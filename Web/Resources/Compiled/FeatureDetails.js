!function(){var t="<div class='panel-group' data-binding='{@visible: attachmentInfos}'>    <h3 data-binding='{@text: @language-feature-attachments}'></h3>    <div class='no-item' data-binding='{@hidden: isAttachmentInfosInitialized}{@text: @language-feature-attachments-checking}'></div>    <div class='no-item' data-binding='{@visible: noAttachments}{@text: @language-feature-attachments-no-attachments}'></div>    <div class='no-item' data-binding='{@visible: isOffline}{@text: @language-feature-attachments-no-attachments-offline}'></div>    <ul class='list-menu active has-icon' data-binding='{@source: attachmentInfos}'>        <li class='attachment list-menu-item' data-binding='{@template-for: attachmentInfos}{@class-has-delete-button: canEditAttachments}'>            <a class='list-menu-details' data-binding='{href: url}{@event-onclick: attachment_click}{target: target}'>                <img class='list-menu-icon' src='Resources/Images/Icons/Toolbar/attach-24.png' data-binding='{alt: @language-feature-attachments}' />                <strong class='list-menu-name' data-binding='{@text: name}'></strong>                <span class='list-menu-desc' data-binding='{@text: size}'></span>            </a>            <button class='list-item-button icon icon-delete-16' data-binding='{@visible: canEditAttachments}{@event-click: handleDeleteClick}{title: @language-feature-attachments-delete}{@text: @language-feature-attachments-delete}'></button>        </li>    </ul></div>",i="<div class='panel-group' data-binding='{@visible: providerEnabled}'>    <h3 data-binding='{@text: @language-feature-attributes}' tab-index='1'></h3>    <div class='list-menu attrib static' data-binding='{@source: attributes}'>        <div class='list-menu-item' data-binding='{@template-for: attributes}{@visible: visible}'>            <strong class='list-menu-name' data-binding='{@text: displayName}'></strong>            <div class='list-menu-desc'>                <span data-binding='{@hidden: displayAsUrl}{@text: presentableValue}'></span>                <a data-binding='{href: value}{@visible: displayAsUrl}{@text: presentableValue}{@event-onclick: handleClickAttributeLink}' target='_blank'></a>                <span data-binding='{@hidden: presentableValue}{@text: @language-feature-not-available}'></span>            </div>        </div>    </div></div>",a="<div class='panel-group'>    <h3 data-binding='{@text: displayName}'></h3>    \x3c!-- DataLinks Table --\x3e    <div class='datalinks-table-widget' data-binding='{@widget: DataLinksTableViewWidget}{@widget-context: @context}{@widget-required: false}'></div>    \x3c!-- END: DataLinksTable Table --\x3e</div>",r="<div class='panel-group' data-binding='{@visible: providerEnabled}'>    <h3 data-binding='{@text: displayName}'></h3>    <div class='list-menu active' data-binding='{@source: dataLinks}'>        <button class='list-menu-item' data-binding='{@template-for: dataLinks}{@event-click: handleViewClick}'>            <div class='list-menu-details'>                <div class='list-menu-name' data-binding='{@text: displayName}'></div>            </div>        </button>    </div></div>",n="<div class='panel-group data-link'>    <h3 data-binding='{@text: @language-feature-attributes}'></h3>    <div class='datalinks' data-binding='{@visible: currentDataLink}{@source: currentDataLink}'>        <div class='list-menu attrib' data-binding='{@template-for: currentDataLink}{@source: attributes}'>            <div class='list-menu-item' data-binding='{@template-for: attributes}' tabindex='0'>                <strong class='list-menu-name' data-binding='{@text: name}'></strong>                <span class='list-menu-desc' data-binding='{@visible: presentableValue}'>                    <span data-binding='{@hidden: displayAsUrl}{@text: presentableValue}'></span>                    <a data-binding='{@event-onclick: handleClickDataLink}{href: value}{@visible: displayAsUrl}{@text: value}' target='_blank'></a>                </span>                <span class='list-menu-desc' data-binding='{@hidden: presentableValue}{@text: @language-feature-not-available}'></span>            </div>        </div>    </div></div>",s="<div class='panel-group feature-description-provider' data-binding='{@visible: providerEnabled}'>    <h3 data-binding='{@text: @language-feature-description}' tab-index='1'></h3>    <div class='feature-details-content' data-binding='{@widget: GetDescription}{@widget-context: currentFeature}{@widget-required: false}'>    </div></div>",o="<div class='panel-group' data-binding='{@visible: providerEnabled}'  tabindex='0'>    <h3 data-binding='{@text: @language-feature-actions}' tabindex='0'></h3>    <ul class='list-menu active has-icon' data-binding='{@source: visibleMenuItems}'>        <li class='list-menu-item' data-binding='{@template-for: visibleMenuItems}{@event-onmouseover: getDescription}{@event-onclick: handleMenuItemClick}'>            <button class='list-menu-details'>                <img class='list-menu-icon' data-binding='{@visible: iconUri}{src: iconUri}' alt=''/>                <strong class='list-menu-name' data-binding='{@text: text}'></strong>                <span class='list-menu-desc' data-binding='{@text: description}'></span>            </button>        </li>    </ul></div>",l="<div class='panel-group feature-hyperlinks-provider' data-binding='{@visible: providerEnabled}'>    <h3 data-binding='{@text: @language-feature-hyperlinks}'></h3>    <ul class='list-menu hyperlinks' data-binding='{@visible: providerEnabled}{@source: hyperlinks}'>        <li class='list-menu-item' data-binding='{@template-for: hyperlinks}'>            <a class='list-menu-button' data-binding='{href: uri}{target: target}{@event-onclick: handleClickHyperlink}'>                <span class='list-menu-details' data-binding='{title: toolTip}{@class-disabled: isBroken}'>                    <strong class='list-menu-name' data-binding='{@text: text}'></strong>                </span>            </a>        </li>    </ul></div>",u="<div class='panel-group' data-binding='{@visible: providerEnabled}'>    <h3 data-binding='{@text: @language-feature-attributes}' tabindex='0'></h3>    <div class='attrib static' data-binding='{@source: multiColumnAttributeContainer}'>        <div class='multi-column-container' data-binding='{@template-for: multiColumnAttributeContainer}'>            <ul class='attribute-list columns' data-binding='{@source: @context}{@template: Mapping/modules/FeatureDetails/FeatureDetailsProviders/SingleAttributeView.html}'></ul>        </div>    </div></div>",d="<div class='panel-group' data-binding='{@class-has-editable-related-features: relatedsEditable}{@visible: providerEnabled}' tabindex='0'>    <h3>        <span>            <span data-binding='{@text: displayName}'></span>        </span>    </h3>    \x3c!-- CREATE/EDIT RELATED FEATURES --\x3e    <div class='no-item' data-binding='{@hidden: hasRetrievedData}{@text: @language-feature-related-checking}'></div>    <div class='createfeature' data-binding='{@enabled: hasRetrievedData}'>        <ul class='list-menu has-icon createfeature-actions' data-binding='{@visible: canAdd}'>            <li class='list-menu-item'>                <button class='list-menu-details' data-binding='{@enabled: validCardinality}{@event-click: handleClickAddRelatedRecord}'>                    <img class='list-menu-icon' src='Resources/Images/Icons/add-24.png' alt=' ' />                    <span class='list-menu-desc' data-binding='{@text: @language-feature-create-related-features}'></span>                </button>            </li>        </ul>        <div class='no-item' data-binding='{@visible: noRelatedFeatures}{@text: @language-feature-related-no-data}'></div>        <div class='no-item' data-binding='{@visible: errorFetchingRelatedFeatures}{@text: @language-feature-related-error-fetching}'></div>        \x3c!-- Related Features Table --\x3e        <div class='related-features-table-widget' data-binding='{@hidden: noRelatedFeatures}{@widget: RelatedFeaturesTableViewWidget}{@widget-context: @context}{@widget-required: false}'></div>        \x3c!-- END: Related Features Table --\x3e    </div></div>",c="<div class='panel-group' data-binding='{@visible: providerEnabled}' tabindex='0'>    <h3>        <span>            <span data-binding='{@text: displayName}'></span>        </span>    </h3>    \x3c!-- CREATE/EDIT RELATED FEATURES --\x3e    <div class='no-item' data-binding='{@hidden: hasRetrievedData}{@text: @language-feature-related-checking}'></div>    <div data-binding='{@enabled: hasRetrievedData}'>        <div class='list-menu has-icon' data-binding='{@visible: canAdd}'>            <button class='list-menu-item' data-binding='{@enabled: validCardinality}{@event-click: handleClickAddRelatedRecord}'>                <img class='list-menu-icon' src='Resources/Images/Icons/add-24.png' alt=' ' />                <span class='list-menu-desc' data-binding='{@text: @language-feature-create-related-features}'></span>            </button>        </div>        <div class='no-item' data-binding='{@visible: noRelatedFeatures}{@text: @language-feature-related-no-data}'></div>        <div class='no-item' data-binding='{@visible: errorFetchingRelatedFeatures}{@text: @language-feature-related-error-fetching}'></div>        <div class='list-menu active' data-binding='{@source: relatedEsriFeatureInfo}'>            <button class='list-menu-item' data-binding='{@template-for: relatedEsriFeatureInfo}{@event-click: handleViewClick}'>                <div class='list-menu-details'>                    <strong class='list-menu-name' data-binding='{@text: displayName}'></strong>                </div>            </button>        </div>    </div></div>",p="<li class='attribute-item' data-binding='{@template-for: @context}{@visible: visible}' tabindex='0'>    <span class='attribute-label' data-binding='{@text: displayName}'></span>    <div class='attribute-details'>        <span data-binding='{@hidden: displayAsUrl}{@text: presentableValue}'></span>        <a data-binding='{href: value}{@visible: displayAsUrl}{@text: presentableValue}{@event-onclick: handleClickAttributeLink}' target='_blank'></a>        <span data-binding='{@hidden: presentableValue}{@text: @language-feature-not-available}'></span>    </div></li>",h="<div class='tab-container' data-binding='{@var: scrollingTabContainerElement}'>    <table>        <tr>            <td class='tab-left-scroll' data-binding='{@visible: tabControlsEnabled}{@class-disabled: leftScrollTabDisabled}{@var: scrollTabLeftElement}'>                <button data-binding='{@event-onclick: handleTabScrollBack}{title: @language-tab-scroll-prev}'>                    <img src='Resources/Images/Icons/chevron-left-16.png' data-binding='{alt: @language-feature-details-left-chevron}'>                </button>            </td>            <td >                <div class='tab-container' data-binding='{@var: tabContainerElement}'>                    <ul class='tab-control' data-binding='{@source: viewDescriptors}{@var: tabElements}'>                        <li data-binding='{@template-for: viewDescriptors}{@visible: providerEnabled}{@event-onclick: handleClickTab}'>                            <button data-binding='{@noclass-tab: isActive}{@class-tab-active: isActive}{@text: title}{title: title}'></button>                        </li>                    </ul>                </div>            </td>            <td class='tab-right-scroll' data-binding='{@visible: tabControlsEnabled}{@class-disabled: rightScrollTabDisabled}{@var: scrollTabRightElement}'>                <button data-binding='{@event-onclick: handleTabScrollForward}{title: @language-tab-scroll-next}'>                    <img src='Resources/Images/Icons/chevron-right-16.png' data-binding='{alt: @language-feature-details-right-chevron}' />                </button>            </td>        </tr>    </table></div>",g="<div class='feature-details-header'>    <div class='feature-actions-widget' data-binding='{@visible: currentFeature}{@widget: FeatureActionsWidget}{@widget-context: currentFeature}{@widget-required: false}' data-menu-id='FeatureActions'></div></div><div data-binding='{@widget: FeatureDetailsRegionWidget}{@widget-context: @context}{@widget-required: true}{@widget-replace: true}' tabindex='0'></div>",b="<div class='large-feature-detail' data-binding='{@visible: headerText}'>        <h2 data-binding='{@text: headerText}'></h2>    <div class='panel-group' data-binding='{@visible: FeatureActions}'>        <ul class='actions-menu' data-binding='{@source: FeatureActions}'>            <li data-binding='{@template-for: FeatureActions}'>                <a href='javascript:void(0);' data-binding='{@text: text}{@event-onmouseover: getDescription}{@event-onclick: handleMenuItemClick}'></a>            </li>        </ul>    </div>        <div class='panel-group' data-region-name='FeatureRegion' data-region-adapter='geocortex.framework.ui.DivStackRegionAdapter'></div> </div>";function D(e,t,i){if("string"==typeof e&&(i=t,t=e),void 0!==i)for(var a=t.split("."),r=null,n=window,s=0,o=a.length;s<o;s++)r=a[s],s==o-1?n[r]=i:n[r]||(n[r]={}),n=n[r];else console.warn("Undefined shim for: "+t)}require({cache:{"Mapping/modules/FeatureDetails/FeatureDetailsModule":function(){var a,h=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/application/ModuleBase","geocortex/infrastructure/Feature","geocortex/infrastructure/FeatureSetCollection","geocortex/framework/ui/MultiViewRegionAdapter","geocortex/geocortex","geocortex/infrastructure/TaskUtils","geocortex/infrastructure/GraphicUtils","geocortex/framework/utils/utils"],function(e,t,i,d,r,n,c,p,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s,o=(s=i.ModuleBase,h(u,s),u.prototype.initialize=function(e){s.prototype.initialize.call(this,e),this._processConfig(e),this.registerCommands(),this.app.event("GraphicAttributesChangedEvent").subscribe(this,this.handleGraphicAttributesUpdated)},u.prototype.handleGraphicAttributesUpdated=function(e){var t=e.graphic;this._currentFeature&&this._currentFeature.esriFeature&&this._currentFeature.esriFeature.get()===t&&(this._currentFeature.esriFeature.pulse(),this.app.event("FeatureChangedEvent").publish(this._currentFeature))},u.prototype.getStateFilter=function(){return{currentFeature:this.app.project.filter.feature,viewMode:!0}},u.prototype.exportState=function(){var i=this;return Promise.try(function(){var e=i._viewModes[i._defaultViewMode].viewId,t=i.app.viewManager.getViewById(e);return{currentFeature:t&&t.isActive?i.app.project.convert.fromGcxFeature(i._currentFeature):null,viewMode:i._defaultViewMode}})},u.prototype.applyState=function(i){var a=this;return this.app.project.convert.toGcxFeature(i.currentFeature).catch(function(e){return null}).then(function(e){var t=i.viewMode;a._viewModes[t]||(t=a._defaultViewMode),a._executeSetFeatureDetailsMode({viewMode:t,feature:e})})},u.prototype._processConfig=function(e){if(e){if(e.viewModes)for(var t in e.viewModes)e.viewModes.hasOwnProperty(t)&&(e.viewModes[t].viewId&&e.viewModes[t].defaultProviderTargetRegion?(e.defaultViewMode||(e.defaultViewMode=t.toLowerCase()),this._viewModes[t.toLowerCase()]=e.viewModes[t]):this.app.trace.warning("FeatureDetailsModule: Error loading view mode - viewId or defaultProviderTargetRegion not specified. Please check your configuration"));if(this._defaultViewMode=e.defaultViewMode,!this._defaultViewMode)return void this.app.trace.error("FeatureDetailsModule: Could not compute default view mode. Please check your configuration settings");e.providers&&(this._providerConfig=e.providers)}},u.prototype.registerCommands=function(){var a=this;this.app.command("ShowFirstFeatureFromCollection").register(this,function(e){var t=null;if(!e&&a._currentFeature?a.app.command("ShowFeatureDetails").execute(a._currentFeature):"string"==typeof e?t=a.app.featureSetManager.getCollectionById(e):e instanceof r.FeatureSetCollection?t=e:a.app.trace.error("No FeatureSetCollection or ID given"),t){var i=t.firstFeature();i?a.app.command("ShowFeatureDetails").execute(i):a.app.trace.error("No feature in FeatureSetCollection")}else a.app.trace.error("No FeatureSetColection found.")}),this.app.command("ShowFeatureDetails").register(this,function(e){!e&&a._currentFeature&&(e=a._currentFeature),e?"string"==typeof e?a.app.command("ShowFirstFeatureFromCollection").execute(e):(a.app.command("_updateFeatureDetailViewModels").execute(e),a._processFeatureDetails(e)):a.app.trace.error("ShowFeatureDetails: Could not execute command. No feature found.")}),this.app.command("ShowFeatureDetailsFromMaptip").register(this,this._showFeatureDetailsFromMaptip,this._canExecuteshowFeatureDetailsFromMaptip),this.app.command("HideFeatureDetails").register(this,this._deactivateFeatureDetailsView),this.app.command("GetFeatureDetailsProviders").register(this,this._processFeatureDetails),this.app.command("ShowFeatureDetailsCompact").register(this,function(e){a._executeSetFeatureDetailsMode({viewMode:"compact",feature:e}),a.app.command("ShowFeatureDetailsExpanded").raiseCanExecuteChanged(),a.app.command("ShowFeatureDetailsCompact").raiseCanExecuteChanged()},function(e){return a._canExecuteSetFeatureDetailsMode({viewMode:"compact",feature:e})}),this.app.command("ShowFeatureDetailsExpanded").register(this,function(e){a._executeSetFeatureDetailsMode({viewMode:"expanded",feature:e}),a.app.command("ShowFeatureDetailsCompact").raiseCanExecuteChanged(),a.app.command("ShowFeatureDetailsExpanded").raiseCanExecuteChanged()},function(e){return a._canExecuteSetFeatureDetailsMode({viewMode:"expanded",feature:e})}),this.app.command("SetFeatureDetailsMode").register(this,this._executeSetFeatureDetailsMode,this._canExecuteSetFeatureDetailsMode),this.app.command("GetRelatedFeatures").register(this,this._executeGetRelatedFeatures)},u.prototype._executeSetFeatureDetailsMode=function(e){this._defaultViewMode="string"==typeof e?e:e.viewMode,"string"!=typeof e&&e.feature&&e.feature!==this._currentFeature&&(this.app.command("_updateFeatureDetailViewModels").execute(e.feature),this._processFeatureDetails(e.feature)),this._activateFeatureDetailsView(this._currentFeature)},u.prototype._canExecuteSetFeatureDetailsMode=function(e){var t="string"==typeof e?e:e.viewMode;if(this._defaultViewMode===t)return!1;var i,a=this._getViewModeConfigParams(t);a&&(i=this.app.viewManager.getViewById(a.viewId));var r=e.feature;return r&&r!==this._currentFeature?!!i&&!!a.defaultProviderTargetRegion:!(!i||i.isActive||!a.defaultProviderTargetRegion||!r&&!this._currentFeature)},u.prototype.updateFeature=function(t){t&&t!==this._currentFeature&&(this._currentFeature=t,this.providerViewModelList.forEach(function(e){return e.currentFeature.set(t)}),this.app.project.isLoading||this.app.event("FeatureDetailsCurrentFeatureChanged").publish(t))},u.prototype._processFeatureDetails=function(e){function t(){i._loadProviders(i._providerConfig),i.updateFeature(e),i._activateFeatureDetailsView(e),i.app.event("FeatureDetailsInvokedEvent").publish(e)}var i=this;this.app.allLibrariesLoaded?t():this.app.event("ViewerLibrariesDownloadedEvent").once(this,t)},u.prototype._activateFeatureDetailsView=function(e){if(e){var t=null;if(!this.app.project.isLoading){for(var i in this._viewModes)if(this._viewModes.hasOwnProperty(i)){var a=this._viewModes[i].viewId;if(i===this._defaultViewMode)t=a;else{var r=this.app.viewManager.getViewById(a);r&&r.isActive&&this.app.command("DeactivateView").execute(a)}}t&&(this.app.command("ActivateView").execute(t),t=null)}this._setProviderTargetRegions(this._defaultViewMode)}},u.prototype._showFeatureDetailsFromMaptip=function(e){this.app.configuration.mobileMode||this.app.command("DeactivateView").execute("MapTipView"),this.app.command("RemoveResultsStatus").execute(),this.app.command("ShowFeatureDetails").execute(e)},u.prototype._canExecuteshowFeatureDetailsFromMaptip=function(e){if(e&&e.esriFeature&&e.esriFeature.get()){var t=e.esriFeature.get();if(a.isClickableGraphic(this.app,t)){var i=a.getClickableLayerInfo(this.app,t);if(i&&i.canEdit(t))return!1}}return!0},u.prototype._deactivateFeatureDetailsView=function(){var e=this._getViewModeConfigParams(this._defaultViewMode);if(e&&e.viewId){var t=this.app.viewManager.getViewById(e.viewId);t&&t.isActive&&this.app.command("DeactivateView").execute(e.viewId)}},u.prototype._loadProviders=function(e){var r=this;0<this.providerViewModelList.length||e.forEach(function(e){if(!1!==e.enabled){var t=dojo.getObject(e.type);if(t){var i=new t(r.app,e.libraryId||r.libraryId),a=r._getProviderViewModeRegionConfig(e);i.app=r.app,i.libraryId=e.libraryId||r.libraryId,i.initialize(e.config),i.createAttachedViews(e,a,function(e){return function(e,t){t.forEach(function(e){r._wireUpViewBindings(e),r.providerViewList.push(e)}),r._setProviderTargetRegions(r._defaultViewMode)}(0,e)}),r.providerViewModelList.push(i)}else r.app.trace.warning("Cannot find FeatureDetailsProvider '{0}'.".format(e.type))}})},u.prototype._getProviderConfigByView=function(e){if(this._providerConfig)for(var t=0,i=this._providerConfig;t<i.length;t++){var a=i[t],r=a.markup;if(r&&"string"==typeof r){if(r===e.markupResource)return a}else for(var n in r)if(r.hasOwnProperty(n)&&r[n]===e.markupResource)return a}return null},u.prototype._getProviderTargetRegionForMode=function(e,t){var i=null;if(e.targetRegion&&e.targetRegion[t])i=e.targetRegion[t];else{var a=this._getViewModeConfigParams(t);a&&(i=a.defaultProviderTargetRegion)}return i},u.prototype._getViewModeConfigParams=function(e){for(var t in this._viewModes)if(this._viewModes.hasOwnProperty(t)&&t===e)return this._viewModes[e];return null},u.prototype._getProviderViewModeRegionConfig=function(e){var t={};if("string"==typeof e.markup)t.default=this._getProviderTargetRegionForMode(e,this._defaultViewMode);else for(var i in e.markup)e.markup.hasOwnProperty(i)&&(t[i]=this._getProviderTargetRegionForMode(e,i));return t},u.prototype._setProviderTargetRegions=function(s){var o=this;s&&(this.providerViewList.forEach(function(e){var t=o._getProviderConfigByView(e),i=o._getProviderTargetRegionForMode(t,s),a="string"==typeof t.markup||t.markup[s]&&t.markup[s]===e.markupResource||void 0===t.markup[s];if(o.app.viewManager.deactivateView(e),a){var r=null;if(i){var n=o.app.viewManager.getRegionForViewId(e.id);n&&(r=e.removed,e.removed=function(){},n.unhostView(e),e.regionName=i)}o.app.viewManager.activateView(e),r&&(e.removed=r),l.isNullOrUndefined(e.viewModel.providerEnabled)||e.viewModel.providerEnabled.pulse()}}),this.app.event("Internal.FeatureProviderTargetRegionsChanged").publish(this._currentFeature))},u.prototype._wireUpViewBindings=function(i){function e(e){if(e){var t=a.app.viewManager.getExistingRegionByName(i.regionName);!t||t instanceof n.MultiViewRegionAdapter&&1!==t.views.length||a.app.viewManager.activateView(i)}else a.app.viewManager.deactivateView(i)}var a=this;if(i.viewModel&&i.viewModel.providerEnabled&&i.viewModel.providerEnabled.isObservable){e(i.viewModel.providerEnabled.get());var t=i.viewModel.providerEnabled.bind(this,e),r=i.onDestroy.bind(i);i.onDestroy=function(){i.viewModel.providerEnabled.unbind(t);for(var e=a.providerViewList.length-1;0<=e;e--)a.providerViewList[e]===i&&a.providerViewList.splice(e,1);"function"==typeof r&&r()}}},u.prototype._executeGetRelatedFeatures=function(e){this._getRelatedFeatures(e.mapService,e.relationshipId,e.objectId,e.currentFeature,e.successCallback,e.errorCallback)},u.prototype._getRelatedFeatures=function(e,t,i,a,s,r){var o=new dojo.Deferred;if(!e){var n=new Error("_getRelatedFeatures: mapService cannot be null.");return c.deferredReject(o,n),"function"==typeof r&&r(n),o}if(isNaN(t))return n=new Error("_getRelatedFeatures: relationshipId cannot be null."),c.deferredReject(o,n),"function"==typeof r&&r(n),o;if(!i)return n=new Error("_getRelatedFeatures: objectId cannot be null."),c.deferredReject(o,n),"function"==typeof r&&r(n),o;var l=new esri.tasks.RelationshipQuery;l.outFields=["*"],l.relationshipId=t,l.objectIds=[i];var u=null;return a&&(a instanceof d.Feature?u=a.layer?a.layer:a.featureLayer:a instanceof esri.Graphic&&(u=a.getLayer())),(u=u||e.serviceLayer)?p.getQueryTask(u,e).executeRelationshipQuery(l).then(function(e){var t=[];for(var i in e)if(e.hasOwnProperty(i))for(var a=0,r=e[i].features;a<r.length;a++){var n=r[a];t.push(n)}c.deferredResolve(o,t),"function"==typeof s&&s(t)},function(e){c.deferredReject(o,e)}):c.deferredResolve(o,[]),o},u);function u(){var e=null!==s&&s.apply(this,arguments)||this;return e.providerViewModelList=[],e.providerViewList=[],e._providerConfig=null,e._currentFeature=null,e._defaultViewMode=null,e._viewModes={},e}t.FeatureDetailsModule=o})},"Mapping/modules/FeatureDetails/FeatureDetailsModuleConfig":function(){define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})},"Mapping/modules/FeatureDetails/FeatureDetailsState":function(){define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})},"Mapping/modules/FeatureDetails/FeatureDetailsSwitcherView":function(){var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework-ui/ViewSwitcher/ViewSwitcherView"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=(a=i.ViewSwitcherView,s(n,a),n.prototype.handleClickTab=function(e,t,i){a.prototype.handleClickTab.call(this,e,t,i),this._refreshTabControlVisibility()},n.prototype.activated=function(){a.prototype.activated.call(this),this.appResizedSubToken=this.app.event("ApplicationResizedEvent").subscribe(this,this.handleResize)},n.prototype.deactivated=function(){a.prototype.deactivated.call(this),this.app.event("ApplicationResizedEvent").unsubscribe(this.appResizedSubToken),this.appResizedSubToken=null},n.prototype.handleResize=function(){var e=this;this.isActive&&(this.delayedExecuteToken&&(clearTimeout(this.delayedExecuteToken),this.delayedExecuteToken=null),this.delayedExecuteToken=setTimeout(function(){e._refreshTabControlVisibility()},200)),this._refreshTabControlVisibility()},n.prototype._updateScrollTabDisabledStatus=function(){if(this.tabContainerElement){var e=this.tabContainerElement.scrollWidth-this.tabContainerElement.offsetWidth;this.viewModel.leftScrollTabDisabled.set(0===this.tabContainerElement.scrollLeft),this.viewModel.rightScrollTabDisabled.set(this.tabContainerElement.scrollLeft>e-1)}},n.prototype.handleTabScrollBack=function(e,t,i){var a=$(this.tabContainerElement),r=a.scrollLeft()-2*this.scrollTabLeftElement.offsetWidth;a.scrollLeft(r<0?0:r),this._updateScrollTabDisabledStatus()},n.prototype.handleTabScrollForward=function(e,t,i){var a=$(this.tabContainerElement),r=this.tabContainerElement.scrollWidth-this.tabContainerElement.offsetWidth,n=a.scrollLeft()+2*this.scrollTabRightElement.offsetWidth;a.scrollLeft(r<n?r:n),this._updateScrollTabDisabledStatus()},n.prototype._refreshTabControlVisibility=function(){var e=this;setTimeout(function(){e.scrollingTabContainerElement&&e.tabElements&&(e.viewModel.tabControlsEnabled.set(e.tabElements.offsetWidth>e.scrollingTabContainerElement.offsetWidth),e._updateScrollTabDisabledStatus())},100)},n);function n(e,t){var i=a.call(this,e,t)||this;return i.viewModel=null,i.scrollingTabContainerElement=null,i.tabContainerElement=null,i.tabElements=null,i.scrollTabLeftElement=null,i.scrollTabRightElement=null,i.delayedExecuteToken=null,i.appResizedSubToken=null,i}t.FeatureDetailsSwitcherView=r})},"Mapping/modules/FeatureDetails/FeatureDetailsSwitcherViewDescriptor":function(){var a,o=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework-ui/ViewSwitcher/ViewSwitcherViewDescriptor","geocortex/framework/observables"],function(e,t,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=i.ViewSwitcherViewDescriptor,o(s,r),s);function s(){var e=null!==r&&r.apply(this,arguments)||this;return e.providerEnabled=new a.Observable(!1),e}t.FeatureDetailsSwitcherViewDescriptor=n})},"Mapping/modules/FeatureDetails/FeatureDetailsSwitcherViewModel":function(){var a,l=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework-ui/ViewSwitcher/ViewSwitcherViewModel","geocortex/framework/observables","./FeatureDetailsSwitcherViewDescriptor"],function(e,t,i,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,s=(n=i.ViewSwitcherViewModel,l(o,n),o.prototype.initialize=function(e){if(n.prototype.initialize.call(this,e),e&&e.hasOwnProperty("defaultTabViewForLayer")){var t=e.defaultTabViewForLayer;for(var i in t)if(t.hasOwnProperty(i)){var a=t[i];if(dojo.isArray(a))for(var r=0;r<a.length;r++)this._addProperty(i,a[r]);else this._addProperty(i,a)}}},o.prototype.createDescriptorForView=function(e){var t=new a.FeatureDetailsSwitcherViewDescriptor(e,this);return this._processViewDescriptor(t),t},o.prototype.checkIfSwitcherActive=function(){return 1<dojo.filter(this.viewDescriptors.get(),function(e){return e.providerEnabled.get()}).length},o.prototype._addProperty=function(e,t){this._layerTabViews[e]||(this._layerTabViews[e]=[]),e&&"default"===t?this._defaultLayerTabView=e:null!=t.mapServiceId&&null!=t.layerId?this._layerTabViews[e].push(t):this.app.trace.warning("Invalid configuration for default layer tab view. Syntax is - {PreferredViewId} : { {mapServiceId}, {layerId} }")},o.prototype._getPreferredViewDescriptor=function(e,t){if(!e||!t)return null;for(var i in this._layerTabViews)if(this._layerTabViews.hasOwnProperty(i))for(var a=0,r=this._layerTabViews[i];a<r.length;a++){var n=r[a];if(e===n.mapServiceId&&t===n.layerId){var s=this._getDescriptorForFirstEligibleTabView(i);if(s)return s}}},o.prototype._processViewDescriptor=function(t){function e(e){t.providerEnabled.bind(i,i.updateViewSwitcherState),t.providerEnabled.sync(e.providerEnabled)}var i=this;t.view.viewModel?e(t.view.viewModel):dojo.aspect.after(t.view,"attach",dojo.hitch(this,e),!0)},o.prototype._handleFeatureChanged=function(e){if(0!==this.viewDescriptors.length()&&(this._cancelBindingsIfApplicable(),e&&e.layer)){var t=e.layer.mapService?e.layer.mapService.id:null;this._activateDefaultTabViewForLayer(t,e.layer.id)}},o.prototype._activateDefaultTabViewForLayer=function(e,t){function i(i){var e=i.providerEnabled,t=i.providerEnabled.bind(a,function(e){if(e){var t=s&&i.view.id===s.view.id;n&&!t||(a.app.viewManager.activateView(i.view),t&&a._cancelBindingsIfApplicable(),n=!0)}});a._currFeatureProviderBindings.push({currentFeatureProviderEnabledRef:e,currentFeatureProviderBindingToken:t})}var a=this,r=null,n=!1,s=null;!(r=this._getPreferredViewDescriptor(e,t))&&this._defaultLayerTabView&&(r=this._getDescriptorForFirstEligibleTabView(this._defaultLayerTabView)),r&&!r.providerEnabled.get()&&(s=r,r=null),(r=r||function(){for(var e=0;e<a.viewDescriptors.length();e++)if(a.viewDescriptors.getAt(e).providerEnabled.get()&&a.viewDescriptors.getAt(e).view)return a.viewDescriptors.getAt(e);return null}())?(this.app.viewManager.activateView(r.view),n=!0,s&&i(s)):this.viewDescriptors.get().forEach(function(e){return i(e)})},o.prototype._cancelBindingsIfApplicable=function(){this._currFeatureProviderBindings.length&&(this._currFeatureProviderBindings.forEach(function(e){e.currentFeatureProviderEnabledRef.unbind(e.currentFeatureProviderBindingToken)}),this._currFeatureProviderBindings=[])},o.prototype._getDescriptorForFirstEligibleTabView=function(t){var e=null;if(!(e=this.getDescriptorForView(this.app.viewManager.getViewById(t)))){var i=this.app.viewManager.getViews().filter(function(e){return e.id.startsWith(t)});if(i.length)for(var a=0,r=i;a<r.length;a++){var n=r[a];if(e=this.getDescriptorForView(n))break}}return e},o);function o(e,t,i){var a=n.call(this,e,t,i)||this;return a.tabControlsEnabled=new r.Observable(!1),a.leftScrollTabDisabled=new r.Observable(!1),a.rightScrollTabDisabled=new r.Observable(!1),a._defaultLayerTabView=null,a._layerTabViews={},a._currFeatureProviderBindings=[],a.app.event("Internal.FeatureProviderTargetRegionsChanged").subscribe(a,a._handleFeatureChanged),a.app.command("_updateFeatureDetailViewModels").register(a,a._handleFeatureChanged),a}t.FeatureDetailsSwitcherViewModel=s})},"Mapping/modules/FeatureDetails/FeatureDetailsView":function(){var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewBase"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,a=(r=i.ViewBase,s(n,r),n.prototype.attach=function(e){r.prototype.attach.call(this,e),this.title.syncTransform(e.headerText,function(e){return String.unescapeHtml(e)}),-1===e.viewsToActivate.indexOf(this.id)&&e.viewsToActivate.push(this.id)},n.prototype.resolveWidget=function(e,t,i){switch(r.prototype.resolveWidget.call(this,e,t,i),e){case"FeatureDetailsRegionWidget":var a=this.app.viewManager.createView({markupResource:"Framework.UI/geocortex/framework/ui/MultiRegion/MultiRegionView.html",libraryId:"Framework.UI",typeName:"geocortex.framework.ui.MultiRegion.MultiRegionView",isVisible:!1});return a&&a.attach(t),this._processView(a),a;case"FeatureActionsWidget":return this._featureDetailsMenu.context!==t&&(this._featureDetailsMenu={context:t,menu:this.app.menuRegistry.createMenuWidget(this,t,i,this.libraryId,null,"feature-detail-actions-widget",!0)}),this._featureDetailsMenu.menu;default:return}},n.prototype.activated=function(){var e=this;r.prototype.activated.call(this),setTimeout(function(){return e.app.behavior("FeatureDetailsOpenedBehavior").run(e.viewModel.currentFeature.get())},300)},n.prototype.deactivated=function(){r.prototype.deactivated.call(this),this.app.behavior("FeatureDetailsClosedBehavior").run(this.viewModel.currentFeature.get()),this.isActive=!1},n.prototype._handleFeatureChanged=function(e){var t=this,i=this.app.command("ShowMap").postExecute.once(this,function(){setTimeout(function(){t.app.command("FocusOnFirstInputInView").execute(t)},0),i=null});this.app.event("ViewActivated").once(this,function(){i&&(t.app.command("ShowMap").postExecute.unsubscribe(i),setTimeout(function(){t.app.command("FocusOnFirstInputInView").execute(t)},0))})},n.prototype._processView=function(e){function t(){a.className=r+" "+i.viewModel.featureMultiRegionCss.get().trim()}var i=this,a=e.multiRegionViewElement,r="";this._multiRegionCssBindingToken&&(this.viewModel.featureMultiRegionCss.unbind(this._multiRegionCssBindingToken),this._multiRegionCssBindingToken=""),a&&(r=a.className.trim(),t(),this._multiRegionCssBindingToken=this.viewModel.featureMultiRegionCss.bind(this,t))},n);function n(e,t){var i=r.call(this,e,t)||this;return i._multiRegionCssBindingToken="",i._featureDetailsMenu={context:null,menu:null},i.app.event("FeatureDetailsCurrentFeatureChanged").subscribe(i,i._handleFeatureChanged),i.app.event("ViewContainerViewClosedEvent").subscribe(i,function(e){e.viewId===i.id&&i.viewModel&&i.viewModel.currentFeature.get()&&i.viewModel.setFeatureDetailsDisplayFeatureTag(i.viewModel.currentFeature.get(),!1)}),i}t.FeatureDetailsView=a})},"Mapping/modules/FeatureDetails/FeatureDetailsViewModel":function(){var a,c=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework-ui/MultiRegion/MultiRegionViewModel","geocortex/framework/observables","geocortex/infrastructure/Feature","geocortex/infrastructure/FeatureSet","./FeatureDetailsSwitcherViewModel","geocortex/infrastructure/MapUtils"],function(e,t,i,a,s,o,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l,u=(l=i.MultiRegionViewModel,c(d,l),d.prototype.initialize=function(e){e&&(this._config=e,this._config.autoInsertViewSwitcher=!0),l.prototype.initialize.call(this,e)},d.prototype.createViewSwitcherViewModel=function(e){var t=new r.FeatureDetailsSwitcherViewModel(this.app,this.libraryId,e);return t.initialize(this._config),t},d.prototype.processRegion=function(e){var t=this;l.prototype.processRegion.call(this,e),e.regionActive.bind(this,function(e){return t._updateMultiRegionViewCss()})},d.prototype._updateMultiRegionViewCss=function(){var t="";this.regionDescriptors.get().forEach(function(e){return t=t.concat(" {0}-{1}".format(e.regionName,e.regionActive.get()?"active":"inactive"))}),this.featureMultiRegionCss.set(t.trim())},d.prototype._registerCommands=function(){var t=this;this.app.command("_updateFeatureDetailViewModels").register(this,function(e){e&&e instanceof s.Feature&&(t._setCurrentFeature(e),t.currentFeatureSet=t.currentFeature.get()?t.currentFeature.get().featureSet:null)})},d.prototype._subscribeEvents=function(){this.app.event("FeatureEditedEvent").subscribe(this,this._handleEditedFeature),this.app.event("FeatureDeletedEvent").subscribe(this,this._handleDeletedFeature),this.app.event("FSMCollectionRemovedEvent").subscribe(this,this._onFeatureSetCollectionRemoved)},d.prototype._handleDeletedFeature=function(e){var t=e instanceof esri.Graphic?e:e.originalFeature;t&&this.currentEsriFeatureClone&&n.esriFeaturesEqual(this.currentEsriFeatureClone,t)&&(this.currentEsriFeatureClone=null,this._deactivateViews())},d.prototype._handleEditedFeature=function(e){e.originalFeature&&e.editedFeature?this.currentEsriFeatureClone&&n.esriFeaturesEqual(e.originalFeature,this.currentEsriFeatureClone)&&(this.currentFeature.get().esriFeature.set(e.editedFeature),this._processCurrentFeature(),this.currentEsriFeatureClone=e.editedFeature):this.app.trace.warning("FeatureDetailsViewModel: Could not handle FeatureEditedEvent. Original or Edited feature not provided.")},d.prototype._onFeatureSetCollectionRemoved=function(e){var t=e.featureSetCollection;if(t){var i=this.currentFeature.get();if(i&&i.featureSet){var a=t.getFeatureSetById(i.featureSet.id);a&&a.uniqueId===i.featureSet.uniqueId&&(this._deactivateViews(),this.currentFeature.set(null))}}},d.prototype._setCurrentFeature=function(e){this.currentFeature.get()&&this.app.command("ClearFeatureFocus").execute(this.currentFeature.get());var t=!1;if("string"==typeof e){var i=this.app.featureSetManager.getCollectionById(e);if(i){var a=i.firstFeature();a?this.currentFeature.get()&&this.currentFeature.get().token===a.token?this.currentFeature.value=a:(this.currentFeature.set(a),t=!0):this.app.trace.error("No feature in feature set collection")}else this.app.trace.error("No feature set collection found matching id: "+e)}else if(e&&e instanceof s.Feature){var r=e;if(null==r.featureSet){var n=new o.FeatureSet({app:this.app,layer:r.layer});n.addFeature(r),r.featureSet=n}this.currentFeature.get()&&this.currentFeature.get().token===r.token?this.currentFeature.value=r:(this.currentFeature.set(r),t=!0)}t&&this._processCurrentFeature()},d.prototype._handleCurrentFeatureChanged=function(){var e=this.currentFeature.get();this.currentEsriFeatureClone=e?n.cloneEsriFeature(e._graphic):null},d.prototype._processCurrentFeature=function(){var e=this.currentFeature.get();this.headerText.removeSync(),e&&this.headerText.sync(e.plainLabel)},d.prototype._deactivateViews=function(){for(var e=0,t=this.viewsToActivate;e<t.length;e++){var i=t[e];this.app.command("DeactivateView").execute(i)}},d.prototype.setFeatureDetailsDisplayFeatureTag=function(e,t){e&&dojo.isFunction(e.setExtendedProperty)&&e.setExtendedProperty(this._featureTag,!!t)},d);function d(e,t){var i=l.call(this,e,t)||this;return i.headerText=new a.Observable(""),i.currentFeature=new a.Observable(null),i.currentEsriFeatureClone=null,i.currentFeatureSet=null,i.viewsToActivate=[],i.featureMultiRegionCss=new a.Observable(""),i._featureTag="isShownInFeaturedetails",i._lastTaggedCurrentFeature=null,i.currentFeature.bind(i,function(){return i._handleCurrentFeatureChanged()}),i.regionViewSwitcherWidgetMarkup="Mapping/modules/FeatureDetails/FeatureDetailsSwitcherView.html",i.regionViewSwitcherWidgetType="geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsSwitcherView",i.regionViewSwitcherLibraryId=i.libraryId,i._registerCommands(),i._subscribeEvents(),i.currentFeature.bind(i,function(e){e?(i._lastTaggedCurrentFeature&&i.setFeatureDetailsDisplayFeatureTag(i._lastTaggedCurrentFeature,!1),i.setFeatureDetailsDisplayFeatureTag(e,!0),i._lastTaggedCurrentFeature=e):i._lastTaggedCurrentFeature&&i.setFeatureDetailsDisplayFeatureTag(e,!1)}),i}t.FeatureDetailsViewModel=u})},"Mapping/modules/FeatureDetails/FeatureDetailsProviders/AttachmentsView":function(){var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewBase"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=(a=i.ViewBase,s(n,a),n.prototype.attachment_click=function(e,t,i){var a=this;return this.app.isOffline.get()?(this.app.command("RewriteUrlForOffline").execute(i.url.get(),function(e){if(e)return a.app.command("OpenWebPage").execute({url:e,element:t});a.app.command("Alert").execute(a.getResource("language-feature-details-attachment-not-available-offline"))}),!1):this.app.followNavigationLink({url:i.url.get(),element:t})},n.prototype.handleDeleteClick=function(e,t,i){var a=this,r=this.app.getResource(this.libraryId,"language-feature-attachments-delete-prompt-title"),n=this.app.getResource(this.libraryId,"language-feature-attachments-delete-prompt-text");this.app.command("Confirm").execute(n,r,function(e){if(e){var t={layer:a.viewModel.currentFeature.get().layer.mapService.serviceLayer,feature:a.viewModel.currentFeature.get().esriFeature.get(),attachmentIds:[i.attachmentId],callback:function(e){if(e[0]&&e[0].error){var t=a.getResource("language-feature-attachments-delete-prompt-title"),i=e[0].error.message||a.getResource("language-feature-attachments-delete-prompt-error-unknown");a.app.command("Alert").execute(i,t)}else a.viewModel.currentFeature.get().resetAttachmentInfos(),a.viewModel.handleCurrentFeatureChanged(a.viewModel.currentFeature.get())},errback:function(e){var t=a.getResource("language-feature-attachments-delete-prompt-title");a.app.command("Alert").execute(e.message||e,t)}};a.app.command("DeleteAttachments").execute(t)}})},n);function n(){return null!==a&&a.apply(this,arguments)||this}t.AttachmentsView=r})},"Mapping/modules/FeatureDetails/FeatureDetailsProviders/AttachmentsViewModel":function(){var a,u=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/infrastructure/featureDetails/FeatureProviderBase","geocortex/framework/observables","geocortex/essentials/FeatureLayerService","geocortex/infrastructure/FormatUtils"],function(e,t,i,a,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s,o=(s=i.FeatureProviderBase,u(l,s),l.prototype.handleCurrentFeatureChanged=function(t){var i=this;if(this.updateProviderState(!1),this.hasAttachments.set(!1),this.noAttachments.set(!1),this.isOffline.set(!1),this.isAttachmentInfosInitialized.set(!1),this.canEditAttachments.set(!1),this._setAttachmentInfos(null),!t)throw new Error("Feature cannot be null for the attachment infos view model");if(this.hasAttachments.set(t.hasAttachments.get()),this.hasAttachments.get()){var e=t.layer&&t.layer.mapService;e&&e instanceof r.FeatureLayerService&&this.canEditAttachments.set(e.canAddAttachments&&e.canEdit),t.attachmentInfosInitialized.get()?(this._setAttachmentInfos(t.attachmentInfos),0===this.attachmentInfos.length()?(this.isOffline.set(this.app.isOffline.get()),this.noAttachments.set(!this.app.isOffline.get())):this.updateProviderState(!0),this.isAttachmentInfosInitialized.set(!0)):this.bindToken=t.attachmentInfosInitialized.bind(this,function(e){e&&(i.isAttachmentInfosInitialized.set(!0),i._setAttachmentInfos(t.attachmentInfos),0===i.attachmentInfos.length()?(i.isOffline.set(i.app.isOffline.get()),i.noAttachments.set(!i.app.isOffline.get())):i.updateProviderState(!0),t.attachmentInfosInitialized.unbind(i.bindToken))}),t.attachmentInfos.get()}},l.prototype._setAttachmentInfos=function(e){if(this.attachmentInfos.clear(),e)for(var t=e.getLength(),i=0;i<t;i++){var a=e.getAt(i),r=this.app.nativeManager.isNative()?null:"_blank";this.attachmentInfos.addItem({name:a.name,url:a.url,canEditAttachments:this.canEditAttachments.get(),size:n.formatBytes(a.size.get()),attachmentId:a.id.get(),target:r})}},l);function l(e,t){var i=s.call(this,e,t)||this;return i.hasAttachments=new a.Observable(!1),i.attachmentInfos=new a.ObservableCollection,i.isAttachmentInfosInitialized=new a.Observable(!1),i.noAttachments=new a.Observable(!1),i.isOffline=new a.Observable(!1),i.canEditAttachments=new a.Observable(!1),i.bindToken=null,i.app.event("FeatureAttachmentAddedEvent").subscribe(i,i.handleCurrentFeatureChanged),i}t.AttachmentsViewModel=o})},"Mapping/modules/FeatureDetails/FeatureDetailsProviders/AttributesView":function(){var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewBase"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=(a=i.ViewBase,s(n,a),n.prototype.handleClickAttributeLink=function(e,t,i){return this.app.followNavigationLink({url:i.value.get(),element:t})},n);function n(){return null!==a&&a.apply(this,arguments)||this}t.AttributesView=r})},"Mapping/modules/FeatureDetails/FeatureDetailsProviders/AttributesViewModel":function(){var a,u=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/infrastructure/featureDetails/FeatureProviderBase","geocortex/framework/observables","geocortex/essentials/Field","geocortex/framework/utils/utils"],function(e,t,i,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s,o=(s=i.FeatureProviderBase,u(l,s),l.prototype.initialize=function(e){s.prototype.initialize.call(this,e),e&&(this.MAX_COLUMNS=isNaN(parseInt(e.maxColumns,10))?this.MAX_COLUMNS:parseInt(e.maxColumns,10),this.COLUMN_THRESHOLD=isNaN(parseInt(e.columnThreshold,10))?this.COLUMN_THRESHOLD:parseInt(e.columnThreshold,10))},l.prototype.handleCurrentFeatureChanged=function(e){if(e){this._getAttributeTypes(this.currentFeature.get());var t=e.getAttributes();this._attributesChangedSubscriptionToken&&this._prevFeatureLinkedAttributes&&this._prevFeatureLinkedAttributes.unbind(this._attributesChangedSubscriptionToken),this._attributesChangedSubscriptionToken=this._prevFeatureLinkedAttributes=null,this._prevFeatureLinkedAttributes=e.linkedAttributes,this._attributesChangedSubscriptionToken=e.linkedAttributes.bind(this,this._handleAttributesChanged),this.processAttributes(t),this._setAttributes(t)}else this._setAttributes(null)},l.prototype._getAttributeTypes=function(e){if(this.attributeTypes={},e.layer&&e.layer.fields)for(var t=0;t<e.layer.fields.length;t++){var i=e.layer.fields[t];if(e.layer instanceof esri.layers.FeatureLayer){var a=i;i.dataType=r.Field.convertFromEsriType(a.type)}this.attributeTypes[i.name]=i.dataType}},l.prototype._handleAttributesChanged=function(){var e=this.currentFeature.get().getAttributes();this.processAttributes(e),this._setAttributes(e)},l.prototype._setAttributes=function(e){this.attributes.clear(),e&&this.attributes.set(e),this._populateMultiColumnAttributeContainer(),this.updateProviderState(!!this.attributes.length())},l.prototype._populateMultiColumnAttributeContainer=function(){this.multiColumnAttributeContainer.clear();var e=dojo.filter(this.attributes.get(),function(e){return e.visible.get()}),t=e.length>this.COLUMN_THRESHOLD?Math.ceil(e.length/this.COLUMN_THRESHOLD):1;t=t>this.MAX_COLUMNS?this.MAX_COLUMNS:t;for(var i=Math.ceil(e.length/t),a=0;a<t;a++){var r=new n.ObservableCollection(e.slice(a*i,(a+1)*i));this.multiColumnAttributeContainer.addItem(r)}},l.prototype.processAttributes=function(e){for(var t=0;t<e.length;t++){e[t].name.get();var i=e[t].value.get();e[t].displayAsUrl=a.isUrl(i)}},l);function l(e,t){var i=s.call(this,e,t)||this;return i.attributeTypes={},i.MAX_COLUMNS=3,i.COLUMN_THRESHOLD=5,i._attributesChangedSubscriptionToken=null,i.attributes=new n.ObservableCollection([]),i.multiColumnAttributeContainer=new n.ObservableCollection([]),i}t.AttributesViewModel=o})},"Mapping/modules/FeatureDetails/FeatureDetailsProviders/DataLinksView":function(){var a,o=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewBase","geocortex/infrastructure/ui/components/Table/TableViewModel"],function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s,a=(s=i.ViewBase,o(r,s),r.prototype.attach=function(e){this.masterViewModel=e.masterViewModel,s.prototype.attach.call(this,e)},r.prototype.handleViewClick=function(e,t,i){for(var a=0;a<this.viewModel.dataLinks.length();a++){var r=this.viewModel.dataLinks.getAt(a);if(r===i){this.masterViewModel.currentDataLink.set(r);break}}this.masterViewModel.activateDataLinkDetailsView()},r.prototype.resolveWidget=function(e,t,i){var a=this;switch(s.prototype.resolveWidget.call(this,e,t),e){case"DataLinksTableViewWidget":if(this.tableView=this.app.viewManager.createView({typeName:"geocortex.essentialsHtmlViewer.mapping.infrastructure.ui.components.Table.TableView",markupResource:"Mapping/infrastructure/ui/components/Table/TableView.html",libraryId:"Mapping.Infrastructure",isVisible:!0}),this.tableView){var r=new n.TableViewModel(this.app,this.libraryId);r.recordClickEvent=function(e){return a.app.event("DataLinkTableItemClickedEvent").publish(e)},r.recordLongPressEvent=function(e){return a.app.event("DataLinkTableItemPressedEvent").publish(e)},r.syncRows(t.results),r.syncColumns(t.columnHeaders),this.tableView.attach(r)}return this.tableView;default:return null}},r.prototype.activated=function(){s.prototype.activated.call(this),this.tableView&&!this.tableView.isActive&&this.tableView.activated()},r.prototype.deactivated=function(){s.prototype.deactivated.call(this),this.tableView&&this.tableView.deactivated()},r.prototype.destroy=function(){this.tableView&&this.tableView.destroy(),s.prototype.destroy.call(this)},r);function r(){return null!==s&&s.apply(this,arguments)||this}t.DataLinksView=a})},"Mapping/modules/FeatureDetails/FeatureDetailsProviders/DataLinksViewModel":function(){var a,c=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/observables","geocortex/infrastructure/featureDetails/FeatureProviderBase","geocortex/framework/utils/utils","geocortex/framework-ui/LazyObservable","geocortex/infrastructure/FormatUtils","geocortex/essentials/Field"],function(e,t,l,i,n,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d,a=(d=i.FeatureProviderBase,c(r,d),r.prototype.initialize=function(e){d.prototype.initialize.call(this,e),e&&(e.dataLinkView||e.dataLinkDetailsView)&&(this.targetDataLinkDetailsRegion=e.dataLinkView||e.dataLinkDetailsView),this.hasDataLinks.bind(this,this.updateProviderState)},r.prototype.handleCurrentFeatureChanged=function(e){this.hasDataLinks.set(!1),this._destroyAttachedViews(),this.dataLinksList.clear(),this._featureDataLinkBindingToken&&this._prevFeatureDataLinkingResults&&this._prevFeatureDataLinkingResults.unbind(this._featureDataLinkBindingToken),this._prevFeatureDataLinkingResults=this._featureDataLinkBindingToken=null,this._prevFeatureDataLinkingResults=e.dataLinkingResults,this._featureDataLinkBindingToken=e.dataLinkingResults.bind(this,this.handleCollectionChanged),this._handleDataLinks(e.dataLinkingResults.get()),this._createAttachedViews()},r.prototype.activateDataLinkDetailsView=function(){if(this.targetDataLinkDetailsRegion){if(!this.currentDataLink.get())throw new Error("Cannot display data link details. Current datalink not set.");this.dataLinkView||(this.dataLinkView=this.app.viewManager.createView({markupResource:"Mapping/modules/FeatureDetails/FeatureDetailsProviders/DataLinkView.html",typeName:"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.DataLinkView",iconUri:"Resources/Images/Icons/Toolbar/file-multi-24.png",regionName:this.targetDataLinkDetailsRegion,isVisible:!1,libraryId:this.libraryId}),this.dataLinkView.attach(this)),this.dataLinkView.title.set(this.currentDataLink.get().displayName),this.app.viewManager.activateView(this.dataLinkView),this.app.command("FocusOnFirstInputInView").execute(this.dataLinkView)}},r.prototype.createAttachedViews=function(e,t,i){this._config=e,this._viewModeRegionConfig=t,this._onViewsCreated=i},r.prototype._createAttachedViews=function(i,a,r){var n=this;if(i=i||this._config,a=a||this._viewModeRegionConfig,r=r||this._onViewsCreated,i){var e=function(){n.dataLinksList.get().forEach(function(e){if(-1===n._addedDataLinks.indexOf(e.displayName)){var t=dojo.clone(i);t.title=e.displayName,t.viewId=n._generateDataLinksViewIdFromConfigViewId(t.viewId,t.title),d.prototype.createAttachedViews.call(n,t,a,function(e){n._datalinkViews=n._datalinkViews.concat(e),r&&r(e)},e),n._addedDataLinks.push(e.displayName)}})};e(),this._dataLinkListBindingTokens.push(this.dataLinksList.bind(this,function(){return e()}))}},r.prototype.handleCollectionChanged=function(e){if("append"===e.type){var t=e.sender.value.slice(e.rangeStart,e.rangeStart+1);this._handleDataLinks(t)}},r.prototype._generateDataLinksViewIdFromConfigViewId=function(e,t){var i=n.alphaNumericToken();return t=t?t+"-"+i:i,"{0} datalink-{1}".format(e||this.DEFAULT_VIEW_ID,t)},r.prototype._destroyAttachedViews=function(){var t=this;this._datalinkViews.forEach(function(e){t.app.viewManager.destroyView(e),delete e.viewModel}),this._dataLinkListBindingTokens.forEach(function(e){return t.dataLinksList.unbind(e)}),this._datalinkViews=[],this._addedDataLinks=[],this._dataLinkListBindingTokens=[]},r.prototype._handleDataLinks=function(e){for(var s=this,t=function(e){if(e.dataLink&&e.dataLink.get()&&!e.dataLink.get().isOneToOne){var t=e.table.get(),i=new l.ObservableCollection(t.rows.map(function(e){return{displayName:e.row[0],attributes:new l.ObservableCollection(s.toDict(t.columns,e.row))}})),a=new l.ObservableCollection(t.rows.map(function(e){return{attributes:new l.ObservableCollection(s._buildTableColumns(t.columns,e.row)),selected:e.selected,token:e.token}})),r=new l.ObservableCollection(o._buildTableColumnHeaders(t.columns,a.getAt(0))),n=new l.Observable(o.providerEnabled.get());n.sync(o.providerEnabled),o.dataLinksList.addItem({displayName:e.dataLink.get().displayName,dataLinks:i,results:a,columnHeaders:r,providerEnabled:n,masterViewModel:o}),o.hasDataLinks.get()||o.hasDataLinks.set(!0)}},o=this,i=0,a=e;i<a.length;i++)t(a[i])},r.prototype.toDict=function(e,t){for(var i=[],a=0;a<e.length;a++)i.push({name:e[a],value:t[a],presentableValue:o.format(t[a]),displayAsUrl:n.isUrl(t[a])});return i},r.prototype._buildTableColumns=function(a,r){return a.map(function(e,t){return{visible:new l.Observable(!0),value:new l.Observable(r[t]),name:new l.Observable(t.toString()),displayName:new l.Observable(a[t]),type:new l.Observable(u.EssentialsFieldTypes.essentialsFieldTypeString),presentableValue:(i=t,new s.LazyObservable(null,function(){return o.format(r[i])})),displayAsUrl:n.isUrl(r[t])};var i})},r.prototype._buildTableColumnHeaders=function(e,a){return e.map(function(e,t){var i=a.attributes.getAt(t);return{visible:new l.Observable(i.visible.get()),value:new l.Observable,name:new l.Observable(t.toString()),displayName:new l.Observable(e),type:new l.Observable(new l.Observable(i.value.get()instanceof Date?u.EssentialsFieldTypes.essentialsFieldTypeDate:u.EssentialsFieldTypes.essentialsFieldTypeString)),presentableValue:new l.Observable(""),displayAsUrl:!1}})},r);function r(e,t){var i=d.call(this,e,t)||this;return i.hasDataLinks=new l.Observable(!1),i.dataLinksList=new l.ObservableCollection([]),i.currentDataLink=new l.Observable(null),i.targetDataLinkDetailsRegion=null,i.DEFAULT_VIEW_ID="FeatureDataLinksProviderView",i.DEFAULT_PAGED=!0,i.DEFAULT_PAGE_SIZE=50,i.DATALINK_TABLE_ITEM_CLICKED_EVENT="DataLinkTableItemClickedEvent",i.DATALINK_TABLE_ITEM_PRESSED_EVENT="DataLinkTableItemPressedEvent",i._featureDataLinkBindingToken=null,i._datalinkViews=[],i._addedDataLinks=[],i._dataLinkListBindingTokens=[],i._config=null,i._viewModeRegionConfig=null,i._onViewsCreated=null,i}t.DataLinksViewModel=a})},"Mapping/modules/FeatureDetails/FeatureDetailsProviders/DataLinkView":function(){var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewBase"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=(a=i.ViewBase,s(n,a),n.prototype.handleClickDataLink=function(e,t,i){var a=i.value.get?i.value.get():i.value;return this.app.followNavigationLink({url:a,element:t})},n);function n(){return null!==a&&a.apply(this,arguments)||this}t.DataLinkView=r})},"Mapping/modules/FeatureDetails/FeatureDetailsProviders/DescriptionView":function(){var a,o=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewBase","geocortex/infrastructure/FeatureDescriptionPresenterView"],function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s,a=(s=i.ViewBase,o(r,s),r.prototype.attach=function(e){s.prototype.attach.call(this,e),this._featureChangedToken&&(this.app.event("FeatureChangedEvent").unsubscribe(this._featureChangedToken),this._featureChangedToken=null),this._featureEditedToken&&(this.app.event("FeatureEditedEvent").unsubscribe(this._featureEditedToken),this._featureEditedToken=null),this._featureChangedToken=this.app.event("FeatureChangedEvent").subscribe(this,this._handleFeatureChangedEvent),this._featureEditedToken=this.app.event("FeatureEditedEvent").subscribe(this,this._updateDescription),this._relatedRecordEditedToken=this.app.event("RelatedRecordEditedEvent").subscribe(this,this._handleRelatedRecordsEdited)},r.prototype.destroy=function(){s.prototype.destroy.call(this),this._featureChangedToken&&(this.app.event("FeatureChangedEvent").unsubscribe(this._featureChangedToken),this._featureChangedToken=null),this._featureEditedToken&&(this.app.event("FeatureEditedEvent").unsubscribe(this._featureEditedToken),this._featureEditedToken=null),this._relatedRecordEditedToken&&(this.app.event("RelatedRecordEditedEvent").unsubscribe(this._relatedRecordEditedToken),this._relatedRecordEditedToken=null),this._presenterView&&(this._presenterView.destroy(),this._presenterView=null)},r.prototype.resolveWidget=function(e,t,i){if(t&&"GetDescription"===e){var a=new n.FeatureDescriptionPresenterView(this.app,this.libraryId);a.contentField=this.viewModel.showLongDescription?"longDescription":"description",a.root=dojo.create("div");var r=document.createElement("img");return r.src="Resources/Images/loader-small.gif",r.setAttribute("style","margin-left: 40%"),a.root.appendChild(r),a.root.className="feature-description",a.attach(t),this._presenterView=a}return s.prototype.resolveWidget.call(this,e,t,i)},r.prototype._handleFeatureChangedEvent=function(e){this._presenterView&&e&&this.viewModel.currentFeature.get()&&this.viewModel.currentFeature.get().token===e.token&&this._updateDescription()},r.prototype._handleRelatedRecordsEdited=function(e){var t=this.viewModel.currentFeature.get(),i=t&&t.esriFeature.get(),a=i&&i.getLayer();t&&a&&i.attributes[a.objectIdField]===e.attributes[a.objectIdField]&&(dojo.mixin(i.attributes,e.attributes),t.esriFeature.pulse())},r.prototype._updateDescription=function(){this._presenterView.reattach(this.viewModel.currentFeature.get())},r);function r(){var e=null!==s&&s.apply(this,arguments)||this;return e._featureChangedToken=null,e._featureEditedToken=null,e._relatedRecordEditedToken=null,e._presenterView=null,e}t.DescriptionView=a})},"Mapping/modules/FeatureDetails/FeatureDetailsProviders/DescriptionViewModel":function(){var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/infrastructure/featureDetails/FeatureProviderBase"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=(a=i.FeatureProviderBase,s(n,a),n.prototype.initialize=function(e){a.prototype.initialize.call(this,e),e&&e.longDescription&&(this.showLongDescription=!0)},n.prototype.handleCurrentFeatureChanged=function(e){if(e.longDescription||e.description){var t=this.showLongDescription?e.longDescription.get():e.description.get();this.updateProviderState(!!t)}else this.app.trace.warning("Input must be a Feature")},n);function n(){var e=null!==a&&a.apply(this,arguments)||this;return e.showLongDescription=!1,e}t.DescriptionViewModel=r})},"Mapping/modules/FeatureDetails/FeatureDetailsProviders/FeatureActionsView":function(){var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/infrastructure/menus/MenuView"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a=(n=i.MenuView,s(r,n),r.prototype.attach=function(a){var r=this;n.prototype.attach.call(this,a),this.viewModel.menuContext.sync(a.currentFeature),this.viewModel.visibleMenuItems.bind(this,function(e){var t=r.viewModel.visibleMenuItems.length();if("clear"===e.type)t=0;else if("remove"===e.type){var i=e.sender.get().slice(0);i.splice(e.rangeStart,e.rangeEnd-e.rangeStart+1),t=i.length}a.updateProviderState(!!t)})},r);function r(){return null!==n&&n.apply(this,arguments)||this}t.FeatureActionsView=a})},"Mapping/modules/FeatureDetails/FeatureDetailsProviders/FeatureActionsViewModel":function(){var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/infrastructure/featureDetails/FeatureProviderBase"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=(a=i.FeatureProviderBase,s(n,a),n);function n(){return null!==a&&a.apply(this,arguments)||this}t.FeatureActionsViewModel=r})},"Mapping/modules/FeatureDetails/FeatureDetailsProviders/Hyperlink":function(){define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function i(e,t,i){var a=this;if(void 0===i&&(i=!1),this.text=null,this.uri=null,this.iconUri=null,this.target=null,this.toolTip=null,this.isBroken=!1,this.awaitPromise=Promise.resolve(),t){this.currentFeature=t;var r=[];if(i){if(e){if(e.text){var n=this.currentFeature.formatTemplateStringAsync(e.text);r.push(n),n.then(function(e){return a.text=String.unescapeHtml(e)})}else{if(!e.uri)return;n=this.currentFeature.formatTemplateStringAsync(e.uri),r.push(n),n.then(function(e){return a.text=String.unescapeHtml(e)})}e.uri&&(n=this.currentFeature.formatTemplateStringAsync(e.uri),r.push(n),n.then(function(e){return a.uri=String.unescapeHtml(e)})),e.iconUri&&(this.iconUri=e.iconUri),e.target&&(this.target=e.target),e.toolTip&&(n=this.currentFeature.formatTemplateStringAsync(e.toolTip),r.push(n),n.then(function(e){return a.toolTip=String.unescapeHtml(e)}))}0<r.length&&(this.awaitPromise=Promise.all(r))}else if(e){if(e.text)this.text=this.currentFeature.formatTemplateString(e.text),this.text=String.unescapeHtml(this.text);else{if(!e.uri)return;this.text=this.currentFeature.formatTemplateString(e.uri),this.text=String.unescapeHtml(this.text)}e.uri&&(this.uri=this.currentFeature.formatTemplateString(e.uri),this.uri=String.unescapeHtml(this.uri)),e.iconUri&&(this.iconUri=e.iconUri),e.target&&(this.target=e.target),e.toolTip&&(this.toolTip=this.currentFeature.formatTemplateString(e.toolTip),this.toolTip=String.unescapeHtml(this.toolTip))}}}t.Hyperlink=i})},"Mapping/modules/FeatureDetails/FeatureDetailsProviders/HyperlinksView":function(){var a,s=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewBase"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=(a=i.ViewBase,s(n,a),n.prototype.handleClickHyperlink=function(e,t,i){return!i.isBroken&&this.app.followNavigationLink({url:i.uri,element:t})},n);function n(){return null!==a&&a.apply(this,arguments)||this}t.HyperlinksView=r})},"Mapping/modules/FeatureDetails/FeatureDetailsProviders/HyperlinksViewModel":function(){var a,o=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/infrastructure/featureDetails/FeatureProviderBase","geocortex/framework/observables","geocortex/config"],function(e,t,i,a,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=i.FeatureProviderBase,o(s,r),s.prototype.handleCurrentFeatureChanged=function(a){var r=this;if(this.hyperlinks.set(null),a&&a.hyperlinks){var e=dojo.getObject("geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.Hyperlink");if(e){var n=[];this._numHyperlinksChecked=0,this._numHyperlinksTotal=a.hyperlinks.getLength(),0!==a.hyperlinks.getLength()&&this.updateProviderState(!0);for(var t=0;t<this._numHyperlinksTotal;t++){var i=new e(a.hyperlinks.getAt(t),a,!0);n.push(i)}var s=n.map(function(e){return e.awaitPromise});Promise.all(s).then(function(){for(var e=0,t=n;e<t.length;e++){var i=t[e];a.layer&&"ShowAll"!==a.layer.showFeatureHyperlinks&&r._testHyperlink(i,n,"HEAD")}a.layer&&"ShowAll"===a.layer.showFeatureHyperlinks&&r._showHyperlinks(n)})}else this.hyperlinks.addItems(a.hyperlinks.get())}},s.prototype._testHyperlink=function(r,n,s){function o(){l._numHyperlinksChecked++,l._numHyperlinksChecked===l._numHyperlinksTotal&&l._showHyperlinks(n)}var l=this;if(!r.uri)return r.isBroken=!0,void o();if(r.uri&&r.uri.length>u.config.io.postLength-500)return this.app.trace.warning("Unable to test hyperlink with URI '{0}...'. The URI was too long.".format(r.uri.substr(0,100))),void o();var e={type:s,cache:!0,url:r.uri};"GET"===s&&(e.headers={"If-Match":"LatitudeGeographics"}),e.success=function(e,t,i){o()},e.error=function(e,t,i){var a=e.status;"HEAD"!==s||405!==a&&0!==a?(r.isBroken=400<=a&&412!==a,o()):l._testHyperlink(r,n,"GET")},$.ajax(e)},s.prototype._showHyperlinks=function(e){for(var t=this.currentFeature.get(),i=t&&t.layer?t.layer.showFeatureHyperlinks:null,a=0,r=e;a<r.length;a++){var n=r[a];if(null!=n.uri&&""!==n.uri){if(i&&"HideBrokenLinks"===i&&n.isBroken)continue;this.hyperlinks.addItem(n)}}0===this.hyperlinks.getLength()&&this.updateProviderState(!1)},s);function s(e,t){var i=r.call(this,e,t)||this;return i._numHyperlinksChecked=0,i._numHyperlinksTotal=0,i.hyperlinks=new a.ObservableCollection,i}t.HyperlinksViewModel=n})},"Mapping/modules/FeatureDetails/FeatureDetailsProviders/RelatedFeaturesView":function(){var a,l=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewBase","geocortex/infrastructure/ui/components/Table/TableViewModel","geocortex/framework/utils/utils"],function(e,t,i,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s,a=(s=i.ViewBase,l(r,s),r.prototype.attach=function(e){this.masterViewModel=e.masterViewModel,s.prototype.attach.call(this,e),this.masterViewModel._viewContainerViewClosedEventBindingToken||(this.masterViewModel._viewContainerViewClosedEventBindingToken=this.app.event("ViewContainerViewClosedEvent").subscribe(this,this._checkIfEventIsRelevant))},r.prototype.activated=function(){s.prototype.activated.call(this),this.tableView&&!this.tableView.isActive&&this.tableView.activated()},r.prototype.deactivated=function(){s.prototype.deactivated.call(this),this.tableView&&this.tableView.deactivated()},r.prototype.destroy=function(){this.tableView&&this.tableView.destroy(),this.masterViewModel._viewContainerViewClosedEventBindingToken&&0===this.masterViewModel.relatedFeatureViews.length&&(this.app.event("ViewContainerViewClosedEvent").unsubscribe(this.masterViewModel._viewContainerViewClosedEventBindingToken),this.masterViewModel._viewContainerViewClosedEventBindingToken=null),s.prototype.destroy.call(this)},r.prototype.resolveWidget=function(e,t,i){var a=this;switch(s.prototype.resolveWidget.call(this,e,t),e){case"RelatedFeaturesTableViewWidget":if(this.tableView=this.app.viewManager.createView({typeName:"geocortex.essentialsHtmlViewer.mapping.infrastructure.ui.components.Table.TableView",markupResource:"Mapping/infrastructure/ui/components/Table/TableView.html",libraryId:"Mapping.Infrastructure",isVisible:!0}),this.tableView){var r=new n.TableViewModel(this.app,this.libraryId);r.recordClickEvent=function(e){return a.app.event("RelatedFeatureTableItemClickedEvent").publish(e)},r.recordLongPressEvent=function(e){return a.app.event("RelatedFeatureTableItemPressedEvent").publish(e)},r.syncRows(t.results),r.syncColumns(t.columnHeaders),this.tableView.attach(r)}return this.tableView;default:return null}},r.prototype.handleViewClick=function(e,t,i){if(i&&i.attributes&&0<i.attributes.getLength())for(var a=0,r=i.attributes.get();a<r.length;a++){var n=r[a],s=n.value.get();n.displayAsUrl=o.isUrl(s)}this.isBusy.set(!0),this.masterViewModel.activateRelatedFeatureView(i)},r.prototype.handleClickAddRelatedRecord=function(e,t,i){var a=this;if(!i)return!1;if(i.editable&&!i.editable.get())return!1;var r=this.masterViewModel;r&&r.generateRelatedLayerObject(i,function(e){a.app.command("StartEditingNewRelatedRecord").execute(e,!0)})},r.prototype._checkIfEventIsRelevant=function(e){(e.backButtonClicked||e.xButtonClicked)&&this.masterViewModel.showParentView()},r);function r(){return null!==s&&s.apply(this,arguments)||this}t.RelatedFeaturesView=a})},"Mapping/modules/FeatureDetails/FeatureDetailsProviders/RelatedFeaturesViewModel":function(){var a,u=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","./RelatedFeaturesViewModelBase","geocortex/framework/observables","geocortex/essentials/Layer","geocortex/infrastructure/TaskUtils","geocortex/essentials/utilities/LayerUtilities","geocortex/infrastructure/FeatureSet","geocortex/infrastructure/LayerIntegrationUtils"],function(e,t,i,o,b,a,v,r,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,s=(n=i.RelatedFeaturesViewModelBase,u(l,n),l.prototype.initialize=function(e){var t=this;n.prototype.initialize.call(this,e),this.app.nativeManager.hasNativeCapability("editing").then(function(e){t._canEditOffline=e})},l.prototype.handleCurrentFeatureChanged=function(r){var n=this;if(!r)throw new Error("Feature cannot be null for the related features view model");this._destroyAttachedViews(),this.hasRelationships.set(!1),this.relationList.clear(),this._allRelatedFeatureInfo=[],this.relatedLayers=new o.ObservableCollection([]),this._relatedLayerPromises&&(this._relatedLayerPromises.cancel(),this._relatedLayerPromises=null);var e=[],s=this.currentFeature.get().layer||this.currentFeature.get().featureLayer;if(s&&s.relationships){for(var t=function(i){s instanceof b.Layer&&e.push(new Promise(function(e,t){return s.getRelatedFeatureLayer(i.id,e,t)}))},i=0,a=s.relationships;i<a.length;i++)t(a[i]);this._relatedLayerPromises=Promise.all(e),this._relatedLayerPromises.then(function(e){if(n._relatedLayerPromises=null,n.relatedLayers.addItems(e),r.hasVisibleRelationships.get()&&s&&s.relationships&&n.app.site.getFeatureServices()){n.hasRelationships.set(!0);for(var t=function(a){a.visible&&function(){var e=new o.Observable(n.providerEnabled.get()),t=new o.ObservableCollection([]);e.sync(n.providerEnabled);var i={displayName:new o.Observable(a.displayName||a.name),id:new o.Observable(a.id),relatedTableId:new o.Observable(a.relatedTableId),visible:new o.Observable(a.visible),relatedEsriFeatureInfo:new o.ObservableCollection([]),relatedGcxFeatures:t,hasRetrievedData:new o.Observable(!1),noRelatedFeatures:new o.Observable(!1),canAdd:new o.Observable(!0),validCardinality:new o.Observable(!0),errorFetchingRelatedFeatures:new o.Observable(!1),results:t,columnHeaders:new o.ObservableCollection([]),providerEnabled:e,masterViewModel:n};i.relatedEsriFeatureInfo.bind(n,function(e){n._generateGCXFeaturesFromRelatedFeatureInfos(e.sender.getRange(e.rangeStart,e.rangeEnd))}),n.relationList.addItem(i)}()},i=0,a=s.relationships;i<a.length;i++)t(a[i]);n._fetchRelatedFeatures()}n._createAttachedViews(),n._updateProviderState(),null==n.parentFeature.get()&&n.parentFeature.set(n.currentFeature.get())})}},l.prototype._generateGCXFeaturesFromRelatedFeatureInfos=function(e){for(var t=0,i=e;t<i.length;t++){var a=i[t];this._generateRelatedGCXFeature(a)}},l.prototype._generateRelatedGCXFeature=function(t){var e={featureInfo:t,esriFeature:null,gcxFeature:null,layer:null},a={};t.attributes.get().forEach(function(e){var t=e.name.get(),i=e.value.get();a[t]=i});var i=new esri.Graphic;i.setAttributes(a);var r=this.currentFeature.get().layer||this.currentFeature.get().featureLayer,n=null;r.relationships.forEach(function(e){(e.name?e.name:e.displayName)===t.relationName.get()&&(n=e.relatedTableId)});for(var s=null,o=0;o<this.relatedLayers.getLength();o++){var l=this.relatedLayers.getAt(o);l.layerId===n&&(s=l)}if(s)null!=n&&(s.add(i),e.layer=s,e.esriFeature=i,this._checkRelatedFeature(e));else{for(var u=new RegExp("/[^/]*.$"),d=t.featureUrl.replace(u,""),c=0,p=this.app.site.getFeatureServices();c<p.length;c++){var h=p[c];d===this._getProperMapServiceUrlForComparison(h,d)&&(s=h.serviceLayer)}e.layer=s,e.esriFeature=i,this._checkRelatedFeature(e)}},l.prototype.generateRelatedLayerObject=function(t,i){var a=this,r=null,n=null;try{this._getFeatureLayerForCurrentFeature(t,function(e){e.relationships.forEach(function(e){e.id===t.id.get()&&e.relatedTableId===t.relatedTableId.get()&&(n=e)}),r={id:t.id.get(),text:"New "+t.displayName.get(),relatedFeature:a.currentFeature.get().esriFeature.get(),essentialsRelatedFeature:a.currentFeature.get(),feature:null,editable:!0,relationship:n},i(r)})}catch(e){this.app.trace.error("Error in generating related layer object for creation: "+e)}},l.prototype._getFeatureLayerForCurrentFeature=function(e,t){var i=this.currentFeature.get().esriFeature.get().getLayer();if(i)t(i);else{if(!i&&"Table"!==this.currentFeature.get().layer.type)return this.app.command("GetFeatureDetailsProviders").execute(this.currentFeature.get()),i=(i=this.currentFeature.get().esriFeature.get().getLayer())||this.currentFeature.get().layer.mapService.layers[0],void t(i);if(!i)for(var a=0,r=this.app.site.getFeatureServices();a<r.length;a++)for(var n=r[a],s=0,o=n.layers;s<o.length;s++)o[s].id===e.relatedTableId.get()&&n.getRelatedFeatureLayer(e.id.get(),function(e){t(i=e)},function(e){})}},l.prototype._relatedRecordCreated=function(e){this.handleCurrentFeatureChanged(this.currentFeature.get())},l.prototype._relatedRecordEdited=function(e){e.attributes.Date&&(e.attributes.Date=this._formatDate(e.attributes.Date));var t=this.currentFeature.get().esriFeature.get().attributes;for(var i in t)e.attributes[i]&&(t[i]=e.attributes[i]);this.currentFeature.get().loadAttributes(!0)},l.prototype._fetchRelatedFeatures=function(){var g=this,t=this.currentFeature.get(),e=this.currentFeature.get().layer||this.currentFeature.get().featureLayer;if(t&&e&&this.relationList&&0<this.relationList.length()){var b=t.layer?t.layer:t.featureLayer;if(b){var i=void 0;for(i=0;i<this.relationList.length();i++)!function(h){h.id.get();var e=new esri.tasks.RelationshipQuery;e.outFields=["*"],e.relationshipId=h.id.get(),null!=t.getPrimaryKeyValue()?e.objectIds=[t.getPrimaryKeyValue()]:e.objectIds=[t.esriFeature.get().attributes.OBJECTID],a.getQueryTask(b).executeRelationshipQuery(e).then(function(s){var e=!1;for(var t in s)if(s.hasOwnProperty(t)){e=!0;break}if(!e)return g._setCanAddNewFeature(b,h),h.noRelatedFeatures.set(!0),void h.hasRetrievedData.set(!0);var i=f.getRelatedFeatureLayer(b,h.id.get(),h.relatedTableId.get(),g.app);if(!i){for(var a=null,r=0,n=g.app.site.getFeatureServices();r<n.length;r++){var o=n[r];if(o.serviceLayer.layerId===h.relatedTableId.get()){a=o.serviceLayer;break}}for(var l in s)if(s.hasOwnProperty(l)){g._resolveDatalinksAfterFeaturesResolved(h,s[l].features.length);for(var u=0,d=s[l].features;u<d.length;u++){var c=d[u],p=g._processRelatedFeature(a,c,h);h.relatedEsriFeatureInfo.addItem(p),a.hasAttachments&&setTimeout(function(e,t){return function(){return t._loadAttachments(e)}}(p,g),100)}}return g._setCanAddNewFeature(b,h),void h.hasRetrievedData.set(!0)}i.then(function(e){if(e.message)return g._setCanAddNewFeature(b,h),h.noRelatedFeatures.set(!0),void h.hasRetrievedData.set(!0);for(var t in s)if(s.hasOwnProperty(t)){g._resolveDatalinksAfterFeaturesResolved(h,s[t].features.length);for(var i=0,a=s[t].features;i<a.length;i++){var r=a[i],n=g._processRelatedFeature(e,r,h);h.relatedEsriFeatureInfo.addItem(n),e.hasAttachments&&setTimeout(function(e,t){return function(){return t._loadAttachments(e)}}(n,g),100)}}g._setCanAddNewFeature(b,h),h.hasRetrievedData.set(!0)},function(e){h.errorFetchingRelatedFeatures.set(!0),h.hasRetrievedData.set(!0),g.app.trace.error("Error getting related record for layer {0}: {1}.".format(b.displayName,e.message))})},function(e){h.errorFetchingRelatedFeatures.set(!0),h.hasRetrievedData.set(!0),g.app.trace.error("Error getting related record for layer {0}: {1}.".format(b.displayName,e.message))})}(this.relationList.getAt(i))}}},l.prototype._setCanAddNewFeature=function(e,t){var i=null,a=null;if(t.canAdd.set(!0),t.validCardinality.set(!0),e instanceof b.Layer?((i=e).mapService,i.mapService.serviceLayer instanceof esri.layers.FeatureLayer&&(a=i.mapService.serviceLayer)):e instanceof esri.layers.FeatureLayer&&(a=e),!a)return this.app.trace.debug("Attempted to see if related feature could be created but layer is not a Essentials Layer or Esri FeatureLayer."),t.canAdd.set(!1),void t.validCardinality.set(!1);if(a){var r=a.relationships,n=null;if(r&&r.length)for(var s=0,o=r;s<o.length;s++){var l=o[s];l.id===t.id.get()&&(n=l)}if(n){"esriRelCardinalityOneToOne"===n.cardinality&&"esriRelRoleOrigin"===n.role&&0<t.relatedEsriFeatureInfo.get().length&&t.validCardinality.set(!1);for(var u=0,d=this.app.site.essentialsMap.mapServices;u<d.length;u++){var c=d[u].serviceLayer;if(c instanceof esri.layers.FeatureLayer){var p=c;p.layerId===t.relatedTableId.get()&&!1===p.getEditCapabilities().canCreate&&t.canAdd.set(!1)}}var h=v.LayerUtilities.decomposeFeatureLayerUrl(a.url).serviceUrl+"/"+t.relatedTableId.get();if(this.app.offlineManager.isOfflineMapActive.get()){var g=this.app.offlineManager.syncInfo.findLayerOrTable(h);this._canEditOffline&&g&&g.canEdit||t.canAdd.set(!1)}}}},l.prototype._resolveDatalinksAfterFeaturesResolved=function(i,e){if(i&&!(e<1)){var t=function(){var e=i.relatedGcxFeatures.getAt(0).layer;if(e){var t=new r.FeatureSet;t.features.set(i.relatedGcxFeatures.get()),t.layer=e,t.esriFeatureSet=new esri.tasks.FeatureSet,t.esriFeatureSet.features=i.relatedGcxFeatures.get().map(function(e){return e.esriFeature.get()}),t.resolveDataLinks()}};if(i.relatedGcxFeatures.length()===e)t();else var a=i.relatedGcxFeatures.bind(this,function(){i.relatedGcxFeatures.length()===e&&(i.relatedGcxFeatures.unbind(a),a=null,t())})}},l);function l(e,t){var i=n.call(this,e,t)||this;return i._canEditOffline=!1,i.app.event("RelatedRecordCreatedEvent").subscribe(i,i._relatedRecordCreated),i.app.event("RelatedRecordEditedEvent").subscribe(i,i._relatedRecordEdited),i}t.RelatedFeaturesViewModel=s})},"Mapping/modules/FeatureDetails/FeatureDetailsProviders/RelatedFeaturesViewModelBase":function(){var a,w=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/observables","geocortex/infrastructure/Feature","geocortex/framework-ui/PresentableCollection","geocortex/infrastructure/featureDetails/FeatureProviderBase","geocortex/framework/utils/utils","geocortex/essentials/utilities/TimeZoneUtils","geocortex/framework/utils/ArrayUtils","geocortex/infrastructure/FormatUtils","geocortex/infrastructure/gis/FieldInfo","geocortex/infrastructure/AttachmentInfo","geocortex/essentials/LayerType","geocortex/infrastructure/MapUtils","geocortex/infrastructure/TaskUtils","geocortex/essentials/RestHelperHTTPService"],function(e,t,l,u,i,a,r,d,c,n,p,o,h,g,b,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v,f=(v=a.FeatureProviderBase,w(m,v),m.prototype.createAttachedViews=function(e,t,i,a){this._config=e,this._viewModeRegionConfig=t,this._onViewsCreated=i},m.prototype.createAttachedViewsSuper=function(e,t,i,a){v.prototype.createAttachedViews.call(this,e,t,i,a)},m.prototype.activateRelatedFeatureView=function(e){var t;if(t=e instanceof u.Feature?this._getFeatureInfoFromFeature(e):e)for(var i=0,a=this._allRelatedFeatureInfo;i<a.length;i++){var r=a[i],n=r.featureInfo;if(t.id.get()===n.id.get()){if(t.layer&&n.layer&&t.layer!==n.layer&&t.layer.layerId!==n.layer.layerId)continue;this._displayGeocortexFeatureDetails(r.gcxFeature);break}}},m.prototype.showParentView=function(){this.relatedFeatures.getLength()<1?this.parentFeature.get()&&this.parentFeature.set(null):(this.relatedFeatures.removeItem(this.currentFeature.get()),0!==this.relatedFeatures.getLength()?this.app.command("ShowFeatureDetails").execute(this.relatedFeatures.getAt(this.relatedFeatures.length()-1)):this.app.command("ShowFeatureDetails").execute(this.parentFeature.get()))},m.prototype._generateRelatedFeaturesViewIdFromConfigViewId=function(e,t){var i=r.alphaNumericToken();return t=t?t+"-"+i:i,"{0} relatedfeatures-{1}".format(e||this.DEFAULT_VIEW_ID,t)},m.prototype._createConfiguredPresentableResultCollection=function(e){var t=new i.PresentableCollection(e);return t.pageSize.set(this.DEFAULT_PAGE_SIZE),this.DEFAULT_PAGED!==t.isPaginated.get()&&t.isPaginated.set(this.DEFAULT_PAGED),t.items.useThrottling=!0,t.sortingPredicate=null,t},m.prototype._createColumnHeaderItems=function(e){var t=[],i=e.get();if(i.length)for(var a=0,r=i[0].attributes.get();a<r.length;a++){var n=r[a];t.push(n)}return t},m.prototype._getFeatureInfoFromFeature=function(e){for(var t=0,i=this._allRelatedFeatureInfo;t<i.length;t++){var a=i[t];if(a.gcxFeature===e)return a.featureInfo}return null},m.prototype._getFeatureFromFeatureInfo=function(e){for(var t=0,i=this._allRelatedFeatureInfo;t<i.length;t++){var a=i[t];if(a.featureInfo===e)return a.gcxFeature}return null},m.prototype._displayGeocortexFeatureDetails=function(e){this._addFeatureToBucket(e),this.app.command("ShowFeatureDetails").execute(e)},m.prototype._addFeatureToBucket=function(e){e!==this.relatedFeatures.getAt(this.relatedFeatures.getLength())&&this.relatedFeatures.addItem(e)},m.prototype._destroyAttachedViews=function(){for(var t=this,e=this.relatedFeatureViews.length-1;0<=e;e--){var i=this.relatedFeatureViews[e];this.relatedFeatureViews.splice(e,1),this.app.viewManager.destroyView(i),delete i.viewModel}this._relatedFeatureListBindingTokens.forEach(function(e){return t.relationList.unbind(e)}),this._addedRelatedFeatures=[],this._relatedFeatureListBindingTokens=[]},m.prototype._getRelationshipObjectFromFeatureInfo=function(e){for(var t=null,i=0;i<this.relationList.length();i++){t=this.relationList.getAt(i);for(var a=0;a<t.relatedEsriFeatureInfo.length();a++)if(e===t.relatedEsriFeatureInfo.getAt(a))return t}return t},m.prototype._processGeneratedGCXFeature=function(e){this._allRelatedFeatureInfo.push(e);var t=this._getRelationshipObjectFromFeatureInfo(e.featureInfo);t&&(t.relatedGcxFeatures.addItem(e.gcxFeature),t.columnHeaders.length()||t.columnHeaders.addItems(this._createColumnHeaderItems(t.results)))},m.prototype._generateGeocortexFeature=function(e,t,i){var a=d.getTimeZoneFromLayer(t),r=null;this.parentFeature.get()&&this.parentFeature.get().layer&&(r=d.getDisplayTimeZoneFromMapService(this.parentFeature.get().layer.mapService),a=a||d.getTimeZoneFromMapService(this.parentFeature.get().layer.mapService));var n=new u.Feature({graphic:e,layer:t,featureLayer:i,timeZoneId:a,displayTimeZoneId:r});if(n.loadAttributes(!0),t)n.defaultNumberFormat=c.firstOrDefault([t.defaultNumberFormat,t.mapService.defaultNumberFormat],function(e){return!!e}),n.defaultDateFormat=c.firstOrDefault([t.defaultDateFormat,t.mapService.defaultDateFormat],function(e){return!!e});else if(this.parentFeature.get()){var s=this.parentFeature.get().layer;s&&(n.defaultNumberFormat=s.mapService.defaultNumberFormat,n.defaultDateFormat=s.mapService.defaultDateFormat)}if(i&&!t&&0<i.relationships.length){n.hasVisibleRelationships.set(!0);for(var o=0,l=i.relationships;o<l.length;o++)l[o].visible=!0}return n},m.prototype._makeAttributesObservable=function(e,t){var i=new l.ObservableCollection;if(e)for(var a in e)if(e.hasOwnProperty(a)){var r=e[a];i.addItem({name:new l.Observable(a),value:new l.Observable(r)})}return i},m.prototype._formatDate=function(e){return n.formatDate(n.parseDate(e))},m.prototype._cleanup=function(){this.parentFeature.set(null),this.relatedFeatures.clear()},m.prototype._processRelatedFeature=function(e,t,i){var a=new l.ObservableCollection,r=t.attributes[e.displayField];if(e.getField&&r){var n=p.FieldInfo.fromEsriField(e.getField(e.displayField),e);if(n.isCodedValueDomain()||n.hasSubtypeCodedValueDomains()){var s=t.attributes[e.typeIdField];r=n.resolveCodedDomainValue(r,s)}else"esriFieldTypeDate"===n.type&&(r=this._formatDate(r))}r=r||t.attributes[e.objectIdField];var o=e.objectIdField;return{id:new l.Observable(t.attributes[o]),displayName:new l.Observable(r),relationName:new l.Observable(i.displayName.get()),layer:e,featureUrl:e.url+"/"+t.attributes[e.objectIdField],attributes:this._makeAttributesObservable(t.attributes,e),geometry:new l.Observable(t.geometry),hasAttachments:new l.Observable(!1),attachmentInfos:a}},m.prototype._loadAttachments=function(n){var t=this,s=n.featureUrl+"/attachments",e={url:s+"?f=json&ts="+(new Date).getTime(),handleAs:"json"};(n.layer instanceof esri.layers.FeatureLayer&&n.layer.url?n.layer.queryAttachmentInfos(parseInt(n.id.get(),10)):esri.request(e)).then(function(e){if(0<e.length&&!e.attachmentInfos&&e instanceof Array){e.attachmentInfos=[];for(var t=0;t<e.length;t++)e.attachmentInfos[t]=e[t]}if(e&&e.attachmentInfos&&0<e.attachmentInfos.length){var i=void 0;for(i=0;i<e.attachmentInfos.length;i++){var a=e.attachmentInfos[i],r=new o.AttachmentInfo;r.id.set(a.id),r.contentType.set(a.contentType),r.size.set(a.size),r.name.set(a.name),r.url.set(s+"/"+a.id),n.attachmentInfos.addItem(r)}n.hasAttachments.set(!0)}},function(e){t.app.trace.error("Unable to retrieve attachment information for related feature '"+n.featureUrl+"': "+e.message)})},m.prototype._updateProviderState=function(){var t,i=this,a=!1;function r(e){(e.canAdd.get()||!e.errorFetchingRelatedFeatures.get()&&e.relatedEsriFeatureInfo.length())&&(a=!0),i.updateProviderState(a)}if(this.updateProviderState(a),this.relationList.length())for(var e=0;e<this.relationList.length();e++)t=e,function(){if(!a){var e=i.relationList.getAt(t);e.hasRetrievedData.get()?r(e):e.hasRetrievedData.once(i,function(){return r(e)})}}()},m.prototype._createAttachedViews=function(i,a,r){var n=this;if(i=i||this._config,r=r||this._onViewsCreated,a=a||this._viewModeRegionConfig,i){var e=function(){n.relationList.get().forEach(function(e){if(-1===n._addedRelatedFeatures.indexOf(e.displayName.get())){var t=dojo.clone(i);t.title=e.displayName.get(),t.viewId=n._generateRelatedFeaturesViewIdFromConfigViewId(t.viewId,e.displayName.get()),v.prototype.createAttachedViews.call(n,t,a,function(e){n.relatedFeatureViews=n.relatedFeatureViews.concat(e),r&&r(e)},e),n._addedRelatedFeatures.push(e.displayName.get())}})};e(),this._relatedFeatureListBindingTokens.push(this.relationList.bind(this,function(){return e()}))}},m.prototype._checkRelatedFeature=function(i){var a=this;if(i){var e=i.layer,r=i.esriFeature,n=null;if(e&&((n=this._findGeocortexLayer(e,this.app.site))||this.app.trace.debug("Could not find related layer in site. Related features will not be editable and will not contain spatial information.")),!r.geometry&&n&&n.mapService&&n.mapService.serviceLayer&&n.type!==h.LayerType.TABLE_LAYER){var t=null,s=n.mapService.serviceLayer;if(s instanceof esri.layers.FeatureLayer&&(t=g.findFeatureInMap(r,this.app.site,s)),t&&t!==r)i.gcxFeature=this._generateGeocortexFeature(t,n,s),this._processGeneratedGCXFeature(i);else{var o=new esri.tasks.Query;if(o.objectIds=[r.attributes[n.getObjectIdFieldName()]],o.outFields=["*"],o.returnGeometry=!0,s instanceof esri.layers.FeatureLayer)s.queryFeatures(o,function(e){e.features&&(r=e.features[0],i.gcxFeature=a._generateGeocortexFeature(r,n,s),a._processGeneratedGCXFeature(i))},function(e){a.app.trace.error("There was an error in retrieving the related feature: "+e)});else{n.mapService.serviceUrl.split("?");var l=b.getQueryTask(n);n.getFeatureLayer().then(function(t){l.execute(o,function(e){e.features&&(r=e.features[0],i.gcxFeature=a._generateGeocortexFeature(r,n,t),a._processGeneratedGCXFeature(i))},function(e){a.app.trace.error("There was an error in retrieving the related feature: "+e)})}).catch(function(e){a.app.trace.error("There was an error in returning the feature layer: "+e)})}}}else i.gcxFeature=this._generateGeocortexFeature(r,n,e),this._processGeneratedGCXFeature(i)}},m.prototype._findGeocortexLayer=function(e,t){if(e&&t&&t.essentialsMap)return t.essentialsMap.findLayerFromMatchingEsriFeatureLayer(e)},m.prototype._getProperMapServiceUrlForComparison=function(e,t){var i=e.serviceUrl;return e.serviceToken&&0<t.search(/token=.[^&]*/g)&&(i=s.RestHelperHTTPService.appendTokenToUrl(i,e.serviceToken)),i},m);function m(e,t){var i=v.call(this,e,t)||this;return i.DEFAULT_VIEW_ID="FeatureRelationsProviderView",i.DEFAULT_PAGED=!0,i.DEFAULT_PAGE_SIZE=50,i.REL_FEATURES_TABLE_ITEM_CLICKED_EVENT="RelatedFeatureTableItemClickedEvent",i.REL_FEATURES_TABLE_ITEM_PRESSED_EVENT="RelatedFeatureTableItemPressedEvent",i.hasRelationships=new l.Observable(!1),i.relationList=new l.ObservableCollection([]),i.parentFeature=new l.Observable(null),i.relatedLayers=new l.ObservableCollection([]),i.relatedFeatures=new l.ObservableCollection,i.relatedFeatureViews=[],i._viewContainerViewClosedEventBindingToken=null,i._config=null,i._viewModeRegionConfig=null,i._onViewsCreated=null,i._allRelatedFeatureInfo=[],i._addedRelatedFeatures=[],i._relatedFeatureListBindingTokens=[],i._relatedLayerPromises=null,i.app.command("ShowFeatureParentDetails").register(i,i.showParentView),i.app.command("ClearFeatureInformation").register(i,i._cleanup),i.app.event(i.REL_FEATURES_TABLE_ITEM_CLICKED_EVENT).subscribe(i,i.activateRelatedFeatureView),i}t.RelatedFeaturesViewModelBase=f})},"Mapping/modules/FeatureDetails/FeatureDetailsProviders/SearchTablesRelatedFeaturesViewModel":function(){var a,o=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","./RelatedFeaturesViewModelBase","geocortex/essentials/Layer","geocortex/infrastructure/Feature","geocortex/infrastructure/FilterUtils","geocortex/framework/observables","geocortex/infrastructure/gis/FieldInfo","geocortex/infrastructure/TaskUtils","geocortex/infrastructure/FeatureSet"],function(e,t,i,b,a,v,f,m,w,F){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=i.RelatedFeaturesViewModelBase,o(s,n),s.prototype.activateRelatedFeatureView=function(e){e instanceof a.Feature||(e=this._getFeatureFromFeatureInfo(e));var t=this.parentFeature.get();t&&e&&e instanceof a.Feature&&t.getExtendedPropertyByName(this.SEARCH_TABLE_ID_KEY)===e.getExtendedPropertyByName(this.SEARCH_TABLE_ID_KEY)?this.showParentView():n.prototype.activateRelatedFeatureView.call(this,e)},s.prototype.handleCurrentFeatureChanged=function(l){var u=this;if(!l)throw new Error("Feature cannot be null for the related features view model");this._destroyAttachedViews(),this.hasRelationships.set(!1),this.relationList.clear(),this._allRelatedFeatureInfo=[],this.datalinkSearches=[],this.currentSearchTable=null,this._featureLayers={},this._allLayers=[],this._relatedLayerPromises&&(this._relatedLayerPromises.cancel(),this._relatedLayerPromises=null);var a,e=l.getExtendedPropertyByName(this.SEARCHTABLE_KEY);if(e){var t=e.getExtendedPropertyByName(this.SEARCH_TABLE_ID_KEY),i=this._getSearchTable(t);if(i){var r=new f.Observable(this.providerEnabled.get()),n=new f.ObservableCollection([]),s=e.esriFeature.get(),o={id:new f.Observable("Parent_SearchTable"),displayName:new f.Observable(v.sanitize(e.label.get(),{allowFrames:!1,uriTransformer:function(e){return e}})),relationName:new f.Observable(null),layer:null,featureUrl:"",attributes:e.attributes,geometry:new f.Observable(s.geometry),hasAttachments:new f.Observable(!1),attachmentInfos:new f.ObservableCollection([])};r.sync(this.providerEnabled);var d={displayName:new f.Observable(i.displayName),id:new f.Observable(0),relatedTableId:new f.Observable(null),visible:new f.Observable(!0),relatedEsriFeatureInfo:new f.ObservableCollection([o]),relatedGcxFeatures:n,hasRetrievedData:new f.Observable(!0),noRelatedFeatures:new f.Observable(!1),canAdd:new f.Observable(!1),validCardinality:new f.Observable(!1),errorFetchingRelatedFeatures:new f.Observable(!1),results:n,columnHeaders:new f.ObservableCollection([]),providerEnabled:r,masterViewModel:this};this.relationList.addItem(d);var c={featureInfo:o,esriFeature:s,gcxFeature:e,layer:null};this._checkRelatedFeature(c),c.gcxFeature.setExtendedProperty(this.SEARCH_TABLE_ID_KEY,t),this._createAttachedViews(),this.updateProviderState(!0)}}else{if(t=l.getExtendedPropertyByName(this.SEARCH_TABLE_ID_KEY),this.currentSearchTable=this._getSearchTable(t),!this.currentSearchTable||!this._searchTablesRelationships.hasOwnProperty(this.currentSearchTable.id))return;this.datalinkSearches=this._searchTablesRelationships[this.currentSearchTable.id];for(var p=[],h=0,g=this.datalinkSearches.length;h<g;h++)a=h,function(){var e=u.datalinkSearches[a],t=e&&e.dataLink?e.dataLink.layer:null;if(u._allLayers.push(t),t&&t instanceof b.Layer){var i=t.getFeatureLayer();i.then(function(e){u._featureLayers[t.url]=e}),p.push(i)}}();this._relatedLayerPromises=Promise.all(p),this._relatedLayerPromises.then(function(){if(u._relatedLayerPromises=null,0<u.datalinkSearches.length){u.hasRelationships.set(!0);for(var e=0,t=u.datalinkSearches.length;e<t;e++)o=e,function(){var e=u.datalinkSearches[o],t=e.dataLink.layer,i=e.displayName,a=new f.Observable(u.providerEnabled.get()),r=new f.ObservableCollection([]);a.sync(u.providerEnabled);var n={displayName:new f.Observable(i),id:new f.Observable(o),relatedTableId:new f.Observable(null),visible:new f.Observable(!0),relatedEsriFeatureInfo:new f.ObservableCollection([]),relatedGcxFeatures:r,hasRetrievedData:new f.Observable(!1),noRelatedFeatures:new f.Observable(!1),canAdd:new f.Observable(!1),validCardinality:new f.Observable(!1),errorFetchingRelatedFeatures:new f.Observable(!1),results:r,columnHeaders:new f.ObservableCollection([]),providerEnabled:a,masterViewModel:u},s=u._featureLayers[t.url];u._resolveRelatedFeatures(n,l,e,s),u.relationList.addItem(n)}()}var o;u._createAttachedViews(),u._updateProviderState(),null==u.parentFeature.get()&&(u.parentFeature.set(u.currentFeature.get()),u.parentFeature.get())})}},s.prototype._findGeocortexLayer=function(e){for(var t in this._featureLayers)if(this._featureLayers.hasOwnProperty(t)&&this._featureLayers[t]===e)for(var i=0,a=this._allLayers.length;i<a;i++){var r=this._allLayers[i];if(r&&r.url===t)return r}return n.prototype._findGeocortexLayer.call(this,e,this.app.site)},s.prototype._siteInitialized=function(){this._findSearchTableRelationships()},s.prototype._findSearchTableRelationships=function(){if(this._searchTablesRelationships={},this.app.site&&this.app.site.essentialsMap)for(var e=this.app.site.essentialsMap.allLayers(),t=0,i=e.length;t<i;t++)for(var a=e[t],r=0,n=a.dataLinks.length;r<n;r++)for(var s=a.dataLinks[r],o=0,l=s.searches.length;o<l;o++){var u=s.searches[o],d=u.searchTableId;this._searchTablesRelationships.hasOwnProperty(d)||(this._searchTablesRelationships[d]=[]),this._searchTablesRelationships[d].push(u)}},s.prototype._resolveRelatedFeatures=function(o,l,t,u){var d=this;if(o&&l&&t&&u){var e=t.dataLink,c=e?e.layer:null,i=l.esriFeature.get(),a=i&&i.attributes&&t.tableField?i.attributes[t.tableField]:null,r=c?c.getFieldByName(t.featureField):null,n=this._getEsriField(u,t.featureField),s=n?m.FieldInfo.fromEsriField(n,null,r):null,p=[];if(c&&s){s.searchable=!0,p.push(s);var h=w.getSearchTextWhereClause(c,p,a),g=new esri.tasks.Query;g.where=h,g.outFields=["*"],g.outSpatialReference=this.app.map.spatialReference,g.returnGeometry=!0,w.getQueryTask(c).execute(g,function(e){if(0===e.features.length)return o.noRelatedFeatures.set(!0),void o.hasRetrievedData.set(!0);for(var t=new F.FeatureSet({layer:c,app:d.app,esriFeatureSet:new esri.tasks.FeatureSet}),i=0,a=e.features.length;i<a;i++){var r={featureInfo:null,esriFeature:null,gcxFeature:null,layer:u},n=e.features[i];r.esriFeature=n;var s=d._processRelatedFeature(u,n,o);r.featureInfo=s,o.relatedEsriFeatureInfo.addItem(s),d._checkRelatedFeature(r),t.addFeature(r.gcxFeature),r.gcxFeature.setExtendedProperty(d.SEARCHTABLE_KEY,l),r.gcxFeature.hasVisibleRelationships.set(!0),u.hasAttachments&&setTimeout(function(e,t){return function(){return t._loadAttachments(e)}}(s,d),100)}t.resolveDataLinks(function(e){d.app.event("FeatureChangedEvent").publish(e)}),o.hasRetrievedData.set(!0)},function(e){o.errorFetchingRelatedFeatures.set(!0),o.hasRetrievedData.set(!0),d.app.trace.error("Error getting related record for search table datalink {0}: {1}.".format(t.displayName,e.message))})}}else this.app.trace.error("_resolveRelatedFeatures missing parameters")},s.prototype._getEsriField=function(e,t){var i=null;if(e&&e.fields)for(var a=e.fields,r=0,n=a.length;r<n;r++)if(a[r],a[r].name===t){i=a[r];break}return i},s.prototype._getSearchTable=function(e){var t=null,i=this.app.site;return e&&i&&i.hasSearchTables&&(t=i.getResourceById(i.searchTables,e)),t},s);function s(e,t){var i=n.call(this,e,t)||this;return i.SEARCHTABLE_KEY="parentSearchTable",i.SEARCH_TABLE_ID_KEY="SearchTableId",i.datalinkSearches=[],i.currentSearchTable=null,e.site&&e.site.isInitialized?i._siteInitialized():e.event("SiteInitializingEvent").once(i,i._siteInitialized),i}t.SearchTablesRelatedFeaturesViewModel=r})},"url:/Mapping/modules/FeatureDetails/FeatureDetailsProviders/AttachmentsView.html":t,"url:/Mapping/modules/FeatureDetails/FeatureDetailsProviders/AttributesView.html":i,"url:/Mapping/modules/FeatureDetails/FeatureDetailsProviders/DataLinksTableView.html":a,"url:/Mapping/modules/FeatureDetails/FeatureDetailsProviders/DataLinksView.html":r,"url:/Mapping/modules/FeatureDetails/FeatureDetailsProviders/DataLinkView.html":n,"url:/Mapping/modules/FeatureDetails/FeatureDetailsProviders/DescriptionView.html":s,"url:/Mapping/modules/FeatureDetails/FeatureDetailsProviders/FeatureActionsView.html":o,"url:/Mapping/modules/FeatureDetails/FeatureDetailsProviders/HyperlinksView.html":l,"url:/Mapping/modules/FeatureDetails/FeatureDetailsProviders/MultiColumnAttributesView.html":u,"url:/Mapping/modules/FeatureDetails/FeatureDetailsProviders/RelatedFeaturesTableView.html":d,"url:/Mapping/modules/FeatureDetails/FeatureDetailsProviders/RelatedFeaturesView.html":c,"url:/Mapping/modules/FeatureDetails/FeatureDetailsProviders/SingleAttributeView.html":p,"url:/Mapping/modules/FeatureDetails/FeatureDetailsSwitcherView.html":h,"url:/Mapping/modules/FeatureDetails/FeatureDetailsView.html":g,"url:/Mapping/modules/FeatureDetails/LargeFeatureDetailsView.html":b}}),require(["geocortex/framework/resourceManager"],function(e){e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/CSS/common.css","css","DQovKiBGRUFUVVJFIERFVEFJTCBQUk9WSURFUlMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovDQouRmVhdHVyZURldGFpbHNDb21wYWN0VmlldyBoMiwNCi5GZWF0dXJlRGV0YWlsc1ZpZXcgaDIsDQouRmVhdHVyZURldGFpbHNDb21wYWN0VmlldyBoMywNCi5GZWF0dXJlRGV0YWlsc1ZpZXcgaDMgew0KICAgIGZvbnQtd2VpZ2h0OiBsaWdodGVyOw0KfQ0KDQouRmVhdHVyZURldGFpbHNDb21wYWN0VmlldyBoMyBidXR0b24sDQouRmVhdHVyZURldGFpbHNWaWV3IGgzIGJ1dHRvbiB7DQogICAgYmFja2dyb3VuZDogbm9uZTsNCiAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgI0Q5RDlEOTsNCiAgICBmb250LXNpemU6IDEuMjVlbTsNCiAgICBtYXJnaW4tYm90dG9tOiAxZW07DQp9DQoNCi5GZWF0dXJlRGV0YWlsc0NvbXBhY3RWaWV3IC5wYW5lbC1ncm91cCwNCi5GZWF0dXJlRGV0YWlsc1ZpZXcgLnBhbmVsLWdyb3VwIHsNCiAgICBwYWRkaW5nOiAwIDAgMWVtIDA7DQogICAgZmxvYXQ6IGxlZnQ7DQogICAgd2lkdGg6IDEwMCU7DQogICAgLXdlYmtpdC1ib3gtc2l6aW5nOiBib3JkZXItYm94Ow0KICAgIC1tb3otYm94LXNpemluZzogYm9yZGVyLWJveDsNCiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94Ow0KfQ0KLkZlYXR1cmVEZXRhaWxzQ29tcGFjdFZpZXcgLnBhbmVsLWdyb3VwIGgzLA0KLkZlYXR1cmVEZXRhaWxzVmlldyAucGFuZWwtZ3JvdXAgaDMgew0KICAgIGJhY2tncm91bmQ6IG5vbmU7DQogICAgZm9udC1zaXplOiAxLjVlbTsNCn0NCg0KLm1hcC1jYWxsb3V0LWNvbnRlbnRzIC5tb2RpZnkgew0KICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBiYWNrZ3JvdW5kOiAjZmZmZmZmOw0KfQ0KDQoubWFwLWNhbGxvdXQtY29udGVudHMgLm1vZGlmeSBhIHsNCiAgICBwYWRkaW5nOiAxZW0gMDsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBjb2xvcjogIzE5N0RDODsNCiAgICBkaXNwbGF5OiBibG9jazsNCiAgICB3aWR0aDogMTAwJTsNCn0NCi5mZWF0dXJlLWRlc2NyaXB0aW9uLXByb3ZpZGVyIGgzLCAuZmVhdHVyZS1kZXRhaWxzLWNvbnRlbnQsIC5GZWF0dXJlQXR0cmlidXRlc1Byb3ZpZGVyVmlldyBoMyB7DQogICAgd29yZC1icmVhazogYnJlYWstd29yZDsNCiAgICB3b3JkLXdyYXA6IGJyZWFrLXdvcmQ7DQogICAgcGFkZGluZy1yaWdodDogMWVtOw0KfQ0KLmZlYXR1cmUtZGV0YWlscy1jb250ZW50IHsNCiAgICBwYWRkaW5nLWxlZnQ6IDFlbTsNCiAgICB3aGl0ZS1zcGFjZTogcHJlLXdyYXA7DQp9DQouZmVhdHVyZS1kZXRhaWxzLWNvbnRlbnQgPiBpZnJhbWUsDQouZmVhdHVyZS1kZXRhaWxzLWNvbnRlbnQgPiBpbWcgeyAvKiBIYXZlIHRoZSBmZWF0dXJlIGltYWdlIG9yIGlmcmFtZSBmbG9hdCBzbyB0aGUgY29udGVudCB3aWxsIGxpbmUgdXAgbmV4dCB0byBpdC4gKi8NCiAgICBmbG9hdDogbGVmdDsNCiAgICBtYXJnaW46IDAgMWVtIDFlbSAwOw0KfQ0KDQouZmVhdHVyZS1kZXRhaWxzLWNvbnRlbnQgPiBpZnJhbWUgKyBiciwNCi5mZWF0dXJlLWRldGFpbHMtY29udGVudCA+IGltZyArIGJyIHsgLyogSWYgdGhlIGZlYXR1cmUgaW1hZ2Ugb3IgaWZyYW1lIGhhcyBhIGJyIHRhZyBmb2xsb3cgaXQsIGhpZGUgaXQgc28gdGhlIGNvbnRlbnQgaW4gdGhlIG5leHQgY29sdW1uIGRvZXNuJ3QgaGF2ZSBhbiBleHRyYSBzcGFjZSBhYm92ZSBpdC4gKi8NCiAgICBkaXNwbGF5OiBub25lOw0KfQ0KDQouZmVhdHVyZS1kZXRhaWxzLWNvbnRlbnQgdWwgew0KICAgIHdoaXRlLXNwYWNlOiBub3JtYWw7DQp9DQoNCi5hdHRyaWJ1dGUtbGlzdCwNCi5hdHRyaWJ1dGUtaXRlbSB7DQogICAgZGlzcGxheTogYmxvY2s7DQogICAgbWFyZ2luOiAwOw0KICAgIHBhZGRpbmc6IDA7DQogICAgbGlzdC1zdHlsZTogbm9uZTsNCn0NCg0KLmF0dHJpYnV0ZS1pdGVtIHsNCiAgICBtYXJnaW4tdG9wOiAxZW07DQp9DQouYXR0cmlidXRlLWl0ZW06Zmlyc3QtY2hpbGQgew0KICAgIG1hcmdpbi10b3A6IDA7DQp9DQoNCi5hdHRyaWJ1dGUtbGFiZWwsDQouYXR0cmlidXRlLWRldGFpbHMgew0KICAgIGRpc3BsYXk6IGJsb2NrOw0KICAgIC13ZWJraXQtYm94LXNpemluZzogYm9yZGVyLWJveDsNCiAgICAtbW96LWJveC1zaXppbmc6IGJvcmRlci1ib3g7DQogICAgYm94LXNpemluZzogYm9yZGVyLWJveDsNCn0NCg0KLmF0dHJpYnV0ZS1sYWJlbCB7DQogICAgY29sb3I6ICM3Njc2NzY7DQp9DQoNCi5hdHRyaWJ1dGUtZGV0YWlscyB7DQogICAgZm9udC1zaXplOiAxLjI1ZW07DQogICAgbGluZS1oZWlnaHQ6IDEuMjVlbTsNCiAgICB3b3JkLXdyYXA6IGJyZWFrLXdvcmQ7DQp9DQoNCi5GZWF0dXJlRGV0YWlsc1ZpZXcgLnRhYi1jb250YWluZXIgew0KICAgIGJhY2tncm91bmQ6ICNGRkZGRkY7DQogICAgYm9yZGVyLWNvbG9yOiAjRDlEOUQ5Ow0KfQ0KDQouRmVhdHVyZURldGFpbHNWaWV3IC50YWIgew0KICAgIGJhY2tncm91bmQtY29sb3I6ICNFRUVFRUU7DQogICAgYm9yZGVyLWNvbG9yOiAjRDlEOUQ5Ow0KICAgIG92ZXJmbG93OiBoaWRkZW47DQogICAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7DQp9DQoNCi5GZWF0dXJlRGV0YWlsc1ZpZXcgLnRhYi1hY3RpdmUgew0KICAgIGJhY2tncm91bmQ6ICNGRkZGRkY7DQogICAgb3ZlcmZsb3c6IGhpZGRlbjsNCiAgICB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpczsNCn0NCg0KLkZlYXR1cmVEZXRhaWxzVmlldyAudGFiOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kOiAjREREREREOw0KfQ0KLkZlYXR1cmVEZXRhaWxzQ29tcGFjdFZpZXcgLm11bHRpLWNvbHVtbi1jb250YWluZXIsDQoubXVsdGktY29sdW1uLWNvbnRhaW5lciB7DQogICAgZmxvYXQ6IGxlZnQ7DQogICAgd2lkdGg6IDk1JTsNCiAgICBtYXJnaW46IDAgYXV0bzsNCn0NCi5GZWF0dXJlRGV0YWlsc0NvbXBhY3RWaWV3IC5tdWx0aS1jb2x1bW4tY29udGFpbmVyIHsNCiAgICBtYXJnaW46IDAgMCAwLjVlbSAwOw0KICAgIGJvcmRlcjogMDsNCiAgICBwYWRkaW5nLXRvcDogMC41ZW07DQp9DQoNCi5tdWx0aS1jb2x1bW4tY29udGFpbmVyIHsNCiAgICB3aWR0aDogNDUlOw0KICAgIG1hcmdpbi1yaWdodDogMWVtOw0KICAgIHBhZGRpbmctbGVmdDogMWVtOw0KICAgIGJvcmRlci1sZWZ0OiAxcHggc29saWQgI0VFRUVFRTsNCn0NCi5tdWx0aS1jb2x1bW4tY29udGFpbmVyOmZpcnN0LWNoaWxkIHsNCiAgICBtYXJnaW4tbGVmdDogMDsNCiAgICBib3JkZXItbGVmdDogbm9uZTsNCn0NCg0KDQpAbWVkaWEgYWxsIGFuZCAobWluLXdpZHRoOiAxMDAwcHgpIHsNCiAgICAubXVsdGktY29sdW1uLWNvbnRhaW5lciB7DQogICAgICAgIHdpZHRoOiAzMCU7DQogICAgfQ0KfQ0KDQoucmVnaW9uLWNvbnRhaW5lciB7DQogICAgZGlzcGxheTogaW5saW5lLWJsb2NrOw0KICAgIGZsb2F0OiBsZWZ0Ow0KfQ0KDQouRmVhdHVyZURldGFpbHNUb3BMZWZ0UmVnaW9uLWFjdGl2ZS5GZWF0dXJlRGV0YWlsc1RvcFJpZ2h0UmVnaW9uLWFjdGl2ZSAuZmVhdHVyZS1kZXRhaWxzLXRvcC1sZWZ0LXJlZ2lvbiwNCi5GZWF0dXJlRGV0YWlsc1RvcExlZnRSZWdpb24tYWN0aXZlLkZlYXR1cmVEZXRhaWxzVG9wUmlnaHRSZWdpb24tYWN0aXZlIC5mZWF0dXJlLWRldGFpbHMtdG9wLXJpZ2h0LXJlZ2lvbiB7DQogICAgd2lkdGg6IDUwJTsNCn0NCi5GZWF0dXJlRGV0YWlsc1RvcExlZnRSZWdpb24tYWN0aXZlLkZlYXR1cmVEZXRhaWxzVG9wUmlnaHRSZWdpb24taW5hY3RpdmUgLmZlYXR1cmUtZGV0YWlscy10b3AtbGVmdC1yZWdpb24sDQouRmVhdHVyZURldGFpbHNUb3BMZWZ0UmVnaW9uLWluYWN0aXZlLkZlYXR1cmVEZXRhaWxzVG9wUmlnaHRSZWdpb24tYWN0aXZlIC5mZWF0dXJlLWRldGFpbHMtdG9wLXJpZ2h0LXJlZ2lvbiwNCi5mZWF0dXJlLWRldGFpbHMtYm90dG9tLXJlZ2lvbiB7DQogICAgd2lkdGg6IDEwMCU7DQp9DQouZmVhdHVyZS1kZXRhaWxzLWJvdHRvbS1yZWdpb246YWZ0ZXIgew0KICAgICBjb250ZW50OiAiICI7DQogICAgIGRpc3BsYXk6IGJsb2NrOw0KICAgICBoZWlnaHQ6IDA7DQogICAgIGNsZWFyOiBib3RoOw0KICAgICB2aXNpYmlsaXR5OiBoaWRkZW47IA0KfQ0KDQovKiBIaWRlIHRoZSBEZXRhaWxzIGhlYWRlciB3aGVuIGl0IGlzIHRoZSBvbmx5IG9uZSBwcmVzZW50ICovDQouRmVhdHVyZURldGFpbHNFeHBhbmRlZFZpZXcgLkZlYXR1cmVBdHRyaWJ1dGVzUHJvdmlkZXJWaWV3IC5wYW5lbC1ncm91cCBoMyB7DQogICAgZGlzcGxheTogbm9uZTsNCn0NCg0KLyogSGlkZSB0aGUgaGVhZGVyIHdoZW4gdGFicyBhcmUgcHJlc2VudCBpbiB0aGUgcmVnaW9uIGhlYWRlciAqLw0KLnJlZ2lvbi12aWV3LXN3aXRjaGVyLmJvdW5kLXZpc2libGUgKyAucmVnaW9uIC52aWV3IC5wYW5lbC1ncm91cCBoMyB7DQogICAgZGlzcGxheTogbm9uZTsNCn0NCi5yZWdpb24tdmlldy1zd2l0Y2hlci5ib3VuZC12aXNpYmxlICsgLnJlZ2lvbiAudmlldy5GZWF0dXJlRGVzY3JpcHRpb25Qcm92aWRlclZpZXcuYWN0aXZlIC5wYW5lbC1ncm91cCAuZmVhdHVyZS1kZXRhaWxzLWNvbnRlbnQgew0KICAgIG1hcmdpbi10b3A6IDFlbTsNCn0NCi5kYXRhbGlua3MtdGFibGUtd2lkZ2V0LA0KLnJlbGF0ZWQtZmVhdHVyZXMtdGFibGUtd2lkZ2V0IHsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgdG9wOiAyLjNlbTsNCiAgICBib3R0b206IDA7DQp9DQouY3JlYXRlZmVhdHVyZS1hY3Rpb25zLmJvdW5kLXZpc2libGUgfiAucmVsYXRlZC1mZWF0dXJlcy10YWJsZS13aWRnZXQgew0KICAgIHRvcDogNS4zZW07DQp9IA0KDQovKi5kYXRhbGlua3MtdGFibGUtd2lkZ2V0LCANCi5yZWxhdGVkLWZlYXR1cmVzLXRhYmxlLXdpZGdldCB7DQogICAgaGVpZ2h0OiBpbmhlcml0Ow0KfSovDQouRmVhdHVyZURldGFpbHNFeHBhbmRlZFZpZXcgLm11bHRpLWNvbHVtbi1jb250YWluZXIgew0KICAgIHBhZGRpbmctdG9wOiAwLjVlbTsNCn0NCi5yZWdpb24tY29udGFpbmVyLmZlYXR1cmUtcmVnaW9uIHsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBwYWRkaW5nLXRvcDogMC41ZW07DQp9DQoNCi5wYW5lbC1ncm91cCB7DQogICAgZmxvYXQ6IG5vbmU7DQogICAgY2xlYXI6IGJvdGg7DQogICAgd2lkdGg6IDEwMCU7DQp9DQouRmVhdHVyZURldGFpbHNDb21wYWN0VmlldyAubXVsdGktY29sdW1uLWNvbnRhaW5lciB7DQogICAgZmxvYXQ6IG5vbmU7DQp9DQouRmVhdHVyZURldGFpbHNDb21wYWN0VmlldyAuc2luZ2xlLWZlYXR1cmUtY2hhcnQgaDMgew0KICAgIG1hcmdpbi1ib3R0b206IDA7DQp9DQouRmVhdHVyZURldGFpbHNDb21wYWN0VmlldyAucGFuZWwtZ3JvdXAgaDMgew0KICAgIHBhZGRpbmctbGVmdDogLjc1ZW07DQp9DQouRmVhdHVyZURldGFpbHNDb21wYWN0VmlldyAucGFuZWwtZ3JvdXAgYnV0dG9uLmxpc3QtbWVudS1pdGVtIHsNCiAgICBib3JkZXI6IDA7DQogICAgZGlzcGxheTogYmxvY2s7DQogICAgd2lkdGg6IDEwMCU7DQogICAgcGFkZGluZy10b3A6IDAuNDM4ZW07DQogICAgcGFkZGluZy1ib3R0b206IDAuNDM4ZW07DQp9DQoNCi50b3VjaCAuRmVhdHVyZURldGFpbHNDb21wYWN0VmlldyAucGFuZWwtZ3JvdXAgYnV0dG9uLmxpc3QtbWVudS1pdGVtIHsNCiAgICBwYWRkaW5nLXRvcDogMWVtOw0KICAgIHBhZGRpbmctYm90dG9tOiAxZW07DQp9DQoNCi5GZWF0dXJlRGV0YWlsc0NvbXBhY3RWaWV3IC5wYW5lbC1ncm91cCAubGlzdC1tZW51Lmhhcy1pY29uIGJ1dHRvbi5saXN0LW1lbnUtaXRlbSB7DQogICAgcGFkZGluZy10b3A6IDAuMjVlbTsNCiAgICBwYWRkaW5nLWJvdHRvbTogMC4yNWVtOw0KfQ0KDQoudG91Y2ggLkZlYXR1cmVEZXRhaWxzQ29tcGFjdFZpZXcgLnBhbmVsLWdyb3VwIC5saXN0LW1lbnUuaGFzLWljb24gYnV0dG9uLmxpc3QtbWVudS1pdGVtIHsNCiAgICBwYWRkaW5nLXRvcDogMWVtOw0KICAgIHBhZGRpbmctYm90dG9tOiAxZW07DQp9DQoNCi5GZWF0dXJlRGV0YWlsc0NvbXBhY3RWaWV3IC5wYW5lbC1ncm91cCAubGlzdC1tZW51IC5hdHRhY2htZW50Lmxpc3QtbWVudS1pdGVtIHsNCiAgICBwYWRkaW5nLWxlZnQ6IDA7DQp9DQoNCi8qIEdWSC0xMDEyMjogVGFncyBmb3IgdGFiIGNvbnRyb2xzIGNvcGllZCBmcm9tIE1hcHBpbmcvaW5mcmFzdHJ1Y3R1cmUvcmVzdWx0cy9DU1MvY29tbW9uLmNzcyAqLw0KDQouRmVhdHVyZURldGFpbHNFeHBhbmRlZFZpZXcgLnRhYi1jb250YWluZXIgew0KICAgIG92ZXJmbG93OiBoaWRkZW47DQp9DQoNCi5GZWF0dXJlRGV0YWlsc0V4cGFuZGVkVmlldyAudGFiLWNvbnRhaW5lciB0YWJsZSB7DQogICAgdGFibGUtbGF5b3V0OiBmaXhlZDsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBvdmVyZmxvdzogaGlkZGVuOw0KfQ0KDQouRmVhdHVyZURldGFpbHNFeHBhbmRlZFZpZXcgLnRhYi1sZWZ0LXNjcm9sbCwgDQouRmVhdHVyZURldGFpbHNFeHBhbmRlZFZpZXcgLnRhYi1yaWdodC1zY3JvbGwgew0KICAgIHZlcnRpY2FsLWFsaWduOiB0b3A7DQogICAgd2lkdGg6IDIuNzVlbTsNCiAgICBwb3NpdGlvbjogcmVsYXRpdmU7DQogICAgei1pbmRleDogMTAwOw0KfQ0KLkZlYXR1cmVEZXRhaWxzRXhwYW5kZWRWaWV3IC50YWItbGVmdC1zY3JvbGwgew0KICAgIGJvcmRlci1yaWdodDogMXB4IHNvbGlkICNEOUQ5RDk7DQp9DQouRmVhdHVyZURldGFpbHNFeHBhbmRlZFZpZXcgLnRhYi1yaWdodC1zY3JvbGwgew0KICAgIGJvcmRlci1sZWZ0OiAxcHggc29saWQgI0Q5RDlEOTsNCn0NCi5GZWF0dXJlRGV0YWlsc0V4cGFuZGVkVmlldyAudGFiLWxlZnQtc2Nyb2xsIGltZywgDQouRmVhdHVyZURldGFpbHNFeHBhbmRlZFZpZXcgLnRhYi1yaWdodC1zY3JvbGwgaW1nIHsNCiAgICBtYXJnaW46IDAgYXV0bzsNCiAgICBkaXNwbGF5OiBibG9jazsNCn0NCi5GZWF0dXJlRGV0YWlsc0V4cGFuZGVkVmlldyAudGFiLWxlZnQtc2Nyb2xsIGJ1dHRvbiwgDQouRmVhdHVyZURldGFpbHNFeHBhbmRlZFZpZXcgLnRhYi1yaWdodC1zY3JvbGwgYnV0dG9uIHsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBoZWlnaHQ6IDIuMmVtOw0KICAgIGJhY2tncm91bmQ6ICNmZmZmZmY7DQp9DQouRmVhdHVyZURldGFpbHNFeHBhbmRlZFZpZXcgLnRhYi1sZWZ0LXNjcm9sbC5kaXNhYmxlZCBidXR0b24sIA0KLkZlYXR1cmVEZXRhaWxzRXhwYW5kZWRWaWV3IC50YWItcmlnaHQtc2Nyb2xsLmRpc2FibGVkIGJ1dHRvbiB7DQogICAgYmFja2dyb3VuZDogI2VlZWVlZTsNCn0NCi5GZWF0dXJlRGV0YWlsc0V4cGFuZGVkVmlldyAucmVzdWx0cyAud2lkZ2V0LmJvdW5kLXZpc2libGUgew0KICAgIHRvcDogMi4xNWVtOw0KfQ0KDQouRmVhdHVyZURldGFpbHNFeHBhbmRlZFZpZXcgLnRhYi1jb250cm9sIHsNCiAgICAvKiBXaWR0aCBpbmhlcml0IGlzIHJlcXVpcmVkIHNvIHRhYiBjb250cm9sIG9mZnNldCB3aWR0aCBjYW4gYmUgY29tcGFyZWQgdG8gdGhhdCBvZiB0aGUgdGFiIGNvbnRhaW5lciB0byBjaGVjayB3aGV0aGVyIHRvIGRpc3BsYXkgdGFiIHNjcm9sbCBidXR0b25zICovDQogICAgd2lkdGg6IGluaGVyaXQ7DQogICAgZGlzcGxheTogaW5saW5lLWJsb2NrICFpbXBvcnRhbnQ7DQogICAgem9vbTogMTsNCn0NCg0KLkZlYXR1cmVEZXRhaWxzRXhwYW5kZWRWaWV3IC50YWItY29udHJvbCB7DQogICAgLyogV2lkdGggaW5oZXJpdCBpcyByZXF1aXJlZCBzbyB0YWIgY29udHJvbCBvZmZzZXQgd2lkdGggY2FuIGJlIGNvbXBhcmVkIHRvIHRoYXQgb2YgdGhlIHRhYiBjb250YWluZXIgdG8gY2hlY2sgd2hldGhlciB0byBkaXNwbGF5IHRhYiBzY3JvbGwgYnV0dG9ucyAqLw0KICAgIHdpZHRoOiBpbmhlcml0Ow0KICAgIGRpc3BsYXk6IGlubGluZS1ibG9jayAhaW1wb3J0YW50Ow0KICAgIHpvb206IDE7DQp9DQoNCi8qIGVuZCBvZiB0YWIgY29udHJvbCB0YWdzICovDQoNCkBtZWRpYSBhbGwgYW5kIChtaW4td2lkdGg6IDBweCkgYW5kIChtYXgtd2lkdGg6IDQ1MHB4KSB7DQogICAgLkZlYXR1cmVEZXRhaWxzRXhwYW5kZWRWaWV3IC5tdWx0aS1jb2x1bW4tY29udGFpbmVyIHsNCiAgICAgICAgcGFkZGluZy10b3A6IDFlbTsNCiAgICAgICAgZmxvYXQ6IG5vbmU7DQogICAgICAgIGJvcmRlcjogMDsNCiAgICAgICAgd2lkdGg6IDEwMCU7DQogICAgICAgIG1hcmdpbjogMDsNCiAgICB9DQp9DQoNCi5saXN0LW1lbnUuaHlwZXJsaW5rcyB7DQogICAgYm9yZGVyLXRvcDogMXB4IHNvbGlkICNFRUVFRUU7DQp9DQoNCi5saXN0LW1lbnUuaHlwZXJsaW5rcyAubGlzdC1tZW51LWRldGFpbHMgew0KICAgIHBhZGRpbmc6IDAuNWVtIDFlbTsNCn0="),e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/CSS/large.css","css","DQovKiBGRUFUVVJFIERFVEFJTCBQUk9WSURFUlMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovDQoNCi5hdHRyaWIgLmxpc3QtbWVudS1pdGVtIC5saXN0LW1lbnUtbmFtZSwNCi5hdHRyaWIgLmxpc3QtbWVudS1pdGVtIC5saXN0LW1lbnUtZGVzYyB7DQogICAgYm94LXNpemluZzogYm9yZGVyLWJveDsNCiAgICAtbW96LWJveC1zaXppbmc6IGJvcmRlci1ib3g7DQp9DQoNCi5hdHRyaWIgLmxpc3QtbWVudS1pdGVtIHsNCiAgICBkaXNwbGF5OiBibG9jazsNCiAgICBtYXgtd2lkdGg6NTBlbTsNCiAgICBwYWRkaW5nOiAwOw0KfQ0KDQouYXR0cmliIC5saXN0LW1lbnUtbmFtZSwNCi5hdHRyaWIgLmxpc3QtbWVudS1kZXNjIHsNCiAgICBmbG9hdDogbGVmdDsNCiAgICB2ZXJ0aWNhbC1hbGlnbjogYm90dG9tOw0KICAgIHBhZGRpbmc6IDFlbTsNCiAgICB3b3JkLXdyYXA6IGJyZWFrLXdvcmQ7DQp9DQoNCi5hdHRyaWIgLmxpc3QtbWVudS1uYW1lIHsNCiAgICB3aWR0aDogNDAlOw0KICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQp9DQoNCi5hdHRyaWIgLmxpc3QtbWVudS1kZXNjIHsNCiAgICB3aWR0aDogNjAlOw0KfQ0KDQouZmVhdHVyZS1kZXRhaWxzLWhlYWRlciAucGFuZWwtdGl0bGUgew0KICAgIGZsb2F0OiBsZWZ0Ow0KICAgIG1hcmdpbjogMCAyMHB4Ow0KfQ0KDQouZmVhdHVyZS1kZXRhaWxzLWhlYWRlciAuZmVhdHVyZS1hY3Rpb25zLXdpZGdldCB7DQogICAgZmxvYXQ6IHJpZ2h0Ow0KICAgIG1hcmdpbjogMCAyMHB4Ow0KICAgIG1heC13aWR0aDogNjAlOw0KfQ0KDQouZmVhdHVyZS1kZXRhaWxzLWJvdHRvbS1yZWdpb24gLnBhbmVsLXNjcm9sbC1jb250YWluZXIgew0KICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsNCn0NCg0KLmZlYXR1cmUtZGV0YWlscy1ib3R0b20tcmVnaW9uIGgzIHsNCn0NCg0KLyogSGlkZSB0aGUgY2hhcnQgaGVhZGVyIGluIGZlYXR1cmUgZGV0YWlscywgc2luY2Ugd2UgaGF2ZSBhIGNoYXJ0IHNlbGVjdG9yIHRoYXQgZG9lcyB0aGUgc2FtZSB0aGluZyAqLw0KLnJlZ2lvbiAudmlldyAucGFuZWwtZ3JvdXAuc2luZ2xlLWZlYXR1cmUtY2hhcnQuYm91bmQtdmlzaWJsZSBoMyB7DQogICAgZGlzcGxheTogbm9uZTsNCn0NCg0KLyogSWYgdGhlIGhlYWRlciBpcyBub3QgdmlzaWJsZSwgd2UgbmVlZCB0byBtYWtlIGFkanVzdG1lbnRzIHRvIGNoYXJ0IHZpZXcgKi8NCi5yZWdpb24gLnZpZXcgLnBhbmVsLWdyb3VwLnNpbmdsZS1mZWF0dXJlLWNoYXJ0LmJvdW5kLXZpc2libGUgaW1nIHsNCiAgICB0b3A6IDA7DQp9DQoNCi8qLkZlYXR1cmVEZXRhaWxzVmlldyAuRmVhdHVyZUNoYXJ0c1Byb3ZpZGVyVmlldyAuc2luZ2xlLWZlYXR1cmUtY2hhcnQgLmZ1aS1zZWxlY3RvciB7DQogICAgcGFkZGluZzogMDsNCn0qLw0KDQouZmVhdHVyZS1kZXRhaWxzLWhlYWRlciB7DQogICAgZGlzcGxheTogYmxvY2s7DQogICAgd2lkdGg6IDEwMCU7DQp9DQoNCi5mZWF0dXJlLWRldGFpbHMtaGVhZGVyIC5mZWF0dXJlLWFjdGlvbnMtd2lkZ2V0IC5tZW51LWh5cGVybGlua3MgLmxpc3QtbWVudSB7DQogICAgbWFyZ2luLXRvcDogMDsNCiAgICBib3JkZXItdG9wOiBub25lOw0KfQ0KLkZlYXR1cmVEZXRhaWxzVG9wUmlnaHRSZWdpb24tYWN0aXZlIC5mZWF0dXJlLWRldGFpbHMtdG9wLXJpZ2h0LXJlZ2lvbiAucmVzdWx0cy10YWJsZSB7DQogICAgbWF4LXdpZHRoOiA1MCU7DQogICAgbWluLXdpZHRoOiAwOw0KfQ0K"),e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/CSS/medium.css","css","DQovKiBGRUFUVVJFIERFVEFJTCBQUk9WSURFUlMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovDQoNCi5hdHRyaWIgLmxpc3QtbWVudS1pdGVtIC5saXN0LW1lbnUtbmFtZSwNCi5hdHRyaWIgLmxpc3QtbWVudS1pdGVtIC5saXN0LW1lbnUtZGVzYyB7DQogICAgYm94LXNpemluZzogYm9yZGVyLWJveDsNCiAgICAtbW96LWJveC1zaXppbmc6IGJvcmRlci1ib3g7DQp9DQoNCi5hdHRyaWIgLmxpc3QtbWVudS1pdGVtIHsNCiAgICBkaXNwbGF5OiBibG9jazsNCiAgICBtYXgtd2lkdGg6NTBlbTsNCiAgICBwYWRkaW5nOiAwOw0KfQ0KDQouYXR0cmliIC5saXN0LW1lbnUtbmFtZSwNCi5hdHRyaWIgLmxpc3QtbWVudS1kZXNjIHsNCiAgICBmbG9hdDogbGVmdDsNCiAgICB2ZXJ0aWNhbC1hbGlnbjogYm90dG9tOw0KICAgIHBhZGRpbmc6IDFlbTsNCiAgICB3b3JkLXdyYXA6IGJyZWFrLXdvcmQ7DQp9DQoNCi5hdHRyaWIgLmxpc3QtbWVudS1uYW1lIHsNCiAgICB3aWR0aDogNDAlOw0KICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQp9DQoNCi5hdHRyaWIgLmxpc3QtbWVudS1kZXNjIHsNCiAgICB3aWR0aDogNjAlOw0KfQ0KDQouZmVhdHVyZS1kZXRhaWxzLWhlYWRlciAucGFuZWwtdGl0bGUgew0KICAgIGZsb2F0OiBsZWZ0Ow0KICAgIG1hcmdpbjogMCAyMHB4Ow0KfQ0KDQouZmVhdHVyZS1kZXRhaWxzLWhlYWRlciAuZmVhdHVyZS1hY3Rpb25zLXdpZGdldCB7DQogICAgZmxvYXQ6IHJpZ2h0Ow0KICAgIG1hcmdpbjogMCAyMHB4Ow0KICAgIG1heC13aWR0aDogNjAlOw0KfQ0KDQouZmVhdHVyZS1kZXRhaWxzLXRvcC1sZWZ0LXJlZ2lvbiwNCi5mZWF0dXJlLWRldGFpbHMtdG9wLXJpZ2h0LXJlZ2lvbiB7DQogICAgd2lkdGg6IDUwJTsNCiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7DQogICAgZmxvYXQ6IGxlZnQ7DQp9DQoNCi5mZWF0dXJlLWRldGFpbHMtYm90dG9tLXJlZ2lvbiB7DQogICAgd2lkdGg6IDEwMCU7DQogICAgZGlzcGxheTogaW5saW5lLWJsb2NrOw0KfQ0KDQouZmVhdHVyZS1kZXRhaWxzLWJvdHRvbS1yZWdpb24gLnBhbmVsLXNjcm9sbC1jb250YWluZXIgew0KICAgIHRvcDphdXRvICFpbXBvcnRhbnQ7DQogICAgYm90dG9tOiBhdXRvICFpbXBvcnRhbnQ7DQogICAgcG9zaXRpb246IHJlbGF0aXZlOw0KfQ0KDQouZmVhdHVyZS1kZXRhaWxzLWJvdHRvbS1yZWdpb24gaDMgew0KfQ0KDQovKiBIaWRlIHRoZSBjaGFydCBoZWFkZXIgaW4gZmVhdHVyZSBkZXRhaWxzLCBzaW5jZSB3ZSBoYXZlIGEgY2hhcnQgc2VsZWN0b3IgdGhhdCBkb2VzIHRoZSBzYW1lIHRoaW5nICovDQoucmVnaW9uIC52aWV3IC5wYW5lbC1ncm91cC5zaW5nbGUtZmVhdHVyZS1jaGFydC5ib3VuZC12aXNpYmxlIGgzIHsNCiAgICBkaXNwbGF5OiBub25lOw0KfQ0KDQovKiBJZiB0aGUgaGVhZGVyIGlzIG5vdCB2aXNpYmxlLCB3ZSBuZWVkIHRvIG1ha2UgYWRqdXN0bWVudHMgdG8gY2hhcnQgdmlldyAqLw0KLnJlZ2lvbiAudmlldyAucGFuZWwtZ3JvdXAuc2luZ2xlLWZlYXR1cmUtY2hhcnQuYm91bmQtdmlzaWJsZSBpbWcgew0KICAgIHRvcDogMDsNCn0NCg0KLyouRmVhdHVyZURldGFpbHNWaWV3IC5GZWF0dXJlQ2hhcnRzUHJvdmlkZXJWaWV3IC5zaW5nbGUtZmVhdHVyZS1jaGFydCAuZnVpLXNlbGVjdG9yIHsNCiAgICBwYWRkaW5nOiAwOw0KfSovDQoNCi5mZWF0dXJlLWRldGFpbHMtaGVhZGVyIHsNCiAgICBkaXNwbGF5OiBibG9jazsNCiAgICB3aWR0aDogMTAwJTsNCn0NCg0KLmZlYXR1cmUtZGV0YWlscy1oZWFkZXIgLmZlYXR1cmUtYWN0aW9ucy13aWRnZXQgLm1lbnUtaHlwZXJsaW5rcyAubGlzdC1tZW51IHsNCiAgICBtYXJnaW4tdG9wOiAwOw0KICAgIGJvcmRlci10b3A6IG5vbmU7DQp9DQpAbWVkaWEgYWxsIGFuZCAobWF4LXdpZHRoOiA5ODBweCkgew0KDQogICAgLmZlYXR1cmUtZGV0YWlscy1ib3R0b20tcmVnaW9uIC5tdWx0aS1jb2x1bW4tY29udGFpbmVyIHsNCiAgICAgICAgcGFkZGluZy1sZWZ0OiAxZW07DQogICAgICAgIG1hcmdpbjogMDsNCiAgICAgICAgYm9yZGVyLWxlZnQ6MDsNCiAgICB9DQp9DQoNCi5kYXRhbGlua3MtdGFibGUtd2lkZ2V0LA0KLnJlbGF0ZWQtZmVhdHVyZXMtdGFibGUtd2lkZ2V0IHsNCiAgICB0b3A6IDMuNWVtOw0KfQ0KDQouY3JlYXRlZmVhdHVyZS1hY3Rpb25zLmJvdW5kLXZpc2libGUgfiAucmVsYXRlZC1mZWF0dXJlcy10YWJsZS13aWRnZXQgew0KICAgIHRvcDogNi41ZW07DQp9"),e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/CSS/small.css","css","LnJlZ2lvbi1jb250YWluZXIuZmVhdHVyZS1yZWdpb24gew0KICAgIHdpZHRoOiAxMDAlOw0KfQ0KLkZlYXR1cmVEZXRhaWxzVmlldyAucGFuZWwtZ3JvdXAgew0KICAgIGZsb2F0OiBub25lOw0KICAgIGNsZWFyOiBib3RoOw0KICAgIHdpZHRoOiAxMDAlOw0KfQ0KLkZlYXR1cmVEZXRhaWxzVmlldyAubXVsdGktY29sdW1uLWNvbnRhaW5lciB7DQogICAgZmxvYXQ6IG5vbmU7DQp9DQouRmVhdHVyZURldGFpbHNWaWV3IC5zaW5nbGUtZmVhdHVyZS1jaGFydCBoMyB7DQogICAgbWFyZ2luLWJvdHRvbTogMDsNCn0="),e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/FeatureDetailsProviders/AttachmentsView.html","html",t),e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/FeatureDetailsProviders/AttributesView.html","html",i),e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/FeatureDetailsProviders/DataLinksTableView.html","html",a),e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/FeatureDetailsProviders/DataLinksView.html","html",r),e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/FeatureDetailsProviders/DataLinkView.html","html",n),e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/FeatureDetailsProviders/DescriptionView.html","html",s),e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/FeatureDetailsProviders/FeatureActionsView.html","html",o),e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/FeatureDetailsProviders/HyperlinksView.html","html",l),e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/FeatureDetailsProviders/MultiColumnAttributesView.html","html",u),e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/FeatureDetailsProviders/RelatedFeaturesTableView.html","html",d),e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/FeatureDetailsProviders/RelatedFeaturesView.html","html",c),e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/FeatureDetailsProviders/SingleAttributeView.html","html",p),e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/FeatureDetailsSwitcherView.html","html",h),e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/FeatureDetailsView.html","html",g),e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/LargeFeatureDetailsView.html","html",b)}),require({cache:{}}),define(["Mapping/modules/FeatureDetails/FeatureDetailsModule","Mapping/modules/FeatureDetails/FeatureDetailsSwitcherView","Mapping/modules/FeatureDetails/FeatureDetailsSwitcherViewDescriptor","Mapping/modules/FeatureDetails/FeatureDetailsSwitcherViewModel","Mapping/modules/FeatureDetails/FeatureDetailsView","Mapping/modules/FeatureDetails/FeatureDetailsViewModel","Mapping/modules/FeatureDetails/FeatureDetailsProviders/AttachmentsView","Mapping/modules/FeatureDetails/FeatureDetailsProviders/AttachmentsViewModel","Mapping/modules/FeatureDetails/FeatureDetailsProviders/AttributesView","Mapping/modules/FeatureDetails/FeatureDetailsProviders/AttributesViewModel","Mapping/modules/FeatureDetails/FeatureDetailsProviders/DataLinksView","Mapping/modules/FeatureDetails/FeatureDetailsProviders/DataLinksViewModel","Mapping/modules/FeatureDetails/FeatureDetailsProviders/DataLinkView","Mapping/modules/FeatureDetails/FeatureDetailsProviders/DescriptionView","Mapping/modules/FeatureDetails/FeatureDetailsProviders/DescriptionViewModel","Mapping/modules/FeatureDetails/FeatureDetailsProviders/FeatureActionsView","Mapping/modules/FeatureDetails/FeatureDetailsProviders/FeatureActionsViewModel","Mapping/modules/FeatureDetails/FeatureDetailsProviders/Hyperlink","Mapping/modules/FeatureDetails/FeatureDetailsProviders/HyperlinksView","Mapping/modules/FeatureDetails/FeatureDetailsProviders/HyperlinksViewModel","Mapping/modules/FeatureDetails/FeatureDetailsProviders/RelatedFeaturesView","Mapping/modules/FeatureDetails/FeatureDetailsProviders/RelatedFeaturesViewModel","Mapping/modules/FeatureDetails/FeatureDetailsProviders/RelatedFeaturesViewModelBase","Mapping/modules/FeatureDetails/FeatureDetailsProviders/SearchTablesRelatedFeaturesViewModel"],function(e,t,i,a,r,n,s,o,l,u,d,c,p,h,g,b,v,f,m,w,F,y,C,V){D(e,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsModule",e.FeatureDetailsModule),D(t,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsSwitcherView",t.FeatureDetailsSwitcherView),D(i,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsSwitcherViewDescriptor",i.FeatureDetailsSwitcherViewDescriptor),D(a,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsSwitcherViewModel",a.FeatureDetailsSwitcherViewModel),D(r,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsView",r.FeatureDetailsView),D(n,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsViewModel",n.FeatureDetailsViewModel),D(s,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.AttachmentsView",s.AttachmentsView),D(o,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.AttachmentsViewModel",o.AttachmentsViewModel),D(l,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.AttributesView",l.AttributesView),D(u,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.AttributesViewModel",u.AttributesViewModel),D(d,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.DataLinksView",d.DataLinksView),D(c,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.DataLinksViewModel",c.DataLinksViewModel),D(p,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.DataLinkView",p.DataLinkView),D(h,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.DescriptionView",h.DescriptionView),D(g,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.DescriptionViewModel",g.DescriptionViewModel),D(b,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.FeatureActionsView",b.FeatureActionsView),D(v,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.FeatureActionsViewModel",v.FeatureActionsViewModel),D(f,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.Hyperlink",f.Hyperlink),D(m,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.HyperlinksView",m.HyperlinksView),D(w,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.HyperlinksViewModel",w.HyperlinksViewModel),D(F,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.RelatedFeaturesView",F.RelatedFeaturesView),D(y,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.RelatedFeaturesViewModel",y.RelatedFeaturesViewModel),D(C,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.RelatedFeaturesViewModelBase",C.RelatedFeaturesViewModelBase),D(V,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.SearchTablesRelatedFeaturesViewModel",V.SearchTablesRelatedFeaturesViewModel)})}();