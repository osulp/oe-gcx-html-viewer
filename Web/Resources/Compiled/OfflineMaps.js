!function(){var t="<div class='panel-group-contents' data-binding='{@source: basemap}'>    <div class='offline-basemap-levels' data-binding='{@template-for: basemap}'>        <p data-binding='{@text: @language-offlinemapeditor-basemaps-levels-instructions}'></p>        <span data-binding='{@text: @language-offlinemapeditor-basemaps-levels-levels}'></span><span data-binding='{@text: exportTilesMinLevel}'></span> - <span data-binding='{@text: exportTilesMaxLevel}'></span>        <div data-binding='{@var: slider}'></div>        <div>            <span class='offline-profile-basemap-less-detail' data-binding='{@text: @language-offlinemapeditor-basemaps-levels-less-detail}'></span>            <span class='offline-profile-basemap-more-detail' data-binding='{@text: @language-offlinemapeditor-basemaps-levels-more-detail}'></span>        </div>        <div data-binding='{@hidden: isNone}'>            <span data-binding='{@text: @language-offlinemapeditor-basemaps-size-label}'></span>            <span data-binding='{@text: sizePresentable}'></span>        </div>    </div></div><div class='form-btns'>    <button class='button' data-binding='{@text: @language-common-ok}{@event-click: handleDoneClick}'></button></div>",i="<div class='basemap-editor offline-map-editor panel-group-contents' data-binding='{@source: basemaps}'>    <div class='panel-group-contents' data-binding='{@template-for: basemaps}'>        <span class='layer-item-ctrl layer-list-layer-icon' data-binding='{@visible: iconUri}'><img data-binding='{src: iconUri}{alt: @language-offlinemapeditor-layer-icon}' /></span>        <span class='display-name' data-binding='{@text: displayName}'></span>        <form data-binding='{@template-for: basemaps}{@visible: supportsAny}'>            <div class='input-group'>                <label>                    <input type='radio' name='sourceType' value='none' data-binding='{checked: isNone}{@event-onchange: handleTypeRadioClick}' />                    <span class='label-text' data-binding='{@text: @language-offlinemapeditor-basemaps-none}'></span>                </label>                <label data-binding='{@visible: supportsStatic}'>                    <input type='radio' name='sourceType' value='pregenerated' data-binding='{checked: isStatic}{@event-onchange: handleTypeRadioClick}' />                    <span class='label-text' data-binding='{@text: @language-offlinemapeditor-basemaps-pregenerated}'></span>                </label>                <label data-binding='{@visible: supportsExportTiles}'>                    <input type='radio' name='sourceType' value='exportTiles' data-binding='{checked: isExportTiles}{@event-onchange: handleTypeRadioClick}' />                    <span class='label-text' data-binding='{@text: @language-offlinemapeditor-basemaps-exporttiles}'></span>                </label>            </div>            <div data-binding='{@visible: isExportTiles}'>                <div class='input-group'>                    <span data-binding='{@text: @language-offlinemapeditor-basemaps-exporttiles-level}'></span>                    <span data-binding='{@text: exportTilesMinLevel}'></span> - <span data-binding='{@text: exportTilesMaxLevel}'></span>                    <button class='button' data-binding='{@text: @language-common-edit}{@event-click: handleEditLevelsClick}'></button>                </div>                <div class='input-group'>                    <label>                        <span data-binding='{@text: @language-offlinemapeditor-basemaps-exporttiles-refresh-label}'></span>                        <input type='number' min='0' pattern='d*' data-binding='{@value: exportTilesRefreshInterval}' />                    </label>                </div>            </div>            <div data-binding='{@visible: isStatic}'>                <select data-binding='{@source: staticTpks}{@value: staticTpk}'>                    <option data-binding='{@template-for: staticTpks}{@text: displayName}{@attach: @context}'></option>                </select>            </div>            <div data-binding='{@hidden: isNone}'>                <span data-binding='{@text: @language-offlinemapeditor-basemaps-size-label}'></span>                <span data-binding='{@text: sizePresentable}'></span>            </div>        </form>        \x3c!-- Errors. --\x3e        <span class='error-message error-message-text' data-binding='{@hidden: supportsAny}{@text: @language-offlinemapeditor-basemaps-nonesupported}'></span>        <span class='error-message error-message-text' data-binding='{@visible: errorConfigurationMessage}{@text: errorConfigurationMessage}'></span>        <span class='error-message error-message-text' data-binding='{@visible: errorExportTilesMessage}{@text: errorExportTilesMessage}'></span>    </div></div><div class='form-btns'>    <button class='button' data-binding='{@text: @language-common-ok}{@event-click: handleBackClick}'></button></div>",a="<div data-binding='{@widget: OfflineMapEditorGeometryActionsWidget}{@widget-required: false}' data-menu-id='OfflineMapEditorGeometryActions' data-menu-template='Mapping/infrastructure/menus/MenuView.html' data-menu-hoist-disabled></div><div class='form-btns'>    <button class='button' data-binding='{@text: @language-common-ok}{@event-click: handleBackClick}'></button></div>",n="<li class='layer' data-binding='{@template-for: items}'>    <div class='layer-item-expander' data-binding='{@visible: isFolder}'>        <button class='tree-expander' data-binding='{@class-expanded: isExpanded}{@noclass-collapsed: isExpanded}{@event-onclick: handleExpanderClick}{title: expanderTooltip}'></button>    </div>    <div class='layer-info'>        <div class='layer-contents'>            <label>                <span class='layer-item-ctrl' data-binding='{@hidden: isFolder}'>                    <input type='checkbox' data-binding='{@value: isEnabled}{checked: isEnabled}{aria-label: stateToggleTooltip}' />                </span>                <span class='layer-item-ctrl layer-list-layer-icon' data-binding='{@visible: iconUri}'><img data-binding='{alt: iconTooltip}{src: iconUri}' /></span>                <span class='display-name label-text' data-binding='{@text: name}'></span>            </label>            <div class='item-child' data-binding='{@hidden: isFolder}'>                <div class='item-options' data-binding='{@visible: isEnabled}'>                    <span data-binding='{@hidden: invalidDefinitionExpression}'>                        <button class='filter-button' data-binding='{@hidden: definitionExpression}{@event-onclick: handleDefinitionExpressionClick}{title: @language-offlinemapeditor-layers-filter-tooltip}'><img data-binding='{alt: @language-offlinemapeditor-layers-filter-tooltip}' src='Resources/Images/Icons/Toolbar/filter-off-24.png' /></button>                        <button class='filter-button' data-binding='{@visible: definitionExpression}{@event-onclick: handleDefinitionExpressionClick}{title: @language-offlinemapeditor-layers-filter-tooltip}'><img data-binding='{alt: @language-offlinemapeditor-layers-filter-tooltip}' src='Resources/Images/Icons/Toolbar/filter-on-24.png' /></button>                    </span>                    <button class='filter-button' data-binding='{@visible: invalidDefinitionExpression}{@event-onclick: handleDefinitionExpressionClick}{title: @language-offlinemapeditor-layers-invalid-definition-expression-title}'><img data-binding='{alt: @language-offlinemapeditor-layers-invalid-definition-expression-title}' src='Resources/Images/Icons/Toolbar/filter-error-24.png' /></button>                    <div class='sub-text'>                        <span data-binding='{@text: numFeatures}{title: numFeaturesTitle}'></span>                        <span data-binding='{@text: @language-offlinemapeditor-layers-feature-count}'></span>                    </div>                    <div class='sub-text'>                        <span data-binding='{@text: editableOrReadOnlyText}'></span>                    </div>                </div>            </div>        </div>    </div>    <ul class='layers' data-binding='{@visible: isExpanded}{@source: items}{@template: Mapping/modules/OfflineMaps/Editor/Layers/LayerSelectorItemTemplate.html}'></ul></li>",s="<div class='profile-layers' data-binding='{@source: layerSelectorViewModel}'>    <div data-binding='{@template-for: layerSelectorViewModel}'>        <ul class='layer-selector-buttons panel-group-contents'>            <li><button class='button layer-actions-button' data-binding='{@text: selectAllButtonText}{title: selectAllButtonTitle}{@event-onclick: selectAllLayers}'></button></li>            <li><button class='button layer-actions-button' data-binding='{@text: clearAllButtonText}{title: clearAllButtonTitle}{@event-onclick: clearAllLayers}'></button></li>        </ul>        <div class='layer-list'>            <ul class='identify-layers layers' data-binding='{@source: items}{@template: Mapping/modules/OfflineMaps/Editor/Layers/LayerSelectorItemTemplate.html}'></ul>        </div>    </div></div><div class='panel-group-contents clear'>    <label>        <input type='checkbox' data-binding='{@value: includeAttachments}'/>        <span class='label-text' data-binding='{@text: @language-offlinemapeditor-layers-attachments-label}{title: @language-offlinemapeditor-layers-attachments-alt}'></span>    </label></div><div class='form-btns'>    <button class='button' data-binding='{@text: @language-common-ok}{@event-click: handleBackClick}'></button></div>",o="<div class='offline-map-editor'>        <span class='error-message' data-binding='{@text: loadError}{@visible: loadError}'></span>    <div class='panel-group-contents'>        <label for='profile_1' data-binding='{@text: @language-offlinemapeditor-name-label}'></label>        <input id='profile_1' type='text' data-binding='{@value: name}{@enabled: canChange}'/>        <div data-binding='{@hidden: canChange}'>            <img src='Resources/Images/Icons/status-alert-16.png' class='status-msg-icon' data-binding='{title: @language-offlinemapeditor-status-title-alert}{alt: @language-offlinemapeditor-status-alt-alert}'>            <span data-binding='{@text: @language-offlinemapeditor-name-cant-change}'></span>        </div>        <div data-binding='{@hidden: name}'>            <img src='Resources/Images/Icons/status-error-16.png' class='status-msg-icon' data-binding='{title: @language-offlinemapeditor-status-title-error}{alt: @language-offlinemapeditor-status-alt-error}'>            <span class='error-message' data-binding='{@text: @language-offlinemapeditor-error-noname}{@hidden: name}'></span>        </div>    </div>    <ul class='list-menu active has-icon'>        <li>            <button class='list-menu-item' data-binding='{@event-onclick: handleGeometryClick}'>                <img class='list-menu-icon' data-binding='{alt: @language-offlinemapeditor-draw-polygon}' src='Resources/Images/Icons/Toolbar/draw-polygon-24.png' />                <span class='list-menu-details'>                    <strong class='list-menu-name' data-binding='{@text: @language-offlinemapeditor-geometry-button}'></strong>                    <span class='list-menu-desc' data-binding='{@text: @language-offlinemapeditor-geometry-description}'></span>                    <span class='list-menu-status-msg' data-binding='{@visible: isGeometryValid}'>                        <img src='Resources/Images/Icons/status-ok-16.png' class='status-msg-icon' data-binding='{@visible: geometryChanged}{title: @language-offlinemapeditor-status-title-ok}{alt: @language-offlinemapeditor-status-alt-ok}'>                        <img src='Resources/Images/Icons/status-default-16.png' class='status-msg-icon' data-binding='{@hidden: geometryChanged}{title: @language-offlinemapeditor-status-title-default}{alt: @language-offlinemapeditor-status-title-default}'>                        <span class='list-menu-desc' data-binding='{@hidden: geometryChanged}{@text: @language-offlinemapeditor-geometry-text-default}'></span>                        <span class='list-menu-desc' data-binding='{@visible: geometryChanged}{@text: @language-offlinemapeditor-geometry-text}'></span>                    </span>                    <span class='list-menu-status-msg' data-binding='{@hidden: isGeometryValid}'>                        <img src='Resources/Images/Icons/status-error-16.png' class='status-msg-icon' data-binding='{title: @language-offlinemapeditor-status-title-error}{alt: @language-offlinemapeditor-status-alt-error}'>                        <span class='error-message' data-binding='{@text: @language-offlinemapeditor-geometry-error-empty}'></span>                    </span>                </span>            </button>        </li>        <li>            <button class='list-menu-item' data-binding='{@event-onclick: handleLayersClick}'>                <img class='list-menu-icon' data-binding='{alt: @language-offlinemapeditor-layers}' src='Resources/Images/Icons/Toolbar/layers-24.png' />                <span class='list-menu-details'>                    <strong class='list-menu-name' data-binding='{@text: @language-offlinemapeditor-layers-button}'></strong>                    <span class='list-menu-desc' data-binding='{@text: @language-offlinemapeditor-layers-description}'></span>                    <span class='list-menu-status-msg' data-binding='{@visible: isLayersValid}'>                        <img src='Resources/Images/Icons/status-ok-16.png' class='status-msg-icon' data-binding='{title: @language-offlinemapeditor-status-title-ok}{alt: @language-offlinemapeditor-status-alt-ok}'>                        <span class='list-menu-desc' data-binding='{@text: layersText}{@visible: isLayersValid}'></span>                    </span>                    <span class='list-menu-status-msg' data-binding='{@hidden: isLayersValid}'>                        <img src='Resources/Images/Icons/status-error-16.png' class='status-msg-icon' data-binding='{title: @language-offlinemapeditor-status-title-error}{alt: @language-offlinemapeditor-status-alt-error}'>                        <span class='error-message' data-binding='{@text: @language-offlinemapeditor-layers-error-empty}'></span>                    </span>                </span>            </button>        </li>        <li>            <button class='list-menu-item' data-binding='{@event-onclick: handleBasemapsClick}'>                <img class='list-menu-icon' data-binding='{alt: @language-offlinemapeditor-basemap}' src='Resources/Images/Icons/basemap-24.png' />                <span class='list-menu-details'>                    <strong class='list-menu-name' data-binding='{@text: @language-offlinemapeditor-basemaps-button}'></strong>                    <span class='list-menu-desc' data-binding='{@text: @language-offlinemapeditor-basemaps-description}'></span>                    <span class='list-menu-status-msg' data-binding='{@visible: isBasemapsValid}'>                        <img src='Resources/Images/Icons/status-ok-16.png' class='status-msg-icon' data-binding='{@visible: hasBasemaps}{title: @language-offlinemapeditor-status-title-ok}{alt: @language-offlinemapeditor-status-alt-ok}'>                        <img src='Resources/Images/Icons/status-default-16.png' class='status-msg-icon' data-binding='{@hidden: hasBasemaps}{title: @language-offlinemapeditor-status-title-default}{alt: @language-offlinemapeditor-status-alt-default}'>                        <span class='list-menu-desc' data-binding='{@text: basemapsText}'></span>                    </span>                    <span class='list-menu-status-msg' data-binding='{@hidden: isBasemapsValid}'>                        <img src='Resources/Images/Icons/status-error-16.png' class='status-msg-icon' data-binding='{title: @language-offlinemapeditor-status-title-error}{alt: @language-offlinemapeditor-status-alt-error}'>                        <span class='error-message' data-binding='{@hidden: isBasemapsCalculating}{@text: @language-offlinemapeditor-basemaps-error}'></span>                        <span class='error-message' data-binding='{@visible: isBasemapsCalculating}{@text: @language-offlinemapeditor-basemaps-error-calculating}'></span>                    </span>                </span>            </button>        </li>        <li>            <button class='list-menu-item' data-binding='{@event-onclick: handleSharingClick}'>                <img class='list-menu-icon' data-binding='{alt: @language-offlinemapeditor-team}' src='Resources/Images/Icons/team-24.png' />                <span class='list-menu-details'>                    <strong class='list-menu-name' data-binding='{@text: @language-offlinemapeditor-sharing-button}'></strong>                    <span class='list-menu-desc' data-binding='{@visible: canChange}{@text: @language-offlinemapeditor-sharing-description}'></span>                    <span class='list-menu-status-msg' data-binding='{@visible: canChange}'>                        <img src='Resources/Images/Icons/status-ok-16.png' class='status-msg-icon' data-binding='{@visible: hasSharing}{title: @language-offlinemapeditor-status-title-ok}{alt: @language-offlinemapeditor-status-alt-ok}'>                        <img src='Resources/Images/Icons/status-default-16.png' class='status-msg-icon' data-binding='{@hidden: hasSharing}{title: @language-offlinemapeditor-status-title-default}{alt: @language-offlinemapeditor-status-alt-default}'>                        <span class='list-menu-desc' data-binding='{@visible: hasSharing}{@text: @language-offlinemapeditor-sharing-text-some}'></span>                        <span class='list-menu-desc' data-binding='{@hidden: hasSharing}{@text: @language-offlinemapeditor-sharing-text-none}'></span>                    </span>                    <span class='list-menu-status-msg' data-binding='{@hidden: canChange}'>                        <img src='Resources/Images/Icons/status-alert-16.png' class='status-msg-icon' data-binding='{title: @language-offlinemapeditor-status-title-alert}{alt: @language-offlinemapeditor-status-alt-alert}'>                        <span class='list-menu-desc' data-binding='{@text: @language-offlinemapeditor-sharing-cant-change}'></span>                    </span>                </span>            </button>        </li>    </ul>    <div class='form-btns'>        <button class='button' data-binding='{@text: @language-offlinemapeditor-button-save}{@enabled: isValid}{@event-click: handleDoneClick}'></button>        <button class='button' data-binding='{@text: @language-common-cancel}{@event-click: handleCancelClick}'></button>    </div></div>",l="<div class='panel-group-contents'>    <div class='share-with'>        <label class='form-label' data-binding='{@text: @language-offlinemapeditor-share-with-label}'></label>    </div>    <div data-binding='{@widget: GrantEditorWidget}{@widget-context: @context}{@widget-replace: true}'></div>    <div data-binding='{@hidden: canChange}{@text: @language-offlinemapeditor-sharing-cant-change}'></div>    <div class='form-btns'>        <button class='button' data-binding='{@text: @language-common-ok}{@event-click: handleBackClick}'></button>    </div></div>",r="<div data-binding='{@widget: ListOfflineMapsActionsWidget}{@widget-required: false}' data-menu-id='ListOfflineMapsActions' data-menu-template='Mapping/infrastructure/menus/MenuView.html'></div><div class='offline-profiles'>    <div class='offline-profile-message error-message'>        <span class='error-message-text' data-binding='{@text: @language-offline-maps-not-native}{@hidden: statusNative}'></span>        <span class='error-message-text' data-binding='{@text: @language-offline-maps-empty-offline}{@visible: statusOffline}'></span>        <span data-binding='{@hidden: statusOffline}'>            <span class='error-message-text' data-binding='{@text: @language-offline-maps-empty-fetching}{@visible: statusFetching}'></span>            <span data-binding='{@hidden: statusFetching}'>                <span class='error-message-text' data-binding='{@text: @language-offline-maps-empty-unsupported}{@visible: statusUnsupported}'></span>                <span data-binding='{@hidden: statusUnsupported}'>                    <span class='error-message-text' data-binding='{@text: @language-offline-maps-empty-empty}{@visible: statusEmpty}'></span>                </span>            </span>        </span>    </div>    <ul class='list-menu profile-list'>        <li class='item-list-item online-only'>            <button class='list-item-button' data-binding='{@event-click: handleDeactivateOfflineMapClick}{@enabled: hasActiveOfflineMap}'>                <span class='offline-thumbnail'><img src='Resources/Images/Icons/map-online-70x50.png' class='list-item-img' data-binding='{alt: @language-offline-maps-use-online-data-desc}' /></span>                <strong class='list-menu-name' data-binding='{@text: @language-offline-maps-use-online-data}'></strong>                <span class='list-menu-desc' data-binding='{@text: @language-offline-maps-use-online-data-desc}'></span>                <span class='status-icon' data-binding='{@hidden: hasActiveOfflineMap}'><span class='status-icon-helper'></span><img src='Resources/Images/Icons/cloud-24.png' alt='Downloaded' /></span>            </button>        </li>    </ul>    <ul class='list-menu profile-list' data-binding='{@hidden: offline}{@source: mergedOfflineMaps}'>        <li class='item-list-item' data-binding='{@template-for: mergedOfflineMaps}{@class-active-list-item: isActive}'>            <button class='list-item-button' data-binding='{@event-click: handleOfflineMapClick}{@disabled: isActive}'>                <span class='offline-thumbnail'><span class='offline-thumbnail-helper'></span><img class='list-item-img' data-binding='{src: thumbnail}{@event-error: handleThumbnailLoadError}' alt=' ' /></span>                <span class='list-menu-name' data-binding='{@text: title}'></span>                <span data-binding='{@hidden: isOrphaned}'>                    <span class='status-icon active-icon' data-binding='{@visible: isActive}'><span class='status-icon-helper'></span><img src='Resources/Images/Icons/device-active-24.png' alt='Active' /></span>                    <span class='status-icon downloaded-icon' data-binding='{@visible: isDownloaded}'><span class='status-icon-helper'></span><img src='Resources/Images/Icons/device-phone-24.png' alt='Downloaded' /></span>                    <span class='status-icon' data-binding='{@hidden: isDownloaded}'><span class='status-icon-helper'></span><img src='Resources/Images/Icons/cloud-download-24.png' alt='Download' /></span>                </span>                <span class='status-icon orphan-icon' data-binding='{@visible: isOrphaned}'><span class='status-icon-helper'></span><img src='Resources/Images/Icons/error-24.png' alt='Profile has been removed from the server' /></span>                <div class='list-menu-desc' data-binding='{@visible: isDownloaded}'>                    <div><span data-binding='{@text: @language-offline-maps-size}'></span><span data-binding='{@text: dataSizeDisplayValue}'></span></div>                    <div><span data-binding='{@text: @language-offline-maps-last-sync-time}'></span><span data-binding='{@text: lastSyncTime}'></span></div>                    <div data-binding='{@visible: isOrphaned}'><span class='orphan-warning' data-binding='{@text: @language-offline-maps-orphaned}'></span></div>                </div>                <span class='list-menu-desc sync-incomplete' data-binding='{@visible: hasProgress}{@text: @language-offline-maps-has-progress}'></span>            </button>            <div data-binding='{@hidden: isActive}'>                <button class='list-item-button action-button' data-binding='{@visible: isDownloaded}{@event-click: handleOfflineMapForgetClick}'><span class='action-button-helper'></span><img src='Resources/Images/Icons/clear-24.png' alt='Remove from Device' /></button>            </div>            <div data-binding='{@visible: isActive}'>                <button class='list-item-button action-button' data-binding='{@visible: isDownloaded}{@event-click: handleOfflineMapSyncClick}'><span class='action-button-helper'></span><span class='icon-container' data-binding='{@class-sync-incomplete: hasProgress}'><img src='Resources/Images/Icons/toolbar/sync-24.png' alt='Sync'/></span></button>            </div>            <span class='edits-badge' data-binding='{@text: numberOfEdits}{@visible: numberOfEdits}'></span>        </li>    </ul></div>",p="<div data-binding='{@widget: ManageOfflineMapsActionsWidget}{@widget-required: false}' data-menu-id='ManageOfflineMapsActions' data-menu-template='Mapping/infrastructure/menus/MenuView.html'></div><div class='offline-profiles panel-group-contents'>    <div class='offline-header-info-text' data-binding='{@visible: switchedToOnlineMap}{@text: @language-offline-maps-manage-showing-online-map}'>    </div>    <div class='offline-profile-message error-message'>        <span class='error-message-text' data-binding='{@text: @language-offline-maps-empty-offline}{@visible: statusOffline}'></span>        <span data-binding='{@hidden: statusOffline}'>            <span data-binding='{@hidden: statusUnsupported}'>                <span class='error-message-text' data-binding='{@text: @language-offline-maps-empty-empty}{@visible: statusEmpty}'></span>            </span>        </span>        <span class='error-message-text' data-binding='{@text: @language-offline-maps-cannot-create}{@hidden: canCreate}'></span>    </div>    <ul class='list-menu profile-manage' data-binding='{@hidden: offline}{@source: docstoreOfflineMaps}'>        <li class='item-list-item' data-binding='{@template-for: docstoreOfflineMaps}{@visible: canEdit}'>            <button class='list-item-button' data-binding='{@event-click: handleEditOfflineMapClick}'>                <span class='offline-thumbnail'><span class='offline-thumbnail-helper'></span><img class='list-item-img' data-binding='{src: thumbnail}{title: title}{@event-error: handleThumbnailLoadError}' alt=' '/></span>                <span class='list-menu-name' data-binding='{@text: title}'></span>                <span class='status-icon' data-binding='{@hidden: isDownloaded}'><span class='status-icon-helper'></span><img src='Resources/Images/Icons/Toolbar/edit-24.png' alt='Edit' /></span>            </button>            <button class='list-item-button button-delete' data-binding='{@event-click: handleDeleteOfflineMapClick}{@visible: canChange}'>                <img src='Resources/Images/Icons/trash-white.png' data-binding='{title: @language-offline-maps-delete-from-server-title}' alt=' '/>            </button>        </li>    </ul>    <div class='form-btns'>        <button class='button' data-binding='{@text: @language-offline-maps-new-button}{@event-click: handleNewOfflineMapClick}{@enabled: canCreate}'></button>        <button class='button' data-binding='{@text: @language-common-done}{@event-click: handleDoneClick}{@visible: showManageDoneButton}'></button>    </div></div>",c="<div class='sync-status padded-view'>    <div>        \x3c!-- Progress | Complete text | Error text--\x3e        <h3 class='sync-status-heading'><span data-binding='{@text: @language-offline-maps-sync-syncing-profile}'></span> <span data-binding='{@text: name}'></span></h3>        <div data-binding='{@visible: isResuming}{@text: @language-offline-maps-sync-resuming}'></div>        <div class='sync-status-spacer'></div>        <div data-binding='{@visible: showProgress}{@widget: syncProgressBar}'></div>        <ul data-binding='{@source: progressModels}'>            <li data-binding='{@template-for: progressModels}'>                <span data-binding='{@text: mapNameDisplay}{@visible: mapNameDisplay}'></span>                <span data-binding='{@text: message}{className: progressClass}'></span>            </li>        </ul>        <div data-binding='{@text: partialDataText}{@visible: partialDataText}'></div>        <div data-binding='{@text: cancellingText}{@visible: cancellingText}'></div>        \x3c!-- Warnings --\x3e        <div class='sync-warning-header' data-binding='{@text: @language-offline-maps-sync-warnings}{@visible: warnings}'></div>        <div class='sync-warnings' data-binding='{@visible: warnings}'>            <ul data-binding='{@source: warnings}'>                <li data-binding='{@template-for: warnings}'>                    <span data-binding='{@text: @context}'></span>                </li>            </ul>        </div>    </div>    \x3c!-- Buttons & Close when done --\x3e    <div class='form-btns'>        <label class='sync-checkbox-close'><input type='checkbox' data-binding='{@value: closeWhenDone}' /><span data-binding='{@text: @language-offline-maps-sync-close-when-done}'></span></label>        <button class='button' data-binding='{@text: @language-common-cancel}{@event-click: handleCancelClick}{@visible: showCancel}{@enabled: canCancel}'></button>        <button class='button' data-binding='{@text: @language-common-close}{@event-click: handleCloseClick}{@visible: showClose}'></button>        <button class='button' data-binding='{@text: @language-offline-maps-delete-keep-button}{@event-click: handleCloseClick}{@visible: partialDataText}'></button>        <button class='button' data-binding='{@text: @language-offline-maps-delete-data-button}{@event-click: handleDeleteData}{@visible: partialDataText}'></button>    </div>    \x3c!-- Details --\x3e    <div class='sync-details'>        <button data-binding='{@class-collapsed: hideStatusText}{@class-expanded: showStatusText}{@event-click: handleToggleDetailsClick}' class='sync-status-details-toggle'>            <span data-binding='{@text: @language-offline-maps-sync-show-details}'></span>        </button>        <div class='sync-status-details' data-binding='{@text: statusText}{@visible: showStatusText}'></div>    </div></div>",d="<div class='progress-bar'>    <div class='progress' data-binding='{@style-width: widthStyle}'></div></div>";function M(e,t,i){if("string"==typeof e&&(i=t,t=e),void 0!==i)for(var a=t.split("."),n=null,s=window,o=0,l=a.length;o<l;o++)n=a[o],o==l-1?s[n]=i:s[n]||(s[n]={}),s=s[n];else console.warn("Undefined shim for: "+t)}require({cache:{"Mapping/modules/OfflineMaps/ListOfflineMapsView":function(){var a,l=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewBase","./OfflineMapsModule"],function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,s=(a=i.ViewBase,l(o,a),o.prototype.attach=function(e){a.prototype.attach.call(this,e),e&&(e.isBusy.bind(this,this._calculateIsBusy),e.mergedOfflineMaps.bind(this,this._offlineMapsChanged))},o.prototype.activated=function(){a.prototype.activated.call(this),this.viewModel.activate()},o.prototype.handleOfflineMapClick=function(e,t,i){var a=this;if(!i.isActive.get())if(i.isDownloaded.get()){if(this.isBusy.get())return;i.isBusy.set(!0),this.app.offlineManager.activateOfflineMap(i.doc,!0).then(function(){i.isBusy.set(!1)},function(e){i.isBusy.set(!1),a.app.trace.error("Failed to activate offline map. "+(e.message||e.toString())),a.app.command("Alert").execute(a.getResource("language-offline-maps-activate-failed"))})}else{if(i.isBusy.get())return;this.app.command("Confirm").execute(this.getResource("language-offline-maps-add-confirm"),i.doc.title,function(e){e&&a._guaranteeOfflineMapContent(i).then(function(e){n.OfflineMapsModule._execCommandFromConfig(a.app,a.configuration.download,{offlineMap:e})},function(e){a.app.trace.error("Failed to download offline map. "+(e.message||e.toString())),a.app.command("Alert").execute(e.message||e.toString())})})}},o.prototype.handleOfflineMapForgetClick=function(e,t,i){var a=this;!i.isDownloaded.get()||i.isActive.get()||i.isBusy.get()||this.app.command("Confirm").execute(this.getResource("language-offline-maps-delete-from-device-confirm"),i.doc.title,function(e){e&&(i.isBusy.set(!0),a.app.offlineManager.removeOfflineMap(i.doc).then(function(){i.isBusy.set(!1),a._calculateIsBusy()},function(e){i.isBusy.set(!1),a.app.command("Alert").execute(e.message||e.toString()),a._calculateIsBusy()}))})},o.prototype.handleOfflineMapSyncClick=function(e,t,i){var a=this;i.isDownloaded.get()&&!i.isBusy.get()&&this.app.site.documentStore.getById(i.doc.id,!0).then(function(e){return e},function(e){return a.app.trace.warning("Error fetching existing offline map: "+e),i.doc}).then(function(e){n.OfflineMapsModule._execCommandFromConfig(a.app,a.configuration.sync,{offlineMap:e})})},o.prototype.handleDeactivateOfflineMapClick=function(e,t,i){var a=this;if(!this.isBusy.get()&&this.viewModel.hasActiveOfflineMap.get()){var n=this.app.offlineManager.getActiveOfflineMap();n&&(this.viewModel.offlineManagerOfflineMaps.get().filter(function(e){return e.doc.id===n.id})[0]?(this.isBusy.set(!0),this.app.offlineManager.deactivateOfflineMap(!0).then(function(){a.isBusy.set(!1)},function(e){a.isBusy.set(!1),a.app.command("Alert").execute(e.message||e.toString())})):this.app.trace.error("Can't find view model matching the active offline map."))}},o.prototype.handleThumbnailLoadError=function(e,t,i){t.src!==this.viewModel.defaultThumbnail&&(t.src=this.viewModel.defaultThumbnail,t.src!==this.viewModel.defaultThumbnail&&(this.viewModel.defaultThumbnail=t.src))},o.prototype.resolveWidget=function(e,t,i){switch(a.prototype.resolveWidget.call(this,e,t,i),e){case"ListOfflineMapsActionsWidget":return this.app.menuRegistry.createMenuWidget(this,t,i)}},o.prototype._guaranteeOfflineMapContent=function(t){return t.doc.content?Promise.resolve(t.doc):this.app.site.documentStore.getById(t.doc.id,!0).then(function(e){return t.update(e),e})},o.prototype._offlineMapsChanged=function(e){for(var t=e.rangeStart;t<=e.rangeEnd;t++){var i=this.viewModel.mergedOfflineMaps.getAt(t);switch(e.type){case"append":case"insert":case"set":this._offlineMapIfBusyBindingTokens[i.doc.id]=i.isBusy.bind(this,this._calculateIsBusy);break;case"remove":case"clear":i.isBusy.unbind(this._offlineMapIfBusyBindingTokens[i.doc.id]),delete this._offlineMapIfBusyBindingTokens[i.doc.id]}}},o.prototype._calculateIsBusy=function(){for(var e=this.viewModel.isBusy.get(),t=0,i=this.viewModel.mergedOfflineMaps.length();!e&&t<i;t++)e=this.viewModel.mergedOfflineMaps.getAt(t).isBusy.get();this.isBusy.set(e)},o);function o(){var e=null!==a&&a.apply(this,arguments)||this;return e._offlineMapIfBusyBindingTokens={},e}t.ListOfflineMapsView=s})},"Mapping/modules/OfflineMaps/ListOfflineMapsViewConfiguration":function(){define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})},"Mapping/modules/OfflineMaps/ManageOfflineMapsView":function(){var a,l=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewBase","./OfflineMapsModule"],function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,s=(a=i.ViewBase,l(o,a),o.prototype.attach=function(e){a.prototype.attach.call(this,e),e&&(this.isBusy.sync(e.isBusy),e.showManageDoneButton.set(!1!==this.configuration.showDonebutton))},o.prototype.activated=function(){a.prototype.activated.call(this),this.viewModel.activate(),this._isManaging||(this.viewModel.startManaging(),this._isManaging=!0)},o.prototype.handleEditOfflineMapClick=function(e,t,i){var a=this;this.isBusy.get()||(i.doc.content?n.OfflineMapsModule._execCommandFromConfig(this.app,this.configuration.editOfflineMap,{offlineMap:i.doc}):(this.isBusy.set(!0),this.app.site.documentStore.getById(i.doc.id,!0).then(function(e){i.update(e),n.OfflineMapsModule._execCommandFromConfig(a.app,a.configuration.editOfflineMap,{offlineMap:i.doc}),a.isBusy.set(!1)},function(e){a.app.trace.error("Error fetching offlinemap document. "+(e.message||e));var t=a.getResource("language-offline-maps-fetch-error"),i=a.getResource("language-offline-maps-fetch-error-title");a.app.command("Alert").execute(t,i),a.isBusy.set(!1)})))},o.prototype.handleDeleteOfflineMapClick=function(e,t,i){var a=this;this.isBusy.get()||this.app.command("Confirm").execute(this.getResource("language-offline-maps-delete-from-server").format(i.title.get()),this.getResource("language-offline-maps-delete-from-server-title"),function(e){e&&a.viewModel.deleteOfflineMap(i)})},o.prototype.handleNewOfflineMapClick=function(e,t,i){this.isBusy.get()||n.OfflineMapsModule._execCommandFromConfig(this.app,this.configuration.newOfflineMap)},o.prototype.handleDoneClick=function(e,t,i){this.app.command("DeactivateView").execute(this.id),this._stopManaging()},o.prototype._onViewContainerViewClosedEvent=function(e){e.viewId===this.id&&this._stopManaging()},o.prototype._stopManaging=function(){this.viewModel.stopManaging(),this._isManaging=!1},o.prototype.handleThumbnailLoadError=function(e,t,i){t.src!==this.viewModel.defaultThumbnail&&(t.src=this.viewModel.defaultThumbnail,t.src!==this.viewModel.defaultThumbnail&&(this.viewModel.defaultThumbnail=t.src))},o.prototype.resolveWidget=function(e,t,i){switch(a.prototype.resolveWidget.call(this,e,t,i),e){case"ManageOfflineMapsActionsWidget":return this.app.menuRegistry.createMenuWidget(this,t,i)}},o);function o(e,t){var i=a.call(this,e,t)||this;return i._isManaging=!1,i.app.event("ViewContainerViewClosedEvent").subscribe(i,i._onViewContainerViewClosedEvent),i}t.ManageOfflineMapsView=s})},"Mapping/modules/OfflineMaps/ManageOfflineMapsViewConfiguration":function(){define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})},"Mapping/modules/OfflineMaps/ModuleConfig":function(){define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})},"Mapping/modules/OfflineMaps/OfflineMapModel":function(){var a,r=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewModelBase","geocortex/framework/observables","geocortex/infrastructure/FormatUtils"],function(e,t,i,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,a=(o=i.ViewModelBase,r(l,o),l.prototype._getDisplayBytes=function(e){var t=e/1024,i=t/1024,a=i/1024;return 1<=a?this.getResource("language-offline-maps-size-gb").format(s.formatNumber(a,null,{fractionalDigits:2})):1<=i?this.getResource("language-offline-maps-size-mb").format(s.formatNumber(i,null,{fractionalDigits:1})):this.getResource("language-offline-maps-size-kb").format(s.formatNumber(t,null,{fractionalDigits:0}))},l.prototype.update=function(e){this.doc=e,this.title.set(e.title),this.thumbnail.set(e.thumbnail?e.thumbnail.location:null),this.canEdit.set(e.access.edit),this.canChange.set(e.access.change)},l);function l(e,t,i){var a=o.call(this,e,t)||this;return a.title=new n.Observable,a.thumbnail=new n.Observable,a.isBusy=new n.Observable(!1),a.isActive=new n.Observable(!1),a.isDownloaded=new n.Observable(!1),a.hasProgress=new n.Observable(!1),a.isOrphaned=new n.Observable(!1),a.canEdit=new n.Observable(!1),a.canChange=new n.Observable(!1),a.numberOfEdits=new n.Observable(0),a.lastSyncTime=new n.Observable(""),a.dataSizeBytes=new n.Observable(0),a.dataSizeDisplayValue=new n.Observable("â€¦"),a.update(i),a.dataSizeDisplayValue.syncTransform(a.dataSizeBytes,function(e){return a._getDisplayBytes(e)}),a}t.OfflineMapModel=a})},"Mapping/modules/OfflineMaps/OfflineMapsModule":function(){var a,o=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/application/ModuleBase","geocortex/infrastructure/ArrayUtils"],function(e,t,i,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,n=(a=i.ModuleBase,o(s,a),s.prototype.initialize=function(e){var t=this;a.prototype.initialize.call(this,e),this.app.offlineManager.aoiMask.configure(e.aoiMask),this.app.nativeManager.onNativeInitialized().then(function(){t.app.isNative.get()&&(t.app.event("MapLoadedEvent").subscribe(t,t._handleMapLoadedEvent),t.app.event("SyncInfoRefreshedEvent").subscribe(t,t._syncInfoRefreshedEventHandler))})},s._execCommandsFromConfig=function(t,e,i){var a=this;e&&e.forEach(function(e){return a._execCommandFromConfig(t,e,i)})},s._execCommandFromConfig=function(e,t,i){if(t){var a=t.commandParameter;a&&i&&(a=s._replaceCommandParameterTokens(a,i)),e.command(t.command).execute(a)}},s._replaceCommandParameterTokens=function(e,t){var i,a=this;if("string"==typeof e)return i=/{{(.+)}}/.exec(e),n=t[i[1]];var n={};for(var s in e)e.hasOwnProperty(s)&&("string"==typeof e[s]&&(i=/{{(.+)}}/.exec(e[s]))&&t.hasOwnProperty(i[1])?n[s]=t[i[1]]:dojo.isArray(e[s])?n[s]=e[s].map(function(e){return a._replaceCommandParameterTokens(e,t)}):"object"==typeof e[s]?n[s]=this._replaceCommandParameterTokens(e[s],t):n[s]=e[s]);return n},s.prototype._checkForInternetAndDisplayNotification=function(){var t=this,i=!1;this.app.offlineManager.hasInternetCheck().then(function(e){i=e.result}),setInterval(function(){t.app.offlineManager.hasInternetCheck().then(function(e){i!=e.result&&((i=e.result)?(t.displayOnlineSyncNotification(),t.app.command("RemoveNotification").execute(t._syncNotificationOfflineString)):(t.displayOfflineSyncNotification(),t.app.command("RemoveNotification").execute(t._syncNotificationString),t.app.command("RemoveNotification").execute(t._oneWeekSyncNotificationString))),t.app.event("NetworkConnectivityChangedEvent").publish(i)})},6e4)},s.prototype._shouldDisplayWeeklyNotification=function(e,t){return 6<this._daysBetween(e,new Date)&&6<this._daysBetween(t,new Date)},s.prototype._syncInfoRefreshedEventHandler=function(e){this.displayOnlineSyncNotification()},s.prototype._handleMapLoadedEvent=function(){var t=this;this._checkForInternetAndDisplayNotification(),this.app.offlineManager.hasInternetCheck().then(function(e){e?t.displayOnlineSyncNotification():t.displayOfflineSyncNotification()})},s.prototype.displayOfflineSyncNotification=function(){var n=this,e=this.app.offlineManager.getOfflineMapsWithState();if(e){var s=0;e.forEach(function(e,t){e.syncInfoPromise.then(function(e){var t=f.ArrayUtils.sum(e.servers,function(e){return e.numberOfAdds+e.numberOfDeletes+e.numberOfEdits});if(0<(s+=t)){var i=n.getResource("language-offline-maps-unsynced-edits-offline").format(s);1==s&&(i=n.getResource("language-offline-maps-unsynced-edit-offline"));var a={id:n._syncNotificationOfflineString,text:i,iconProperties:{uri:"Resources/Images/Icons/toolbar/sync-24.png",altText:"Sync Button"},closeButton:{}};n.app.command("DisplayNotification").execute(a)}})})}},s.prototype.displayOnlineSyncNotification=function(){var d=this;this.app.offlineManager.hasInternetCheck().then(function(e){if(e.result){var t=d.app.offlineManager.getOfflineMapsWithState();if(t){d.app.command("RemoveNotification").execute(d._oneWeekSyncNotificationString);var l=[],r=0,p=new Date,c=new Date;t.forEach(function(o,e){o.syncInfoPromise.then(function(e){var t=f.ArrayUtils.sum(e.servers,function(e){return e.numberOfAdds+e.numberOfDeletes+e.numberOfEdits}),i=!1;0<t&&(l.push(o.offlineMap),i=!0),r+=t;var a=e.getOldestSyncTime();if(!i&&d._daysBetween(a,new Date)&&l.push(o.offlineMap),a<p&&(p=a),c>e.lastSyncNotificationDate&&(c=e.lastSyncNotificationDate),0<r){var n=d.getResource("language-offline-maps-unsynced-edits").format(r);1==r&&(n=d.getResource("language-offline-maps-unsynced-edit"));var s={id:d._syncNotificationString,text:n,iconProperties:{uri:"Resources/Images/Icons/toolbar/sync-24.png",altText:"Sync Button"},buttons:[{text:d.getResource("language-offline-maps-sync-now-button"),callback:function(){d.app.command("StartOfflineFeatureSync").execute({offlineMaps:l})}}]};d.app.command("DisplayNotification").execute(s)}else d.app.command("RemoveNotification").execute(d._syncNotificationString),d._shouldDisplayWeeklyNotification(p,c)&&(s={id:d._oneWeekSyncNotificationString,text:d.getResource("language-offline-maps-not-synced-in-one-week").format(d._daysBetween(p,new Date)),iconProperties:{uri:"Resources/Images/Icons/toolbar/sync-24.png",altText:"Sync Button"},buttons:[{text:d.getResource("language-offline-maps-sync-now-button"),callback:function(){d.app.command("StartOfflineFeatureSync").execute({offlineMaps:l})}}],closeButton:{callback:function(){d.app.nativeManager.message("SaveSyncJsonData",{localServerNamespace:d.app.localServerNamespace,lastSyncNotificationDate:new Date})}}},d.app.command("DisplayNotification").execute(s))})})}else d.app.command("RemoveNotification").execute(d._syncNotificationString)}else d.app.command("RemoveNotification").execute(d._syncNotificationString),d.app.command("RemoveNotification").execute(d._oneWeekSyncNotificationString)})},s.prototype._daysBetween=function(e,t){var i=e.getTime(),a=t.getTime()-i;return Math.floor(a/864e5)},s);function s(){var e=null!==a&&a.apply(this,arguments)||this;return e._syncNotificationString="SyncNotifications",e._oneWeekSyncNotificationString="OneWeekSyncNotification",e._syncNotificationOfflineString="SyncNotificationsOffline",e}t.OfflineMapsModule=n})},"Mapping/modules/OfflineMaps/OfflineMapsViewModel":function(){var a,f=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewModelBase","geocortex/framework/observables","./OfflineMapModel","geocortex/infrastructure/offline/OfflineMap","geocortex/infrastructure/ArrayUtils","geocortex/infrastructure/FormatUtils"],function(e,t,i,a,r,p,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,s=(n=i.ViewModelBase,f(o,n),o.prototype.initialize=function(e){var t=this;n.prototype.initialize.call(this,e),this.defaultThumbnail=e.defaultThumbnail,this.mergedOfflineMaps.bind(this,function(){t.statusEmpty.set(0===t.mergedOfflineMaps.length())}),this.app.nativeManager.onNativeInitialized().then(function(){t.statusNative.set(!0)}),this.app.waitUntilSiteInitialized().then(function(){return t.app.site.documentStore.onInitialized()}).then(function(){return t.canCreate.set(t.app.site.documentStore.canCreate())}),this._downloadedOfflineMapsLoaded({offlineMaps:this.app.offlineManager.getOfflineMaps(),activeOfflineMap:this.app.offlineManager.getActiveOfflineMap(),offlineMapStates:this.app.offlineManager.getOfflineMapsWithState().map(function(e){return e.state})}),this.app.command("RefreshOfflineMapsList").register(this,this.populateFromDocStore),this.app.event("OfflineMapsLoadedEvent").subscribe(this,this._downloadedOfflineMapsLoaded),this.app.event("OfflineMapAddedEvent").subscribe(this,this._downloadedOfflineMapAdded),this.app.event("OfflineMapRemovedEvent").subscribe(this,this._refreshOfflineMapStatus),this.app.event("OfflineMapPartialDataRemovedEvent").subscribe(this,this._refreshOfflineMapStatus),this.app.event("OfflineMapSyncedEvent").subscribe(this,this._downloadedOfflineMapSynced),this.app.event("OfflineMapSyncErrorEvent").subscribe(this,this._downloadedOfflineMapSyncError),this.app.event("OfflineMapActivatedEvent").subscribe(this,this._offlineMapActivated),this.app.event("SyncInfoRefreshedEvent").subscribe(this,this._onSyncInfoRefreshed),this.app.event("NetworkConnectivityChangedEvent").subscribe(this,this._onNetworkConnectivityChangedEvent),e.saveOfflineMaps&&this.app.event("OfflineMapEditorFinishedEvent").subscribe(this,this._onOfflineMapEditorFinishedEvent),e.menus&&this.app.menuRegistry&&this.app.menuRegistry.loadMenus({menus:e.menus})},o.prototype.activate=function(){var e=this;this._activated||(this._activated=!0,this.app.waitUntilSiteInitialized().finally(function(){e.statusUnsupported.set(!e.app.site.documentStore.supported),e.populateFromDocStore()}))},o.prototype.startManaging=function(){this.app.nativeManager.nativeInitialized&&(this._offlineMapWhenManagingStarted=this.app.offlineManager.getActiveOfflineMap(),this._offlineMapWhenManagingStarted&&this.app.offlineManager.deactivateOfflineMap(!1),this.switchedToOnlineMap.set(!!this._offlineMapWhenManagingStarted))},o.prototype.stopManaging=function(){this.app.nativeManager.nativeInitialized&&this._offlineMapWhenManagingStarted&&this.app.offlineManager.activateOfflineMap(this._offlineMapWhenManagingStarted,!1)},o.prototype.populateFromDocStore=function(){var t=this;if(this.app.site.documentStore.supported&&this._activated){this.isBusy.set(!0),this.statusFetching.set(!0);var e={filters:{require:[{field:"fileType",method:"values",range:[{string:"offlinemap"}]},{field:"properties.siteId.string",method:"values",range:[{string:this.app.site.id}]}]},limit:this._queryPageSize};this._queryDocStore(e,0,[]).then(function(e){t._populated=!0,t.statusOffline.set(!1),t.docstoreOfflineMaps.set(e)}).catch(function(e){t.statusOffline.set(!0),t.app.trace.error("Unable to fetch offline maps. "+e)}).then(function(){t.statusFetching.set(!1),t.updateMergedOfflineMaps()}).catch(function(e){t.app.trace.error("Unable to update metadata for offline maps. "+e)}).finally(function(){t.isBusy.set(!1)})}},o.prototype._queryDocStore=function(i,a,n){var s=this;return i.start=a,this.app.waitUntilSiteInitializing().then(function(){return s.app.site.principal.isAuthenticated?Promise.resolve():s.app.site.refreshPrincipal()}).then(function(){return s.app.site.documentStore.query(i)}).then(function(e){var t=e.results.map(function(e){return new r.OfflineMapModel(s.app,s.libraryId,e.entity)});return 0<t.length&&(n=n.concat(t)),t.length===i.limit?s._queryDocStore(i,a+i.limit,n):Promise.resolve(n.sort(l))})},o.prototype.deleteOfflineMap=function(i){var a=this;this.app.site.documentStore.supported&&(this.isBusy.set(!0),this.app.site.documentStore.deleteById(i.doc.id).then(function(){a.isBusy.set(!1),a.docstoreOfflineMaps.removeItem(i),a.updateMergedOfflineMaps()},function(e){if(a.isBusy.set(!1),e.error&&404===e.error.code)return a.docstoreOfflineMaps.removeItem(i),void a.updateMergedOfflineMaps();var t=e.message||e.error&&e.error.message||e.toString();a.app.command("Alert").execute(t,a.getResource("language-offline-maps-delete-from-server-title"))}))},o.prototype.updateOfflineManagerOfflineMaps=function(){var i=this,e=this.app.offlineManager.getOfflineMapsWithState().map(function(e){var t=new r.OfflineMapModel(i.app,i.libraryId,e.offlineMap);return t.isDownloaded.set(e.state.isDownloaded),t.hasProgress.set(e.state.hasProgress),t});return this.offlineManagerOfflineMaps.set(e),this.offlineManagerOfflineMaps},o.prototype.updateMergedOfflineMaps=function(){for(var e=this.app.offlineManager.getActiveOfflineMap(),t=this._calculateMergedOfflineMaps(),i=0,a=t;i<a.length;i++){var n=a[i];this._updateMetadataForOfflineMap(n),e&&n.doc.id===e.id&&n.isActive.set(!0)}this.mergedOfflineMaps.set(t)},o.prototype._calculateMergedOfflineMaps=function(){var i=this,e=this.updateOfflineManagerOfflineMaps().get(),a=this.docstoreOfflineMaps.get();return this._populated&&e.forEach(function(t){var e=i.app.site.documentStore.isInitialized&&i.app.site.documentStore.userMonikers.some(function(e){return t.doc.access&&t.doc.access.monikerIds&&-1!==t.doc.access.monikerIds.indexOf(e.id)})&&!a.some(function(e){return e.doc.id===t.doc.id});t.isOrphaned.set(e)}),a=a.filter(function(t){return!e.some(function(e){return e.doc.id===t.doc.id})}),e.concat(a).sort(l)},o.prototype._downloadedOfflineMapsLoaded=function(e){this.updateMergedOfflineMaps(),this._offlineMapActivated({offlineMap:e.activeOfflineMap})},o.prototype._downloadedOfflineMapAdded=function(e){this.updateMergedOfflineMaps()},o.prototype._refreshOfflineMapStatus=function(e){this.updateMergedOfflineMaps()},o.prototype._offlineMapActivated=function(e){this.hasActiveOfflineMap.set(!!e.offlineMap);for(var t=0,i=this.offlineManagerOfflineMaps.length();t<i;t++){var a=this.offlineManagerOfflineMaps.getAt(t);a.isActive.set(null!=e.offlineMap&&e.offlineMap.id===a.doc.id)}},o.prototype._downloadedOfflineMapSynced=function(e){for(var t=0,i=this.offlineManagerOfflineMaps.length();t<i;t++){var a=this.offlineManagerOfflineMaps.getAt(t);if(a.doc.id===e.offlineMap.id)return a.update(e.offlineMap),void this._updateMetadataForOfflineMap(e.offlineMap)}},o.prototype._downloadedOfflineMapSyncError=function(e){this._updateMetadataForOfflineMap(e.offlineMap)},o.prototype._refreshActiveMapState=function(){this.hasActiveOfflineMap.get()&&this._getActiveMap().isActive.set(!0)},o.prototype._getActiveMap=function(){if(this.hasActiveOfflineMap.get())for(var e=this.app.offlineManager.getActiveOfflineMap().id,t=0;t<this.mergedOfflineMaps.length();t++){var i=this.mergedOfflineMaps.getAt(t);if(i.doc.id===e)return i}},o.prototype._onSyncInfoRefreshed=function(e){this._updateMetadataForOfflineMap(e.offlineMap)},o.prototype._onNetworkConnectivityChangedEvent=function(e){this.populateFromDocStore()},o.prototype._updateMetadataForOfflineMap=function(t){var i=this;if(!this.app.nativeManager.nativeInitialized)return Promise.resolve();var a=t instanceof r.OfflineMapModel?t:this.mergedOfflineMaps.get().filter(function(e){return e.doc.id===t.id})[0];if(!a)return Promise.reject("Offline map not downloaded.");var n=[];a.dataSizeBytes.set(0);var s=0,o=a.lastSyncTime.get(),l=null,e=this.app.offlineManager.getOfflineMapWithStateById(a.doc.id);return e&&n.push(e.syncInfoPromise.then(function(e){s=c.ArrayUtils.sum(e.servers,function(e){return e.numberOfAdds+e.numberOfDeletes+e.numberOfEdits}),o=d.formatDate(c.ArrayUtils.max(e.servers,function(e){return e.lastSyncTime})),l=a.dataSizeBytes.get()+c.ArrayUtils.sum(e.servers,function(e){return e.totalSizeInBytes})}).finally(function(){a.numberOfEdits.set(s),a.lastSyncTime.set(o),a.dataSizeBytes.set(l)})),a.doc.content&&a.doc.content.basemaps.filter(function(e){return e.sourceType===p.OfflineMapBasemap.Type.EXPORT_TILES}).forEach(function(e){n.push(i.app.nativeManager.getViewerResourceInfo(e.filename).then(function(e){"number"==typeof e.length&&a.dataSizeBytes.set(a.dataSizeBytes.get()+e.length)}))}),a.hasProgress.set(!!e&&e.state.hasProgress),Promise.all(n)},o.prototype._onOfflineMapEditorFinishedEvent=function(e){var a=this;if(this.app.site.documentStore.supported&&!e.canceled)if(e.newOfflineMap.contentType="application/json",e.newOfflineMap.fileType="offlinemap",e.existingOfflineMap){e.newOfflineMap.id=e.existingOfflineMap.id;var t=p.OfflineMap.diff(e.existingOfflineMap,e.newOfflineMap);if(!t)return void this.app.trace.warning("OfflineMapEditorFinishedEvent called without any changes to send.  Bailing.");t.content&&(t.content=e.newOfflineMap.content),this.isBusy.set(!0),this.app.site.documentStore.updateById(e.existingOfflineMap.id,t).then(function(e){a.isBusy.set(!1);for(var t=0;t<a.docstoreOfflineMaps.length();t++)if(a.docstoreOfflineMaps.getAt(t).doc.id===e.id){a.docstoreOfflineMaps.getAt(t).update(e);break}},function(e){a.isBusy.set(!1),a.app.trace.error("Error updating offline map in doc store. "+(e.message||e));var t=a.getResource("language-offline-maps-update-profile-error").format(e.message||e),i=a.getResource("language-offline-maps-update-profile-error-title");a.app.command("Alert").execute(t,i)})}else this.isBusy.set(!0),this.app.site.documentStore.add(e.newOfflineMap).then(function(e){a.isBusy.set(!1);var t=new r.OfflineMapModel(a.app,a.libraryId,e),i=a.docstoreOfflineMaps.get().concat([t]).sort(l);a.docstoreOfflineMaps.set(i),a.updateMergedOfflineMaps()},function(e){a.isBusy.set(!1),a.app.trace.error("Error adding offline map to doc store. "+(e.message||e));var t=a.getResource("language-offline-maps-add-error").format(e.message||e),i=a.getResource("language-offline-maps-add-error-title");a.app.command("Alert").execute(t,i)})},o);function o(){var e=null!==n&&n.apply(this,arguments)||this;return e.docstoreOfflineMaps=new a.ObservableCollection,e.offlineManagerOfflineMaps=new a.ObservableCollection,e.mergedOfflineMaps=new a.ObservableCollection,e.canCreate=new a.Observable(!1),e.hasActiveOfflineMap=new a.Observable(!1),e.showManageDoneButton=new a.Observable(!0),e.switchedToOnlineMap=new a.Observable(!1),e.isBusy=new a.Observable(!1),e.statusFetching=new a.Observable(!1),e.statusEmpty=new a.Observable(!1),e.statusOffline=new a.Observable(!1),e.statusUnsupported=new a.Observable(!1),e.statusNative=new a.Observable(!1),e._activated=!1,e._populated=!1,e._queryPageSize=20,e}function l(e,t){return(e.doc.title||"").toLocaleLowerCase().localeCompare((t.doc.title||"").toLocaleLowerCase())}t.OfflineMapsViewModel=s})},"Mapping/modules/OfflineMaps/OfflineMapsViewModelConfiguration":function(){define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})},"Mapping/modules/OfflineMaps/Editor/MapState":function(){define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(a.prototype.restore=function(){var t=this;this.appInfo.map.setExtent(this.extent),this.appInfo.mapInfo.getLayerInfos().forEach(function(e){if(t.layers.hasOwnProperty(e.uniqueId))try{e.setEsriLayerVisibility(t.layers[e.uniqueId].visible),e.setDefinitionExpression(t.layers[e.uniqueId].definitionExpression)}catch(e){}})},a);function a(e){var t=this;this.appInfo=e,this.extent=e.map.extent,this.layers={},e.mapInfo.getLayerInfos().forEach(function(e){t.layers[e.uniqueId]={visible:e.isVisible(),definitionExpression:e.getDefinitionExpression()}})}t.MapState=i})},"Mapping/modules/OfflineMaps/Editor/OfflineMapEditorBasemap":function(){define(["require","exports","geocortex/framework/observables","geocortex/infrastructure/offline/OfflineMap","geocortex/essentials/MapServiceConstants","geocortex/infrastructure/ExportTilesUtils","geocortex/framework/utils/utils","geocortex/infrastructure/offline/BasemapDownloading"],function(e,t,n,s,o,l,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(p.prototype.load=function(e){var t=this;switch(this.type.set(e.sourceType),this.filename.set(e.filename),this._exportFileName=null,e.sourceType){case s.OfflineMapBasemap.Type.PREGENERATED:this._staticTpksSet?this._setStaticTpkByUrl(e.url):this.staticTpks.once(this,function(){t._setStaticTpkByUrl(e.url)});break;case s.OfflineMapBasemap.Type.EXPORT_TILES:this.exportTilesMinLevel.set(Math.max(e.minLevel,this.app.map.getMinZoom())),this.exportTilesMaxLevel.set(Math.min(e.maxLevel,this.app.map.getMaxZoom())),this.exportTilesRefreshInterval.set(this._sanitizeRefreshInterval(e.refreshInterval)),this._exportFileName=e.filename;break;default:throw new Error("Unknown sourceType.")}},p.prototype.save=function(){switch(this.type.get()){case"none":throw new Error("This OfflineMapBasemap is set to none and not savable.");case s.OfflineMapBasemap.Type.PREGENERATED:return{baseMapId:this.source.id,sourceType:this.type.get(),url:this.staticTpk.get()?this.staticTpk.get().url:null,filename:this.filename.get(),size:Math.max(this.size.get(),0)};case s.OfflineMapBasemap.Type.EXPORT_TILES:return{baseMapId:this.source.id,sourceType:this.type.get(),url:this._exportTilesMapServiceUri,filename:this.filename.get(),minLevel:this.exportTilesMinLevel.get(),maxLevel:this.exportTilesMaxLevel.get(),size:Math.max(this.size.get(),0),refreshInterval:this._sanitizeRefreshInterval(this.exportTilesRefreshInterval.get())};default:throw new Error("Unknown sourceType.")}},p.prototype.reset=function(){this.type.set("none"),this.staticTpks.isEmpty()||this.staticTpk.set(this.staticTpks.getAt(0)),this.exportTilesMinLevel.set(Math.max(this.exportTilesMapServiceMinLevel.get(),this.app.map.getMinZoom())),this.exportTilesMaxLevel.set(Math.min(this.exportTilesMapServiceMaxLevel.get(),this.app.map.getMaxZoom())),this.exportTilesRefreshInterval.set(0),this._exportFileName=null},p.prototype._calculateExportTilesMapServiceUri=function(){var i=this;if(this.errorConfigurationMessage.set(null),this.source.exportTilesMapServiceUri)this._getExportTilesMapServiceInfo(this.source.exportTilesMapServiceUri).then(function(e){return i._enableExportTilesSupport(i.source.exportTilesMapServiceUri,e)},function(e){i.app.trace.warning("Unable to use configured Map Service '"+i.source.exportTilesMapServiceUri+"' to create the Custom Offline Basemap. "+(e.message||e)),e.message&&/No token available for service /.test(e.message)?i.errorConfigurationMessage.set(i.getResource("language-offlinemapeditor-basemaps-exporttiles-error-agollogin")):e.error&&499==e.error.code?i.errorConfigurationMessage.set(i.getResource("language-offlinemapeditor-basemaps-exporttiles-error-auth")):i.errorConfigurationMessage.set(i.getResource("language-offlinemapeditor-basemaps-exporttiles-error-misconfigured")),i._exportTilesMapServiceUri=null,i.supportsExportTiles.set(!1)});else{var a=this.source.services.map(function(e){return e.mapService.serviceUrl}).filter(function(e){return!!e}),e=a.map(function(e){return i._getExportTilesMapServiceInfo(e)}),n=function(t){t>=e.length?(i._exportTilesMapServiceUri=null,i.supportsExportTiles.set(!1)):e[t].then(function(e){return i._enableExportTilesSupport(a[t],e)},function(){return n(t+1)})};n(0)}},p.prototype._getExportTilesMapServiceInfo=function(e){var t=r.getServiceTokenForMapService(this.app,e);return esri.request({callbackParamName:"callback",content:t?{f:"json",token:t}:{f:"json"},handleAs:"json",url:e}).then(function(e){if(!e.currentVersion||!e.tileInfo)throw new Error("Not a map service.");if(e.currentVersion<10.2)throw new Error("Version not supported.");if(!e.exportTilesAllowed)throw new Error("Export tiles not supported.");return e})},p.prototype._enableExportTilesSupport=function(e,t){var i=t.tileInfo;this._exportTilesMapServiceUri=e,this.exportTilesMapServiceMinLevel.set(i.lods[0].level),this.exportTilesMapServiceMaxLevel.set(i.lods[i.lods.length-1].level),this.supportsExportTiles.set(this._hasTiledMapService)},p.prototype._setStaticTpkByUrl=function(e){var t,i=this.staticTpks.length();for(t=0;t<i&&this.staticTpks.getAt(t).url!==e;t++);t===i&&(t=0),this.staticTpk.set(this.staticTpks.getAt(t))},p.prototype._calculateSize=function(){var s=this;this._calculateSizeHandle&&clearTimeout(this._calculateSizeHandle),this.errorExportTilesMessage.set(null);var e=p.sizeUnknown,o=++this._calculateSizeGen;this.isExportTiles.get()?(e=p.sizeCalculating,this._calculateSizeHandle=setTimeout(function(){if(o===s._calculateSizeGen){var e=s.geometry.get();if(e){var t=s.exportTilesMinLevel.get(),i=s.exportTilesMaxLevel.get(),a=t!==i?t+"-"+i:""+t,n=r.getServiceTokenForMapService(s.app,s._exportTilesMapServiceUri);l.estimateExportTilesSize(s._exportTilesMapServiceUri,{tilePackage:!0,optimizeTilesForSize:!0,compressionQuality:90,exportBy:"levelId",levels:a,areaOfInterest:JSON.stringify({features:[{geometry:e.toJson()}]}),token:n}).then(function(e){o===s._calculateSizeGen&&(e&&"number"==typeof e.totalSize?s.size.set(e.totalSize):(s.app.trace.error('ExportTilesUtils.estimateExportTilesSize returned unexpected result. "'+JSON.stringify(e)+'"'),s.size.set(p.sizeUnknown)))},function(e){if(o===s._calculateSizeGen){var t=e&&e.message?e.message:e;s.errorExportTilesMessage.set(t),s.app.trace.error("Error fetching TPK size: "+t),s.size.set(p.sizeInvalid)}})}else s.size.set(p.sizeUnknown)}},2e3)):this.isStatic.get()&&this.staticTpk.get()&&(e=this.staticTpk.get().size),this.size.set(e)},p.prototype._calculateFileName=function(){var e=null;if(this.isStatic.get()){var t=this.staticTpk.get();e=t?t.filename:null}else if(this.isExportTiles.get()){if(!this._exportFileName){var i=/([^\/]+)\/MapServer\/?/.exec(this._exportTilesMapServiceUri);this._exportFileName=encodeURIComponent(i?i[1]:this.source.id)+"-"+a.alphaNumericToken(12)+".tpk"}e=this._exportFileName}this.filename.set(e)},p.prototype._calculateIsValid=function(){var e=!1;this.isNone.get()?e=!0:this.isStatic.get()?e=!0:this.isExportTiles.get()&&(e=0<=this.size.get()),this.isValid.set(e)},p.prototype._formatBytes=function(e){if(-3===e)return this.app.getResource(this.libraryId,"language-offlinemapeditor-basemaps-size-invalid");if(-2===e)return this.app.getResource(this.libraryId,"language-offlinemapeditor-basemaps-size-calculating");if(-1===e)return this.app.getResource(this.libraryId,"language-offlinemapeditor-basemaps-size-unknown");if(0===e)return"0";var t;for(t=0;1e3<e;t++)e/=1e3;return e.toFixed(0<t?2:0)+" "+["B","KB","MB","GB","TB","PB"][t]},p.prototype._sanitizeRefreshInterval=function(e){var t=parseInt(e);return isNaN(t)&&(t=0),t<0&&(t=0),t},p.prototype.getResource=function(e){return this.app.getResource(this.libraryId,e)},p.sizeUnknown=-1,p.sizeCalculating=-2,p.sizeInvalid=-3,p);function p(e,t,i){var a=this;this.app=e,this.libraryId=t,this.source=i,this.type=new n.Observable(null),this.isNone=new n.Observable(!0),this.isStatic=new n.Observable(!1),this.isExportTiles=new n.Observable(!1),this.isValid=new n.Observable(!0),this.geometry=new n.Observable(null),this.supportsStatic=new n.Observable(!1),this.supportsExportTiles=new n.Observable(!1),this.supportsAny=new n.Observable(!1),this.staticTpks=new n.ObservableCollection([]),this.staticTpk=new n.Observable(null),this.exportTilesMinLevel=new n.Observable(0),this.exportTilesMaxLevel=new n.Observable(22),this.exportTilesMapServiceMinLevel=new n.Observable(0),this.exportTilesMapServiceMaxLevel=new n.Observable(22),this.exportTilesRefreshInterval=new n.Observable(0),this.filename=new n.Observable(""),this.displayName=new n.Observable(""),this.iconUri=new n.Observable(""),this.size=new n.Observable(p.sizeUnknown),this.sizePresentable=new n.Observable(""),this.errorConfigurationMessage=new n.Observable(null),this.errorExportTilesMessage=new n.Observable(null),this._hasTiledMapService=!1,this._staticTpksSet=!1,this._exportFileName=null,this._calculateSizeGen=1,this.displayName.set(i.displayName),this.iconUri.set(i.iconUri),this.type.bind(this,function(e){a.isNone.set("none"===e),a.isStatic.set(e===s.OfflineMapBasemap.Type.PREGENERATED),a.isExportTiles.set(e===s.OfflineMapBasemap.Type.EXPORT_TILES),a._calculateSize(),a._calculateFileName()}),this.staticTpks.bind(this,function(){a._staticTpksSet=!0;var e=a.staticTpks.isEmpty();a.supportsStatic.set(a._hasTiledMapService&&!e),a.staticTpk.get()||e||a.staticTpk.set(a.staticTpks.getAt(0))}),this.staticTpk.bind(this,function(){a._calculateSize(),a._calculateFileName()}),this.supportsExportTiles.bind(this,function(){return a.supportsAny.set(a.supportsExportTiles.get()||a.supportsStatic.get())}),this.supportsStatic.bind(this,function(){return a.supportsAny.set(a.supportsExportTiles.get()||a.supportsStatic.get())}),this.exportTilesMinLevel.bind(this,function(){return a._calculateSize()}),this.exportTilesMaxLevel.bind(this,function(){return a._calculateSize()}),this.exportTilesMapServiceMinLevel.bind(this,function(e){a.exportTilesMinLevel.get()<e&&a.exportTilesMinLevel.set(e),a.exportTilesMaxLevel.get()<e&&a.exportTilesMaxLevel.set(e)}),this.exportTilesMapServiceMaxLevel.bind(this,function(e){a.exportTilesMinLevel.get()>e&&a.exportTilesMinLevel.set(e),a.exportTilesMaxLevel.get()>e&&a.exportTilesMaxLevel.set(e)}),this.geometry.bind(this,function(){return a._calculateSize()}),this.size.bind(this,function(){return a._calculateIsValid()}),this.sizePresentable.syncTransform(this.size,function(e){return a._formatBytes(e)}),this._hasTiledMapService=0<i.services.filter(function(e){return e.mapService.mapServiceType===o.MapServiceType.TILED}).length,this._hasTiledMapService?this._calculateExportTilesMapServiceUri():(this.supportsStatic.set(!1),this.supportsExportTiles.set(!1),this.errorConfigurationMessage.set(this.getResource("language-offlinemapeditor-basemaps-notiled")))}t.OfflineMapEditorBasemap=i})},"Mapping/modules/OfflineMaps/Editor/OfflineMapEditorView":function(){var a,l=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewBase","./../OfflineMapsModule"],function(e,t,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,s=(n=i.ViewBase,l(o,n),o.prototype._onShowOfflineMapEditor=function(e){this._setTitle(!!e.existingOfflineMap),this.viewModel.startEditing(e),this.app.command("ActivateView").execute(this.id)},o.prototype.activated=function(){n.prototype.activated.call(this),this.viewModel.calculateIsValid()},o.prototype.handleCancelClick=function(e,t,i){this.viewModel.finishEditing(!0),this.app.command("DeactivateView").execute(this.id)},o.prototype.handleDoneClick=function(e,t,i){var a=this;this.isBusy.set(!0),this.viewModel.finishEditing().then(function(){a.isBusy.set(!1),a.app.command("DeactivateView").execute(a.id)})},o.prototype.handleLayersClick=function(e,t,i){a.OfflineMapsModule._execCommandFromConfig(this.app,this.configuration.showLayersEditor)},o.prototype.handleGeometryClick=function(e,t,i){a.OfflineMapsModule._execCommandFromConfig(this.app,this.configuration.showGeometryEditor)},o.prototype.handleBasemapsClick=function(e,t,i){a.OfflineMapsModule._execCommandFromConfig(this.app,this.configuration.showBasemapsEditor)},o.prototype.handleSharingClick=function(e,t,i){a.OfflineMapsModule._execCommandFromConfig(this.app,this.configuration.showSharingEditor)},o.prototype._setTitle=function(e){if(this.configuration.title){var t=e?this.configuration.title.forExisting:this.configuration.title.forNew;t&&(t.startsWith("@")&&(this.configuration.title.libraryId,t=this.app.getResource(this.configuration.title.libraryId?this.configuration.title.libraryId:this.libraryId,t)),this.title.set(t))}},o.prototype._onViewContainerViewClosedEvent=function(e){e.viewId===this.id&&this.viewModel.finishEditing(!0)},o);function o(e,t){var i=n.call(this,e,t)||this;return i.app.command("ShowOfflineMapEditor").register(i,i._onShowOfflineMapEditor),i.app.event("ViewContainerViewClosedEvent").subscribe(i,i._onViewContainerViewClosedEvent),i}t.OfflineMapEditorView=s})},"Mapping/modules/OfflineMaps/Editor/OfflineMapEditorViewConfiguration":function(){define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})},"Mapping/modules/OfflineMaps/Editor/OfflineMapEditorViewModel":function(){var a,v=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewModelBase","geocortex/framework/events/Event","geocortex/infrastructure/offline/OfflineMap","geocortex/framework/observables","./MapState","./Layers/LayerSelectorViewModel","./OfflineMapEditorBasemap","geocortex/infrastructure/documents/GrantEditorViewModel","geocortex/essentials/GeometryUtilities","geocortex/infrastructure/gis/AppInfo","./../OfflineMapsModule","geocortex/essentials/ReportParameters","geocortex/essentials/documents/DocumentConstants"],function(e,t,i,a,n,s,o,l,p,r,c,d,f,u,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m,h=(m=i.ViewModelBase,v(b,m),b.prototype.initialize=function(e){this.config=e,m.prototype.initialize.call(this,e),e.tools&&this.app.toolRegistry&&this.app.toolRegistry.createTools(e.tools,!0),e.menus&&this.app.menuRegistry&&this.app.menuRegistry.loadMenus({menus:e.menus})},b.prototype.startEditing=function(e){if(!this.app.site.isInitialized)throw new Error("Can't start editing before the site is initialized.");this.isEditing.get()&&this.finishEditing(!0),this.basemaps.isEmpty()&&0<this.app.site.essentialsMap.baseMaps.length&&this._initBasemaps(),this.isEditing.set(!0),this.loadError.set(null),this.initialMapState=new o.MapState(d.AppInfo.fromGeocortexApp(this.app)),this.existingOfflineMap=e.existingOfflineMap,e.existingOfflineMap&&this._loadExistingOfflineMapDoc(e.existingOfflineMap)||this._reset(),f.OfflineMapsModule._execCommandsFromConfig(this.app,this.config.onEditingStarted)},b.prototype._initBasemaps=function(){var i=this,e=this.app.site.essentialsMap.baseMaps.map(function(e){var t=new p.OfflineMapEditorBasemap(i.app,i.libraryId,e);return t.geometry.sync(i.geometry),t.isValid.bind(i,i.calculateIsValid),t.type.bind(i,function(){return i.basemapsChanged.set(!0)}),t});this.basemaps.set(e),this.app.site.getOfflineBasemaps(function(t){e.forEach(function(e){return e.staticTpks.set(t)})},function(e){i.app.trace.error("Unable to fetch offline basemaps: "+e)})},b.prototype._loadExistingOfflineMapDoc=function(a){var n=this;try{return this.name.set(a.title),this.thumbnail.set(a.thumbnail?a.thumbnail.location:null),this.geometry.set(new esri.geometry.Polygon(a.content.geometry)),this.includeAttachments.set(a.content.includeAttachments),this.canChange.set(a.access.change),this.app.map.setExtent(this.geometry.get().getExtent()),this.layerSelectorViewModel.getAllItems().filter(function(e){return!e.isFolder}).forEach(function(t){var e=a.content.layers.filter(function(e){return n.layerSelectorViewModel.filter(t)&&e.layerInfoUniqueId===t.layer.uniqueId});if(0<e.length){var i=e[0];t.definitionExpression.set(i?i.definitionExpression:null),t.isEnabled.set(!0)}else t.definitionExpression.set(null),t.isEnabled.set(!1)}),this.layerSelectorViewModel.setVisibleLayersFromSelectedItems(),this.basemaps.get().forEach(function(t){var e=a.content.basemaps.filter(function(e){return e.baseMapId===t.source.id});0<e.length?t.load(e[0]):t.reset()}),this.grantEditorViewModel.loadById(a.id),this.layersChanged.set(!0),this.geometryChanged.set(!0),this.basemapsChanged.set(!0),!0}catch(e){return this.app.trace.error("Unable to load existing offline map.  "+(e.message||e)),this.loadError.set(this.getResource("language-offlinemapeditor-error-load").format(e.message||e)),!1}},b.prototype._reset=function(){this.canChange.set(!0),this.name.set(""),this.thumbnail.set(""),this.geometry.set(esri.geometry.Polygon.fromExtent(this.app.map.extent)),this.includeAttachments.set(!0),this.layerSelectorViewModel.setSelectedItemsFromVisibleLayers(),this.layerSelectorViewModel.getAllItems().filter(function(e){return!e.isFolder}).forEach(function(e){e.layer&&e.definitionExpression.set(e.layer.getDefinitionExpression())}),this.basemaps.get().forEach(function(e){e.reset()}),this.grantEditorViewModel.reset(),this.layersChanged.set(!1),this.geometryChanged.set(!1),this.basemapsChanged.set(!1)},b.prototype.finishEditing=function(e){var t=this;if(void 0===e&&(e=!1),!this.isEditing.get())throw this.app.trace.error("OfflineMapEditorViewModel.finishEditing called when not editing."),new Error("Not editing.");this.savingEvent.publish();var i={existingOfflineMap:this.existingOfflineMap,newOfflineMap:null,canceled:e},a=Promise.resolve();return e||(i.newOfflineMap={content:{layers:this.layerSelectorViewModel.getAllItems().filter(function(e){return e.layer&&e.isEnabled.get()}).map(function(e){var t=e,i={layerInfoUniqueId:t.layer.uniqueId,definitionExpression:t.definitionExpression.get()};return t.layer.gcxLayer&&t.layer.gcxLayer.isUserCreated&&(i.isUserCreated=t.layer.gcxLayer.isUserCreated,i.layerJson=t.layer.gcxLayer.toJson(),i.serviceInfo={url:t.layer.serviceLayerInfo.serviceLayer.url,capabilities:t.layer.serviceLayerInfo.capabilities}),i}),geometry:this.geometry.get()?this.geometry.get().toJson():null,basemaps:this.basemaps.get().filter(function(e){return e.type.get()===n.OfflineMapBasemap.Type.PREGENERATED||e.type.get()===n.OfflineMapBasemap.Type.EXPORT_TILES}).map(function(e){return e.save()}),includeAttachments:this.includeAttachments.get()},title:this.name.get(),thumbnail:{location:this.thumbnail.get()},properties:{siteId:{string:this.app.site.id},viewerId:{string:(this.app.configModel.viewerId||"null").toLowerCase()}},grants:this.grantEditorViewModel.grants},i.newOfflineMap.thumbnail&&this.existingOfflineMap&&JSON.stringify(this.existingOfflineMap.content.layers)===JSON.stringify(i.newOfflineMap.content.layers)&&JSON.stringify(this.existingOfflineMap.content.geometry)===JSON.stringify(i.newOfflineMap.content.geometry)||(a=this._getThumbnailUri().then(function(e){e&&(i.newOfflineMap.thumbnail.location=e)}))),this.initialMapState.restore(),this.isEditing.set(!1),this.initialMapState=null,this.existingOfflineMap=null,a.then(function(){f.OfflineMapsModule._execCommandsFromConfig(t.app,t.config.onEditingFinished),t.app.event("OfflineMapEditorFinishedEvent").publish(i)})},b.prototype._getThumbnailUri=function(){var i=this,a=new u.ReportParameters;return a.outputFormat="PNG",a.includeData=!0,a.imageWidth=this.config.thumbnail&&this.config.thumbnail.width||150,a.imageHeight=this.config.thumbnail&&this.config.thumbnail.height||150,a.resolution={displayName:"custom",dpi:this.config.thumbnail&&this.config.thumbnail.dpi||20},a.customExtent=this.geometry.get().getExtent(),a.extentType=u.ReportParameters.CUSTOM_EXTENT,a.populateMapGraphicsLayers(this.app.map),new Promise(function(t,e){i.app.site.essentialsMap.exportMap(a,function(e){e.data?t("data:image/png;base64,"+e.data):e.href?t(e.href):t(null)},function(e){i.app.trace.error("Error exporting map for thumbnail: "+e.message),t(null)})})},b.prototype.calculateIsValid=function(){var e=this.layerSelectorViewModel.getAllItems().filter(function(e){return e.layer&&e.isEnabled.get()}).length,t=0<e;this.isLayersValid.set(t),this.layersText.set(this.getResource("language-offlinemapeditor-layers-text").format(e));var i=!!this.geometry.get();this.isGeometryValid.set(i);var a=this.basemaps.get().every(function(e){return e.isValid.get()});this.isBasemapsValid.set(a),this.isBasemapsCalculating.set(this.basemaps.get().some(function(e){return e.size.get()===p.OfflineMapEditorBasemap.sizeCalculating}));var n=this.basemaps.get().filter(function(e){return!e.isNone.get()}).length;this.hasBasemaps.set(0<n),this.basemapsText.set(this.getResource("language-offlinemapeditor-basemaps-text").format(n));var s=g.GrantKind.READER,o=g.GrantKind.WRITER,l=this.grantEditorViewModel.monikers.get().filter(function(e){return 0<e.grants.filter(function(e){return e.assert&&!e.revoke&&(e.kind===s||e.kind===o)}).length}).length;this.hasSharing.set(0<l);var r=t&&i&&a&&!!this.name.get();this.isValid.set(r)},b);function b(e,t){var i=m.call(this,e,t)||this;return i.savingEvent=new a.Event("OfflineMapEditorViewModelSaving"),i.isEditing=new s.Observable(!1),i.loadError=new s.Observable(null),i.canChange=new s.Observable(!1),i.name=new s.Observable(""),i.thumbnail=new s.Observable(""),i.basemaps=new s.ObservableCollection([]),i.geometry=new s.Observable(null),i.includeAttachments=new s.Observable(!0),i.layersChanged=new s.Observable(!1),i.geometryChanged=new s.Observable(!1),i.basemapsChanged=new s.Observable(!1),i.layersText=new s.Observable(""),i.basemapsText=new s.Observable(""),i.hasBasemaps=new s.Observable(!1),i.hasSharing=new s.Observable(!1),i.isLayersValid=new s.Observable(!1),i.isGeometryValid=new s.Observable(!1),i.isBasemapsValid=new s.Observable(!1),i.isBasemapsCalculating=new s.Observable(!1),i.isValid=new s.Observable(!1),i.layerSelectorViewModel=new l.LayerSelectorViewModel(e,t),i.layerSelectorViewModel.onEnabledItemsChanged=function(){return i.layersChanged.set(!0)},i.layerSelectorViewModel.onAllLayersEnabled=function(){return i.includeAttachments.set(!0)},i.layerSelectorViewModel.onAllLayersDisabled=function(){return i.includeAttachments.set(!1)},i.layerSelectorViewModel.initialize({}),i.layerSelectorViewModel.geometry.sync(i.geometry),i.grantEditorViewModel=new r.GrantEditorViewModel(e,"Mapping.Infrastructure"),i.grantEditorViewModel.enabled.sync(i.canChange),i.name.bind(i,i.calculateIsValid),i.geometry.bind(i,function(){return i.geometryChanged.set(!0)}),i.app.command("SetOfflineMapEditorGeometry").register(i,function(e){e&&"extent"===e.type&&(e=c.envelopeToPolygon(e)),e&&"polygon"!==e.type?i.app.trace.error("SetOfflineMapEditorGeometry does not support geometry type '"+e.type+"'."):i.geometry.set(e)}),i}t.OfflineMapEditorViewModel=h})},"Mapping/modules/OfflineMaps/Editor/OfflineMapEditorViewModelConfiguration":function(){define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})},"Mapping/modules/OfflineMaps/Widgets/ProgressBarWidget":function(){var a,o=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewBase"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,n=(a=i.ViewBase,o(s,a),s);function s(){return null!==a&&a.apply(this,arguments)||this}t.ProgressBarWidget=n})},"Mapping/modules/OfflineMaps/Widgets/ProgressBarWidgetViewModel":function(){var a,l=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewModelBase","geocortex/framework/observables"],function(e,t,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,s=(n=i.ViewModelBase,l(o,n),o);function o(){var e=null!==n&&n.apply(this,arguments)||this;return e.widthStyle=new a.Observable("0%"),e}t.ProgressBarWidgetViewModel=s})},"Mapping/modules/OfflineMaps/Sync/SyncStatusView":function(){var a,l=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewBase","./../Widgets/ProgressBarWidgetViewModel"],function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s,a=(s=i.ViewBase,l(o,s),o.prototype.attach=function(e){s.prototype.attach.call(this,e)},o.prototype.activated=function(){s.prototype.activated.call(this)},o.prototype.resolveWidget=function(e,t,i){if(s.prototype.resolveWidget.call(this,e,t,i),"syncProgressBar"===e){var a=this.app.viewManager.createView({typeName:"geocortex.essentialsHtmlViewer.mapping.modules.offlineMaps.widgets.ProgressBarWidget",markupResource:"Mapping/modules/OfflineMaps/Widgets/ProgressBarWidget.html"});return a.app=this.app,a.libraryId=this.libraryId,this.progressBarViewModel=new n.ProgressBarWidgetViewModel(this.app,this.libraryId),a.attach(this.progressBarViewModel),a}},o.prototype.deactivated=function(){s.prototype.deactivated.call(this),this.viewModel.reset(),this.progressBarViewModel.widthStyle.set("0%"),this._switchedToOnline&&this.app.isOffline.set(!0)},o.prototype._startOfflineFeatureSync=function(n){var s=this;if(!this.app.offlineManager.currentOperation){this.viewModel.reset();var t=Promise.resolve(),o=!1;n.offlineMaps.forEach(function(i,a){var e=s.app.offlineManager.getOfflineMapById(i.id);s._setup(e),s.viewModel.updateProgressText(i,s.getResource("language-offline-maps-sync-waiting"),!0),t=t.finally(function(){s.viewModel.updateProgressText(i,s.getResource("language-offline-maps-sync-syncing"),!0);var e=a===n.offlineMaps.length-1;return s.app.offlineManager.syncOfflineMap(i,function(e){var t=e.percentage/n.offlineMaps.length+a/n.offlineMaps.length*100;s.progressBarViewModel.widthStyle.set(t+"%"),setTimeout(function(){s.viewModel.overallPercentage.set(Math.round(10*t)/10),s.viewModel.statusText.set(e.message),e.isWarning&&s.viewModel.warnings.addItem(e.message)},500)},{basemapDownloads:!1,featureDataSync:!0,refreshMap:e,updateBundle:!1})}).then(function(){setTimeout(function(){s.viewModel.updateProgressText(i,s.getResource("language-offline-maps-sync-done"),!0)},500)}).catch(function(t){o=!0,setTimeout(function(){var e=t.message||t;s.viewModel.updateProgressText(i,e,!1)},500)})}),t.finally(function(){setTimeout(function(){s._closeConditionally(o),s.viewModel.showProgress.set(!1),s.viewModel.showCancel.set(!1),s.viewModel.showClose.set(!0),s.viewModel.isResuming.set(!1),o&&(s.viewModel.showClose.set(!1),s.viewModel.partialDataText.set(s.getResource("language-offline-maps-delete-partial-data-text")))},500)})}},o.prototype._startOfflineSyncAndShowProgress=function(i){var a=this;if(!this.app.offlineManager.currentOperation){var e=this.app.offlineManager.getOfflineMapById(i.offlineMap.id);this.viewModel.reset(),this._setup(e),this.app.offlineManager.syncOfflineMap(i.offlineMap,function(e){a.progressBarViewModel.widthStyle.set(e.percentage+"%"),setTimeout(function(){a.viewModel.overallPercentage.set(Math.round(10*e.percentage)/10),a.viewModel.statusText.set(e.message),e.isWarning&&a.viewModel.warnings.addItem(e.message)},500)}).then(function(){setTimeout(function(){a.viewModel.updateProgressText(i.offlineMap,a.getResource("language-offline-maps-sync-done"),!0),a._closeConditionally()},500)}).catch(function(t){setTimeout(function(){var e=t.message||t;a.viewModel.updateProgressText(i.offlineMap,e,!1),a.viewModel.partialDataText.set(a.getResource("language-offline-maps-delete-partial-data-text"))},500)}).finally(function(){setTimeout(function(){a.viewModel.showProgress.set(!1),a.viewModel.showCancel.set(!1),null==a.viewModel.partialDataText.get()&&a.viewModel.showClose.set(!0),a.viewModel.isResuming.set(!1)},500)})}},o.prototype._startOfflineDownloadAndShowProgress=function(i){var a=this;this.viewModel.reset(),this._setup(i.offlineMap),this.app.offlineManager.addOfflineMap(i.offlineMap,function(e){a.progressBarViewModel.widthStyle.set(e.percentage+"%"),setTimeout(function(){a.viewModel.overallPercentage.set(Math.round(10*e.percentage)/10),a.viewModel.statusText.set(e.message),e.isWarning&&a.viewModel.warnings.addItem(e.message)},500)}).then(function(){a.app.offlineManager.activateOfflineMap(i.offlineMap,!0)}).then(function(){setTimeout(function(){a.viewModel.updateProgressText(i.offlineMap,a.getResource("language-offline-maps-sync-done"),!0),a._closeConditionally()},500)}).catch(function(t){setTimeout(function(){var e=t.message||t;a.viewModel.updateProgressText(i.offlineMap,e,!1),a.viewModel.partialDataText.set(a.getResource("language-offline-maps-delete-partial-data-text"))},500)}).finally(function(){setTimeout(function(){a.viewModel.showProgress.set(!1),a.viewModel.showCancel.set(!1),null==a.viewModel.partialDataText.get()&&a.viewModel.showClose.set(!0),a.viewModel.isResuming.set(!1)},500)})},o.prototype._closeConditionally=function(e){var t=this;void 0===e&&(e=!1),this.viewModel.closeWhenDone.get()&&0===this.viewModel.warnings.get().length&&!e&&setTimeout(function(){t._close()},100)},o.prototype._close=function(){this.app.viewManager.deactivateView(this)},o.prototype._open=function(){this.app.viewManager.getViewById(this.id).isActive||this.app.command("ActivateView").execute(this.id)},o.prototype._setup=function(e){this.app.isOffline.get()?(this.app.isOffline.set(!1),this._switchedToOnline=!0):this._switchedToOnline=!1,this.viewModel.setup(e);var t=this.app.offlineManager.getOfflineMapWithStateById(e.id);this.viewModel.isResuming.set(!!t&&t.state.hasProgress),this._open()},o.prototype.handleCancelClick=function(e,t,i){var a=this;this.viewModel.cancellingText.set(this.getResource("language-offline-maps-sync-cancelling")),this.viewModel.showProgress.set(!1),this.viewModel.isCancelling=!0,this.app.offlineManager.cancel().finally(function(){a.viewModel.isCancelling&&a._close()}),setTimeout(function(){a.viewModel.isCancelling&&(a.viewModel.showCancel.set(!1),a.viewModel.showClose.set(!0))},1e4)},o.prototype.handleCloseClick=function(e,t,i){this.viewModel.isCancelling&&(this.app.offlineManager.forgetLast(),this.app.offlineManager.removeOfflineMap(this.viewModel.offlineMap)),this._close()},o.prototype.handleDeleteData=function(e,t,i){var a=this,n=this.viewModel.progressModels.getItems().filter(function(e){return!e.success}),s=[];Promise.each(n,function(e){var t=a.app.offlineManager.getOfflineMapWithStateById(e.context.id);t.state.hasProgress=!1;var i=!t.state.isDownloaded;return a.app.offlineManager.removeOfflineMapPartialData(e.context,i).then(function(){if(i)return a.app.offlineManager.removeOfflineMap(e.context)}).catch(function(e){s.push(e.message||e.toString())})}).finally(function(){0<s.length&&a.app.command("Alert").execute(s.join("\n")),a._close()})},o.prototype.handleToggleDetailsClick=function(e,t,i){this.viewModel.showStatusText.set(!this.viewModel.showStatusText.get())},o);function o(e,t){var i=s.call(this,e,t)||this;return i.app=e,i._switchedToOnline=!1,i.app.command("StartOfflineFeatureSync").register(i,i._startOfflineFeatureSync),i.app.command("StartOfflineSyncAndShowProgress").register(i,i._startOfflineSyncAndShowProgress),i.app.command("StartOfflineDownloadAndShowProgress").register(i,i._startOfflineDownloadAndShowProgress),i}t.SyncStatusView=a})},"Mapping/modules/OfflineMaps/Sync/SyncStatusViewModel":function(){var a,r=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewModelBase","geocortex/framework/observables"],function(e,t,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,s=(n=i.ViewModelBase,r(o,n),o.prototype.setup=function(e){this._bindings.push({token:this.showStatusText.bind(this,this.showStatusTextChanged),observable:this.showStatusText}),this._bindings.push({token:this.closeWhenDone.bind(this,this.closeWhenDoneChanged),observable:this.closeWhenDone}),this.canCancel.sync(this.app.offlineManager.canCancel);var t=localStorage.getItem("geocortex.offlineMaps.SyncStatusViewModel.showStatusText");"string"==typeof t&&this.showStatusText.set("true"===t);var i=localStorage.getItem("geocortex.offlineMaps.SyncStatusViewModel.closeWhenDone");"string"==typeof i&&this.closeWhenDone.set("true"===i),this.name.set(e.title),this.statusText.set(this.getResource("language-offline-maps-progress-pending")),this.offlineMap=e,this.showClose.set(!1),this.showCancel.set(!0)},o.prototype.reset=function(){this._bindings.forEach(function(e){return e.observable.unbind(e.token)}),this._bindings.length=0,this.overallPercentage.set(0),this.cancellingText.set(null),this.partialDataText.set(null),this.statusText.set(null),this.showProgress.set(!0),this.progressModels.clear(),this.warnings.clear(),this.isCancelling=!1},o.prototype.updateProgressText=function(t,e,i){var a=this.progressModels.getItems().filter(function(e){return e.context.id===t.id})[0];a||(a=new l,this.progressModels.addItem(a)),a.mapNameDisplay.set(String.format("{0}: ",t.title)),a.progressClass.set(i?"success":"error"),a.message.set(e),a.context=t,a.success=i},o.prototype.showStatusTextChanged=function(e){localStorage.setItem("geocortex.offlineMaps.SyncStatusViewModel.showStatusText",e+""),this.hideStatusText.set(!e)},o.prototype.closeWhenDoneChanged=function(e){localStorage.setItem("geocortex.offlineMaps.SyncStatusViewModel.closeWhenDone",e+"")},o);function o(e,t){var i=n.call(this,e,t)||this;return i.app=e,i._bindings=new Array,i.name=new a.Observable,i.overallPercentage=new a.Observable,i.cancellingText=new a.Observable,i.progressModels=new a.ObservableCollection,i.statusText=new a.Observable,i.closeWhenDone=new a.Observable(!1),i.warnings=new a.ObservableCollection,i.partialDataText=new a.Observable,i.showStatusText=new a.Observable(!1),i.hideStatusText=new a.Observable(!0),i.showProgress=new a.Observable(!0),i.showCancel=new a.Observable(!0),i.showClose=new a.Observable(!1),i.canCancel=new a.Observable(!1),i.isCancelling=!1,i.isResuming=new a.Observable(!1),i}t.SyncStatusViewModel=s;var l=function(){this.message=new a.Observable,this.progressClass=new a.Observable,this.mapNameDisplay=new a.Observable,this.success=!1};t.ProgressViewModel=l})},"Mapping/modules/OfflineMaps/Editor/Basemap/OfflineMapEditorBasemapLevelsConfiguration":function(){define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})},"Mapping/modules/OfflineMaps/Editor/Basemap/OfflineMapEditorBasemapLevelsView":function(){var a,o=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewBase"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,n=(a=i.ViewBase,o(s,a),s.prototype._showOfflineMapEditorBasemapLevels=function(e){this.viewModel.basemap.set(e.basemap),this.app.command("ActivateView").execute(this.id)},s.prototype.attach=function(e){var t=this;a.prototype.attach.call(this,e),this.viewModel.basemap.bind(this,function(){return t._initSliderAndMapBindings()})},s.prototype.deactivated=function(){a.prototype.deactivated.call(this);for(var e=0;e<this._bindings.length;e++){var t=this._bindings[e];t.observable&&t.token?t.observable.unbind(t.token):t.esriHandle&&t.esriHandle.remove()}this._bindings.length=0,this.app.command("RemoveNotification").execute(this._statusId),this.app.map._params.maxZoom=this._mapMaxZoom},s.prototype._initSliderAndMapBindings=function(){var i=this;if(this.viewModel,$(this.slider).slider({range:!1,min:Math.max(this.viewModel.basemap.get().exportTilesMapServiceMinLevel.get(),this.app.map.getMinZoom()),max:Math.min(this.viewModel.basemap.get().exportTilesMapServiceMaxLevel.get(),this.app.map.getMaxZoom()),value:this.viewModel.basemap.get().exportTilesMaxLevel.get(),slide:function(e,t){i.viewModel.basemap.get().exportTilesMaxLevel.get()!==t.value&&i.viewModel.basemap.get().exportTilesMaxLevel.set(t.value)}}),this._bindings.push({observable:this.viewModel.basemap.get().exportTilesMaxLevel,token:this.viewModel.basemap.get().exportTilesMaxLevel.bind(this,function(e){$(i.slider).slider("value",e),i.app.map.getLevel()!==e&&i.app.map.setLevel(e)})}),this._bindings.push({esriHandle:this.app.map.on("extent-change",function(e){e.lod.level!==i.viewModel.basemap.get().exportTilesMaxLevel.get()&&i.viewModel.basemap.get().exportTilesMaxLevel.set(e.lod.level)})}),this.app.map.setZoom(this.viewModel.basemap.get().exportTilesMaxLevel.get()),"Handheld"!=this.app.shellName){var e={id:this._statusId,text:this.getResource("language-offlinemapeditor-basemaps-levels-mapinstructions"),closeButton:{callback:function(){i.app.command("DeactivateView").execute(i.id)}}};this.app.command("DisplayNotification").execute(e)}var t=this.app.map;this._mapMaxZoom=t._params.maxZoom,t._params.maxZoom=this.viewModel.basemap.get().exportTilesMapServiceMaxLevel.get()},s.prototype.handleDoneClick=function(e,t,i){this.app.command("DeactivateView").execute(this.id)},s);function s(e,t){var i=a.call(this,e,t)||this;return i._bindings=new Array,i._statusId="offlineBasemapDefineLevels",i.app.command("ShowOfflineMapEditorBasemapLevels").register(i,i._showOfflineMapEditorBasemapLevels),i}t.OfflineMapEditorBasemapLevelsView=n})},"Mapping/modules/OfflineMaps/Editor/Basemap/OfflineMapEditorBasemapLevelsViewModel":function(){var a,l=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewModelBase","geocortex/framework/observables"],function(e,t,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,s=(n=i.ViewModelBase,l(o,n),o);function o(e,t){var i=n.call(this,e,t)||this;return i.basemap=new a.Observable(null),i}t.OfflineMapEditorBasemapLevelsViewModel=s})},"Mapping/modules/OfflineMaps/Editor/Basemap/OfflineMapEditorBasemapsView":function(){var a,l=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewBase","./../../OfflineMapsModule"],function(e,t,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,s=(n=i.ViewBase,l(o,n),o.prototype.handleTypeRadioClick=function(e,t,i){i.type.set(t.value)},o.prototype.handleEditLevelsClick=function(e,t,i){a.OfflineMapsModule._execCommandFromConfig(this.app,this.configuration.showBasemapsLevelEditorView,{basemap:i})},o.prototype.handleBackClick=function(e,t,i){this.app.command("DeactivateView").execute(this.id)},o);function o(){return null!==n&&n.apply(this,arguments)||this}t.OfflineMapEditorBasemapsView=s})},"Mapping/modules/OfflineMaps/Editor/Geometry/OfflineMapEditorGeometryView":function(){var a,o=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewBase"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a=(n=i.ViewBase,o(s,n),s.prototype.attach=function(e){var a=this;n.prototype.attach.call(this,e),this.viewModel.isEditing.bind(this,function(e){a._getGraphicsLayer().setVisibility(e)}),this.viewModel.savingEvent.subscribe(this,function(){a._getGraphicsLayer().setVisibility(!1)}),this.viewModel.geometry.bind(this,function(e){var t=a._getGraphicsLayer();if(t.clear(),e){var i=new esri.Graphic;i.setGeometry(e),t.add(i)}})},s.prototype.activated=function(){n.prototype.activated.call(this),this._getGraphicsLayer().setOpacity(1)},s.prototype.deactivated=function(){n.prototype.deactivated.call(this),this._getGraphicsLayer().setOpacity(this.configuration.offViewOpacity),this.app.command("ClearActiveTool").execute()},s.prototype.resolveWidget=function(e,t,i){switch(n.prototype.resolveWidget.call(this,e,t,i),e){case"OfflineMapEditorGeometryActionsWidget":return this.app.menuRegistry.createMenuWidget(this,t,i)}},s.prototype.handleBackClick=function(e,t,i){this.app.command("DeactivateView").execute(this.id)},s.prototype._getGraphicsLayer=function(){if(this._layer)return this._layer;if(this._layer=this.app.map.getLayer(this.configuration.geometryLayerId),!this._layer){this._layer=new esri.layers.GraphicsLayer,this._layer.id=this.configuration.geometryLayerId;var e=new esri.symbol.SimpleLineSymbol;e.color.setColor(new esri.Color(this.configuration.outlineColor)),e.setWidth(this.configuration.outlineWidth);var t=new esri.symbol.SimpleFillSymbol;t.setColor(new esri.Color(this.configuration.fillColor)),t.setOutline(e);var i=new esri.renderer.SimpleRenderer(t);this._layer.setRenderer(i),this._layer.setOpacity(this.configuration.offViewOpacity),this.app.map.addLayer(this._layer)}return this._layer},s);function s(){return null!==n&&n.apply(this,arguments)||this}t.OfflineMapEditorGeometryView=a})},"Mapping/modules/OfflineMaps/Editor/Geometry/OfflineMapEditorGeometryViewConfiguration":function(){define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})},"Mapping/modules/OfflineMaps/Editor/Layers/LayerSelectorItem":function(){define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})},"Mapping/modules/OfflineMaps/Editor/Layers/LayerSelectorViewModel":function(){var a,c=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/infrastructure/layerselector/LayerSelectorViewModelBase","geocortex/framework/observables","geocortex/essentials/MapServiceConstants","geocortex/essentials/LayerType","geocortex/infrastructure/TaskUtils"],function(e,t,i,a,n,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l,r=(l=i.LayerSelectorViewModelBase,c(p,l),p.prototype.filter=function(e){if(e.layer){var t=e.layer;if(t.gcxLayer&&(!t.gcxLayer.isUserCreated||t.gcxLayer.catalogId&&t.serviceLayerInfo.gcxMapService.mapServiceType===n.MapServiceType.DYNAMIC&&t.gcxLayer.isDynamic))return t.serviceLayerInfo.gcxMapService?t.serviceLayerInfo.gcxMapService.mapServiceType===n.MapServiceType.DYNAMIC||t.serviceLayerInfo.gcxMapService.mapServiceType===n.MapServiceType.FEATURE:t.serviceLayerInfo.serviceType===n.MapServiceType.FEATURE&&t.gcxLayer.type===s.LayerType.FEATURE_LAYER}return!1},p.prototype.handleLayerStateChange=function(e){if(this.filter(e)&&e.layer){var t=e,i=this.filter(t)&&t.isEnabled.get();t.layer.setEsriLayerVisibility(i),this.onEnabledItemsChanged&&this.onEnabledItemsChanged()}},p.prototype.handleAllLayersEnabled=function(){this.setVisibleLayersFromSelectedItems(),this.onEnabledItemsChanged&&this.onEnabledItemsChanged(),this.onAllLayersEnabled&&this.onAllLayersEnabled()},p.prototype.handleAllLayersDisabled=function(){this.setVisibleLayersFromSelectedItems(),this.onEnabledItemsChanged&&this.onEnabledItemsChanged(),this.onAllLayersDisabled&&this.onAllLayersDisabled()},p.prototype.onLayerSelectorFolderItemCreated=function(e){this._addCustomLayerSelectorMembers(e)},p.prototype.onLayerSelectorLayerItemCreated=function(t){var e=this;t.isEnabled.set(!1),this._addCustomLayerSelectorMembers(t);var i=t;i.definitionExpression.bind(this,function(e){t.layer.setDefinitionExpression(e)}),i.isEnabled.bind(this,function(){return e._calculateNumFeaturesInLayer(i)}),i.definitionExpression.bind(this,function(){return e._calculateNumFeaturesInLayer(i)}),this.geometry.bind(this,function(){return e._calculateNumFeaturesInLayer(i)});var a=t.layer.serviceLayerInfo.capabilities;a&&0<=a.indexOf("Sync")?i.editableOrReadOnlyText.set(this.getResource("language-offlinemapeditor-layers-editable-offline")):i.editableOrReadOnlyText.set(this.getResource("language-offlinemapeditor-layers-readonly-offline"))},p.prototype.onLayerSelectorServiceLayerItemCreated=function(e){this._addCustomLayerSelectorMembers(e)},p.prototype._addCustomLayerSelectorMembers=function(e){var t=e;t.definitionExpression=new a.Observable(null),t.invalidDefinitionExpression=new a.Observable(!1),t.numFeatures=new a.Observable("0"),t.numFeaturesTitle=new a.Observable(""),t.editableOrReadOnlyText=new a.Observable("")},p.prototype._calculateNumFeaturesInLayer=function(i){var a=this;if(i.invalidDefinitionExpression.set(!1),!i.isEnabled.get()||!this.geometry.get()||i.layer.gcxLayer&&!i.layer.gcxLayer.supportsQuery)return i.numFeatures.set("0"),void i.numFeaturesTitle.set(this.getResource("language-offlinemapeditor-layers-numfeatures-title").format(0));i.numFeatures.set(this.getResource("language-offlinemapeditor-layers-numfeatures-calculating")),i.numFeaturesTitle.set(this.getResource("language-offlinemapeditor-layers-numfeatures-calculating-title"));var e=new esri.tasks.Query;e.where=i.definitionExpression.get(),e.geometry=this.geometry.get(),o.getQueryTask(i.layer.gcxLayer).executeForCount(e).then(function(e){i.numFeatures.set(e),i.numFeaturesTitle.set(a.getResource("language-offlinemapeditor-layers-numfeatures-title").format(e))},function(e){dojo.isArray(e.details)&&e.details.some(function(e){return"Invalid query"===e})&&i.invalidDefinitionExpression.set(!0);var t=e.message?e.message:e;a.app.trace.error("Error querying layer '"+i.layer.id+"': "+t),i.numFeatures.set(a.getResource("language-offlinemapeditor-layers-numfeatures-unknown")),i.numFeaturesTitle.set(a.getResource("language-offlinemapeditor-layers-numfeatures-unknown-title"))})},p.prototype.setVisibleLayersFromSelectedItems=function(){var a=this;this.getAllItems().forEach(function(e){if(e.layer){var t=e,i=a.filter(t)&&t.isEnabled.get();t.layer.setEsriLayerVisibility(i)}})},p.prototype.setSelectedItemsFromVisibleLayers=function(){var t=this;this.getAllItems().forEach(function(e){return e.isEnabled.set(t.filter(e)&&e.layer.isVisible()&&!!e.layer.gcxLayer&&(!e.layer.gcxLayer.isUserCreated||!!e.layer.gcxLayer.catalogId&&e.layer.serviceLayerInfo.gcxMapService.mapServiceType===n.MapServiceType.DYNAMIC&&e.layer.gcxLayer.isDynamic))})},p);function p(){var e=null!==l&&l.apply(this,arguments)||this;return e.geometry=new a.Observable,e}t.LayerSelectorViewModel=r})},"Mapping/modules/OfflineMaps/Editor/Layers/OfflineMapEditorLayersView":function(){var a,o=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewBase"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,n=(a=i.ViewBase,o(s,a),s.prototype.activated=function(){this.viewModel.layerSelectorViewModel.layerSelectorInitialized.get()||this.viewModel.layerSelectorViewModel.setupLayerSelector()},s.prototype.selectAllLayers=function(e,t,i){this.viewModel.layerSelectorViewModel.layerSelector.enableAllLayers()},s.prototype.clearAllLayers=function(e,t,i){this.viewModel.layerSelectorViewModel.layerSelector.disableAllLayers()},s.prototype.handleExpanderClick=function(e,t,i){i.isExpanded.set(!i.isExpanded.get())},s.prototype.handleDefinitionExpressionClick=function(e,t,i){this.app.command("Prompt").execute(this.getResource("language-offlinemapeditor-layers-lde-title"),this.getResource("language-offlinemapeditor-layers-lde-description"),i.definitionExpression.get(),function(e){"string"==typeof e&&i.definitionExpression.set(e)})},s.prototype.handleBackClick=function(e,t,i){this.app.command("DeactivateView").execute(this.id)},s);function s(){return null!==a&&a.apply(this,arguments)||this}t.OfflineMapEditorLayersView=n})},"Mapping/modules/OfflineMaps/Editor/Sharing/OfflineMapEditorSharingView":function(){var a,o=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewBase"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a=(n=i.ViewBase,o(s,n),s.prototype.resolveWidget=function(e,t,i){if(n.prototype.resolveWidget.call(this,e,t),!e)return null;switch(e){case"GrantEditorWidget":var a=this.app.viewManager.createView({typeName:"geocortex.essentialsHtmlViewer.mapping.infrastructure.documents.GrantEditorView",markupResource:"Mapping/infrastructure/documents/GrantEditorView.html",libraryId:"Mapping.Infrastructure",isVisible:!0});return a&&a.attach(this.viewModel.grantEditorViewModel),a;default:return null}},s.prototype.handleBackClick=function(e,t,i){this.app.command("DeactivateView").execute(this.id)},s);function s(){return null!==n&&n.apply(this,arguments)||this}t.OfflineMapEditorSharingView=a})},"url:/Mapping/modules/OfflineMaps/Editor/Basemap/OfflineMapEditorBasemapLevelsView.html":t,"url:/Mapping/modules/OfflineMaps/Editor/Basemap/OfflineMapEditorBasemapsView.html":i,"url:/Mapping/modules/OfflineMaps/Editor/Geometry/OfflineMapEditorGeometryView.html":a,"url:/Mapping/modules/OfflineMaps/Editor/Layers/LayerSelectorItemTemplate.html":n,"url:/Mapping/modules/OfflineMaps/Editor/Layers/OfflineMapEditorLayersView.html":s,"url:/Mapping/modules/OfflineMaps/Editor/OfflineMapEditorView.html":o,"url:/Mapping/modules/OfflineMaps/Editor/Sharing/OfflineMapEditorSharingView.html":l,"url:/Mapping/modules/OfflineMaps/ListOfflineMapsView.html":r,"url:/Mapping/modules/OfflineMaps/ManageOfflineMapsView.html":p,"url:/Mapping/modules/OfflineMaps/Sync/SyncStatusView.html":c,"url:/Mapping/modules/OfflineMaps/Widgets/ProgressBarWidget.html":d}}),require(["geocortex/framework/resourceManager"],function(e){e.resourceManager.register("Mapping","inv","Mapping/modules/OfflineMaps/CSS/common.css","css","LnN0cmluZy13cmFwIHsNCiAgICB3b3JkLWJyZWFrOiBicmVhay1hbGw7DQogICAgb3ZlcmZsb3ctd3JhcDogYnJlYWstd29yZDsNCiAgICB3b3JkLXdyYXA6IGJyZWFrLXdvcmQ7DQp9DQoub2ZmbGluZS1oZWFkaW5nIHsNCiAgICBmb250LXNpemU6IDEuM2VtOw0KICAgIGZvbnQtd2VpZ2h0OiBub3JtYWw7DQp9DQoub2ZmbGluZS1oZWFkaW5nLA0KLmVycm9yLW1lc3NhZ2UtdGV4dCB7DQogICAgZGlzcGxheTogYmxvY2s7DQogICAgbWFyZ2luOiAwLjVlbSAxZW07DQp9DQouT2ZmbGluZU1hcEVkaXRvckdlb21ldHJ5VmlldyAub2ZmbGluZS1oZWFkaW5nIHsNCiAgICBtYXJnaW4tYm90dG9tOiAxZW07DQp9DQoub2ZmbGluZS1oZWFkZXItaW5mby10ZXh0IHsNCiAgICBwYWRkaW5nOiAxZW07DQogICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICNEOUQ5RDk7DQp9DQoubGlzdC1tZW51LA0KLmxpc3QtbWVudSAqIHsNCiAgICAtd2Via2l0LWJveC1zaXppbmc6IGJvcmRlci1ib3g7DQogICAgLW1vei1ib3gtc2l6aW5nOiBib3JkZXItYm94Ow0KICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7DQp9DQoubGlzdC1tZW51IC5pdGVtLWxpc3QtaXRlbSB7DQogICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICNEOUQ5RDk7DQogICAgcG9zaXRpb246IHJlbGF0aXZlOw0KfQ0KLml0ZW0tbGlzdC1pdGVtLmFjdGl2ZS1saXN0LWl0ZW0gew0KICAgIGJhY2tncm91bmQtY29sb3I6ICNERUYyRkY7DQp9DQoubGlzdC1pdGVtLWJ1dHRvbiB7DQogICAgcG9zaXRpb246IHJlbGF0aXZlOw0KICAgIGRpc3BsYXk6IGJsb2NrOw0KICAgIHdpZHRoOiAxMDAlOw0KICAgIHBhZGRpbmc6IDAuMjVlbSA0ZW0gMC4yNWVtIDYuNWVtOw0KICAgIG1pbi1oZWlnaHQ6IDVlbTsNCiAgICB3b3JkLXdyYXA6IGJyZWFrLXdvcmQ7DQp9DQoucHJvZmlsZS1tYW5hZ2UgLmxpc3QtaXRlbS1idXR0b24uYnV0dG9uLWRlbGV0ZSB7DQogICAgcGFkZGluZy1yaWdodDogMGVtOw0KfQ0KLm9mZmxpbmUtdGh1bWJuYWlsIHsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgdG9wOiAwOw0KICAgIGxlZnQ6IDA7DQogICAgbWFyZ2luOiAwLjVlbTsNCiAgICB3aWR0aDogNS41ZW07DQp9DQoubGlzdC1pdGVtLWltZyB7DQogICAgcG9zaXRpb246IHJlbGF0aXZlICFpbXBvcnRhbnQ7DQogICAgYm9yZGVyOiAxcHggc29saWQgI2Q5ZDlkOTsNCn0NCi5vZmZsaW5lLXRodW1ibmFpbCAubGlzdC1pdGVtLWltZyB7DQogICAgd2lkdGg6IDEwMCU7DQp9DQoNCi5wcm9ncmVzcy1tZXNzYWdlIHsNCiAgICBiYWNrZ3JvdW5kOiAjZWVlOw0KfQ0KDQoubGlzdC1tZW51LWRlc2Muc3luYy1pbmNvbXBsZXRlIHsNCiAgICBwYWRkaW5nLWxlZnQ6IDEuNzVlbTsNCiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoUmVzb3VyY2VzL0ltYWdlcy9JY29ucy9Ub29sYmFyL2FsZXJ0LTE2LnBuZyk7DQogICAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsNCiAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBsZWZ0IGJvdHRvbTsNCg0KfQ0KDQouaWNvbi1jb250YWluZXIgew0KICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsNCiAgICBwb3NpdGlvbjogcmVsYXRpdmU7DQp9DQoNCi5saXN0LWl0ZW0tYnV0dG9uLmJ1dHRvbi1kZWxldGUsDQoubGlzdC1pdGVtLWJ1dHRvbi5hY3Rpb24tYnV0dG9uIHsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgdG9wOiAwOw0KICAgIHJpZ2h0OiAwOw0KICAgIHdpZHRoOiAzLjVlbTsNCiAgICBoZWlnaHQ6IDEwMCU7DQogICAgcGFkZGluZzogMDsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgYm9yZGVyLWxlZnQ6IDFweCBzb2xpZCAjRDlEOUQ5Ow0KICAgIGJhY2tncm91bmQ6ICNGRkZGRkY7DQp9DQoNCi5hY3Rpb24tYnV0dG9uIC5zeW5jLWluY29tcGxldGU6OmFmdGVyIHsNCiAgICBjb250ZW50OiAiICI7DQogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKFJlc291cmNlcy9JbWFnZXMvSWNvbnMvVG9vbGJhci9hbGVydC0xNi5wbmcpOw0KICAgIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7DQogICAgcG9zaXRpb246IGFic29sdXRlOw0KICAgIGhlaWdodDogMS4yNWVtOw0KICAgIHdpZHRoOiAxLjI1ZW07DQogICAgcmlnaHQ6IC0wLjI1ZW07DQogICAgYm90dG9tOiAtMC41ZW07DQp9DQoNCi5saXN0LWl0ZW0tYnV0dG9uLmFjdGlvbi1idXR0b24uc3luYy1idXR0b24gew0KICAgIHJpZ2h0OiAzLjVlbTsNCn0NCg0KLmxpc3QtaXRlbS1idXR0b24uYnV0dG9uLWRlbGV0ZSB7DQogICAgYmFja2dyb3VuZDogI2QxMzMyZjsNCn0NCi5vZmZsaW5lLXByb2ZpbGUtYmFzZW1hcC1tb3JlLWRldGFpbCB7DQogICAgZmxvYXQ6IHJpZ2h0Ow0KfQ0KDQouYmFzZW1hcC1lZGl0b3IgLmRpc3BsYXktbmFtZSwNCi5iYXNlbWFwLWVkaXRvciBmb3JtLA0KLmJhc2VtYXAtZWRpdG9yIC5lcnJvci1tZXNzYWdlIHsNCiAgICBkaXNwbGF5OiBibG9jazsNCiAgICBtYXJnaW4tYm90dG9tOiAwLjVlbTsNCn0NCi5iYXNlbWFwLWVkaXRvciAubGF5ZXItaXRlbS1jdHJsIHsNCiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7DQogICAgbWFyZ2luLWJvdHRvbTogLTVweDsNCn0NCi5iYXNlbWFwLWVkaXRvciAuZGlzcGxheS1uYW1lIHsNCiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7DQogICAgZm9udC13ZWlnaHQ6IDYwMDsNCn0NCi5iYXNlbWFwLWVkaXRvciBmb3JtIHsNCiAgICBtYXJnaW4tdG9wOiAwLjdlbTsNCn0NCi5iYXNlbWFwLWVkaXRvciAuZXJyb3ItbWVzc2FnZS10ZXh0IHsNCiAgICAgbWFyZ2luOiAwLjVlbSAxZW0gMWVtIDA7DQogfQ0KDQouZWRpdHMtYmFkZ2UsDQouc3luYy1iYWRnZSB7DQogICAgYmFja2dyb3VuZDogI2QxMzMyZjsNCiAgICBjb2xvcjogI2ZmZmZmZjsNCiAgICBtaW4td2lkdGg6IDEuNWVtOw0KICAgIGhlaWdodDogMS41ZW07DQogICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgIGJvcmRlci1yYWRpdXM6IDFlbTsNCiAgICBsaW5lLWhlaWdodDogMC41ZW07DQogICAgcGFkZGluZzogMC41ZW07DQogICAgZm9udC1zaXplOiAwLjllbTsNCn0NCg0KLmVkaXRzLWJhZGdlIHsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgcmlnaHQ6IDQuMmVtOw0KICAgIHRvcDogMjAlOw0KfQ0KDQoub3JwaGFuLXdhcm5pbmcgew0KICAgIGZvbnQtc3R5bGU6IGl0YWxpYzsNCn0NCg0KLyogLS0tLS0tIFNUQVJUOiBOZXcgUHJvZmlsZXMgLS0tLS0tICovDQoub2ZmbGluZS1tYXAtZWRpdG9yIHsNCiAgICBwb3NpdGlvbjogcmVsYXRpdmU7DQp9DQoub2ZmbGluZS1tYXAtZWRpdG9yIC5mb3JtLWJ0bnMgew0KICAgIHBhZGRpbmc6IDAgMWVtOw0KICAgIG1hcmdpbi10b3A6IDJlbTsNCiAgICBtYXJnaW4tYm90dG9tOiAyZW07DQp9DQoub2ZmbGluZS1tYXAtZWRpdG9yIC5sYXllci1zZWxlY3Rvci1idXR0b25zLnBhbmVsLWdyb3VwLWNvbnRlbnRzIHsNCiAgICBwYWRkaW5nOiAxZW07DQogICAgLXdlYmtpdC1ib3gtc2l6aW5nOiBib3JkZXItYm94Ow0KICAgIC1tb3otYm94LXNpemluZzogYm9yZGVyLWJveDsNCiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94Ow0KfQ0KLnByb2ZpbGUtbGF5ZXJzIC5sYXllci1saXN0IHsNCiAgICBwb3NpdGlvbjogcmVsYXRpdmU7DQogICAgdG9wOiBhdXRvOw0KICAgIHJpZ2h0OiBhdXRvOw0KICAgIGJvdHRvbTogYXV0bzsNCiAgICBsZWZ0OiAwOw0KICAgIG92ZXJmbG93OiBpbmhlcml0Ow0KfQ0KLnByb2ZpbGUtbGF5ZXJzIC5sYXllci1saXN0IC5pZGVudGlmeS1sYXllcnMgLmxheWVyIHsNCiAgICBwYWRkaW5nLWxlZnQ6IDEwJTsNCn0NCi5wcm9maWxlLWxheWVycyAubGF5ZXItbGlzdCAuaWRlbnRpZnktbGF5ZXJzLmxheWVycyAubGF5ZXIgLmxheWVyLWl0ZW0tZXhwYW5kZXIgew0KICAgIG1hcmdpbi1sZWZ0OiAwOw0KfQ0KLnByb2ZpbGUtbGF5ZXJzIC5maWx0ZXItYnV0dG9uIHsNCiAgcG9zaXRpb246IGFic29sdXRlOw0KICB0b3A6IDA7DQogIHJpZ2h0OiAwOw0KICBib3R0b206IDA7DQogIGJvcmRlci1sZWZ0OiAxcHggc29saWQgI0VFRUVFRTsNCiAgYmFja2dyb3VuZDogI0ZGRkZGRjsNCiAgcGFkZGluZzogMCAwLjc1ZW07DQp9DQoucHJvZmlsZS1sYXllcnMgLmZpbHRlci1idXR0b246aG92ZXIsDQoubGlzdC1tZW51LWl0ZW06aG92ZXIsDQoubGlzdC1tZW51LWRldGFpbHM6aG92ZXIgew0KICAgIGJhY2tncm91bmQtY29sb3I6ICNERUYyRkY7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KfQ0KLnByb2ZpbGUtbGF5ZXJzIC5sYXllci1jb250ZW50czpob3ZlciB7DQogICAgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQ7DQogICAgY3Vyc29yOiBkZWZhdWx0Ow0KfQ0KLnByb2ZpbGUtbGF5ZXJzIC5zdWItdGV4dCB7DQogICAgY29sb3I6ICM3Nzc3Nzc7DQogICAgZm9udC1zaXplOiAwLjllbTsNCn0NCi5wcm9maWxlLWxheWVycyAubGF5ZXItaXRlbS1jdHJsIGlucHV0W3R5cGU9ImNoZWNrYm94Il0sIA0KLnByb2ZpbGUtbGF5ZXJzIC5sYXllci1pdGVtLWN0cmwgaW5wdXRbdHlwZT0icmFkaW8iXSB7DQogICAgbWFyZ2luLWJvdHRvbTogMmVtOw0KfQ0KLm9mZmxpbmUtbWFwLWVkaXRvciBidXR0b24ubGlzdC1tZW51LWl0ZW0gew0KICAgIHdpZHRoOiAxMDAlOw0KfQ0KLm9mZmxpbmUtbWFwLWVkaXRvciAubGlzdC1tZW51IGxpOmZpcnN0LWNoaWxkIC5saXN0LW1lbnUtaXRlbSB7DQogICAgYm9yZGVyLXRvcDogMXB4IHNvbGlkICNlZWVlZWU7DQp9DQoubGlzdC1tZW51LXN0YXR1cy1tc2cgew0KICAgIGZvbnQtc3R5bGU6IGl0YWxpYzsNCiAgICBmb250LXNpemU6IDAuOWVtOw0KfQ0KLmxpc3QtbWVudS1zdGF0dXMtbXNnIC5zdGF0dXMtbXNnLWljb24sDQoubGlzdC1tZW51LXN0YXR1cy1tc2cgLmxpc3QtbWVudS1kZXNjLA0KLmxpc3QtbWVudS1zdGF0dXMtbXNnIC5lcnJvci1tZXNzYWdlIHsNCiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7DQp9DQovKiAtLS0tLS0gRU5EOiBOZXcgUHJvZmlsZXMgLS0tLS0tICovDQoNCi8qIC0tLS0tLSBTVEFSVDogU2VsZWN0IExheWVycyAtLS0tLS0gKi8NCi5vZmZsaW5lLXByb2ZpbGVzIC5sYXllcnMgLmxheWVyIC5sYXllci1pdGVtLWV4cGFuZGVyIHsNCiAgICBtYXJnaW4tbGVmdDogMDsNCn0NCi8qIC0tLS0tLSBFTkQ6IFNlbGVjdCBMYXllcnMgLS0tLS0tICovDQovKiAtLS0tLS0gU1RBUlQ6IEJhc2VtYXBzIC0tLS0tLSAqLw0KLm9mZmxpbmUtbWFwLWVkaXRvciAuaW5wdXQtZ3JvdXAgew0KICAgIG1hcmdpbi1ib3R0b206IDFlbTsNCn0NCi5iYXNlbWFwLWVkaXRvciAuaW5wdXQtZ3JvdXAgbGFiZWwgew0KICAgIGRpc3BsYXk6IGJsb2NrOw0KfQ0KLmxhYmVsLXRleHQgew0KICAgIHBvaW50ZXItZXZlbnRzOiBub25lOw0KfQ0KLyogLS0tLS0tIEVORDogQmFzZW1hcHMgLS0tLS0tICovDQovKiAtLS0tLS0gU1RBUlQ6IFNoYXJpbmcgLS0tLS0tICovDQoub2ZmbGluZS1tYXAtZWRpdG9yIC5ncmFudC1lZGl0b3Igew0KICAgIHBhZGRpbmc6IDAgMWVtIDFlbSAxZW07DQp9DQouc2hhcmUtd2l0aCBsYWJlbHsNCiAgICBwYWRkaW5nOiAxZW0gMCAwIDFlbTsgDQp9DQovKiAtLS0tLS0gRU5EOiBTaGFyaW5nIC0tLS0tLSAqLw0KLyogLS0tLS0tIFNUQVJUOiBPdmVycmlkZXMgLS0tLS0tICovDQoub2ZmbGluZS1wcm9maWxlcyAubGlzdC1tZW51IGxpOmxhc3QtY2hpbGQgew0KICAgIGJvcmRlci1yYWRpdXM6IDA7DQp9DQouT2ZmbGluZU1hcEVkaXRvckJhc2VtYXBzVmlldyAuZm9ybS1idG5zLA0KLk9mZmxpbmVNYXBFZGl0b3JCYXNlbWFwTGV2ZWxzVmlldyAuZm9ybS1idG5zIHsNCiAgICBwYWRkaW5nOiAwIDFlbTsNCn0NCi5vZmZsaW5lLXByb2ZpbGVzIC5sYXllci1saXN0IHsNCiAgICBwb3NpdGlvbjogcmVsYXRpdmU7DQogICAgb3ZlcmZsb3c6IHZpc2libGU7DQogICAgdG9wOiAwOw0KICAgIGxlZnQ6IDA7DQp9DQoub2ZmbGluZS1wcm9maWxlcyAubGF5ZXJzIC5sYXllciB7DQogICAgcGFkZGluZy1sZWZ0OiAyLjE1ZW07DQp9DQoub2ZmbGluZS1wcm9maWxlcyAubGF5ZXItbGlzdCAudHJlZS1leHBhbmRlci5leHBhbmRlZCB7DQogICAgYmFja2dyb3VuZC1wb3NpdGlvbjogNTAlIDUwJTsNCn0NCi8qIC0tLS0tLSBFTkQ6IE92ZXJyaWRlcyAtLS0tLS0gKi8NCg0KLyogLS0tLS0tIFNUQVJUIEJ1dHRvbiBTdGF0ZXMgLS0tLS0tKi8NCi5hY3RpdmUtcHJvZmlsZSBidXR0b24sDQouYWN0aXZlLXByb2ZpbGUgYnV0dG9uOmhvdmVyIC5zdGF0dXMtaWNvbiwNCi5hY3RpdmUtcHJvZmlsZSBidXR0b24gLnN0YXR1cy1pY29uOmhvdmVyLA0KLmxpc3QtaXRlbS1idXR0b246aG92ZXIsDQoub25saW5lLW9ubHkgLmxpc3QtaXRlbS1idXR0b246aG92ZXIgew0KICAgIGJhY2tncm91bmQtY29sb3I6ICNERUYyRkY7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KfQ0KLmFjdGl2ZS1wcm9maWxlIGJ1dHRvbi5ib3VuZC1kaXNhYmxlZCwNCi5hY3RpdmUtcHJvZmlsZSBidXR0b24uYm91bmQtZGlzYWJsZWQ6aG92ZXIgLnN0YXR1cy1pY29uLA0KLmFjdGl2ZS1wcm9maWxlIGJ1dHRvbi5ib3VuZC1kaXNhYmxlZCAuc3RhdHVzLWljb246aG92ZXIsDQoubGlzdC1pdGVtLWJ1dHRvbi5ib3VuZC1kaXNhYmxlZCwNCi5saXN0LWl0ZW0tYnV0dG9uLmJvdW5kLWRpc2FibGVkOmhvdmVyLA0KLm9ubGluZS1vbmx5IC5saXN0LWl0ZW0tYnV0dG9uLmJvdW5kLWRpc2FibGVkOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjRUVFRUVFOw0KICAgIGN1cnNvcjogZGVmYXVsdDsNCn0NCi5hY3RpdmUtbGlzdC1pdGVtIC5saXN0LWl0ZW0tYnV0dG9uLmJvdW5kLWRpc2FibGVkLA0KLm9ubGluZS1vbmx5IC5saXN0LWl0ZW0tYnV0dG9uLmJvdW5kLWRpc2FibGVkIHsNCiAgICB6b29tOiAxOw0KCWZpbHRlcjogYWxwaGEob3BhY2l0eT0xMDApOw0KCW9wYWNpdHk6IDE7DQogICAgYmFja2dyb3VuZC1jb2xvcjogI0RFRjJGRjsNCn0NCi5hY3RpdmUtbGlzdC1pdGVtIGJ1dHRvbi5saXN0LWl0ZW0tYnV0dG9uW2Rpc2FibGVkXSwNCi5vbmxpbmUtb25seSBidXR0b24ubGlzdC1pdGVtLWJ1dHRvbltkaXNhYmxlZF0gew0KICAgIGNvbG9yOiAjMzMzMzMzOw0KfQ0KLmFjdGl2ZS1saXN0LWl0ZW0gYnV0dG9uLmxpc3QtaXRlbS1idXR0b25bZGlzYWJsZWRdIC5saXN0LW1lbnUtZGVzYywNCi5vbmxpbmUtb25seSBidXR0b24ubGlzdC1pdGVtLWJ1dHRvbltkaXNhYmxlZF0gLmxpc3QtbWVudS1kZXNjIHsNCiAgICBjb2xvcjogIzY2NjY2NjsNCn0NCi5idXR0b24tZGVsZXRlOmhvdmVyIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjOTk5OTk5Ow0KfQ0KDQouYWN0aXZlLXByb2ZpbGUgLnN0YXR1cy1pY29uIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmZmZmOw0KfQ0KDQouc3RhdHVzLWljb24uZG93bmxvYWRlZC1pY29uLA0KLnN0YXR1cy1pY29uLmFjdGl2ZS1pY29uLA0KLnN0YXR1cy1pY29uLm9ycGhhbi1pY29uLA0KLnByb2ZpbGUtbWFuYWdlIC5zdGF0dXMtaWNvbiB7DQogICAgcmlnaHQ6IDMuNWVtOw0KfQ0KDQouc3RhdHVzLWljb24uZG93bmxvYWRlZC1pY29uLA0KLnN0YXR1cy1pY29uLmFjdGl2ZS1pY29uLA0KLnN0YXR1cy1pY29uLm9ycGhhbi1pY29uIHsNCiAgICBib3JkZXItbGVmdC1jb2xvcjogdHJhbnNwYXJlbnQ7DQp9DQoNCi8qIC0tLS0tLSBFTkQgQnV0dG9uIFN0YXRlcyAtLS0tLS0qLw0KDQovKiAtLS0tLS0gU1RBUlQgU3luYyBTdGF0dXMgVmlldyAtLS0tLS0qLw0KLnN5bmMtc3RhdHVzLnBhZGRlZC12aWV3IHsNCiAgICB3aWR0aDogMzVlbTsNCiAgICBwYWRkaW5nOiAyZW07DQogICAgd29yZC1icmVhazogYnJlYWstYWxsOw0KICAgIHdvcmQtd3JhcDogYnJlYWstd29yZDsNCn0NCkBtZWRpYSBhbGwgYW5kIChtaW4td2lkdGg6IDgwMHB4KSB7DQogICAgLnN5bmMtc3RhdHVzLnBhZGRlZC12aWV3IHsNCiAgICAgICAgd2lkdGg6IDQ1ZW07DQogICAgfQ0KfQ0KQG1lZGlhIGFsbCBhbmQgKG1pbi13aWR0aDogMTAwMHB4KSB7DQogICAgLnN5bmMtc3RhdHVzLnBhZGRlZC12aWV3IHsNCiAgICAgICAgd2lkdGg6IDU1ZW07DQogICAgfQ0KfQ0KLnN5bmMtc3RhdHVzLXNwYWNlciB7DQogICAgbWFyZ2luLWJvdHRvbTogMWVtOw0KfQ0KLnN5bmMtc3RhdHVzLWRldGFpbHMtdG9nZ2xlIHsNCiAgICBmb250LXdlaWdodDogNjAwOw0KICAgIGNvbG9yOiAjNDQ0NDQ0Ow0KICAgIHBhZGRpbmctbGVmdDogMS41ZW07DQogICAgYmFja2dyb3VuZC1wb3NpdGlvbjogbGVmdCBjZW50ZXI7DQogICAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsNCn0NCi5zeW5jLXN0YXR1cy1kZXRhaWxzLXRvZ2dsZS5jb2xsYXBzZWQgew0KICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChSZXNvdXJjZXMvSW1hZ2VzL0ljb25zL2NoZXZyb24tcmlnaHQtMTYucG5nKTsNCn0NCi5zeW5jLXN0YXR1cy1kZXRhaWxzLXRvZ2dsZS5leHBhbmRlZCB7DQogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKFJlc291cmNlcy9JbWFnZXMvSWNvbnMvY2hldnJvbi1kb3duLTE2LnBuZyk7DQp9DQouc3luYy1kZXRhaWxzIHsNCiAgICBtYXJnaW4tdG9wOiAxZW07DQp9DQouc3luYy1zdGF0dXMtZGV0YWlscyB7DQogICAgYmFja2dyb3VuZC1jb2xvcjogI0VFRUVFRTsNCiAgICBwYWRkaW5nOiAwLjVlbTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCAjRDlEOUQ5Ow0KICAgIGJvcmRlci1yYWRpdXM6IDAuMjVyZW07DQp9DQouc3luYy1jaGVja2JveC1jbG9zZSB7DQogICAgbWFyZ2luLXJpZ2h0OiAxZW07DQogICAgcG9zaXRpb246IHJlbGF0aXZlOw0KfQ0KLnN5bmMtY2hlY2tib3gtY2xvc2UgaW5wdXRbdHlwZT0iY2hlY2tib3giXSB7DQogICAgbWFyZ2luLXJpZ2h0OiAwLjVlbTsNCn0NCi5zeW5jLXN0YXR1cyAuc3VjY2VzcyB7DQogICAgY29sb3I6IGdyZWVuOw0KfQ0KLnN5bmMtc3RhdHVzIC5lcnJvciB7DQogICAgY29sb3I6ICM5OTAwMDA7DQp9DQoudG91Y2ggLnN5bmMtY2hlY2tib3gtY2xvc2UgaW5wdXRbdHlwZT0iY2hlY2tib3giXSB7DQogICAgbWFyZ2luLXJpZ2h0OiAxZW07DQp9DQoudG91Y2ggLnN5bmMtY2hlY2tib3gtY2xvc2UgaW5wdXRbdHlwZT0iY2hlY2tib3giXSArIHNwYW4gew0KICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsNCiAgICBtYXJnaW46IDAuNWVtIDA7DQp9DQouc3RhdHVzLWljb24gew0KICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgICByaWdodDogMDsNCiAgICB0b3A6IDA7DQogICAgYm90dG9tOiAwOw0KICAgIGhlaWdodDogMTAwJTsNCiAgICB3aWR0aDogMy41ZW07DQogICAgYm9yZGVyLWxlZnQ6IDFweCBzb2xpZCAjRDlEOUQ5Ow0KICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCn0NCg0KLm9ubGluZS1vbmx5IC5zdGF0dXMtaWNvbiB7DQogICAgYm9yZGVyLWxlZnQtY29sb3I6IHRyYW5zcGFyZW50Ow0KfQ0KLm9ubGluZS1vbmx5IC5saXN0LW1lbnUtZGVzYyB7DQogICAgZGlzcGxheTogYmxvY2s7DQp9DQoNCi5hY3Rpb24tYnV0dG9uLWhlbHBlciwNCi5zdGF0dXMtaWNvbi1oZWxwZXIgew0KICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsNCiAgICBoZWlnaHQ6IDEwMCU7DQogICAgdmVydGljYWwtYWxpZ246IG1pZGRsZTsNCn0NCg0KLmFjdGlvbi1idXR0b24gaW1nLA0KLnN0YXR1cy1pY29uIGltZyB7DQogICAgdmVydGljYWwtYWxpZ246IG1pZGRsZTsNCn0NCg0KLnN5bmMtd2FybmluZy1oZWFkZXIgew0KICAgIGNvbG9yOiByZWQ7DQogICAgbWFyZ2luLXRvcDogMWVtOw0KICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQogICAgbWFyZ2luLWJvdHRvbTogMGVtOw0KfQ0KLnN5bmMtd2FybmluZ3Mgew0KICBiYWNrZ3JvdW5kLWNvbG9yOiAjRUVFRUVFOw0KICBwYWRkaW5nOiAwLjVlbTsNCiAgYm9yZGVyOiAxcHggc29saWQgI0Q5RDlEOTsNCiAgYm9yZGVyLXJhZGl1czogMC4yNXJlbTsNCiAgbWFyZ2luLXRvcDogMGVtOw0KfQ0KLnN5bmMtd2FybmluZ3MgdWwgew0KICBtYXJnaW46IDAuMjVlbTsNCiAgcGFkZGluZy1sZWZ0OiAxLjI1ZW07DQp9DQoNCi8qIC0tLS0tLSBFTkQgU3luYyBTdGF0dXMgVmlldyAtLS0tLS0qLw0KDQovKiAtLS0tLS0gU1RBUlQgUHJvZ3Jlc3MgQmFyIC0tLS0tLSovDQoucHJvZ3Jlc3MtYmFyIHsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBib3JkZXI6IDFweCBzb2xpZCAjQ0NDQ0NDOw0KICAgIHBhZGRpbmc6IDAuMjVlbTsNCiAgICAtd2Via2l0LWJveC1zaXppbmc6IGJvcmRlci1ib3g7DQogICAgLW1vei1ib3gtc2l6aW5nOiBib3JkZXItYm94Ow0KICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7DQogICAgDQogICAgLXdlYmtpdC1ib3JkZXItcmFkaXVzOiAwLjI1ZW07DQogICAgLW1vei1ib3JkZXItcmFkaXVzOiAwLjI1ZW07DQogICAgLW1zLWJvcmRlci1yYWRpdXM6IDAuMjVlbTsNCiAgICBib3JkZXItcmFkaXVzOiAwLjI1ZW07DQp9DQoucHJvZ3Jlc3Mgew0KICAgIGhlaWdodDogMWVtOw0KICAgIGJhY2tncm91bmQ6ICM0QkI3NDk7DQogIA0KICAgIC13ZWJraXQtYm9yZGVyLXJhZGl1czogMC4xNWVtOw0KICAgIC1tb3otYm9yZGVyLXJhZGl1czogMC4xNWVtOw0KICAgIC1tcy1ib3JkZXItcmFkaXVzOiAwLjE1ZW07DQogICAgYm9yZGVyLXJhZGl1czogMC4xNWVtOw0KICAgIA0KICAgIC13ZWJraXQtdHJhbnNpdGlvbjogd2lkdGggMC41cyBlYXNlLWluLW91dDsNCiAgICAtbW96LXRyYW5zaXRpb246IHdpZHRoIDAuNXMgZWFzZS1pbi1vdXQ7DQogICAgLW8tdHJhbnNpdGlvbjogd2lkdGggMC41cyBlYXNlLWluLW91dDsNCiAgICB0cmFuc2l0aW9uOiB3aWR0aCAwLjVzIGVhc2UtaW4tb3V0Ow0KICAgIA0KICAgIC13ZWJraXQtYW5pbWF0aW9uOiBmYWRlLWJhY2tncm91bmQgMnMgZWFzZS1pbi1vdXQgaW5maW5pdGU7IC8qIFNhZmFyaSA0KyAqLw0KICAgIC1tb3otYW5pbWF0aW9uOiAgICBmYWRlLWJhY2tncm91bmQgMnMgZWFzZS1pbi1vdXQgaW5maW5pdGU7IC8qIEZ4IDUrICovDQogICAgLW8tYW5pbWF0aW9uOiAgICAgIGZhZGUtYmFja2dyb3VuZCAycyBlYXNlLWluLW91dCBpbmZpbml0ZTsgLyogT3BlcmEgMTIrICovDQogICAgYW5pbWF0aW9uOiAgICAgICAgIGZhZGUtYmFja2dyb3VuZCAycyBlYXNlLWluLW91dCBpbmZpbml0ZSA7IA0KfQ0KDQoNCiBALXdlYmtpdC1rZXlmcmFtZXMgZmFkZS1iYWNrZ3JvdW5kIHsNCiAgICAwJSwgMTAwJSB7IA0KICAgICAgICBiYWNrZ3JvdW5kOiAjNEJCNzQ5Ow0KICAgIH0NCiAgICA1MCUgeyANCiAgICAgICAgYmFja2dyb3VuZDogIzg5REY4NzsgDQogICAgfQ0KfQ0KQC1tb3ota2V5ZnJhbWVzIGZhZGUtYmFja2dyb3VuZCB7DQogICAgMCUsIDEwMCUgeyANCiAgICAgICAgYmFja2dyb3VuZDogIzRCQjc0OTsNCiAgICB9DQogICAgNTAlIHsgDQogICAgICAgIGJhY2tncm91bmQ6ICM4OURGODc7IA0KICAgIH0NCn0NCkAtby1rZXlmcmFtZXMgZmFkZS1iYWNrZ3JvdW5kIHsNCiAgICAwJSwgMTAwJSB7IA0KICAgICAgICBiYWNrZ3JvdW5kOiAjNEJCNzQ5Ow0KICAgIH0NCiAgICA1MCUgeyANCiAgICAgICAgYmFja2dyb3VuZDogIzg5REY4NzsgDQogICAgfQ0KfQ0KQGtleWZyYW1lcyBmYWRlLWJhY2tncm91bmQgew0KICAgIDAlLCAxMDAlIHsgDQogICAgICAgIGJhY2tncm91bmQ6ICM0QkI3NDk7DQogICAgfQ0KICAgIDUwJSB7IA0KICAgICAgICBiYWNrZ3JvdW5kOiAjODlERjg3OyANCiAgICB9DQp9IA0KLyogLS0tLS0tIEVORCBQcm9ncmVzcyBCYXIgLS0tLS0tKi8="),e.resourceManager.register("Mapping","inv","Mapping/modules/OfflineMaps/CSS/small.css","css","LnN5bmMtc3RhdHVzLnBhZGRlZC12aWV3IHsNCiAgICBtaW4td2lkdGg6IDA7DQogICAgd2lkdGg6IDEwMCU7DQogICAgbWF4LXdpZHRoOiAxMDAlOw0KICAgIHBhZGRpbmc6IDJlbTsNCiAgICAtd2Via2l0LWJveC1zaXppbmc6IGJvcmRlci1ib3g7DQogICAgLW1vei1ib3gtc2l6aW5nOiBib3JkZXItYm94Ow0KICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7DQp9DQouc3luYy1jaGVja2JveC1jbG9zZTphZnRlciB7DQogICAgY29udGVudDogIiI7DQogICAgZGlzcGxheTogYmxvY2s7DQogICAgaGVpZ2h0OiAwOw0KICAgIHBhZGRpbmctdG9wOiAxZW07DQogICAgY2xlYXI6IGJvdGg7DQp9"),e.resourceManager.register("Mapping","inv","Mapping/modules/OfflineMaps/Editor/Basemap/OfflineMapEditorBasemapLevelsView.html","html",t),e.resourceManager.register("Mapping","inv","Mapping/modules/OfflineMaps/Editor/Basemap/OfflineMapEditorBasemapsView.html","html",i),e.resourceManager.register("Mapping","inv","Mapping/modules/OfflineMaps/Editor/Geometry/OfflineMapEditorGeometryView.html","html",a),e.resourceManager.register("Mapping","inv","Mapping/modules/OfflineMaps/Editor/Layers/LayerSelectorItemTemplate.html","html",n),e.resourceManager.register("Mapping","inv","Mapping/modules/OfflineMaps/Editor/Layers/OfflineMapEditorLayersView.html","html",s),e.resourceManager.register("Mapping","inv","Mapping/modules/OfflineMaps/Editor/OfflineMapEditorView.html","html",o),e.resourceManager.register("Mapping","inv","Mapping/modules/OfflineMaps/Editor/Sharing/OfflineMapEditorSharingView.html","html",l),e.resourceManager.register("Mapping","inv","Mapping/modules/OfflineMaps/ListOfflineMapsView.html","html",r),e.resourceManager.register("Mapping","inv","Mapping/modules/OfflineMaps/ManageOfflineMapsView.html","html",p),e.resourceManager.register("Mapping","inv","Mapping/modules/OfflineMaps/Sync/SyncStatusView.html","html",c),e.resourceManager.register("Mapping","inv","Mapping/modules/OfflineMaps/Widgets/ProgressBarWidget.html","html",d)}),require({cache:{}}),define(["Mapping/modules/OfflineMaps/ListOfflineMapsView","Mapping/modules/OfflineMaps/ManageOfflineMapsView","Mapping/modules/OfflineMaps/OfflineMapModel","Mapping/modules/OfflineMaps/OfflineMapsModule","Mapping/modules/OfflineMaps/OfflineMapsViewModel","Mapping/modules/OfflineMaps/Editor/MapState","Mapping/modules/OfflineMaps/Editor/OfflineMapEditorBasemap","Mapping/modules/OfflineMaps/Editor/OfflineMapEditorView","Mapping/modules/OfflineMaps/Editor/OfflineMapEditorViewModel","Mapping/modules/OfflineMaps/Sync/SyncStatusView","Mapping/modules/OfflineMaps/Sync/SyncStatusViewModel","Mapping/modules/OfflineMaps/Widgets/ProgressBarWidget","Mapping/modules/OfflineMaps/Widgets/ProgressBarWidgetViewModel","Mapping/modules/OfflineMaps/Editor/Geometry/OfflineMapEditorGeometryView","Mapping/modules/OfflineMaps/Editor/Basemap/OfflineMapEditorBasemapLevelsView","Mapping/modules/OfflineMaps/Editor/Basemap/OfflineMapEditorBasemapLevelsViewModel","Mapping/modules/OfflineMaps/Editor/Basemap/OfflineMapEditorBasemapsView","Mapping/modules/OfflineMaps/Editor/Layers/LayerSelectorViewModel","Mapping/modules/OfflineMaps/Editor/Layers/OfflineMapEditorLayersView","Mapping/modules/OfflineMaps/Editor/Sharing/OfflineMapEditorSharingView"],function(e,t,i,a,n,s,o,l,r,p,c,d,f,u,g,m,h,b,v,y){M(e,"geocortex.essentialsHtmlViewer.mapping.modules.offlineMaps.ListOfflineMapsView",e.ListOfflineMapsView),M(t,"geocortex.essentialsHtmlViewer.mapping.modules.offlineMaps.ManageOfflineMapsView",t.ManageOfflineMapsView),M(i,"geocortex.essentialsHtmlViewer.mapping.modules.offlineMaps.OfflineMapModel",i.OfflineMapModel),M(a,"geocortex.essentialsHtmlViewer.mapping.modules.offlineMaps.OfflineMapsModule",a.OfflineMapsModule),M(n,"geocortex.essentialsHtmlViewer.mapping.modules.offlineMaps.OfflineMapsViewModel",n.OfflineMapsViewModel),M(s,"geocortex.essentialsHtmlViewer.mapping.modules.offlineMaps.editor.MapState",s.MapState),M(o,"geocortex.essentialsHtmlViewer.mapping.modules.offlineMaps.editor.OfflineMapEditorBasemap",o.OfflineMapEditorBasemap),M(l,"geocortex.essentialsHtmlViewer.mapping.modules.offlineMaps.editor.OfflineMapEditorView",l.OfflineMapEditorView),M(r,"geocortex.essentialsHtmlViewer.mapping.modules.offlineMaps.editor.OfflineMapEditorViewModel",r.OfflineMapEditorViewModel),M(p,"geocortex.essentialsHtmlViewer.mapping.modules.offlineMaps.sync.SyncStatusView",p.SyncStatusView),M(c,"geocortex.essentialsHtmlViewer.mapping.modules.offlineMaps.sync.SyncStatusViewModel",c.SyncStatusViewModel),M(d,"geocortex.essentialsHtmlViewer.mapping.modules.offlineMaps.widgets.ProgressBarWidget",d.ProgressBarWidget),M(f,"geocortex.essentialsHtmlViewer.mapping.modules.offlineMaps.widgets.ProgressBarWidgetViewModel",f.ProgressBarWidgetViewModel),M(u,"geocortex.essentialsHtmlViewer.mapping.modules.offlineMaps.editor.geometry.OfflineMapEditorGeometryView",u.OfflineMapEditorGeometryView),M(g,"geocortex.essentialsHtmlViewer.mapping.modules.offlineMaps.editor.basemap.OfflineMapEditorBasemapLevelsView",g.OfflineMapEditorBasemapLevelsView),M(m,"geocortex.essentialsHtmlViewer.mapping.modules.offlineMaps.editor.basemap.OfflineMapEditorBasemapLevelsViewModel",m.OfflineMapEditorBasemapLevelsViewModel),M(h,"geocortex.essentialsHtmlViewer.mapping.modules.offlineMaps.editor.basemap.OfflineMapEditorBasemapsView",h.OfflineMapEditorBasemapsView),M(b,"geocortex.essentialsHtmlViewer.mapping.modules.offlineMaps.editor.layers.LayerSelectorViewModel",b.LayerSelectorViewModel),M(v,"geocortex.essentialsHtmlViewer.mapping.modules.offlineMaps.editor.layers.OfflineMapEditorLayersView",v.OfflineMapEditorLayersView),M(y,"geocortex.essentialsHtmlViewer.mapping.modules.offlineMaps.editor.sharing.OfflineMapEditorSharingView",y.OfflineMapEditorSharingView)})}();