function shim(e,a,t){if("string"==typeof e&&(t=a,a=e),"undefined"==typeof t)return void console.warn("Undefined shim for: "+a);for(var i=a.split("."),r=null,o=window,n=0,s=i.length;n<s;n++)r=i[n],n==s-1?o[r]=t:o[r]||(o[r]={}),o=o[r]}require({cache:{"Mapping/modules/UploadData/Dialog":function(){define(["require","exports","geocortex/framework/ui/ViewBase"],function(e,a,t){"use strict";var i=function(e){function a(){return null!==e&&e.apply(this,arguments)||this}return __extends(a,e),a.prototype.attach=function(a){var t=this;e.prototype.attach.call(this,a),this.viewContainerViewClosedEventToken||(this.viewContainerViewClosedEventToken=this.app.event("ViewContainerViewClosedEvent").subscribe(this,function(e){e&&e.viewId===t.id&&t.handleCancel()}))},a.prototype.destroy=function(){e.prototype.destroy.call(this),this.viewContainerViewClosedEventToken&&(this.app.event("ViewContainerViewClosedEvent").unsubscribe(this.viewContainerViewClosedEventToken),this.viewContainerViewClosedEventToken=null)},a.prototype.handleCancel=function(){this.close(),this.viewModel.processActions&&this.viewModel.processActions.cancel&&this.viewModel.processActions.cancel()},a.prototype.close=function(){this.app.viewManager.deactivateView(this)},a}(t.ViewBase);a.DialogViewBase=i})},"Mapping/modules/UploadData/RestInterfaces":function(){define(["require","exports"],function(e,a){"use strict"})},"Mapping/modules/UploadData/UploadDataModule":function(){define(["require","exports","geocortex/framework/application/ModuleBase","geocortex/framework/observables","geocortex/infrastructure/PortalUtils","geocortex/infrastructure/commandArgs/AddStatusArgs","geocortex/geocortex","geocortex/essentials/LayerStyle","geocortex/essentials/KmlService","geocortex/infrastructure/GeometryUtils","geocortex/infrastructure/LayerIntegrationUtils","geocortex/essentials/Site"],function(e,a,t,i,r,o,n,s,l,d,p,u){"use strict";function c(e){return e.reduce(function(e,a){return e.concat(a)})}function g(e,a){return a.some(function(a){return new RegExp("(?:^|\\b|_)"+a+"(?:$|\\b|_)","i").test(e)})}var m=1e4,h=[".shp",".shx",".dbf"],f="__CUSTOM__";a.SERVICE_TYPE_FEATURE="Feature Service",a.SERVICE_TYPE_KML="KML",a.ERROR_CANCELLED="UploadDataError/Cancelled",a.ERROR_CANCELLED_MESSAGE="Upload data process was cancelled.",a.ERROR_MUST_SIGN_IN_TO_PUBLISH_GEODATABASE="UploadDataError/MustSignInToPublishGeodatabase",a.ERROR_NOT_AUTHORIZED_TO_PUBLISH_GEODATABASE="UploadDataError/NotAuthorizedToPublishGeodatabase",a.ERROR_COULD_NOT_PARSE_XSLX="UploadDataError/CouldNotParseXLSX";var b=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a._processInProgress=new i.Observable((!1)),a._layerNamePlaceholderCounter=0,a}return __extends(t,e),t.prototype.initialize=function(e){e.checkJobStatusPeriod=e.checkJobStatusPeriod||4e3,e.warnOnFeatureCount=e.warnOnFeatureCount||m,e.heatMap=e.heatMap||{enabled:!1,userCanToggle:!0,respectScaleRange:!0,gradient:[[255,255,255,0],[0,0,255,98],[255,0,0,139],[255,255,0,181]],offset:[0,.5,.75,1],intensity:25,includeInLegend:!0},e.cluster=e.cluster||{enabled:!1,userCanToggle:!0,radius:25,maximumFeatures:1e3,backgroundColor:[0,0,255],labelColor:[255,255,255]},this.configuration=e,this.app.command("UploadData").register(this,this._executeUploadData,this._canExecuteUploadData)},t.prototype._canExecuteUploadData=function(){return!this.app.isOffline.get()&&!this._processInProgress.get()},t.prototype._executeUploadData=function(){var e=this;if(/iPhone|iPad|iPod|GeocortexApp\.iOS/.test(navigator.userAgent)&&!window.MSBlobBuilder)return void this.app.command("Alert").execute(this.getResource("language-upload-data-ios-warning-message"),this.getResource("language-upload-data-ios-warning"));if(this._processInProgress.get()){var a=new Error("You cannot start an upload data process while one is already in progress.");return a.name="UploadDataError/AlreadyInProgress",this._handleError(a)}return this._processInProgress.set(!0),Promise.resolve({uploadResponse:void 0,tableMapping:void 0,layerDetailsResults:void 0,mainResponse:void 0,mapServices:void 0,symbols:void 0}).then(function(a){return e._promptUploadDialog(a)}).then(function(a){return e._promptTableMappingDialog(a)}).then(function(a){return e._promptLayerDetailsDialog(a)}).then(function(a){return e._confirmBeforePublish(a)}).then(function(a){return e._sendRequest(a)}).then(function(a){return e._handleMainResponse(a)}).then(function(a){return e._displayTableRecordResults(a)}).then(function(a){return e._promptSymbolDialog(a)}).then(function(a){return e._symbolize(a)}).then(function(a){return e._autoDetectFeatureLabels(a)}).then(function(a){return e._attachDefaultVisualizations(a)}).then(function(a){return e._addMapServicesToMap(a)}).then(function(a){return e._handleCompletion(a)})["catch"](function(a){return e._handleError(a)})},t.prototype._promptUploadDialog=function(e){var a=this,t=this.app.viewManager.getViewById("UploadDialogView");return this.app.viewManager.activateView(t),t.reset(),t.viewModel.prompt().then(function(i){return e.uploadResponse=i,a.app.viewManager.deactivateView(t),e})["catch"](function(e){return a.app.viewManager.deactivateView(t),Promise.reject(e)})},t.prototype._promptTableMappingDialog=function(e){var t=this,i=e.uploadResponse,r=e.uploadResponse.fileItems[0].fileType,o=i.fileItems.length&&i.fileItems[0].tablePreviews&&i.fileItems[0].tablePreviews.length?i.fileItems[0].tablePreviews[0]:null;if(o){var n=this.app.viewManager.getViewById("TableMappingDialogView");if(!o[0].length&&"xlsx"===r){var s=new Error("Each worksheet in the file must contain rows of data");return s.name=a.ERROR_COULD_NOT_PARSE_XSLX,Promise.reject(s)}this.app.viewManager.activateView(n);var l=n.viewModel.prompt(o).then(function(a){return e.tableMapping=a,t.app.viewManager.deactivateView(n),e})["catch"](function(e){return t.app.viewManager.deactivateView(n),Promise.reject(e)});return n.reset(),l}return e.tableMapping=!1,Promise.resolve(e)},t.prototype._promptLayerDetailsDialog=function(e){var t=this,i=e.uploadResponse.fileItems[0].fileType;if("fileGeodatabase"===i){if(!r.hasAccessToPortal(this.app)){var o=new Error("Geodatabase must be published, but the user is not signed into ArcGIS Online.");return o.name=a.ERROR_MUST_SIGN_IN_TO_PUBLISH_GEODATABASE,Promise.reject(o)}if(!r.hasPublishFeaturePrivilege(this.app)){var o=new Error("Geodatabase must be published, but the user does not have sufficient privileges to publish layers to ArcGIS Online.");return o.name=a.ERROR_NOT_AUTHORIZED_TO_PUBLISH_GEODATABASE,Promise.reject(o)}}var n=this.app.viewManager.getViewById("LayerDetailsDialogView");this.app.viewManager.activateView(n);var s=e.layerDetailsResults?e.layerDetailsResults.details.layerName:e.uploadResponse.fileItems[0].fileName;if(n.reset(s),"shapefile"===i&&"application/zip"!==e.uploadResponse.fileItems[0].contentType){var l=function(){for(var a=0,t=h;a<t.length;a++){var i=t[a];if(!e.uploadResponse.fileItems.some(function(e){return e.fileName.endsWith(i)}))return!1}return!0}();l||n.viewModel.publishDisabledMessage.set(this.getResource("language-layer-details-publish-disabled-shapefile"))}return n.viewModel.prompt(i).then(function(a){return e.layerDetailsResults=a,t.app.viewManager.deactivateView(n),e})["catch"](function(e){return t.app.viewManager.deactivateView(n),Promise.reject(e)})},t.prototype._promptSymbolDialog=function(e){var a=this,t=this.app.viewManager.getViewById("SymbolDialogView");this.app.viewManager.activateView(t);var i=t.symbologySettingsWidget.viewModel;return i.isPoint.set(e.mapServices.some(function(e){return"esriGeometryPoint"===e.serviceLayer.geometryType})),i.isPolygon.set(e.mapServices.some(function(e){return"esriGeometryPolygon"===e.serviceLayer.geometryType})),i.isLine.set(e.mapServices.some(function(e){return"esriGeometryPolyline"===e.serviceLayer.geometryType})),t.reset(),t.viewModel.prompt().then(function(a){return e.symbols=a,e})["catch"](function(e){return a.app.viewManager.deactivateView(t),Promise.reject(e)})},t.prototype._confirmBeforePublish=function(e){var a=this;return e.layerDetailsResults.publish?new Promise(function(t,i){var r=a.getResource("language-upload-data-confirm-before-publish"),o=a.getResource("language-upload-data-confirm-before-publish-message");a.app.command("Confirm").execute(o,r,function(i){i?t(e):(e.layerDetailsResults.publish=!1,t(a._promptLayerDetailsDialog(e).then(function(e){return a._confirmBeforePublish(e)})))})}):Promise.resolve(e)},t.prototype._sendRequest=function(e){var t=this,i=e.uploadResponse,r=e.tableMapping,s=e.layerDetailsResults,l=s.details,d=s.publish,p="WaitForUploadDataMainResponse",u=new o.AddStatusArgs(this.getResource("language-upload-data-wait-for-main-response"));u.id=p,u.showBusyIcon=!0,u.timeoutMS=0,this.app.command("AddStatus").execute(u);var c=this.app.site.url+(d?"/publish":"/generate"),g="json",m=i.fileItems.map(function(e){return e.fileId}),h=i.fileItems[0].fileType,f={layerName:l.layerName,targetSR:this.app.site.essentialsMap.spatialReference};[r,l].forEach(function(e){if(e)for(var a=0,t=Object.keys(e);a<t.length;a++){var i=t[a];f[i]=e[i]}});var b=d?{f:g,title:l.layerName,tags:"",fileIds:m,fileType:h,featureParameters:f}:{f:g,fileIds:m,fileType:h,featureParameters:f},v=n.encodeJson(b);return new Promise(function(i,r){n.request({url:c,content:v},{usePost:!0}).then(function(a){t.app.command("RemoveStatus").execute(p),e.mainResponse=a,i(e)},function(o){t.app.command("RemoveStatus").execute(p);var n;if(n=o.message.match(/409 - Item '(.*)' already exists\./)){var s=e.uploadResponse.fileItems[0].fileType;if("fileGeodatabase"==s){t.app.command("Alert").execute(t.getResource("language-upload-data-error-publish-geodatabase-name-taken-message").format(n[1]),t.getResource("language-upload-data-error-publish-name-taken"));var l=new Error(a.ERROR_CANCELLED_MESSAGE);l.name=a.ERROR_CANCELLED,r(l)}else t.app.command("Confirm").execute(t.getResource("language-upload-data-error-publish-name-taken-message").format(n[1]),t.getResource("language-upload-data-error-publish-name-taken"),function(o){if(o)e.layerDetailsResults.publish=!1,i(t._sendRequest(e));else{var n=new Error(a.ERROR_CANCELLED_MESSAGE);n.name=a.ERROR_CANCELLED,r(n)}})}else r(o)})})},t.prototype._handleMainResponse=function(e){var a=e.mainResponse,t=function(e,a){return a.mapServices=e,a},i=e.layerDetailsResults.details.layerName;if(a.featureCollection)return this._acceptGenerateResponse(a,i).then(function(a){return t(a,e)});if(a.services){if(/^https/i.test(window.location.protocol)){var r=a,o=/^http:/;r.services.map(function(e){return e.serviceUrl=e.serviceUrl.replace(o,"https:"),e.jobStatusUrl=e.jobStatusUrl.replace(o,"https:"),e})}return this._acceptPublishResponse(a,i).then(function(a){return t(a,e)})}if(a.error){var n=new Error(a.error.message);throw n.name=a.error.name,n}throw new Error("Invalid response.")},t.prototype._symbolize=function(e){for(var a=0,t=e.mapServices;a<t.length;a++){var i=t[a],r=i.serviceLayer;"esriGeometryPoint"===r.geometryType?r.setRenderer(new esri.renderer.SimpleRenderer(e.symbols.marker)):"esriGeometryPolyline"===r.geometryType?r.setRenderer(new esri.renderer.SimpleRenderer(e.symbols.line)):"esriGeometryPolygon"===r.geometryType&&r.setRenderer(new esri.renderer.SimpleRenderer(e.symbols.fill))}return Promise.resolve(e)},t.prototype._autoDetectFeatureLabels=function(e){var a=e.mapServices,t=this.app.viewManager.getViewById("TableMappingDialogView").viewModel.configuration;if(t.autoDetectionTerms&&t.autoDetectionTerms.featureLabel)for(var i=function(e,a){for(var t=0,i=e;t<i.length;t++){var r=i[t];if(g(r.name,a))return r}return null},r=0,o=a;r<o.length;r++)for(var n=o[r],s=0,l=n.layers;s<l.length;s++){var d=l[s];if(!d.displayField){var p=i(d.fields,t.autoDetectionTerms.featureLabel);p&&(d.displayField=p,n.serviceLayer instanceof esri.layers.FeatureLayer&&(n.serviceLayer.displayField=p.name))}}return Promise.resolve(e)},t.prototype._attachDefaultVisualizations=function(e){for(var a=0,t=e.mapServices;a<t.length;a++){var i=t[a];if(i.serviceLayer instanceof esri.layers.FeatureLayer){"esriGeometryPoint"===i.serviceLayer.geometryType&&(i.heatMap=this.configuration.heatMap,i.featureClustering=this.configuration.cluster);var r=JSON.stringify(i.serviceLayer.renderer.toJson());i.layers[0].allowSymbolization=!0,i.layers[0].styles.push(new s.LayerStyle(r,f,f,(!0)))}}return Promise.resolve(e)},t.prototype._displayTableRecordResults=function(e){var a=e.mainResponse.recordResults;if(a&&e.tableMapping){var t=this.app.viewManager.getViewById("TableRecordResultsDialogView");return this.app.viewManager.activateView(t),t.viewModel.prompt(a).then(function(){return e})}return Promise.resolve(e)},t.prototype._handleCompletion=function(e){var a=this;this._processInProgress.set(!1);for(var t=[],i=0,r=e.mapServices;i<r.length;i++){var o=r[i];o instanceof l.KmlService?t.push.apply(t,o.serviceLayer.getLayers()):t.push.apply(t,o.layers)}for(var n=[],s=0,p=t;s<p.length;s++){var u=p[s];u.fullExtent&&d.isValidGeometry(u.fullExtent)&&n.push(u.fullExtent)}return d.unionGeometries(n).then(function(t){return a.app.command("ZoomToExtent").execute(t),a.app.event("UploadDataCompletedEvent").publish(e),e})},t.prototype._handleError=function(e){return this._processInProgress.set(!1),e.name===a.ERROR_CANCELLED||(e.name===a.ERROR_MUST_SIGN_IN_TO_PUBLISH_GEODATABASE?this.app.command("Alert").execute(this.getResource("language-upload-data-error-must-be-signed-in-to-publish-geodatabase-message"),this.getResource("language-upload-data-error-must-be-signed-in-to-publish-geodatabase")):e.name===a.ERROR_COULD_NOT_PARSE_XSLX?this.app.command("Alert").execute(this.getResource("language-upload-data-error-unable-to-parse-excel-file-message"),this.getResource("language-upload-data-error-unable-to-parse-excel-file")):e.name===a.ERROR_NOT_AUTHORIZED_TO_PUBLISH_GEODATABASE?this.app.command("Alert").execute(this.getResource("language-upload-data-error-unauthorized-to-publish-message"),this.getResource("language-upload-data-error-unauthorized-to-publish")):"UploaderError/500"===e.name&&/Unable to upload file\: Invalid zip file\./.test(e.message)?this.app.command("Alert").execute(this.getResource("language-upload-data-error-invalid-zip-message"),this.getResource("language-upload-data-error-invalid-zip")):"UploaderError/500"===e.name&&/Unable to upload file\: Wrong Local header signature\:/.test(e.message)?this.app.command("Alert").execute(this.getResource("language-upload-data-error-invalid-zip-other-message"),this.getResource("language-upload-data-error-invalid-zip")):/Projection .+ is not supported/.test(e.message)?this.app.command("Alert").execute(this.getResource("language-upload-data-error-projection-not-supported-message"),this.getResource("language-upload-data-error-projection-not-supported")):/406 - Error while analyzing Shapefile/.test(e.message)?this.app.command("Alert").execute(this.getResource("language-upload-data-error-invalid-shapefile-message"),this.getResource("language-upload-data-error-invalid-shapefile")):/499 - Token required/.test(e.message)?this.app.command("Alert").execute(this.getResource("language-upload-data-error-geocoding-unauthenticated-message"),this.getResource("language-upload-data-error-geocoding-unauthenticated")):/The provided file was empty/.test(e.message)?this.app.command("Alert").execute(this.getResource("language-upload-data-error-empty-file-message"),this.getResource("language-upload-data-error-empty-file")):(this.app.trace.error(e.message,e),this.app.command("Alert").execute(this.getResource("language-upload-data-error-message"),this.getResource("language-upload-data-error")))),this.app.event("UploadDataFailedEvent").publish(e),Promise.reject(e)},t.prototype._acceptGenerateResponse=function(e,t){for(var i=this,r=0,o=0,n=e.featureCollection.layers;o<n.length;o++){var s=n[o];s.layerDefinition.name||(s.layerDefinition.name=t+" "+ ++this._layerNamePlaceholderCounter),s.layerDefinition.visibilityField&&(s.layerDefinition.visibilityField=null),s.featureSet&&s.featureSet.features&&(r+=s.featureSet.features.length)}var l=function(){var a=e.featureCollection.layers.map(function(e){return p.buildLocalFeatureLayerService(e)});return Promise.all(a)};return r>=this.configuration.warnOnFeatureCount?new Promise(function(e,t){var o=i.getResource("language-upload-data-confirm-add-layer"),n=i.getResource("language-upload-data-confirm-add-layer-message").format(r);i.app.command("Confirm").execute(n,o,function(i){if(i)return e(l());var r=new Error(a.ERROR_CANCELLED_MESSAGE);r.name=a.ERROR_CANCELLED,t(r)})}):l()},t.prototype._acceptPublishResponse=function(e,a){var t=this,i="WaitOnPublishJob",r=new o.AddStatusArgs(this.getResource("language-upload-data-wait-on-publish-job"));return r.id=i,r.showBusyIcon=!0,r.timeoutMS=0,this.app.command("AddStatus").execute(r),Promise.map(e.services,function(e){return t._waitOnJob(e).then(function(e){return t.app.command("RemoveStatus").execute(i),e}).then(function(e){return t._buildService(e,a)})}).then(function(e){return c(e)})},t.prototype._waitOnJob=function(e){var t=this;return new Promise(function(i,r){if(e.type===a.SERVICE_TYPE_FEATURE){if(!/^https/i.test(e.jobStatusUrl))return r(new Error("Job URL must be HTTPS."));var o=t.app.site.getTokenFromPrincipal(e.jobStatusUrl,esri.IdentityManagerBase)||t.app.site.getTokenFromPrincipal(e.jobStatusUrl,u.Site),n={f:"json",token:o,jobId:e.jobId};esri.request({url:e.jobStatusUrl,content:n,handleAs:"json"}).then(function(a){"completed"===a.status?i(e):"processing"===a.status?setTimeout(function(){i(t._waitOnJob(e))},t.configuration.checkJobStatusPeriod):r(new Error("Publish job check failed."))},r)}else i(e)})},t.prototype._buildService=function(e,t){if(e.type===a.SERVICE_TYPE_FEATURE)return p.discoverFeatureServices(e.serviceUrl).then(function(e){return Promise.all(e.map(p.buildFeatureLayerService))});if(e.type===a.SERVICE_TYPE_KML){var i=t+" "+ ++this._layerNamePlaceholderCounter;return p.buildKmlService(e.serviceUrl,{displayName:i}).then(function(e){return[e]})}throw new TypeError("Given service type '"+e.type+"' unsupported.")},t.prototype._addMapServicesToMap=function(e){for(var a=0,t=e.mapServices;a<t.length;a++){var i=t[a];this.app.command("AddMapService").execute(i)}return Promise.resolve(e)},t}(t.ModuleBase);a.UploadDataModule=b,a.flatten=c,a.checkStringForTerms=g})},"Mapping/modules/UploadData/Dialogs/LayerDetailsDialogView":function(){define(["require","exports","./../Dialog"],function(e,a,t){"use strict";var i=/[^a-z0-9_]/gi,r=function(e){function a(){return null!==e&&e.apply(this,arguments)||this}return __extends(a,e),a.prototype.attach=function(a){e.prototype.attach.call(this,a),$(this.form).change(this.validate.bind(this))},a.prototype.reset=function(e){void 0===e&&(e=""),e=e.replace(/\.[^\.]+$/,""),this.layerName.value=e.replace(i,""),this.publish.checked=!1,this.viewModel.publishDisabledMessage.set("")},a.prototype.validator=function(){var e=[];return this.layerName.value.trim()||e.push({title:this.getResource("language-layer-details-validation-error-name-cannot-be-empty"),message:this.getResource("language-layer-details-validation-error-name-cannot-be-empty-message")}),this.publish.checked&&this.layerName.value.match(i)&&e.push({title:this.getResource("language-layer-details-validation-error-invalid-publish-name"),message:this.getResource("language-layer-details-validation-error-invalid-publish-name-message")}),"fileGeodatabase"!==this.viewModel.fileType.get()||this.publish.checked||e.push({title:this.getResource("language-layer-details-validation-error-filegeodatabase-must-be-published"),message:this.getResource("language-layer-details-validation-error-filegeodatabase-must-be-published-message")}),e},a.prototype.validate=function(){this.viewModel.validationProblems.set(this.validator())},a.prototype.handleProceed=function(){return this.validate(),this.viewModel.validationProblems.getLength()>=1?void this.app.command("Alert").execute(this.getResource("language-upload-data-cannot-proceed-when-invalid-message"),this.getResource("language-upload-data-cannot-proceed-when-invalid")):(this.close(),void this.viewModel.processActions.proceed({details:{layerName:this.layerName.value},publish:this.viewModel.signedIn.get()&&this.publish.checked}))},a}(t.DialogViewBase);a.LayerDetailsDialogView=r})},"Mapping/modules/UploadData/Dialogs/LayerDetailsDialogViewModel":function(){define(["require","exports","geocortex/framework/ui/ViewModelBase","geocortex/framework/observables","geocortex/infrastructure/PortalUtils","./../UploadDataModule"],function(e,a,t,i,r,o){"use strict";a.ERROR_CANCELLED_LOCAL="UploadDataError/Cancelled",a.ERROR_CANCELLED_MESSAGE_LOCAL="Upload data process was cancelled.";var n=function(e){function a(){var a=null!==e&&e.apply(this,arguments)||this;return a.signedIn=new i.Observable((!1)),a.fileType=new i.Observable((void 0)),a.publishIsAvailable=new i.Observable((!1)),a.publishDisabledMessage=new i.Observable,a.validationProblems=new i.ObservableCollection,a}return __extends(a,e),a.prototype.initialize=function(a){e.prototype.initialize.call(this,a),this.configuration=a},a.prototype.prompt=function(e){var a=this;return this.fileType.set(e),this.signedIn.set(r.hasAccessToPortal(this.app)),this.publishIsAvailable.set(this.signedIn.get()&&"gpx"!==e&&r.hasPublishFeaturePrivilege(this.app)),new Promise(function(e,t){a.processActions={proceed:function(a){return e(a)},error:function(e){return t(e)},cancel:function(){var e=new Error(o.ERROR_CANCELLED_MESSAGE);e.name=o.ERROR_CANCELLED,t(e)}}})},a}(t.ViewModelBase);a.LayerDetailsDialogViewModel=n})},"Mapping/modules/UploadData/Dialogs/SymbolDialogView":function(){define(["require","exports","./../Dialog"],function(e,a,t){"use strict";var i=function(e){function a(){return null!==e&&e.apply(this,arguments)||this}return __extends(a,e),a.prototype.reset=function(){this.symbologySettingsWidget.reset(),this.symbologySettingsWidget.applySettings()},a.prototype.handleProceed=function(){this.close(),this.viewModel.processActions.proceed(this.symbologySettingsWidget.viewModel.symbols)},a.prototype.handleCancel=function(){this.handleProceed()},a}(t.DialogViewBase);a.SymbolDialogView=i})},"Mapping/modules/UploadData/Dialogs/SymbolDialogViewModel":function(){define(["require","exports","geocortex/framework/ui/ViewModelBase"],function(e,a,t){"use strict";var i=function(e){function a(){return null!==e&&e.apply(this,arguments)||this}return __extends(a,e),a.prototype.prompt=function(){var e=this;return new Promise(function(a,t){e.processActions={proceed:function(e){return a(e)},error:function(e){return t(e)},cancel:function(){return a()}}})},a}(t.ViewModelBase);a.SymbolDialogViewModel=i})},"Mapping/modules/UploadData/Dialogs/TableMappingDialogView":function(){define(["require","exports","./../Dialog","./../UploadDataModule"],function(e,a,t,i){"use strict";a.Z_AXIS_ENABLED=!1,a.Z_AXIS_REQUIRED=a.Z_AXIS_ENABLED&&!1;var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.validator=function(){var e=this,t=[];if(this.viewModel.locationTypeIsCoordinates.get()){(![this.xAxis,this.yAxis].every(function(e){return e.selectedIndex!==-1})||a.Z_AXIS_ENABLED&&a.Z_AXIS_REQUIRED&&this.zAxis.selectedIndex===-1)&&t.push({title:this.getResource("language-table-mapping-validation-error-all-coordinates-must-be-set"),message:this.getResource("language-table-mapping-validation-error-all-coordinates-must-be-set-message")});var i=function(){for(var a=[e.xAxis,e.yAxis,e.zAxis],t=0,i=a;t<i.length;t++)for(var r=i[t],o=0,n=a;o<n.length;o++){var s=n[o];if(r!==s&&r.value&&r.value===s.value)return!1}return!0}();i||t.push({title:this.getResource("language-table-mapping-validation-error-axes-must-be-unique"),message:this.getResource("language-table-mapping-validation-error-axes-must-be-unique-message")}),this.getSourceSpatialReference()||t.push({title:this.getResource("language-table-mapping-validation-error-source-spatial-mapping-invalid"),message:this.getResource("language-table-mapping-validation-error-source-spatial-mapping-invalid-message")})}if(this.viewModel.locationTypeIsAddress.get()){var r=[];this.viewModel.addressFieldSelectors.get().forEach(function(a,t){if(a.required&&(!a.value||""===a.value)){var i=$(e.form).find(".address select").get(t).selectedIndex>0;i||r.push(a)}}),r.length&&t.push({title:this.getResource("language-table-mapping-validation-error-lacking-required-address-fields"),message:this.getResource("language-table-mapping-validation-error-lacking-required-address-fields-message").format(r.map(function(e){return e.label}).join(", "))})}return t},t.prototype.validate=function(){this.viewModel.validationProblems.set(this.validator())},t.prototype.attach=function(a){e.prototype.attach.call(this,a),this.reset(),$(this.form).change(this.validate.bind(this))},t.prototype.reset=function(){this.refreshLocationType(),this.viewModel.transformTablePreview(this.isFirstRowHeader.checked);var e=this.viewModel.sourceSpatialReferences.get();this.sourceSpatialReference.selectedIndex=e.findIndex(function(e){return e.preselected}),this.viewModel.sourceSpatialReferencesUseCustom.set(!1),$(this.form).find(".address select").each(function(e,a){a.selectedIndex=-1}),this.performAutoDetection(),this.validate()},t.prototype.performAutoDetection=function(){var e=this,a=this.viewModel.configuration.autoDetectionTerms,t=function(a){for(var t=e.viewModel.tableHeadings.get(),r=0;r<t.length;r++){var o=t[r];if(i.checkStringForTerms(o,a))return r}return-1};this.xAxis.selectedIndex=a&&a.xAxis?t(a.xAxis):-1,this.yAxis.selectedIndex=a&&a.yAxis?t(a.yAxis):-1,this.zAxis.selectedIndex=a&&a.zAxis?t(a.zAxis):-1,this.viewModel.addressFieldSelectors.get().forEach(function(i,r){var o=$(e.form).find(".address li").eq(r).find("select").get(0);o.selectedIndex=a&&a[i.name]?t(a[i.name])+1:-1})},t.prototype.refreshLocationType=function(){var e=this.locationType.querySelector("input[type=radio]:checked"),a=e.value;this.viewModel.locationTypeIsCoordinates.set("coordinates"===a),this.viewModel.locationTypeIsAddress.set("address"===a)},t.prototype.handleChangeLocationType=function(){this.refreshLocationType(),this.validate()},t.prototype.handleChangeUseFirstRowAsHeader=function(){this.reset()},t.prototype.handleChangeSourceSpatialReference=function(e,a){this.viewModel.sourceSpatialReferencesUseCustom.set(this.viewModel.sourceSpatialReferences.getAt(a.selectedIndex).custom),this.validate()},t.prototype.getSourceSpatialReference=function(){if(this.sourceSpatialReference.selectedIndex===-1)return null;var e=this.viewModel.sourceSpatialReferences.getAt(this.sourceSpatialReference.selectedIndex);if(e.spatialReference)return e.spatialReference;if(e.map)this.app.map.spatialReference;else if(e.custom){var a=this.sourceSpatialReferenceCustom.value.trim();return a?/^[0-9]+$/.test(a)?new esri.SpatialReference(parseInt(a,10)):new esri.SpatialReference(a):null}},t.prototype.handleProceed=function(){var e=this;if(this.validate(),this.viewModel.validationProblems.getLength()>=1)return void this.app.command("Alert").execute(this.getResource("language-upload-data-cannot-proceed-when-invalid-message"),this.getResource("language-upload-data-cannot-proceed-when-invalid"));var t;if(this.viewModel.locationTypeIsCoordinates.get())t={locationType:"coordinates",isFirstRowHeader:this.isFirstRowHeader.checked,x:this.xAxis.value,y:this.yAxis.value,sourceSR:this.getSourceSpatialReference()},a.Z_AXIS_ENABLED&&(t.z=this.zAxis.value);else if(this.viewModel.locationTypeIsAddress.get()){var i={};$(this.form).find(".address select").each(function(a,t){var r=e.viewModel.addressFieldSelectors.getAt(a);t.value&&(i[r.name]=t.value)}),t={locationType:"address",isFirstRowHeader:this.isFirstRowHeader.checked,addressFields:i}}else this.viewModel.processActions.error(new Error("Location type is invalid."));this.close(),this.viewModel.processActions.proceed(t)},t}(t.DialogViewBase);a.TableMappingDialogView=r})},"Mapping/modules/UploadData/Dialogs/TableMappingDialogViewModel":function(){define(["require","exports","geocortex/framework/ui/ViewModelBase","geocortex/framework/observables","./../UploadDataModule"],function(e,a,t,i,r){"use strict";var o=function(e){function a(){var a=null!==e&&e.apply(this,arguments)||this;return a.hasConfiguredGeocoder=new i.Observable((!1)),a.tablePreview=new i.ObservableCollection,a.tableHeadings=new i.ObservableCollection,a.tableHeadingOptions=new i.ObservableCollection,a.locationTypeIsCoordinates=new i.Observable((!1)),a.locationTypeIsAddress=new i.Observable((!1)),a.zAxisEnabled=new i.Observable((!1)),a.sourceSpatialReferences=new i.ObservableCollection,a.sourceSpatialReferencesUseCustom=new i.Observable((!1)),a.addressFieldSelectors=new i.ObservableCollection,a.validationProblems=new i.ObservableCollection,a}return __extends(a,e),a.prototype.initialize=function(a){e.prototype.initialize.call(this,a),this.configuration=a},a.prototype.prompt=function(e){var a=this;if(this.sourceSpatialReferences.set(this.configuration.sourceSpatialReferences.map(function(e){return e.map&&(e.spatialReference=a.app.map.spatialReference,e.spatialReference.wkid&&(e.label=a.getResource("language-table-mapping-source-spatial-reference-map-format").format(a.app.map.spatialReference.wkid))),e})),this.rawTablePreview=e,this.transformTablePreview(),this.geocoder=this.app.site.getDefaultBatchGeocoder(),this.hasConfiguredGeocoder.set(this.geocoder&&this.geocoder.parameters.length>0),this.addressFieldSelectors.clear(),this.hasConfiguredGeocoder.get())for(var t=0,i=this.geocoder.parameters;t<i.length;t++){var o=i[t];this.addressFieldSelectors.addItem({name:o.name,label:o.displayName||o.name,required:o.isRequired,value:o.value,tableHeadingOptions:this.tableHeadingOptions})}return new Promise(function(e,t){a.processActions={proceed:function(a){return e(a)},error:function(e){return t(e)},cancel:function(){var e=new Error(r.ERROR_CANCELLED_MESSAGE);e.name=r.ERROR_CANCELLED,t(e)}}})},a.prototype.transformTablePreview=function(e){if(void 0===e&&(e=!0),this.tablePreview.clear(),this.rawTablePreview){if(!e){for(var a=this.rawTablePreview[0].length,t=new i.ObservableCollection,r=1;r<=a;r++)t.addItem(this.getResource("language-table-mapping-generated-column-prefix")+r);this.tablePreview.addItem(t)}for(var o=0,n=this.rawTablePreview;o<n.length;o++){var s=n[o];this.tablePreview.addItem(new i.ObservableCollection(s))}this.tableHeadings.set(this.tablePreview.getAt(0).get()),this.tableHeadingOptions.set([""].concat(this.tableHeadings.get()))}},a}(t.ViewModelBase);a.TableMappingDialogViewModel=o})},"Mapping/modules/UploadData/Dialogs/TableRecordResultsDialogView":function(){define(["require","exports","./../Dialog"],function(e,a,t){"use strict";var i=function(e){function a(){return null!==e&&e.apply(this,arguments)||this}return __extends(a,e),a.prototype.handleProceed=function(){this.close(),this.viewModel.processActions.proceed()},a}(t.DialogViewBase);a.TableRecordResultsDialogView=i})},"Mapping/modules/UploadData/Dialogs/TableRecordResultsDialogViewModel":function(){define(["require","exports","geocortex/framework/ui/ViewModelBase","geocortex/framework/observables"],function(e,a,t,i){"use strict";var r=function(e){function a(){var a=null!==e&&e.apply(this,arguments)||this;return a.rejectedRecordsMessage=new i.Observable(""),a.acceptedRecordsMessage=new i.Observable(""),a.rejectedRecordsUrl=new i.Observable(""),a}return __extends(a,e),a.prototype.initialize=function(a){e.prototype.initialize.call(this,a),this.configuration=a},a.prototype.prompt=function(e){var a=this;return this.rejectedRecordsMessage.set(this.getResource("language-table-record-results-dialog-rejected-records-message").format(e.rejected)),this.acceptedRecordsMessage.set(this.getResource("language-table-record-results-dialog-accepted-records-message").format(e.accepted)),this.rejectedRecordsUrl.set(e.rejectedRecordsUrl),new Promise(function(e,t){a.processActions={proceed:function(){return e()},error:function(e){return t(e)},cancel:function(){
return e()}}})},a}(t.ViewModelBase);a.TableRecordResultsDialogViewModel=r})},"Mapping/modules/UploadData/Dialogs/UploadDialogView":function(){define(["require","exports","./../Dialog","geocortex/framework/observables"],function(e,a,t,i){"use strict";var r=function(e){function a(){var a=null!==e&&e.apply(this,arguments)||this;return a.isBusy=new i.Observable((!1)),a.validator=function(){var e=a.uploaderWidget.viewModel.selectedFiles.get(),t=[],i=["csv","xlsx","gpx","kml","zip"],r=["shp","dbf","shx","prj","cpg","sbn","sbx","shp.xml"],o=i.concat(r);e.length||t.push({title:a.getResource("language-uploader-validation-error-no-file-title"),message:a.getResource("language-uploader-validation-error-no-file-message")});var n=0;e.forEach(function(e){o.some(function(a){return e.name.toLowerCase().endsWith("."+a.toLowerCase())})||(e.flag=a.getResource("language-upload-dialog-selected-file-flag-extension-not-allowed"),n++)}),n&&t.push({title:a.getResource("language-upload-dialog-validation-error-extension-not-allowed"),message:a.getResource("language-upload-dialog-validation-error-extension-not-allowed-message")});var s=e.filter(function(e){return i.some(function(a){return e.name.endsWith("."+a)})});s.length>1&&t.push({title:a.getResource("language-upload-dialog-validation-error-too-many"),message:a.getResource("language-upload-dialog-validation-error-too-many-message").format(s.length)});var l=e.filter(function(e){return["shp"].concat(r).some(function(a){return e.name.endsWith("."+a)})}),d=l.some(function(e){return e.name.endsWith(".shp")});return l.length>0&&!d&&t.push({title:a.getResource("language-upload-dialog-validation-error-shapefile-incomplete"),message:a.getResource("language-upload-dialog-validation-error-shapefile-incomplete-message")}),t},a}return __extends(a,e),a.prototype.attachUploader=function(e){var a=this;this.uploaderWidget=e,this.isBusy.sync(this.uploaderWidget.viewModel.uploading),this.viewModel.disabled.sync(this.uploaderWidget.viewModel.disabled),this.uploaderWidget.viewModel.uploadRequestParameters.validator="feature",$(this.uploaderWidget.form).off("change").on("change",function(){a.validate()}),this.uploaderWidget.viewModel.onUploadSuccess=function(e){return a.viewModel.processActions.proceed(e)},this.uploaderWidget.viewModel.onUploadFailure=function(e){return a.viewModel.processActions.error(e)}},a.prototype.reset=function(){this.uploaderWidget.reset(),this.viewModel.validationProblems.clear()},a.prototype.validate=function(){this.viewModel.validationProblems.set(this.validator()),this.uploaderWidget.viewModel.selectedFiles.pulse()},a.prototype.handleProceed=function(e){return this.validate(),this.viewModel.validationProblems.getLength()>=1?void this.app.command("Alert").execute(this.getResource("language-upload-data-cannot-proceed-when-invalid-message"),this.getResource("language-upload-data-cannot-proceed-when-invalid")):void this.uploaderWidget.viewModel.upload(this.uploaderWidget.form)},a}(t.DialogViewBase);a.UploadDialogView=r})},"Mapping/modules/UploadData/Dialogs/UploadDialogViewModel":function(){define(["require","exports","geocortex/framework/ui/ViewModelBase","geocortex/framework/observables","./../UploadDataModule"],function(e,a,t,i,r){"use strict";var o=function(e){function a(){var a=null!==e&&e.apply(this,arguments)||this;return a.validationProblems=new i.ObservableCollection,a.disabled=new i.Observable((!1)),a}return __extends(a,e),a.prototype.initialize=function(a){e.prototype.initialize.call(this,a),this.configuration=a},a.prototype.prompt=function(){var e=this;return new Promise(function(a,t){e.processActions={proceed:function(e){return a(e)},error:function(e){return t(e)},cancel:function(){var e=new Error(r.ERROR_CANCELLED_MESSAGE);e.name=r.ERROR_CANCELLED,t(e)}}})},a}(t.ViewModelBase);a.UploadDialogViewModel=o})},"Mapping/modules/UploadData/Widgets/Uploader/UploaderView":function(){define(["require","exports","geocortex/framework/ui/ViewBase"],function(e,a,t){"use strict";var i=function(e){function a(){return null!==e&&e.apply(this,arguments)||this}return __extends(a,e),a.prototype.added=function(a){var t=this;e.prototype.added.call(this,a),this.viewModel.legacyMode?($(this.input).add(this.selectedFileList).remove(),this.handleLegacyAddInput(),this.viewModel.selectedFiles.bind(this,function(){var e=$(t.legacyInputBox).find("input");t.viewModel.selectedFiles.get().forEach(function(a,t){e.each(function(e,t){if(t.value.endsWith(a.name)){var i=!!a.flag,r=$(t).closest("li");i?r.removeClass("flagged"):r.addClass("flagged"),r.find(".file-flag").text(i?a.flag:"")}})})})):$(this.legacyInputBox).remove(),a.attachUploader(this)},a.prototype.updateSelectedFiles=function(){var e=this;if(this.viewModel.legacyMode){var a=$(this.legacyInputBox).find("input");this.viewModel.selectedFiles.clear(),a.each(function(a,t){var i=t.value;i&&e.viewModel.selectedFiles.addItem({name:/(?:\\|\/)(.+)$/.exec(i)[1],size:null,flag:null})})}else{var t=[].slice.call(this.input.files);this.viewModel.selectedFiles.set(t.map(function(a){return{name:a.name,size:a.size>1048576?(a.size/1024/1024).toFixed(1)+" "+e.getResource("language-uploader-megabyte-abbreviation"):(a.size/1024).toFixed(0)+" "+e.getResource("language-uploader-kilobyte-abbreviation"),flag:null}}))}this.app.viewManager.notifyDimensionsChanged(this)},a.prototype.reset=function(){this.viewModel.disabled.set(!1),this.viewModel.legacyMode?(this.viewModel.legacyInputs.clear(),this.handleLegacyAddInput()):this.form.reset(),this.viewModel.selectedFiles.clear(),this.viewModel.progress.set(0)},a.prototype.handleChange=function(){this.updateSelectedFiles()},a.prototype.handleLegacyAddInput=function(){this.viewModel.legacyInputs.addItem({})},a.prototype.handleLegacyRemoveInput=function(e,a){var t=$(a).closest("li").index();this.viewModel.legacyInputs.removeAt(t),$(this.form).change()},a.prototype.handleSubmit=function(e){var a=this;if(e.preventDefault(),!(this.viewModel.selectedFiles.getLength()>=1)){var t=new Error("Cannot upload when there are no selected files.");throw t.name="UploaderError/NoSelectedFiles",t}return this.viewModel.upload(this.form).caught(function(e){throw a.reset(),/\/0$/.test(e.name)?a.app.command("Alert").execute(a.getResource("language-uploader-error-cors-message"),a.getResource("language-uploader-error-cors-title")):a.app.command("Alert").execute(a.getResource("language-uploader-error-unknown-message"),a.getResource("language-uploader-error-unknown-title")),e}),!1},a}(t.ViewBase);a.UploaderView=i})},"Mapping/modules/UploadData/Widgets/Uploader/UploaderViewModel":function(){define(["require","exports","geocortex/framework/ui/ViewModelBase","geocortex/framework/observables","geocortex/essentials/utilities/UrlUtilities"],function(e,a,t,i,r){"use strict";function o(){try{var e=esri._getProxyUrl();if(e.path)return e.path}catch(a){}return null}function n(e,a){var t=new dojo._Url(e),i=window.location;if(!t.scheme&&!t.host&&!t.port)return!1;if(a.nativeManager.isNative()&&"https"===t.scheme)return!1;var r=t.scheme+"://"+t.host+(t.port?":"+t.port:""),o=i.protocol+"//"+i.hostname+(i.port?":"+i.port:"");return r!==o}var s=function(e){function a(a,t){var o=e.call(this,a,t)||this;return o.selectedFiles=new i.ObservableCollection,o.progress=new i.Observable(0),o.uploading=new i.Observable((!1)),o.disabled=new i.Observable((!1)),o.legacyMode=document.documentMode&&document.documentMode<=9,o.legacyInputs=new i.ObservableCollection,o.uploadEndpointUrl=null,o.uploadRequestParameters={f:"json"},o.onUploadSuccess=function(){},o.onUploadFailure=function(){},o.app.waitUntilSiteInitialized().then(function(){o.uploadEndpointUrl=r.UrlUtilities.simplify(o.app.site.url+"/../../")+"/files/upload"}),o}return __extends(a,e),a.prototype.upload=function(e){var a=this;return new Promise(function(t,i){a.uploading.set(!0);var r=a.uploadEndpointUrl;if(n(r,a.app)){var s=o();if(!s)throw new Error("Proxy is required but not available");r=s+"?"+r}if(a.legacyMode){var l={url:r,data:a.uploadRequestParameters,files:$(":file",e),iframe:!0,processData:!1};$.ajax(l).always(function(e,r,o){var n=JSON.parse(o.responseText);if(n.error){a.disabled.set(!1);var s=new Error(n.error.message);s.name="UploaderError/"+n.error.code,a.onUploadFailure(s),i(s)}else a.onUploadSuccess(n),t(n)})}else{var d=new FormData(e);Object.keys(a.uploadRequestParameters).forEach(function(e){d.append(e,a.uploadRequestParameters[e])}),$.ajax({url:r,data:d,type:"POST",processData:!1,contentType:!1,dataType:"json",xhr:function(){var e=$.ajaxSettings.xhr();return e.upload&&(e.upload.onprogress=function(e){var t=e.loaded/e.total,i=isNaN(t)?0:100*t;a.progress.set(i)}),e}}).done(function(e,r,o){if(e.error){a.disabled.set(!1);var n=new Error(e.error.message);n.name="UploaderError/"+e.error.code,a.onUploadFailure(n),i(n)}else a.onUploadSuccess(e),t(e)}).fail(function(e,t,r){a.disabled.set(!1);var o=new Error(r);o.name="UploaderError/"+e.status,a.onUploadFailure(o),i(o)}).always(function(){a.uploading.set(!1)})}a.disabled.set(!0)})},a}(t.ViewModelBase);a.UploaderViewModel=s})},"url:/Mapping/modules/UploadData/Dialogs/LayerDetailsDialogView.html":'<div class="upload-data layer-details-dialog">\r\n\r\n    <!-- Layer details form. -->\r\n    <form action="javascript:void(0)" data-binding="{@var: form}">\r\n\r\n        <!-- Feature parameter details. -->\r\n        <div class="form-fields">\r\n            <label for="layer-details-layer-name" data-binding="{@text: @language-layer-details-layer-name}"></label>\r\n            <input id="layer-details-layer-name" name="layer-name" data-binding="{@var: layerName}{value: @language-layer-details-layer-name-default}" />\r\n        </div>\r\n\r\n        <!-- Publish checkbox (determines whether to use Generate or Publish endpoint). -->\r\n        <div class="publish-checkbox-container" data-binding="{@visible: publishIsAvailable}">\r\n            <label data-binding="{@disabled: publishDisabledMessage}">\r\n                <input type="checkbox" class="publish-checkbox" name="publish" data-binding="{@var: publish}{@disabled: publishDisabledMessage}" />\r\n                <span class="publish-checkbox-label" data-binding="{@text: @language-layer-details-publish}"></span>\r\n            </label>\r\n            <div class="publish-info" data-binding="{@visible: publishDisabledMessage}">\r\n                <span data-binding="{@text: publishDisabledMessage}"></span>\r\n            </div>\r\n        </div>\r\n    </form>\r\n\r\n    <!-- Validation problems. -->\r\n    <ol class="validation-problems" data-binding="\r\n      {@source: validationProblems}\r\n      {@visible: validationProblems}">\r\n        <li data-binding="{@template-for: validationProblems}">\r\n            <p data-binding="{@text: title}"></p>\r\n            <p data-binding="{@text: message}"></p>\r\n        </li>\r\n    </ol>\r\n\r\n    <!-- Bottom buttons. -->\r\n    <div class="form-btns">\r\n        <button class="button" data-binding="{@text: @language-layer-details-dialog-button-proceed}{@event-onclick: handleProceed}"></button>\r\n        <button class="button" data-binding="{@text: @language-layer-details-dialog-button-cancel}{@event-onclick: handleCancel}"></button>\r\n    </div>\r\n</div>',"url:/Mapping/modules/UploadData/Dialogs/SymbolDialogView.html":'<div class="upload-data symbol-dialog">\r\n\r\n    <!-- Symbology settings widget. -->\r\n    <div data-binding="{@widget: SymbologySettings}{@widget-replace: true}"></div>\r\n\r\n    <!-- Bottom buttons. -->\r\n    <div class="form-btns">\r\n        <button class="button" data-binding="{@text: @language-symbol-dialog-button-proceed}{@event-onclick: handleProceed}"></button>\r\n    </div>\r\n</div>',"url:/Mapping/modules/UploadData/Dialogs/TableMappingDialogView.html":'<!-- Dialog where the user can affect the way the table data will be interpreted as a layer. -->\r\n<div class="upload-data table-mapping-dialog">\r\n\r\n    <!-- Table mapping form form where the user can change details about the way table data is interpreted as a layer. -->\r\n    <form class="table-mapping-form" name="table-mapping" action="javascript:void(0)" data-binding="{@var: form}{@event-onchange: validate}">\r\n\r\n        <!-- Radio buttons for switching between Spatial and Address table mapping modes. -->\r\n        <fieldset class="table-mapping-location-type-box" data-binding="{@var: locationType}{@event-onchange: handleChangeLocationType}">\r\n            <label>\r\n                <input type="radio" name="table-mapping-location-type" value="coordinates" checked />\r\n                <span data-binding="{@text: @language-table-mapping-location-type-coordinates}"></span>\r\n            </label>\r\n            <label data-binding="{@visible: hasConfiguredGeocoder}">\r\n                <input type="radio" name="table-mapping-location-type" value="address" />\r\n                <span data-binding="{@text: @language-table-mapping-location-type-address}"></span>\r\n            </label>\r\n        </fieldset>\r\n\r\n        <!-- Coordinate data options. -->\r\n        <ol class="table-mapping coordinates" data-binding="{@visible: locationTypeIsCoordinates}">\r\n            <li>\r\n                <label class="form-label">\r\n                    <span data-binding="{@text: @language-table-mapping-x-axis}"></span>\r\n                    <select name="x-axis" data-binding="{@source: tableHeadings}{@var: xAxis}">\r\n                        <option data-binding="{@template-for: tableHeadings}{@text: @context}"></option>\r\n                    </select>\r\n                </label>\r\n            </li>\r\n            <li>\r\n                <label class="form-label">\r\n                    <span data-binding="{@text: @language-table-mapping-y-axis}"></span>\r\n                    <select name="y-axis" data-binding="{@source: tableHeadings}{@var: yAxis}">\r\n                        <option data-binding="{@template-for: tableHeadings}{@text: @context}"></option>\r\n                    </select>\r\n                </label>\r\n            </li>\r\n            <li data-binding="{@visible: zAxisEnabled}">\r\n                <label class="form-label">\r\n                    <span data-binding="{@text: @language-table-mapping-z-axis}"></span>\r\n                    <select name="z-axis" data-binding="{@source: tableHeadings}{@var: zAxis}">\r\n                        <option data-binding="{@template-for: tableHeadings}{@text: @context}"></option>\r\n                    </select>\r\n                </label>\r\n            </li>\r\n            <li>\r\n                <label class="form-label">\r\n                    <span data-binding="{@text: @language-table-mapping-source-spatial-reference}"></span>\r\n                    <select name="source-spatial-reference" data-binding="{@source: sourceSpatialReferences}{@event-onchange: handleChangeSourceSpatialReference}{@var: sourceSpatialReference}">\r\n                        <option data-binding="{@template-for: sourceSpatialReferences}{@text: label}"></option>\r\n                    </select>\r\n                </label>\r\n            </li>\r\n            <li data-binding="{@visible: sourceSpatialReferencesUseCustom}">\r\n                <label for="table-mapping-source-spatial-reference-custom" data-binding="{@text: @language-table-mapping-source-spatial-reference-custom}"></label>\r\n                <input type="text" id="table-mapping-source-spatial-reference-custom" name="source-spatial-reference-custom" data-binding="{@var: sourceSpatialReferenceCustom}" />\r\n            </li>\r\n        </ol>\r\n\r\n        <!-- Address data options. -->\r\n        <ol class="table-mapping address" data-binding="{@visible: locationTypeIsAddress}{@source: addressFieldSelectors}">\r\n            <li data-binding="{@template-for: addressFieldSelectors}">\r\n                <label class="form-label" data-binding="{@text: label}"></label>\r\n                <select class="address-select" data-binding="{@source: tableHeadingOptions}">\r\n                    <option data-binding="{@template-for: tableHeadingOptions}{@text: @context}"></option>\r\n                </select>\r\n            </li>\r\n        </ol>\r\n\r\n        <!-- Checkbox that controls table headings. -->\r\n        <label class="table-mapping-is-first-row-header-box">\r\n            <input type="checkbox" name="is-first-row-header" data-binding="{@var: isFirstRowHeader}{@event-onchange: handleChangeUseFirstRowAsHeader}" checked />\r\n            <span data-binding="{@text: @language-table-mapping-is-first-row-header}"></span>\r\n        </label>\r\n\r\n    </form>\r\n\r\n    <!-- Table mapping preview. -->\r\n    <div class="table-mapping-preview-container">\r\n        <table class="table-mapping-preview">\r\n            <tbody data-binding="{@source: tablePreview}">\r\n                <tr data-binding="{@template-for: tablePreview}{@source: @context}">\r\n                    <td data-binding="{@template-for: @context}{@text: @context}"></td>\r\n                </tr>\r\n            </tbody>\r\n        </table>\r\n    </div>\r\n\r\n    <!-- Validation problems. -->\r\n    <ol class="validation-problems error-message" data-binding="\r\n        {@source: validationProblems}\r\n        {@visible: validationProblems}">\r\n        <li data-binding="{@template-for: validationProblems}">\r\n            <p data-binding="{@text: title}"></p>\r\n            <p data-binding="{@text: message}"></p>\r\n        </li>\r\n    </ol>\r\n\r\n    <!-- Bottom buttons. -->\r\n    <div class="form-btns">\r\n        <button class="button" data-binding="{@text: @language-table-mapping-dialog-proceed}{@event-onclick: handleProceed}"></button>\r\n        <button class="button" data-binding="{@text: @language-table-mapping-dialog-cancel}{@event-onclick: handleCancel}"></button>\r\n    </div>\r\n</div>',"url:/Mapping/modules/UploadData/Dialogs/TableRecordResultsDialogView.html":'<div class="upload-data table-record-results-dialog">\r\n\r\n    <!-- Table Record results. -->\r\n    <div class="table-record-result">\r\n        <span class="table-record-result-details">\r\n            <img src="Resources\\Images\\Icons\\Toolbar\\alert-24.png">\r\n            <span data-binding="{@text: rejectedRecordsMessage}"></span>\r\n        </span>\r\n        <span class="table-record-result-details">\r\n            <img src="Resources\\Images\\Icons\\Toolbar\\check-24.png">\r\n            <span data-binding="{@text: acceptedRecordsMessage}"></span>\r\n        </span>\r\n        <p class="table-record-result-download"><a download data-binding="{@visible: rejectedRecordsUrl}{href: rejectedRecordsUrl}{@text: @language-table-record-results-dialog-rejected-records-link}"></a></p>\r\n    </div>\r\n\r\n    <!-- Bottom buttons. -->\r\n    <div class="form-btns">\r\n        <button class="button" data-binding="{@text: @language-table-record-results-dialog-button-proceed}{@event-onclick: handleProceed}"></button>\r\n    </div>\r\n</div>\r\n\r\n',"url:/Mapping/modules/UploadData/Dialogs/UploadDialogView.html":'<div class="upload-data upload-dialog" data-binding="{@class-uploader-disabled: disabled}">\r\n\r\n    <!-- Description for this dialog. -->\r\n    <p class="upload-dialog-description" data-binding="{@text: @language-upload-dialog-description}"></p>\r\n    <p class="upload-dialog-supported-files">\r\n        <strong data-binding="{@text: @language-upload-dialog-supported-files-label}"></strong>\r\n        <em data-binding="{@text: @language-upload-dialog-supported-files}"></em>\r\n    </p>\r\n\r\n    <!-- Uploader widget. -->\r\n    <div data-binding="{@widget: Uploader}{@widget-replace: true}"></div>\r\n\r\n    <!-- Validation problems. -->\r\n    <ol class="validation-problems error-message" data-binding="\r\n        {@source: validationProblems}\r\n        {@visible: validationProblems}">\r\n        <li data-binding="{@template-for: validationProblems}">\r\n            <p data-binding="{@text: title}"></p>\r\n            <p data-binding="{@text: message}"></p>\r\n        </li>\r\n    </ol>\r\n\r\n    <!-- Bottom buttons. -->\r\n    <div class="form-btns">\r\n        <button class="button" data-binding="{@event-onclick: handleProceed}{@text: @language-upload-dialog-button-proceed}{disabled: disabled}"></button>\r\n        <button class="button" data-binding="{@event-onclick: handleCancel}{@text: @language-upload-dialog-button-cancel}{disabled: disabled}"></button>\r\n    </div>\r\n</div>',"url:/Mapping/modules/UploadData/Widgets/Uploader/UploaderView.html":'\r\n<div class="uploader" data-binding="{@class-uploader-disabled: disabled}">\r\n\r\n    <!-- Upload form. -->\r\n    <form action="javascript:void(0)" data-binding="{@var: form}{@event-onchange: handleChange}{@event-onsubmit: handleSubmit}">\r\n\r\n        <!-- Modern implementation of file input that allows multiple files to be selected at once. -->\r\n        <input type="file" name="files" multiple data-binding="{@var: input}{disabled: disabled}" />\r\n\r\n        <!-- List of selected files. -->\r\n        <ol class="selected-file-list" data-binding="{@var: selectedFileList}{@visible: selectedFiles}{@source: selectedFiles}">\r\n            <li data-binding="{@template-for: selectedFiles}{@class-flagged: flag}">\r\n                <div class="selected-file-box">\r\n                    <span class="selected-file-name" data-binding="{@text: name}"></span>\r\n                    <span class="selected-file-size" data-binding="{@visible: size}{@text: size}"></span>\r\n                </div>\r\n\r\n                <!-- Validation flag about the specific file. -->\r\n                <div class="file-flag error-message" data-binding="{@visible: flag}{@text: flag}"></div>\r\n            </li>\r\n        </ol>\r\n\r\n        <!-- Legacy file input implementation. -->\r\n        <div class="uploader-legacy-input-box" data-binding="{@var: legacyInputBox}">\r\n            <ol data-binding="{@source: legacyInputs}">\r\n                <li data-binding="{@template-for: legacyInputs}">\r\n                    <input type="file" name="files" data-binding="{disabled: disabled}" />\r\n                    <button class="uploader-legacy-remove-button" data-binding="{@event-onclick: handleLegacyRemoveInput}"></button>\r\n                    <button class="uploader-legacy-add-button" data-binding="{@event-onclick: handleLegacyAddInput}"></button>\r\n\r\n                    <!-- Validation flag about the specific file. -->\r\n                    <div class="file-flag" data-binding="{@visible: flag}{@text: flag}"></div>\r\n                </li>\r\n            </ol>\r\n        </div>\r\n    </form>\r\n\r\n    <!-- Upload progress bar. -->\r\n    <progress max="100" value="0" data-binding="{@visible: progress}{value: progress}"></progress>\r\n</div>\r\n'}}),define(["Mapping/modules/UploadData/Dialog","Mapping/modules/UploadData/UploadDataModule","Mapping/modules/UploadData/Dialogs/LayerDetailsDialogView","Mapping/modules/UploadData/Dialogs/LayerDetailsDialogViewModel","Mapping/modules/UploadData/Dialogs/SymbolDialogView","Mapping/modules/UploadData/Dialogs/SymbolDialogViewModel","Mapping/modules/UploadData/Dialogs/TableMappingDialogView","Mapping/modules/UploadData/Dialogs/TableMappingDialogViewModel","Mapping/modules/UploadData/Dialogs/TableRecordResultsDialogView","Mapping/modules/UploadData/Dialogs/TableRecordResultsDialogViewModel","Mapping/modules/UploadData/Dialogs/UploadDialogView","Mapping/modules/UploadData/Dialogs/UploadDialogViewModel","Mapping/modules/UploadData/Widgets/Uploader/UploaderView","Mapping/modules/UploadData/Widgets/Uploader/UploaderViewModel"],function(e,a,t,i,r,o,n,s,l,d,p,u,c,g){shim(e,"geocortex.essentialsHtmlViewer.mapping.modules.uploadData.DialogViewBase",e.DialogViewBase),shim(a,"geocortex.essentialsHtmlViewer.mapping.modules.uploadData.SERVICE_TYPE_FEATURE",a.SERVICE_TYPE_FEATURE),shim(a,"geocortex.essentialsHtmlViewer.mapping.modules.uploadData.SERVICE_TYPE_KML",a.SERVICE_TYPE_KML),shim(a,"geocortex.essentialsHtmlViewer.mapping.modules.uploadData.ERROR_CANCELLED",a.ERROR_CANCELLED),shim(a,"geocortex.essentialsHtmlViewer.mapping.modules.uploadData.ERROR_CANCELLED_MESSAGE",a.ERROR_CANCELLED_MESSAGE),shim(a,"geocortex.essentialsHtmlViewer.mapping.modules.uploadData.ERROR_MUST_SIGN_IN_TO_PUBLISH_GEODATABASE",a.ERROR_MUST_SIGN_IN_TO_PUBLISH_GEODATABASE),shim(a,"geocortex.essentialsHtmlViewer.mapping.modules.uploadData.ERROR_NOT_AUTHORIZED_TO_PUBLISH_GEODATABASE",a.ERROR_NOT_AUTHORIZED_TO_PUBLISH_GEODATABASE),shim(a,"geocortex.essentialsHtmlViewer.mapping.modules.uploadData.ERROR_COULD_NOT_PARSE_XSLX",a.ERROR_COULD_NOT_PARSE_XSLX),shim(a,"geocortex.essentialsHtmlViewer.mapping.modules.uploadData.UploadDataModule",a.UploadDataModule),shim(a,"geocortex.essentialsHtmlViewer.mapping.modules.uploadData.flatten",a.flatten),shim(a,"geocortex.essentialsHtmlViewer.mapping.modules.uploadData.checkStringForTerms",a.checkStringForTerms),shim(t,"geocortex.essentialsHtmlViewer.mapping.modules.uploadData.LayerDetailsDialogView",t.LayerDetailsDialogView),shim(i,"geocortex.essentialsHtmlViewer.mapping.modules.uploadData.ERROR_CANCELLED_LOCAL",i.ERROR_CANCELLED_LOCAL),shim(i,"geocortex.essentialsHtmlViewer.mapping.modules.uploadData.ERROR_CANCELLED_MESSAGE_LOCAL",i.ERROR_CANCELLED_MESSAGE_LOCAL),shim(i,"geocortex.essentialsHtmlViewer.mapping.modules.uploadData.LayerDetailsDialogViewModel",i.LayerDetailsDialogViewModel),shim(r,"geocortex.essentialsHtmlViewer.mapping.modules.uploadData.SymbolDialogView",r.SymbolDialogView),shim(o,"geocortex.essentialsHtmlViewer.mapping.modules.uploadData.SymbolDialogViewModel",o.SymbolDialogViewModel),shim(n,"geocortex.essentialsHtmlViewer.mapping.modules.uploadData.Z_AXIS_ENABLED",n.Z_AXIS_ENABLED),shim(n,"geocortex.essentialsHtmlViewer.mapping.modules.uploadData.Z_AXIS_REQUIRED",n.Z_AXIS_REQUIRED),shim(n,"geocortex.essentialsHtmlViewer.mapping.modules.uploadData.TableMappingDialogView",n.TableMappingDialogView),shim(s,"geocortex.essentialsHtmlViewer.mapping.modules.uploadData.TableMappingDialogViewModel",s.TableMappingDialogViewModel),shim(l,"geocortex.essentialsHtmlViewer.mapping.modules.uploadData.TableRecordResultsDialogView",l.TableRecordResultsDialogView),shim(d,"geocortex.essentialsHtmlViewer.mapping.modules.uploadData.TableRecordResultsDialogViewModel",d.TableRecordResultsDialogViewModel),shim(p,"geocortex.essentialsHtmlViewer.mapping.modules.uploadData.UploadDialogView",p.UploadDialogView),shim(u,"geocortex.essentialsHtmlViewer.mapping.modules.uploadData.UploadDialogViewModel",u.UploadDialogViewModel),shim(c,"geocortex.essentialsHtmlViewer.mapping.modules.uploadData.widgets.uploader.UploaderView",c.UploaderView),shim(g,"geocortex.essentialsHtmlViewer.mapping.modules.uploadData.widgets.uploader.UploaderViewModel",g.UploaderViewModel)});