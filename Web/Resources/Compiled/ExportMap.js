!function(){var t="<div class='exportmap'>    <div class='export-create' data-binding='{@hidden: exportComplete}'>        <div class='export-status' data-binding='{@visible: isExporting}'>            <p data-binding='{@text: @language-export-map-is-exporting}'></p>        </div>        <div data-binding='{@hidden: isExporting}'>            <label for='outputformat' data-binding='{@text: @language-export-map-select-image-format}{@visible: outputFormats}'></label>            <select id='outputformat' data-binding='{@source: outputFormats}{@value: selectedFormat}{@visible: outputFormats}'>                <option data-binding='{@template-for: outputFormats}{@text: @context}{@attach: @context}'></option>            </select>            <input id='georeference' type='checkbox' data-binding='{@value: includeGeoreferenceData}{@enabled: formatSupportsIncludeGeoreferenceData}{@visible: allowIncludeGeoreferenceData}' />            <label for='georeference' class='inline' data-binding='{@text: @language-export-map-include-georeference-data}{@visible: allowIncludeGeoreferenceData}'></label>            <div class='form-btns'>                <button class='export-button button' data-binding='{@event-click: handleExportMapClick}{@text: @language-export-map-create-image}'></button>            </div>        </div>    </div>    <div class='export-complete' data-binding='{@visible: exportComplete}'>        <p data-binding='{@text: @language-export-map-complete-description}'></p>        <div class='form-btns'>            <button class='export-button button' data-binding='{@event-click: handleViewImageClick}{@text: @language-export-map-view-image}'></button>        </div>    </div></div>";function o(e,t,a){if("string"==typeof e&&(a=t,t=e),void 0!==a)for(var o=t.split("."),r=null,i=window,p=0,n=o.length;p<n;p++)r=o[p],p==n-1?i[r]=a:i[r]||(i[r]={}),i=i[r];else console.warn("Undefined shim for: "+t)}require({cache:{"Mapping/modules/ExportMap/ExportMapModule":function(){var o,l=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)},function(e,t){function a(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)});define(["require","exports","geocortex/framework/application/ModuleBase","geocortex/essentials/utilities/GraphicsLayerUtilities","geocortex/infrastructure/GraphicsLayerIds","geocortex/infrastructure/GraphicsLayerUtils"],function(e,t,a,o,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p,n=(p=a.ModuleBase,l(s,p),s.prototype.initialize=function(e){p.prototype.initialize.call(this,e),e.excludeHighlightLayerFromExport&&o.addToGraphicsLayerIdsToExclude([i.ExcludeFromEnum.ExportMapTaskName],r.HIGHLIGHT_LAYER_ID)},s);function s(){return null!==p&&p.apply(this,arguments)||this}t.ExportMapModule=n})},"Mapping/modules/ExportMap/ExportMapView":function(){var o,p=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)},function(e,t){function a(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)});define(["require","exports","geocortex/framework/ui/ViewBase"],function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=(o=a.ViewBase,p(i,o),i.prototype.handleExportMapClick=function(e,t,a){this.viewModel.exportMap()},i.prototype.handleViewImageClick=function(e,t,a){window.open(this.viewModel.url.get()),this.viewModel.exportComplete.set(!1)},i);function i(e,t){var a=o.call(this,e,t)||this;return a.app.command("ShowExportMapDialog").register(a,function(){a.app.viewManager.activateView(a),a.viewModel.exportComplete.set(!1)},function(){return a.app.site&&!!a.app.site.essentialsMap&&!!a.app.site.essentialsMap.supportedExportFormats}),a}t.ExportMapView=r})},"Mapping/modules/ExportMap/ExportMapViewModel":function(){var o,s=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)},function(e,t){function a(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)});define(["require","exports","geocortex/framework/ui/ViewModelBase","geocortex/framework/observables","geocortex/essentials/ReportParameters"],function(e,t,a,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,p=(i=a.ViewModelBase,s(n,i),n.prototype.siteInitialized=function(){var t=this;if(this.app.site&&this.app.site.essentialsMap&&this.app.site.essentialsMap.supportedExportFormats){var e=this.app.site.essentialsMap.supportedExportFormats.filter(function(e){return!(t.app.site.getEssentialsVersion()<4.03&&"pdf"===e.toLowerCase())});this.outputFormats.set(e),this.app.site.essentialsMap.exportMapImageOptions&&this.app.site.essentialsMap.exportMapImageOptions.defaultOutputFormat?this.selectedFormat.set(this.getFormatIgnoreCase(this.app.site.essentialsMap.exportMapImageOptions.defaultOutputFormat)):0<this.outputFormats.get().length?this.selectedFormat.set(this.outputFormats.getAt(0)):this.selectedFormat.set(this.app.getResource(this.libraryId,"language-export-map-none")),this.app.site.essentialsMap.exportMapImageOptions&&this.allowIncludeGeoreferenceData.set(this.app.site.essentialsMap.exportMapImageOptions.allowIncludeGeoreferenceData)}this.app.command("ShowExportMapDialog").raiseCanExecuteChanged()},n.prototype.getFormatIgnoreCase=function(e){var t=this.outputFormats.get();if(!t||t.length<=0)return null;if(e)for(var a=e.toUpperCase(),o=0;o<t.length;o++){var r=t[o];if(r&&r.toUpperCase()===a)return t[o]}return t[0]},n.prototype.exportMap=function(){var t=this;this.isExporting.set(!0);var e=this.app.site.essentialsMap;this.app.command("ScreenReaderNarrate").execute(this.app.getResource(this.libraryId,"language-export-map-is-exporting"));var a=new r.ReportParameters;a.outputFormat=this.selectedFormat.get(),a.customExtent=this.app.map.extent,a.extentType=r.ReportParameters.CURRENT_EXTENT,this.allowIncludeGeoreferenceData&&(a.includeGeoreferenceData=this.includeGeoreferenceData.get()),null!=this.app&&null!=this.app.map&&a.populateMapGraphicsLayers(this.app.map),e.exportMap(a,function(e){t.app.command("ScreenReaderNarrate").execute(t.app.getResource(t.libraryId,"language-export-map-complete-description")),t.isExporting.set(!1),t.url.set(e.href),t.exportComplete.set(!0)},function(e){t.app.command("Alert").execute(t.app.getResource(t.libraryId,"language-export-map-error").format(e.message)),t.app.command("ScreenReaderNarrate").execute(t.app.getResource(t.libraryId,"language-export-map-error").format(e.message)),t.isExporting.set(!1)})},n);function n(e,t){var a=i.call(this,e,t)||this;return a.formatSupportsIncludeGeoreferenceData=new o.Observable(!1),a.isExporting=new o.Observable(!1),a.exportComplete=new o.Observable(!1),a.url=new o.Observable(null),a.outputFormats=new o.ObservableCollection,a.allowIncludeGeoreferenceData=new o.Observable(!0),a.selectedFormat=new o.Observable(null),a.includeGeoreferenceData=new o.Observable(!1),a.app.site&&a.app.site.isInitialized?a.siteInitialized():a.app.event("SiteInitializingEvent").once(a,a.siteInitialized),a.formatSupportsIncludeGeoreferenceData.syncTransform(a.selectedFormat,function(e){return e&&"GeoTIFF"!=e&&"PDF"!=e}),a.includeGeoreferenceData.syncTransform(a.selectedFormat,function(e){return e&&"GeoTIFF"!=e&&"PDF"!=e&&a.includeGeoreferenceData.get()}),a}t.ExportMapViewModel=p})},"url:/Mapping/modules/ExportMap/ExportMapView.html":t}}),require(["geocortex/framework/resourceManager"],function(e){e.resourceManager.register("Mapping","inv","Mapping/modules/ExportMap/CSS/common.css","css","LmV4cG9ydG1hcA0Kew0KICAgIGhlaWdodDogMTAwJTsNCiAgICBwYWRkaW5nOiAxMHB4Ow0KfQ0KDQouZXhwb3J0bWFwIGxhYmVsDQp7DQogICAgY29sb3I6ICM2Njc1ODA7DQogICAgZm9udC1zaXplOiAxLjJlbTsNCiAgICBkaXNwbGF5OiBibG9jazsNCiAgICBtYXJnaW46IC43NWVtIDAgMC4yNWVtIDA7DQp9DQoNCi5leHBvcnRtYXAgc2VsZWN0DQp7DQogICAgd2lkdGg6IDEwMCU7DQp9DQoNCi5leHBvcnRtYXAgaW5wdXRbdHlwZT0nY2hlY2tib3gnXQ0Kew0KICAgIGRpc3BsYXk6IGlubGluZTsNCiAgICBtYXJnaW46IC43NWVtIDAgMC4yNWVtIDA7DQp9DQoNCi5leHBvcnRtYXAgLmlubGluZQ0Kew0KICAgIGRpc3BsYXk6IGlubGluZTsNCn0NCg0KLmV4cG9ydG1hcCBidXR0b25zDQp7DQogICAgbWFyZ2luLXRvcDogLjc1ZW07DQogICAgdGV4dC1hbGlnbjogY2VudGVyOw0KfQ0K"),e.resourceManager.register("Mapping","inv","Mapping/modules/ExportMap/ExportMapView.html","html",t)}),require({cache:{}}),define(["Mapping/modules/ExportMap/ExportMapModule","Mapping/modules/ExportMap/ExportMapView","Mapping/modules/ExportMap/ExportMapViewModel"],function(e,t,a){o(e,"geocortex.essentialsHtmlViewer.mapping.modules.exportMap.ExportMapModule",e.ExportMapModule),o(t,"geocortex.essentialsHtmlViewer.mapping.modules.exportMap.ExportMapView",t.ExportMapView),o(a,"geocortex.essentialsHtmlViewer.mapping.modules.exportMap.ExportMapViewModel",a.ExportMapViewModel)})}();