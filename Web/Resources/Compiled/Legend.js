!function(){function e(e,t,r){if("string"==typeof e&&(r=t,t=e),void 0!==r)for(var n=t.split("."),i=null,o=window,s=0,a=n.length;s<a;s++)i=n[s],s==a-1?o[i]=r:o[i]||(o[i]={}),o=o[i];else console.warn("Undefined shim for: "+t)}var t="<div class='results-list-actions-widget' data-binding='{@visible: viewInitialized}{@widget: LegendActionsWidget}{@widget-context: @context}{@widget-required: false}'     data-menu-id='LegendActions' data-menu-template='Mapping/infrastructure/menus/MenuHyperlinkView.html'></div><div class='panel-filter-widget' data-binding='{@visible: viewInitialized}{@widget: LegendListFilterWidget}{@widget-context: @context}{@widget-required: true}'></div><div class='no-results' data-binding='{@hidden: hasVisibleItems}'>    <p data-binding='{@text: @language-legend-no-items}'></p></div><div class='layer-list legend' data-binding='{@visible: hasVisibleItems}{@source: onDemandRootNode}'>    <div class='legend-list' data-binding='{@template-for: onDemandRootNode}'>        <ul data-binding='{@source: children}{@template: Mapping/modules/Legend/Templates/LegendItemNode.html}'></ul>    </div></div>",r="<div class='legend-item leaf clear'>    <div class='legend-swatch' data-binding='{innerHTML: swatchElement}{title: label}'></div>    <span class='legend-item-label' data-binding='{@text: label}{title: label}'></span></div>",n="<div class='legend-item group clear'>    <div class='legend-item-parent'>        <button data-binding='{class: expanderClass}{@visible: children}{@event-onclick: handleSlideToggleClick}{title: label}'>        <span class='legend-item-label' data-binding='{@text: label}{title: label}'></span></button>    </div>    <ul class='legend-item children' data-binding='{@source: children}{@visible: expanded}{@template: Mapping/modules/Legend/Templates/LegendItemNode.html}'>    </ul></div>",i="<li data-binding='{@source: @context}{@visible: isVisible}{@template-selector: templateType}'>    <div class='templ-item' data-binding='{@template-select: single-item}{@template: Mapping/modules/Legend/Templates/LegendItem.html}'></div>    <div class='templ-group' data-binding='{@template-select: group}{@template: Mapping/modules/Legend/Templates/LegendItemGroup.html}'></div></li>";require({cache:{"Mapping/modules/Legend/LegendModule":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();define(["require","exports","geocortex/framework/application/ModuleBase","geocortex/infrastructure/legend/LegendItemProviderFactory","./Providers/ArcGISDynamicMapService/ArcGISDynamicMapServiceLegendProvider","./Providers/ArcGISTiledMapService/ArcGISTiledMapServiceLegendProvider","./Providers/FeatureLayer/FeatureLayerLegendProvider","./Providers/KML/KMLLayerLegendProvider","./Providers/WMS/WMSLayerLegendProvider","./Providers/WFS/WFSLayerLegendProvider","./Providers/HeatMaps/HeatMapLayerLegendProvider","./Providers/ClusterLayer/ClusterLayerLegendProvider"],function(t,r,n,i,o,s,a,l,d,p,g,c){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var u=function(){return function(){}}();r.LegendItemViewModel=u;var h=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return e(r,t),r.prototype.initialize=function(e){this.enableThrottling=!e||void 0==e.enableThrottling||e.enableThrottling,i.LegendItemProviderFactory.registerLegendItemProvider(new o.ArcGISDynamicMapServiceLegendProvider(this.app,this.libraryId,this.enableThrottling)),i.LegendItemProviderFactory.registerLegendItemProvider(new s.ArcGISTiledMapServiceLegendProvider(this.app,this.libraryId,this.enableThrottling)),i.LegendItemProviderFactory.registerLegendItemProvider(new a.FeatureLayerLegendProvider(this.app,this.libraryId,this.enableThrottling)),i.LegendItemProviderFactory.registerLegendItemProvider(new l.KMLLayerLegendProvider(this.app,this.libraryId,this.enableThrottling)),i.LegendItemProviderFactory.registerLegendItemProvider(new d.WMSLayerLegendProvider(this.app,this.libraryId,this.enableThrottling)),i.LegendItemProviderFactory.registerLegendItemProvider(new p.WFSLayerLegendProvider(this.app,this.libraryId,this.enableThrottling)),i.LegendItemProviderFactory.registerLegendItemProvider(new g.HeatMapLayerLegendProvider(this.app,this.libraryId,this.enableThrottling)),i.LegendItemProviderFactory.registerLegendItemProvider(new c.ClusterLayerLegendProvider(this.app,this.libraryId,this.enableThrottling))},r}(n.ModuleBase);r.LegendModule=h})},"Mapping/modules/Legend/LegendView":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();define(["require","exports","geocortex/framework/ui/ViewBase","geocortex/infrastructure/ui/components/FilterControl/FilterControlViewBase"],function(t,r,n,i){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=function(t){function r(e,r){var n=t.call(this,e,r)||this;return n.registerCommands(),n}return e(r,t),r.prototype.registerCommands=function(){var e=this;this.app.command("SwitchToLegendView").register(this,function(){e.app.command("ActivateView").execute(e.id)})},r.prototype.resolveWidget=function(e,r,n){switch(t.prototype.resolveWidget.call(this,e,r),e){case"LegendActionsWidget":return this.app.menuRegistry.createMenuWidget(this,r,n);case"LegendListFilterWidget":if(!r)return null;var o=new i.FilterControlViewBase(this.app,this.libraryId);o.handleFilterButtonClick=dojo.hitch(this,this.handleFilterButtonClick),o.handleFilterTextClear=dojo.hitch(this,this.handleFilterTextClear);var s=this.app.viewManager.createView({markupResource:"Mapping/infrastructure/ui/components/FilterControl/FilterControlView.html",typeName:"geocortex.essentialsHtmlViewer.mapping.infrastructure.ui.components.FilterControl.FilterControlViewBase",isVisible:!0},o);return s.attach(r.filterControlViewModel),s;default:return this.app.trace.warning("LegendView: Unknown Widget"),null}},r.prototype.activated=function(){this.viewModel.viewActive.set(!0)},r.prototype.deactivated=function(){this.viewModel.viewActive.set(!1)},r.prototype.handleSlideToggleClick=function(e,t,r){r.expanded.set(!r.expanded.get())},r.prototype.handleClickShowLayerList=function(){this.app.command("SwitchToLayerView").execute()},r.prototype.handleFilterTextClear=function(e,t,r){this.viewModel.filterControlViewModel.filterText.set("")},r.prototype.handleFilterButtonClick=function(e,t,r){this.viewModel.filterControlViewModel.filterText.pulse()},r}(n.ViewBase);r.LegendView=o})},"Mapping/modules/Legend/LegendViewModel":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();define(["require","exports","geocortex/framework/ui/ViewModelBase","geocortex/infrastructure/legend/LegendItem","geocortex/framework/observables","geocortex/infrastructure/legend/LegendItemProviderResponse","geocortex/infrastructure/legend/LegendItemProviderFactory","geocortex/infrastructure/ui/components/FilterControl/FilterControlComponent","geocortex/infrastructure/ui/components/FilterControl/FilterControlViewModelBase"],function(t,r,n,i,o,s,a,l,d){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var p=function(t){function r(){var e=null!==t&&t.apply(this,arguments)||this;return e.hasVisibleItems=new o.Observable(!1),e.viewActive=new o.Observable(!1),e.extentChangedBindingToken=null,e._topLevelItems=[],e._filteredOutLegendItemLabels=[],e._itemsExpandedByFilter=[],e._filterControlId="LegendListFilterControl",e._namePositionDictionary={},e}return e(r,t),r.prototype.initialize=function(){var e=this;this.rootNode=new i.LegendItem(null),this.onDemandRootNode=new i.LegendItem(null,!0),this.filterControlViewModel=new d.FilterControlViewModelBase(this.app,this.libraryId),this.filterControlViewModel.filterInputPlaceholder.set(this.getResource("language-legend-search-placeholder")),this.filterControlViewModel.filterButtonText.set(this.getResource("language-legend-filter-button-text")),this.filterControlViewModel.setFilterControlComponent(new l.FilterControlComponent(this.app,this._filterControlId)),this.app.event("FilterControlResultChangedEvent").subscribe(this,this._handleFilterChanged),this.app.site&&this.app.site.isInitialized?this._handleInitializedSite(this.app.isOffline.get()):this.app.event("SiteInitializedEvent").once(this,function(){return e._handleInitializedSite(e.app.isOffline.get())}),this.app.event("MapServiceAddedEvent").subscribe(this,this._handleMapServiceAddedEvent),this.app.event("MapServicePropertyChangedEvent").subscribe(this,this._handleMapServiceAddedEvent),this.app.event("MapServiceLayersChangedEvent").subscribe(this,this._handleMapServiceAddedEvent),this.app.event("MapServiceRemovedEvent").subscribe(this,this._handleMapServiceRemovedEvent),this.app.event("MapExtentChangedEvent").subscribe(this,this._handleMapExtentChangedEvent),this.app.event("LayerVisualizationChangedEvent").subscribe(this,this._handleLayerVisualizationChanged),this.app.event("ClusterLayerAddedEvent").subscribe(this,this._handleAddClusterLegend),this.app.isOffline.bind(this,function(t){try{e._clear(),e._handleInitializedSite(t),setTimeout(function(){e._handleMapExtentChangedEvent()},100)}catch(t){e.app.trace.warning("Legend error while transitioning between online/offline modes: "+t)}})},r.prototype._handleAddClusterLegend=function(e){this._handleLayerAddition(e,this.app.isOffline.get())},r.prototype._handleLayerVisualizationChanged=function(e){var t=this;setTimeout(function(){t._handleMapServiceAddedEvent(e.mapService),t._removeClusteredLegendItems()},500)},r.prototype._handleMapServiceAddedEvent=function(e){if(e){var t=e.serviceLayer;try{this._handleLayerAddition(t,this.app.isOffline.get())}catch(e){this.app.trace.warning("Error loading legend items for layer '{0}': {1}".format(t.url,e.toString()))}}},r.prototype._handleMapServiceRemovedEvent=function(e){if(e)for(var t=e.serviceLayer,r=0;r<this.rootNode.children.get().length;r++)t===this.rootNode.children.get()[r].esriLayer&&(this.rootNode.children.removeAt(r),this._removeTopLevelItem(r))},r.prototype._clear=function(){this._onServiceLayerAddConnectHandle&&(this._onServiceLayerAddConnectHandle.remove(),this._onServiceLayerAddConnectHandle=null),this._onLayerRemoveHandle&&(this._onLayerRemoveHandle.remove(),this._onLayerRemoveHandle=null),this._serviceLayerVisEventSubscribeHandle&&(this.app.event("MapServiceVisibilityChangedEvent").unsubscribe(this._serviceLayerVisEventSubscribeHandle),this._serviceLayerVisEventSubscribeHandle=null),this._layerVisEventSubscribeHandle&&(this.app.event("LayerVisibilityChangedEvent").unsubscribe(this._layerVisEventSubscribeHandle),this._layerVisEventSubscribeHandle=null),this._clearTopLevelItems(),this.hasVisibleItems.set(!1)},r.prototype._handleInitializedSite=function(e){var t=this;this._map=this.app.map;for(var r={},n=this._map.layerIds.concat(this._map.graphicsLayerIds),i=0;i<n.length;++i){var o=this._map.getLayer(n[i]);if(o){r[o.url]=o;try{this._handleLayerAddition(o,e)}catch(e){this.app.trace.warning("Error loading legend items for layer '{0}': {1}".format(o.url,e.toString()))}}}this._onServiceLayerAddConnectHandle=this._map.on("layer-add",function(n){if(!r[n.layer.url])try{t._handleLayerAddition(n.layer,e)}catch(e){t.app.trace.warning("Error loading legend items for layer '{0}': {1}".format(n.layer.url,e.toString()))}}),this._onLayerRemoveHandle=this._map.on("layer-remove",function(r){t._handleLayerRemoval(r.layer,e)}),this._layerVisEventSubscribeHandle=this.app.event("LayerVisibilityChangedEvent").subscribe(this,this._handleMapExtentChangedEvent),this._serviceLayerVisEventSubscribeHandle=this.app.event("MapServiceVisibilityChangedEvent").subscribe(this,this._handleMapExtentChangedEvent)},r.prototype._refreshLegend=function(){this._handleMapExtentChangedEvent()},r.prototype._handleMapExtentChangedEvent=function(){var e=this;if(this.viewActive.get())try{this._handleMapExtentChangedEventImpl()}catch(e){}else this.extentChangedBindingToken||(this.extentChangedBindingToken=this.viewActive.bind(this,function(){e.viewActive.unbind(e.extentChangedBindingToken),e.extentChangedBindingToken=null,e._handleMapExtentChangedEventImpl()}))},r.prototype._handleMapExtentChangedEventImpl=function(){for(var e=this.app.map.getScale(),t=0,r=!1,n=0;n<this._topLevelItems.length;++n){var i=this._topLevelItems[n];i&&(t+=this._walkLegendTree(e,i),i.isVisible.get()&&("group"!==i.templateType||"group"===i.templateType&&i.children.length())&&(r=!0))}this._removeClusteredLegendItems(),this._populateOnDemandRootNode(),r!==this.hasVisibleItems.get()&&this.hasVisibleItems.set(r)},r.prototype._populateOnDemandRootNode=function(){this.onDemandRootNode.children.clear();var e=this.rootNode.children.get().filter(function(e){return e.isVisible.get()});this.onDemandRootNode.children.addItems(e)},r.prototype._isVisibleInTree=function(e){if(e&&!e.isVisible())return!0;if(e){if(null==e.parentLayerId)return!1;var t=e.mapService.findLayerById(e.parentLayerId);return!!t&&this._isVisibleInTree(t)}return!1},r.prototype._walkLegendTree=function(e,t){if(t.essLayer&&this._isVisibleInTree(t.essLayer))return this._hideLegendItem(t),0;if(!t.essLayer&&!t.esriLayer.visible)return this._hideLegendItem(t),0;if(t.isCluster)return 1;for(var r=0,n=t.children.getLength()>0,i=0;i<t.children.getLength();++i)r+=this._walkLegendTree(e,t.children.getAt(i));var o=Number.POSITIVE_INFINITY,s=0;o=t.essLayer?t.essLayer.minScale:t.esriLayer.minScale,s=t.essLayer?t.essLayer.maxScale:t.esriLayer.maxScale;var a=!1;return 0===o&&0===s?a=!0:e>=s&&e<=o&&(a=!0),a=a&&(t.essLayer?t.essLayer.isVisible():t.esriLayer.visible),a?a=n&&0===r?this._setFilterContingentLegendVisibility(t,!1):this._setFilterContingentLegendVisibility(t,!0):this._setFilterContingentLegendVisibility(t,!1),!a||0===r&&t.children.getLength()>0?0:r+(n?0:1)},r.prototype._hideLegendItem=function(e){!0===e.isVisible.get()&&e.isVisible.set(!1)},r.prototype._showLegendItem=function(e){!1===e.isVisible.get()&&e.isVisible.set(!0)},r.prototype._setFilterContingentLegendVisibility=function(e,t){var r=t&&-1===this._filteredOutLegendItemLabels.indexOf(e.label.get());return r?this._showLegendItem(e):this._hideLegendItem(e),r},r.prototype._handleLayerAddition=function(e,t){var r=this._getProvider(e,t);if(r){var n=r.item;if(r.code.get()===s.LegendItemProviderResponseCode.Show||r.code.get()===s.LegendItemProviderResponseCode.Pending)this._replaceDuplicate(n,r)||this._addTopLevelItem(n,r);else if(r.code.get()===s.LegendItemProviderResponseCode.Hide){for(i=0;i<this.rootNode.children.length();i++)if(this.rootNode.children.getAt(i).esriLayer===n.esriLayer){this.rootNode.children.removeAt(i);break}for(var i=0;i<this._topLevelItems.length;i++)if(this._topLevelItems[i]&&this._topLevelItems[i].esriLayer===n.esriLayer){this._removeTopLevelItem(i);break}}this._handleMapExtentChangedEvent()}},r.prototype._handleLayerRemoval=function(e,t){var r=this._getProvider(e,t);if(r){for(var n=r.item,i=0;i<this.rootNode.children.length();i++)if(this.rootNode.children.getAt(i).esriLayer===n.esriLayer){if(n.esriLayer instanceof esri.layers.FeatureLayer){var o=n.esriLayer.name;(!this._namePositionDictionary.hasOwnProperty(o)||this._namePositionDictionary[o]>i)&&(this._namePositionDictionary[o]=i)}this.rootNode.children.removeAt(i);break}for(i=0;i<this._topLevelItems.length;i++)if(this._topLevelItems[i]&&this._topLevelItems[i].esriLayer===n.esriLayer){this._removeTopLevelItem(i);break}this._handleMapExtentChangedEvent()}},r.prototype._getProvider=function(e,t){for(var r=a.LegendItemProviderFactory.getProviders(),n=0;n<r.length;++n){var i=r[n];if(!t||i.supportsOffline()){var o;try{o=i.provide(e)}catch(e){this.app.trace.warning("Error building legend: "+e);continue}if(o&&o.code.get()!==s.LegendItemProviderResponseCode.NotFound)return o}}return null},r.prototype._replaceDuplicate=function(e,t){for(var r=this,n=0;n<this.rootNode.children.get().length;n++){var i=this.rootNode.children.get()[n];if(e.esriLayer===i.esriLayer)return this.rootNode.children.removeAt(n),this.rootNode.children.insertItem(n,e),this._topLevelItems[n]=e,this._getLegendFlatListFromItem(i).forEach(function(e){r.filterControlViewModel.getFilterControlComponent().removeRegisteredItem(e)}),this._registerFilterableItem(e,t),!0}return!1},r.prototype._addTopLevelItem=function(e,t){var r=0;if(e.esriLayer instanceof esri.layers.FeatureLayer){var n=e.esriLayer.name;n&&this._namePositionDictionary.hasOwnProperty(n)&&(r=this._namePositionDictionary[n])}this.rootNode.children.insertItem(r,e),this._topLevelItems.unshift(e),this._registerFilterableItem(e,t)},r.prototype._registerFilterableItem=function(e,t){var r=this;if(t&&t.code.get()!==s.LegendItemProviderResponseCode.Show)var n=t.code.bind(this,function(i){i===s.LegendItemProviderResponseCode.Show&&(t.code.unbind(n),r._getLegendFlatListFromItem(e).forEach(function(e){return r.filterControlViewModel.getFilterControlComponent().registerFilterableItem(e,[e.label.get()])}))});else this._getLegendFlatListFromItem(e).forEach(function(e){return r.filterControlViewModel.getFilterControlComponent().registerFilterableItem(e,[e.label.get()])})},r.prototype._removeTopLevelItem=function(e){var t=this,r=this._topLevelItems[e];if(!r)return!1;this._topLevelItems.splice(e,1),this._getLegendFlatListFromItem(r).forEach(function(e){t.filterControlViewModel.getFilterControlComponent().removeRegisteredItem(e)})},r.prototype._clearTopLevelItems=function(){this._topLevelItems.length=0,this.filterControlViewModel.getFilterControlComponent().clear()},r.prototype._getLegendFlatListFromItem=function(e){var t=this,r=[];return r.push(e),"group"===e.templateType&&e.children.get().forEach(function(e){r=r.concat(t._getLegendFlatListFromItem(e))}),r},r.prototype._removeClusteredLegendItems=function(){for(var e=0;e<this._topLevelItems.length;++e){var t=this._topLevelItems[e];t&&(t.esriLayer instanceof esri.layers.FeatureLayer&&null===t.esriLayer.renderer&&t.isVisible.set(!1))}},r.prototype._handleFilterChanged=function(e){if(e.filterControlId===this._filterControlId){this._restoreExpandedLegendItems(),this._filteredOutLegendItemLabels=e.filterableItems.filter(function(e){return!e.queryMatched}).map(function(e){return e.item.label.get()});var t=e.filterableItems.filter(function(e){return e.queryMatched}).map(function(e){return e.item});this._processDisplayableLegendItems(t,e.filterableItems.length&&!e.filterableItems[0].filterQuery),this._refreshLegend()}},r.prototype._restoreExpandedLegendItems=function(){this._itemsExpandedByFilter&&this._itemsExpandedByFilter.length&&(this._itemsExpandedByFilter.forEach(function(e){return e.expanded.set(!1)}),this._itemsExpandedByFilter.length=0)},r.prototype._processDisplayableLegendItems=function(e,t){var r=this;void 0===t&&(t=!1);var n=function(e){var t=r._filteredOutLegendItemLabels.indexOf(e);t>=0&&r._filteredOutLegendItemLabels.splice(t,1)},i=function(e){e.expanded.get()||t||(e.expanded.set(!0),r._itemsExpandedByFilter.push(e))},o=function(e){n(e.label.get()),i(e)},s=function(e){for(var t=e.parent;t;)o(t),t=t.parent},a=function(e){o(e),e.children.get().forEach(function(e){o(e)})};e.forEach(function(e){s(e),a(e)})},r}(n.ViewModelBase);r.LegendViewModel=p})},"Mapping/modules/Legend/Providers/ArcGISCommonLegendProviderClasses/ArcGISMapServiceLegendProvider":function(){define(["require","exports","geocortex/infrastructure/legend/LegendItemProviderResponse","geocortex/infrastructure/legend/LegendItem","geocortex/essentials/RestHelperHTTPService"],function(e,t,r,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t,r,n,i){this.app=e,this.libraryId=t,this.layerType=r||"",this.offlineSupported=n||!1,this.useThrottledCollections=i||!1}return e.prototype.supportsOffline=function(){return this.offlineSupported},e.prototype.provide=function(e){var t=this;if((null!=e.declaredClass?e.declaredClass:null)!==this.layerType)return new r.LegendItemProviderResponse(r.LegendItemProviderResponseCode.NotFound,null);if(Number(e.version)<10.01)return new r.LegendItemProviderResponse(r.LegendItemProviderResponseCode.NotFound,null);if(e.url&&e.url.indexOf("/ImageServer")>=0)return new r.LegendItemProviderResponse(r.LegendItemProviderResponseCode.NotFound,null);for(var i=this.app.site,o="",s=null,a=0;a<i.essentialsMap.mapServices.length;++a){var l=i.essentialsMap.mapServices[a];if(l.serviceLayer===e){s=l;break}}var d=null;s&&(d=this._getLegendUrl(s)),null==d&&(d=e.url.replace("/MapServer","/MapServer/legend"));var p=new n.LegendItem(e,this.useThrottledCollections),g=esri.request({url:d,content:{f:"json"},handleAs:"json",callbackParamName:"callBack"}),c=new r.LegendItemProviderResponse(r.LegendItemProviderResponseCode.Pending,p);if(g.then(function(r){t._handleLegendResponse(r,c,p,e,s)},function(e){t._handleLegendError(p,e)}),s)o=l.displayName;else{var u=e.url.lastIndexOf("/");u>-1&&(o=e.url.substr(u))}return p.label.set(o),p.templateType="group",c},e.prototype._handleLegendResponse=function(e,t,r,n,i){this._populateItemForLayer(e,t,r,n,i)},e.prototype._findGcxLayerForEsriLayer=function(e,t){return e.findLayerById(t.layerId)},e.prototype._populateItemForLayer=function(e,t,i,o,s){if(e){i.isVisible.set(!0);for(var a=0;a<e.layers.length;++a){var l=e.layers[a],d=(l.minScale,l.maxScale,null),p=null;if(s){if(!(d=this._findGcxLayerForEsriLayer(s,l)))continue;if(!d.includeInLegend)continue;p=d.displayName,d.minScale,d.maxScale}var g=new n.LegendItem(o,this.useThrottledCollections);g.label.set(p||l.layerName),g.essLayer=d;for(var c=0;c<l.legend.length;++c){var u=l.legend[c],h=u.imageData,m=String.escapeHtml(h),v=new n.LegendItem(o,this.useThrottledCollections);v.label.set(u.label?u.label:this.app.getResource(this.libraryId,"language-legend-default-swatch-label")),v.sublayerId=l.layerId,v.essLayer=d;var L="data:"+u.contentType+";base64,"+m,y=this.app.getResource(this.libraryId,"language-legend-icon-alt-text").format(v.label.get());v.swatchElement="<img src='"+L+"' alt='"+y+"' />",v.parent=g,g.children.addItem(v)}if(1===g.children.getLength()){var f=g.children.getAt(0);f.templateType="single-item",f.label.set(g.label.get()),f.parent=i,i.children.addItem(f)}else g.children.getLength()>1&&(g.templateType="group",g.parent=i,i.children.addItem(g))}i.children.getLength()>0&&(i.templateType="group"),t.code.set(r.LegendItemProviderResponseCode.Show)}else this.app.trace.warning("Could not fetch legend entry for '{0}'".format(o.url))},e.prototype._handleLegendError=function(e,t){this.app.trace.warning("Error fetching legend information: "+t.toString()),e.isVisible.set(!1)},e.prototype._getLegendUrl=function(e){var t=null;if(e&&e.serviceLayer&&e.serviceLayer.url){var r=e.serviceLayer.url.match(/(\/MapServer\/jobs\/[\d\w]+)[\?\/]?/),n=r&&r[1]?r[1]:"/MapServer";t=e.serviceLayer.url.replace(n,n+"/legend")}return t&&e.serviceToken&&!/.*token=.*/.test(t)&&(t=i.RestHelperHTTPService.appendTokenToUrl(t,e.serviceToken)),t},e}();t.ArcGISMapServiceLegendProvider=o})},"Mapping/modules/Legend/Providers/ArcGISDynamicMapService/ArcGISDynamicMapServiceLegendProvider":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();define(["require","exports","./../ArcGISCommonLegendProviderClasses/ArcGISMapServiceLegendProvider","geocortex/infrastructure/legend/LegendItemProviderResponse","geocortex/infrastructure/legend/LegendItem"],function(t,r,n,i,o){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s=function(t){function r(e,r,n){var i=t.call(this,e,r,"esri.layers.ArcGISDynamicMapServiceLayer",!1,!!n)||this;return i.offlineSupported=!0,i}return e(r,t),r.prototype.provide=function(e){var t=this;if((null!=e.declaredClass?e.declaredClass:null)!==this.layerType)return new i.LegendItemProviderResponse(i.LegendItemProviderResponseCode.NotFound,null);var r=e;if(Number(r.version)<10.01)return new i.LegendItemProviderResponse(i.LegendItemProviderResponseCode.NotFound,null);for(var n=this.app.site,s="",a=null,l=0;l<n.essentialsMap.mapServices.length;++l){var d=n.essentialsMap.mapServices[l];if(d.serviceLayer===e){a=d;break}}var p=null;a&&(p=this._getLegendUrl(a)),null==p&&(p=e.url.replace("/MapServer","/MapServer/legend"));var g=new o.LegendItem(e,this.useThrottledCollections),c={};if(a){if(0===a.layers.length)return new i.LegendItemProviderResponse(i.LegendItemProviderResponseCode.NotFound,null);a.supportsDynamicLayers&&r.dynamicLayerInfos&&r.dynamicLayerInfos.length>0&&(c.dynamicLayers=this.getDynamicLayersParameterJSON(r)),s=a.displayName}else{var u=e.url.lastIndexOf("/");u>-1&&(s=e.url.substr(u))}g.label.set(s),g.templateType="group",c.f="json";var h=esri.request({url:p,content:c,handleAs:"json",callbackParamName:"callBack"}),m=new i.LegendItemProviderResponse(i.LegendItemProviderResponseCode.Pending,g);return h.then(function(r){t._handleLegendResponse(r,m,g,e,a)},function(e){t._handleLegendError(g,e)}),m},r.prototype.getDynamicLayersParameterJSON=function(e){var t=[];if(e.dynamicLayerInfos)for(var r=e.dynamicLayerInfos,n=0;n<r.length;n++)if(r[n]){var i=new a;i.source=r[n].source.toJson(),i.id=r[n].id,e.layerDrawingOptions&&e.layerDrawingOptions[r[n].id]&&(i.drawingInfo=e.layerDrawingOptions[r[n].id].toJson()),t.push(i)}return JSON.stringify(t)},r}(n.ArcGISMapServiceLegendProvider);r.ArcGISDynamicMapServiceLegendProvider=s;var a=function(){return function(){}}()})},"Mapping/modules/Legend/Providers/ArcGISTiledMapService/ArcGISTiledMapServiceLegendProvider":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();define(["require","exports","./../ArcGISCommonLegendProviderClasses/ArcGISMapServiceLegendProvider"],function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=function(t){function r(e,r,n){return t.call(this,e,r,"esri.layers.ArcGISTiledMapServiceLayer",!1,!!n)||this}return e(r,t),r}(n.ArcGISMapServiceLegendProvider);r.ArcGISTiledMapServiceLegendProvider=i})},"Mapping/modules/Legend/Providers/FeatureLayer/FeatureLayerLegendProvider":function(){define(["require","exports","geocortex/infrastructure/legend/LegendItemProviderResponse","geocortex/infrastructure/legend/LegendItem","geocortex/infrastructure/SymbolUtils"],function(e,t,r,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t,r){this.app=e,this.libraryId=t,this.mapServiceLegends={},this.useThrottledCollections=!!r}return e.prototype.supportsOffline=function(){return!0},e.prototype.provide=function(e){if("esri.layers.FeatureLayer"!==(null!=e.declaredClass?e.declaredClass:null))return new r.LegendItemProviderResponse(r.LegendItemProviderResponseCode.NotFound,null);for(var t=this.app.site,i=0;i<t.essentialsMap.mapServices.length;i++){var o=t.essentialsMap.mapServices[i];if(o.serviceLayer instanceof esri.layers.KMLLayer){for(var s=o.serviceLayer.getLayers(),a=0;a<s.length;a++)if(s[a]===e)return new r.LegendItemProviderResponse(r.LegendItemProviderResponseCode.NotFound,null)}else if(o.serviceLayer===e){if(o.heatMap&&o.heatMap.enabled&&Modernizr.canvas)return new r.LegendItemProviderResponse(r.LegendItemProviderResponseCode.NotFound,null);if(o.featureClustering&&o.featureClustering.enabled)return new r.LegendItemProviderResponse(r.LegendItemProviderResponseCode.NotFound,null)}}for(var l=new n.LegendItem(e,this.useThrottledCollections),d=e,p=t.getFeatureServices(),g=null,i=0;i<p.length;++i){var c=p[i];if(c.serviceLayer===e){g=c;break}}if(g){l.label.set(g.displayName);for(i=0;i<g.layers.length;++i){var u=g.layers[i];u.includeInLegend&&this.populateItemForLayer(l,u,d,null)}}else l.label.set(d.name),this.populateItemForLayer(l,u,d,null);return l&&l.children&&l.children.length()?new r.LegendItemProviderResponse(r.LegendItemProviderResponseCode.Show,l):new r.LegendItemProviderResponse(r.LegendItemProviderResponseCode.Hide,l)},e.prototype._buildLegendItemForTemplate=function(e,t,r){var i;if(i=new n.LegendItem(t,this.useThrottledCollections),i.essLayer=e,i.label.set(r.name),t.renderer){var o=this._getTemplateSymbol(r,t.renderer);o&&this._populateSwatchElement(i,o)}return i},e.prototype._buildLegendItemFromSimpleRenderer=function(e,t,r){var i;return i=new n.LegendItem(t,this.useThrottledCollections),i.essLayer=e,i.label.set(e&&e.displayName?e.displayName:t.name),r.symbol&&this._populateSwatchElement(i,r.symbol),i},e.prototype._buildLegendItemFromRendererInfo=function(e,t,r){var i;return i=new n.LegendItem(t,this.useThrottledCollections),i.essLayer=e,i.label.set(r.label),r.symbol&&this._populateSwatchElement(i,r.symbol),i},e.prototype._populateSwatchElement=function(e,t){if(t&&t.type&&e){var r=t.color?t.color.toCss():"rgb(255,255,255)",n=String.escapeHtml(r);switch(t.type){case"picturefillsymbol":case"picturemarkersymbol":var o=t.url,s=this.app.getResource(this.libraryId,"language-legend-icon-alt-text").format(e.label.get()),a=t.width,l=t.height,d=String.escapeHtml(o);e.swatchElement="<img src='"+d+"' alt='"+s+"' width='"+a+"' height='"+l+"'/>";break;case"simplefillsymbol":case"simplemarkersymbol":case"simplelinesymbol":var p=document.createElement("div"),g=t instanceof esri.symbol.SimpleMarkerSymbol?t.size+(t.outline?t.outline.width:0):32;i.createSymbolSwatch(p,g,t),e.swatchElement=p.innerHTML;break;default:e.swatchElement="<div class='simple-swatch square' style='background-color: "+n+"; border-color: "+n+";'></div>"}}},e.prototype._getTemplateSymbol=function(e,t){var r=new esri.Graphic(null);return r.attributes={},e.prototype.attributes&&dojo.mixin(r.attributes,e.prototype.attributes),t.getSymbol(r)},e.prototype.populateItemForLayer=function(e,t,r,n){var i=new Array;if(e.essLayer=t,r.renderer&&(r.renderer instanceof esri.renderer.UniqueValueRenderer||r.renderer instanceof esri.renderer.ClassBreaksRenderer)&&r.renderer.infos&&r.renderer.infos.length)for(var o=[],s=0;s<r.renderer.infos.length;++s){var a=r.renderer.infos[s];-1===o.indexOf(a.label)&&(i.push(this._buildLegendItemFromRendererInfo(t,r,a)),o.push(a.label))}else if(r.renderer&&r.renderer instanceof esri.renderer.SimpleRenderer&&r.renderer.symbol)i.push(this._buildLegendItemFromSimpleRenderer(t,r,r.renderer));else if(r.templates&&r.templates.length>0)for(s=0;s<r.templates.length;++s)i.push(this._buildLegendItemForTemplate(t,r,r.templates[s]));else if(r.types&&r.types.length>0)for(s=0;s<r.types.length;++s){var l=r.types[s];if(l.templates)for(var d=0;d<l.templates.length;++d)i.push(this._buildLegendItemForTemplate(t,r,l.templates[d]))}i.forEach(function(t){return t.parent=e}),e.children.addItems(i),e.children.getLength()>0&&(e.templateType="group")},e.prototype._handleLegendError=function(e,t){this.app.trace.warning("Error fetching legend information: "+t.toString())},e}();t.FeatureLayerLegendProvider=o})},"Mapping/modules/Legend/Providers/HeatMaps/HeatMapLayerLegendProvider":function(){define(["require","exports","geocortex/infrastructure/legend/LegendItemProviderResponse","geocortex/infrastructure/legend/LegendItem","geocortex/infrastructure/ColorUtils"],function(e,t,r,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t,r){this.app=e,this.libraryId=t,this.useThrottledCollections=!!r}return e.prototype.supportsOffline=function(){return!0},e.prototype.provide=function(e){if(!(e instanceof esri.layers.FeatureLayer&&Modernizr.canvas))return new r.LegendItemProviderResponse(r.LegendItemProviderResponseCode.NotFound,null);for(var t,i=this.app.site,o=e,s=0;s<i.essentialsMap.mapServices.length;s++){var a=i.essentialsMap.mapServices[s];if(a.serviceLayer===o){t=a;break}}if(!(t&&t.heatMap&&t.heatMap.enabled&&t.heatMap.includeInLegend))return new r.LegendItemProviderResponse(r.LegendItemProviderResponseCode.NotFound,null);var l=new n.LegendItem(e,this.useThrottledCollections);l.label.set(t.displayName);for(s=0;s<t.layers.length;s++){var d=t.layers[s];d.includeInLayerList&&this.populateItemForLayer(l,d,o,null)}return l&&l.children&&l.children.length()?new r.LegendItemProviderResponse(r.LegendItemProviderResponseCode.Show,l):new r.LegendItemProviderResponse(r.LegendItemProviderResponseCode.Hide,l)},e.prototype.populateItemForLayer=function(e,t,r,o){var s=new Array;e.essLayer=t;var a=r.renderer;if(a&&a instanceof esri.renderer.HeatmapRenderer){var l=a.colors;!l&&a.colorStops&&(l=a.colorStops.map(function(e){var t=e.color;return t instanceof dojo.Color?t.toCss(!0):t instanceof Array?i.getStringFromList(t):t}));for(var d=l.filter(function(e){return!e.match(/rgba.*,(?= 0\))/g)}),p=d.length-1;p>=0;p--){var g=d[p],c=String.escapeHtml(g),u=new n.LegendItem(r,this.useThrottledCollections);u.essLayer=t;var h="";0===p?h=this.app.getResource(this.libraryId,"language-legend-heat-maps-low"):p===d.length-1&&(h=this.app.getResource(this.libraryId,"language-legend-heat-maps-high")),u.label.set(h),u.swatchElement="<div class='simple-swatch square' style='background-color: "+c+"; border-color: "+c+";'></div>",s.push(u)}}s.forEach(function(t){return t.parent=e}),e.children.addItems(s),e.children.getLength()>0&&(e.templateType="group")},e}();t.HeatMapLayerLegendProvider=o})},"Mapping/modules/Legend/Providers/ClusterLayer/ClusterLayerLegendProvider":function(){define(["require","exports","geocortex/infrastructure/ClusterLayer","geocortex/infrastructure/legend/LegendItemProviderResponse","geocortex/infrastructure/legend/LegendItem","./../FeatureLayer/FeatureLayerLegendProvider"],function(e,t,r,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t,r){this.app=e,this.libraryId=t,this.useThrottledCollections=!!r}return e.prototype.supportsOffline=function(){return!0},e.prototype.provide=function(e){if(!(e instanceof r.ClusterLayer))return new n.LegendItemProviderResponse(n.LegendItemProviderResponseCode.NotFound,null);for(var t,o=this.app.site,s=0;s<o.essentialsMap.mapServices.length;s++){var a=o.essentialsMap.mapServices[s];if(a.serviceLayer===e.featureLayer){t=a;break}}var l=new i.LegendItem(e,this.useThrottledCollections);l.label.set(t.displayName);for(s=0;s<t.layers.length;s++)t.layers[s].includeInLayerList&&this.populateItemForLayer(l,e,null);return l&&l.children&&l.children.length()&&t.featureClustering.enabled?new n.LegendItemProviderResponse(n.LegendItemProviderResponseCode.Show,l):t.featureClustering.enabled?void 0:new n.LegendItemProviderResponse(n.LegendItemProviderResponseCode.Hide,l)},e.prototype.populateItemForLayer=function(e,t,r){var n=new Array;if(e.essLayer=t.gcxLayer,t&&t.renderer&&t.gcxLayer.includeInLegend){new o.FeatureLayerLegendProvider(this.app,this.libraryId,!0).populateItemForLayer(e,t.gcxLayer,t.singleFeatureLayer,t.gcxLayer.mapService.serviceUrl);for(var s=t.renderer.infos,a=0;a<s.length;a++){var l=s[a].symbol,d=String.escapeHtml(l.color.toHex()),p=String.escapeHtml(""+l.size),g=l.color.toRgb(),c=new i.LegendItem(t.featureLayer,this.useThrottledCollections);c.isCluster=!0,c.essLayer=t.gcxLayer,c.isVisible.sync(t.rendererInformation[a].isVisible),c.label.sync(t.rendererInformation[a].rangeString),c.swatchElement="<div class='simple-swatch circle' style='background-color: "+d+"; width: "+p+"px; height: "+p+"px; border-radius: 50%; background-clip: padding-box; border: 4px solid rgba("+g[0]+", "+g[1]+", "+g[2]+", 0.25);'></div>",n.push(c)}}n.forEach(function(t){return t.parent=e}),e.children.addItems(n),e.children.getLength()>0&&(e.templateType="group")},e}();t.ClusterLayerLegendProvider=s})},"Mapping/modules/Legend/Providers/KML/KMLLayerLegendProvider":function(){define(["require","exports","./../FeatureLayer/FeatureLayerLegendProvider","geocortex/infrastructure/legend/LegendItemProviderResponse","geocortex/infrastructure/legend/LegendItem"],function(e,t,r,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t,n){this.app=e,this.libraryId=t,this._featureLayerProvider=new r.FeatureLayerLegendProvider(this.app,this.libraryId),this.useThrottledCollections=!!n}return e.prototype.supportsOffline=function(){return!0},e.prototype.provide=function(e){if(!(e instanceof esri.layers.KMLLayer))return new n.LegendItemProviderResponse(n.LegendItemProviderResponseCode.NotFound,null);for(var t,r=this.app.site,o=0;o<r.essentialsMap.mapServices.length;o++){var s=r.essentialsMap.mapServices[o];s.serviceLayer===e&&(t=s)}var a=new i.LegendItem(e,this.useThrottledCollections);t?a.label.set(t.displayName):a.label.set(this.app.getResource(this.libraryId,"language-legend-kml-default-title"));for(var l=t.serviceLayer.getLayers(),o=0;o<l.length;o++)l[o]instanceof esri.layers.FeatureLayer&&this._featureLayerProvider.populateItemForLayer(a,null,l[o],null);return a&&a.children&&a.children.length()?new n.LegendItemProviderResponse(n.LegendItemProviderResponseCode.Show,a):new n.LegendItemProviderResponse(n.LegendItemProviderResponseCode.Hide,a)},e}();t.KMLLayerLegendProvider=o})},"Mapping/modules/Legend/Providers/WFS/WFSLayerLegendProvider":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();define(["require","exports","./../FeatureLayer/FeatureLayerLegendProvider","geocortex/infrastructure/legend/LegendItemProviderResponse","geocortex/infrastructure/legend/LegendItem"],function(t,r,n,i,o){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return e(r,t),r.prototype.supportsOffline=function(){return!1},r.prototype.provide=function(e){if("esri.layers.WFSLayer"!==(null!=e.declaredClass?e.declaredClass:null))return new i.LegendItemProviderResponse(i.LegendItemProviderResponseCode.NotFound,null);for(var t=new o.LegendItem(e,this.useThrottledCollections),r=null,n=this.app.site.essentialsMap.mapServices,s=0;s<n.length;s++){var a=n[s];if(a.serviceLayer===e){r=a;break}}if(r){t.label.set(r.displayName);var l=r.layers[0];l&&l.includeInLegend&&this.populateItemForLayer(t,l,e,null)}return t&&t.children&&t.children.length()?new i.LegendItemProviderResponse(i.LegendItemProviderResponseCode.Show,t):new i.LegendItemProviderResponse(i.LegendItemProviderResponseCode.Hide,t)},r.prototype.populateItemForLayer=function(e,r,n,i){if(t.prototype.populateItemForLayer.call(this,e,r,n,i),!!!(e&&e.children&&e.children.length())){var o=null;switch(r.featureType){case"Point":o=n._pointSymbol;break;case"Line":o=n._lineSymbol;break;case"Polygon":o=n._polygonSymbol}if(o){var s=this._buildLegendItemFromSymbol(r,n,o);s&&(e.children.addItem(s),e.templateType="group")}}},r.prototype._buildLegendItemFromSymbol=function(e,t,r){var n=new esri.renderer.SimpleRenderer(r);return this._buildLegendItemFromSimpleRenderer(e,t,n)},r}(n.FeatureLayerLegendProvider);r.WFSLayerLegendProvider=s})},"Mapping/modules/Legend/Providers/WMS/WMSLayerLegendProvider":function(){define(["require","exports","geocortex/infrastructure/legend/LegendItemProviderResponse","geocortex/infrastructure/legend/LegendItem"],function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,r){this.app=e,this.libraryId=t,this.useThrottledCollections=!!r}return e.prototype.supportsOffline=function(){return!1},e.prototype.provide=function(e){if("esri.layers.WMSLayer"!==(null!=e.declaredClass?e.declaredClass:null))return new r.LegendItemProviderResponse(r.LegendItemProviderResponseCode.NotFound,null);for(var t=new n.LegendItem(e,this.useThrottledCollections),i=this.app.site,o="",s=null,a=0;a<i.essentialsMap.mapServices.length;++a){var l=i.essentialsMap.mapServices[a];if(l.serviceLayer===e){s=l;break}}if(!s)return new r.LegendItemProviderResponse(r.LegendItemProviderResponseCode.NotFound,null);o=s.displayName;for(var d=[],a=0;a<s.layers.length;++a){var p=s.layers[a];if(p.includeInLegend&&p.legendUrl){var g=p.legendUrl;s.proxyUrl&&(g=s.proxyUrl+"?"+encodeURIComponent(g));var c=String.escapeHtml(g),u=this.app.getResource(this.libraryId,"language-legend-icon-alt-text").format(p.displayName),h=new n.LegendItem(e,this.useThrottledCollections);h.essLayer=p,h.swatchElement="<img src='"+c+"' alt='"+u+"' class='wms-legend-swatch'/>";var m=new n.LegendItem(e,this.useThrottledCollections);m.label.set(p.displayName),m.templateType="group",h.parent=m,m.children.addItem(h),d.push(m)}}return d.length>0?(d.forEach(function(e){return e.parent=t}),t.children.addItems(d),t.label.set(o),t.children.getLength()>0&&(t.templateType="group"),new r.LegendItemProviderResponse(r.LegendItemProviderResponseCode.Show,t)):new r.LegendItemProviderResponse(r.LegendItemProviderResponseCode.Hide,t)},e}();t.WMSLayerLegendProvider=i})},"url:/Mapping/modules/Legend/LegendView.html":t,"url:/Mapping/modules/Legend/Templates/LegendItem.html":r,"url:/Mapping/modules/Legend/Templates/LegendItemGroup.html":n,"url:/Mapping/modules/Legend/Templates/LegendItemNode.html":i}}),require(["geocortex/framework/resourceManager"],function(e){e.resourceManager.register("Mapping","inv","Mapping/modules/Legend/CSS/common.css","css","LyogU1RBUlQ6IExlZ2VuZCAtLS0tLS0tLS0tLS0tLS0gKi8NCi5sYXllciAubGVnZW5kLWxpc3Qgew0KICAgIG1hcmdpbi1sZWZ0OiAyZW07DQp9DQoubGVnZW5kIHVsIHsNCiAgICBsaXN0LXN0eWxlLXR5cGU6IG5vbmU7DQogICAgbWFyZ2luOiAwOw0KICAgIHBhZGRpbmc6IDA7DQp9DQoNCi5sZWdlbmQgdWwgbGkgdWwgbGkgew0KICAgIG1hcmdpbi1sZWZ0OiAyZW07DQp9DQoNCi5sZWdlbmQtc3dhdGNoIHsNCiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7DQogICAgbWFyZ2luLXJpZ2h0OiAwLjVlbTsNCiAgICBtaW4td2lkdGg6IDNlbTsNCiAgICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOw0KfQ0KDQoubGVnZW5kLXN3YXRjaCBpbWcgew0KICAgIGRpc3BsYXk6IGJsb2NrOw0KICAgIG1hcmdpbjogMCBhdXRvOw0KICAgIHdpZHRoOiBhdXRvOw0KICAgIGhlaWdodDogYXV0bzsNCn0NCg0KLmxlZ2VuZC1zd2F0Y2ggaW1nLndtcy1sZWdlbmQtc3dhdGNoIHsNCiAgICB3aWR0aDogYXV0bzsNCiAgICBoZWlnaHQ6IGF1dG87DQp9DQoNCi5sZWdlbmQtaXRlbS1wYXJlbnQgLmxlZ2VuZC1pdGVtLWxhYmVsLA0KLmxlZ2VuZC1pdGVtLmxlYWYgew0KICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjRUVFRUVFOw0KICAgIHBhZGRpbmc6IDAuMjVlbSAwOw0KfQ0KLmxheWVyIC5sZWdlbmQtaXRlbS1wYXJlbnQgLmxlZ2VuZC1pdGVtLWxhYmVsLA0KLmxheWVyIC5sZWdlbmQtaXRlbS5sZWFmIHsNCiAgICBib3JkZXItYm90dG9tOiBub25lOw0KfQ0KDQoubGVnZW5kLWl0ZW0ubGVhZiwNCi5sZWdlbmQtaXRlbS1wYXJlbnQgLnRyZWUtZXhwYW5kZXIgew0KICAgIG1hcmdpbjogMC4yNWVtIDA7DQp9DQoubGVnZW5kIC5sZWdlbmQtaXRlbS5sZWFmOmxhc3QtY2hpbGQgew0KICAgIG1hcmdpbi1ib3R0b206IDAuMjVlbTsNCiAgICBwYWRkaW5nLWJvdHRvbTogMC4yNWVtOw0KfQ0KLmxheWVyLWxpc3QubGVnZW5kIC50cmVlLWV4cGFuZGVyIHsNCiAgICBwb3NpdGlvbjogcmVsYXRpdmUgIWltcG9ydGFudDsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBib3JkZXI6IDA7DQp9DQoubGVnZW5kLWl0ZW0tcGFyZW50IHsNCiAgICBwb3NpdGlvbjogcmVsYXRpdmU7DQp9DQoubGVnZW5kLWl0ZW0tbGFiZWwgew0KICAgIHBhZGRpbmc6IDAuMjVlbSAwOw0KICAgIGRpc3BsYXk6IGJsb2NrOw0KICAgIHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7DQogICAgd29yZC13cmFwOiBicmVhay13b3JkOw0KICAgIHdpZHRoOiAxMDAlOw0KICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7DQp9DQoubGVnZW5kLWl0ZW0tcGFyZW50IC5sZWdlbmQtaXRlbS1sYWJlbCB7DQogICAgcGFkZGluZzogMC42NWVtIDAgMC42NWVtIDAuNjVlbTsNCiAgICBmb250LXdlaWdodDogNjAwOw0KfQ0KLmxlZ2VuZC1saXN0IC50ZW1wbC1pdGVtIC5sZWdlbmQtaXRlbS5sZWFmIHsNCiAgICBwYWRkaW5nOiAwLjI1ZW0gMDsNCn0NCi5sZWdlbmQtaXRlbS5sZWFmLmNsZWFyOmFmdGVyLA0KLmxlZ2VuZC1pdGVtLXBhcmVudDphZnRlciB7DQogICAgY29udGVudDogIiI7DQogICAgZGlzcGxheTogYmxvY2s7DQogICAgY2xlYXI6IGJvdGg7DQogICAgd2lkdGg6IDA7DQogICAgaGVpZ2h0OiAwOw0KICAgIHZpc2liaWxpdHk6IGhpZGRlbjsNCn0NCi5sZWdlbmQtaXRlbS5sZWFmIC5sZWdlbmQtaXRlbS1sYWJlbCB7DQogICAgZGlzcGxheTogaW5saW5lOw0KfQ0KLmxlZ2VuZC1pdGVtLmNoaWxkcmVuIC50ZW1wbC1ncm91cCB7DQogICAgbWFyZ2luLWxlZnQ6IC0xZW07DQp9DQouc2ltcGxlLXN3YXRjaCB7DQogICAgZGlzcGxheTogaW5saW5lLWJsb2NrOw0KICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsNCiAgICBtYXJnaW4tYm90dG9tOiAtMC4zNWVtOw0KfQ0KLmxheWVyLWxpc3QtbGVnZW5kLWljb24gLnNpbXBsZS1zd2F0Y2ggew0KICAgIHRvcDogMC4zNWVtOw0KICAgIG1hcmdpbi1sZWZ0OiAwLjVlbTsNCn0NCi5sZWdlbmQtaXRlbSAubGVnZW5kLXN3YXRjaCAuc2ltcGxlLXN3YXRjaCB7DQogICAgZGlzcGxheTogYmxvY2s7DQogICAgbWFyZ2luLWxlZnQ6IGF1dG87DQogICAgbWFyZ2luLXJpZ2h0OiBhdXRvOw0KfQ0KLnNpbXBsZS1zd2F0Y2guc3F1YXJlLA0KLnNxdWFyZSB7DQogICAgd2lkdGg6IDIwcHg7DQogICAgaGVpZ2h0OiAyMHB4Ow0KICAgIGJvcmRlci1zdHlsZTogc29saWQ7DQogICAgYm9yZGVyLXdpZHRoOiAycHg7DQp9DQouc2ltcGxlLXN3YXRjaC5saW5lLA0KLmxpbmUgew0KICAgIHdpZHRoOiAyNHB4Ow0KICAgIGhlaWdodDogMHB4Ow0KICAgIHRvcDogLTVweDsNCiAgICBib3JkZXItc3R5bGU6IHNvbGlkOw0KICAgIGJvcmRlci13aWR0aDogMnB4Ow0KfQ0KLmxheWVyLWxpc3QtZm9vdGVyIGJ1dHRvbiB7DQogICAgcGFkZGluZzogLjVlbTsNCiAgICBvdXRsaW5lOiBub25lOw0KICAgIGJhY2tncm91bmQ6ICNGNUY1RjU7DQogICAgYm9yZGVyOiAxcHggc29saWQgI0NDQ0NDQzsNCiAgICBib3JkZXItcmFkaXVzOiAwLjI1cmVtOw0KICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQogICAgY29sb3I6ICMxQTcyQzQ7DQogICAgYm94LXNoYWRvdzogMXB4IDFweCAxcHggI0ZGRkZGRiBpbnNldDsNCiAgICAtbW96LWJveC1zaGFkb3c6IDFweCAxcHggMXB4ICNGRkZGRkYgaW5zZXQ7DQogICAgLXdlYmtpdC1ib3gtc2hhZG93OiAxcHggMXB4IDFweCAjRkZGRkZGIGluc2V0Ow0KfQ0KLyogRU5EOiBMZWdlbmQgLS0tLS0tLS0tLS0tLS0tICov"),e.resourceManager.register("Mapping","inv","Mapping/modules/Legend/LegendView.html","html",t),e.resourceManager.register("Mapping","inv","Mapping/modules/Legend/Templates/LegendItem.html","html",r),e.resourceManager.register("Mapping","inv","Mapping/modules/Legend/Templates/LegendItemGroup.html","html",n),e.resourceManager.register("Mapping","inv","Mapping/modules/Legend/Templates/LegendItemNode.html","html",i)}),require({cache:{}}),define(["Mapping/modules/Legend/LegendModule","Mapping/modules/Legend/LegendView","Mapping/modules/Legend/LegendViewModel","Mapping/modules/Legend/Providers/ArcGISCommonLegendProviderClasses/ArcGISMapServiceLegendProvider","Mapping/modules/Legend/Providers/ArcGISTiledMapService/ArcGISTiledMapServiceLegendProvider","Mapping/modules/Legend/Providers/ArcGISDynamicMapService/ArcGISDynamicMapServiceLegendProvider","Mapping/modules/Legend/Providers/FeatureLayer/FeatureLayerLegendProvider","Mapping/modules/Legend/Providers/ClusterLayer/ClusterLayerLegendProvider","Mapping/modules/Legend/Providers/HeatMaps/HeatMapLayerLegendProvider","Mapping/modules/Legend/Providers/KML/KMLLayerLegendProvider","Mapping/modules/Legend/Providers/WMS/WMSLayerLegendProvider"],function(t,r,n,i,o,s,a,l,d,p,g){e(t,"geocortex.essentialsHtmlViewer.mapping.modules.legend.LegendItemViewModel",t.LegendItemViewModel),e(t,"geocortex.essentialsHtmlViewer.mapping.modules.legend.LegendModule",t.LegendModule),e(r,"geocortex.essentialsHtmlViewer.mapping.modules.legend.LegendView",r.LegendView),e(n,"geocortex.essentialsHtmlViewer.mapping.modules.legend.LegendViewModel",n.LegendViewModel),e(i,"geocortex.essentialsHtmlViewer.mapping.modules.legend.providers.ArcGISMapServiceLegendProvider",i.ArcGISMapServiceLegendProvider),e(o,"geocortex.essentialsHtmlViewer.mapping.modules.legend.providers.ArcGISTiledMapServiceLegendProvider",o.ArcGISTiledMapServiceLegendProvider),e(s,"geocortex.essentialsHtmlViewer.mapping.modules.legend.providers.ArcGISDynamicMapServiceLegendProvider",s.ArcGISDynamicMapServiceLegendProvider),e(a,"geocortex.essentialsHtmlViewer.mapping.modules.legend.providers.FeatureLayerLegendProvider",a.FeatureLayerLegendProvider),e(l,"geocortex.essentialsHtmlViewer.mapping.modules.legend.providers.ClusterLayerLegendProvider",l.ClusterLayerLegendProvider),e(d,"geocortex.essentialsHtmlViewer.mapping.modules.legend.providers.HeatMapLayerLegendProvider",d.HeatMapLayerLegendProvider),e(p,"geocortex.essentialsHtmlViewer.mapping.modules.legend.providers.KMLLayerLegendProvider",p.KMLLayerLegendProvider),e(g,"geocortex.essentialsHtmlViewer.mapping.modules.legend.providers.WMSLayerLegendProvider",g.WMSLayerLegendProvider)})}();