/*
	
	Copyright (c) 2016, Latitude Geographics Group Ltd.
	All rights reserved.
	       
	Redistribution is not permitted. 
	
	Use in binary form, without modification, is permitted provided that neither 
	the name of the organization nor the names of its contributors may be used 
	to endorse or promote products derived from this software without specific 
	prior written permission.
	       
	THIS SOFTWARE IS PROVIDED BY COPYRIGHT HOLDER ''AS IS'' AND ANY
	EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
	WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
	DISCLAIMED. IN NO EVENT SHALL LATITUDE GEOGRAPHICS GROUP LTD. BE LIABLE FOR ANY
	DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
	(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
	LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
	ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
	(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
	SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/

var geocortex;
(function(b){(function(e){(function(e){var b=function(){function d(a,c,f,g){this.app=a;this.name=c;this.event=g;this.commands=f||[];this._wireUpEvent()}d.prototype.run=function(a){this._executeCommands(a)};d.prototype._wireUpEvent=function(){var a=this;this.event&&(this.eventToken=this.app.event(this.event).subscribe(this,function(c){a._executeCommands(c)}))};d.prototype._executeCommands=function(a){for(var c=0;this.commands&&c<this.commands.length;c++)this.app.command(this.commands[c]).execute(a)};d.prototype.destroy=
function(){this.event&&this.app.event(this.event).unsubscribe(this.eventToken);this.commands=null};return d}();e.Behavior=b})(e.behaviors||(e.behaviors={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(e){(function(b){var k=function(){function d(a){this.behaviors={};this.dummyBehavior=new b.Behavior(null,null,null);this.app=a}d.prototype.loadBehaviorsFromConfig=function(a,c){var f=[];if(!(a instanceof e.application.ModuleBase))return this.app.trace.warning("Attempted to add behaviors to registry outside of ModuleBase. Behaviors from "+a.id+" not added."),f;if(c&&c.behaviors)for(var g=0;g<c.behaviors.length;g++){var h=c.behaviors[g];f.push(h.name);this.addBehavior(h.name,h.commands,
h.event)}return f};d.prototype.addBehavior=function(a,c,f){c?(this.behaviors[a]&&this.app.trace.warning("Behavior "+a+" is already present in registry."),a||this.app.trace.warning("Attempted to add a nameless Behavior to the registry."),c=new b.Behavior(this.app,a,c,f),this.behaviors[a]=c):this.app.trace.debug("Behavior "+a+" does not possess an array of command IDs. Not added to registry.")};d.prototype.remove=function(a){if(!this.behaviors[a])return this.app.trace.debug("Attempted to remove behavior not in found in registry."),
!1;var c=this.behaviors[a];delete this.behaviors[a];c.destroy();return!0};d.prototype.behavior=function(a){var c=null;void 0!==this.behaviors[a]?c=this.behaviors[a]:(c=this.dummyBehavior,this.app.trace.debug("Could not find Behavior named "+a+" in the Behavior Registry."));return c};return d}();b.BehaviorRegistry=k})(e.behaviors||(e.behaviors={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(e){var b=function(){function e(d,a){this.dojoConnects=[];this.observableBindings=[];this.eventSubscriptions=[];this.commandHandlers=[];this.app=d;this.libraryId=a}e.prototype.auto=function(d,a,c){if(3===arguments.length&&"string"===typeof a)this.dojoConnects.push(dojo.connect(d,a,c));else if(2===arguments.length&&a instanceof Function){var f=d.bind(d,a);this.observableBindings.push({obj:d,token:f})}else 3===arguments.length&&c instanceof Function&&(f=d.bind(a,c),this.observableBindings.push({obj:d,
token:f}))};e.prototype.trackSubscription=function(d,a){this.eventSubscriptions.push({event:d,token:a})};e.prototype.trackCommandHandler=function(d,a){this.commandHandlers.push({command:d,token:a})};e.prototype.onDestroy=function(){};e.prototype.destroy=function(){for(var d=0;d<this.dojoConnects.length;++d)dojo.disconnect(this.dojoConnects[d]);this.dojoConnects=[];for(d=0;d<this.observableBindings.length;++d){var a=this.observableBindings[d].token;this.observableBindings[d].obj.unbind(a)}this.observableBindings=
[];for(d=0;d<this.eventSubscriptions.length;++d){var c=this.eventSubscriptions[d].event,a=this.eventSubscriptions[d].token;c.unsubscribe(a)}this.eventSubscriptions=[];for(d=0;d<this.commandHandlers.length;++d)c=this.commandHandlers[d].command,a=this.commandHandlers[d].token,c.unregister(a);this.commandHandlers=[];this.onDestroy()};e.prototype.getResource=function(d,a){return this.app.getResource(this.libraryId,d,a)};return e}();e.FrameworkObject=b})(b.framework||(b.framework={}))})(geocortex||(geocortex=
{}));(function(b){(function(e){(function(e){var b=function(){return function(){this.sender=null;this.type="append";this.rangeEnd=this.rangeStart=0}}();e.CollectionChangedArgs=b})(e.events||(e.events={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
if(!String.prototype.format){var dateFormats="d{1,4}|f{1,7}|F{1,7}|g{1,2}|h{1,2}|H{1,2}|K|m{1,2}|M{1,4}|s{1,2}|t{1,2}|y{1,5}|z{1,3}|:|\\/",uberDateRegexPattern="("+dateFormats+"|[^"+dateFormats+"])",uberDateRegex=RegExp(uberDateRegexPattern,"g"),openBraceTempToken="\x00MAGIC\x00";String.prototype.format=function(){var b=arguments,e=this.replace(/{{/g,openBraceTempToken),e=e.replace(/{(\d+)(?::([^}]*))?}/g,function(e,k,d){e=b[k];if(!(d&&e instanceof Date))return e;d=d.match(uberDateRegex);k=[];for(var a=
0;a<d.length;a++){var c=d[a],f=geocortex.framework.utils.DateFormatters[c];f&&(c=f.call(this,e));k.push(c)}return k.join("")});return e.replace(RegExp(openBraceTempToken,"g"),"{").replace(/}}/g,"}")}}String.format=function(b){for(var e=[],l=1;l<arguments.length;l++)e[l-1]=arguments[l];return b.format.apply(b,e)};String.quickHashCode=function(b){var e=0,l,k;if(0==b.length)return e;for(l=0;l<b.length;l++)k=b.charCodeAt(l),e=(e<<5)-e+k,e&=e;return e};
String.escapeHtml=function(b){return null===b||void 0===b?b:b.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};String.unescapeHtml=function(b){return null===b||void 0===b?b:b.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&#x2F;/g,"/")};
String.escapeHtmlEncode=function(b){var e=document.createElement("div");e.appendChild(document.createTextNode(b));return e.innerHTML};String.isNullOrEmpty=function(b){return"undefined"===typeof b||null===b||0===b.length};String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};String.prototype.ltrim=function(){return this.replace(/^\s+/,"")};String.prototype.rtrim=function(){return this.replace(/\s+$/,"")};String.prototype.startsWith=function(b,e){e=e||0;return this.indexOf(b,e)===e};
String.prototype.endsWith=function(b,e){e=e||this.length;e-=b.length;var l=this.lastIndexOf(b);return-1!==l&&l===e};
(function(b){(function(e){(function(e){function b(a){return"undefined"===typeof a?!1:!0}function d(a){return null===a||!b(a)}e.base64keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e.isDefined=b;e.isNullOrUndefined=d;e.makeUrlAbsolute=function(a){if(0===a.indexOf("http"))return a;var c="{0}//{1}{2}".format(window.location.protocol,window.location.host,window.location.pathname);if("/"!=c.charAt(c.length-1)||"\\"!=c.charAt(c.length-1))c=c.split("/"),--c.length,c=c.join("/"),
c+="/";return a="/"===a.charAt(0)||"\\"===a.charAt(0)?window.location.protocol+"//"+window.location.host+"/"+a.substring(1):c+a};e.alphaNumericToken=function(a){a=a||8;for(var c="",f=0;f<a;f++)var g=Math.floor(61*Math.random()),c=c+"0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".substring(g,g+1);return c};e.base64Encode=function(a){var c="",f,g,h,d,e,b,l=0;for(a=this.utf8Encode(a);l<a.length;)f=a.charCodeAt(l++),g=a.charCodeAt(l++),h=a.charCodeAt(l++),d=f>>2,f=(f&3)<<4|g>>4,e=(g&15)<<
2|h>>6,b=h&63,isNaN(g)?e=b=64:isNaN(h)&&(b=64),c=c+this.base64keyStr.charAt(d)+this.base64keyStr.charAt(f)+this.base64keyStr.charAt(e)+this.base64keyStr.charAt(b);return c};e.base64Decode=function(a){var c="";if(!a||""===a)return c;var f,g,h,d,e,b=0;if(/[^A-Za-z0-9\+\/\=]/g.exec(a))throw Error("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding.");a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");do f=this.base64keyStr.indexOf(a.charAt(b++)),
g=this.base64keyStr.indexOf(a.charAt(b++)),d=this.base64keyStr.indexOf(a.charAt(b++)),e=this.base64keyStr.indexOf(a.charAt(b++)),f=f<<2|g>>4,g=(g&15)<<4|d>>2,h=(d&3)<<6|e,c+=String.fromCharCode(f),64!=d&&(c+=String.fromCharCode(g)),64!=e&&(c+=String.fromCharCode(h));while(b<a.length);return c=this.utf8Decode(c)};e.utf8Encode=function(a){a=a.replace(/\r\n/g,"\n");for(var c="",f=0;f<a.length;f++){var g=a.charCodeAt(f);128>g?c+=String.fromCharCode(g):(127<g&&2048>g?c+=String.fromCharCode(g>>6|192):(c+=
String.fromCharCode(g>>12|224),c+=String.fromCharCode(g>>6&63|128)),c+=String.fromCharCode(g&63|128))}return c};e.utf8Decode=function(a){for(var c="",f=0,g=0,h=0,d=0;f<a.length;)g=a.charCodeAt(f),128>g?(c+=String.fromCharCode(g),f++):191<g&&224>g?(h=a.charCodeAt(f+1),c+=String.fromCharCode((g&31)<<6|h&63),f+=2):(h=a.charCodeAt(f+1),d=a.charCodeAt(f+2),c+=String.fromCharCode((g&15)<<12|(h&63)<<6|d&63),f+=3);return c};e.isUrl=function(a){if(!a||"string"!==typeof a)return!1;a=a.trim().toLowerCase();
return 7<=a.length&&0===a.indexOf("http://")||8<=a.length&&0===a.indexOf("https://")?!0:!1};e.isPercentage=function(a){return d(a)?!1:/^(\d+|\d*[.]\d+)%$/.test(a)};e.clamp=function(a,c,f){return a<c?c:a>f?f:a};e.addEventListener=function(a,c,f){a.addEventListener?a.addEventListener(c,f,!1):a.attachEvent&&a.attachEvent("on"+c,f)}})(e.utils||(e.utils={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(e){(function(e){var k=function(){return function(a,c){this.handler=a;this.scope=c;this.once=!1}}(),d=function(){function a(c,f){this.app=null;this.isPublishing=!1;this.subscriptions={};this.name=c;this.app=f}a.prototype.getSubscriptionHandlerByToken=function(c){return this.subscriptions.hasOwnProperty(c)?this.subscriptions[c].handler:null};a.prototype.subscribe=function(c,f){if(null===f||void 0===f)throw Error("Event handler cannot be null or undefined");var a;do a=b.framework.utils.alphaNumericToken();
while(this.getSubscriptionHandlerByToken[a]);var h=new k(f,c);this.subscriptions[a]=h;c&&c instanceof b.framework.FrameworkObject&&c.trackSubscription(this,a);return a};a.prototype.once=function(c,f){var a=this.subscribe(c,f);this.subscriptions[a].once=!0;return a};a.prototype.unsubscribe=function(c){if(!this.subscriptions.hasOwnProperty(c))return!1;delete this.subscriptions[c];return!0};a.prototype.clear=function(){this.subscriptions={}};a.prototype.publish=function(){for(var c=0;c<arguments.length;c++);
this.app&&this.app.debugMode&&(c="Event '{0}' published.".format(this.name),console.debug?console.debug(c):console.log(c));this.isPublishing=!0;for(var f in this.subscriptions)this.subscriptions.hasOwnProperty(f)&&(c=this.subscriptions[f],c.handler.apply(c.scope,arguments),c.once&&delete this.subscriptions[f]);this.isPublishing=!1};return a}();e.Event=d})(e.events||(e.events={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
var Observable=function(){function b(e){this.bindingEvent=new geocortex.framework.events.Event("__anonymous");this._syncSource=this._syncToken=null;this.value=e}b.prototype.set=function(e){this.value=e;this.bindingEvent.publish(e)};b.prototype.get=function(){return this.value};b.prototype.equals=function(e){var b=e;e&&e.get&&"function"===typeof e.get&&(b=e.get());if(this.value instanceof Array&&b instanceof Array){if(this.value.length!==b.length)return!1;for(e=0;e<this.value.length;e++)if(this.value[e]!==
b[e])return!1;return!0}return this.get()===b};b.makeBindableProxy=function(e){if(!e)return null;var l=[];if(e.___clonedObject)return e.___clonedObject;var k=function(){throw Error("Can't make method calls on a bindable proxy.");},d=function(c,f,a){for(var h=0;h<l.length;++h)if(f===l[h])return l[h];l.push(f);if(f&&"string"!==typeof f&&"number"!==typeof f&&"boolean"!==typeof f){if(f instanceof Array){for(var e=new ObservableCollection,h=0;h<f.length;++h){var B={},B=d(h,f[h],f);e.addItem(B)}return e}if(f instanceof
Object){if(f.isObservable)return f;B={};for(e in f)f.hasOwnProperty(e)&&(B[e]=d(e,f[e],f));return B}return f instanceof Function?k:f}var p=new b(f);(function(){p.set=function(f){a[c]=f;p.value=f;p.bindingEvent.publish(f)};p.get=function(){return a[c]}})();return p},a=d("root",{root:e},e);e.___clonedObject=a.root;return e instanceof Array?a.root:new b(a.root)};b.prototype.bind=function(e,b){return this.bindingEvent.subscribe(e,b)};b.prototype.unbind=function(e){return this.bindingEvent.unsubscribe(e)};
b.prototype.once=function(e,b){var k=this,d=this.bind(e,function(){k.unbind(d);b.apply(e,arguments)});return d};b.prototype.sync=function(e){this.removeSync();e&&(this.set(e.get()),this._syncSource=e,this._syncToken=e.bindingEvent.subscribe(this,function(e){this.set(e)}))};b.prototype.removeSync=function(){this._syncToken&&this._syncSource&&(this._syncSource.unbind(this._syncToken),this._syncSource=this._syncToken=null)};b.prototype.syncTransform=function(e,b){this._syncToken&&this._syncSource&&(this._syncSource.unbind(this._syncToken),
this._syncSource=this._syncToken=null);e&&(this.set(b(e.get())),this._syncSource=e,this._syncToken=e.bindingEvent.subscribe(this,function(e){this.set(b(e))}))};b.prototype.pulse=function(){this.set(this.get())};return b}();Observable.prototype.isObservable=!0;
var ObservableCollection=function(){function b(e){this.bindingEvent=new geocortex.framework.events.Event("__anonymous");this.useThrottling=!1;this._syncSource=this.throttledOperations=null;this.value=e||[]}b.prototype.isEmpty=function(){return 0===this.value.length};b.prototype.length=function(){return this.value.length};b.prototype.contains=function(e){return Array.contains(this.value,e)};b.prototype.getAt=function(e){return this.value[e]};b.prototype.getRange=function(e,b){return void 0===b?this.value.slice(e):
this.value.slice(e,b+1)};b.prototype.indexOf=function(e){return this.value.indexOf(e)};b.prototype.get=function(){return this.value};b.prototype.getItems=function(){return this.value};b.prototype.getLength=function(){return this.value.length};b.prototype.addItems=function(e){if(e&&!(1>e.length)){var b=new geocortex.framework.events.CollectionChangedArgs;b.type="append";b.rangeStart=this.value.length;this.value=this.value.concat(e);b.rangeEnd=b.rangeStart+e.length-1;b.sender=this;this.bindingEvent.publish(b)}};
b.prototype.addItem=function(e){var b=new geocortex.framework.events.CollectionChangedArgs;b.type="append";b.rangeStart=this.value.length;b.rangeEnd=this.value.length;this.value.push(e);b.sender=this;this.bindingEvent.publish(b)};b.prototype.insertItems=function(e,b){if(0!=b.length)if(e>=this.value.length)this.addItems(b);else{var k=new geocortex.framework.events.CollectionChangedArgs;k.type="insert";k.rangeStart=e;k.rangeEnd=e+b.length-1;k.sender=this;for(var d=0;d<b.length;++d)this.value.splice(e+
d,0,b[d]);this.bindingEvent.publish(k)}};b.prototype.insertItem=function(e,b){if(e>=this.value.length)this.addItem(b);else{var k=new geocortex.framework.events.CollectionChangedArgs;k.type="insert";k.rangeStart=e;k.rangeEnd=e;k.sender=this;this.value.splice(e,0,b);this.bindingEvent.publish(k)}};b.prototype.removeItem=function(e){for(var b;-1<(b=Array.pos(this.value,e));){var k=new geocortex.framework.events.CollectionChangedArgs;k.type="remove";k.rangeStart=b;k.rangeEnd=b;k.sender=this;this.bindingEvent.publish(k);
Array.remove(this.value,b,b)}};b.prototype.removeAt=function(e){if(0<=e&&e<this.getLength()){var b=new geocortex.framework.events.CollectionChangedArgs;b.type="remove";b.rangeStart=e;b.rangeEnd=e;b.sender=this;this.bindingEvent.publish(b);Array.remove(this.value,e,e)}};b.prototype.removeRange=function(e,b){b||0===b||(b=this.value.length);var k=new geocortex.framework.events.CollectionChangedArgs;k.type="remove";k.rangeStart=e;k.rangeEnd=Math.min(b,this.value.length);k.sender=this;this.bindingEvent.publish(k);
Array.remove(this.value,e,b)};b.prototype.removeWhere=function(e){if(e)for(var b=this.value.length-1;0<=b;b--)if(e(this.value[b])){var k=new geocortex.framework.events.CollectionChangedArgs;k.type="remove";k.rangeStart=b;k.rangeEnd=b;k.sender=this;this.bindingEvent.publish(k);Array.remove(this.value,b,b)}};b.prototype.clear=function(){if(this.value&&0!=this.value.length){var e=new geocortex.framework.events.CollectionChangedArgs;e.type="clear";e.rangeStart=0;e.rangeEnd=this.value.length-1;e.sender=
this;this.bindingEvent.publish(e);this.value.length=0}};b.prototype.set=function(e){this.clear();e&&this.addItems(e)};b.prototype.pulse=function(){var e=new geocortex.framework.events.CollectionChangedArgs;e.type="clear";e.rangeStart=0;e.rangeEnd=this.value.length-1;e.sender=this;this.bindingEvent.publish(e);e=new geocortex.framework.events.CollectionChangedArgs;e.type="append";e.rangeStart=0;e.rangeEnd=this.value.length-1;e.sender=this;this.bindingEvent.publish(e)};b.prototype.bind=function(e,b){return this.bindingEvent.subscribe(e,
b)};b.prototype.unbind=function(e){return this.bindingEvent.unsubscribe(e)};b.prototype.once=function(e,b){var k=this,d=k.bind(e,function(){k.unbind(d);b.apply(e,arguments)});return d};b.prototype.sync=function(e){e.value&&e.bindingEvent&&(this.clear(),this.value=e.value,e.bindingEvent.subscribe(this,function(b){this.value=e.value;var k=new geocortex.framework.events.CollectionChangedArgs;dojo.mixin(k,b);k.sender=this;this.bindingEvent.publish(k);"clear"===b.type&&(this.value=[])}))};b.prototype.equals=
function(e){var b=e;e&&e.isObservableCollection&&(b=e.get());if(!b.hasOwnProperty("length"))throw Error("Type mismatch");if(this.get().length!==b.length)return!1;for(e=0;e<this.get().length;e++)if(this.value[e]!==b[e])return!1;return!0};return b}();ObservableCollection.prototype.isObservable=!0;ObservableCollection.prototype.isObservableCollection=!0;
(function(b){(function(b){(function(b){(function(e){e.firstOrDefault=function(d,a){var c=d?d.length:0;if((null===a||"undefined"===typeof a)&&0<c)return d[0];for(var f=0;f<c;f++){var g=d[f];if(a(g,f))return g}return null};e.lastOrDefault=function(d,a){var c=d?d.length:0;if((null===a||"undefined"===typeof a)&&0<c)return d[c-1];for(c-=1;0<=c;c--){var f=d[c];if(a(f,c))return f}return null};e.orderBy=function(d,a){return d?d.slice().sort(function(c,f){var g=a(c),h=a(f);return g instanceof b.Tuple?b.Tuple.compare(g,
h):g===h?0:g>h?1:-1}):[]};e.orderByDescending=function(d,a){return d?d.slice().sort(function(c,f){var g=a(c),h=a(f);return g instanceof b.Tuple?b.Tuple.compare(h,g):h===g?0:h>g?1:-1}):[]};e.groupBy=function(d,a){var c={},f=[];if(d&&a){for(var g=0;g<d.length;g++){var h=d[g],e=a(h),b=JSON.stringify(e);c.hasOwnProperty(b)?c[b].items.push(h):c[b]={key:e,items:[h]}}for(var k in c)c.hasOwnProperty(k)&&f.push(c[k])}return f};e.distinct=function(d){return d?d.filter(function(a,c,f){return null!=a&&f.indexOf(a)===
c}):[]};e.difference=function(d,a){return d?a?d.filter(function(c){return 0>a.indexOf(c)}):d.slice(0):[]};e.remove=function(d,a,c){c=d.slice((c||a)+1||d.length);d.length=0>a?d.length+a:a;return d.push.apply(d,c)};e.removeItem=function(d,a){var c=e.pos(d,a);return-1==c?null:e.remove(d,c,c)};e.contains=function(d,a){for(var c=d.length;c--;)if(d[c]===a)return!0;return!1};e.pos=function(d,a){for(var c=d.length;c--;)if(d[c]===a)return c;return-1};e.flatten=function(d){return d?[].concat.apply([],d):d};
Array.prototype.indexOf||(Array.prototype.indexOf=function(d){if(null==this)throw new TypeError;var a=Object(this),c=a.length>>>0;if(0===c)return-1;var f=0;1<arguments.length&&(f=Number(arguments[1]),f!=f?f=0:0!=f&&Infinity!=f&&-Infinity!=f&&(f=+(0<f||-1)*Math.floor(Math.abs(f))));if(f>=c)return-1;for(f=0<=f?f:Math.max(c-Math.abs(f),0);f<c;f++)if(f in a&&a[f]===d)return f;return-1});Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(d){if(null==this)throw new TypeError;var a=Object(this),
c=a.length>>>0;if(0===c)return-1;var f=c;1<arguments.length&&(f=Number(arguments[1]),f!=f?f=0:0!=f&&f!=1/0&&f!=-(1/0)&&(f=+(0<f||-1)*Math.floor(Math.abs(f))));for(c=0<=f?Math.min(f,c-1):c-Math.abs(f);0<=c;c--)if(c in a&&a[c]===d)return c;return-1});Array.prototype.forEach||(Array.prototype.forEach=function(d,a){var c,f;if(null==this)throw new TypeError("this is null or not defined");var g=Object(this),h=g.length>>>0;if("[object Function]"!=={}.toString.call(d))throw new TypeError(d+" is not a function");
a&&(c=a);for(f=0;f<h;){var b;Object.prototype.hasOwnProperty.call(g,f)&&(b=g[f],d.call(c,b,f,g));f++}});Array.prototype.every||(Array.prototype.every=function(d,a){if(null==this)throw new TypeError;var c=Object(this),f=c.length>>>0;if("function"!=typeof d)throw new TypeError;for(var g=0;g<f;g++)if(g in c&&!d.call(a,c[g],g,c))return!1;return!0});Array.prototype.some||(Array.prototype.some=function(d,a){if(null==this)throw new TypeError;var c=Object(this),f=c.length>>>0;if("function"!=typeof d)throw new TypeError;
for(var g=0;g<f;g++)if(g in c&&d.call(a,c[g],g,c))return!0;return!1});Array.prototype.filter||(Array.prototype.filter=function(d,a){if(null==this)throw new TypeError;var c=Object(this),f=c.length>>>0;if("function"!=typeof d)throw new TypeError;for(var g=[],h=0;h<f;h++)if(h in c){var b=c[h];d.call(a,b,h,c)&&g.push(b)}return g});Array.prototype.map||(Array.prototype.map=function(d,a){var c,f,g;if(null==this)throw new TypeError(" this is null or not defined");var h=Object(this),b=h.length>>>0;if("function"!==
typeof d)throw new TypeError(d+" is not a function");a&&(c=a);f=Array(b);for(g=0;g<b;){var e;g in h&&(e=h[g],e=d.call(c,e,g,h),f[g]=e);g++}return f});Array.prototype.find||(Array.prototype.find=function(b,a){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!==typeof b)throw new TypeError("predicate must be a function");for(var c=Object(this),f=c.length>>>0,g,h=0;h<f;h++)if(g=c[h],b.call(a,g,h,c))return g});Array.prototype.findIndex||(Array.prototype.findIndex=
function(b,a){if(null===this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!==typeof b)throw new TypeError("predicate must be a function");for(var c=Object(this),f=c.length>>>0,g,h=0;h<f;h++)if(g=c[h],b.call(a,g,h,c))return h;return-1})})(b.ArrayUtils||(b.ArrayUtils={}))})(b.utils||(b.utils={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));Array.remove=geocortex.framework.utils.ArrayUtils.remove;Array.removeItem=geocortex.framework.utils.ArrayUtils.removeItem;
Array.contains=geocortex.framework.utils.ArrayUtils.contains;Array.pos=geocortex.framework.utils.ArrayUtils.pos;
(function(b){(function(b){(function(b){var e=function(){function b(a,c,f){this.period=100;this.isActive=!1;this._setTimeoutToken=null;this.period=void 0==a?0:a;this.action=c;this.cancelAction=f;var g=this;this._setTimeoutToken=setTimeout(function(){g.execute(g)},this.period)}b.prototype.cancel=function(){this._setTimeoutToken&&(clearTimeout(this._setTimeoutToken),this._setTimeoutToken=null,this.isActive=!1,this.cancelAction&&this.cancelAction())};b.prototype.execute=function(a){a.isActive=!0;var c=
a.action();null!==a._setTimeoutToken&&c?a._setTimeoutToken=setTimeout(function(){a.execute(a)},a.period):(a._setTimeoutToken=null,a.isActive=!1)};return b}();b.ThrottledOperation=e})(b.utils||(b.utils={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){var e=/^on/,d=function(){function a(){this.domElement=null;this.type="attr";this.target=this.attributeName=null;this.invert=!1;this._dojoDomEvents=[];this.targetBindings=[];this.templateKey=this.templateMode=null;this.templateSelections={};this.parentView=null;this.boundViews=[];this.viewModel=null}a.prototype.on=function(c,f){var a=this;if(c&&f){if(!this.domElement)throw Error("Cannot bind before domElement is set.");e.test(c)&&(c=c.substring(2));require(["dojo/on"],
function(h){h=h(a.domElement,c,f);a._dojoDomEvents.push(h)})}};a.prototype.destroy=function(){if(this.templateSelections)for(var c in this.templateSelections)if(this.templateSelections.hasOwnProperty(c)){var f=this.templateSelections[c];f&&f.___domParent&&dojo.place(f,f.___domParent,"last")}this.viewModel=this.parentView=this.target=this.domElement=null;for(c=0;c<this._dojoDomEvents.length;++c)this._dojoDomEvents[c].remove();for(c=this._dojoDomEvents.length=0;c<this.targetBindings.length;++c)this.targetBindings[c].event.unsubscribe(this.targetBindings[c].token);
this.targetBindings=[];for(c=0;c<this.boundViews.length;++c)this.boundViews[c].destroyBindings();this.boundViews=[]};return a}();b.BindingExpression=d})(b.ui||(b.ui={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){var e=function(){function b(){this.parent=this.domElement=null;this.children=[];this.expressions=[];this.context=null;this.contextChange=!1;this.context=this.parent=this.domElement=null}b.prototype.destroy=function(){this.context=this.parent=this.domElement=null;this.contextChange=!1;for(var a=0;a<this.expressions.length;++a)this.expressions[a].destroy();this.expressions=[];for(a=0;a<this.children.length;++a)this.children[a].destroy();this.children=[]};return b}();
b.BindingNode=e})(b.ui||(b.ui={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));var __extends=this&&this.__extends||function(b,e){function l(){this.constructor=b}for(var k in e)e.hasOwnProperty(k)&&(b[k]=e[k]);l.prototype=e.prototype;b.prototype=new l};
(function(b){(function(e){(function(l){var k=function(d){function a(c,f){d.call(this,c,f);this.isManaged=this.isActive=!1;this.isBusy=new Observable(!1);this.title=new Observable("");this.description=new Observable("");this.iconUri=new Observable("");this.viewModel=this.markupResource=null;this.typeName=this.regionName="";this.parentView=this.bindingTree=this.root=null;this.childRegions=[];this.initiallyBound=this.bound=!1;this.disposableBindings=[];this.bindingSetupDelegates=[];this.id="View-"+b.framework.utils.alphaNumericToken()}
__extends(a,d);a.prototype.addDisposableBinding=function(c,f){this.disposableBindings.push({event:c.bindingEvent,token:f})};a.prototype.attach=function(c){this.bound||(this.viewModel=c,this.root&&(this.bindingTree=this.buildTree(),null!==this.viewModel&&void 0!==this.viewModel&&this.pulseAll(),this.bound=!0,this.initiallyBound||(this.initiallyBound=!0,this.app.event("ViewInitializedEvent").publish(this))))};a.prototype.activated=function(){};a.prototype.deactivated=function(){};a.prototype.added=
function(c){!this.bound&&this.viewModel&&(this.bindingTree=this.buildTree(),this.bound=!0,this.pulseAll(),this.initiallyBound||(this.initiallyBound=!0,this.app.event("ViewInitializedEvent").publish(this)))};a.prototype.removed=function(){this.destroyBindings()};a.prototype.destroy=function(){this.destroyBindings();d.prototype.destroy.call(this)};a.prototype.destroyBindings=function(){this.isActive&&this.app.viewManager.deactivateView(this);if(this.bindingTree){this.bindingTree.destroy();for(var c=
0;c<this.disposableBindings.length;++c){var f=this.disposableBindings[c];f.event.unsubscribe(f.token)}this.bound=!1;this.disposableBindings=[];this.bindingSetupDelegates=[]}};a.prototype.pulseAll=function(){for(var c=0;c<this.bindingSetupDelegates.length;++c)try{this.bindingSetupDelegates[c]()}catch(f){this.app.trace.error("Error performing initial data-bind in view '{0}' with view model '{1}': {2}".format(this.id,this.viewModel.id,f.message),f)}this.bindingSetupDelegates=[]};a.prototype.resolveWidget=
function(c,f,a){return null};a.prototype.buildTree=function(){function c(a,g){function d(c){var a=[];if(!c)return a;var f=c.match(/\{(.*?)\}/g);if(!f){if(this.app)return this.app.trace.warning("Invalid data-binding expression '{0}'.".format(c)),[];throw Error("Invalid data-binding expression '{0}'.".format(c));}for(c=0;c<f.length;++c){var g=f[c].split(":");2==g.length&&a.push({directive:g[0].replace("{","").trim(),target:g[1].replace("}","").trim()})}return a}if(g&&g.children)for(var k=0;k<g.children.length;++k){var l=
g.children[k],m=dojo.attr(l,"data-region-name"),s=dojo.attr(l,"data-binding");s||(s=l.___dataBindingExpressions);if(s){var t=d(s);l.___dataBindingExpressions=s;f.app.debugMode||dojo.removeAttr(l,"data-binding");if(t&&0!==t.length){for(var v=!1,y=0;y<t.length;++y)(function(){var c=a.expressions,g=a.context,w=!1,k=t[y],p=k.directive,u=k.target,q=new b.framework.ui.BindingExpression;q.domElement=l;q.target=u;null!=f.viewModel?q.viewModel=f.viewModel:(q.viewModel={},q.viewModel.id="[None]");q.parentView=
f.parentView?f.parentView:f;if(p.startsWith("@"))if(u=p.split("-")[1],p.startsWith("@event-"))u?(q.type="event",q.attributeName=u):(this.app.trace.warning("Binding error: Invalid event binding expression '{0}' in view '{1}'.".format(p,f.id)),w=!0);else if(p.startsWith("@var"))q.type="var";else if(p.startsWith("@text"))q.attributeName="innerHTML",q.type="text";else if(p.startsWith("@attach"))q.attributeName="___attachedValue",q.type="attachment";else if(p.startsWith("@style-"))k=p.indexOf("-"),(k=
p.substring(k+1))?(q.type="style",q.attributeName=k):(this.app.trace.warning("Binding error: Invalid style binding expression '{0}' in view '{1}'.".format(p,f.id)),w=!0);else if(p.startsWith("@dom"))q.type="dom",q.attributeName=u;else if(p.startsWith("@value"))q.type="value",q.attributeName=u;else if(p.startsWith("@widget"))q.type=p.substring(1),q.attributeName=u,q.otherExpressions=t;else if(p.startsWith("@class")||p.startsWith("@noclass"))q.type="class",p.startsWith("@noclass")&&(q.invert=!0),k=
p.indexOf("-"),(k=p.substring(k+1))?q.attributeName=k:(this.app.trace.warning("Binding error: Invalid class binding expression '{0}' in view '{1}'.".format(p,f.id)),w=!0);else if("@source"===p){q.type="source";q.attributeName="@source";v=!0;q.templateMode="single-inline";for(u=0;u<t.length;++u)if(p=t[u],p!==k){var s=p.directive,p=p.target;if("@template"===s){q.templateMode="single-external";k=new e.config.ViewConfig(null,null,null);k.markupResource=p;k.libraryId=f.libraryId;var m=f.app.viewManager.createView(k);
if(!m){f.app.trace.error("Could not instantiate template '{0}' while binding view '{1}'.".format(p,this.id));break}m.app=f.app;q.templateSelections={"@default":m.root};break}else if("@template-selector"===s){q.templateMode="inline-selected";q.templateKey=p;q.templateSelections={};break}}if("single-external"!==q.templateMode){k=new dojo.NodeList;for(p=0;p<l.children.length;++p)for(var u=l.children[p],s=dojo.attr(u,"data-binding"),m=d(s),z=0;z<m.length;++z)if(s=m[z],"@template-for"===s.directive||"@template-select"===
s.directive){if("@template-for"===s.directive&&s.target===q.target)k.push(u),m=dojo.clone(u),q.templateSelections["@default"]=m,m.___domParent=l;else if("@template-select"===s.directive){k.push(u);for(var z=!1,E=0;E<m.length;++E){var F=m[E];if("@template"===F.directive){m=new e.config.ViewConfig(null,null,null);m.markupResource=F.target;m.libraryId=f.libraryId;m=f.app.viewManager.createView(m);if(!m){this.app.trace.error("Could not instantiate template '{0}' while binding view '{1}'.".format(F.target,
this.id));break}m.app=f.app;z=dojo.clone(u);dojo.place(m.root,z,"last");q.templateSelections[s.target]=z;z=!0;break}}z||(k.push(u),q.templateSelections[s.target]=u,u.___domParent=l)}break}k.orphan()}}else"@source-remove"===p?(q.type="source-remove",q.attributeName=u):"@source-add"===p?(q.type="source-add",q.attributeName=u):"@visible"===p||"@hidden"===p?("@hidden"===p&&(q.invert=!0),q.type="visibility",q.attributeName="@visibility"):"@disabled"===p||"@enabled"===p?("@disabled"===p&&(q.invert=!0),
q.type="disabledState",q.attributeName="@disabledState"):p.startsWith("@template")?q.type="template":p.startsWith("@halt")?v=!0:(f.app.trace.warning("Unknown binding term '{0}'.".format(p)),w=!0);else q.type="attr",q.attributeName=p;w||f.applyBinding.apply(f,[l,q,g,a])&&c.push(q)})();s=new b.framework.ui.BindingNode;s.domElement=l;s.parent=a;s.context=a.context;s.children=[];s.expressions=[];a.children.push(s);!1!=v||m||c(s,l)}}else m||c(a,l)}}var f=this;if(null!=this.root){var a=new b.framework.ui.BindingNode;
a.domElement=null;a.parent=null;a.children=[];a.context=this.viewModel;c(a,{children:[this.root]});return a}};a.prototype.getBindingTarget=function(c){if("@context"===c.target)return c.viewModel;if(-1<c.target.indexOf("@language-"))return c=c.target.split("-").slice(1).join("-"),this.app.getResource(this.libraryId,"language-"+c);if(!0!=c.viewModel.isObservable)return c.viewModel[c.target];var a=c.viewModel.get();return null==a?a:a[c.target]};a.prototype.setBindingTargetValue=function(c,a){if("@context"===
c.target)c.viewModel&&c.viewModel.isObservable?c.viewModel.set(a):c.viewModel=a;else if(!(-1<c.target.indexOf("@language-")))if(c.viewModel.isObservable){var g=c.viewModel.get();g&&(g[c.target]?g[c.target].isObservable?g[c.target].set(a):g[c.target]=a:g[c.target]=new Observable(a))}else c.viewModel[c.target].isObservable?c.viewModel[c.target].set(a):c.viewModel[c.target]=a};a.prototype.resolveBindingTemplate=function(c,a){var g=null;if("single-inline"===c.templateMode||"single-external"===c.templateMode)g=
dojo.clone(c.templateSelections["@default"]);else if("inline-selected"===c.templateMode){var h=null;a[c.templateKey]&&(h=a[c.templateKey],h.isObservable&&(h=h.get()));!h&&c.templateSelections.hasOwnProperty("@null")?g=dojo.clone(c.templateSelections["@null"]):c.templateSelections.hasOwnProperty(h)&&(g=dojo.clone(c.templateSelections[h]));!g&&c.templateSelections.hasOwnProperty("@default")&&(g=dojo.clone(c.templateSelections["@default"]),dojo.addClass(g,"empty-div"))}g||(g=dojo.create("div"));return g};
a.prototype.buildSourceBinding=function(c,a,g,h){var e=this,d=e.getBindingTarget(a);if(null===d)return!1;if(void 0===d)return e.app.trace.warning("Binding error: '{0}' in view model '{1}' was not bindable.".format(a.target,a.viewModel.id)),!1;var k=function(){if(d.useThrottling&&d.throttledOperations&&d.throttledOperations.length)for(var c=d.throttledOperations.length-1;0<=c;c--)d.throttledOperations[c].cancel(),d.throttledOperations.splice(c,1)},l=function(g){if(!0===a.upToDate)a.upToDate=!1;else{for(var l=
null,r=null,m=0;m<h.expressions.length;++m){var n=h.expressions[m];l||"source-add"!=n.type||(l=n.target);r||"source-remove"!=n.type||(r=n.target)}m=this;a.parentView&&(m=a.parentView);var x=m[l],l=m[r];if(void 0!==g&&null!==g){if(!(g instanceof b.framework.events.CollectionChangedArgs)){r=g.isObservable?g.get():g;l&&l.apply(e,[a,r,g,0]);for(n=0;n<a.boundViews.length;++n)this.app.viewManager.destroyView(a.boundViews[n]);a.boundViews=[];!l&&(n=a.___singleSourceItem)&&(m=new dojo.NodeList,m.push(n),
m.orphan(),a.___singleSourceItem=null);if(r)if(x)x.apply(e,[a,r,g,0]);else{m=e.resolveBindingTemplate(a,r);dojo.place(m,a.domElement,"last");n=new b.framework.ui.ViewBase(e.app);n.parentView=a.parentView;n.app=n.parentView.app;n.libraryId=e.libraryId;var C={children:[]};C.children.push(m);r||(r=new b.framework.ui.ViewModelBase(e.app,e.libraryId),r.app=e.app,r.libraryId=e.libraryId);r.hasOwnProperty("___boundViews");n.root=C;n.attach(r);n.root=m;a.___singleSourceItem=n.root;a.boundViews.push(n)}}else if(null===
g||"clear"===g.type){k();if(l)for(n=g.rangeStart;n<=g.rangeEnd;++n)l.apply(e,[a,d.getAt(n),g,n]);for(n=0;n<a.boundViews.length;++n)this.app.viewManager.destroyView(a.boundViews[n]);a.boundViews=[];if(!l&&null!=a.domElement&&null!=a.domElement.children){m=new dojo.NodeList;for(n=0;n<a.domElement.children.length;++n)a.domElement.children[n].___collectionTemplate||m.push(a.domElement.children[n]);m.orphan()}}else if("replace"===g.type){k();if(l)for(n=g.rangeStart;n<g.rangeEnd+1;++n)l.apply(e,[a,d.getAt(n),
g,n]);for(n=0;n<a.boundViews.length;++n)this.app.viewManager.destroyView(a.boundViews[n]);a.boundViews=[];l||dojo.empty(a.domElement);g.type="append";g.rangeStart=0;g.rangeEnd=d.value.length-1}if("append"===g.type||"insert"===g.type){var A=null;"insert"===g.type&&a.domElement.children.length>g.rangeStart&&(A=a.domElement.children[g.rangeStart]);var D=function(h,k,p){if(h>k||!a||null==a.domElement)return!1;for(p=p?p:d;h<=k;++h){var l=null;if(null!=x)x.apply(e,[a,p.isObservable?p.getAt(h):p[h],g,h]);
else{var r=p.isObservable?p.getAt(h):p[h],l=e.resolveBindingTemplate(a,r);if(A&&"insert"===g.type)dojo.place(l,A,"before");else if(A&&"append"===g.type)dojo.place(l,A,"after");else if(a&&null!=a.domElement)dojo.place(l,a.domElement,"last");else return!1;var m=new b.framework.ui.ViewBase(e.app,e.libraryId);m.parentView=a.parentView;m.app=m.parentView.app;m.libraryId=e.libraryId;m.id+="-item"+h;var u={children:[]};u.children.push(l);if(null===r||void 0===r)r=new b.framework.ui.ViewModelBase(e.app,e.libraryId),
r.app=e.app,r.libraryId=e.libraryId;r.hasOwnProperty("___boundViews");m.root=u;m.attach(r);m.root=l;a.boundViews.push(m)}}c.___populateInitialValueFunc&&(c.___populateInitialValueFunc(),delete c.___populateInitialValueFunc);return!0};if(d.useThrottling){d.throttledOperations=d.throttledOperations&&d.throttledOperations.constructor===Array?d.throttledOperations:[];var l=void 0==d.throttleDelay?0:d.throttleDelay,u=g.rangeStart,q=Math.min(u+10-1,g.rangeEnd),H=d.get().slice(0),G=function(){var c=d.throttledOperations.indexOf(z);
-1<c&&d.throttledOperations.splice(c,1)},z=new b.framework.utils.ThrottledOperation(l,function(){var c=D(u,q,H);if(q>=g.rangeEnd)return G(),!1;u+=10;q+=10;q=Math.min(q,g.rangeEnd);c||G();return c});d.throttledOperations.push(z)}else D(g.rangeStart,g.rangeEnd)}else if("remove"===g.type)for(k(),r=g.rangeStart;r<=g.rangeEnd;++r)for(m=0;m<a.boundViews.length;++m)n=a.boundViews[m],null!==n.viewModel&&void 0!==n.viewModel&&n.viewModel==d.getAt(r)&&(l?l.apply(e,[a,g[r],g,r]):e.app.viewManager.destroyView(n),
Array.removeItem(a.boundViews,n),--m)}}};d.bind&&a.targetBindings.push({event:d.bindingEvent,token:d.bind(e,l)});if(d.isObservableCollection){var m=d.getLength()-1;this.bindingSetupDelegates.push(function(){var c=new b.framework.events.CollectionChangedArgs;c.type="append";c.rangeStart=0;c.rangeEnd=m;c.sender=d;l.apply(e,[c]);d.isObservable&&d.bindingEvent.isPublishing&&(a.upToDate=!0)})}else this.bindingSetupDelegates.push(function(){l.apply(e,[d]);d.isObservable&&d.bindingEvent.isPublishing&&(a.upToDate=
!0)})};a.prototype.buildEventBinding=function(c,a,g){var h=this;!this[a.target]&&a.parentView&&a.parentView[a.target]&&(h=a.parentView);if(h[a.target])c!=a.domElement&&this.app.trace.warning("Binding error: buildEventBinding passed in el that doesn't match binding.domElement."),a.on(a.attributeName,function(b){var d=h[a.target](b,c,g);return d?d:(b.preventDefault(),b.stopPropagation(),!1)});else return this.app.trace.warning("Binding error: Event handler '{0}' was not found in view '{1}' or its parent view.".format(a.target,
h.id)),!1};a.prototype.buildVarBinding=function(c,a,g){g=this;a.parentView&&(g=a.parentView);var h=g[a.target];h?h&&h instanceof Array?h.push(c):h&&h.isObservableCollection?h.addItem(c):g[a.target]=c:g[a.target]=c};a.prototype.buildTextBinding=function(c,a,g){var h=this.getBindingTarget(a);if(null===h)return!1;if(void 0===h)return this.app.trace.warning("Binding error: Property '{0}' does not exist in view model '{1}'.".format(a.target,a.viewModel.id)),!1;var b=function(){if(null==h||h.isObservable){var g=
h.get(),g=null===g||void 0===g?"":g.toString();"innerHTML"===a.attributeName?(dojo.empty(c),c.appendChild(dojo.doc.createTextNode(g))):dojo.attr(c,a.attributeName,String.escapeHtml(g))}else"innerHTML"===a.attributeName?(dojo.empty(c),c.appendChild(document.createTextNode(h))):dojo.attr(c,a.attributeName,String.escapeHtml(h))};h.isObservable&&a.targetBindings.push({event:h.bindingEvent,token:h.bind(this,b)});this.bindingSetupDelegates.push(function(){b.apply(this,[null])})};a.prototype.buildAttributeBinding=
function(c,a,g,h){var b=this.getBindingTarget(a);if("undefined"===typeof b)return this.app.trace.warning("Binding error: Property '{0}' does not exist in view model '{1}'.".format(a.target,a.viewModel.id)),!1;var d=function(){if(null===b)return dojo.attr(c,a.attributeName,""),!1;if(b.isObservable){var g=b.get();if(null===g||void 0===g)g="";!0===h?c[a.attributeName]=g:dojo.attr(c,a.attributeName,g)}else{if(null===b||void 0===b)b="";!0===h?c[a.attributeName]=b:dojo.attr(c,a.attributeName,b)}};null!==
b&&b.isObservable&&a.targetBindings.push({event:b.bindingEvent,token:b.bind(this,d)});this.bindingSetupDelegates.push(function(){d.apply(this,[null])})};a.prototype.buildStyleBinding=function(c,a,g){var h=this,b=this.getBindingTarget(a);if(null===b)return!1;if(void 0===b)return this.app.trace.warning("Binding error: Property '{0}' does not exist in view model '{1}'.".format(a.target,a.viewModel.id)),!1;if(null!=b&&!b.isObservable)g=isNaN(b)||""===b?b:b+"px",dojo.style(c,a.attributeName,g);else if(null!=
b){var d=function(){var g;g=b.get();g=isNaN(g)||""===g?g:g+"px";dojo.style(c,a.attributeName,g)};b.isObservable&&a.targetBindings.push({event:b.bindingEvent,token:b.bind(this,d)});this.bindingSetupDelegates.push(function(){d.apply(h,[null])})}};a.prototype.buildDomBinding=function(c,a,g){c=this;a.parentView&&(c=a.parentView);var h=c[a.target];if(null==h)return!1;if(void 0===h)return this.app.trace.warning("Binding error: Property '{0}' does not exist in view model '{1}'.".format(a.target,a.viewModel.id)),
!1;try{if(h.isObservable){a.targetBindings.push({event:h.bindingEvent,token:h.bind(this,function(c){if(!h.get())return!1;a.domElement=dojo.place(h.get(),a.domElement,"replace");this.app&&this.app.viewManager.notifyDimensionsChanged(this)})});if(!h.get())return!1;dojo.place(h.get(),a.domElement,"replace")}else{if(!h)return!1;dojo.place(h,a.domElement,"replace")}}catch(b){this.app.trace.warning("Binding error: An error occurred in view '{0}' while attempting to perform a DOM binding in view model '{1}'.".format(this.id,
a.viewModel.id))}};a.prototype._createWidgetViewFromConfig=function(c,a){var g=c.type,h=c.id?"WidgetView-{0}-{1}".format(c.id,b.framework.utils.alphaNumericToken()):"{0}-{1}".format(b.framework.utils.alphaNumericToken(),b.framework.utils.alphaNumericToken()),h=new e.config.ViewConfig(h,null,g||"geocortex.framework.ui.ViewBase");h.isVisible=!0;h.libraryId=c.libraryId;c.markup&&(h.markupResource=c.markup);c=this.app.translateConfiguration(c.libraryId,c);g=null;if(c.viewModelId){if(g=this.app.getFrameworkObjectById(c.viewModelId),
!g)throw Error("Could not bind widget '{0}' to view model with ID '{1}': View model not found.".format(c.Id,c.viewModelId));}else c.viewModelType?(g=this.app.instantiateFrameworkObject(c.viewModelType,c.libraryId),c.id||(c.id=b.framework.utils.alphaNumericToken()),g.id="WidgetViewModel-{0}-{1}".format(c.id,b.framework.utils.alphaNumericToken())):g=a;h=this.app.viewManager.createView(h);if(!h)throw Error("Could not create widget '{0}': The widget's view could not be created.".format(c.Id));h.configuration=
c.configuration;var d={children:[]};d.children.push(h.root);h.root=d;h.attach(g);h.root=d.children[0];return h};a.prototype.buildWidgetBinding=function(c,a,g){var h=this,d=a.target,e=this.viewModel,k=!0,l=!1,m=null;g=null;if(a.otherExpressions)for(c=0;c<a.otherExpressions.length;++c)if(g=a.otherExpressions[c],"@widget-context"===g.directive){a.target=g.target;e=this.getBindingTarget(a);if(!e)return this.app.trace.error("Error binding widget '{0}' to target '{1}': Target was not found in view model.".format(d,
g.target)),!1;m=e}else"@widget-required"===g.directive?k="false"!==g.target.toLowerCase():"@widget-replace"===g.directive&&(l="true"===g.target.toLowerCase());g=e&&e.isObservable;var s=this.app.configModel.widgetConfigs,t=null;for(c=0;c<s.length;++c){var v=s[c];if(v.id===d){t=v;break}}var y=!t,n=function(){var c=m||null;c&&c.isObservable&&(c=c.get());c=(a.parentView||this).resolveWidget(d,c,a);if(!c){if(k)throw Error("Widget '{0}' was not found.".format(d));return!1}return c},x=function(c,g){var e=
null;if(0<a.boundViews.length)for(var k=0;k<a.boundViews.length;++k)h.app.viewManager.destroyView(a.boundViews[k]);dojo.empty(a.domElement);k=null;if(c){if("string"===typeof c)e=dojo.create("div"),dojo.attr(e,"innerHTML",c),dojo.addClass(e,"empty-div"),e=e.children&&1===e.children.length?e.children[0]:e;else if(c.hasOwnProperty("nodeType")&&[1,2,3,8,9].contains(t.nodeType))e=c;else if(c instanceof b.framework.ui.ViewBase)k=c,a.boundViews.push(k),e=c.root;else if(c instanceof b.framework.config.WidgetConfig)k=
h._createWidgetViewFromConfig(c,g),a.boundViews.push(k),e=k.root;else{h.app.trace.warning("Could not resolve widget '{0}': Object of unknown type provided.".format(d));return}dojo.place(e,a.domElement,l?"replace":"last");k&&(k.added(h),k.activated())}};g&&a.targetBindings.push({event:e.bindingEvent,token:e.bind(this,function(c){if(y){var a=n();x(a,c)}else x(t,c)})});this.bindingSetupDelegates.push(function(){var c=null;e&&(c=e.isObservable?e.get():e);if(y){var a=n();x(a,c)}else x(t,c)})};a.prototype.buildClassBinding=
function(c,a,g){var h=this.getBindingTarget(a);if(null===h)return!1;if(void 0===h)return this.app.trace.debug("Binding error: Property '{0}' does not exist in view model '{1}'.".format(a.target,a.viewModel.id)),!1;var b=function(g){g=e.isTruthy(g);!0===a.invert&&(g=!g);var h=a.attributeName;!0===g?(dojo.removeClass(c,h),dojo.addClass(c,h)):dojo.removeClass(c,h)},e=this;h.isObservable&&a.targetBindings.push({event:h.bindingEvent,token:h.bind(this,b)});this.bindingSetupDelegates.push(function(){b.apply(e,
[h])})};a.prototype.isTruthy=function(c){if(c)if(c instanceof b.framework.events.CollectionChangedArgs)if("append"===c.type){if(0<c.rangeEnd+1-c.rangeStart||c.sender.value&&0<c.sender.value.length)return!0}else{if("clear"===c.type)return!1;if("insert"===c.type){if(0<c.rangeEnd+1-c.rangeStart)return!0}else if("remove"===c.type&&c.rangeEnd+1-c.rangeStart<c.sender.value.length)return!0}else return c.isObservableCollection?0<c.getLength():c.isObservable?!!c.get():c?!0:"string"===typeof c?0<c.length:!1;
else return!1};a.prototype.buildVisibilityBinding=function(c,a,g){var h=this.getBindingTarget(a);if(null===h)return!1;if(void 0===h)return this.app.trace.debug("Binding error: Property '{0}' does not exist in view model '{1}'.".format(a.target,a.viewModel.id)),!1;a.initialVisibility=dojo.style(c,"display")||"block";var b=function(g){g=e.isTruthy(g);!0==a.invert&&(g=!g);var h="",h="inline"===a.initialVisibility?"bound-visible-inline":"bound-visible";!0==g?(dojo.removeClass(c,"bound-invisible"),dojo.addClass(c,
h)):(dojo.removeClass(c,h),dojo.addClass(c,"bound-invisible"))},e=this;h.isObservable&&a.targetBindings.push({event:h.bindingEvent,token:h.bind(this,b)});this.bindingSetupDelegates.push(function(){b.apply(e,[h])})};a.prototype.buildDisabledBinding=function(c,a,g){var h=this.getBindingTarget(a);if(void 0===h)return this.app.trace.debug("Binding error: Property '{0}' does not exist in view model '{1}'.".format(a.target,a.viewModel.id)),!1;a.initialDisabled=dojo.attr(c,"disabled");var e=function(g){var e=
!1;if(!g)e=!0;else if(h)if(g instanceof b.framework.events.CollectionChangedArgs)if("append"==g.type){if(0<g.rangeEnd+1-g.rangeStart||h.value&&0<h.value.length)e=!1}else"clear"==g.type?e=!0:"insert"==g.type?0<g.rangeEnd+1-g.rangeStart&&(e=!1):"remove"==g.type&&g.rangeEnd+1-g.rangeStart<h.value.length&&(e=!1);else e=h.isObservableCollection?!(0<h.getLength()):h.isObservable?!h.get():"string"===typeof g?0==g.length:!1;!0==a.invert&&(e=!e);!0==e?(dojo.attr(c,"disabled",!0),dojo.attr(c,"tabindex",-1),
dojo.addClass(c,"bound-disabled")):(dojo.removeAttr(c,"disabled"),dojo.removeAttr(c,"tabindex"),dojo.removeClass(c,"bound-disabled"))},d=this;h.isObservable&&a.targetBindings.push({event:h.bindingEvent,token:h.bind(this,e)});this.bindingSetupDelegates.push(function(){e.apply(d,[h])})};a.prototype.buildValueBinding=function(c,a,g){var h=this,d=this.getBindingTarget(a);if(void 0===d)return this.app.trace.warning("Binding error: Property '{0}' does not exist in view model '{1}'.".format(a.target,a.viewModel.id)),
!1;if(null==d)return!1;var k=d.isObservable||!1,l=d.isObservableCollection||!1;g=c.tagName.toLowerCase();var r=dojo.attr(c,"type");if(k){var m=function(a){if(a!==dojo.attr(c,"value")){if(null===a||void 0===a)a="";dojo.attr(c,"value",a)}},s=function(a){c.checked=!0===a},t=function(a){var f=dojo.attr(c,"value");dojo.query("input[type=radio]",h.root).forEach(function(c){});c.checked=!0===a||f==a?!0:!1},v=function(a){a instanceof Date?(a=new Date(a.getTime()),a.setMinutes(a.getMinutes()-a.getTimezoneOffset()),
c.valueAsDate=a):c.value=a},y=function(c){var g=c;c=function(c,a){return"undefined"!==typeof c.___attachedValue?"number"===typeof c.___attachedValue||"boolean"===typeof c.___attachedValue?c.___attachedValue.toString()===(void 0===a?g:a):c.___attachedValue===(void 0===a?g:a)||c.___attachedValue.value===(void 0===a?g:a):c.value===(void 0===a?g:a)};if(g instanceof b.framework.events.CollectionChangedArgs){for(var h=g,d=h.sender,e=[],k=h.rangeStart;k<=h.rangeEnd;k++){var w=d.getAt(k);e.push(w.value?w.value+
"":w)}if("append"===h.type||"insert"===h.type)for(h=0;h<a.domElement.options.length;++h)for(d=a.domElement.options[h],k=0;k<e.length;k++)c(d,e[k])?d.selected=!0:dojo.attr(a.domElement,"multiple")||(d.selected=!1)}else{if("number"===typeof g||"boolean"===typeof g)g=g.toString();if(null===g||void 0===g)for(h=0;h<a.domElement.options.length;++h)d=a.domElement.options[h],d.selected=!1;else if(dojo.isArray(g))if(a.viewModel[a.target].isObservableCollection)for(k=!1,h=0;h<a.domElement.options.length;++h){if(d=
a.domElement.options[h],d.selected=!1,dojo.attr(a.domElement,"multiple")||!k)for(w=0;w<g.length;++w)if(e=g[w],c(d,e)){k=d.selected=!0;break}}else for(h=0;h<a.domElement.options.length;++h){if(d=a.domElement.options[h],c(d,e)){d.selected=!0;break}}else for(h=0;h<a.domElement.options.length;++h)if(d=a.domElement.options[h],c(d,e)){d.selected=!0;break}}};"select"===g?(a.targetBindings.push({event:d.bindingEvent,token:d.bind(a,y)}),this.bindingSetupDelegates.push(function(){y.apply(h,[d.get()])})):"radio"===
r?(a.targetBindings.push({event:d.bindingEvent,token:d.bind(a,t)}),this.bindingSetupDelegates.push(function(){t.apply(h,[d.get()])})):"checkbox"===r?(a.targetBindings.push({event:d.bindingEvent,token:d.bind(a,s)}),this.bindingSetupDelegates.push(function(){s.apply(h,[d.get()])})):"date"===r?(a.targetBindings.push({event:d.bindingEvent,token:d.bind(a,v)}),this.bindingSetupDelegates.push(function(){v.apply(h,[d.get()])})):(a.targetBindings.push({event:d.bindingEvent,token:d.bind(a,m)}),this.bindingSetupDelegates.push(function(){m.apply(h,
[d.get()])}))}var n=function(){a.on("change",function(c){if(void 0===c.currentTarget)h.app&&h.app.trace.error("Binding error: bound to change event where currentTarget is undefined");else return c=dojo.attr(c.currentTarget,"value"),k?d.set(c):h.setBindingTargetValue(a,c),!0})},x=function(){a.on("change",function(c){c=dojo.attr(c.currentTarget,"checked");k?d.set(c):h.setBindingTargetValue(a,c);return!0})},C=function(){a.on("click",function(c){dojo.attr(c.currentTarget,"checked")&&(k?d.set(c.currentTarget.value):
h.setBindingTargetValue(a,c.currentTarget.value));return!0})},A=function(){a.on("change",function(c){var g=k?d.get():d;c=c.currentTarget.valueAsDate;c.setMinutes(c.getMinutes()+c.getTimezoneOffset());g instanceof Date&&!isNaN(g.getTime())&&(c.setHours(g.getHours()),c.setMinutes(g.getMinutes()),c.setSeconds(g.getSeconds()),c.setMilliseconds(g.getMilliseconds()));k?d.set(c):h.setBindingTargetValue(a,c);return!0})},D=function(){c.___populateInitialValueFunc=function(){y(d.isObservable?d.get():d)};a.on("change",
function(){for(var g=dojo.query("option",c),b=[],m=0;m<g.length;++m){var r=g[m];if(!0===r.selected){var n=r.___attachedValue;e.utils.isNullOrUndefined(n)?b.push(r.value):b.push(n)}}0===b.length&&0<g.length&&!c.multiple&&!0===h.app.___uaIsiPad&&(c.selectedIndex=0,n=g[0].___attachedValue,b.push(e.utils.isNullOrUndefined(n)?g[0].value:n));0<b.length?l?(d.clear(),d.addItems(b)):k?d.set(b[0]):h.setBindingTargetValue(a,b):d.clear();return!0})};"textarea"===g||"input"===g&&"text"===r?function(){var c=null,
g=function(g){g=dojo.attr(g.currentTarget,"value");if(g!==c)return c=g,k?d.set(g):h.setBindingTargetValue(a,g),!0};a.on("change",g);a.on("keyup",g);a.on("mouseup",g);a.on("input",g)}():"input"===g&&"checkbox"===r?x():"input"===g&&"radio"===r?C():"input"===g&&"date"===r?A():"select"===g?D():n()};a.prototype.applyBinding=function(c,a,g,h){"source"===a.type?this.buildSourceBinding(c,a,g,h):"event"===a.type?this.buildEventBinding(c,a,g):"text"===a.type?this.buildTextBinding(c,a,g):"var"===a.type?this.buildVarBinding(c,
a,g):"class"===a.type?this.buildClassBinding(c,a,g):"style"===a.type?this.buildStyleBinding(c,a,g):"dom"===a.type?this.buildDomBinding(c,a,g):"value"===a.type?this.buildValueBinding(c,a,g):"attr"===a.type?this.buildAttributeBinding(c,a,g):"attachment"===a.type?this.buildAttributeBinding(c,a,g,!0):"visibility"===a.type?this.buildVisibilityBinding(c,a,g):"disabledState"===a.type?this.buildDisabledBinding(c,a,g):"widget"===a.type&&this.buildWidgetBinding(c,a,g);return!0};return a}(b.framework.FrameworkObject);
l.ViewBase=k})(e.ui||(e.ui={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(l){var k=function(){function d(a,c){this._viewActivationTimers=[];this._viewDeactivationTimers=[];this.isActive=!1;this.options=this.domElement=null;this.views=[];this.activeViews=[];this.defaultTransitionDelay=10;this.app=c;this.name=a}d.prototype.host=function(a,c){this.domElement=a;this.options=c||{};if(this.options.useTransitions){if(!this.options.transitionDelay||isNaN(this.options.transitionDelay))this.options.transitionDelay=this.defaultTransitionDelay}else this.options.useTransitions=
!1};d.prototype.unhost=function(){this.options=this.domElement=null};d.prototype.activateView=function(a){this.cancelActivate(a);0===this.activeViews.length&&!1===a.isActive&&(this.isActive=!0,this.app.event("RegionActivatedEvent").publish(this),dojo.removeClass(this.domElement,"region-inactive"),dojo.addClass(this.domElement,"region-active"));b.utils.ArrayUtils.contains(this.activeViews,a)&&b.utils.ArrayUtils.removeItem(this.activeViews,a);this.activeViews.push(a);a.activated();a.isActive=!0;this.options.useTransitions?
(dojo.removeClass(a.root,"inactive"),dojo.addClass(a.root,"activating"),this._viewActivationTimers[a.id]=setTimeout(dojo.hitch(this,function(){dojo.removeClass(a.root,"inactive");dojo.removeClass(a.root,"activating");dojo.addClass(a.root,"active");delete this._viewActivationTimers[a.id]}),this.options.transitionDelay)):(dojo.removeClass(a.root,"inactive"),dojo.addClass(a.root,"active"));this.app.event("ViewActivatedEvent").publish(a)};d.prototype.cancelActivate=function(a){this._viewActivationTimers[a.id]&&
(clearTimeout(this._viewActivationTimers[a.id]),delete this._viewActivationTimers[a.id],dojo.removeClass(a.root,"activating"))};d.prototype.cancelDeactivate=function(a){this._viewActivationTimers[a.id]&&(clearTimeout(this._viewActivationTimers[a.id]),delete this._viewActivationTimers[a.id],dojo.removeClass(a.root,"deactivating"))};d.prototype.deactivateView=function(a){this.cancelDeactivate(a);1>=this.activeViews.length&&!0===a.isActive&&(this.isActive=!1,dojo.removeClass(this.domElement,"region-active"),
dojo.addClass(this.domElement,"region-inactive"),this.app.event("RegionDeactivatedEvent").publish(this));this.cancelActivate(a);b.utils.ArrayUtils.removeItem(this.activeViews,a);a.deactivated();a.isActive=!1;this.options.useTransitions?(dojo.removeClass(a.root,"active"),dojo.addClass(a.root,"deactivating"),this._viewDeactivationTimers[a.id]=setTimeout(dojo.hitch(this,function(){dojo.removeClass(a.root,"active");dojo.removeClass(a.root,"deactivating");dojo.addClass(a.root,"inactive");delete this._viewDeactivationTimers[a.id]}),
this.options.transitionDelay)):(dojo.removeClass(a.root,"active"),dojo.addClass(a.root,"inactive"));this.app.event("ViewDeactivatedEvent").publish(a)};d.prototype.hostView=function(a){a.added();dojo.removeClass(a.root,"active");dojo.addClass(a.root,"inactive");this.app.event("ViewHostedEvent").publish({region:this,view:a})};d.prototype.unhostView=function(a){a.removed();dojo.removeClass(a.root,"active");dojo.addClass(a.root,"inactive");this.app.event("ViewUnhostedEvent").publish({region:this,view:a})};
return d}();l.RegionAdapterBase=k})(b.ui||(b.ui={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(e){(function(l){var k=function(d){function a(c,f){var g=this;d.call(this,c,f);this.activeView=null;this.activeViews=[];this._scrollTimer=this.overlayElement=this.contentElement=this.contentContainer=this.contentTitle=this.contentHeader=this.titleBindingToken=null;this._scrollDelay=50;this._screenReaderNarrationDisabled=!1;if(a.instance)throw Error("PopupModalRegionAdapter is a singleton and has already been constructed once.");a.instance=this;null==this.app.modalRegionSingleton&&
(this.app.modalRegionSingleton=this);this.app.command("CloseModalRegion").register(this,function(){g.deactivate()});this.app.event("ViewActivatedEvent").subscribe(this,function(){0<g.activeViews.length&&setTimeout(function(){g.positionContent()},0)});this.app.event("ViewDimensionsChangedEvent").subscribe(this,function(){g.positionContent()})}__extends(a,d);a.getInstance=function(){return a.instance};a.prototype.activate=function(){0<this.activeViews.length&&(dojo.style(this.domElement,"opacity",0),
dojo.query(this.domElement).removeClass("inactive"),dojo.query(this.domElement).addClass("active"),dojo.query(this.overlayElement).removeClass("inactive"),dojo.query(this.overlayElement).addClass("active"))};a.prototype.deactivate=function(){dojo.query(this.domElement).removeClass("active");dojo.query(this.domElement).addClass("inactive");dojo.query(this.overlayElement).removeClass("active");dojo.query(this.overlayElement).addClass("inactive");this._screenReaderNarrationDisabled&&(this.app.command("EnableScreenReaderNarrate").execute(),
this._screenReaderNarrationDisabled=!1);this.activeView&&(this.activeView=null)};a.prototype.host=function(c){var a=this;d.prototype.host.call(this,c);this.domElement=c;dojo.query(this.domElement).removeClass("active");dojo.query(this.domElement).addClass("inactive");this.contentContainer=dojo.query(".modal-container")[0];this.contentElement=dojo.query(".modal-container-inner")[0];this.overlayElement=dojo.query(".modal-overlay")[0];dojo.connect(window,"onresize",function(){a.handleScrollEvent()});
dojo.connect(window,"onscroll",function(){a.handleScrollEvent()});this.app.event("WorkflowFormTextInputBlurredEvent").subscribe(this,function(){setTimeout(function(){a.positionContent()},100)})};a.prototype.handleScrollEvent=function(){var c=this;null!=this._scrollTimer&&(clearTimeout(this._scrollTimer),this._scrollTimer=null);this._scrollTimer=setTimeout(function(){c.positionContent()},0)};a.prototype.positionContent=function(){var c=this;if(this.contentContainer&&null!=this.activeView&&null!=this.activeView.root){var a=
dojo.position(this.contentContainer),g=dojo.window.getBox(),h=a.w;a.w>g.w?(h=g.w,dojo.style(this.contentElement,{"max-width":h+"px"})):dojo.style(this.contentElement,{"max-width":""});var d=a.h;a.h>g.h?(d=g.h,dojo.style(this.contentElement,{"max-height":d+"px"})):dojo.style(this.contentElement,{"max-height":""});dojo.style(this.contentContainer,{left:g.w/2-h/2+"px",top:g.h/2-d/2+"px"});setTimeout(function(){return dojo.style(c.domElement,"opacity",1)})}};a.prototype.showActiveView=function(a){a.isActive&&
(this.activeView=a,this.hideAllViews(),a.activated(),this.activate(),this.activeView=a,dojo.removeClass(a.root,"inactive"),dojo.addClass(a.root,"active"))};a.prototype.hideAllViews=function(){dojo.query("> .view",this.contentElement).removeClass("active");dojo.query("> .view",this.contentElement).addClass("inactive")};a.prototype.activateView=function(a){var f=this;e.utils.ArrayUtils.contains(this.activeViews,a)&&e.utils.ArrayUtils.removeItem(this.activeViews,a);this.activeViews.push(a);this._screenReaderNarrationDisabled||
(this._screenReaderNarrationDisabled=!0,this.app.command("DisableScreenReaderNarrate").execute());d.prototype.activateView.call(this,a);this.showActiveView(a);this._repositionOnImageLoaded(a.root);setTimeout(function(){return f.app.command("FocusOnFirstInputInView").execute(a)},400)};a.prototype.deactivateView=function(a){e.utils.ArrayUtils.removeItem(this.activeViews,a);0<this.activeViews.length?(this.showActiveView(this.activeViews[this.activeViews.length-1]),this.positionContent()):this.deactivate();
d.prototype.deactivateView.call(this,a)};a.prototype.deactivateActiveView=function(){if(this.activeView){null!=this.titleBindingToken&&(this.activeView.title.unbind(this.titleBindingToken),this.titleBindingToken=null);var a=this.activeView;this.activeView=null;this.deactivateView(a);e.utils.ArrayUtils.removeItem(this.activeViews,this.activeView)}};a.prototype.hostView=function(a){this.views.push(a);if(null==a.root){var f=b.resourceManager.fetch(a.markupResource,a.libraryId);if(null==f)return this.app.trace.warning("Could not fetch markup resource '{0}' in library '{1}'.".format(a.markupResource,
a.libraryId)),!1;a.root=dojo.create("div",{className:"view {0}".format(a.id)});a.root.innerHTML=f;dojo.place(a.root,this.contentElement,"last");a.viewModel&&a.attach(a.viewModel);this.app.viewManager.discoverRegions(a.root,a);this.positionContent()}else dojo.place(a.root,this.contentElement,"last");d.prototype.hostView.call(this,a);return!0};a.prototype.unhostView=function(a){a==this.activeView&&this.deactivateView(a);e.utils.ArrayUtils.removeItem(this.views,a);e.utils.ArrayUtils.removeItem(this.activeViews,
a);var f=new dojo.NodeList;f.push(a.root);f.orphan();d.prototype.unhostView.call(this,a)};a.prototype._repositionOnImageLoaded=function(a){var f=this;dojo.forEach(dojo.query("img",a),function(a){a.attached_ModalRegion_ImageLoadedConnection&&(dojo.disconnect(a.attached_ModalRegion_ImageLoadedConnection),delete a.attached_ModalRegion_ImageLoadedConnection);var c=dojo.connect(a,"load",f,function(a){f._imageLoaded(a)});a.attached_ModalRegion_ImageLoadedConnection=c})};a.prototype._imageLoaded=function(a){a=
a.target;a.attached_ModalRegion_ImageLoadedConnection&&(dojo.disconnect(a.attached_ModalRegion_ImageLoadedConnection),delete a.attached_ModalRegion_ImageLoadedConnection);this.positionContent()};a.instance=null;return a}(l.RegionAdapterBase);l.PopupModalRegionAdapter=k})(e.ui||(e.ui={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){var e=function(){function d(){}d.createCommands=function(a){};return d}();b.ApplicationCommands=e})(b.application||(b.application={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(e){(function(l){var k=function(){return function(a,c,f){this.impl=a;this.scope=c;this.canExecute=f}}(),d=function(){function a(a,f,g){this._entries={};this.app=null;this.name=a;this.app=f;this.isWrapper=!0;this.canExecuteChanged=new e.events.Event("{0}.CanExecuteChanged".format(a));this.preExecute=new e.events.Event("{0}.PreExecute".format(a));this.postExecute=new e.events.Event("{0}.PostExecute".format(a));this.canExecuteMode=null!=g&&void 0!=g?g:"all"}a.prototype.raiseCanExecuteChanged=
function(){this.canExecuteChanged.publish()};a.prototype.canExecute=function(a){if(this.isWrapper)return!1;for(var f in this._entries)if(this._entries.hasOwnProperty(f)){var g=this._entries[f];if(g.canExecute&&g.canExecute.apply(g.scope,arguments)){if("any"===this.canExecuteMode)return!0}else if("all"===this.canExecuteMode)return!1}return"any"===this.canExecuteMode?!1:!0};a.prototype.execute=function(a){var f=!1;if(this._entries)for(var g in this._entries)if(this._entries.hasOwnProperty(g)){f=!0;
break}if(f){if("all"!==this.canExecuteMode||this.canExecute.apply(this,arguments)){this.app&&this.app.debugMode&&(f="Command '{0}' executed.".format(this.name),console.debug?console.debug(f):console.log(f));this.preExecute.publish.apply(this.preExecute,arguments);for(g in this._entries)this._entries.hasOwnProperty(g)&&(f=this._entries[g],("any"!==this.canExecuteMode||f.canExecute.apply(f.scope,arguments))&&f.impl.apply(f.scope,arguments));this.postExecute.publish.apply(this.postExecute,arguments)}}else this.app.trace.debug("Command '{0}' executed but no implementation registered.".format(this.name))};
a.prototype.register=function(a,f,g){this.isWrapper=!1;var h=b.framework.utils.alphaNumericToken();f=new k(f,a,g||this.defaultCanExecuteFunction);this._entries[h]=f;a&&a instanceof b.framework.FrameworkObject&&a.trackCommandHandler(this,h);this.app.trace.debug("Registered an implementation for command '{0}'.".format(this.name));this.raiseCanExecuteChanged();return h};a.prototype.defaultCanExecuteFunction=function(){return!0};a.prototype.unregister=function(a){this.isWrapper=!1;if(!this._entries.hasOwnProperty(a))return!1;
delete this._entries[a];this.app.trace.debug("Unregistered an implementation for command '{0}'.".format(this.name));this.raiseCanExecuteChanged();return!0};a.prototype.clear=function(){this._entries={};this.raiseCanExecuteChanged();this.app.trace.debug("Cleared all implementations of command '{0}'.".format(this.name))};return a}();l.Command=d})(e.commands||(e.commands={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(e){(function(e){var k=function(){function d(a){this.commands={};this.app=a}d.prototype.clear=function(){for(var a in this.commands)this.commands.hasOwnProperty(a)&&this.commands[a].clear()};d.prototype.command=function(a){var c=this.commands[a];return c?c:(a=new b.framework.commands.Command(a,this.app),a.isWrapper=!0,this.commands[a.name]=a)};return d}();e.CommandRegistry=k})(e.commands||(e.commands={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(e){(function(e){function k(a){var c=[-1399014851,-706512510];b._nonConfigs&&(c=b._nonConfigs.map(function(a){return String.quickHashCode(a.toLowerCase())}));var f=document.createElement("a");f.href=a.toLowerCase();a=f.href;for(a=decodeURIComponent(a);-1<a.indexOf("%");)a=decodeURIComponent(a);a=a.replace(/[\\\/:]+/g,"/");var g=a.split(/[\\\/:]/);a=g.map(function(a){return a.toLowerCase()}).map(function(a,c){return c<g.length-1?[a,g[c+1]]:null});a.pop();var h=!1;a.forEach(function(a){a=
String.quickHashCode(a[0]+"/"+a[1]);-1<c.indexOf(a)&&(h=!0)});return h}var d=function(){function a(a){this._targetConfigUri=null;this.app=a}a.prototype.loadConfigurationTree=function(a,f){var g=this;this._targetConfigUri=a;if(k(this._targetConfigUri)){var h=Error("Configuration cannot be loaded from this location.");this.app.event("ConfigurationLoadFailedEvent").publish(h)}else this.app.fetchConfigResource({url:this._targetConfigUri,load:function(a){null!=f&&void 0!=f&&f(a)},error:function(a){return g.app.event("ConfigurationLoadFailedEvent").publish(a)}})};
return a}();e.ConfigurationLoader=d;e.checkList=k})(e.config||(e.config={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));(function(b){(function(b){(function(b){var e=function(){return function(d,a){this.locales=[];this.position=0;this.omitStyles=!1;this.id=d;this.uri=a}}();b.LibraryConfig=e})(b.config||(b.config={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(e){(function(e){var k=function(d){function a(a,f){d.call(this,a,f)}__extends(a,d);a.prototype.initialize=function(a){};a.prototype.getResource=function(a,f){return this.app.getResource(this.libraryId,a,f)};return a}(b.framework.FrameworkObject);e.ViewModelBase=k})(e.ui||(e.ui={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){var e=function(){return function(d,a,c){this.viewId=d;this.moduleName=a;this.typeName=c}}();b.ViewConfig=e})(b.config||(b.config={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){var e=function(){return function(b,a,c){this.libraryId="";this.configuration={};this.viewModelId=b;this.moduleName=a;this.typeName=c}}();b.ViewModelConfig=e})(b.config||(b.config={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){var e=function(){return function(b,a,c,f){this.viewConfigs=[];this.viewModelConfigs=[];this.moduleName=b;this.moduleType=a;this.configuration=c;this.libraryId=f}}();b.ModuleConfig=e})(b.config||(b.config={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){var e=function(){return function(b,a){this.viewModelType=null;this.configuration={};this.markup=this.typeName="";this.id=b;this.libraryId=a}}();b.WidgetConfig=e})(b.config||(b.config={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(e){(function(e){var k=function(){function d(a){this.application={};this.viewerId=this.version="unknown";this.defaultLibraryId="";this.globals=null;this.libraryConfigs=[];this.moduleConfigs=[];this.widgetConfigs=[];this.libraryModules={};this.externalLocaleReferences=[];this.app=a}d.prototype.parse=function(a,c){var f="object"===typeof a?a:JSON.parse(a);f.configuration||(f.configuration={version:"1.0",viewerId:"unknown",application:{},defaultLibraryId:"",libraries:[],modules:[],
widgets:[]});var g,h,d;try{this.application=f.configuration.application||{},this.version=f.configuration.version||"1.0",this.viewerId=f.configuration.viewerId||"unknown",this.defaultLibraryId=f.configuration.defaultLibraryId||null,g=f.configuration.libraries||[],h=f.configuration.modules||[],d=f.configuration.widgets||[],this.app.trace.debug("Config version: {0}.".format(this.version))}catch(e){this.app.trace.error("Error reading configuration: {0}".format(e),e);return}if(g&&0<g.length)for(var k=
0;k<g.length;++k){var l=g[k],l=this.app.translateConfiguration(l.id,l);null==this.defaultLibraryId&&(this.defaultLibraryId=l.id);var m=new b.framework.config.LibraryConfig(l.id,l.uri);m.position=k;m.omitStyles=l.omitStyles||!1;this.libraryConfigs.push(m);this.libraryModules[l.id]=[];if(l.locales)for(f=0;f<l.locales.length;++f){var s=l.locales[f];s.locale=s.locale.toLowerCase();s.hasOwnProperty("uri")&&(s.libraryId=l.id,m.locales.push(s),this.externalLocaleReferences.push(s))}}if(h&&0<h.length)for(f=
0;f<h.length;++f){g=h[f];k=g.libraryId;k||(k=this.defaultLibraryId);l=new b.framework.config.ModuleConfig(g.moduleName,g.moduleType,g.configuration,k);this.libraryModules[k]?this.libraryModules[k].push(l):this.app.trace.error("Unknown library '{0}'.".format(k));if(s=g.views)for(m=0;m<s.length;++m){var t=s[m],v=new b.framework.config.ViewConfig(t.id,g.moduleName,t.type||"geocortex.framework.ui.ViewBase");l.viewConfigs.push(v);v.libraryId=t.libraryId||k;v.viewModelId=t.viewModelId||null;v.markupResource=
t.markup||null;v.configuration=t.configuration||{};v.regionName=t.region||null;v.isManaged=t.isManaged||!1;v.isVisible=t.visible||!1;v.title=t.title||null;v.description=t.description||"";v.iconUri=t.iconUri||""}if(s=g.viewModels)for(m=0;m<s.length;++m)t=s[m],v=new b.framework.config.ViewModelConfig(t.id,g.moduleName,t.type),l.viewModelConfigs.push(v),v.libraryId=t.libraryId||k,t.configuration&&(v.configuration=t.configuration);this.moduleConfigs.push(l)}if(d&&0<d.length)for(k=0;k<d.length;++k)h=new b.framework.config.WidgetConfig(d[k].id,
d[k].libraryId||this.defaultLibraryId),dojo.safeMixin(h,d[k]),this.widgetConfigs.push(h);c&&c(this)};return d}();e.ConfigurationModel=k})(e.config||(e.config={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(e){(function(e){var k=function(){function d(a){this.events={};this.app=a}d.prototype.clear=function(){for(var a in this.events)this.events.hasOwnProperty(a)&&this.events[a].clear()};d.prototype.event=function(a){var c=this.events[a];c||(c=new b.framework.events.Event(a,this.app),this.events[a]=c);return c};return d}();e.EventRegistry=k})(e.events||(e.events={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){var e=function(){function b(){this.numKeys=this.sizeInChars=this.capacity=b.UNKNOWN}b.UNKNOWN=-1;return b}();b.StorageStats=e})(b.storage||(b.storage={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){var e=function(){function d(a){this.app=a;this.keyNamespace=a.id}d.prototype.initialize=function(){};d.prototype.isSupported=function(){return!1};d.prototype.isFull=function(){return!1};d.prototype.getStats=function(){return new b.StorageStats};d.prototype.getScore=function(){return 0};d.prototype.clear=function(a,c){};d.prototype.clearAllData=function(a,c){};d.prototype.get=function(a,c,f,g){};d.prototype.set=function(a,c,f,g,b){};d.prototype.remove=function(a,
c,f,g){};return d}();b.StorageProviderBase=e})(b.storage||(b.storage={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){var e=function(d){function a(){d.apply(this,arguments);this._isInitializing=!1;this._initializationErrorCallback=this._initializationSuccessCallback=null;this._defaultDesiredSize=524288E3;this._storageTypeTemporary=0;this._storageTypePersistent=1;this._error=null;this._isInitialized=this._isFull=!1}__extends(a,d);a.prototype.initialize=function(a){var f=this;if(!this._isInitialized&&!this._error)if(d.prototype.initialize.call(this),this.isSupported()){a||(this.app.configuration&&
this.app.configuration.offlineStorageSpaceMb&&(a=1048576*parseInt(this.app.configuration.offlineStorageSpaceMb,10)),a||(a=this._defaultDesiredSize));var g=function(a){f._isInitialized||(f._isInitialized=!0,f.app.trace.debug("Filesystem '{0}' initialized successfully.".format(a.name)),f._filesystem=a,f._error=null,f._initializationSuccessCallback(a))};navigator.webkitPersistentStorage||window.webkitStorageInfo?this._requestQuota(this._storageTypePersistent,a,function(b){this._isInitialized||(f.app.trace.debug("HTML5 File API quota granted. Size: {0} bytes.".format(b)),
f._requestFileSystem(window.PERSISTENT,a,g,function(a){a=f._shapeError(a);f._error=a;f._initializationErrorCallback(a)}))},function(a){a=f._shapeError(a);f._error=a;f.app.trace.error("Error requesting filesystem quota: {0}".format(a.toString()),a);f._initializationErrorCallback(a)}):this._requestFileSystem(LocalFileSystem.PERSISTENT,a,g,function(a){a=f._shapeError(a);f._error=a;f._initializationErrorCallback(a)})}else this.app.trace.warning("The HTML5 storage provider could not be initialized. The File API is not supported by this browser.")};
a.prototype.isSupported=function(){return!(!window.requestFileSystem&&!window.webkitRequestFileSystem)};a.prototype.isFull=function(){return this._isFull};a.prototype.getScore=function(){this.initialize();return 5};a.prototype.getStats=function(){this.initialize();return new b.StorageStats};a.prototype._ensureInitializedThen=function(a){var f=null;if(this._isInitialized)a.apply(this,[]);else if(this._isInitializing)f=dojo.connect(this,"_initializationSuccessCallback",function(){dojo.disconnect(f);
a.apply(g,[])});else{var g=this;this._isInitializing=!0;f=dojo.connect(this,"_initializationSuccessCallback",function(){dojo.disconnect(f);a.apply(g,[])});this.initialize()}};a.prototype._silentlyEnsureInitializeThen=function(a,f){var g=this;this._isInitialized||this._isInitializing||!navigator.webkitPersistentStorage&&!window.webkitStorageInfo?g._ensureInitializedThen(a):this._queryUsageAndQuota(this._storageTypePersistent,function(b,d){0==b&&0==d?f():g._ensureInitializedThen(a)},function(a){a=g._shapeError(a);
g.app.trace.warning("An error occurred while trying to fetch file API usage information: {0}".format(a.toString()))})};a.prototype._requestFileSystem=function(a,f,g,b){if(window.requestFileSystem)window.requestFileSystem(a,f,g,b);else if(window.webkitRequestFileSystem)window.webkitRequestFileSystem(a,f,g,b);else throw Error("No request filesystem method found");};a.prototype._requestQuota=function(a,f,g,b){var d=navigator,e=window;switch(a){case this._storageTypeTemporary:d.webkitTemporaryStorage&&
d.webkitTemporaryStorage.requestQuota?d.webkitTemporaryStorage.requestQuota(f,g,b):e.webkitStorageInfo&&e.webkitStorageInfo.requestQuota&&e.webkitStorageInfo.requestQuota(window.TEMPORARY,f,g,b);break;case this._storageTypePersistent:d.webkitPersistentStorage&&d.webkitPersistentStorage.requestQuota?d.webkitPersistentStorage.requestQuota(f,g,b):e.webkitStorageInfo&&e.webkitStorageInfo.requestQuota&&e.webkitStorageInfo.requestQuota(window.PERSISTENT,f,g,b)}};a.prototype._queryUsageAndQuota=function(a,
f,g){var b=navigator,d=window;switch(a){case this._storageTypeTemporary:b.webkitTemporaryStorage&&b.webkitTemporaryStorage.queryUsageAndQuota?b.webkitTemporaryStorage.queryUsageAndQuota(f,g):d.webkitStorageInfo&&d.webkitStorageInfo.queryUsageAndQuota&&d.webkitStorageInfo.queryUsageAndQuota(window.TEMPORARY,f,g);break;case this._storageTypePersistent:b.webkitPersistentStorage&&b.webkitPersistentStorage.queryUsageAndQuota?b.webkitPersistentStorage.queryUsageAndQuota(f,g):d.webkitStorageInfo&&d.webkitStorageInfo.queryUsageAndQuota&&
d.webkitStorageInfo.queryUsageAndQuota(window.PERSISTENT,f,g)}};a.prototype._writeValue=function(a,f,g,b,d){function e(a){a=m._shapeError(a);b&&b(a)}function k(f){d?m._filesystem.root.getFile(a+".json",{create:!0,exclusive:!1},f,e):m._filesystem.root.getDirectory(s,{create:!0,exclusive:!1},function(g){m._filesystem.root.getFile(s+"/"+a+".json",{create:!0,exclusive:!1},f,e)},e)}function l(a){a.createWriter(function(a){a.truncate(0)});a.createWriter(function(a){a.onwriteend=function(a){m.app.trace.debug("Wrote {0} bytes to filesystem.".format(a.total))};
a.onerror=function(a){a=m._shapeError(a);m.app.trace.debug("Write failed: {0}".format(a));b&&b(a)};var c=!1;try{var d=!1;"undefined"!==typeof window.cordova&&window.cordova.exec&&(a.write(f),d=!0);if(!d&&"undefined"!==typeof Blob)try{var k=new Blob([f],{type:"text/plain"});a.write(k);d=!0}catch(l){m.app.trace.debug('Failed to create blob "'+l+'". Falling back to BlobBuilder.')}if(!d){d=null;"undefined"!==typeof BlobBuilder?d=new BlobBuilder:"undefined"!==typeof WebKitBlobBuilder?d=new WebKitBlobBuilder:
"undefined"!==typeof MSBlobBuilder&&(d=new MSBlobBuilder);if(!d)throw Error("Error writing to File API file: No BlobBuilder implementation found.");d.append(f);a.write(d.getBlob("text/plain"))}}catch(w){c=!0,e(w)}c||g()})}var m=this,s=d?"":this.keyNamespace;try{k(l)}catch(t){e(t)}};a.prototype._readValue=function(a,f,g,b){function d(a){a.code&&a.code===FileError.NOT_FOUND_ERR?f(null):(a=e._shapeError(a),g&&g(a))}var e=this;e._filesystem.root.getFile((b?"":this.keyNamespace+"/")+a+".json",{},function(a){a.file(function(a){var c=
new FileReader;c.onloadend=function(a){f(this.result)};try{c.readAsText(a)}catch(g){d(g)}},d)},d)};a.prototype._shapeError=function(a){var f="";if(a.hasOwnProperty("code")){switch(a.code){case FileError.QUOTA_EXCEEDED_ERR:f="Quota Exceeded.";break;case FileError.NOT_FOUND_ERR:f="File not found.";break;case FileError.SECURITY_ERR:f="Security error.";break;case FileError.INVALID_MODIFICATION_ERR:f="Invalid modification.";break;case FileError.INVALID_STATE_ERR:f="Invalid state.";break;default:f="Unknown Error."}a=
Error("File error: {0}.".format(f))}return a};a.prototype.clear=function(a,f){function g(a){f&&(a=b._shapeError(a),f(a))}var b=this;this._silentlyEnsureInitializeThen(function(){b._filesystem.root.getDirectory(this.keyNamespace,{create:!1},function(f){f.removeRecursively(function(){a&&a()},g)},function(f){f.code===FileError.NOT_FOUND_ERR?a():g(f)})},a)};a.prototype.clearAllData=function(a,f){var g=this;this._silentlyEnsureInitializeThen(function(){try{var b=g._filesystem.root.createReader(),d=[],
e=0,k=0,l=new dojo.Deferred,m=new dojo.Deferred,s=new dojo.DeferredList([l,m]);s.then(function(g){k?f&&f(Error("{0} errors were encountered while clearing the storage provider.".format(k))):a&&a()});s.addErrback(function(a){f&&(a=g._shapeError(a),f(a))});var t=function(){var a=function(){--e;0>=e&&(l.resolve(),m.resolve())},c=function(a){a=g._shapeError(a);g.app.trace.warning("Error removing local file: {0}.".format(a.toString()));--e;++k;0>=e&&l.resolve()},f=function(f){f.remove(a,c)},b=function(a){a=
g._shapeError(a);g.app.trace.warning("Could not obtain file for removal: {0}.".format(a.toString()));m.errback(a)};e=d.length;if(0===e)l.resolve(),m.resolve();else if(0===d.length)l.resolve(),m.resolve();else for(var h=0;h<d.length;++h)try{g._filesystem.root.getFile(d[h],{},f,b)}catch(n){n=g._shapeError(n),s.errback(n)}},v=function(){},y=function(a){a=g._shapeError(a);g.app.trace.warning("Error removing local folder: {0}.".format(a.toString()));++k;m.resolve()},n=function(){b.readEntries(function(a){if(a.length){for(var c=
0;c<a.length;++c){var f=a[c];f.isDirectory?f.removeRecursively(v,y):d.push(f.fullPath)}n()}else t()},function(a){a=g._shapeError(a);f&&f(a)})};n()}catch(x){x=g._shapeError(x),f&&f(x)}},a)};a.prototype.get=function(a,f,g,b){var d=this;this._silentlyEnsureInitializeThen(function(){try{d._readValue(a,f,g,b)}catch(e){e=d._shapeError(e),g&&g(e)}},function(){f(null)})};a.prototype.set=function(a,f,g,b,d){var e=this;this._ensureInitializedThen(function(){try{e._writeValue(a,f,g,b,d)}catch(k){k=e._shapeError(k),
b&&b(k)}})};a.prototype.remove=function(a,f,g,b){var d=this,e=b?"":this.keyNamespace;this._ensureInitializedThen(function(){try{d._filesystem.root.getFile(e+"/"+a+".json",{create:!1},function(a){a.remove(f,function(a){a=d._shapeError(a);g&&g(a)})},function(a){a=d._shapeError(a);d.app.trace.debug("Could not obtain file for removal: {0}.".format(a.toString()));g&&g(a)})}catch(b){b=d._shapeError(b),g&&g(b)}})};return a}(b.StorageProviderBase);b.FileStorageProvider=e})(b.storage||(b.storage={}))})(b.framework||
(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){var e=function(d){function a(){d.apply(this,arguments);this._isFull=!1}__extends(a,d);a.prototype.initialize=function(){d.prototype.initialize.call(this);this._localStorage=window.localStorage};a.prototype.isSupported=function(){this._localStorage||this.initialize();return!!this._localStorage};a.prototype.isFull=function(){this._localStorage||this.initialize();return this._isFull};a.prototype.getScore=function(){this._localStorage||this.initialize();return 5};
a.prototype.getStats=function(){this._localStorage||this.initialize();return new b.StorageStats};a.prototype.clear=function(c,f){this._localStorage||this.initialize();for(var g=null,b=RegExp("^"+this.keyNamespace+a._namespaceSeperator),d=0,e=this._localStorage.length;d<e;d++){var k=this._localStorage.key(d);if(b.test(k))try{this._localStorage.removeItem(k),d--,e--}catch(l){g=l}}null!=g?f&&f(g):c&&c()};a.prototype.clearAllData=function(a,f){this._localStorage||this.initialize();try{this._localStorage.clear(),
a&&a()}catch(g){f&&f(g)}};a.prototype.get=function(c,f,g,b){c=b?c:"{0}{1}{2}".format(this.keyNamespace,a._namespaceSeperator,c);this._localStorage||this.initialize();try{var d=this._localStorage.getItem(c);f&&f(d)}catch(e){g&&g(e)}};a.prototype.set=function(c,f,g,b,d){c=d?c:"{0}{1}{2}".format(this.keyNamespace,a._namespaceSeperator,c);this._localStorage||this.initialize();try{this._localStorage.setItem(c,f),g&&g()}catch(e){b&&b(e)}};a.prototype.remove=function(c,f,g,b){c=b?c:"{0}{1}{2}".format(this.keyNamespace,
a._namespaceSeperator,c);this._localStorage||this.initialize();try{this._localStorage.removeItem(c),f&&f()}catch(d){g&&g(d)}};a._namespaceSeperator="\u2192";return a}(b.StorageProviderBase);b.LocalStorageProvider=e})(b.storage||(b.storage={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){var e=function(){function d(a,c){this.app=a;this._rootNamespace=this._sanitizeKey(c?c.toString():"framework."+this.app.id)}d.prototype.initialize=function(a){a?this._provider=a:b.HttpStorageProvider.isSupported()?this._provider=new b.HttpStorageProvider(this.app):(a=new b.FileStorageProvider(this.app),a.isSupported()?this._provider=a:this._provider=new b.LocalStorageProvider(this.app));this._provider.keyNamespace=this._rootNamespace};d.prototype.hasProvider=
function(){return null!=this._provider};d.prototype._yield=function(a){return a?function(){var c=arguments;setTimeout(function(){a.apply(this,c)},0)}:function(){}};d.prototype._yieldError=function(a){return a?function(){var c=arguments;setTimeout(function(){a.apply(this,c)},0)}:function(){}};d.prototype._yieldGet=function(a){return a?function(){var c=arguments;setTimeout(function(){a.apply(this,c)},0)}:function(){}};d.prototype.clear=function(a,c){this._provider&&this._provider.clear(this._yield(a),
this._yieldError(c))};d.prototype.clearAllData=function(a,c){this._provider&&this._provider.clearAllData(this._yield(a),this._yieldError(c))};d.prototype._sanitizeKey=function(a){return a.replace(RegExp("[/\\\\:,?=|]","gm"),"_")};d.prototype.set=function(a,c,f,g,b){var d=new dojo.Deferred,e=this._sanitizeKey(a);b=b||!1;this._provider&&this._provider.set(e,c,this._yield(function(){d&&-1==d.fired&&d.resolve(c);f&&f(a,c)}),this._yieldError(function(f){d&&-1==d.fired&&d.resolve(f);g&&g(f,a,c)}),b);return d};
d.prototype.get=function(a,c,f,g){var b=new dojo.Deferred,d=this._sanitizeKey(a);g=g||!1;this._provider&&this._provider.get(d,this._yieldGet(function(f){b&&-1==b.fired&&b.resolve(f);c&&c(f,a)}),this._yieldError(function(c){b&&-1==b.fired&&b.resolve(c);f&&f(c,a)}),g);return b};d.prototype.remove=function(a,c,f,g){var b=new dojo.Deferred,d=this._sanitizeKey(a);g=g||!1;this._provider&&this._provider.remove(d,this._yield(function(){b&&-1==b.fired&&b.resolve(a);c&&c(a)}),this._yieldError(function(c){b&&
-1==b.fired&&b.resolve(c);f&&f(c,a)}),g);return b};return d}();b.Store=e})(b.storage||(b.storage={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));(function(b){(function(b){(function(b){var e=function(){return function(b,a){this.view=b;this.region=a}}();b.ViewDimensionsChangedArgs=e})(b.events||(b.events={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(e){(function(l){var k=function(){return function(){}}();l.ViewManagerRegionEntry=k;var d=function(){function a(a){this._views=[];this._hostedRegions=[];this._pendingRegions=[];this.app=a;this._registerCommands()}a.prototype.shutdown=function(){for(var a=0;a<this._hostedRegions.length;++a)this.destroyRegion(this._hostedRegions[a]);for(var f=this._hostedRegions.length=0;f<this._views.length;++f)this.destroyView(this._views[f]);for(a=this._views.length=0;a<this._pendingRegions.length;++a){for(var g=
this._pendingRegions[a],f=0;f<g.views.length;++f)this.destroyView(g.views[f]);g.views=[]}this._pendingRegions.length=0};a.prototype._registerCommands=function(){this.app.commandRegistry.command("ActivateView").register(this,function(a){var f=this.getViewById(a);f?this.activateView(f):this.app.trace.warning("ActivateView: Could not find view '{0}'.".format(a))});this.app.commandRegistry.command("DeactivateView").register(this,function(a){var f=this.getViewById(a);f?this.deactivateView(f):this.app.trace.warning("DeactivateView: Could not find view '{0}'.".format(a))});
this.app.commandRegistry.command("ToggleView").register(this,function(a){var f=this.getViewById(a);f?this.toggleView(f):this.app.trace.warning("ToggleView: Could not find view '{0}'.".format(a))});this.app.commandRegistry.command("DestroyView").register(this,function(a){var f=this.getViewById(a);f?this.destroyView(f):this.app.trace.warning("DestroyView: Could not find view '{0}'.".format(a))})};a.prototype.activateView=function(a){if(!a.id)return this.app.trace.error("ViewManager: Invalid or nonexistent view passed to activateView."),
!1;var f=this.getRegionForViewId(a.id);if(!f){if(!a.regionName)return this.app.trace.warning("Could not activate view '{0}' - view is not associated with a region.".format(a.id)),!1;if(f=this.getExistingRegionByName(a.regionName))return f.hostView(a),f.activateView(a),!0;(f=this._getPendingRegionEntryByName(a.regionName))?e.utils.ArrayUtils.contains(f.views,a)?this.app.trace.debug("View '{0}' re-added to pending region '{1}'.".format(a.id,a.regionName)):f.views.push(a):(f=new k,f.name=a.regionName,
f.views=[a],this._pendingRegions.push(f));return!1}f.activateView(a);return!0};a.prototype.deactivateView=function(a){if(!a.id)return this.app.trace.error("ViewManager: Invalid or nonexistent view passed to deactivateView."),!1;var f=this.getRegionForViewId(a.id);if(!f)return this.app.trace.debug("Could not find region for view '{0}'.".format(a.id)),!1;f.deactivateView(a);return!0};a.prototype.toggleView=function(a){a.isActive?this.deactivateView(a):this.activateView(a)};a.prototype.createView=function(a){var f=
a.viewId||a.id;if(f&&this.getViewById(f))this.app.trace.error("Could not create view '{0}' - a view with that ID already exists.".format(f));else{var g=a.typeName||a.type||"geocortex.framework.ui.ViewBase",d=null;try{d=this.app.instantiateFrameworkObject(g,a.libraryId)}catch(l){return this.app.trace.error("Could not instantiate view with type '{0}' - type was not found or view constructor failed.".format(g),l),null}g=a.isVisible||a.visible;d.id=null==f?"View-"+b.framework.utils.alphaNumericToken():
f;d.markupResource=a.markupResource||a.markup;d.regionName=a.regionName||a.region;d.configuration=a.configuration||{};d.isManaged=a.isManaged||!1;d.title.set(a.title||"");d.description.set(a.description);d.iconUri.set(a.iconUri);a.viewModel&&(d.viewModel=a.viewModel);this._views.push(d);if(d.regionName)(a=this.getExistingRegionByName(d.regionName))?(a.hostView(d),g&&a.activateView(d)):(g&&(d.___shouldActivate=!0),(a=this._getPendingRegionEntryByName(d.regionName))?e.utils.ArrayUtils.contains(a.views,
d)?this.app.trace.debug("View '{0}' re-added to pending region '{1}'.".format(d.id,d.regionName)):a.views.push(d):(a=new k,a.name=d.regionName,a.views=[d],this._pendingRegions.push(a)));else{a=b.resourceManager.fetch(d.markupResource,d.libraryId);if(null==a)return this.app.trace.warning("Could not fetch markup resource '{0}' in library '{1}'.".format(d.markupResource,d.libraryId)),null;d.root=dojo.create("div");d.root.innerHTML=a;d.root.children&&1===d.root.children.length&&(d.root=d.root.children[0])}return d}};
a.prototype.create=function(a,f,g,b,d){a=new e.config.ViewConfig(null,null,a);a.markupResource=g;a.regionName=b;a.configuration={};g=this.createView(a);if(null===g)return g;b=null;try{b=this.app.instantiateFrameworkObject(f||"geocortex.framework.ui.ViewModelBase",b.libraryId),b.initialize({})}catch(k){return this.app.trace.error("Could not create view model with type '{0}' - type was not found, not a view model, or failed to construct: {1}".format(a.typeName,k.message),k),null}g.attach(b);this.activateView(g);
return g};a.prototype.destroyView=function(a){for(var f=this.getRegionForViewId(a.id),b=window.document.activeElement;b;){if(a.root===b){window.document.activeElement.blur();break}b=b.parentElement}null!=f&&(f.deactivateView(a),f.unhostView(a));a.destroy();if(null!=a.childRegions)for(f=0;f<a.childRegions.length;++f)this.destroyRegion(a.childRegions[f]);a.childRegions.length=0;null!=a.root&&(f=new dojo.NodeList,f.push(a.root),f.orphan());e.utils.ArrayUtils.removeItem(this._views,a);a.onDestroy()};
a.prototype.destroyRegion=function(a){if(null!=a.views)for(var f=a.views.length-1;0<=f;f--)this.destroyView(a.views[f]);e.utils.ArrayUtils.removeItem(this._hostedRegions,a);a.unhost()};a.prototype.discoverRegions=function(a,f){var b=this;null!=a&&dojo.query("[data-region-name]",a).forEach(function(a){var c=dojo.attr(a,"data-region-name");if(b.getExistingRegionByName(c))b.app.trace.error("Region '{0}' already exists.".format(c));else{var d=b._getPendingRegionEntryByName(c),e=null;d&&b._removePendingRegionEntry(c);
var k=dojo.attr(a,"data-region-adapter"),l=null;try{k||(k="geocortex.framework.ui.DivRegionAdapter"),l=dojo.getObject(k,!0),e=new l(c,b.app)}catch(s){return b.app.trace.error("Could not instantiate region with type '{0}' - type was not found.".format(k),s),null}k=dojo.attr(a,"data-region-options");c={};if(k)for(k=k.split(","),l=0;l<k.length;l++){var t=k[l].split("=");c[t[0]]=1<t.length?t[1]:""}e.host(a,c);b._hostedRegions.push(e);null!=f&&(f.childRegions.push(e),e.ownerView=f);if(d)for(a=0;a<d.views.length;++a)c=
d.views[a],b._views.push(c),e.hostView(c),c.___shouldActivate&&(delete c.___shouldActivate,e.activateView(c))}})};a.prototype.getExistingRegionByName=function(a){for(var f=0;f<this._hostedRegions.length;++f){var b=this._hostedRegions[f];if(b.name==a)return b}return null};a.prototype._getPendingRegionEntryByName=function(a){for(var f=0;f<this._pendingRegions.length;++f){var b=this._pendingRegions[f];if(b.name==a)return b}return null};a.prototype._removePendingRegionEntry=function(a){for(var f=-1,b=
0;b<this._pendingRegions.length;++b)if(this._pendingRegions[b].name==a){f=b;break}return-1<b?(e.utils.ArrayUtils.remove(this._pendingRegions,f,f),!0):!1};a.prototype.getRegionForViewId=function(a){for(var f=0;f<this._hostedRegions.length;++f)for(var b=this._hostedRegions[f],d=0;d<b.views.length;++d)if(b.views[d].id===a)return b;return null};a.prototype.getViewById=function(a){for(var f=0;f<this._views.length;++f){var b=this._views[f];if(b.id&&b.id===a)return b}};a.prototype.getViews=function(){return this._views};
a.prototype.notifyDimensionsChanged=function(a){var f=this.getRegionForViewId(a.id);a=new b.framework.events.ViewDimensionsChangedArgs(a,f);this.app.eventRegistry.event("ViewDimensionsChangedEvent").publish(a)};return a}();l.ViewManager=d})(e.ui||(e.ui={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){var e=function(){function b(a){this.app=a}b.prototype._traceImpl=function(a,c,f){("debug"!==a&&"trace"!==a||this.app.debugMode)&&this.app&&this.app.event("TraceEvent").publish({level:a,timestamp:new Date,message:c,stack:f})};b.prototype._stackTraceFromException=function(a){return"undefined"!==typeof a?a.stack||a.backtrace||a.stacktrace:null};b.prototype.debug=function(a){this._traceImpl("debug",a)};b.prototype.trace=function(a){this._traceImpl("trace",a)};b.prototype.info=
function(a){this._traceImpl("info",a)};b.prototype.alert=function(a){this._traceImpl("alert",a)};b.prototype.warning=function(a){this._traceImpl("warning",a)};b.prototype.error=function(a,c){this._traceImpl("error",a,this._stackTraceFromException(c))};b.prototype.exception=function(a,c){this._traceImpl("error",a,this._stackTraceFromException(c))};return b}();b.Trace=e})(b.utils||(b.utils={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(l){var k=function(d){function a(a,b){d.call(this,a,b);this.behaviorNames=[];this.configuration={}}__extends(a,d);a.prototype.initialize=function(a){this.configuration=a;this.behaviorNames=this.app.behaviorRegistry.loadBehaviorsFromConfig(this,a)};a.prototype.onDestroy=function(){d.prototype.onDestroy.call(this);for(var a=0;a<this.behaviorNames.length;a++)this.app.behaviorRegistry.remove(this.behaviorNames[a]);this.behaviorNames.length=0};a.prototype.shutdown=function(a){};
a.prototype.exportState=function(){return new b.SimplePromise(function(a,b){return a(null)})};a.prototype.applyState=function(a){return new b.SimplePromise(function(a,c){return a()})};a.prototype.getStateFilter=function(){return null};return a}(b.FrameworkObject);l.ModuleBase=k})(b.application||(b.application={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){var e=function(){function b(a){this._modules={};this.app=a}b.prototype.shutdown=function(a){for(var c in this._modules)this._modules.hasOwnProperty(c)&&(this._modules[c].shutdown(a),this._modules[c].destroy());this._modules={}};b.prototype.instantiate=function(a,c){return null==a?null:this.app.instantiateFrameworkObject(a,c)};b.prototype.markModuleLoaded=function(a,c){this._modules[a]=c;this.app.event("ModuleInitializedEvent").publish(a)};b.prototype.moduleIsLoaded=
function(a){return null!=this._modules[a]};b.prototype.notifyModuleLoaded=function(a,c){if(this.moduleIsLoaded(a)&&null!=c)c(a);else var b=this.app.event("ModuleInitializedEvent").subscribe(this,function(g){if(g==a)try{c(g)}finally{this.app.event("ModuleInitializedEvent").unsubscribe(b)}})};return b}();b.ModuleManager=e})(b.application||(b.application={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(e){(function(l){var k=function(){function d(a,c,f,g){this.version="2.6";this.allowCrossDomainConfig=!1;this.configuration={};this.localServerAddress="";this.localServerNamespace=this.localServerToken=null;this.urlParameters={};this.allLibrariesLoaded=this.isHttpsMode=this.developmentMode=!1;this.modalRegionSingleton=this.configPreprocessor=null;this._resourceDictionaries={};this.frameworkObjects={};this._pendingFrameworkObjectRequests={};this._initialStateAppliedCount=0;this.id=
f||"default";this.configTokens=g||{};this.trace=new e.utils.Trace(this);this.moduleManager=new b.framework.application.ModuleManager(this);this.commandRegistry=new b.framework.commands.CommandRegistry(this);this.eventRegistry=new b.framework.events.EventRegistry(this);this.behaviorRegistry=new b.framework.behaviors.BehaviorRegistry(this);this.viewManager=new b.framework.ui.ViewManager(this);this.command=dojo.hitch(this.commandRegistry,this.commandRegistry.command);this.event=dojo.hitch(this.eventRegistry,
this.eventRegistry.event);this.behavior=dojo.hitch(this.behaviorRegistry,this.behaviorRegistry.behavior);this.hostElement=c||dojo.body();this.store=new b.framework.storage.Store(this,this.id);this.store.initialize();null==a?this.configModel=new e.config.ConfigurationModel(this):"object"===typeof a?(this.configObject=a,this.configUri=null):(this.configModel=null,this.configUri=a.trim());this.isOffline=new Observable(!1);this.isOffline.bind(this,function(a){a?this.eventRegistry.event("ApplicationOfflineEvent").publish():
this.eventRegistry.event("ApplicationOnlineEvent").publish()});this.isNative=new Observable(!1);this.isNative.bind(this,function(a){a?this.eventRegistry.event("ApplicationNativeReadyEvent").publish():this.eventRegistry.event("ApplicationNativeRemovedEvent").publish()});b.framework.application.ApplicationCommands.createCommands(this);a=document.URL;a=a.substring(a.indexOf("?")+1,a.length);this.urlParameters=dojo.queryToObject(a)||{};a=window.location.protocol;0>a.indexOf(":")&&(a+=":");c=window.location.pathname.lastIndexOf("/");
f="/";-1<c&&(f=window.location.pathname.substr(0,c));""===f&&(f="/");this.host=a+"//"+window.location.host.trim()+f.trim();"/"!==this.host.charAt(this.host.length-1)&&(this.host+="/");this.isHttpsMode=this.isHttpsUri(this.host);this.detectBrowserLocale();b.framework.registerApplication(this)}d.prototype.getLibraryOrder=function(a){if(!this.configModel.libraryConfigs)return null;for(var c=0;c<this.configModel.libraryConfigs.length;++c)if(this.configModel.libraryConfigs[c].id===a)return c;return null};
d.prototype.shouldOmitStylesForLibrary=function(a){if(!this.configModel.libraryConfigs)return null;for(var c=0;c<this.configModel.libraryConfigs.length;++c){var b=this.configModel.libraryConfigs[c];if(b.id===a)return!!b.omitStyles}return!1};d.prototype.translateConfiguration=function(a,c){var b=this,g=function(c,d,e){if("string"===typeof d){if(-1<d.indexOf("@language")){var h=d.split("-");if(2>h.length)throw Error("Invalid language key '{0}'.".format(d));d=h.join("-").replace("@","");return b.getResource(e||
a,d)}return b.performTokenReplacement(d)}if(d instanceof Array){e=[];for(h=0;h<d.length;++h)e.push(g(h,d[h]));return e}if(d instanceof Function)return d;if(d instanceof Object){e={};c=d.hasOwnProperty("libraryId")?d.libraryId:void 0;for(h in d)d.hasOwnProperty(h)&&(e[h]=g(h,d[h],c));return e}return d},d={},e;for(e in c)c.hasOwnProperty(e)&&(d[e]=g(e,c[e]));return d};d.prototype.performTokenReplacement=function(a){var c=this;return a?a.replace(/{.+?}/g,function(a){var b=a.substring(1,a.length-1);a=
c.configTokens.hasOwnProperty(b)?c.configTokens[b]:a;if(!a&&c.configuration&&c.configuration.hasOwnProperty(b))return c.configuration[b];if(a)return a;c.trace.warning("The token syntax \\{{0}\\} was detected, but could not be matched to a valid replacement.".format(b));return""}):a};d.prototype.isHttpsUri=function(a){a=a.trim();return-1<a.indexOf("://")&&5<=a.length&&"https"===a.substring(0,5)};d.prototype.makeAbsolute=function(a,c){if(!(new dojo._Url(a)).host){var b=c?c:"{0}//{1}{2}".format(window.location.protocol,
window.location.host,window.location.pathname);if("/"!=b.charAt(b.length-1)||"\\"!=b.charAt(b.length-1))b=b.split("/"),--b.length,b=b.join("/"),b+="/";if("/"==a.charAt(0)||"\\"==a.charAt(0))b=new dojo._Url(b),a=b.scheme+"://"+b.authority+"/"+a.substring(1);else{for(var d=b.split("/"),b=a?a.split("../"):[],e=0,k=0;k<b.length;++k)""==b[k]&&++e;d=d.slice(0,d.length-(0<e?e+1:e));b=b.slice(0<e?e-1:e);a=d.join("/")+b.join("/")}}return a};d.prototype.getHostElement=function(){return this.hostElement};d.prototype.getResource=
function(a,c,b){b=b||this.locale||"inv";b=b.toLowerCase();if(!this._resourceDictionaries||!this._resourceDictionaries.inv)throw Error("The application is missing its invariant resources.");var d=this._resourceDictionaries[b],e=this._resourceDictionaries.inv;d||(d=e);var k=d[a]||e[a];if(!k)return this.trace.warning("No resource dictionary found for library '{0}' while trying to get resource with key '{1}', using locale '{2}'.".format(a,c,b)),"@"+c;var l=null;if(!k.hasOwnProperty(c)){if(d===e)return"@"+
c;k=e[a];if(!1===k.hasOwnProperty(c))return this.trace.warning("The resource with key '{0}' was not found in library '{1}'.".format(c,a)),"@"+c}l=k[c];return"debug"===b?this._getDebugLocaleString(l):"strings"===b?c:l};d.prototype.getUri=function(a){var c=!1;if(c=0>a.indexOf("://"))return a=this.host+a,this.isHttpsUri(a)!=this.isHttpsMode&&this.trace.warning("Mixing secured and non-secured resources. Request: '{0}'.".format(a)),null==this.proxyUri||String.isNullOrEmpty(this.proxyUri)?a:this.proxyUri+
encodeURIComponent(a);this.isHttpsUri(a)!=this.isHttpsMode&&this.trace.warning("Mixing secured and non-secured resources. Request: '{0}'.".format(a));return this.proxyUri+encodeURIComponent(a)};d.prototype.getUrlParameter=function(a){if(this.urlParameters)for(var c in this.urlParameters)if(this.urlParameters.hasOwnProperty(c)&&!String.isNullOrEmpty(c)&&!String.isNullOrEmpty(a)&&c.toLowerCase()===a.toLowerCase())return this.urlParameters[c];return null};d.prototype.onLibrariesDownloaded=function(a){};
d.prototype.onConfigurationLoaded=function(a){};d.prototype.notifyLibraryDownload=function(a){this.trace.info("Processing downloaded library '{0}' for application '{1}'.".format(a,this.id));this.eventRegistry.event("LibraryDownloadedEvent").publish(a);var c=b.resourceManager.fetchAllFor(a,"json");if(c&&0<c.length)for(var f=0;f<c.length;++f){var d=c[f],e=b.resourceManager.fetch(d.name,d.library,d.locale);this.injectLibraryResources(a,e,d.locale)}this.configModel&&(c=this.configModel.libraryModules[a],
null==c?this.trace.warning("No modules found for library '{0}' in application '{1}'.".format(a,this.id)):(this.initializeModules(c),0<this.pendingLibraryDownloads&&--this.pendingLibraryDownloads,this._doIfNoPendingLibraryDownloads()))};d.prototype.hasLibrary=function(a){return b.framework.hasLibrary(a)&&!!this.configModel.libraryModules[a]&&this._resourceDictionaries.inv&&!!this._resourceDictionaries.inv[a]};d.prototype.registerFrameworkObject=function(a){if(!a.id)throw Error("Could not register framework object. Object was missing an ID.");
this.frameworkObjects[a.id]=a;var c=this._pendingFrameworkObjectRequests[a.id];c&&c.length&&(c.forEach(function(c){return c(a)}),c.length=0,delete this._pendingFrameworkObjectRequests[a.id]);return a};d.prototype.freeAllFrameworkObjects=function(){};d.prototype.getFrameworkObjectById=function(a){for(var c in this.frameworkObjects)if(this.frameworkObjects.hasOwnProperty(c)&&c===a)return this.frameworkObjects[c];return null};d.prototype.getFrameworkObjectByIdAsync=function(a,c,b){a&&dojo.isString(a)&&
c&&dojo.isFunction(c)?(b=this.getFrameworkObjectById(a))?c(b):(this._pendingFrameworkObjectRequests[a]=this._pendingFrameworkObjectRequests[a]||[],this._pendingFrameworkObjectRequests[a].push(c)):b&&dojo.isFunction(b)&&b(Error("Cannot retrieve Framework Object. Object ID or callback unspecified or incorrect."))};d.prototype.initialize=function(){var a=this;dojo.connect(window,"onresize",function(c){a.eventRegistry.event("ApplicationResizedEvent").publish()});dojo.subscribe("ServiceTokenRefreshed",
function(c){a.configuration&&c.serviceUrl===a.configuration.geometryServiceUrl&&(a.configuration.geometryServiceToken=c.token)});var c=new b.framework.config.ConfigurationLoader(this),f=function(c){"string"==typeof c&&(c=JSON.parse(c));a.configPreprocessor&&(a.configPreprocessor(c),a.configPreprocessor=null);var f=new b.framework.config.ConfigurationModel(a);a.onConfigurationLoaded(c);a.abortInitialization||f.parse(c,function(c){return a.processConfiguration(c)})};if(null!=this.configModel)throw Error("Configuration model should not be loaded already");
if(null!=this.configObject)f(this.configObject),this.configObject=null;else if(null!=this.configUri)c.loadConfigurationTree(this.configUri,function(a){return f(a)});else throw Error("No configuration method");this.viewManager.discoverRegions(this.hostElement)};d.prototype.shutdown=function(a){this.eventRegistry.event("ApplicationShutdownEvent").publish(a);this.viewManager.shutdown();this.moduleManager.shutdown(a);this.commandRegistry.clear();this.eventRegistry.clear()};d.prototype._doIfNoPendingLibraryDownloads=
function(){0===this.pendingLibraryDownloads&&(b.resourceManager&&b.resourceManager.performThemeInjection(),this.allLibrariesLoaded=!0,this.eventRegistry.event("ViewerLibrariesDownloadedEvent").publish(this),this.onLibrariesDownloaded(this),0>=this._initialStateAppliedCount&&this.initialStateAppliedCallback&&this.initialStateAppliedCallback(this))};d.prototype.onInitializationComplete=function(){null!=this.initializationCompleteCallback&&void 0!=this.initializationCompleteCallback&&this.initializationCompleteCallback(this)};
d.prototype.detectBrowserLocale=function(){this.locale=navigator.language?navigator.language:navigator.userLanguage?navigator.userLanguage:navigator.browserLanguage?navigator.browserLanguage:"inv"};d.prototype.downloadLibraries=function(a){this.pendingLibraryDownloads=a.libraryConfigs.length;for(var c=0;c<a.libraryConfigs.length;++c){var f=a.libraryConfigs[c];!0===b.framework.hasLibrary(f.id)?this.notifyLibraryDownload(f.id):(b.framework.libraries[f.id]=!1,f.uri&&this.includeScript(f.uri,function(a){},
function(){}))}};d.prototype.injectLibraryResources=function(a,c,b){b=b.toLowerCase();!1===this._resourceDictionaries.hasOwnProperty(b)?(this._resourceDictionaries[b]={},this._resourceDictionaries[b][a]=c):!1===this._resourceDictionaries[b].hasOwnProperty(a)?this._resourceDictionaries[b][a]=c:dojo.mixin(this._resourceDictionaries[b][a],c)};d.prototype.instantiateFrameworkObject=function(a,c){for(var b=a.split("."),d=window,e=0;e<b.length&&"object"===typeof d;e++)d=d[b[e]];b=null;"function"===typeof d&&
(b=new d(this,c));if(!b)try{b=new (dojo.getObject(a))(this,c)}catch(k){this.trace.error("Could not instantiate object of type '{0}': '{1}'".format(a,k),k)}return b};d.prototype.includeScript=function(a,c,b){var d=this;dojo.io.script.get({url:a,preventCache:this.debugMode,load:function(b){try{c&&c(b)}catch(f){d.trace.error("Error while including script '{0}': {1}".format(a,f),f)}},error:function(c){d.trace.error("Error while including script '{0}': {1}".format(a,c),c);0<d.pendingLibraryDownloads&&
d.pendingLibraryDownloads--;d._doIfNoPendingLibraryDownloads();b&&b(c)}})};d.prototype.processConfiguration=function(a){var c=this;this.configuration=a.application||{};this.configModel=a;this.eventRegistry.event("AppConfigLoaded").publish(this.configModel);this.eventRegistry.event("ApplicationConfigLoadedEvent").publish(this.configModel);this.configuration&&this.configuration.locale&&(this.locale=this.configuration.locale);this.urlParameters&&this.getUrlParameter("locale")&&(this.locale=this.getUrlParameter("locale"));
dojo.locale=this.locale;this.pendingLocaleDownloads=a.externalLocaleReferences.length;if(0==this.pendingLocaleDownloads)this.downloadLibraries(a);else for(var b=0;b<a.externalLocaleReferences.length;++b)(function(b){c.fetchConfigResource({url:b.uri,handleAs:"json",load:function(d){try{if(d)if(d.hasOwnProperty("locales"))for(var f in d)d.hasOwnProperty(f)&&c.injectLibraryResources(b.libraryId,d[f],f);else if(b.hasOwnProperty("locale"))c.injectLibraryResources(b.libraryId,d,b.locale);else throw Error("Locale reference missing 'locale' identifier.");
else c.trace.warning("Error loading locale '{0}' for library '{1}' from offline storage.".format(b.locale,b.libraryId))}catch(e){c.trace.error("Error fetching external locale resource {0}: {1}".format(b.uri,e.message),e)}finally{--c.pendingLocaleDownloads,1>c.pendingLocaleDownloads&&c.downloadLibraries(a)}},error:function(d){c.trace.error("Error fetching external locale resource {0}: {1}".format(b.uri,d.message),d);--c.pendingLocaleDownloads;1>c.pendingLocaleDownloads&&c.downloadLibraries(a)}})})(a.externalLocaleReferences[b])};
d.prototype.addNativeReadyFunction=function(a){if("undefined"!==typeof gcxNativeReady)a&&a();else{var c=gcxNativeReadyCallback;gcxNativeReadyCallback=function(){c&&c();a&&a()}}};d.prototype.getInitialState=function(a,c){return new e.SimplePromise(function(a,c){return a(null)})};d.prototype.initializeModules=function(a){for(var c=this,d={},g=0;g<a.length;++g){var e=a[g];if(!this.moduleManager.moduleIsLoaded(e.moduleName)){var k=this.translateConfiguration(e.libraryId,e.configuration),l=this.moduleManager.instantiate(e.moduleType,
e.libraryId);if(null===l)this.trace.error("Could not instantiate module with type '{0}' - type not found or constructor failed.".format(e.moduleType));else{if(l.initialize){this.trace.info("Initializing module '{0}'.".format(e.moduleName));try{l.id="module-{0}-{1}".format(e.libraryId,e.moduleName),l.initialize(k),this.registerFrameworkObject(l),function(a,b){c._initialStateAppliedCount++;c.getInitialState(b.moduleName,b.libraryId).then(function(c){if(c&&"function"===typeof a.applyState)return a.applyState(c)}).then(function(){return c._onInitialStateApplied(b.moduleName)},
function(a){return c._onInitialStateApplied(b.moduleName,a)})}(l,e)}catch(p){this.trace.error("Error initializing module '{0}': {1}.".format(e.moduleName,p.message),p);continue}this.moduleManager.markModuleLoaded(e.moduleName,l);this.trace.debug("Module '{0}' initialized.".format(e.moduleName))}if(e.viewModelConfigs&&0<e.viewModelConfigs.length)for(l=0;l<e.viewModelConfigs.length;++l){var r=e.viewModelConfigs[l];if(d[r.viewModelId])this.trace.error("ViewModel '{0}' already exists in module '{1}'.".format(r.viewModelId,
e.moduleName));else{var m=null;try{m=this.instantiateFrameworkObject(r.typeName,r.libraryId),m.id=r.viewModelId||b.framework.utils.alphaNumericToken(),k=this.translateConfiguration(e.libraryId,r.configuration),m.initialize(k),d[r.viewModelId]=m,this.registerFrameworkObject(m)}catch(s){this.trace.error("Could not create view model with type '{0}' - type was not found, not a view model, or failed to construct: {1}".format(r.typeName,s.message),s)}}}}}}for(g=0;g<a.length;++g)if(e=a[g],e.viewConfigs)for(l=
0;l<e.viewConfigs.length;++l)k=e.viewConfigs[l],this.getFrameworkObjectById(k.viewId)||(k=this.translateConfiguration(e.libraryId,k),r=null,k.viewModelId?(r=d[k.viewModelId])?r.libraryId=r.libraryId||e.libraryId:this.trace.error("Could not attach view model '{0}' to view '{1}' - view model not found.".format(k.viewModelId,k.viewId)):r=new b.framework.ui.ViewModelBase(this,e.libraryId),k.viewModel=r,(r=this.viewManager.createView(k))?this.registerFrameworkObject(r):this.trace.warning("Could not instantiate view with type '{0}'.".format(k.typeName)));
this.initializationCompleteCallback&&(this.onInitializationComplete(),this.initializationCompleteCallback=null)};d.prototype._onInitialStateApplied=function(a,c){this._initialStateAppliedCount--;c&&this.trace.error('Error setting initial state for module "{0}": {1}'.format(a,c.message),c);this.allLibrariesLoaded&&0>=this._initialStateAppliedCount&&this.initialStateAppliedCallback&&this.initialStateAppliedCallback(this)};d.prototype.fetchConfigResource=function(a){var c=document.createElement("a");
try{c.href=a.url;c.style.display="none";document.body.appendChild(c);var d=b._configDomains;if(!c.hostname||["protocol","hostname"].every(function(a){return c[a]===window.location[a]})||d&&!0==d[c.protocol+"//"+c.hostname])return dojo.xhrGet(a);var e=Error("Could not load viewer because the specified configuration file is not on the same domain as the viewer ({0}).".format(a.url));e.name="ConfigurationDomainMismatch";throw e;}finally{document.body.removeChild(c)}};d.prototype._getDebugLocaleString=
function(a){for(var c=[9728,9983],b=[],d=0;d<a.length;++d)b.push(Math.floor(Math.random()*(c[1]-c[0]))+c[0]);return String.fromCharCode.apply(String,b)};return d}();l.Application=k})(e.application||(e.application={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(e){(function(e){var k=function(){function d(){this.resources=[];this.cachedResources={};this.themesToInject=[]}d.prototype.fetch=function(a,c,d){d=d||"inv";var e="{0}-{1}-{2}".format(c,d,a);if(this.cachedResources.hasOwnProperty(e))return this.cachedResources[e];a=this.findResource(a,c,d);if(!a)return null;c=null;switch(a.format){case "css":case "html":c=b.framework.utils.base64Decode(a.data);this.cachedResources[e]=c;break;case "json":c=b.framework.utils.base64Decode(a.data);
c=JSON.parse(c);this.cachedResources[e]=c;break;default:return null}return c};d.prototype.fetchAllFor=function(a,c){for(var b=[],d=0;d<this.resources.length;++d){var e=this.resources[d];e.library!=a||null!=c&&e.format!=c||b.push(e)}return b};d.prototype.register=function(a,c,b,d,e){if(!this.findResource(b,a)){var k={};k.name=b;k.library=a;k.locale=c;k.format=d;k.data=e;this.resources.push(k)}};d.prototype.remove=function(a,c,b){var d=this.findResource(c,a,b);return null!=d?(Array.removeItem(this.resources,
d),a="{0}-{1}-{2}".format(a,b,c),this.cachedResources.hasOwnProperty(a)&&delete this.cachedResources[a],!0):!1};d.prototype.injectTheme=function(a){this.themesToInject.push(a)};d.prototype.performThemeInjection=function(){for(var a=dojo.query("head")[0],c=0;c<this.themesToInject.length;++c){var b=dojo.create("link",{rel:"stylesheet",href:this.themesToInject[c]});dojo.place(b,a,"last")}};d.prototype.findResource=function(a,c,b){b=b||"inv";for(var d=0;d<this.resources.length;++d){var e=this.resources[d];
if(e.name==a&&(null==c||e.library==c)&&e.locale==b)return e}return null};return d}();e.ResourceManager=k})(e.application||(e.application={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));(function(b){b.resourceManager=new b.framework.application.ResourceManager})(geocortex||(geocortex={}));
(function(b){(function(e){e.applications=[];e.libraries={};e.injectedStyleBlocks=[];e.initialized=!1;e.registerApplication=function(e){b.framework.applications.push(e)};e.hasLibrary=function(e){return!0===b.framework.libraries[e]};e.notifyLibraryDownload=function(e){if(!b.framework.hasLibrary(e)){b.framework.libraries[e]=!0;for(var k=0,d=!0,a=0;a<b.framework.applications.length;++a){var c=b.framework.applications[a],f=c.getLibraryOrder(e);!0===c.shouldOmitStylesForLibrary(e)&&(d=!1);if(f){k=f+32*
a;break}}if(d){(a=b.resourceManager.fetchAllFor(e,"css"))||(a=[]);d="";c=dojo.query("head")[0];for(f=0;f<a.length;++f){var g=a[f];(g=b.resourceManager.fetch(g.name,g.library))&&(d+=g+" ")}a=document.createElement("style");b.framework.injectedStyleBlocks.push(a);a.setAttribute("type","text/css");dojo.attr(a,"data-block-order",k);if(0===k)dojo.place(a,c,"first");else if(f=dojo.query("head style[data-block-order]"),0===f.length)dojo.place(a,c,"first");else{for(var c=null,g=!1,h=0;h<f.length;++h){var w=
f[h];if((dojo.attr(w,"data-block-order")||0)>=k){dojo.place(a,w,"before");g=!0;break}else c=w}g||dojo.place(a,c,"after")}a.styleSheet?a.styleSheet.cssText=d:(k=document.createTextNode(d),a.appendChild(k))}for(a=0;a<b.framework.applications.length;++a)c=b.framework.applications[a],c.notifyLibraryDownload(e)}};e.initialize=function(){b.framework.initialized||(b.utils=b.framework.utils,b.framework.initialized=!0)}})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));geocortex.framework.initialize();
(function(b){(function(e){(function(l){var k=function(d){function a(a,b){d.call(this,a,b)}__extends(a,d);a.prototype.unhostAllViews=function(){for(var a=0;a<this.views.length;++a)this.unhostView(this.views[a]);this.views.length=0};a.prototype.hostView=function(a){this.unhostAllViews();this.views.push(a);if(null==a.root){var e=b.resourceManager.fetch(a.markupResource,a.libraryId);if(null===e)return this.app.trace.warning("Could not fetch markup resource '{0}' in library '{1}'.".format(a.markupResource,
a.libraryId)),!1;a.root=dojo.create("div",{className:"view {0}".format(a.id)});a.root.innerHTML=e;dojo.place(a.root,this.domElement,"last");a.viewModel&&a.attach(a.viewModel);this.app.viewManager.discoverRegions(a.root,a)}else dojo.place(a.root,this.domElement,"only");d.prototype.hostView.call(this,a);return!0};a.prototype.unhostView=function(a){this.deactivateView(a);e.utils.ArrayUtils.removeItem(this.views,a);var b=new dojo.NodeList;b.push(a.root);b.orphan();d.prototype.unhostView.call(this,a)};
return a}(l.RegionAdapterBase);l.DivRegionAdapter=k})(e.ui||(e.ui={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(e){(function(l){var k=function(d){function a(a,b){d.call(this,a,b);this.activeViews=[];this.activateViewsInLastPosition=!0}__extends(a,d);a.prototype.host=function(a,b){d.prototype.host.call(this,a,b);"false"===this.options.activateViewsInLastPosition&&(this.activateViewsInLastPosition=!1)};a.prototype.activateView=function(a){e.utils.ArrayUtils.contains(this.activeViews,a)&&e.utils.ArrayUtils.removeItem(this.activeViews,a);this.activeViews.push(a);this.activateViewsInLastPosition&&
dojo.place(a.root,this.domElement,"last");d.prototype.activateView.call(this,a)};a.prototype.deactivateView=function(a){a.isActive=!1;e.utils.ArrayUtils.removeItem(this.activeViews,a);0<this.activeViews.length&&this.activateView(this.activeViews[this.activeViews.length-1]);d.prototype.deactivateView.call(this,a)};a.prototype.hostView=function(a){this.views.push(a);if(null==a.root){var e=b.resourceManager.fetch(a.markupResource,a.libraryId);if(null==e)return this.app.trace.warning("Could not fetch markup resource '{0}' in library '{1}'.".format(a.markupResource,
a.libraryId)),!1;var g=this.getHostedTagName();a.root=dojo.create(g,{className:"view {0}".format(a.id)});a.root.innerHTML=e;dojo.place(a.root,this.domElement,"last");a.viewModel&&a.attach(a.viewModel);this.app.viewManager.discoverRegions(a.root,a)}else dojo.place(a.root,this.domElement,"last");d.prototype.hostView.call(this,a);return!0};a.prototype.unhostView=function(a){this.deactivateView(a);e.utils.ArrayUtils.removeItem(this.views,a);e.utils.ArrayUtils.removeItem(this.activeViews,a);var b=new dojo.NodeList;
b.push(a.root);b.orphan();d.prototype.unhostView.call(this,a)};a.prototype.getHostedTagName=function(){return this.options&&this.options.tagName?this.options.tagName:"div"};return a}(l.RegionAdapterBase);l.DivStackRegionAdapter=k})(e.ui||(e.ui={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(e){(function(l){var k=function(d){function a(){d.apply(this,arguments)}__extends(a,d);a.prototype.activateView=function(a){this.hideAllViews();if(0<this.activeViews.length){var b=this.activeViews[this.activeViews.length-1];b!==a&&(this.cancelActivate(b),b.deactivated())}d.prototype.activateView.call(this,a)};a.prototype.deactivateView=function(a,b){if(void 0===b||null===b)b=!0;d.prototype.deactivateView.call(this,a);b&&0<this.activeViews.length&&this.activateView(this.activeViews[this.activeViews.length-
1])};a.prototype.hideAllViews=function(){dojo.query("> .view",this.domElement).removeClass("active");dojo.query("> .view",this.domElement).addClass("inactive")};a.prototype.hostView=function(a){this.views.push(a);if(null==a.root){var e=b.resourceManager.fetch(a.markupResource,a.libraryId);if(null==e)return this.app.trace.warning("Could not fetch markup resource '{0}' in library '{1}'.".format(a.markupResource,a.libraryId)),!1;var g=this.getHostedTagName();a.root=dojo.create(g,{className:"view {0}".format(a.id)});
a.root.innerHTML=e;dojo.place(a.root,this.domElement,"last");a.viewModel&&a.attach(a.viewModel);this.app.viewManager.discoverRegions(a.root,a)}else dojo.place(a.root,this.domElement,"last");d.prototype.hostView.call(this,a);return!0};a.prototype.getHostedTagName=function(){return this.options&&this.options.tagName?this.options.tagName:"div"};a.prototype.unhostView=function(a){this.deactivateView(a);e.utils.ArrayUtils.removeItem(this.views,a);e.utils.ArrayUtils.removeItem(this.activeViews,a);var b=
new dojo.NodeList;b.push(a.root);b.orphan();d.prototype.unhostView.call(this,a)};return a}(l.RegionAdapterBase);l.MultiViewRegionAdapter=k})(e.ui||(e.ui={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){var e=function(b){function a(){b.apply(this,arguments)}__extends(a,b);a.prototype.getHostedTagName=function(){return"div"};return a}(b.MultiViewRegionAdapter);b.MultiDivRegionAdapter=e})(b.ui||(b.ui={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){(function(b){function d(){null===c&&(c=(new Date).getTimezoneOffset());return c}var a=/(Z|([+-][012]\d(:?\d\d)?))\s*$/;b.containsTimezone=function(c){return a.test(c)};var c=null,e=null;b.getTimezoneOffset=d;b.getTimezoneString=function(){if(null==e){var a=d(),c=Math.floor(a/60),a=Math.floor(a-60*c);if(0==c&&0==a)return"Z";0>c?(c*=-1,e="+"):e="-";e=0==c?e+"00":10>c?e+("0"+c):e+c;e=0==a?e+":00":10>a?e+(":0"+a):e+(":"+a)}return e};(function(){var a=new Date("2011-06-02T09:34:29+02:00");
Date.fromISO=a&&1307000069E3===+a?function(a){return new Date(a)}:function(a){var c,b=/^(\d{4}\-\d\d\-\d\d([tT ][\d:\.]*)?)([zZ]|([+\-])(\d\d):(\d\d))?$/.exec(a)||[];if(b[1]){a=b[1].split(/\D/);c=0;for(var d=a.length;c<d;c++)a[c]=parseInt(a[c],10)||0;a[1]-=1;a=new Date(Date.UTC.apply(Date,a));if(!a.getDate())return NaN;b[5]&&(c=60*parseInt(b[5],10),b[6]&&(c+=parseInt(b[6],10)),"+"==b[4]&&(c*=-1),c&&a.setUTCMinutes(a.getUTCMinutes()+c));return a}return NaN}})();Date.prototype.toISOString||function(){function a(c){c=
String(c);1===c.length&&(c="0"+c);return c}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1E3).toFixed(3)).slice(2,5)+"Z"}}()})(b.DateUtils||(b.DateUtils={}))})(b.utils||(b.utils={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){var e=function(){function b(a,c,d){this.delayMS=0;this.func=null;this.delayMS=a;this.func=d?function(){c.apply(d)}:c}b.prototype.start=function(){this._timerHandle=setTimeout(this.func,this.delayMS)};b.prototype.stop=function(){clearTimeout(this._timerHandle)};b.prototype.reset=function(){this.stop();this.start()};return b}();b.TimeDelayedAction=e})(b.utils||(b.utils={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){var l=function(){function b(d){var a=this;this._state=b.PENDING;this._value=null;this._handlers=[];this._doResolve(d,function(c){return a._resolve(c)},function(c){return a._reject(c)})}b.resolve=function(d){return b._getThen(d)?d:new b(function(a,c){a(d)})};b.reject=function(d){return new b(function(a,c){c(d)})};b.all=function(d){return b.resolve(d).then(function(a){if(!Array.isArray(a))throw Error("SimplePromise.all: expecting an array or a thenable.");var c=a.length,d=
[];return new b(function(e,h){a.forEach(function(a,l){b.resolve(a).then(function(a){d[l]=a;0===--c&&e(d)},h)})})})};b.prototype.then=function(d,a){var c=this;return new b(function(b,e){return c._done(function(a){if("function"===typeof d)try{return b(d(a))}catch(c){return e(c)}else return b(a)},function(c){if("function"===typeof a)try{return b(a(c))}catch(d){return e(d)}else return e(c)})})};b.prototype._fulfill=function(d){var a=this;this._state=b.FULFILLED;this._value=d;this._handlers.forEach(function(c){return a._handle(c)});
this._handlers=[]};b.prototype._reject=function(d){var a=this;this._state=b.REJECTED;this._value=d;this._handlers.forEach(function(c){return a._handle(c)});this._handlers=[]};b.prototype._resolve=function(d){var a=this;try{var c=b._getThen(d);c?this._doResolve(c.bind(d),function(c){return a._resolve(c)},function(c){return a._reject(c)}):this._fulfill(d)}catch(e){this._reject(e)}};b._getThen=function(b){var a=typeof b;return!b||"object"!==a&&"function"!==a||(b=b.then,"function"!==typeof b)?null:b};
b.prototype._doResolve=function(b,a,c){var e=!1;try{b(function(c){e||(e=!0,a(c))},function(a){e||(e=!0,c(a))})}catch(g){e||(e=!0,c(g))}};b.prototype._handle=function(d){if(this._state===b.PENDING)this._handlers.push(d);else{if(this._state===b.FULFILLED&&"function"===typeof d.onFulfilled)d.onFulfilled(this._value);if(this._state===b.REJECTED&&"function"===typeof d.onRejected)d.onRejected(this._value)}};b.prototype._done=function(b,a){var c=this;setTimeout(function(){c._handle({onFulfilled:b,onRejected:a})},
0)};b.PENDING=0;b.FULFILLED=1;b.REJECTED=2;return b}();b.SimplePromise=l})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){var e=function(b){function a(a){b.call(this,a);this.fileStorageEndpoint="/filesystem";this._initialized=!1;this.localServerAddress=this.app.localServerAddress?this.app.localServerAddress:"http://127.0.0.1:8181"}__extends(a,b);a.prototype.initialize=function(){if(!this._initialized){!window.require.has("esri-cors")&&window.Modernizr.cors&&(delete window.require.has.cache["esri-cors"],window.require.has.add("esri-cors",function(){return!0}));var a=this.localServerAddress.replace("http://",
"");window.esri.config.defaults.io.corsEnabledServers.push(a);this._initialized=!0}};a.isSupported=function(){var a=navigator.userAgent.match(/GeocortexApp[^\/]*\/(\d+.\d+)/);return a&&1.1<=parseFloat(a[1])?!0:!1};a.prototype.fileStorageRequest=function(a,b,d,e,k){this.initialize();b={url:this.localServerAddress+this.fileStorageEndpoint+"/"+b,headers:{Authorization:"Token "+this.app.localServerToken},load:function(a){d(a)},error:function(a){a&&a.status&&404===a.status?d(null):e(a)},failOk:!0};k&&
(b.putData=k);dojo.xhr(a,b)};a.prototype.clear=function(a,b){this.fileStorageRequest("DELETE",this.keyNamespace+"/",a,b)};a.prototype.clearAllData=function(a,b){this.fileStorageRequest("DELETE","",a,b)};a.prototype.get=function(a,b,d,e){this.fileStorageRequest("GET",e?"0/"+a:this.keyNamespace+"/"+a,b,d)};a.prototype.set=function(a,b,d,e,k){this.fileStorageRequest("PUT",k?"0/"+a:this.keyNamespace+"/"+a,d,e,b)};a.prototype.remove=function(a,b,d,e){this.fileStorageRequest("DELETE",e?"0/"+a:this.keyNamespace+
"/"+a,b,d)};return a}(b.StorageProviderBase);b.HttpStorageProvider=e})(b.storage||(b.storage={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){b.DateFormatters={d:function(a){return a.getDate()+""},dd:function(a){return e(a.getDate(),2)},f:function(a){return d(a.getMilliseconds()/1E3,1,!1)},ff:function(a){return d(a.getMilliseconds()/1E3,2,!1)},fff:function(a){return d(a.getMilliseconds()/1E3,3,!1)},ffff:function(a){return d(a.getMilliseconds()/1E3,4,!1)},fffff:function(a){return d(a.getMilliseconds()/1E3,5,!1)},ffffff:function(a){return d(a.getMilliseconds()/1E3,6,!1)},fffffff:function(a){return d(a.getMilliseconds()/
1E3,7,!1)},F:function(a){return d(a.getMilliseconds()/1E3,1,!0)},FF:function(a){return d(a.getMilliseconds()/1E3,2,!0)},FFF:function(a){return d(a.getMilliseconds()/1E3,3,!0)},FFFF:function(a){return d(a.getMilliseconds()/1E3,4,!0)},FFFFF:function(a){return d(a.getMilliseconds()/1E3,5,!0)},FFFFFF:function(a){return d(a.getMilliseconds()/1E3,6,!0)},FFFFFFF:function(a){return d(a.getMilliseconds()/1E3,7,!0)},h:function(a){a=a.getHours();12<a&&(a-=12);return e(a,1)},hh:function(a){a=a.getHours();12<
a&&(a-=12);return e(a,2)},H:function(a){return e(a.getHours(),1)},HH:function(a){return e(a.getHours(),2)},m:function(a){return e(a.getMinutes(),1)},mm:function(a){return e(a.getMinutes(),2)},M:function(a){return e(a.getMonth()+1,1)},MM:function(a){return e(a.getMonth()+1,2)},s:function(a){return e(a.getSeconds(),1)},ss:function(a){return e(a.getSeconds(),2)},y:function(a){return e(a.getFullYear(),1)},yy:function(a){return e(a.getFullYear(),2)},yyy:function(a){return e(a.getFullYear(),3)},yyyy:function(a){return e(a.getFullYear(),
4)},yyyyy:function(a){return e(a.getFullYear(),5)}};var e=function(a,b){a+="";for(var d=b-a.length,e=[];e.length<d;)e.push("0");return e.join("")+a},d=function(a,b,d){a=Math.floor(a*Math.pow(10,b));b=e(a,b);d?(d=b+"",d=d.replace(/0*$/g,"")):d=b;return d}})(b.utils||(b.utils={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){var e=function(){function b(a,c,d,e,h){this.item5=this.item4=this.item3=this.item2=this.item1=null;this.item1=a;this.item2=c;null!=d&&"undefined"!==typeof d&&(this.item3=d);null!=e&&"undefined"!==typeof e&&(this.item4=e);null!=h&&"undefined"!==typeof h&&(this.item5=h)}b.equals=function(a,b){return null===a?null===b:a.item1!==b.item1||a.item2!==b.item2||a.item3!==b.item3||a.item4!==b.item4||a.item5!==b.item5?!1:!0};b.compare=function(a,b){var d=function(a,b){return null===
a?null===b?0:-1:a===b?0:a>b?1:-1};return d(a.item1,b.item1)||d(a.item2,b.item2)||d(a.item3,b.item3)||d(a.item4,b.item4)||d(a.item5,b.item5)};return b}();b.Tuple=e})(b.utils||(b.utils={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
