/*
	
	Copyright (c) 2016, Latitude Geographics Group Ltd.
	All rights reserved.
	       
	Redistribution is not permitted. 
	
	Use in binary form, without modification, is permitted provided that neither 
	the name of the organization nor the names of its contributors may be used 
	to endorse or promote products derived from this software without specific 
	prior written permission.
	       
	THIS SOFTWARE IS PROVIDED BY COPYRIGHT HOLDER ''AS IS'' AND ANY
	EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
	WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
	DISCLAIMED. IN NO EVENT SHALL LATITUDE GEOGRAPHICS GROUP LTD. BE LIABLE FOR ANY
	DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
	(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
	LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
	ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
	(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
	SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/

var __extends=this&&this.__extends||function(b,e){function l(){this.constructor=b}for(var h in e)e.hasOwnProperty(h)&&(b[h]=e[h]);b.prototype=null===e?Object.create(e):(l.prototype=e.prototype,new l)},geocortex;
(function(b){(function(e){(function(e){var b=function(){function d(a,c,k,f){this.app=a;this.name=c;this.event=f;this.commands=k||[];this._wireUpEvent()}d.prototype.run=function(a){this._executeCommands(a)};d.prototype._wireUpEvent=function(){var a=this;this.event&&(this.eventToken=this.app.event(this.event).subscribe(this,function(c){a._executeCommands(c)}))};d.prototype._executeCommands=function(a){for(var c=0;this.commands&&c<this.commands.length;c++)this.app.command(this.commands[c]).execute(a)};
d.prototype.destroy=function(){this.event&&this.app.event(this.event).unsubscribe(this.eventToken);this.commands=null};return d}();e.Behavior=b})(e.behaviors||(e.behaviors={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(e){(function(b){var h=function(){function d(a){this.behaviors={};this.dummyBehavior=new b.Behavior(null,null,null);this.app=a}d.prototype.loadBehaviorsFromConfig=function(a,c){var k=[];if(!(a instanceof e.application.ModuleBase))return this.app.trace.warning("Attempted to add behaviors to registry outside of ModuleBase. Behaviors from "+a.id+" not added."),k;if(c&&c.behaviors)for(var f=0;f<c.behaviors.length;f++){var g=c.behaviors[f];k.push(g.name);this.addBehavior(g.name,g.commands,
g.event)}return k};d.prototype.addBehavior=function(a,c,k){c?(this.behaviors[a]&&this.app.trace.warning("Behavior "+a+" is already present in registry."),a||this.app.trace.warning("Attempted to add a nameless Behavior to the registry."),c=new b.Behavior(this.app,a,c,k),this.behaviors[a]=c):this.app.trace.debug("Behavior "+a+" does not possess an array of command IDs. Not added to registry.")};d.prototype.remove=function(a){if(!this.behaviors[a])return this.app.trace.debug("Attempted to remove behavior not in found in registry."),
!1;var c=this.behaviors[a];delete this.behaviors[a];c.destroy();return!0};d.prototype.behavior=function(a){var c=null;void 0!==this.behaviors[a]?c=this.behaviors[a]:(c=this.dummyBehavior,this.app.trace.debug("Could not find Behavior named "+a+" in the Behavior Registry."));return c};return d}();b.BehaviorRegistry=h})(e.behaviors||(e.behaviors={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(e){var b=function(){function e(d,a){this.dojoConnects=[];this.observableBindings=[];this.eventSubscriptions=[];this.commandHandlers=[];this.app=d;this.libraryId=a}e.prototype.auto=function(d,a,c){if(3===arguments.length&&"string"===typeof a)this.dojoConnects.push(dojo.connect(d,a,c));else if(2===arguments.length&&a instanceof Function){var k=d.bind(d,a);this.observableBindings.push({obj:d,token:k})}else 3===arguments.length&&c instanceof Function&&(k=d.bind(a,c),this.observableBindings.push({obj:d,
token:k}))};e.prototype.trackSubscription=function(d,a){this.eventSubscriptions.push({event:d,token:a})};e.prototype.trackCommandHandler=function(d,a){this.commandHandlers.push({command:d,token:a})};e.prototype.onDestroy=function(){};e.prototype.destroy=function(){for(var d=0;d<this.dojoConnects.length;++d)dojo.disconnect(this.dojoConnects[d]);this.dojoConnects=[];for(d=0;d<this.observableBindings.length;++d){var a=this.observableBindings[d].token;this.observableBindings[d].obj.unbind(a)}this.observableBindings=
[];for(d=0;d<this.eventSubscriptions.length;++d){var c=this.eventSubscriptions[d].event,a=this.eventSubscriptions[d].token;c.unsubscribe(a)}this.eventSubscriptions=[];for(d=0;d<this.commandHandlers.length;++d)c=this.commandHandlers[d].command,a=this.commandHandlers[d].token,c.unregister(a);this.commandHandlers=[];this.onDestroy()};e.prototype.getResource=function(d,a){return this.app.getResource(this.libraryId,d,a)};return e}();e.FrameworkObject=b})(b.framework||(b.framework={}))})(geocortex||(geocortex=
{}));(function(b){(function(e){(function(e){var b=function(){return function(){this.sender=null;this.type="append";this.rangeEnd=this.rangeStart=0}}();e.CollectionChangedArgs=b})(e.events||(e.events={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
if(!String.prototype.format){var dateFormats="d{1,4}|f{1,7}|F{1,7}|g{1,2}|h{1,2}|H{1,2}|K|m{1,2}|M{1,4}|s{1,2}|t{1,2}|y{1,5}|z{1,3}|:|\\/",uberDateRegexPattern="("+dateFormats+"|[^"+dateFormats+"])",uberDateRegex=RegExp(uberDateRegexPattern,"g"),openBraceTempToken="\x00MAGIC\x00";String.prototype.format=function(){var b=arguments,e=this.replace(/{{/g,openBraceTempToken),e=e.replace(/{(\d+)(?::([^}]*))?}/g,function(e,h,d){e=b[h];if(!(d&&e instanceof Date))return e;d=d.match(uberDateRegex);h=[];for(var a=
0;a<d.length;a++){var c=d[a],k=geocortex.framework.utils.DateFormatters[c];k&&(c=k.call(this,e));h.push(c)}return h.join("")});return e.replace(RegExp(openBraceTempToken,"g"),"{").replace(/}}/g,"}")}}String.format=function(b){for(var e=[],l=1;l<arguments.length;l++)e[l-1]=arguments[l];return b.format.apply(b,e)};String.quickHashCode=function(b){var e=0,l,h;if(0==b.length)return e;for(l=0;l<b.length;l++)h=b.charCodeAt(l),e=(e<<5)-e+h,e&=e;return e};
String.escapeHtml=function(b){return null===b||void 0===b?b:b.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};String.unescapeHtml=function(b){return null===b||void 0===b?b:b.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&#x2F;/g,"/")};
String.escapeHtmlEncode=function(b){var e=document.createElement("div");e.appendChild(document.createTextNode(b));return e.innerHTML};String.isNullOrEmpty=function(b){return"undefined"===typeof b||null===b||0===b.length};String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};String.prototype.ltrim=function(){return this.replace(/^\s+/,"")};String.prototype.rtrim=function(){return this.replace(/\s+$/,"")};String.prototype.startsWith=function(b,e){e=e||0;return this.indexOf(b,e)===e};
String.prototype.endsWith=function(b,e){e=e||this.length;e-=b.length;var l=this.lastIndexOf(b);return-1!==l&&l===e};
(function(b){(function(e){(function(e){function b(a){return"undefined"===typeof a?!1:!0}function d(a){return null===a||!b(a)}e.base64keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e.isDefined=b;e.isNullOrUndefined=d;e.makeUrlAbsolute=function(a){if(0===a.indexOf("http"))return a;var c="{0}//{1}{2}".format(window.location.protocol,window.location.host,window.location.pathname);if("/"!=c.charAt(c.length-1)||"\\"!=c.charAt(c.length-1))c=c.split("/"),--c.length,c=c.join("/"),
c+="/";return a="/"===a.charAt(0)||"\\"===a.charAt(0)?window.location.protocol+"//"+window.location.host+"/"+a.substring(1):c+a};e.alphaNumericToken=function(a){a=a||8;for(var c="",k=0;k<a;k++)var f=Math.floor(61*Math.random()),c=c+"0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".substring(f,f+1);return c};e.base64Encode=function(a){var c="",k,f,g,d,e,b,l=0;for(a=this.utf8Encode(a);l<a.length;)k=a.charCodeAt(l++),f=a.charCodeAt(l++),g=a.charCodeAt(l++),d=k>>2,k=(k&3)<<4|f>>4,e=(f&15)<<
2|g>>6,b=g&63,isNaN(f)?e=b=64:isNaN(g)&&(b=64),c=c+this.base64keyStr.charAt(d)+this.base64keyStr.charAt(k)+this.base64keyStr.charAt(e)+this.base64keyStr.charAt(b);return c};e.base64Decode=function(a){var c="";if(!a||""===a)return c;var k,f,g,d,e,b=0;if(/[^A-Za-z0-9\+\/\=]/g.exec(a))throw Error("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding.");a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");do k=this.base64keyStr.indexOf(a.charAt(b++)),
f=this.base64keyStr.indexOf(a.charAt(b++)),d=this.base64keyStr.indexOf(a.charAt(b++)),e=this.base64keyStr.indexOf(a.charAt(b++)),k=k<<2|f>>4,f=(f&15)<<4|d>>2,g=(d&3)<<6|e,c+=String.fromCharCode(k),64!=d&&(c+=String.fromCharCode(f)),64!=e&&(c+=String.fromCharCode(g));while(b<a.length);return c=this.utf8Decode(c)};e.utf8Encode=function(a){a=a.replace(/\r\n/g,"\n");for(var c="",k=0;k<a.length;k++){var f=a.charCodeAt(k);128>f?c+=String.fromCharCode(f):(127<f&&2048>f?c+=String.fromCharCode(f>>6|192):(c+=
String.fromCharCode(f>>12|224),c+=String.fromCharCode(f>>6&63|128)),c+=String.fromCharCode(f&63|128))}return c};e.utf8Decode=function(a){for(var c="",k=0,f=0,g=0,d=0;k<a.length;)f=a.charCodeAt(k),128>f?(c+=String.fromCharCode(f),k++):191<f&&224>f?(g=a.charCodeAt(k+1),c+=String.fromCharCode((f&31)<<6|g&63),k+=2):(g=a.charCodeAt(k+1),d=a.charCodeAt(k+2),c+=String.fromCharCode((f&15)<<12|(g&63)<<6|d&63),k+=3);return c};e.isUrl=function(a){if(!a||"string"!==typeof a)return!1;a=a.trim().toLowerCase();
return 7<=a.length&&0===a.indexOf("http://")||8<=a.length&&0===a.indexOf("https://")?!0:!1};e.isPercentage=function(a){return d(a)?!1:/^(\d+|\d*[.]\d+)%$/.test(a)};e.clamp=function(a,c,k){return a<c?c:a>k?k:a};e.addEventListener=function(a,c,k){a.addEventListener?a.addEventListener(c,k,!1):a.attachEvent&&a.attachEvent("on"+c,k)}})(e.utils||(e.utils={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(e){(function(e){var h=function(){return function(a,c){this.handler=a;this.scope=c;this.once=!1}}(),d=function(){function a(c,k){this.app=null;this.isPublishing=!1;this.subscriptions={};this.name=c;this.app=k}a.prototype.getSubscriptionHandlerByToken=function(c){return this.subscriptions.hasOwnProperty(c)?this.subscriptions[c].handler:null};a.prototype.subscribe=function(c,k){if(null===k||void 0===k)throw Error("Event handler cannot be null or undefined");var a;do a=b.framework.utils.alphaNumericToken();
while(this.getSubscriptionHandlerByToken[a]);var g=new h(k,c);this.subscriptions[a]=g;c&&c instanceof b.framework.FrameworkObject&&c.trackSubscription(this,a);return a};a.prototype.once=function(c,a){var f=this.subscribe(c,a);this.subscriptions[f].once=!0;return f};a.prototype.unsubscribe=function(c){if(!this.subscriptions.hasOwnProperty(c))return!1;delete this.subscriptions[c];return!0};a.prototype.clear=function(){this.subscriptions={}};a.prototype.publish=function(){for(var c=0;c<arguments.length;c++);
this.app&&this.app.debugMode&&(c="Event '{0}' published.".format(this.name),console.debug?console.debug(c):console.log(c));this.isPublishing=!0;for(var a in this.subscriptions)this.subscriptions.hasOwnProperty(a)&&(c=this.subscriptions[a],c.handler.apply(c.scope,arguments),c.once&&delete this.subscriptions[a]);this.isPublishing=!1};return a}();e.Event=d})(e.events||(e.events={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
var Observable=function(){function b(e){this.bindingEvent=new geocortex.framework.events.Event("__anonymous");this._syncSource=this._syncToken=null;this.value=e}b.prototype.set=function(e){this.value=e;this.bindingEvent.publish(e)};b.prototype.get=function(){return this.value};b.prototype.equals=function(e){var b=e;e&&e.get&&"function"===typeof e.get&&(b=e.get());if(this.value instanceof Array&&b instanceof Array){if(this.value.length!==b.length)return!1;for(e=0;e<this.value.length;e++)if(this.value[e]!==
b[e])return!1;return!0}return this.get()===b};b.makeBindableProxy=function(e){if(!e)return null;var l=[];if(e.___clonedObject)return e.___clonedObject;var h=function(){throw Error("Can't make method calls on a bindable proxy.");},d=function(c,a,f){for(var g=0;g<l.length;++g)if(a===l[g])return l[g];l.push(a);if(a&&"string"!==typeof a&&"number"!==typeof a&&"boolean"!==typeof a){if(a instanceof Array){for(var e=new ObservableCollection,g=0;g<a.length;++g){var x={},x=d(g,a[g],a);e.addItem(x)}return e}if(a instanceof
Object){if(a.isObservable)return a;x={};for(e in a)a.hasOwnProperty(e)&&(x[e]=d(e,a[e],a));return x}return a instanceof Function?h:a}var r=new b(a);(function(){r.set=function(a){f[c]=a;r.value=a;r.bindingEvent.publish(a)};r.get=function(){return f[c]}})();return r},a=d("root",{root:e},e);e.___clonedObject=a.root;return e instanceof Array?a.root:new b(a.root)};b.prototype.bind=function(e,b){return this.bindingEvent.subscribe(e,b)};b.prototype.unbind=function(e){return this.bindingEvent.unsubscribe(e)};
b.prototype.once=function(e,b){var h=this,d=this.bind(e,function(){h.unbind(d);b.apply(e,arguments)});return d};b.prototype.sync=function(e){this.removeSync();e&&(this.set(e.get()),this._syncSource=e,this._syncToken=e.bindingEvent.subscribe(this,function(e){this.set(e)}))};b.prototype.removeSync=function(){this._syncToken&&this._syncSource&&(this._syncSource.unbind(this._syncToken),this._syncSource=this._syncToken=null)};b.prototype.syncTransform=function(e,b){this._syncToken&&this._syncSource&&(this._syncSource.unbind(this._syncToken),
this._syncSource=this._syncToken=null);e&&(this.set(b(e.get())),this._syncSource=e,this._syncToken=e.bindingEvent.subscribe(this,function(e){this.set(b(e))}))};b.prototype.pulse=function(){this.set(this.get())};return b}();Observable.prototype.isObservable=!0;
var ObservableCollection=function(){function b(e){this.bindingEvent=new geocortex.framework.events.Event("__anonymous");this.useThrottling=!1;this._syncSource=this.throttledOperations=null;this.value=e||[]}b.prototype.isEmpty=function(){return 0===this.value.length};b.prototype.length=function(){return this.value.length};b.prototype.contains=function(e){return Array.contains(this.value,e)};b.prototype.getAt=function(e){return this.value[e]};b.prototype.getRange=function(e,b){return void 0===b?this.value.slice(e):
this.value.slice(e,b+1)};b.prototype.indexOf=function(e){return this.value.indexOf(e)};b.prototype.get=function(){return this.value};b.prototype.getItems=function(){return this.value};b.prototype.getLength=function(){return this.value.length};b.prototype.addItems=function(e){if(e&&!(1>e.length)){var b=new geocortex.framework.events.CollectionChangedArgs;b.type="append";b.rangeStart=this.value.length;this.value=this.value.concat(e);b.rangeEnd=b.rangeStart+e.length-1;b.sender=this;this.bindingEvent.publish(b)}};
b.prototype.addItem=function(e){var b=new geocortex.framework.events.CollectionChangedArgs;b.type="append";b.rangeStart=this.value.length;b.rangeEnd=this.value.length;this.value.push(e);b.sender=this;this.bindingEvent.publish(b)};b.prototype.insertItems=function(e,b){if(0!=b.length)if(e>=this.value.length)this.addItems(b);else{var h=new geocortex.framework.events.CollectionChangedArgs;h.type="insert";h.rangeStart=e;h.rangeEnd=e+b.length-1;h.sender=this;for(var d=0;d<b.length;++d)this.value.splice(e+
d,0,b[d]);this.bindingEvent.publish(h)}};b.prototype.insertItem=function(e,b){if(e>=this.value.length)this.addItem(b);else{var h=new geocortex.framework.events.CollectionChangedArgs;h.type="insert";h.rangeStart=e;h.rangeEnd=e;h.sender=this;this.value.splice(e,0,b);this.bindingEvent.publish(h)}};b.prototype.removeItem=function(e){for(var b;-1<(b=Array.pos(this.value,e));){var h=new geocortex.framework.events.CollectionChangedArgs;h.type="remove";h.rangeStart=b;h.rangeEnd=b;h.sender=this;this.bindingEvent.publish(h);
Array.remove(this.value,b,b)}};b.prototype.removeAt=function(e){if(0<=e&&e<this.getLength()){var b=new geocortex.framework.events.CollectionChangedArgs;b.type="remove";b.rangeStart=e;b.rangeEnd=e;b.sender=this;this.bindingEvent.publish(b);Array.remove(this.value,e,e)}};b.prototype.removeRange=function(e,b){b||0===b||(b=this.value.length);var h=new geocortex.framework.events.CollectionChangedArgs;h.type="remove";h.rangeStart=e;h.rangeEnd=Math.min(b,this.value.length);h.sender=this;this.bindingEvent.publish(h);
Array.remove(this.value,e,b)};b.prototype.removeWhere=function(e){if(e)for(var b=this.value.length-1;0<=b;b--)if(e(this.value[b])){var h=new geocortex.framework.events.CollectionChangedArgs;h.type="remove";h.rangeStart=b;h.rangeEnd=b;h.sender=this;this.bindingEvent.publish(h);Array.remove(this.value,b,b)}};b.prototype.clear=function(){if(this.value&&0!=this.value.length){var e=new geocortex.framework.events.CollectionChangedArgs;e.type="clear";e.rangeStart=0;e.rangeEnd=this.value.length-1;e.sender=
this;this.bindingEvent.publish(e);this.value.length=0}};b.prototype.set=function(e){this.clear();e&&this.addItems(e)};b.prototype.pulse=function(){var e=new geocortex.framework.events.CollectionChangedArgs;e.type="clear";e.rangeStart=0;e.rangeEnd=this.value.length-1;e.sender=this;this.bindingEvent.publish(e);e=new geocortex.framework.events.CollectionChangedArgs;e.type="append";e.rangeStart=0;e.rangeEnd=this.value.length-1;e.sender=this;this.bindingEvent.publish(e)};b.prototype.bind=function(e,b){return this.bindingEvent.subscribe(e,
b)};b.prototype.unbind=function(e){return this.bindingEvent.unsubscribe(e)};b.prototype.once=function(e,b){var h=this,d=h.bind(e,function(){h.unbind(d);b.apply(e,arguments)});return d};b.prototype.sync=function(e){e.value&&e.bindingEvent&&(this.clear(),this.value=e.value,e.bindingEvent.subscribe(this,function(b){this.value=e.value;var h=new geocortex.framework.events.CollectionChangedArgs;dojo.mixin(h,b);h.sender=this;this.bindingEvent.publish(h);"clear"===b.type&&(this.value=[])}))};b.prototype.equals=
function(e){var b=e;e&&e.isObservableCollection&&(b=e.get());if(!b.hasOwnProperty("length"))throw Error("Type mismatch");if(this.get().length!==b.length)return!1;for(e=0;e<this.get().length;e++)if(this.value[e]!==b[e])return!1;return!0};return b}();ObservableCollection.prototype.isObservable=!0;ObservableCollection.prototype.isObservableCollection=!0;
(function(b){(function(e){(function(e){(function(b){b.firstOrDefault=function(d,a){var c=d?d.length:0;if((null===a||"undefined"===typeof a)&&0<c)return d[0];for(var k=0;k<c;k++){var f=d[k];if(a(f,k))return f}return null};b.lastOrDefault=function(d,a){var c=d?d.length:0;if((null===a||"undefined"===typeof a)&&0<c)return d[c-1];for(c-=1;0<=c;c--){var k=d[c];if(a(k,c))return k}return null};b.orderBy=function(d,a){return d?d.slice().sort(function(c,k){var f=a(c),g=a(k);return f instanceof e.Tuple?e.Tuple.compare(f,
g):f===g?0:f>g?1:-1}):[]};b.orderByDescending=function(d,a){return d?d.slice().sort(function(c,k){var f=a(c),g=a(k);return f instanceof e.Tuple?e.Tuple.compare(g,f):g===f?0:g>f?1:-1}):[]};b.groupBy=function(d,a){var c={},k=[];if(d&&a){for(var f=0;f<d.length;f++){var g=d[f],b=a(g),e=JSON.stringify(b);c.hasOwnProperty(e)?c[e].items.push(g):c[e]={key:b,items:[g]}}for(var h in c)c.hasOwnProperty(h)&&k.push(c[h])}return k};b.distinct=function(d){return d?d.filter(function(a,c,k){return null!=a&&k.indexOf(a)===
c}):[]};b.difference=function(d,a){return d?a?d.filter(function(c){return 0>a.indexOf(c)}):d.slice(0):[]};b.remove=function(d,a,c){c=d.slice((c||a)+1||d.length);d.length=0>a?d.length+a:a;return d.push.apply(d,c)};b.removeItem=function(d,a){var c=b.pos(d,a);return-1==c?null:b.remove(d,c,c)};b.contains=function(d,a){for(var c=d.length;c--;)if(d[c]===a)return!0;return!1};b.pos=function(d,a){for(var c=d.length;c--;)if(d[c]===a)return c;return-1};b.flatten=function(d){return d?[].concat.apply([],d):d};
Array.prototype.indexOf||(Array.prototype.indexOf=function(d){if(null==this)throw new TypeError;var a=Object(this),c=a.length>>>0;if(0===c)return-1;var k=0;1<arguments.length&&(k=Number(arguments[1]),k!=k?k=0:0!=k&&Infinity!=k&&-Infinity!=k&&(k=+(0<k||-1)*Math.floor(Math.abs(k))));if(k>=c)return-1;for(k=0<=k?k:Math.max(c-Math.abs(k),0);k<c;k++)if(k in a&&a[k]===d)return k;return-1});Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(d){if(null==this)throw new TypeError;var a=Object(this),
c=a.length>>>0;if(0===c)return-1;var k=c;1<arguments.length&&(k=Number(arguments[1]),k!=k?k=0:0!=k&&k!=1/0&&k!=-(1/0)&&(k=+(0<k||-1)*Math.floor(Math.abs(k))));for(c=0<=k?Math.min(k,c-1):c-Math.abs(k);0<=c;c--)if(c in a&&a[c]===d)return c;return-1});Array.prototype.forEach||(Array.prototype.forEach=function(d,a){var c,k;if(null==this)throw new TypeError("this is null or not defined");var f=Object(this),g=f.length>>>0;if("[object Function]"!=={}.toString.call(d))throw new TypeError(d+" is not a function");
a&&(c=a);for(k=0;k<g;){var b;Object.prototype.hasOwnProperty.call(f,k)&&(b=f[k],d.call(c,b,k,f));k++}});Array.prototype.every||(Array.prototype.every=function(b,a){if(null==this)throw new TypeError;var c=Object(this),k=c.length>>>0;if("function"!=typeof b)throw new TypeError;for(var f=0;f<k;f++)if(f in c&&!b.call(a,c[f],f,c))return!1;return!0});Array.prototype.some||(Array.prototype.some=function(b,a){if(null==this)throw new TypeError;var c=Object(this),k=c.length>>>0;if("function"!=typeof b)throw new TypeError;
for(var f=0;f<k;f++)if(f in c&&b.call(a,c[f],f,c))return!0;return!1});Array.prototype.filter||(Array.prototype.filter=function(b,a){if(null==this)throw new TypeError;var c=Object(this),k=c.length>>>0;if("function"!=typeof b)throw new TypeError;for(var f=[],g=0;g<k;g++)if(g in c){var e=c[g];b.call(a,e,g,c)&&f.push(e)}return f});Array.prototype.map||(Array.prototype.map=function(b,a){var c,k,f;if(null==this)throw new TypeError(" this is null or not defined");var g=Object(this),e=g.length>>>0;if("function"!==
typeof b)throw new TypeError(b+" is not a function");a&&(c=a);k=Array(e);for(f=0;f<e;){var x;f in g&&(x=g[f],x=b.call(c,x,f,g),k[f]=x);f++}return k});Array.prototype.find||(Array.prototype.find=function(b,a){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!==typeof b)throw new TypeError("predicate must be a function");for(var c=Object(this),k=c.length>>>0,f,g=0;g<k;g++)if(f=c[g],b.call(a,f,g,c))return f});Array.prototype.findIndex||(Array.prototype.findIndex=
function(b,a){if(null===this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!==typeof b)throw new TypeError("predicate must be a function");for(var c=Object(this),k=c.length>>>0,f,g=0;g<k;g++)if(f=c[g],b.call(a,f,g,c))return g;return-1})})(e.ArrayUtils||(e.ArrayUtils={}))})(e.utils||(e.utils={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));Array.remove=geocortex.framework.utils.ArrayUtils.remove;Array.removeItem=geocortex.framework.utils.ArrayUtils.removeItem;
Array.contains=geocortex.framework.utils.ArrayUtils.contains;Array.pos=geocortex.framework.utils.ArrayUtils.pos;
(function(b){(function(b){(function(b){var e=function(){function b(a,c,k){this.period=100;this.isActive=!1;this._setTimeoutToken=null;this.period=void 0==a?0:a;this.action=c;this.cancelAction=k;var f=this;this._setTimeoutToken=setTimeout(function(){f.execute(f)},this.period)}b.prototype.cancel=function(){this._setTimeoutToken&&(clearTimeout(this._setTimeoutToken),this._setTimeoutToken=null,this.isActive=!1,this.cancelAction&&this.cancelAction())};b.prototype.execute=function(a){a.isActive=!0;var c=
a.action();null!==a._setTimeoutToken&&c?a._setTimeoutToken=setTimeout(function(){a.execute(a)},a.period):(a._setTimeoutToken=null,a.isActive=!1)};return b}();b.ThrottledOperation=e})(b.utils||(b.utils={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){var e=/^on/,d=function(){function a(){this.domElement=null;this.type="attr";this.target=this.attributeName=null;this.invert=!1;this._dojoDomEvents=[];this.targetBindings=[];this.templateKey=this.templateMode=null;this.templateSelections={};this.parentView=null;this.boundViews=[];this.viewModel=null}a.prototype.on=function(c,a){var f=this;if(c&&a){if(!this.domElement)throw Error("Cannot bind before domElement is set.");e.test(c)&&(c=c.substring(2));require(["dojo/on"],
function(g){g=g(f.domElement,c,a);f._dojoDomEvents.push(g)})}};a.prototype.destroy=function(){if(this.templateSelections)for(var c in this.templateSelections)if(this.templateSelections.hasOwnProperty(c)){var a=this.templateSelections[c];a&&a.___domParent&&dojo.place(a,a.___domParent,"last")}this.viewModel=this.parentView=this.target=this.domElement=null;for(c=0;c<this._dojoDomEvents.length;++c)this._dojoDomEvents[c].remove();for(c=this._dojoDomEvents.length=0;c<this.targetBindings.length;++c)this.targetBindings[c].event.unsubscribe(this.targetBindings[c].token);
this.targetBindings=[];for(c=0;c<this.boundViews.length;++c)this.boundViews[c].destroyBindings();this.boundViews=[]};return a}();b.BindingExpression=d})(b.ui||(b.ui={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){var e=function(){function b(){this.parent=this.domElement=null;this.children=[];this.expressions=[];this.context=null;this.contextChange=!1;this.context=this.parent=this.domElement=null}b.prototype.destroy=function(){this.context=this.parent=this.domElement=null;this.contextChange=!1;for(var a=0;a<this.expressions.length;++a)this.expressions[a].destroy();this.expressions=[];for(a=0;a<this.children.length;++a)this.children[a].destroy();this.children=[]};return b}();
b.BindingNode=e})(b.ui||(b.ui={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(e){(function(l){var h=function(d){function a(c,a){d.call(this,c,a);this.isManaged=this.isActive=!1;this.isBusy=new Observable(!1);this.title=new Observable("");this.description=new Observable("");this.iconUri=new Observable("");this.viewModel=this.markupResource=null;this.typeName=this.regionName="";this.parentView=this.bindingTree=this.root=null;this.childRegions=[];this.initiallyBound=this.bound=!1;this.disposableBindings=[];this.bindingSetupDelegates=[];this.id="View-"+b.framework.utils.alphaNumericToken()}
__extends(a,d);a.prototype.addDisposableBinding=function(c,a){this.disposableBindings.push({event:c.bindingEvent,token:a})};a.prototype.attach=function(c){this.bound||(this.viewModel=c,this.root&&(this.bindingTree=this.buildTree(),null!==this.viewModel&&void 0!==this.viewModel&&this.pulseAll(),this.bound=!0,this.initiallyBound||(this.initiallyBound=!0,this.app.event("ViewInitializedEvent").publish(this))))};a.prototype.activated=function(){};a.prototype.deactivated=function(){};a.prototype.added=
function(c){!this.bound&&this.viewModel&&(this.bindingTree=this.buildTree(),this.bound=!0,this.pulseAll(),this.initiallyBound||(this.initiallyBound=!0,this.app.event("ViewInitializedEvent").publish(this)))};a.prototype.removed=function(){this.destroyBindings()};a.prototype.destroy=function(){this.destroyBindings();d.prototype.destroy.call(this)};a.prototype.destroyBindings=function(){this.isActive&&this.app.viewManager.deactivateView(this);if(this.bindingTree){this.bindingTree.destroy();for(var c=
0;c<this.disposableBindings.length;++c){var a=this.disposableBindings[c];a.event.unsubscribe(a.token)}this.bound=!1;this.disposableBindings=[];this.bindingSetupDelegates=[]}};a.prototype.pulseAll=function(){for(var c=0;c<this.bindingSetupDelegates.length;++c)try{this.bindingSetupDelegates[c]()}catch(a){this.app.trace.error("Error performing initial data-bind in view '{0}' with view model '{1}': {2}".format(this.id,this.viewModel.id,a.message),a)}this.bindingSetupDelegates=[]};a.prototype.resolveWidget=
function(c,a,f){return null};a.prototype.buildTree=function(){function c(f,d){function x(c){var a=[];if(!c)return a;var k=c.match(/\{(.*?)\}/g);if(!k){if(this.app)return this.app.trace.warning("Invalid data-binding expression '{0}'.".format(c)),[];throw Error("Invalid data-binding expression '{0}'.".format(c));}for(c=0;c<k.length;++c){var f=k[c].split(":");2==f.length&&a.push({directive:f[0].replace("{","").trim(),target:f[1].replace("}","").trim()})}return a}if(d&&d.children)for(var h=0;h<d.children.length;++h){var l=
d.children[h],m=dojo.attr(l,"data-region-name"),n=dojo.attr(l,"data-binding");n||(n=l.___dataBindingExpressions);if(n){var t=x(n);l.___dataBindingExpressions=n;a.app.debugMode||dojo.removeAttr(l,"data-binding");if(t&&0!==t.length){for(var u=!1,z=0;z<t.length;++z)(function(){var c=f.expressions,d=f.context,w=!1,h=t[z],r=h.directive,n=h.target,q=new b.framework.ui.BindingExpression;q.domElement=l;q.target=n;null!=a.viewModel?q.viewModel=a.viewModel:(q.viewModel={},q.viewModel.id="[None]");q.parentView=
a.parentView?a.parentView:a;if(r.startsWith("@"))if(n=r.split("-")[1],r.startsWith("@event-"))n?(q.type="event",q.attributeName=n):(this.app.trace.warning("Binding error: Invalid event binding expression '{0}' in view '{1}'.".format(r,a.id)),w=!0);else if(r.startsWith("@var"))q.type="var";else if(r.startsWith("@text"))q.attributeName="innerHTML",q.type="text";else if(r.startsWith("@attach"))q.attributeName="___attachedValue",q.type="attachment";else if(r.startsWith("@style-"))h=r.indexOf("-"),(h=
r.substring(h+1))?(q.type="style",q.attributeName=h):(this.app.trace.warning("Binding error: Invalid style binding expression '{0}' in view '{1}'.".format(r,a.id)),w=!0);else if(r.startsWith("@dom"))q.type="dom",q.attributeName=n;else if(r.startsWith("@value"))q.type="value",q.attributeName=n;else if(r.startsWith("@widget"))q.type=r.substring(1),q.attributeName=n,q.otherExpressions=t;else if(r.startsWith("@class")||r.startsWith("@noclass"))q.type="class",r.startsWith("@noclass")&&(q.invert=!0),h=
r.indexOf("-"),(h=r.substring(h+1))?q.attributeName=h:(this.app.trace.warning("Binding error: Invalid class binding expression '{0}' in view '{1}'.".format(r,a.id)),w=!0);else if("@source"===r){q.type="source";q.attributeName="@source";u=!0;q.templateMode="single-inline";for(n=0;n<t.length;++n)if(r=t[n],r!==h){var m=r.directive,r=r.target;if("@template"===m){q.templateMode="single-external";h=new e.config.ViewConfig(null,null,null);h.markupResource=r;h.libraryId=a.libraryId;var v=a.app.viewManager.createView(h);
if(!v){a.app.trace.error("Could not instantiate template '{0}' while binding view '{1}'.".format(r,this.id));break}v.app=a.app;q.templateSelections={"@default":v.root};break}else if("@template-selector"===m){q.templateMode="inline-selected";q.templateKey=r;q.templateSelections={};break}}if("single-external"!==q.templateMode){h=new dojo.NodeList;for(r=0;r<l.children.length;++r)for(var n=l.children[r],m=dojo.attr(n,"data-binding"),v=x(m),A=0;A<v.length;++A)if(m=v[A],"@template-for"===m.directive||"@template-select"===
m.directive){if("@template-for"===m.directive&&m.target===q.target)h.push(n),v=dojo.clone(n),q.templateSelections["@default"]=v,v.___domParent=l;else if("@template-select"===m.directive){h.push(n);for(var A=!1,F=0;F<v.length;++F){var G=v[F];if("@template"===G.directive){v=new e.config.ViewConfig(null,null,null);v.markupResource=G.target;v.libraryId=a.libraryId;v=a.app.viewManager.createView(v);if(!v){this.app.trace.error("Could not instantiate template '{0}' while binding view '{1}'.".format(G.target,
this.id));break}v.app=a.app;A=dojo.clone(n);dojo.place(v.root,A,"last");q.templateSelections[m.target]=A;A=!0;break}}A||(h.push(n),q.templateSelections[m.target]=n,n.___domParent=l)}break}h.orphan()}}else"@source-remove"===r?(q.type="source-remove",q.attributeName=n):"@source-add"===r?(q.type="source-add",q.attributeName=n):"@visible"===r||"@hidden"===r?("@hidden"===r&&(q.invert=!0),q.type="visibility",q.attributeName="@visibility"):"@disabled"===r||"@enabled"===r?("@disabled"===r&&(q.invert=!0),
q.type="disabledState",q.attributeName="@disabledState"):r.startsWith("@template")?q.type="template":r.startsWith("@halt")?u=!0:(a.app.trace.warning("Unknown binding term '{0}'.".format(r)),w=!0);else q.type="attr",q.attributeName=r;w||a.applyBinding.apply(a,[l,q,d,f])&&c.push(q)})();n=new b.framework.ui.BindingNode;n.domElement=l;n.parent=f;n.context=f.context;n.children=[];n.expressions=[];f.children.push(n);!1!=u||m||c(n,l)}}else m||c(f,l)}}var a=this;if(null!=this.root){var f=new b.framework.ui.BindingNode;
f.domElement=null;f.parent=null;f.children=[];f.context=this.viewModel;c(f,{children:[this.root]});return f}};a.prototype.getBindingTarget=function(c){if("@context"===c.target)return c.viewModel;if(-1<c.target.indexOf("@language-"))return c=c.target.split("-").slice(1).join("-"),this.app.getResource(this.libraryId,"language-"+c);if(!0!=c.viewModel.isObservable)return c.viewModel[c.target];var a=c.viewModel.get();return null==a?a:a[c.target]};a.prototype.setBindingTargetValue=function(c,a){if("@context"===
c.target)c.viewModel&&c.viewModel.isObservable?c.viewModel.set(a):c.viewModel=a;else if(!(-1<c.target.indexOf("@language-")))if(c.viewModel.isObservable){var f=c.viewModel.get();f&&(f[c.target]?f[c.target].isObservable?f[c.target].set(a):f[c.target]=a:f[c.target]=new Observable(a))}else c.viewModel[c.target].isObservable?c.viewModel[c.target].set(a):c.viewModel[c.target]=a};a.prototype.resolveBindingTemplate=function(c,a){var f=null;if("single-inline"===c.templateMode||"single-external"===c.templateMode)f=
dojo.clone(c.templateSelections["@default"]);else if("inline-selected"===c.templateMode){var g=null;a[c.templateKey]&&(g=a[c.templateKey],g.isObservable&&(g=g.get()));!g&&c.templateSelections.hasOwnProperty("@null")?f=dojo.clone(c.templateSelections["@null"]):c.templateSelections.hasOwnProperty(g)&&(f=dojo.clone(c.templateSelections[g]));!f&&c.templateSelections.hasOwnProperty("@default")&&(f=dojo.clone(c.templateSelections["@default"]),dojo.addClass(f,"empty-div"))}f||(f=dojo.create("div"));return f};
a.prototype.buildSourceBinding=function(c,a,f,g){var e=this,d=e.getBindingTarget(a);if(null===d)return!1;if(void 0===d)return e.app.trace.warning("Binding error: '{0}' in view model '{1}' was not bindable.".format(a.target,a.viewModel.id)),!1;var h=function(){if(d.useThrottling&&d.throttledOperations&&d.throttledOperations.length)for(var c=d.throttledOperations.length-1;0<=c;c--)d.throttledOperations[c].cancel(),d.throttledOperations.splice(c,1)},l=function(f){if(!0===a.upToDate)a.upToDate=!1;else{for(var l=
null,p=null,m=0;m<g.expressions.length;++m){var s=g.expressions[m];l||"source-add"!=s.type||(l=s.target);p||"source-remove"!=s.type||(p=s.target)}m=this;a.parentView&&(m=a.parentView);var y=m[l],l=m[p];if(void 0!==f&&null!==f){if(!(f instanceof b.framework.events.CollectionChangedArgs)){p=f.isObservable?f.get():f;l&&l.apply(e,[a,p,f,0]);for(s=0;s<a.boundViews.length;++s)this.app.viewManager.destroyView(a.boundViews[s]);a.boundViews=[];!l&&(s=a.___singleSourceItem)&&(m=new dojo.NodeList,m.push(s),
m.orphan(),a.___singleSourceItem=null);if(p)if(y)y.apply(e,[a,p,f,0]);else{m=e.resolveBindingTemplate(a,p);dojo.place(m,a.domElement,"last");s=new b.framework.ui.ViewBase(e.app);s.parentView=a.parentView;s.app=s.parentView.app;s.libraryId=e.libraryId;var B={children:[]};B.children.push(m);p||(p=new b.framework.ui.ViewModelBase(e.app,e.libraryId),p.app=e.app,p.libraryId=e.libraryId);p.hasOwnProperty("___boundViews");s.root=B;s.attach(p);s.root=m;a.___singleSourceItem=s.root;a.boundViews.push(s)}}else if(null===
f||"clear"===f.type){h();if(l)for(s=f.rangeStart;s<=f.rangeEnd;++s)l.apply(e,[a,d.getAt(s),f,s]);for(s=0;s<a.boundViews.length;++s)this.app.viewManager.destroyView(a.boundViews[s]);a.boundViews=[];if(!l&&null!=a.domElement&&null!=a.domElement.children){m=new dojo.NodeList;for(s=0;s<a.domElement.children.length;++s)a.domElement.children[s].___collectionTemplate||m.push(a.domElement.children[s]);m.orphan()}}else if("replace"===f.type){h();if(l)for(s=f.rangeStart;s<f.rangeEnd+1;++s)l.apply(e,[a,d.getAt(s),
f,s]);for(s=0;s<a.boundViews.length;++s)this.app.viewManager.destroyView(a.boundViews[s]);a.boundViews=[];l||dojo.empty(a.domElement);f.type="append";f.rangeStart=0;f.rangeEnd=d.value.length-1}if("append"===f.type||"insert"===f.type){var C=null;"insert"===f.type&&a.domElement.children.length>f.rangeStart&&(C=a.domElement.children[f.rangeStart]);var D=function(g,h,r){if(g>h||!a||null==a.domElement)return!1;for(r=r?r:d;g<=h;++g){var l=null;if(null!=y)y.apply(e,[a,r.isObservable?r.getAt(g):r[g],f,g]);
else{var p=r.isObservable?r.getAt(g):r[g],l=e.resolveBindingTemplate(a,p);if(C&&"insert"===f.type)dojo.place(l,C,"before");else if(C&&"append"===f.type)dojo.place(l,C,"after");else if(a&&null!=a.domElement)dojo.place(l,a.domElement,"last");else return!1;var q=new b.framework.ui.ViewBase(e.app,e.libraryId);q.parentView=a.parentView;q.app=q.parentView.app;q.libraryId=e.libraryId;q.id+="-item"+g;var m={children:[]};m.children.push(l);if(null===p||void 0===p)p=new b.framework.ui.ViewModelBase(e.app,e.libraryId),
p.app=e.app,p.libraryId=e.libraryId;p.hasOwnProperty("___boundViews");q.root=m;q.attach(p);q.root=l;a.boundViews.push(q)}}c.___populateInitialValueFunc&&(c.___populateInitialValueFunc(),delete c.___populateInitialValueFunc);return!0};if(d.useThrottling){d.throttledOperations=d.throttledOperations&&d.throttledOperations.constructor===Array?d.throttledOperations:[];var l=void 0==d.throttleDelay?0:d.throttleDelay,E=f.rangeStart,q=Math.min(E+10-1,f.rangeEnd),H=d.get().slice(0),v=function(){var c=d.throttledOperations.indexOf(A);
-1<c&&d.throttledOperations.splice(c,1)},A=new b.framework.utils.ThrottledOperation(l,function(){var c=D(E,q,H);if(q>=f.rangeEnd)return v(),!1;E+=10;q+=10;q=Math.min(q,f.rangeEnd);c||v();return c});d.throttledOperations.push(A)}else D(f.rangeStart,f.rangeEnd)}else if("remove"===f.type)for(h(),p=f.rangeStart;p<=f.rangeEnd;++p)for(m=0;m<a.boundViews.length;++m)s=a.boundViews[m],null!==s.viewModel&&void 0!==s.viewModel&&s.viewModel==d.getAt(p)&&(l?l.apply(e,[a,f[p],f,p]):e.app.viewManager.destroyView(s),
Array.removeItem(a.boundViews,s),--m)}}};d.bind&&a.targetBindings.push({event:d.bindingEvent,token:d.bind(e,l)});if(d.isObservableCollection){var m=d.getLength()-1;this.bindingSetupDelegates.push(function(){var c=new b.framework.events.CollectionChangedArgs;c.type="append";c.rangeStart=0;c.rangeEnd=m;c.sender=d;l.apply(e,[c]);d.isObservable&&d.bindingEvent.isPublishing&&(a.upToDate=!0)})}else this.bindingSetupDelegates.push(function(){l.apply(e,[d]);d.isObservable&&d.bindingEvent.isPublishing&&(a.upToDate=
!0)})};a.prototype.buildEventBinding=function(c,a,f){var g=this;!this[a.target]&&a.parentView&&a.parentView[a.target]&&(g=a.parentView);if(g[a.target])c!=a.domElement&&this.app.trace.warning("Binding error: buildEventBinding passed in el that doesn't match binding.domElement."),a.on(a.attributeName,function(b){var e=g[a.target](b,c,f);return e?e:(b.preventDefault(),b.stopPropagation(),!1)});else return this.app.trace.warning("Binding error: Event handler '{0}' was not found in view '{1}' or its parent view.".format(a.target,
g.id)),!1};a.prototype.buildVarBinding=function(c,a,f){f=this;a.parentView&&(f=a.parentView);var g=f[a.target];g?g&&g instanceof Array?g.push(c):g&&g.isObservableCollection?g.addItem(c):f[a.target]=c:f[a.target]=c};a.prototype.buildTextBinding=function(c,a,f){var g=this.getBindingTarget(a);if(null===g)return!1;if(void 0===g)return this.app.trace.warning("Binding error: Property '{0}' does not exist in view model '{1}'.".format(a.target,a.viewModel.id)),!1;var b=function(){if(null==g||g.isObservable){var f=
g.get(),f=null===f||void 0===f?"":f.toString();"innerHTML"===a.attributeName?(dojo.empty(c),c.appendChild(dojo.doc.createTextNode(f))):dojo.attr(c,a.attributeName,String.escapeHtml(f))}else"innerHTML"===a.attributeName?(dojo.empty(c),c.appendChild(document.createTextNode(g))):dojo.attr(c,a.attributeName,String.escapeHtml(g))};g.isObservable&&a.targetBindings.push({event:g.bindingEvent,token:g.bind(this,b)});this.bindingSetupDelegates.push(function(){b.apply(this,[null])})};a.prototype.buildAttributeBinding=
function(c,a,f,g){var b=this.getBindingTarget(a);if("undefined"===typeof b)return this.app.trace.warning("Binding error: Property '{0}' does not exist in view model '{1}'.".format(a.target,a.viewModel.id)),!1;var e=function(){if(null===b)return dojo.attr(c,a.attributeName,""),!1;if(b.isObservable){var f=b.get();if(null===f||void 0===f)f="";!0===g?c[a.attributeName]=f:dojo.attr(c,a.attributeName,f)}else{if(null===b||void 0===b)b="";!0===g?c[a.attributeName]=b:dojo.attr(c,a.attributeName,b)}};null!==
b&&b.isObservable&&a.targetBindings.push({event:b.bindingEvent,token:b.bind(this,e)});this.bindingSetupDelegates.push(function(){e.apply(this,[null])})};a.prototype.buildStyleBinding=function(c,a,f){var g=this,b=this.getBindingTarget(a);if(null===b)return!1;if(void 0===b)return this.app.trace.warning("Binding error: Property '{0}' does not exist in view model '{1}'.".format(a.target,a.viewModel.id)),!1;if(null!=b&&!b.isObservable)f=isNaN(b)||""===b?b:b+"px",dojo.style(c,a.attributeName,f);else if(null!=
b){var e=function(){var f;f=b.get();f=isNaN(f)||""===f?f:f+"px";dojo.style(c,a.attributeName,f)};b.isObservable&&a.targetBindings.push({event:b.bindingEvent,token:b.bind(this,e)});this.bindingSetupDelegates.push(function(){e.apply(g,[null])})}};a.prototype.buildDomBinding=function(c,a,f){c=this;a.parentView&&(c=a.parentView);var g=c[a.target];if(null==g)return!1;if(void 0===g)return this.app.trace.warning("Binding error: Property '{0}' does not exist in view model '{1}'.".format(a.target,a.viewModel.id)),
!1;try{if(g.isObservable){a.targetBindings.push({event:g.bindingEvent,token:g.bind(this,function(c){if(!g.get())return!1;a.domElement=dojo.place(g.get(),a.domElement,"replace");this.app&&this.app.viewManager.notifyDimensionsChanged(this)})});if(!g.get())return!1;dojo.place(g.get(),a.domElement,"replace")}else{if(!g)return!1;dojo.place(g,a.domElement,"replace")}}catch(b){this.app.trace.warning("Binding error: An error occurred in view '{0}' while attempting to perform a DOM binding in view model '{1}'.".format(this.id,
a.viewModel.id))}};a.prototype._createWidgetViewFromConfig=function(c,a){var f=c.type,g=c.id?"WidgetView-{0}-{1}".format(c.id,b.framework.utils.alphaNumericToken()):"{0}-{1}".format(b.framework.utils.alphaNumericToken(),b.framework.utils.alphaNumericToken()),g=new e.config.ViewConfig(g,null,f||"geocortex.framework.ui.ViewBase");g.isVisible=!0;g.libraryId=c.libraryId;c.markup&&(g.markupResource=c.markup);c=this.app.translateConfiguration(c.libraryId,c);f=null;if(c.viewModelId){if(f=this.app.getFrameworkObjectById(c.viewModelId),
!f)throw Error("Could not bind widget '{0}' to view model with ID '{1}': View model not found.".format(c.Id,c.viewModelId));}else c.viewModelType?(f=this.app.instantiateFrameworkObject(c.viewModelType,c.libraryId),c.id||(c.id=b.framework.utils.alphaNumericToken()),f.id="WidgetViewModel-{0}-{1}".format(c.id,b.framework.utils.alphaNumericToken())):f=a;g=this.app.viewManager.createView(g);if(!g)throw Error("Could not create widget '{0}': The widget's view could not be created.".format(c.Id));g.configuration=
c.configuration;var d={children:[]};d.children.push(g.root);g.root=d;g.attach(f);g.root=d.children[0];return g};a.prototype.buildWidgetBinding=function(c,a,f){var g=this,e=a.target,d=this.viewModel,h=!0,l=!1,m=null;f=null;if(a.otherExpressions)for(c=0;c<a.otherExpressions.length;++c)if(f=a.otherExpressions[c],"@widget-context"===f.directive){a.target=f.target;d=this.getBindingTarget(a);if(!d)return this.app.trace.error("Error binding widget '{0}' to target '{1}': Target was not found in view model.".format(e,
f.target)),!1;m=d}else"@widget-required"===f.directive?h="false"!==f.target.toLowerCase():"@widget-replace"===f.directive&&(l="true"===f.target.toLowerCase());f=d&&d.isObservable;var n=this.app.configModel.widgetConfigs,t=null;for(c=0;c<n.length;++c){var u=n[c];if(u.id===e){t=u;break}}var z=!t,s=function(){var c=m||null;c&&c.isObservable&&(c=c.get());c=(a.parentView||this).resolveWidget(e,c,a);if(!c){if(h)throw Error("Widget '{0}' was not found.".format(e));return!1}return c},y=function(c,f){var d=
null;if(0<a.boundViews.length)for(var h=0;h<a.boundViews.length;++h)g.app.viewManager.destroyView(a.boundViews[h]);dojo.empty(a.domElement);h=null;if(c){if("string"===typeof c)d=dojo.create("div"),dojo.attr(d,"innerHTML",c),dojo.addClass(d,"empty-div"),d=d.children&&1===d.children.length?d.children[0]:d;else if(c.hasOwnProperty("nodeType")&&[1,2,3,8,9].contains(t.nodeType))d=c;else if(c instanceof b.framework.ui.ViewBase)h=c,a.boundViews.push(h),d=c.root;else if(c instanceof b.framework.config.WidgetConfig)h=
g._createWidgetViewFromConfig(c,f),a.boundViews.push(h),d=h.root;else{g.app.trace.warning("Could not resolve widget '{0}': Object of unknown type provided.".format(e));return}dojo.place(d,a.domElement,l?"replace":"last");h&&(h.added(g),h.activated())}};f&&a.targetBindings.push({event:d.bindingEvent,token:d.bind(this,function(c){if(z){var a=s();y(a,c)}else y(t,c)})});this.bindingSetupDelegates.push(function(){var c=null;d&&(c=d.isObservable?d.get():d);if(z){var a=s();y(a,c)}else y(t,c)})};a.prototype.buildClassBinding=
function(c,a,f){var g=this.getBindingTarget(a);if(null===g)return!1;if(void 0===g)return this.app.trace.debug("Binding error: Property '{0}' does not exist in view model '{1}'.".format(a.target,a.viewModel.id)),!1;var b=function(f){f=d.isTruthy(f);!0===a.invert&&(f=!f);var g=a.attributeName;!0===f?(dojo.removeClass(c,g),dojo.addClass(c,g)):dojo.removeClass(c,g)},d=this;g.isObservable&&a.targetBindings.push({event:g.bindingEvent,token:g.bind(this,b)});this.bindingSetupDelegates.push(function(){b.apply(d,
[g])})};a.prototype.isTruthy=function(c){if(c)if(c instanceof b.framework.events.CollectionChangedArgs)if("append"===c.type){if(0<c.rangeEnd+1-c.rangeStart||c.sender.value&&0<c.sender.value.length)return!0}else{if("clear"===c.type)return!1;if("insert"===c.type){if(0<c.rangeEnd+1-c.rangeStart)return!0}else if("remove"===c.type&&c.rangeEnd+1-c.rangeStart<c.sender.value.length)return!0}else return c.isObservableCollection?0<c.getLength():c.isObservable?!!c.get():c?!0:"string"===typeof c?0<c.length:!1;
else return!1};a.prototype.buildVisibilityBinding=function(c,a,f){var g=this.getBindingTarget(a);if(null===g)return!1;if(void 0===g)return this.app.trace.debug("Binding error: Property '{0}' does not exist in view model '{1}'.".format(a.target,a.viewModel.id)),!1;a.initialVisibility=dojo.style(c,"display")||"block";var b=function(f){f=d.isTruthy(f);!0==a.invert&&(f=!f);var g="",g="inline"===a.initialVisibility?"bound-visible-inline":"bound-visible";!0==f?(dojo.removeClass(c,"bound-invisible"),dojo.addClass(c,
g)):(dojo.removeClass(c,g),dojo.addClass(c,"bound-invisible"))},d=this;g.isObservable&&a.targetBindings.push({event:g.bindingEvent,token:g.bind(this,b)});this.bindingSetupDelegates.push(function(){b.apply(d,[g])})};a.prototype.buildDisabledBinding=function(c,a,f){var g=this.getBindingTarget(a);if(void 0===g)return this.app.trace.debug("Binding error: Property '{0}' does not exist in view model '{1}'.".format(a.target,a.viewModel.id)),!1;a.initialDisabled=dojo.attr(c,"disabled");var d=function(f){var d=
!1;if(!f)d=!0;else if(g)if(f instanceof b.framework.events.CollectionChangedArgs)if("append"==f.type){if(0<f.rangeEnd+1-f.rangeStart||g.value&&0<g.value.length)d=!1}else"clear"==f.type?d=!0:"insert"==f.type?0<f.rangeEnd+1-f.rangeStart&&(d=!1):"remove"==f.type&&f.rangeEnd+1-f.rangeStart<g.value.length&&(d=!1);else d=g.isObservableCollection?!(0<g.getLength()):g.isObservable?!g.get():"string"===typeof f?0==f.length:!1;!0==a.invert&&(d=!d);!0==d?(dojo.attr(c,"disabled",!0),dojo.attr(c,"tabindex",-1),
dojo.addClass(c,"bound-disabled")):(dojo.removeAttr(c,"disabled"),dojo.removeAttr(c,"tabindex"),dojo.removeClass(c,"bound-disabled"))},e=this;g.isObservable&&a.targetBindings.push({event:g.bindingEvent,token:g.bind(this,d)});this.bindingSetupDelegates.push(function(){d.apply(e,[g])})};a.prototype.buildValueBinding=function(c,a,f){var g=this,d=this.getBindingTarget(a);if(void 0===d)return this.app.trace.warning("Binding error: Property '{0}' does not exist in view model '{1}'.".format(a.target,a.viewModel.id)),
!1;if(null==d)return!1;var h=d.isObservable||!1,l=d.isObservableCollection||!1;f=c.tagName.toLowerCase();var p=dojo.attr(c,"type")||c.type?c.type:null;if(h){var m=function(a){if(a!==dojo.attr(c,"value")){if(null===a||void 0===a)a="";dojo.attr(c,"value",a)}},n=function(a){c.checked=!0===a},t=function(a){var f=dojo.attr(c,"value");dojo.query("input[type=radio]",g.root).forEach(function(a){});c.checked=!0===a||f==a?!0:!1},u=function(a){a instanceof Date?(a=new Date(a.getTime()),a.setMinutes(a.getMinutes()-
a.getTimezoneOffset()),c.valueAsDate=a):c.value=a},z=function(c){var f=c;c=function(a,c){if("undefined"!==typeof a.___attachedValue){var k=a.___attachedValue;if(k===(void 0===c?f:c))return!0;"number"===typeof k||"boolean"===typeof k?k=k.toString():k&&k.hasOwnProperty("value")&&(k=k.value,"number"===typeof k||"boolean"===typeof k)&&(k=k.toString());return k===(void 0===c?f:c)}return a.value===(void 0===c?f:c)};if(f instanceof b.framework.events.CollectionChangedArgs){for(var d=f,g=d.sender,e=[],h=
d.rangeStart;h<=d.rangeEnd;h++){var w=g.getAt(h);e.push(w.value?w.value+"":w)}if("append"===d.type||"insert"===d.type)for(d=0;d<a.domElement.options.length;++d)for(g=a.domElement.options[d],h=0;h<e.length;h++)c(g,e[h])?g.selected=!0:dojo.attr(a.domElement,"multiple")||(g.selected=!1)}else{if("number"===typeof f||"boolean"===typeof f)f=f.toString();if(null===f||void 0===f)for(d=0;d<a.domElement.options.length;++d)g=a.domElement.options[d],g.selected=!1;else if(dojo.isArray(f))if(a.viewModel[a.target].isObservableCollection)for(h=
!1,d=0;d<a.domElement.options.length;++d){if(g=a.domElement.options[d],g.selected=!1,dojo.attr(a.domElement,"multiple")||!h)for(w=0;w<f.length;++w)if(e=f[w],c(g,e)){h=g.selected=!0;break}}else for(d=0;d<a.domElement.options.length;++d){if(g=a.domElement.options[d],c(g,e)){g.selected=!0;break}}else for(d=0;d<a.domElement.options.length;++d)if(g=a.domElement.options[d],c(g,e)){g.selected=!0;break}}};"select"===f?(a.targetBindings.push({event:d.bindingEvent,token:d.bind(a,z)}),this.bindingSetupDelegates.push(function(){z.apply(g,
[d.get()])})):"radio"===p?(a.targetBindings.push({event:d.bindingEvent,token:d.bind(a,t)}),this.bindingSetupDelegates.push(function(){t.apply(g,[d.get()])})):"checkbox"===p?(a.targetBindings.push({event:d.bindingEvent,token:d.bind(a,n)}),this.bindingSetupDelegates.push(function(){n.apply(g,[d.get()])})):"date"===p?(a.targetBindings.push({event:d.bindingEvent,token:d.bind(a,u)}),this.bindingSetupDelegates.push(function(){u.apply(g,[d.get()])})):(a.targetBindings.push({event:d.bindingEvent,token:d.bind(a,
m)}),this.bindingSetupDelegates.push(function(){m.apply(g,[d.get()])}))}var s=function(){a.on("change",function(c){if(void 0===c.currentTarget)g.app&&g.app.trace.error("Binding error: bound to change event where currentTarget is undefined");else return c=dojo.attr(c.currentTarget,"value"),h?d.set(c):g.setBindingTargetValue(a,c),!0})},y=function(){a.on("change",function(c){c=dojo.attr(c.currentTarget,"checked");h?d.set(c):g.setBindingTargetValue(a,c);return!0})},B=function(){a.on("click",function(c){dojo.attr(c.currentTarget,
"checked")&&(h?d.set(c.currentTarget.value):g.setBindingTargetValue(a,c.currentTarget.value));return!0})},C=function(){a.on("change",function(c){var f=h?d.get():d;c=c.currentTarget.valueAsDate;c.setMinutes(c.getMinutes()+c.getTimezoneOffset());f instanceof Date&&!isNaN(f.getTime())&&(c.setHours(f.getHours()),c.setMinutes(f.getMinutes()),c.setSeconds(f.getSeconds()),c.setMilliseconds(f.getMilliseconds()));h?d.set(c):g.setBindingTargetValue(a,c);return!0})},D=function(){c.___populateInitialValueFunc=
function(){z(d.isObservable?d.get():d)};a.on("change",function(){for(var f=dojo.query("option",c),b=[],p=0;p<f.length;++p){var m=f[p];if(!0===m.selected){var n=m.___attachedValue;e.utils.isNullOrUndefined(n)?b.push(m.value):b.push(n)}}0===b.length&&0<f.length&&!c.multiple&&!0===g.app.___uaIsiPad&&(c.selectedIndex=0,n=f[0].___attachedValue,b.push(e.utils.isNullOrUndefined(n)?f[0].value:n));0<b.length?l?(d.clear(),d.addItems(b)):h?d.set(b[0]):g.setBindingTargetValue(a,b):d.clear();return!0})};"textarea"===
f||"input"===f&&"text"===p?function(){var c=null,f=function(f){f=dojo.attr(f.currentTarget,"value");if(f!==c)return c=f,h?d.set(f):g.setBindingTargetValue(a,f),!0};a.on("change",f);a.on("keyup",f);a.on("mouseup",f);a.on("input",f)}():"input"===f&&"checkbox"===p?y():"input"===f&&"radio"===p?B():"input"===f&&"date"===p?C():"select"===f?D():s()};a.prototype.applyBinding=function(a,k,f,d){"source"===k.type?this.buildSourceBinding(a,k,f,d):"event"===k.type?this.buildEventBinding(a,k,f):"text"===k.type?
this.buildTextBinding(a,k,f):"var"===k.type?this.buildVarBinding(a,k,f):"class"===k.type?this.buildClassBinding(a,k,f):"style"===k.type?this.buildStyleBinding(a,k,f):"dom"===k.type?this.buildDomBinding(a,k,f):"value"===k.type?this.buildValueBinding(a,k,f):"attr"===k.type?this.buildAttributeBinding(a,k,f):"attachment"===k.type?this.buildAttributeBinding(a,k,f,!0):"visibility"===k.type?this.buildVisibilityBinding(a,k,f):"disabledState"===k.type?this.buildDisabledBinding(a,k,f):"widget"===k.type&&this.buildWidgetBinding(a,
k,f);return!0};return a}(b.framework.FrameworkObject);l.ViewBase=h})(e.ui||(e.ui={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(l){var h=function(){function d(a,c){this._viewActivationTimers=[];this._viewDeactivationTimers=[];this.isActive=!1;this.options=this.domElement=null;this.views=[];this.activeViews=[];this.defaultTransitionDelay=10;this.app=c;this.name=a}d.prototype.host=function(a,c){this.domElement=a;this.options=c||{};if(this.options.useTransitions){if(!this.options.transitionDelay||isNaN(this.options.transitionDelay))this.options.transitionDelay=this.defaultTransitionDelay}else this.options.useTransitions=
!1};d.prototype.unhost=function(){this.options=this.domElement=null};d.prototype.activateView=function(a){this.cancelActivate(a);0===this.activeViews.length&&!1===a.isActive&&(this.isActive=!0,this.app.event("RegionActivatedEvent").publish(this),dojo.removeClass(this.domElement,"region-inactive"),dojo.addClass(this.domElement,"region-active"));b.utils.ArrayUtils.contains(this.activeViews,a)&&b.utils.ArrayUtils.removeItem(this.activeViews,a);this.activeViews.push(a);a.activated();a.isActive=!0;this.options.useTransitions?
(dojo.removeClass(a.root,"inactive"),dojo.addClass(a.root,"activating"),this._viewActivationTimers[a.id]=setTimeout(dojo.hitch(this,function(){dojo.removeClass(a.root,"inactive");dojo.removeClass(a.root,"activating");dojo.addClass(a.root,"active");delete this._viewActivationTimers[a.id]}),this.options.transitionDelay)):(dojo.removeClass(a.root,"inactive"),dojo.addClass(a.root,"active"));this.app.event("ViewActivatedEvent").publish(a)};d.prototype.cancelActivate=function(a){this._viewActivationTimers[a.id]&&
(clearTimeout(this._viewActivationTimers[a.id]),delete this._viewActivationTimers[a.id],dojo.removeClass(a.root,"activating"))};d.prototype.cancelDeactivate=function(a){this._viewActivationTimers[a.id]&&(clearTimeout(this._viewActivationTimers[a.id]),delete this._viewActivationTimers[a.id],dojo.removeClass(a.root,"deactivating"))};d.prototype.deactivateView=function(a){this.cancelDeactivate(a);1>=this.activeViews.length&&!0===a.isActive&&(this.isActive=!1,dojo.removeClass(this.domElement,"region-active"),
dojo.addClass(this.domElement,"region-inactive"),this.app.event("RegionDeactivatedEvent").publish(this));this.cancelActivate(a);b.utils.ArrayUtils.removeItem(this.activeViews,a);a.deactivated();a.isActive=!1;this.options.useTransitions?(dojo.removeClass(a.root,"active"),dojo.addClass(a.root,"deactivating"),this._viewDeactivationTimers[a.id]=setTimeout(dojo.hitch(this,function(){dojo.removeClass(a.root,"active");dojo.removeClass(a.root,"deactivating");dojo.addClass(a.root,"inactive");delete this._viewDeactivationTimers[a.id]}),
this.options.transitionDelay)):(dojo.removeClass(a.root,"active"),dojo.addClass(a.root,"inactive"));this.app.event("ViewDeactivatedEvent").publish(a)};d.prototype.hostView=function(a){a.added();dojo.removeClass(a.root,"active");dojo.addClass(a.root,"inactive");this.app.event("ViewHostedEvent").publish({region:this,view:a})};d.prototype.unhostView=function(a){a.removed();dojo.removeClass(a.root,"active");dojo.addClass(a.root,"inactive");this.app.event("ViewUnhostedEvent").publish({region:this,view:a})};
return d}();l.RegionAdapterBase=h})(b.ui||(b.ui={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(e){(function(l){var h=function(d){function a(c,k){var f=this;d.call(this,c,k);this.activeView=null;this.activeViews=[];this._scrollTimer=this.overlayElement=this.contentElement=this.contentContainer=this.contentTitle=this.contentHeader=this.titleBindingToken=null;this._scrollDelay=50;this._screenReaderNarrationDisabled=!1;if(a.instance)throw Error("PopupModalRegionAdapter is a singleton and has already been constructed once.");a.instance=this;null==this.app.modalRegionSingleton&&
(this.app.modalRegionSingleton=this);this.app.command("CloseModalRegion").register(this,function(){f.deactivate()});this.app.event("ViewActivatedEvent").subscribe(this,function(){0<f.activeViews.length&&setTimeout(function(){f.positionContent()},0)});this.app.event("ViewDimensionsChangedEvent").subscribe(this,function(){f.positionContent()})}__extends(a,d);a.getInstance=function(){return a.instance};a.prototype.activate=function(){0<this.activeViews.length&&(dojo.style(this.domElement,"opacity",0),
dojo.query(this.domElement).removeClass("inactive"),dojo.query(this.domElement).addClass("active"),dojo.query(this.overlayElement).removeClass("inactive"),dojo.query(this.overlayElement).addClass("active"))};a.prototype.deactivate=function(){dojo.query(this.domElement).removeClass("active");dojo.query(this.domElement).addClass("inactive");dojo.query(this.overlayElement).removeClass("active");dojo.query(this.overlayElement).addClass("inactive");this._screenReaderNarrationDisabled&&(this.app.command("EnableScreenReaderNarrate").execute(),
this._screenReaderNarrationDisabled=!1);this.activeView&&(this.activeView=null)};a.prototype.host=function(a){var k=this;d.prototype.host.call(this,a);this.domElement=a;dojo.query(this.domElement).removeClass("active");dojo.query(this.domElement).addClass("inactive");this.contentContainer=dojo.query(".modal-container")[0];this.contentElement=dojo.query(".modal-container-inner")[0];this.overlayElement=dojo.query(".modal-overlay")[0];dojo.connect(window,"onresize",function(){k.handleScrollEvent()});
dojo.connect(window,"onscroll",function(){k.handleScrollEvent()});this.app.event("WorkflowFormTextInputBlurredEvent").subscribe(this,function(){setTimeout(function(){k.positionContent()},100)})};a.prototype.handleScrollEvent=function(){var a=this;null!=this._scrollTimer&&(clearTimeout(this._scrollTimer),this._scrollTimer=null);this._scrollTimer=setTimeout(function(){a.positionContent()},0)};a.prototype.positionContent=function(){var a=this;if(this.contentContainer&&null!=this.activeView&&null!=this.activeView.root){var k=
dojo.position(this.contentContainer),f=dojo.window.getBox(),d=k.w;k.w>f.w?(d=f.w,dojo.style(this.contentElement,{"max-width":d+"px"})):dojo.style(this.contentElement,{"max-width":""});var b=k.h;k.h>f.h?(b=f.h,dojo.style(this.contentElement,{"max-height":b+"px"})):dojo.style(this.contentElement,{"max-height":""});dojo.style(this.contentContainer,{left:f.w/2-d/2+"px",top:f.h/2-b/2+"px"});setTimeout(function(){return dojo.style(a.domElement,"opacity",1)})}};a.prototype.showActiveView=function(a){a.isActive&&
(this.activeView=a,this.hideAllViews(),a.activated(),this.activate(),this.activeView=a,dojo.removeClass(a.root,"inactive"),dojo.addClass(a.root,"active"))};a.prototype.hideAllViews=function(){dojo.query("> .view",this.contentElement).removeClass("active");dojo.query("> .view",this.contentElement).addClass("inactive")};a.prototype.activateView=function(a){var k=this;e.utils.ArrayUtils.contains(this.activeViews,a)&&e.utils.ArrayUtils.removeItem(this.activeViews,a);this.activeViews.push(a);this._screenReaderNarrationDisabled||
(this._screenReaderNarrationDisabled=!0,this.app.command("DisableScreenReaderNarrate").execute());d.prototype.activateView.call(this,a);this.showActiveView(a);this._repositionOnImageLoaded(a.root);setTimeout(function(){return k.app.command("FocusOnFirstInputInView").execute(a)},400)};a.prototype.deactivateView=function(a){e.utils.ArrayUtils.removeItem(this.activeViews,a);0<this.activeViews.length?(this.showActiveView(this.activeViews[this.activeViews.length-1]),this.positionContent()):this.deactivate();
d.prototype.deactivateView.call(this,a)};a.prototype.deactivateActiveView=function(){if(this.activeView){null!=this.titleBindingToken&&(this.activeView.title.unbind(this.titleBindingToken),this.titleBindingToken=null);var a=this.activeView;this.activeView=null;this.deactivateView(a);e.utils.ArrayUtils.removeItem(this.activeViews,this.activeView)}};a.prototype.hostView=function(a){this.views.push(a);if(null==a.root){var k=b.resourceManager.fetch(a.markupResource,a.libraryId);if(null==k)return this.app.trace.warning("Could not fetch markup resource '{0}' in library '{1}'.".format(a.markupResource,
a.libraryId)),!1;a.root=dojo.create("div",{className:"view {0}".format(a.id)});a.root.innerHTML=k;dojo.place(a.root,this.contentElement,"last");a.viewModel&&a.attach(a.viewModel);this.app.viewManager.discoverRegions(a.root,a);this.positionContent()}else dojo.place(a.root,this.contentElement,"last");d.prototype.hostView.call(this,a);return!0};a.prototype.unhostView=function(a){a==this.activeView&&this.deactivateView(a);e.utils.ArrayUtils.removeItem(this.views,a);e.utils.ArrayUtils.removeItem(this.activeViews,
a);var k=new dojo.NodeList;k.push(a.root);k.orphan();d.prototype.unhostView.call(this,a)};a.prototype._repositionOnImageLoaded=function(a){var k=this;dojo.forEach(dojo.query("img",a),function(a){a.attached_ModalRegion_ImageLoadedConnection&&(dojo.disconnect(a.attached_ModalRegion_ImageLoadedConnection),delete a.attached_ModalRegion_ImageLoadedConnection);var c=dojo.connect(a,"load",k,function(a){k._imageLoaded(a)});a.attached_ModalRegion_ImageLoadedConnection=c})};a.prototype._imageLoaded=function(a){a=
a.target;a.attached_ModalRegion_ImageLoadedConnection&&(dojo.disconnect(a.attached_ModalRegion_ImageLoadedConnection),delete a.attached_ModalRegion_ImageLoadedConnection);this.positionContent()};a.instance=null;return a}(l.RegionAdapterBase);l.PopupModalRegionAdapter=h})(e.ui||(e.ui={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){var e=function(){function d(){}d.createCommands=function(a){};return d}();b.ApplicationCommands=e})(b.application||(b.application={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(e){(function(l){var h=function(){return function(a,c,k){this.impl=a;this.scope=c;this.canExecute=k}}(),d=function(){function a(a,k,f){this._entries={};this.app=null;this.name=a;this.app=k;this.isWrapper=!0;this.canExecuteChanged=new e.events.Event("{0}.CanExecuteChanged".format(a));this.preExecute=new e.events.Event("{0}.PreExecute".format(a));this.postExecute=new e.events.Event("{0}.PostExecute".format(a));this.canExecuteMode=null!=f&&void 0!=f?f:"all"}a.prototype.raiseCanExecuteChanged=
function(){this.canExecuteChanged.publish()};a.prototype.canExecute=function(a){if(this.isWrapper)return!1;for(var k in this._entries)if(this._entries.hasOwnProperty(k)){var f=this._entries[k];if(f.canExecute&&f.canExecute.apply(f.scope,arguments)){if("any"===this.canExecuteMode)return!0}else if("all"===this.canExecuteMode)return!1}return"any"===this.canExecuteMode?!1:!0};a.prototype.execute=function(a){var k=!1;if(this._entries)for(var f in this._entries)if(this._entries.hasOwnProperty(f)){k=!0;
break}if(k){if("all"!==this.canExecuteMode||this.canExecute.apply(this,arguments)){this.app&&this.app.debugMode&&(k="Command '{0}' executed.".format(this.name),console.debug?console.debug(k):console.log(k));this.preExecute.publish.apply(this.preExecute,arguments);for(f in this._entries)this._entries.hasOwnProperty(f)&&(k=this._entries[f],("any"!==this.canExecuteMode||k.canExecute.apply(k.scope,arguments))&&k.impl.apply(k.scope,arguments));this.postExecute.publish.apply(this.postExecute,arguments)}}else this.app.trace.debug("Command '{0}' executed but no implementation registered.".format(this.name))};
a.prototype.register=function(a,k,f){this.isWrapper=!1;var d=b.framework.utils.alphaNumericToken();k=new h(k,a,f||this.defaultCanExecuteFunction);this._entries[d]=k;a&&a instanceof b.framework.FrameworkObject&&a.trackCommandHandler(this,d);this.app.trace.debug("Registered an implementation for command '{0}'.".format(this.name));this.raiseCanExecuteChanged();return d};a.prototype.defaultCanExecuteFunction=function(){return!0};a.prototype.unregister=function(a){this.isWrapper=!1;if(!this._entries.hasOwnProperty(a))return!1;
delete this._entries[a];this.app.trace.debug("Unregistered an implementation for command '{0}'.".format(this.name));this.raiseCanExecuteChanged();return!0};a.prototype.clear=function(){this._entries={};this.raiseCanExecuteChanged();this.app.trace.debug("Cleared all implementations of command '{0}'.".format(this.name))};return a}();l.Command=d})(e.commands||(e.commands={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(e){(function(e){var h=function(){function d(a){this.commands={};this.app=a}d.prototype.clear=function(){for(var a in this.commands)this.commands.hasOwnProperty(a)&&this.commands[a].clear()};d.prototype.command=function(a){var c=this.commands[a];return c?c:(a=new b.framework.commands.Command(a,this.app),a.isWrapper=!0,this.commands[a.name]=a)};return d}();e.CommandRegistry=h})(e.commands||(e.commands={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(e){(function(e){function h(a){var c=[-1399014851,-706512510];b._nonConfigs&&(c=b._nonConfigs.map(function(a){return String.quickHashCode(a.toLowerCase())}));var k=document.createElement("a");k.href=a.toLowerCase();a=k.href;for(a=decodeURIComponent(a);-1<a.indexOf("%");)a=decodeURIComponent(a);a=a.replace(/[\\\/:]+/g,"/");var f=a.split(/[\\\/:]/);a=f.map(function(a){return a.toLowerCase()}).map(function(a,c){return c<f.length-1?[a,f[c+1]]:null});a.pop();var d=!1;a.forEach(function(a){a=
String.quickHashCode(a[0]+"/"+a[1]);-1<c.indexOf(a)&&(d=!0)});return d}var d=function(){function a(a){this._targetConfigUri=null;this.app=a}a.prototype.loadConfigurationTree=function(a,k){var f=this;this._targetConfigUri=a;if(h(this._targetConfigUri)){var d=Error("Configuration cannot be loaded from this location.");this.app.event("ConfigurationLoadFailedEvent").publish(d)}else this.app.fetchConfigResource({url:this._targetConfigUri,load:function(a){null!=k&&void 0!=k&&k(a)},error:function(a){return f.app.event("ConfigurationLoadFailedEvent").publish(a)}})};
return a}();e.ConfigurationLoader=d;e.checkList=h})(e.config||(e.config={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));(function(b){(function(b){(function(b){var e=function(){return function(d,a){this.locales=[];this.position=0;this.omitStyles=!1;this.id=d;this.uri=a}}();b.LibraryConfig=e})(b.config||(b.config={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(e){(function(e){var h=function(d){function a(a,k){d.call(this,a,k)}__extends(a,d);a.prototype.initialize=function(a){};a.prototype.getResource=function(a,k){return this.app.getResource(this.libraryId,a,k)};return a}(b.framework.FrameworkObject);e.ViewModelBase=h})(e.ui||(e.ui={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){var e=function(){return function(d,a,c){this.viewId=d;this.moduleName=a;this.typeName=c}}();b.ViewConfig=e})(b.config||(b.config={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){var e=function(){return function(d,a,c){this.libraryId="";this.configuration={};this.viewModelId=d;this.moduleName=a;this.typeName=c}}();b.ViewModelConfig=e})(b.config||(b.config={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){var e=function(){return function(d,a,c,k){this.viewConfigs=[];this.viewModelConfigs=[];this.moduleName=d;this.moduleType=a;this.configuration=c;this.libraryId=k}}();b.ModuleConfig=e})(b.config||(b.config={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){var e=function(){return function(d,a){this.viewModelType=null;this.configuration={};this.markup=this.typeName="";this.id=d;this.libraryId=a}}();b.WidgetConfig=e})(b.config||(b.config={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(e){(function(e){var h=function(){function d(a){this.application={};this.viewerId=this.version="unknown";this.defaultLibraryId="";this.globals=null;this.libraryConfigs=[];this.moduleConfigs=[];this.widgetConfigs=[];this.libraryModules={};this.externalLocaleReferences=[];this.app=a}d.prototype.parse=function(a,c){var k="object"===typeof a?a:JSON.parse(a);k.configuration||(k.configuration={version:"1.0",viewerId:"unknown",application:{},defaultLibraryId:"",libraries:[],modules:[],
widgets:[]});var f,d,e;try{this.application=k.configuration.application||{},this.version=k.configuration.version||"1.0",this.viewerId=k.configuration.viewerId||"unknown",this.defaultLibraryId=k.configuration.defaultLibraryId||null,f=k.configuration.libraries||[],d=k.configuration.modules||[],e=k.configuration.widgets||[],this.app.trace.debug("Config version: {0}.".format(this.version))}catch(h){this.app.trace.error("Error reading configuration: {0}".format(h),h);return}if(f&&0<f.length)for(var l=
0;l<f.length;++l){var p=f[l],p=this.app.translateConfiguration(p.id,p);null==this.defaultLibraryId&&(this.defaultLibraryId=p.id);var m=new b.framework.config.LibraryConfig(p.id,p.uri);m.position=l;m.omitStyles=p.omitStyles||!1;this.libraryConfigs.push(m);this.libraryModules[p.id]=[];if(p.locales)for(k=0;k<p.locales.length;++k){var n=p.locales[k];n.locale=n.locale.toLowerCase();n.hasOwnProperty("uri")&&(n.libraryId=p.id,m.locales.push(n),this.externalLocaleReferences.push(n))}}if(d&&0<d.length)for(k=
0;k<d.length;++k){f=d[k];l=f.libraryId;l||(l=this.defaultLibraryId);p=new b.framework.config.ModuleConfig(f.moduleName,f.moduleType,f.configuration,l);this.libraryModules[l]?this.libraryModules[l].push(p):this.app.trace.error("Unknown library '{0}'.".format(l));if(n=f.views)for(m=0;m<n.length;++m){var t=n[m],u=new b.framework.config.ViewConfig(t.id,f.moduleName,t.type||"geocortex.framework.ui.ViewBase");p.viewConfigs.push(u);u.libraryId=t.libraryId||l;u.viewModelId=t.viewModelId||null;u.markupResource=
t.markup||null;u.configuration=t.configuration||{};u.regionName=t.region||null;u.isManaged=t.isManaged||!1;u.isVisible=t.visible||!1;u.title=t.title||null;u.description=t.description||"";u.iconUri=t.iconUri||""}if(n=f.viewModels)for(m=0;m<n.length;++m)t=n[m],u=new b.framework.config.ViewModelConfig(t.id,f.moduleName,t.type),p.viewModelConfigs.push(u),u.libraryId=t.libraryId||l,t.configuration&&(u.configuration=t.configuration);this.moduleConfigs.push(p)}if(e&&0<e.length)for(l=0;l<e.length;++l)d=new b.framework.config.WidgetConfig(e[l].id,
e[l].libraryId||this.defaultLibraryId),dojo.safeMixin(d,e[l]),this.widgetConfigs.push(d);c&&c(this)};return d}();e.ConfigurationModel=h})(e.config||(e.config={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(e){(function(e){var h=function(){function d(a){this.events={};this.app=a}d.prototype.clear=function(){for(var a in this.events)this.events.hasOwnProperty(a)&&this.events[a].clear()};d.prototype.event=function(a){var c=this.events[a];c||(c=new b.framework.events.Event(a,this.app),this.events[a]=c);return c};return d}();e.EventRegistry=h})(e.events||(e.events={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){var e=function(){function d(){this.numKeys=this.sizeInChars=this.capacity=d.UNKNOWN}d.UNKNOWN=-1;return d}();b.StorageStats=e})(b.storage||(b.storage={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){var e=function(){function d(a){this.app=a;this.keyNamespace=a.id}d.prototype.initialize=function(){};d.prototype.isSupported=function(){return!1};d.prototype.isFull=function(){return!1};d.prototype.getStats=function(){return new b.StorageStats};d.prototype.getScore=function(){return 0};d.prototype.clear=function(a,c){};d.prototype.clearAllData=function(a,c){};d.prototype.get=function(a,c,k,f){};d.prototype.set=function(a,c,k,f,d){};d.prototype.remove=function(a,
c,k,f){};return d}();b.StorageProviderBase=e})(b.storage||(b.storage={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){var e=function(){function a(){}a.QUOTA_EXCEEDED_ERR="QuotaExceededError";a.NOT_FOUND_ERR="NotFoundError";a.SECURITY_ERR="SecurityError";a.INVALID_MODIFICATION_ERR="InvalidModificationError";a.INVALID_STATE_ERR="InvalidStateError";return a}();b.ErrorType=e;var d=function(a){function c(){a.apply(this,arguments);this._isInitializing=!1;this._initializationErrorCallback=this._initializationSuccessCallback=null;this._defaultDesiredSize=524288E3;this._storageTypeTemporary=
0;this._storageTypePersistent=1;this._error=null;this._isInitialized=this._isFull=!1}__extends(c,a);c.prototype.initialize=function(c){var f=this;if(!this._isInitialized&&!this._error)if(a.prototype.initialize.call(this),this.isSupported()){c||(this.app.configuration&&this.app.configuration.offlineStorageSpaceMb&&(c=1048576*parseInt(this.app.configuration.offlineStorageSpaceMb,10)),c||(c=this._defaultDesiredSize));var b=function(a){f._isInitialized||(f._isInitialized=!0,f.app.trace.debug("Filesystem '{0}' initialized successfully.".format(a.name)),
f._filesystem=a,f._error=null,f._initializationSuccessCallback(a))};navigator.webkitPersistentStorage||window.webkitStorageInfo?this._requestQuota(this._storageTypePersistent,c,function(a){this._isInitialized||(f.app.trace.debug("HTML5 File API quota granted. Size: {0} bytes.".format(a)),f._requestFileSystem(window.PERSISTENT,c,b,function(a){a=f._shapeError(a);f._error=a;f._initializationErrorCallback(a)}))},function(a){a=f._shapeError(a);f._error=a;f.app.trace.error("Error requesting filesystem quota: {0}".format(a.toString()),
a);f._initializationErrorCallback(a)}):this._requestFileSystem(LocalFileSystem.PERSISTENT,c,b,function(a){a=f._shapeError(a);f._error=a;f._initializationErrorCallback(a)})}else this.app.trace.warning("The HTML5 storage provider could not be initialized. The File API is not supported by this browser.")};c.prototype.isSupported=function(){return!(!window.requestFileSystem&&!window.webkitRequestFileSystem)};c.prototype.isFull=function(){return this._isFull};c.prototype.getScore=function(){this.initialize();
return 5};c.prototype.getStats=function(){this.initialize();return new b.StorageStats};c.prototype._ensureInitializedThen=function(a){var c=null;if(this._isInitialized)a.apply(this,[]);else if(this._isInitializing)c=dojo.connect(this,"_initializationSuccessCallback",function(){dojo.disconnect(c);a.apply(b,[])});else{var b=this;this._isInitializing=!0;c=dojo.connect(this,"_initializationSuccessCallback",function(){dojo.disconnect(c);a.apply(b,[])});this.initialize()}};c.prototype._silentlyEnsureInitializeThen=
function(a,c){var b=this;this._isInitialized||this._isInitializing||!navigator.webkitPersistentStorage&&!window.webkitStorageInfo?b._ensureInitializedThen(a):this._queryUsageAndQuota(this._storageTypePersistent,function(d,e){0==d&&0==e?c():b._ensureInitializedThen(a)},function(a){a=b._shapeError(a);b.app.trace.warning("An error occurred while trying to fetch file API usage information: {0}".format(a.toString()))})};c.prototype._requestFileSystem=function(a,c,b,d){if(window.requestFileSystem)window.requestFileSystem(a,
c,b,d);else if(window.webkitRequestFileSystem)window.webkitRequestFileSystem(a,c,b,d);else throw Error("No request filesystem method found");};c.prototype._requestQuota=function(a,c,b,d){var e=navigator,h=window;switch(a){case this._storageTypeTemporary:e.webkitTemporaryStorage&&e.webkitTemporaryStorage.requestQuota?e.webkitTemporaryStorage.requestQuota(c,b,d):h.webkitStorageInfo&&h.webkitStorageInfo.requestQuota&&h.webkitStorageInfo.requestQuota(window.TEMPORARY,c,b,d);break;case this._storageTypePersistent:e.webkitPersistentStorage&&
e.webkitPersistentStorage.requestQuota?e.webkitPersistentStorage.requestQuota(c,b,d):h.webkitStorageInfo&&h.webkitStorageInfo.requestQuota&&h.webkitStorageInfo.requestQuota(window.PERSISTENT,c,b,d)}};c.prototype._queryUsageAndQuota=function(a,c,b){var d=navigator,e=window;switch(a){case this._storageTypeTemporary:d.webkitTemporaryStorage&&d.webkitTemporaryStorage.queryUsageAndQuota?d.webkitTemporaryStorage.queryUsageAndQuota(c,b):e.webkitStorageInfo&&e.webkitStorageInfo.queryUsageAndQuota&&e.webkitStorageInfo.queryUsageAndQuota(window.TEMPORARY,
c,b);break;case this._storageTypePersistent:d.webkitPersistentStorage&&d.webkitPersistentStorage.queryUsageAndQuota?d.webkitPersistentStorage.queryUsageAndQuota(c,b):e.webkitStorageInfo&&e.webkitStorageInfo.queryUsageAndQuota&&e.webkitStorageInfo.queryUsageAndQuota(window.PERSISTENT,c,b)}};c.prototype._writeValue=function(a,c,b,d,e){function h(a){a=n._shapeError(a);d&&d(a)}function l(c){e?n._filesystem.root.getFile(a+".json",{create:!0,exclusive:!1},c,h):n._filesystem.root.getDirectory(t,{create:!0,
exclusive:!1},function(f){n._filesystem.root.getFile(t+"/"+a+".json",{create:!0,exclusive:!1},c,h)},h)}function m(a){a.createWriter(function(a){a.truncate(0)});a.createWriter(function(a){a.onwriteend=function(a){n.app.trace.debug("Wrote {0} bytes to filesystem.".format(a.total))};a.onerror=function(a){a=n._shapeError(a);n.app.trace.debug("Write failed: {0}".format(a));d&&d(a)};var k=!1;try{var e=!1;"undefined"!==typeof window.cordova&&window.cordova.exec&&(a.write(c),e=!0);if(!e&&"undefined"!==typeof Blob)try{var l=
new Blob([c],{type:"text/plain"});a.write(l);e=!0}catch(p){n.app.trace.debug('Failed to create blob "'+p+'". Falling back to BlobBuilder.')}if(!e){e=null;"undefined"!==typeof BlobBuilder?e=new BlobBuilder:"undefined"!==typeof WebKitBlobBuilder?e=new WebKitBlobBuilder:"undefined"!==typeof MSBlobBuilder&&(e=new MSBlobBuilder);if(!e)throw Error("Error writing to File API file: No BlobBuilder implementation found.");e.append(c);a.write(e.getBlob("text/plain"))}}catch(x){k=!0,h(x)}k||b()})}var n=this,
t=e?"":this.keyNamespace;try{l(m)}catch(u){h(u)}};c.prototype._readValue=function(a,c,b,d){function l(a){a.name&&a.name===e.NOT_FOUND_ERR?c(null):(a=r._shapeError(a),b&&b(a))}var r=this;r._filesystem.root.getFile((d?"":this.keyNamespace+"/")+a+".json",{},function(a){a.file(function(a){var k=new FileReader;k.onloadend=function(a){c(this.result)};try{k.readAsText(a)}catch(b){l(b)}},l)},l)};c.prototype._shapeError=function(a){var c="";switch(a.name){case e.QUOTA_EXCEEDED_ERR:c="Quota Exceeded.";break;
case e.NOT_FOUND_ERR:c="File not found.";break;case e.SECURITY_ERR:c="Security error.";break;case e.INVALID_MODIFICATION_ERR:c="Invalid modification.";break;case e.INVALID_STATE_ERR:c="Invalid state.";break;default:c="Unknown Error."}return a=Error("File error: {0}.".format(c))};c.prototype.clear=function(a,c){function b(a){c&&(a=d._shapeError(a),c(a))}var d=this;this._silentlyEnsureInitializeThen(function(){d._filesystem.root.getDirectory(this.keyNamespace,{create:!1},function(c){c.removeRecursively(function(){a&&
a()},b)},function(c){c.name===e.NOT_FOUND_ERR?a():b(c)})},a)};c.prototype.clearAllData=function(a,c){var b=this;this._silentlyEnsureInitializeThen(function(){try{var d=b._filesystem.root.createReader(),e=[],h=0,l=0,m=new dojo.Deferred,n=new dojo.Deferred,t=new dojo.DeferredList([m,n]);t.then(function(b){l?c&&c(Error("{0} errors were encountered while clearing the storage provider.".format(l))):a&&a()});t.addErrback(function(a){c&&(a=b._shapeError(a),c(a))});var u=function(){var a=function(){--h;0>=
h&&(m.resolve(),n.resolve())},c=function(a){a=b._shapeError(a);b.app.trace.warning("Error removing local file: {0}.".format(a.toString()));--h;++l;0>=h&&m.resolve()},f=function(f){f.remove(a,c)},k=function(a){a=b._shapeError(a);b.app.trace.warning("Could not obtain file for removal: {0}.".format(a.toString()));n.errback(a)};h=e.length;if(0===h)m.resolve(),n.resolve();else if(0===e.length)m.resolve(),n.resolve();else for(var d=0;d<e.length;++d)try{b._filesystem.root.getFile(e[d],{},f,k)}catch(w){w=
b._shapeError(w),t.errback(w)}},z=function(){},s=function(a){a=b._shapeError(a);b.app.trace.warning("Error removing local folder: {0}.".format(a.toString()));++l;n.resolve()},y=function(){d.readEntries(function(a){if(a.length){for(var c=0;c<a.length;++c){var f=a[c];f.isDirectory?f.removeRecursively(z,s):e.push(f.fullPath)}y()}else u()},function(a){a=b._shapeError(a);c&&c(a)})};y()}catch(B){B=b._shapeError(B),c&&c(B)}},a)};c.prototype.get=function(a,c,b,d){var e=this;this._silentlyEnsureInitializeThen(function(){try{e._readValue(a,
c,b,d)}catch(h){h=e._shapeError(h),b&&b(h)}},function(){c(null)})};c.prototype.set=function(a,c,b,d,e){var h=this;this._ensureInitializedThen(function(){try{h._writeValue(a,c,b,d,e)}catch(l){l=h._shapeError(l),d&&d(l)}})};c.prototype.remove=function(a,c,b,d){var e=this,h=d?"":this.keyNamespace;this._ensureInitializedThen(function(){try{e._filesystem.root.getFile(h+"/"+a+".json",{create:!1},function(a){a.remove(c,function(a){a=e._shapeError(a);b&&b(a)})},function(a){a=e._shapeError(a);e.app.trace.debug("Could not obtain file for removal: {0}.".format(a.toString()));
b&&b(a)})}catch(d){d=e._shapeError(d),b&&b(d)}})};return c}(b.StorageProviderBase);b.FileStorageProvider=d})(b.storage||(b.storage={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){var e=function(d){function a(){d.apply(this,arguments);this._isFull=!1}__extends(a,d);a.prototype.initialize=function(){d.prototype.initialize.call(this);this._localStorage=window.localStorage};a.prototype.isSupported=function(){this._localStorage||this.initialize();return!!this._localStorage};a.prototype.isFull=function(){this._localStorage||this.initialize();return this._isFull};a.prototype.getScore=function(){this._localStorage||this.initialize();return 5};
a.prototype.getStats=function(){this._localStorage||this.initialize();return new b.StorageStats};a.prototype.clear=function(c,b){this._localStorage||this.initialize();for(var f=null,d=RegExp("^"+this.keyNamespace+a._namespaceSeperator),e=0,h=this._localStorage.length;e<h;e++){var l=this._localStorage.key(e);if(d.test(l))try{this._localStorage.removeItem(l),e--,h--}catch(p){f=p}}null!=f?b&&b(f):c&&c()};a.prototype.clearAllData=function(a,b){this._localStorage||this.initialize();try{this._localStorage.clear(),
a&&a()}catch(f){b&&b(f)}};a.prototype.get=function(c,b,f,d){c=d?c:"{0}{1}{2}".format(this.keyNamespace,a._namespaceSeperator,c);this._localStorage||this.initialize();try{var e=this._localStorage.getItem(c);b&&b(e)}catch(h){f&&f(h)}};a.prototype.set=function(c,b,f,d,e){c=e?c:"{0}{1}{2}".format(this.keyNamespace,a._namespaceSeperator,c);this._localStorage||this.initialize();try{this._localStorage.setItem(c,b),f&&f()}catch(h){d&&d(h)}};a.prototype.remove=function(c,b,f,d){c=d?c:"{0}{1}{2}".format(this.keyNamespace,
a._namespaceSeperator,c);this._localStorage||this.initialize();try{this._localStorage.removeItem(c),b&&b()}catch(e){f&&f(e)}};a._namespaceSeperator="\u2192";return a}(b.StorageProviderBase);b.LocalStorageProvider=e})(b.storage||(b.storage={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){var e=function(){function d(a,c){this.app=a;this._rootNamespace=this._sanitizeKey(c?c.toString():"framework."+this.app.id)}d.prototype.initialize=function(a){a?this._provider=a:b.HttpStorageProvider.isSupported()?this._provider=new b.HttpStorageProvider(this.app):(a=new b.FileStorageProvider(this.app),a.isSupported()?this._provider=a:this._provider=new b.LocalStorageProvider(this.app));this._provider.keyNamespace=this._rootNamespace};d.prototype.hasProvider=
function(){return null!=this._provider};d.prototype._yield=function(a){return a?function(){var c=arguments;setTimeout(function(){a.apply(this,c)},0)}:function(){}};d.prototype._yieldError=function(a){return a?function(){var c=arguments;setTimeout(function(){a.apply(this,c)},0)}:function(){}};d.prototype._yieldGet=function(a){return a?function(){var c=arguments;setTimeout(function(){a.apply(this,c)},0)}:function(){}};d.prototype.clear=function(a,c){this._provider&&this._provider.clear(this._yield(a),
this._yieldError(c))};d.prototype.clearAllData=function(a,c){this._provider&&this._provider.clearAllData(this._yield(a),this._yieldError(c))};d.prototype._sanitizeKey=function(a){return a.replace(RegExp("[/\\\\:,?=|]","gm"),"_")};d.prototype.set=function(a,c,b,f,d){var e=new dojo.Deferred,h=this._sanitizeKey(a);d=d||!1;this._provider&&this._provider.set(h,c,this._yield(function(){e&&-1==e.fired&&e.resolve(c);b&&b(a,c)}),this._yieldError(function(b){e&&-1==e.fired&&e.resolve(b);f&&f(b,a,c)}),d);return e};
d.prototype.get=function(a,c,b,f){var d=new dojo.Deferred,e=this._sanitizeKey(a);f=f||!1;this._provider&&this._provider.get(e,this._yieldGet(function(b){d&&-1==d.fired&&d.resolve(b);c&&c(b,a)}),this._yieldError(function(c){d&&-1==d.fired&&d.resolve(c);b&&b(c,a)}),f);return d};d.prototype.remove=function(a,c,b,f){var d=new dojo.Deferred,e=this._sanitizeKey(a);f=f||!1;this._provider&&this._provider.remove(e,this._yield(function(){d&&-1==d.fired&&d.resolve(a);c&&c(a)}),this._yieldError(function(c){d&&
-1==d.fired&&d.resolve(c);b&&b(c,a)}),f);return d};return d}();b.Store=e})(b.storage||(b.storage={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));(function(b){(function(b){(function(b){var e=function(){return function(b,a){this.view=b;this.region=a}}();b.ViewDimensionsChangedArgs=e})(b.events||(b.events={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(e){(function(l){var h=function(){return function(){}}();l.ViewManagerRegionEntry=h;var d=function(){function a(a){this._views=[];this._hostedRegions=[];this._pendingRegions=[];this.app=a;this._registerCommands()}a.prototype.shutdown=function(){for(var a=0;a<this._hostedRegions.length;++a)this.destroyRegion(this._hostedRegions[a]);for(var b=this._hostedRegions.length=0;b<this._views.length;++b)this.destroyView(this._views[b]);for(a=this._views.length=0;a<this._pendingRegions.length;++a){for(var f=
this._pendingRegions[a],b=0;b<f.views.length;++b)this.destroyView(f.views[b]);f.views=[]}this._pendingRegions.length=0};a.prototype._registerCommands=function(){this.app.commandRegistry.command("ActivateView").register(this,function(a){var b=this.getViewById(a);b?this.activateView(b):this.app.trace.warning("ActivateView: Could not find view '{0}'.".format(a))});this.app.commandRegistry.command("DeactivateView").register(this,function(a){var b=this.getViewById(a);b?this.deactivateView(b):this.app.trace.warning("DeactivateView: Could not find view '{0}'.".format(a))});
this.app.commandRegistry.command("ToggleView").register(this,function(a){var b=this.getViewById(a);b?this.toggleView(b):this.app.trace.warning("ToggleView: Could not find view '{0}'.".format(a))});this.app.commandRegistry.command("DestroyView").register(this,function(a){var b=this.getViewById(a);b?this.destroyView(b):this.app.trace.warning("DestroyView: Could not find view '{0}'.".format(a))})};a.prototype.activateView=function(a){if(!a.id)return this.app.trace.error("ViewManager: Invalid or nonexistent view passed to activateView."),
!1;var b=this.getRegionForViewId(a.id);if(!b){if(!a.regionName)return this.app.trace.warning("Could not activate view '{0}' - view is not associated with a region.".format(a.id)),!1;if(b=this.getExistingRegionByName(a.regionName))return b.hostView(a),b.activateView(a),!0;(b=this._getPendingRegionEntryByName(a.regionName))?e.utils.ArrayUtils.contains(b.views,a)?this.app.trace.debug("View '{0}' re-added to pending region '{1}'.".format(a.id,a.regionName)):b.views.push(a):(b=new h,b.name=a.regionName,
b.views=[a],this._pendingRegions.push(b));return!1}b.activateView(a);return!0};a.prototype.deactivateView=function(a){if(!a.id)return this.app.trace.error("ViewManager: Invalid or nonexistent view passed to deactivateView."),!1;var b=this.getRegionForViewId(a.id);if(!b)return this.app.trace.debug("Could not find region for view '{0}'.".format(a.id)),!1;b.deactivateView(a);return!0};a.prototype.toggleView=function(a){a.isActive?this.deactivateView(a):this.activateView(a)};a.prototype.createView=function(a){var d=
a.viewId||a.id;if(d&&this.getViewById(d))this.app.trace.error("Could not create view '{0}' - a view with that ID already exists.".format(d));else{var f=a.typeName||a.type||"geocortex.framework.ui.ViewBase",g=null;try{g=this.app.instantiateFrameworkObject(f,a.libraryId)}catch(l){return this.app.trace.error("Could not instantiate view with type '{0}' - type was not found or view constructor failed.".format(f),l),null}f=a.isVisible||a.visible;g.id=null==d?"View-"+b.framework.utils.alphaNumericToken():
d;g.markupResource=a.markupResource||a.markup;g.regionName=a.regionName||a.region;g.configuration=a.configuration||{};g.isManaged=a.isManaged||!1;g.title.set(a.title||"");g.description.set(a.description);g.iconUri.set(a.iconUri);a.viewModel&&(g.viewModel=a.viewModel);this._views.push(g);if(g.regionName)(a=this.getExistingRegionByName(g.regionName))?(a.hostView(g),f&&a.activateView(g)):(f&&(g.___shouldActivate=!0),(a=this._getPendingRegionEntryByName(g.regionName))?e.utils.ArrayUtils.contains(a.views,
g)?this.app.trace.debug("View '{0}' re-added to pending region '{1}'.".format(g.id,g.regionName)):a.views.push(g):(a=new h,a.name=g.regionName,a.views=[g],this._pendingRegions.push(a)));else{a=b.resourceManager.fetch(g.markupResource,g.libraryId);if(null==a)return this.app.trace.warning("Could not fetch markup resource '{0}' in library '{1}'.".format(g.markupResource,g.libraryId)),null;g.root=dojo.create("div");g.root.innerHTML=a;g.root.children&&1===g.root.children.length&&(g.root=g.root.children[0])}return g}};
a.prototype.create=function(a,b,f,d,h){a=new e.config.ViewConfig(null,null,a);a.markupResource=f;a.regionName=d;a.configuration={};f=this.createView(a);if(null===f)return f;d=null;try{d=this.app.instantiateFrameworkObject(b||"geocortex.framework.ui.ViewModelBase",d.libraryId),d.initialize({})}catch(l){return this.app.trace.error("Could not create view model with type '{0}' - type was not found, not a view model, or failed to construct: {1}".format(a.typeName,l.message),l),null}f.attach(d);this.activateView(f);
return f};a.prototype.destroyView=function(a){for(var b=this.getRegionForViewId(a.id),d=window.document.activeElement;d;){if(a.root===d){window.document.activeElement.blur();break}d=d.parentElement}null!=b&&(b.deactivateView(a),b.unhostView(a));a.destroy();if(null!=a.childRegions)for(b=0;b<a.childRegions.length;++b)this.destroyRegion(a.childRegions[b]);a.childRegions.length=0;null!=a.root&&(b=new dojo.NodeList,b.push(a.root),b.orphan());e.utils.ArrayUtils.removeItem(this._views,a);a.onDestroy()};
a.prototype.destroyRegion=function(a){if(null!=a.views)for(var b=a.views.length-1;0<=b;b--)this.destroyView(a.views[b]);e.utils.ArrayUtils.removeItem(this._hostedRegions,a);a.unhost()};a.prototype.discoverRegions=function(a,b){var d=this;null!=a&&dojo.query("[data-region-name]",a).forEach(function(a){var c=dojo.attr(a,"data-region-name");if(d.getExistingRegionByName(c))d.app.trace.error("Region '{0}' already exists.".format(c));else{var e=d._getPendingRegionEntryByName(c),h=null;e&&d._removePendingRegionEntry(c);
var l=dojo.attr(a,"data-region-adapter"),m=null;try{l||(l="geocortex.framework.ui.DivRegionAdapter"),m=dojo.getObject(l,!0),h=new m(c,d.app)}catch(n){return d.app.trace.error("Could not instantiate region with type '{0}' - type was not found.".format(l),n),null}l=dojo.attr(a,"data-region-options");c={};if(l)for(l=l.split(","),m=0;m<l.length;m++){var t=l[m].split("=");c[t[0]]=1<t.length?t[1]:""}h.host(a,c);d._hostedRegions.push(h);null!=b&&(b.childRegions.push(h),h.ownerView=b);if(e)for(a=0;a<e.views.length;++a)c=
e.views[a],d._views.push(c),h.hostView(c),c.___shouldActivate&&(delete c.___shouldActivate,h.activateView(c))}})};a.prototype.getExistingRegionByName=function(a){for(var b=0;b<this._hostedRegions.length;++b){var d=this._hostedRegions[b];if(d.name==a)return d}return null};a.prototype._getPendingRegionEntryByName=function(a){for(var b=0;b<this._pendingRegions.length;++b){var d=this._pendingRegions[b];if(d.name==a)return d}return null};a.prototype._removePendingRegionEntry=function(a){for(var b=-1,d=
0;d<this._pendingRegions.length;++d)if(this._pendingRegions[d].name==a){b=d;break}return-1<d?(e.utils.ArrayUtils.remove(this._pendingRegions,b,b),!0):!1};a.prototype.getRegionForViewId=function(a){for(var b=0;b<this._hostedRegions.length;++b)for(var d=this._hostedRegions[b],e=0;e<d.views.length;++e)if(d.views[e].id===a)return d;return null};a.prototype.getViewById=function(a){for(var b=0;b<this._views.length;++b){var d=this._views[b];if(d.id&&d.id===a)return d}};a.prototype.getViews=function(){return this._views};
a.prototype.notifyDimensionsChanged=function(a){var d=this.getRegionForViewId(a.id);a=new b.framework.events.ViewDimensionsChangedArgs(a,d);this.app.eventRegistry.event("ViewDimensionsChangedEvent").publish(a)};return a}();l.ViewManager=d})(e.ui||(e.ui={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){var e=function(){function b(a){this.app=a}b.prototype._traceImpl=function(a,c,b){("debug"!==a&&"trace"!==a||this.app.debugMode)&&this.app&&this.app.event("TraceEvent").publish({level:a,timestamp:new Date,message:c,stack:b})};b.prototype._stackTraceFromException=function(a){return"undefined"!==typeof a?a.stack||a.backtrace||a.stacktrace:null};b.prototype.debug=function(a){this._traceImpl("debug",a)};b.prototype.trace=function(a){this._traceImpl("trace",a)};b.prototype.info=
function(a){this._traceImpl("info",a)};b.prototype.alert=function(a){this._traceImpl("alert",a)};b.prototype.warning=function(a){this._traceImpl("warning",a)};b.prototype.error=function(a,c){this._traceImpl("error",a,this._stackTraceFromException(c))};b.prototype.exception=function(a,c){this._traceImpl("error",a,this._stackTraceFromException(c))};return b}();b.Trace=e})(b.utils||(b.utils={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(l){var h=function(d){function a(a,b){d.call(this,a,b);this.behaviorNames=[];this.configuration={}}__extends(a,d);a.prototype.initialize=function(a){this.configuration=a;this.behaviorNames=this.app.behaviorRegistry.loadBehaviorsFromConfig(this,a)};a.prototype.onDestroy=function(){d.prototype.onDestroy.call(this);for(var a=0;a<this.behaviorNames.length;a++)this.app.behaviorRegistry.remove(this.behaviorNames[a]);this.behaviorNames.length=0};a.prototype.shutdown=function(a){};
a.prototype.exportState=function(){return new b.SimplePromise(function(a,b){return a(null)})};a.prototype.applyState=function(a){return new b.SimplePromise(function(a,c){return a()})};a.prototype.getStateFilter=function(){return null};return a}(b.FrameworkObject);l.ModuleBase=h})(b.application||(b.application={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){var e=function(){function b(a){this._modules={};this.app=a}b.prototype.shutdown=function(a){for(var c in this._modules)this._modules.hasOwnProperty(c)&&(this._modules[c].shutdown(a),this._modules[c].destroy());this._modules={}};b.prototype.instantiate=function(a,c){return null==a?null:this.app.instantiateFrameworkObject(a,c)};b.prototype.markModuleLoaded=function(a,c){this._modules[a]=c;this.app.event("ModuleInitializedEvent").publish(a)};b.prototype.moduleIsLoaded=
function(a){return null!=this._modules[a]};b.prototype.notifyModuleLoaded=function(a,c){if(this.moduleIsLoaded(a)&&null!=c)c(a);else var b=this.app.event("ModuleInitializedEvent").subscribe(this,function(d){if(d==a)try{c(d)}finally{this.app.event("ModuleInitializedEvent").unsubscribe(b)}})};return b}();b.ModuleManager=e})(b.application||(b.application={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(e){(function(l){var h=function(){function d(a,c,d,f){this.version="2.7";this.allowCrossDomainConfig=!1;this.configuration={};this.localServerAddress="";this.localServerNamespace=this.localServerToken=null;this.urlParameters={};this.allLibrariesLoaded=this.isHttpsMode=this.developmentMode=!1;this.modalRegionSingleton=this.configPreprocessor=null;this._resourceDictionaries={};this.frameworkObjects={};this._pendingFrameworkObjectRequests={};this._initialStateAppliedCount=0;this.id=
d||"default";this.configTokens=f||{};this.trace=new e.utils.Trace(this);this.moduleManager=new b.framework.application.ModuleManager(this);this.commandRegistry=new b.framework.commands.CommandRegistry(this);this.eventRegistry=new b.framework.events.EventRegistry(this);this.behaviorRegistry=new b.framework.behaviors.BehaviorRegistry(this);this.viewManager=new b.framework.ui.ViewManager(this);this.command=dojo.hitch(this.commandRegistry,this.commandRegistry.command);this.event=dojo.hitch(this.eventRegistry,
this.eventRegistry.event);this.behavior=dojo.hitch(this.behaviorRegistry,this.behaviorRegistry.behavior);this.hostElement=c||dojo.body();this.store=new b.framework.storage.Store(this,this.id);this.store.initialize();null==a?this.configModel=new e.config.ConfigurationModel(this):"object"===typeof a?(this.configObject=a,this.configUri=null):(this.configModel=null,this.configUri=a.trim());this.isOffline=new Observable(!1);this.isOffline.bind(this,function(a){a?this.eventRegistry.event("ApplicationOfflineEvent").publish():
this.eventRegistry.event("ApplicationOnlineEvent").publish()});this.isNative=new Observable(!1);this.isNative.bind(this,function(a){a?this.eventRegistry.event("ApplicationNativeReadyEvent").publish():this.eventRegistry.event("ApplicationNativeRemovedEvent").publish()});b.framework.application.ApplicationCommands.createCommands(this);a=document.URL;a=a.substring(a.indexOf("?")+1,a.length);this.urlParameters=dojo.queryToObject(a)||{};a=window.location.protocol;0>a.indexOf(":")&&(a+=":");c=window.location.pathname.lastIndexOf("/");
d="/";-1<c&&(d=window.location.pathname.substr(0,c));""===d&&(d="/");this.host=a+"//"+window.location.host.trim()+d.trim();"/"!==this.host.charAt(this.host.length-1)&&(this.host+="/");this.isHttpsMode=this.isHttpsUri(this.host);this.detectBrowserLocale();b.framework.registerApplication(this)}d.prototype.getLibraryOrder=function(a){if(!this.configModel.libraryConfigs)return null;for(var c=0;c<this.configModel.libraryConfigs.length;++c)if(this.configModel.libraryConfigs[c].id===a)return c;return null};
d.prototype.shouldOmitStylesForLibrary=function(a){if(!this.configModel.libraryConfigs)return null;for(var c=0;c<this.configModel.libraryConfigs.length;++c){var b=this.configModel.libraryConfigs[c];if(b.id===a)return!!b.omitStyles}return!1};d.prototype.translateConfiguration=function(a,c){var b=this,d=function(c,e,g){if("string"===typeof e){if(-1<e.indexOf("@language")){var h=e.split("-");if(2>h.length)throw Error("Invalid language key '{0}'.".format(e));e=h.join("-").replace("@","");return b.getResource(g||
a,e)}return b.performTokenReplacement(e)}if(e instanceof Array){g=[];for(h=0;h<e.length;++h)g.push(d(h,e[h]));return g}if(e instanceof Function)return e;if(e instanceof Object){g={};c=e.hasOwnProperty("libraryId")?e.libraryId:void 0;for(h in e)e.hasOwnProperty(h)&&(g[h]=d(h,e[h],c));return g}return e},e={},h;for(h in c)c.hasOwnProperty(h)&&(e[h]=d(h,c[h]));return e};d.prototype.performTokenReplacement=function(a){var c=this;return a?a.replace(/{.+?}/g,function(a){var b=a.substring(1,a.length-1);a=
c.configTokens.hasOwnProperty(b)?c.configTokens[b]:a;if(!a&&c.configuration&&c.configuration.hasOwnProperty(b))return c.configuration[b];if(a)return a;c.trace.warning("The token syntax \\{{0}\\} was detected, but could not be matched to a valid replacement.".format(b));return""}):a};d.prototype.isHttpsUri=function(a){a=a.trim();return-1<a.indexOf("://")&&5<=a.length&&"https"===a.substring(0,5)};d.prototype.makeAbsolute=function(a,c){if(!(new dojo._Url(a)).host){var b=c?c:"{0}//{1}{2}".format(window.location.protocol,
window.location.host,window.location.pathname);if("/"!=b.charAt(b.length-1)||"\\"!=b.charAt(b.length-1))b=b.split("/"),--b.length,b=b.join("/"),b+="/";if("/"==a.charAt(0)||"\\"==a.charAt(0))b=new dojo._Url(b),a=b.scheme+"://"+b.authority+"/"+a.substring(1);else{for(var d=b.split("/"),b=a?a.split("../"):[],e=0,h=0;h<b.length;++h)""==b[h]&&++e;d=d.slice(0,d.length-(0<e?e+1:e));b=b.slice(0<e?e-1:e);a=d.join("/")+b.join("/")}}return a};d.prototype.getHostElement=function(){return this.hostElement};d.prototype.getResource=
function(a,c,b){b=b||this.locale||"inv";b=b.toLowerCase();if(!this._resourceDictionaries||!this._resourceDictionaries.inv)throw Error("The application is missing its invariant resources.");var d=this._resourceDictionaries[b],e=this._resourceDictionaries.inv;d||(d=e);var h=d[a]||e[a];if(!h)return this.trace.warning("No resource dictionary found for library '{0}' while trying to get resource with key '{1}', using locale '{2}'.".format(a,c,b)),"@"+c;var l=null;if(!h.hasOwnProperty(c)){if(d===e)return"@"+
c;h=e[a];if(!1===h.hasOwnProperty(c))return this.trace.warning("The resource with key '{0}' was not found in library '{1}'.".format(c,a)),"@"+c}l=h[c];return"debug"===b?this._getDebugLocaleString(l):"strings"===b?c:"!!"===b?"!"+l+"!":l};d.prototype.getUri=function(a){var c=!1;if(c=0>a.indexOf("://"))return a=this.host+a,this.isHttpsUri(a)!=this.isHttpsMode&&this.trace.warning("Mixing secured and non-secured resources. Request: '{0}'.".format(a)),null==this.proxyUri||String.isNullOrEmpty(this.proxyUri)?
a:this.proxyUri+encodeURIComponent(a);this.isHttpsUri(a)!=this.isHttpsMode&&this.trace.warning("Mixing secured and non-secured resources. Request: '{0}'.".format(a));return this.proxyUri+encodeURIComponent(a)};d.prototype.getUrlParameter=function(a){if(this.urlParameters)for(var c in this.urlParameters)if(this.urlParameters.hasOwnProperty(c)&&!String.isNullOrEmpty(c)&&!String.isNullOrEmpty(a)&&c.toLowerCase()===a.toLowerCase())return this.urlParameters[c];return null};d.prototype.onLibrariesDownloaded=
function(a){};d.prototype.onConfigurationLoaded=function(a){};d.prototype.notifyLibraryDownload=function(a){this.trace.info("Processing downloaded library '{0}' for application '{1}'.".format(a,this.id));this.eventRegistry.event("LibraryDownloadedEvent").publish(a);var c=b.resourceManager.fetchAllFor(a,"json");if(c&&0<c.length)for(var d=0;d<c.length;++d){var f=c[d],e=b.resourceManager.fetch(f.name,f.library,f.locale);this.injectLibraryResources(a,e,f.locale)}this.configModel&&(c=this.configModel.libraryModules[a],
null==c?this.trace.warning("No modules found for library '{0}' in application '{1}'.".format(a,this.id)):(this.initializeModules(c),0<this.pendingLibraryDownloads&&--this.pendingLibraryDownloads,this._doIfNoPendingLibraryDownloads()))};d.prototype.hasLibrary=function(a){return b.framework.hasLibrary(a)&&!!this.configModel.libraryModules[a]&&this._resourceDictionaries.inv&&!!this._resourceDictionaries.inv[a]};d.prototype.registerFrameworkObject=function(a){if(!a.id)throw Error("Could not register framework object. Object was missing an ID.");
this.frameworkObjects[a.id]=a;var c=this._pendingFrameworkObjectRequests[a.id];c&&c.length&&(c.forEach(function(c){return c(a)}),c.length=0,delete this._pendingFrameworkObjectRequests[a.id]);return a};d.prototype.freeAllFrameworkObjects=function(){};d.prototype.getFrameworkObjectById=function(a){for(var c in this.frameworkObjects)if(this.frameworkObjects.hasOwnProperty(c)&&c===a)return this.frameworkObjects[c];return null};d.prototype.getFrameworkObjectByIdAsync=function(a,c,b){a&&dojo.isString(a)&&
c&&dojo.isFunction(c)?(b=this.getFrameworkObjectById(a))?c(b):(this._pendingFrameworkObjectRequests[a]=this._pendingFrameworkObjectRequests[a]||[],this._pendingFrameworkObjectRequests[a].push(c)):b&&dojo.isFunction(b)&&b(Error("Cannot retrieve Framework Object. Object ID or callback unspecified or incorrect."))};d.prototype.initialize=function(){var a=this;dojo.connect(window,"onresize",function(c){a.eventRegistry.event("ApplicationResizedEvent").publish()});dojo.subscribe("ServiceTokenRefreshed",
function(c){a.configuration&&c.serviceUrl===a.configuration.geometryServiceUrl&&(a.configuration.geometryServiceToken=c.token)});var c=new b.framework.config.ConfigurationLoader(this),d=function(c){"string"==typeof c&&(c=JSON.parse(c));a.configPreprocessor&&(a.configPreprocessor(c),a.configPreprocessor=null);var d=new b.framework.config.ConfigurationModel(a);a.onConfigurationLoaded(c);a.abortInitialization||d.parse(c,function(c){return a.processConfiguration(c)})};if(null!=this.configModel)throw Error("Configuration model should not be loaded already");
if(null!=this.configObject)d(this.configObject),this.configObject=null;else if(null!=this.configUri)c.loadConfigurationTree(this.configUri,function(a){return d(a)});else throw Error("No configuration method");this.viewManager.discoverRegions(this.hostElement)};d.prototype.shutdown=function(a){this.eventRegistry.event("ApplicationShutdownEvent").publish(a);this.viewManager.shutdown();this.moduleManager.shutdown(a);this.commandRegistry.clear();this.eventRegistry.clear()};d.prototype._doIfNoPendingLibraryDownloads=
function(){0===this.pendingLibraryDownloads&&(b.resourceManager&&b.resourceManager.performThemeInjection(),this.allLibrariesLoaded=!0,this.eventRegistry.event("ViewerLibrariesDownloadedEvent").publish(this),this.onLibrariesDownloaded(this),0>=this._initialStateAppliedCount&&this.initialStateAppliedCallback&&this.initialStateAppliedCallback(this))};d.prototype.onInitializationComplete=function(){null!=this.initializationCompleteCallback&&void 0!=this.initializationCompleteCallback&&this.initializationCompleteCallback(this)};
d.prototype.detectBrowserLocale=function(){this.locale=navigator.language?navigator.language:navigator.userLanguage?navigator.userLanguage:navigator.browserLanguage?navigator.browserLanguage:"inv"};d.prototype.downloadLibraries=function(a){this.pendingLibraryDownloads=a.libraryConfigs.length;for(var c=0;c<a.libraryConfigs.length;++c){var d=a.libraryConfigs[c];!0===b.framework.hasLibrary(d.id)?this.notifyLibraryDownload(d.id):(b.framework.libraries[d.id]=!1,d.uri&&this.includeScript(d.uri,function(a){},
function(){}))}};d.prototype.injectLibraryResources=function(a,c,b){b=b.toLowerCase();!1===this._resourceDictionaries.hasOwnProperty(b)?(this._resourceDictionaries[b]={},this._resourceDictionaries[b][a]=c):!1===this._resourceDictionaries[b].hasOwnProperty(a)?this._resourceDictionaries[b][a]=c:dojo.mixin(this._resourceDictionaries[b][a],c)};d.prototype.instantiateFrameworkObject=function(a,c){for(var b=a.split("."),d=window,e=0;e<b.length&&"object"===typeof d;e++)d=d[b[e]];b=null;"function"===typeof d&&
(b=new d(this,c));if(!b)try{b=new (dojo.getObject(a))(this,c)}catch(h){this.trace.error("Could not instantiate object of type '{0}': '{1}'".format(a,h),h)}return b};d.prototype.includeScript=function(a,c,b){var d=this;dojo.io.script.get({url:a,preventCache:this.debugMode,load:function(b){try{c&&c(b)}catch(e){d.trace.error("Error while including script '{0}': {1}".format(a,e),e)}},error:function(c){d.trace.error("Error while including script '{0}': {1}".format(a,c),c);0<d.pendingLibraryDownloads&&
d.pendingLibraryDownloads--;d._doIfNoPendingLibraryDownloads();b&&b(c)}})};d.prototype.processConfiguration=function(a){var c=this;this.configuration=a.application||{};this.configModel=a;this.eventRegistry.event("AppConfigLoaded").publish(this.configModel);this.eventRegistry.event("ApplicationConfigLoadedEvent").publish(this.configModel);this.configuration&&this.configuration.locale&&(this.locale=this.configuration.locale);this.urlParameters&&this.getUrlParameter("locale")&&(this.locale=this.getUrlParameter("locale"));
dojo.locale=this.locale;this.pendingLocaleDownloads=a.externalLocaleReferences.length;if(0==this.pendingLocaleDownloads)this.downloadLibraries(a);else for(var b=0;b<a.externalLocaleReferences.length;++b)(function(b){c.fetchConfigResource({url:b.uri,handleAs:"json",load:function(d){try{if(d)if(d.hasOwnProperty("locales"))for(var e in d)d.hasOwnProperty(e)&&c.injectLibraryResources(b.libraryId,d[e],e);else if(b.hasOwnProperty("locale"))c.injectLibraryResources(b.libraryId,d,b.locale);else throw Error("Locale reference missing 'locale' identifier.");
else c.trace.warning("Error loading locale '{0}' for library '{1}' from offline storage.".format(b.locale,b.libraryId))}catch(k){c.trace.error("Error fetching external locale resource {0}: {1}".format(b.uri,k.message),k)}finally{--c.pendingLocaleDownloads,1>c.pendingLocaleDownloads&&c.downloadLibraries(a)}},error:function(d){c.trace.error("Error fetching external locale resource {0}: {1}".format(b.uri,d.message),d);--c.pendingLocaleDownloads;1>c.pendingLocaleDownloads&&c.downloadLibraries(a)}})})(a.externalLocaleReferences[b])};
d.prototype.addNativeReadyFunction=function(a){if("undefined"!==typeof gcxNativeReady)a&&a();else{var c=gcxNativeReadyCallback;gcxNativeReadyCallback=function(){c&&c();a&&a()}}};d.prototype.getInitialState=function(a,c){return new e.SimplePromise(function(a,c){return a(null)})};d.prototype.initializeModules=function(a){for(var c=this,d={},e=0;e<a.length;++e){var g=a[e];if(!this.moduleManager.moduleIsLoaded(g.moduleName)){var h=this.translateConfiguration(g.libraryId,g.configuration),l=this.moduleManager.instantiate(g.moduleType,
g.libraryId);if(null===l)this.trace.error("Could not instantiate module with type '{0}' - type not found or constructor failed.".format(g.moduleType));else{if(l.initialize){this.trace.info("Initializing module '{0}'.".format(g.moduleName));try{l.id="module-{0}-{1}".format(g.libraryId,g.moduleName),l.initialize(h),this.registerFrameworkObject(l),function(a,b){c._initialStateAppliedCount++;c.getInitialState(b.moduleName,b.libraryId).then(function(c){if(c&&"function"===typeof a.applyState)return a.applyState(c)}).then(function(){return c._onInitialStateApplied(b.moduleName)},
function(a){return c._onInitialStateApplied(b.moduleName,a)})}(l,g)}catch(r){this.trace.error("Error initializing module '{0}': {1}.".format(g.moduleName,r.message),r);continue}this.moduleManager.markModuleLoaded(g.moduleName,l);this.trace.debug("Module '{0}' initialized.".format(g.moduleName))}if(g.viewModelConfigs&&0<g.viewModelConfigs.length)for(l=0;l<g.viewModelConfigs.length;++l){var p=g.viewModelConfigs[l];if(d[p.viewModelId])this.trace.error("ViewModel '{0}' already exists in module '{1}'.".format(p.viewModelId,
g.moduleName));else{var m=null;try{m=this.instantiateFrameworkObject(p.typeName,p.libraryId),m.id=p.viewModelId||b.framework.utils.alphaNumericToken(),h=this.translateConfiguration(g.libraryId,p.configuration),m.initialize(h),d[p.viewModelId]=m,this.registerFrameworkObject(m)}catch(n){this.trace.error("Could not create view model with type '{0}' - type was not found, not a view model, or failed to construct: {1}".format(p.typeName,n.message),n)}}}}}}for(e=0;e<a.length;++e)if(g=a[e],g.viewConfigs)for(l=
0;l<g.viewConfigs.length;++l)h=g.viewConfigs[l],this.getFrameworkObjectById(h.viewId)||(h=this.translateConfiguration(g.libraryId,h),p=null,h.viewModelId?(p=d[h.viewModelId])?p.libraryId=p.libraryId||g.libraryId:this.trace.error("Could not attach view model '{0}' to view '{1}' - view model not found.".format(h.viewModelId,h.viewId)):p=new b.framework.ui.ViewModelBase(this,g.libraryId),h.viewModel=p,(p=this.viewManager.createView(h))?this.registerFrameworkObject(p):this.trace.warning("Could not instantiate view with type '{0}'.".format(h.typeName)));
this.initializationCompleteCallback&&(this.onInitializationComplete(),this.initializationCompleteCallback=null)};d.prototype._onInitialStateApplied=function(a,c){this._initialStateAppliedCount--;c&&this.trace.error('Error setting initial state for module "{0}": {1}'.format(a,c.message),c);this.allLibrariesLoaded&&0>=this._initialStateAppliedCount&&this.initialStateAppliedCallback&&this.initialStateAppliedCallback(this)};d.prototype.fetchConfigResource=function(a){var c=document.createElement("a");
try{c.href=a.url;c.style.display="none";document.body.appendChild(c);var d=b._configDomains;if(!c.hostname||["protocol","hostname"].every(function(a){return c[a]===window.location[a]})||d&&!0==d[c.protocol+"//"+c.hostname])return dojo.xhrGet(a);var e=Error("Could not load viewer because the specified configuration file is not on the same domain as the viewer ({0}).".format(a.url));e.name="ConfigurationDomainMismatch";throw e;}finally{document.body.removeChild(c)}};d.prototype._getDebugLocaleString=
function(a){for(var c=[9728,9983],b=[],d=0;d<a.length;++d)b.push(Math.floor(Math.random()*(c[1]-c[0]))+c[0]);return String.fromCharCode.apply(String,b)};return d}();l.Application=h})(e.application||(e.application={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(e){(function(e){var h=function(){function d(){this.resources=[];this.cachedResources={};this.themesToInject=[]}d.prototype.fetch=function(a,c,d){d=d||"inv";var e="{0}-{1}-{2}".format(c,d,a);if(this.cachedResources.hasOwnProperty(e))return this.cachedResources[e];a=this.findResource(a,c,d);if(!a)return null;c=null;switch(a.format){case "css":case "html":c=b.framework.utils.base64Decode(a.data);this.cachedResources[e]=c;break;case "json":c=b.framework.utils.base64Decode(a.data);
c=JSON.parse(c);this.cachedResources[e]=c;break;default:return null}return c};d.prototype.fetchAllFor=function(a,c){for(var b=[],d=0;d<this.resources.length;++d){var e=this.resources[d];e.library!=a||null!=c&&e.format!=c||b.push(e)}return b};d.prototype.register=function(a,c,b,d,e){if(!this.findResource(b,a)){var h={};h.name=b;h.library=a;h.locale=c;h.format=d;h.data=e;this.resources.push(h)}};d.prototype.remove=function(a,c,b){var d=this.findResource(c,a,b);return null!=d?(Array.removeItem(this.resources,
d),a="{0}-{1}-{2}".format(a,b,c),this.cachedResources.hasOwnProperty(a)&&delete this.cachedResources[a],!0):!1};d.prototype.injectTheme=function(a){this.themesToInject.push(a)};d.prototype.performThemeInjection=function(){for(var a=dojo.query("head")[0],c=0;c<this.themesToInject.length;++c){var b=dojo.create("link",{rel:"stylesheet",href:this.themesToInject[c]});dojo.place(b,a,"last")}};d.prototype.findResource=function(a,c,b){b=b||"inv";for(var d=0;d<this.resources.length;++d){var e=this.resources[d];
if(e.name==a&&(null==c||e.library==c)&&e.locale==b)return e}return null};return d}();e.ResourceManager=h})(e.application||(e.application={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));(function(b){b.resourceManager=new b.framework.application.ResourceManager})(geocortex||(geocortex={}));
(function(b){(function(e){e.applications=[];e.libraries={};e.injectedStyleBlocks=[];e.initialized=!1;e.registerApplication=function(e){b.framework.applications.push(e)};e.hasLibrary=function(e){return!0===b.framework.libraries[e]};e.notifyLibraryDownload=function(e){if(!b.framework.hasLibrary(e)){b.framework.libraries[e]=!0;for(var h=0,d=!0,a=0;a<b.framework.applications.length;++a){var c=b.framework.applications[a],k=c.getLibraryOrder(e);!0===c.shouldOmitStylesForLibrary(e)&&(d=!1);if(k){h=k+32*
a;break}}if(d){(a=b.resourceManager.fetchAllFor(e,"css"))||(a=[]);d="";c=dojo.query("head")[0];for(k=0;k<a.length;++k){var f=a[k];(f=b.resourceManager.fetch(f.name,f.library))&&(d+=f+" ")}a=document.createElement("style");b.framework.injectedStyleBlocks.push(a);a.setAttribute("type","text/css");dojo.attr(a,"data-block-order",h);if(0===h)dojo.place(a,c,"first");else if(k=dojo.query("head style[data-block-order]"),0===k.length)dojo.place(a,c,"first");else{for(var c=null,f=!1,g=0;g<k.length;++g){var w=
k[g];if((dojo.attr(w,"data-block-order")||0)>=h){dojo.place(a,w,"before");f=!0;break}else c=w}f||dojo.place(a,c,"after")}a.styleSheet?a.styleSheet.cssText=d:(h=document.createTextNode(d),a.appendChild(h))}for(a=0;a<b.framework.applications.length;++a)c=b.framework.applications[a],c.notifyLibraryDownload(e)}};e.initialize=function(){b.framework.initialized||(b.utils=b.framework.utils,b.framework.initialized=!0)}})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));geocortex.framework.initialize();
(function(b){(function(e){(function(l){var h=function(d){function a(a,b){d.call(this,a,b)}__extends(a,d);a.prototype.unhostAllViews=function(){for(var a=0;a<this.views.length;++a)this.unhostView(this.views[a]);this.views.length=0};a.prototype.hostView=function(a){this.unhostAllViews();this.views.push(a);if(null==a.root){var e=b.resourceManager.fetch(a.markupResource,a.libraryId);if(null===e)return this.app.trace.warning("Could not fetch markup resource '{0}' in library '{1}'.".format(a.markupResource,
a.libraryId)),!1;a.root=dojo.create("div",{className:"view {0}".format(a.id)});a.root.innerHTML=e;dojo.place(a.root,this.domElement,"last");a.viewModel&&a.attach(a.viewModel);this.app.viewManager.discoverRegions(a.root,a)}else dojo.place(a.root,this.domElement,"only");d.prototype.hostView.call(this,a);return!0};a.prototype.unhostView=function(a){this.deactivateView(a);e.utils.ArrayUtils.removeItem(this.views,a);var b=new dojo.NodeList;b.push(a.root);b.orphan();d.prototype.unhostView.call(this,a)};
return a}(l.RegionAdapterBase);l.DivRegionAdapter=h})(e.ui||(e.ui={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(e){(function(l){var h=function(d){function a(a,b){d.call(this,a,b);this.activeViews=[];this.activateViewsInLastPosition=!0}__extends(a,d);a.prototype.host=function(a,b){d.prototype.host.call(this,a,b);"false"===this.options.activateViewsInLastPosition&&(this.activateViewsInLastPosition=!1)};a.prototype.activateView=function(a){e.utils.ArrayUtils.contains(this.activeViews,a)&&e.utils.ArrayUtils.removeItem(this.activeViews,a);this.activeViews.push(a);this.activateViewsInLastPosition&&
dojo.place(a.root,this.domElement,"last");d.prototype.activateView.call(this,a)};a.prototype.deactivateView=function(a){a.isActive=!1;e.utils.ArrayUtils.removeItem(this.activeViews,a);0<this.activeViews.length&&this.activateView(this.activeViews[this.activeViews.length-1]);d.prototype.deactivateView.call(this,a)};a.prototype.hostView=function(a){this.views.push(a);if(null==a.root){var e=b.resourceManager.fetch(a.markupResource,a.libraryId);if(null==e)return this.app.trace.warning("Could not fetch markup resource '{0}' in library '{1}'.".format(a.markupResource,
a.libraryId)),!1;var f=this.getHostedTagName();a.root=dojo.create(f,{className:"view {0}".format(a.id)});a.root.innerHTML=e;dojo.place(a.root,this.domElement,"last");a.viewModel&&a.attach(a.viewModel);this.app.viewManager.discoverRegions(a.root,a)}else dojo.place(a.root,this.domElement,"last");d.prototype.hostView.call(this,a);return!0};a.prototype.unhostView=function(a){this.deactivateView(a);e.utils.ArrayUtils.removeItem(this.views,a);e.utils.ArrayUtils.removeItem(this.activeViews,a);var b=new dojo.NodeList;
b.push(a.root);b.orphan();d.prototype.unhostView.call(this,a)};a.prototype.getHostedTagName=function(){return this.options&&this.options.tagName?this.options.tagName:"div"};return a}(l.RegionAdapterBase);l.DivStackRegionAdapter=h})(e.ui||(e.ui={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(e){(function(l){var h=function(d){function a(){d.apply(this,arguments)}__extends(a,d);a.prototype.activateView=function(a){this.hideAllViews();if(0<this.activeViews.length){var b=this.activeViews[this.activeViews.length-1];b!==a&&(this.cancelActivate(b),b.deactivated())}d.prototype.activateView.call(this,a)};a.prototype.deactivateView=function(a,b){if(void 0===b||null===b)b=!0;d.prototype.deactivateView.call(this,a);b&&0<this.activeViews.length&&this.activateView(this.activeViews[this.activeViews.length-
1])};a.prototype.hideAllViews=function(){dojo.query("> .view",this.domElement).removeClass("active");dojo.query("> .view",this.domElement).addClass("inactive")};a.prototype.hostView=function(a){this.views.push(a);if(null==a.root){var e=b.resourceManager.fetch(a.markupResource,a.libraryId);if(null==e)return this.app.trace.warning("Could not fetch markup resource '{0}' in library '{1}'.".format(a.markupResource,a.libraryId)),!1;var f=this.getHostedTagName();a.root=dojo.create(f,{className:"view {0}".format(a.id)});
a.root.innerHTML=e;dojo.place(a.root,this.domElement,"last");a.viewModel&&a.attach(a.viewModel);this.app.viewManager.discoverRegions(a.root,a)}else dojo.place(a.root,this.domElement,"last");d.prototype.hostView.call(this,a);return!0};a.prototype.getHostedTagName=function(){return this.options&&this.options.tagName?this.options.tagName:"div"};a.prototype.unhostView=function(a){this.deactivateView(a);e.utils.ArrayUtils.removeItem(this.views,a);e.utils.ArrayUtils.removeItem(this.activeViews,a);var b=
new dojo.NodeList;b.push(a.root);b.orphan();d.prototype.unhostView.call(this,a)};return a}(l.RegionAdapterBase);l.MultiViewRegionAdapter=h})(e.ui||(e.ui={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){var e=function(b){function a(){b.apply(this,arguments)}__extends(a,b);a.prototype.getHostedTagName=function(){return"div"};return a}(b.MultiViewRegionAdapter);b.MultiDivRegionAdapter=e})(b.ui||(b.ui={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){(function(b){function d(){null===c&&(c=(new Date).getTimezoneOffset());return c}var a=/(Z|([+-][012]\d(:?\d\d)?))\s*$/;b.containsTimezone=function(c){return a.test(c)};var c=null,e=null;b.getTimezoneOffset=d;b.getTimezoneString=function(){if(null==e){var a=d(),c=Math.floor(a/60),a=Math.floor(a-60*c);if(0==c&&0==a)return"Z";0>c?(c*=-1,e="+"):e="-";e=0==c?e+"00":10>c?e+("0"+c):e+c;e=0==a?e+":00":10>a?e+(":0"+a):e+(":"+a)}return e};(function(){var a=new Date("2011-06-02T09:34:29+02:00");
Date.fromISO=a&&1307000069E3===+a?function(a){return new Date(a)}:function(a){var c,b=/^(\d{4}\-\d\d\-\d\d([tT ][\d:\.]*)?)([zZ]|([+\-])(\d\d):(\d\d))?$/.exec(a)||[];if(b[1]){a=b[1].split(/\D/);c=0;for(var d=a.length;c<d;c++)a[c]=parseInt(a[c],10)||0;a[1]-=1;a=new Date(Date.UTC.apply(Date,a));if(!a.getDate())return NaN;b[5]&&(c=60*parseInt(b[5],10),b[6]&&(c+=parseInt(b[6],10)),"+"==b[4]&&(c*=-1),c&&a.setUTCMinutes(a.getUTCMinutes()+c));return a}return NaN}})();Date.prototype.toISOString||function(){function a(c){c=
String(c);1===c.length&&(c="0"+c);return c}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1E3).toFixed(3)).slice(2,5)+"Z"}}()})(b.DateUtils||(b.DateUtils={}))})(b.utils||(b.utils={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){var e=function(){function b(a,c,d){this.delayMS=0;this.func=null;this.delayMS=a;this.func=d?function(){c.apply(d)}:c}b.prototype.start=function(){this._timerHandle=setTimeout(this.func,this.delayMS)};b.prototype.stop=function(){clearTimeout(this._timerHandle)};b.prototype.reset=function(){this.stop();this.start()};return b}();b.TimeDelayedAction=e})(b.utils||(b.utils={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){var l=function(){function b(d){var a=this;this._state=b.PENDING;this._value=null;this._handlers=[];this._doResolve(d,function(c){return a._resolve(c)},function(c){return a._reject(c)})}b.resolve=function(d){return b._getThen(d)?d:new b(function(a,c){a(d)})};b.reject=function(d){return new b(function(a,c){c(d)})};b.all=function(d){return b.resolve(d).then(function(a){if(!Array.isArray(a))throw Error("SimplePromise.all: expecting an array or a thenable.");var c=a.length,d=
[];return new b(function(e,g){a.forEach(function(a,l){b.resolve(a).then(function(a){d[l]=a;0===--c&&e(d)},g)})})})};b.prototype.then=function(d,a){var c=this;return new b(function(b,e){return c._done(function(a){if("function"===typeof d)try{return b(d(a))}catch(c){return e(c)}else return b(a)},function(c){if("function"===typeof a)try{return b(a(c))}catch(d){return e(d)}else return e(c)})})};b.prototype._fulfill=function(d){var a=this;this._state=b.FULFILLED;this._value=d;this._handlers.forEach(function(c){return a._handle(c)});
this._handlers=[]};b.prototype._reject=function(d){var a=this;this._state=b.REJECTED;this._value=d;this._handlers.forEach(function(c){return a._handle(c)});this._handlers=[]};b.prototype._resolve=function(d){var a=this;try{var c=b._getThen(d);c?this._doResolve(c.bind(d),function(c){return a._resolve(c)},function(c){return a._reject(c)}):this._fulfill(d)}catch(e){this._reject(e)}};b._getThen=function(b){var a=typeof b;return!b||"object"!==a&&"function"!==a||(b=b.then,"function"!==typeof b)?null:b};
b.prototype._doResolve=function(b,a,c){var e=!1;try{b(function(c){e||(e=!0,a(c))},function(a){e||(e=!0,c(a))})}catch(f){e||(e=!0,c(f))}};b.prototype._handle=function(d){if(this._state===b.PENDING)this._handlers.push(d);else{if(this._state===b.FULFILLED&&"function"===typeof d.onFulfilled)d.onFulfilled(this._value);if(this._state===b.REJECTED&&"function"===typeof d.onRejected)d.onRejected(this._value)}};b.prototype._done=function(b,a){var c=this;setTimeout(function(){c._handle({onFulfilled:b,onRejected:a})},
0)};b.PENDING=0;b.FULFILLED=1;b.REJECTED=2;return b}();b.SimplePromise=l})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){var e=function(b){function a(a){b.call(this,a);this.fileStorageEndpoint="/filesystem";this._initialized=!1;this.localServerAddress=this.app.localServerAddress?this.app.localServerAddress:"http://127.0.0.1:8181"}__extends(a,b);a.prototype.initialize=function(){if(!this._initialized){!window.require.has("esri-cors")&&window.Modernizr.cors&&(delete window.require.has.cache["esri-cors"],window.require.has.add("esri-cors",function(){return!0}));var a=this.localServerAddress.replace("http://",
"");window.esri.config.defaults.io.corsEnabledServers.push(a);this._initialized=!0}};a.isSupported=function(){var a=navigator.userAgent.match(/GeocortexApp[^\/]*\/(\d+.\d+)/);return a&&1.1<=parseFloat(a[1])?!0:!1};a.prototype.fileStorageRequest=function(a,b,d,e,h){this.initialize();b={url:this.localServerAddress+this.fileStorageEndpoint+"/"+b,headers:{Authorization:"Token "+this.app.localServerToken},load:function(a){d(a)},error:function(a){a&&a.status&&404===a.status?d(null):e(a)},failOk:!0};h&&
(b.putData=h);dojo.xhr(a,b)};a.prototype.clear=function(a,b){this.fileStorageRequest("DELETE",this.keyNamespace+"/",a,b)};a.prototype.clearAllData=function(a,b){this.fileStorageRequest("DELETE","",a,b)};a.prototype.get=function(a,b,d,e){this.fileStorageRequest("GET",e?"0/"+a:this.keyNamespace+"/"+a,b,d)};a.prototype.set=function(a,b,d,e,h){this.fileStorageRequest("PUT",h?"0/"+a:this.keyNamespace+"/"+a,d,e,b)};a.prototype.remove=function(a,b,d,e){this.fileStorageRequest("DELETE",e?"0/"+a:this.keyNamespace+
"/"+a,b,d)};return a}(b.StorageProviderBase);b.HttpStorageProvider=e})(b.storage||(b.storage={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){b.DateFormatters={d:function(a){return a.getDate()+""},dd:function(a){return e(a.getDate(),2)},f:function(a){return d(a.getMilliseconds()/1E3,1,!1)},ff:function(a){return d(a.getMilliseconds()/1E3,2,!1)},fff:function(a){return d(a.getMilliseconds()/1E3,3,!1)},ffff:function(a){return d(a.getMilliseconds()/1E3,4,!1)},fffff:function(a){return d(a.getMilliseconds()/1E3,5,!1)},ffffff:function(a){return d(a.getMilliseconds()/1E3,6,!1)},fffffff:function(a){return d(a.getMilliseconds()/
1E3,7,!1)},F:function(a){return d(a.getMilliseconds()/1E3,1,!0)},FF:function(a){return d(a.getMilliseconds()/1E3,2,!0)},FFF:function(a){return d(a.getMilliseconds()/1E3,3,!0)},FFFF:function(a){return d(a.getMilliseconds()/1E3,4,!0)},FFFFF:function(a){return d(a.getMilliseconds()/1E3,5,!0)},FFFFFF:function(a){return d(a.getMilliseconds()/1E3,6,!0)},FFFFFFF:function(a){return d(a.getMilliseconds()/1E3,7,!0)},h:function(a){a=a.getHours();12<a&&(a-=12);return e(a,1)},hh:function(a){a=a.getHours();12<
a&&(a-=12);return e(a,2)},H:function(a){return e(a.getHours(),1)},HH:function(a){return e(a.getHours(),2)},m:function(a){return e(a.getMinutes(),1)},mm:function(a){return e(a.getMinutes(),2)},M:function(a){return e(a.getMonth()+1,1)},MM:function(a){return e(a.getMonth()+1,2)},s:function(a){return e(a.getSeconds(),1)},ss:function(a){return e(a.getSeconds(),2)},y:function(a){return e(a.getFullYear(),1)},yy:function(a){return e(a.getFullYear(),2)},yyy:function(a){return e(a.getFullYear(),3)},yyyy:function(a){return e(a.getFullYear(),
4)},yyyyy:function(a){return e(a.getFullYear(),5)}};var e=function(a,b){a+="";for(var d=b-a.length,e=[];e.length<d;)e.push("0");return e.join("")+a},d=function(a,b,d){a=Math.floor(a*Math.pow(10,b));b=e(a,b);d?(d=b+"",d=d.replace(/0*$/g,"")):d=b;return d}})(b.utils||(b.utils={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
(function(b){(function(b){(function(b){var e=function(){function b(a,c,d,e,g){this.item5=this.item4=this.item3=this.item2=this.item1=null;this.item1=a;this.item2=c;null!=d&&"undefined"!==typeof d&&(this.item3=d);null!=e&&"undefined"!==typeof e&&(this.item4=e);null!=g&&"undefined"!==typeof g&&(this.item5=g)}b.equals=function(a,b){return null===a?null===b:a.item1!==b.item1||a.item2!==b.item2||a.item3!==b.item3||a.item4!==b.item4||a.item5!==b.item5?!1:!0};b.compare=function(a,b){var d=function(a,b){return null===
a?null===b?0:-1:a===b?0:a>b?1:-1};return d(a.item1,b.item1)||d(a.item2,b.item2)||d(a.item3,b.item3)||d(a.item4,b.item4)||d(a.item5,b.item5)};return b}();b.Tuple=e})(b.utils||(b.utils={}))})(b.framework||(b.framework={}))})(geocortex||(geocortex={}));
