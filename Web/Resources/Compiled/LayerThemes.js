!function(){function r(e,t,r){if("string"==typeof e&&(r=t,t=e),void 0!==r)for(var n=t.split("."),a=null,i=window,o=0,s=n.length;o<s;o++)a=n[o],o==s-1?i[a]=r:i[a]||(i[a]={}),i=i[a];else console.warn("Undefined shim for: "+t)}require({cache:{"Mapping/modules/LayerThemes/LayerThemeSharingLinkProvider":function(){var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});define(["require","exports","geocortex/infrastructure/sharing/SharingLinkProviderBase"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=(a=n.SharingLinkProviderBase,o(i,a),i.prototype.generate=function(){var e=this.app.site.essentialsMap.layerThemesInfo;return e&&e.layerThemesConfigured?this.app.site.essentialsMap.layerThemesInfo.activeTheme.id:""},i.prototype.apply=function(e){var t=this;e&&(this.app.site&&this.app.site.serviceLayersLoaded?this._applyLayerTheme(e):this.app.event("LayerListInitializedEvent").once(this,function(){t._applyLayerTheme(e)}))},i.prototype._applyLayerTheme=function(e){var t=this.app.site.essentialsMap.layerThemesInfo;if(t&&t.layerThemesConfigured){var r=t.getTheme(e,!0);r&&!r.isActive?r.applyToMap():this.app.trace.warning("Could not switch layer theme to {0}: Specified theme not found.".format(e))}else this.app.trace.warning("Could not switch layer theme to {0}: No layer themes configured.".format(e))},i);function i(e,t){var r=a.call(this,e,t)||this;return r.name="layerTheme",r.priority=n.LayerListLinkPriority.LAYERTHEME,r}t.LayerThemeSharingLinkProvider=r})},"Mapping/modules/LayerThemes/LayerThemesModule":function(){var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});define(["require","exports","geocortex/framework/application/ModuleBase","geocortex/infrastructure/MapUtils"],function(e,t,r,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a=(n=r.ModuleBase,o(i,n),i.prototype.initialize=function(e){var t=this;this.app.waitUntilApplicationReady().then(function(){t.app.site.essentialsMap&&t.app.site.essentialsMap.layerThemesInfo&&t.app.site.essentialsMap.layerThemesInfo.layerThemesConfigured&&(t.layerThemesInfo=t.app.site.essentialsMap.layerThemesInfo,t.app.site.hasNamedExtents&&(t.namedExtents=t.app.site.namedExtents),t.layerThemesInfo.activeTheme&&t._handleConfiguredThemeProperties({currTheme:t.layerThemesInfo.activeTheme,prevTheme:t.layerThemesInfo.previousTheme}),t._registerEvents()),t._registerCommands()})},i.prototype._registerCommands=function(){this.app.command("SwitchToLayerTheme").register(this,this._switchToLayerThemeImpl)},i.prototype._registerEvents=function(){var t=this;this.layerThemesInfo&&(dojo.connect(this.layerThemesInfo,"layerThemeChangingEvent",function(e){t.app.event("LayerThemeChangingEvent").publish(e)}),dojo.connect(this.layerThemesInfo,"layerThemeChangedEvent",function(e){t._handleConfiguredThemeProperties(e),t.app.event("LayerThemeChangedEvent").publish(e)}))},i.prototype._switchToLayerThemeImpl=function(e){if(this.layerThemesInfo&&this.layerThemesInfo.layerThemesConfigured){var t=this.layerThemesInfo.getTheme(e,!0);if(t)return void t.applyToMap();this.app.trace.warning("LayerThemeModule: Could not switch layer theme to: {0}. Specified theme not found.".format(e))}else this.app.trace.warning("LayerThemeModule: Could not switch layer theme to: {0}. No layer themes configured.".format(e))},i.prototype._handleConfiguredThemeProperties=function(e){var r=this;if(e.currTheme&&e.currTheme.properties&&e.currTheme.properties.length)for(var t=0,n=e.currTheme.properties;t<n.length;t++){var a=n[t];switch(a.name){case"LayerThemeNamedExtent":case"layerThemeNamedExtent":case"layerthemenamedextent":case"LAYERTHEMENAMEDEXTENT":if(this.namedExtents)for(var i=function(e){if(o.app.map&&(e.id===a.value||e.displayName===a.value)){if(o.app.map.loaded)h.zoomToExtentWithPriority(o.app,e.extent,10,!0);else var t=o.app.map.on("load",function(){t.remove(),h.zoomToExtentWithPriority(r.app,e.extent,10,!0)});return"break"}},o=this,s=0,p=this.namedExtents;s<p.length&&"break"!==i(p[s]);s++);break;default:this.app.trace.info("LayerThemesModule: Property {0} not supported by the Geocortex Viewer for HTML".format(a.name))}}},i);function i(e,t){return n.call(this,e,t)||this}t.LayerThemesModule=a})}}}),require({cache:{}}),define(["Mapping/modules/LayerThemes/LayerThemeSharingLinkProvider","Mapping/modules/LayerThemes/LayerThemesModule"],function(e,t){r(e,"geocortex.essentialsHtmlViewer.mapping.modules.layerThemes.LayerThemeSharingLinkProvider",e.LayerThemeSharingLinkProvider),r(t,"geocortex.essentialsHtmlViewer.mapping.modules.layerThemes.LayerThemesModule",t.LayerThemesModule)})}();