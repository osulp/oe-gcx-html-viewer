/*
	
	Copyright (c) 2017, Latitude Geographics Group Ltd.
	All rights reserved.
	       
	Redistribution is not permitted. 
	
	Use in binary form, without modification, is permitted provided that neither 
	the name of the organization nor the names of its contributors may be used 
	to endorse or promote products derived from this software without specific 
	prior written permission.
	       
	THIS SOFTWARE IS PROVIDED BY COPYRIGHT HOLDER ''AS IS'' AND ANY
	EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
	WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
	DISCLAIMED. IN NO EVENT SHALL LATITUDE GEOGRAPHICS GROUP LTD. BE LIABLE FOR ANY
	DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
	(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
	LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
	ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
	(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
	SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/

define("infrastructure/accessibility/MapNavigationState",["require","exports"],function(h,f){});define("infrastructure/accessibility/InputMethod",["require","exports"],function(h,f){var k=function(){return function(){}}();k.MOUSE="mouse";k.KEYBOARD="keyboard";f.InputMethod=k});
define("infrastructure/accessibility/AccessibleMapComponent",["require","exports","geocortex/framework/utils/utils","infrastructure/accessibility/InputMethod"],function(h,f,k,l){h=function(){function e(c,a){this.inputMethod=null;this.isKeyboardActive=this.suspended=!1;this.id=k.alphaNumericToken();this._keyUpHandle=this._keyDownHandle=this._mouseDownHandle=this._mapNavState=this._map=null;this.setMap(c);this.setApp(a)}e.prototype.setMap=function(c){this._map=c};e.prototype.setApp=function(c){this.app=
c};e.prototype.setInputMethod=function(c){if(c!==this.inputMethod){var a=this.inputMethod;this.inputMethod=c;this.onInputMethodChange({previousMethod:a,newMethod:this.inputMethod})}};e.prototype.setKeyboardActive=function(c){this.isKeyboardActive=c};e.prototype.suspend=function(){this.suspended=!0};e.prototype.resume=function(){this.suspended=!1};e.prototype.disableMapNavigation=function(c,a,b){void 0===c&&(c=!1);void 0===a&&(a=!1);void 0===b&&(b=!0);var d=this._map;this._mapNavState={isDoubleClickZoom:d.isDoubleClickZoom,
isClickRecenter:d.isClickRecenter,isPan:d.isPan,isRubberBandZoom:d.isRubberBandZoom,isKeyboardNavigation:d.isKeyboardNavigation,isScrollWheelZoom:d.isScrollWheelZoom,isShiftDoubleClickZoom:d.isShiftDoubleClickZoom,isPanArrows:d.isPanArrows,isZoomSlider:d.isZoomSlider};d.disableDoubleClickZoom();d.disableClickRecenter();d.disablePan();d.disableRubberBandZoom();d.disableKeyboardNavigation();d.disableScrollWheelZoom();d.disableShiftDoubleClickZoom();c&&d.isZoomSlider&&d.hideZoomSlider();a&&d.isPanArrows&&
d.hidePanArrows();b&&d.graphics.disableMouseEvents();return this._mapNavState};e.prototype.enableMapNavigation=function(c,a,b,d){void 0===c&&(c=!1);void 0===a&&(a=!1);void 0===b&&(b=!0);var g=this._map;if(d=d||this._mapNavState)d.isDoubleClickZoom&&g.enableDoubleClickZoom(),d.isClickRecenter&&g.enableClickRecenter(),d.isPan&&g.enablePan(),d.isRubberBandZoom&&g.enableRubberBandZoom(),d.isKeyboardNavigation&&g.enableKeyboardNavigation(),d.isScrollWheelZoom&&g.enableScrollWheelZoom(),d.isShiftDoubleClickZoom&&
g.enableShiftDoubleClickZoom(),c&&d.isZoomSlider&&g.showZoomSlider(),a&&d.isPanArrows&&g.showPanArrows(),b&&g.graphics.enableMouseEvents()};e.prototype.getMapState=function(){return this._mapNavState};e.prototype.activateMouseControls=function(c){var a=this;void 0===c&&(c=!0);this.deactivateMouseControls(c);this._mouseDownHandle=this.app.map.on("mouse-down",function(){a._mouseDownHandle.remove();a._mouseDownHandle=null;a.setInputMethod(l.InputMethod.MOUSE)})};e.prototype.deactivateMouseControls=function(c){void 0===
c&&(c=!0);this._mouseDownHandle&&(this._mouseDownHandle.remove(),this._mouseDownHandle=null);c&&this.inputMethod===l.InputMethod.MOUSE&&this.setInputMethod(null)};e.prototype.activateKeyboardControls=function(c){void 0===c&&(c=!0);this.isKeyboardActive&&this.deactivateKeyboardControls(c);this.setKeyboardActive(!0);this._keyDownHandle=dojo.on(this._map.root,"keydown",dojo.hitch(this,"_onKeyDown"));this._keyUpHandle=dojo.on(this._map.root,"keyup",dojo.hitch(this,"_onKeyUp"));this.app.event("AccessibleComponentStartedEvent").publish(this)};
e.prototype.deactivateKeyboardControls=function(c){void 0===c&&(c=!0);this.setKeyboardActive(!1);this._keyDownHandle&&(this._keyDownHandle.remove(),this._keyDownHandle=null);this._keyUpHandle&&(this._keyUpHandle.remove(),this._keyUpHandle=null);c&&this.inputMethod===l.InputMethod.KEYBOARD&&this.setInputMethod(null);this.app.event("AccessibleComponentCompletedEvent").publish(this)};e.prototype.toggleKeyboardMode=function(){if(this.inputMethod!==l.InputMethod.KEYBOARD)this.onKeyboardStart();else this.onKeyboardStop()};
e.prototype.onInputMethodChange=function(c){this.app.event("InputMethodChangedEvent").publish(c)};e.prototype.onKeyboardStart=function(){this._mouseDownHandle&&(this._mouseDownHandle.remove(),this._mouseDownHandle=null);this.setInputMethod(l.InputMethod.KEYBOARD)};e.prototype.onKeyboardStop=function(c){this.setInputMethod(null)};e.prototype._onKeyDown=function(c){};e.prototype._onKeyUp=function(c){};return e}();f.AccessibleMapComponent=h});
define("infrastructure/accessibility/ExtendedDrawOptions",["require","exports"],function(h,f){});define("infrastructure/accessibility/ExtendedEditOptions",["require","exports"],function(h,f){});define("infrastructure/accessibility/EditInterface",["require","exports"],function(h,f){});define("infrastructure/accessibility/EditCapability",["require","exports"],function(h,f){});
define("infrastructure/accessibility/EditCapabilityBase",["require","exports"],function(h,f){var k=function(){function l(e,c,a){this.map=this.graphic=this.owner=null;this.suspended=!1;this.graphic=e;this.map=c;this.owner=a}l.prototype.destroy=function(){this.suspended=!1;this.graphic=this.map=this.owner=null};l.prototype.refresh=function(e){};l.prototype.suspend=function(){this.suspended=!0};l.prototype.resume=function(){this.suspended=!1};return l}();f.EditCapabilityBase=k});
define("infrastructure/accessibility/GraphicMoverOptions",["require","exports"],function(h,f){});define("infrastructure/DatumTransformRegistryItem",["require","exports"],function(h,f){});define("infrastructure/gis/DatumTransform",["require","exports"],function(h,f){});define("infrastructure/DatumTransformParameters",["require","exports"],function(h,f){});define("infrastructure/buffer/BufferUnitDesc",["require","exports"],function(h,f){});
define("infrastructure/buffer/BufferUnits",["require","exports"],function(h,f){});define("infrastructure/buffer/BufferResultBase",["require","exports"],function(h,f){});define("infrastructure/buffer/BufferOperationResult",["require","exports"],function(h,f){});define("infrastructure/buffer/BufferArgsBase",["require","exports"],function(h,f){});define("infrastructure/buffer/BufferGeometryArgs",["require","exports"],function(h,f){});
define("infrastructure/buffer/BufferGeometriesArgs",["require","exports"],function(h,f){});define("infrastructure/buffer/BufferOperationError",["require","exports"],function(h,f){});
define("infrastructure/buffer/BufferUtils",["require","exports","infrastructure/GeometryUtils","geocortex/essentials/DistanceUnit"],function(h,f,k,l){function e(g,m){var e=function(d){var e=null;h(["esri/tasks/BufferParameters"],function(c){e=new esri.tasks.BufferParameters;e.geometries=d;e.unit=a(m.bufferUnit);e.bufferSpatialReference=m.bufferSpatialReference||m.outSpatialReference||m.geometries[0].spatialReference||g.map.spatialReference;e.outSpatialReference=m.outSpatialReference||g.map.spatialReference||
m.geometries[0].spatialReference||m.bufferSpatialReference;e.distances=[m.bufferDistance];e.unionResults=void 0!=m.unionResults?!!m.unionResults:!0;e.geodesic=!!m.geodesic;e.unit==f.GCX_UNIT_YARDS&&(e.unit=esri.tasks.GeometryService.UNIT_FOOT,e.distances=[b(m.bufferDistance,f.GCX_UNIT_YARDS,esri.tasks.GeometryService.UNIT_FOOT)])});return new Promise(function(a,b){c(g,e).then(a,b)})};return new Promise(function(a,b){var g=[];d(m.geometries).forEach(function(a){g.push(e(a))});Promise.all(g).then(function(d){var g=
d[0];g.bufferId=m.bufferId;g.sourceCommand=m.sourceCommand;if(1===d.length)a(g);else{for(var c=1;c<d.length;c++){var e=d[c].geometries;e.length&&(g.geometries=g.geometries.concat(e))}m.unionResults?k.unionGeometries(g.geometries).then(function(b){k.isValidGeometry(b)&&(g.geometries=[b],g.geometry=b,a(g))},function(a){var d={};d.error=a;d.bufferId=m.bufferId;d.sourceCommand=m.sourceCommand;b(d)}):a(g)}},function(a){a.bufferId=m.bufferId;a.sourceCommand=m.sourceCommand;b(a)})})}function c(a,b){var d=
function(a,b){var d={};a&&(d.geometries=a);b&&(d.error=b);return d};return new Promise(function(g,c){var m=k.getGeometryService(a);if(m){var e=function(){0===b.distances[0]?g(d(b.geometries,null)):m.buffer(b,function(a){return g(d(a,null))},function(a){return c(d(null,a))})};esri.geometry.normalizeCentralMeridian(b.geometries).then(function(a){"polygon"===a[0].type?m.simplify(b.geometries,function(a){b.geometries=a;e()},function(a){c(d(null,a))}):(b.geometries=a,e())})}else a.trace.error("BufferUtils: Buffer operation failed. Could not retrieve geometry service."),
c(d(null,Error("BufferUtils: Buffer operation failed. Could not retrieve geometry service.")))})}function a(a,b){if(!a)return null;var d=null;switch(a){case "feet":case l.DistanceUnitType.FEET:case esri.tasks.GeometryService.UNIT_FOOT.toString():case esri.Units.FEET:d=esri.tasks.GeometryService.UNIT_FOOT;break;case "kilometer":case l.DistanceUnitType.KILOMETERS:case esri.tasks.GeometryService.UNIT_KILOMETER.toString():case esri.Units.KILOMETERS:d=esri.tasks.GeometryService.UNIT_KILOMETER;break;case "meter":case l.DistanceUnitType.METERS:case esri.tasks.GeometryService.UNIT_METER.toString():case esri.Units.METERS:d=
esri.tasks.GeometryService.UNIT_METER;break;case "mile":case l.DistanceUnitType.MILES:case esri.tasks.GeometryService.UNIT_STATUTE_MILE.toString():case esri.Units.MILES:d=esri.tasks.GeometryService.UNIT_STATUTE_MILE;break;case "nauticalmile":case l.DistanceUnitType.NAUTICAL_MILES:case esri.tasks.GeometryService.UNIT_NAUTICAL_MILE.toString():case esri.Units.NAUTICAL_MILES:d=esri.tasks.GeometryService.UNIT_NAUTICAL_MILE;break;case "yard":case l.DistanceUnitType.YARDS:case esri.Units.YARDS:d=f.GCX_UNIT_YARDS;
break;default:d=b||a}return d}function b(a,b,d){var g=0;switch(b){case esri.tasks.GeometryService.UNIT_METER:g=3.280839895013*a;break;case esri.tasks.GeometryService.UNIT_KILOMETER:g=3280.839895013123*a;break;case esri.tasks.GeometryService.UNIT_STATUTE_MILE:g=5280*a;break;case esri.tasks.GeometryService.UNIT_NAUTICAL_MILE:g=6076.12*a;break;case f.GCX_UNIT_YARDS:g=3*a;break;default:g=a}switch(d){case esri.tasks.GeometryService.UNIT_METER:return g/3.280839895013;case esri.tasks.GeometryService.UNIT_KILOMETER:return g/
3280.839895013123;case esri.tasks.GeometryService.UNIT_STATUTE_MILE:return g/5280;case esri.tasks.GeometryService.UNIT_NAUTICAL_MILE:return g/6076.12;case f.GCX_UNIT_YARDS:return g/3;default:return g}}function d(a){var b=[];a.forEach(function(a){for(var d=!1,g=0;g<b.length;g++)if(b[g].length&&b[g][0].type===a.type){b[g].push(a);d=!0;break}d||(d=b.length,b[d]=[],b[d].push(a))});return b}f.SUPPORTED_BUFFER_UNITS={feet:null,yard:null,meter:null,kilometer:null,mile:null,nauticalmile:null};var g=[3819,
3821,3824,3889,3906,5013,5233,5246,5252,5264,5324,5340,5354,5360,5365,5371,5373,5381,5393,5451,5464,5467,5489,5524,5527,5546,5561,37257,104E3,104020,104023,104199,104223,104896],m=[[4001,4999],[5228,5229],[2044,2045],[2081,2083],[2085,2086],[2093,2093],[2096,2098],[2105,2132],[2169,2170],[2176,2180],[2193,2193],[2200,2200],[2206,2212],[2319,2319],[2320,2462],[2523,2549],[2551,2735],[2738,2758],[2935,2941],[2953,2953],[3006,3030],[3034,3035],[3058,3059],[3068,3068],[3114,3118],[3126,3138],[3300,3301],
[3328,3335],[3346,3346],[3350,3352],[3366,3366],[3416,3416],[20004,20032],[20064,20092],[21413,21423],[21473,21483],[21896,21899],[22171,22177],[22181,22187],[22191,22197],[25884,25884],[27205,27232],[27391,27398],[27492,27492],[28402,28432],[28462,28492],[30161,30179],[30800,30800],[31251,31259],[31275,31279],[31281,31290],[31466,31700],[37001,37008],[37201,37208],[37211,37235],[37237,37243],[37245,37247],[37249,37255],[37259,37260],[104100,104145],[104256,104259],[104260,104261],[104286,104287],
[104304,104305],[104700,104786],[104800,104871],[104900,104970],[104990,104992]];f.GCX_UNIT_YARDS=12345;f.bufferGeometry=function(a,b){var d={bufferId:b.bufferId,geometries:[b.geometry],callback:b.callback,geodesic:b.geodesic,bufferSpatialReference:b.bufferSpatialReference,outSpatialReference:b.outSpatialReference,bufferDistance:b.bufferDistance,bufferUnit:b.bufferUnit,unionResults:b.unionResults,sourceCommand:b.sourceCommand};return new Promise(function(b,g){e(a,d).then(function(a){a.geometry=a.geometries[0]||
null;b(a)},function(a){g(a)})})};f.bufferGeometries=e;f.buffer=c;f.isGeographicWkid=function(a){a=parseInt(a,10);if(isNaN(a))return!1;if(-1<g.indexOf(a))return!0;for(var b=0;b<m.length;b++)if(a>=m[b][0]&&a<=m[b][1])return!0;return!1};f.getUnitDescFromConfig=function(a){for(var b in f.SUPPORTED_BUFFER_UNITS)if(f.SUPPORTED_BUFFER_UNITS.hasOwnProperty(b)&&f.SUPPORTED_BUFFER_UNITS[b]&&f.SUPPORTED_BUFFER_UNITS[b].config===a)return f.SUPPORTED_BUFFER_UNITS[b];return null};f.getGeometryServiceUnitConstant=
a;f.convertLength=b});
define("infrastructure/GeometryUtils","require exports geocortex/framework/utils/utils geocortex/essentials/GeometryUtilities geocortex/essentials/RestHelperHTTPService infrastructure/buffer/BufferUtils".split(" "),function(h,f,k,l,e,c){function a(a){var b=k.isNullOrUndefined;if(b(a))return!1;switch(a.type){case "point":return!b(a.x)&&!b(a.y);case "multipoint":return(a=a.points)&&0<a.length;case "polyline":return(a=a.paths)&&0<a.length;case "polygon":return(a=a.rings)&&0<a.length;case "extent":return!b(a.xmin)&&
!b(a.xmax)&&!b(a.ymin)&&!b(a.ymax);default:return!1}}function b(a,b){var d=b.x-a.x,g=b.y-a.y;return Math.sqrt(d*d+g*g)}function d(a){if(!a||!a.configuration)return null;if(s&&s.url&&s.url.startsWith(a.configuration.geometryServiceUrl))return s;var b=a.configuration.geometryServiceUrl,d=a.configuration.geometryServiceToken;if(d)var b=e.RestHelperHTTPService.appendTokenToUrl(b,d),g=dojo.subscribe("ServiceTokenRefreshed",function(b){b.serviceUrl===a.configuration.geometryServiceUrl&&(a.configuration.geometryServiceToken=
b.token,s=null,dojo.unsubscribe(g))});"https:"!=window.location.protocol||/^(https|\/\/)/.test(b)||a.trace.warning("Mixed Content Warning: This Viewer was loaded over HTTPS but the geometry service was loaded over HTTP. This may limit functionality. Please configure the geometry service to be served securely.");return s=new esri.tasks.GeometryService(b)}function g(a,b,d,g){if(a&&(!esri.tasks.hasOwnProperty("ProjectParameters")||a instanceof esri.tasks.ProjectParameters)&&a.hasOwnProperty("outSR")&&
a.hasOwnProperty("geometries"))if(b&&dojo.isFunction(b))if(a.outSR){var c=a.geometries,m=!1;c&&0<c.length&&(l.spatialRefsAreEqual(c[0].spatialReference,a.outSR,!1)||(m=!0));m?(g=this._getGeometryService(g),a.outSR.isWebMercator()&&4326===c[0].spatialReference.wkid||4326===a.outSR.wkid&&c[0].spatialReference.isWebMercator()?this._projectLocally(a.geometries,a.outSR,b,d):g?((c=q(c[0].spatialReference,a.outSR))&&!a.transformation&&(a.transformation=c.transformation,a.transformForward=c.transformForward),
esri.tasks.hasOwnProperty("ProjectParameters")?g.project(a,b,d):g.project(a.geometries,a.outSR,b,d)):d&&dojo.isFunction(d)&&d(Error("Unable to get the geometry service. Make sure a geometry service url is configured in the application."))):b(c)}else d&&dojo.isFunction(d)&&d(Error("output spatial reference is required."));else d&&dojo.isFunction(d)&&d(Error("callback required."));else d&&dojo.isFunction(d)&&d(Error("projectParameters required."))}function m(a){a.forEach(function(a){var b=null;a.fromWkid&&
0<a.fromWkid?b=new esri.SpatialReference(a.fromWkid):a.fromWkt&&(b=new esri.SpatialReference(a.fromWkt));var d=null;a.toWkid&&0<a.toWkid?d=new esri.SpatialReference(a.toWkid):a.toWkt&&(d=new esri.SpatialReference(a.toWkt));var g=null;a.transformWkid&&0<a.transformWkid?g=new esri.SpatialReference(a.transformWkid):a.transformWkt&&(g=new esri.SpatialReference(a.transformWkt));if(!b||!d||!g)throw Error("Invalid or missing spatial reference. Cannot register datum transform.");p.push({fromSR:b,toSR:d,transformation:g})})}
function q(a,b){if(!a||!b||0==p.length)return null;for(var d=0;d<p.length;d++){var g=p[d];if(l.spatialRefsAreEqual(a,g.fromSR)&&l.spatialRefsAreEqual(b,g.toSR))return{transformation:g.transformation,transformForward:!0};if(l.spatialRefsAreEqual(a,g.toSR)&&l.spatialRefsAreEqual(b,g.fromSR))return{transformation:g.transformation,transformForward:!1}}return null}function n(a,b){if(3>a.length)return a;for(var d=1,g=0,c=1;c<a.length-1;c++){var m;m=a[c];var e=a[0],q=a[a.length-1],p=void 0,s=p=void 0;e[0]===
q[0]?p=Math.abs(m[0]-e[0]):(p=(q[1]-e[1])/(q[0]-e[0]),s=e[1]-p*e[0],p=Math.abs(p*m[0]-m[1]+s)/Math.sqrt(Math.pow(p,2)+1));m=p;m>g&&(g=m,d=c)}return g>b?(g=n(a.slice(0,d+1),b),d=n(a.slice(d),b),g.slice(0,g.length-1).concat(d)):[a[0],a[a.length-1]]}f.DEFAULT_GEOMETRY_SERVICE_URI="http://sampleserver6.arcgisonline.com/arcgis/rest/services/Utilities/Geometry/GeometryServer";var p=[],s=null;f.isValidGeometry=a;f.getMiddle=function(d){if(!d||!d.type||!a(d))return null;if("point"==d.type)return d;if("multipoint"==
d.type)return(d=d.getExtent())?d.getCenter():null;if("polyline"==d.type){for(var g=0,c=0;c<d.paths.length;c++)for(var m=0;m<d.paths[c].length-1;m++)var e=new esri.geometry.Point(d.paths[c][m]),q=new esri.geometry.Point(d.paths[c][m+1]),g=g+b(e,q);for(var n=0,c=0;c<d.paths.length;c++)for(m=0;m<d.paths[c].length-1;m++){var e=new esri.geometry.Point(d.paths[c][m]),q=new esri.geometry.Point(d.paths[c][m+1]),p=b(e,q);if(n+p>g/2)return g=p/(g/2-n),new esri.geometry.Point(e.x+(q.x-e.x)/g,e.y+(q.y-e.y)/g,
d.spatialReference);n+=p}}else{if("polygon"==d.type)return(d=d.getExtent())?d.getCenter():null;if("extent"==d.type)return d.getCenter()}return null};f.getMidpoint=function(a,b){if(!a||!b)throw Error("The beginning and ending points are required.");return new esri.geometry.Point({x:(a.x+b.x)/2,y:(a.y+b.y)/2,spatialReference:a.spatialReference.toJson()})};f.getEsriGeometryType=function(a,b){if(!a)return null;var d=null;switch(a.toLowerCase()){case "rectangle":d=esri.toolbars.Draw.EXTENT;break;case "freehandpolygon":d=
esri.toolbars.Draw.FREEHAND_POLYGON;break;case "freehandpolyline":d=esri.toolbars.Draw.FREEHAND_POLYLINE;break;case "mappoint":d=esri.toolbars.Draw.POINT;break;case "multipoint":d=esri.toolbars.Draw.MULTI_POINT;break;case "polygon":d=esri.toolbars.Draw.POLYGON;break;case "polyline":d=esri.toolbars.Draw.POLYLINE;break;default:d=b||esri.toolbars.Draw.EXTENT}return d};f._getGeometryService=function(a){return d(a)};f.getGeometryService=d;f.needsProjection=function(a,b){return l.spatialRefsAreEqual(a.spatialReference,
b.map.spatialReference,!1)?!1:!0};f.projectGeometry=function(a,b,d,g,c){if(a&&a.spatialReference)if(a.spatialReference.equals(b))d&&d(a);else{var m=new esri.tasks.ProjectParameters;m.outSR=b;m.geometries=[a];this.project(m,function(a){a&&0<a.length&&d&&d(a[0])},g,c)}else g&&g(Error("Invalid geometry or spatial reference."))};f.projectGeometryWithTransform=function(a,b,d,g,c,m){if(d)if(a&&a.spatialReference)if(a.spatialReference.equals(b))g&&g(a);else{var e=new esri.tasks.ProjectParameters;e.outSR=
b;e.geometries=[a];e.transformation={wkid:d};this.project(e,function(a){a&&0<a.length&&g&&g(a[0])},c,m)}else c&&c(Error("Invalid geometry or spatial reference."));else this.projectGeometry(a,b,g,c)};f.project=g;f.simplifyPolygons=function(a,b,d,g){this._getGeometryService(g).simplify(a,b,d)};f.simplifyPolygon=function(a,b,d,g){this.simplifyPolygons([a],function(a){a&&0<a.length?b(a[0]):d()},d,g)};f._projectLocally=function(a,b,d,g){for(var c=[],m=0;m<a.length;m++)a[m].spatialReference.isWebMercator()&&
4326===b.wkid?c[m]=esri.geometry.webMercatorToGeographic(a[m]):4326===a[m].spatialReference.wkid&&b.isWebMercator()?c[m]=esri.geometry.geographicToWebMercator(a[m]):(g&&dojo.isFunction(g)&&g(Error("Unable to get the geometry service. Make sure a geometry service url is configured in the application.")),this.app.trace.error("An operation requiring projection attempted to project while offline, but was not between WebMercator and WGS84"));d(c)};f.createCircle=function(a,b,d,g){var c=[],m=null;g=g||
40;a=new esri.geometry.Polygon(a);for(var m=360/g,e=1;e<=g;e++){var q=e*m*Math.PI/180;c.push([b.x+d*Math.cos(q),b.y+d*Math.sin(q)])}c.push(c[0]);a.addRing(c);return a};f.fixAspectRatio=function(a,b){var d=b.getWidth()/b.getHeight(),g=a.getWidth()/a.getHeight(),c=a.getWidth(),m=a.getHeight();g<d?c=d*m:m=1/d*c;d=a.getCenter();return new esri.geometry.Extent(d.x-c/2,d.y-m/2,d.x+c/2,d.y+m/2,a.spatialReference)};f.extentToPolygon=function(a){var b=new esri.geometry.Polygon(a.spatialReference),d=[];d.push(new esri.geometry.Point(a.getCenter().x-
a.getWidth()/2,a.getCenter().y-a.getHeight()/2));d.push(new esri.geometry.Point(a.getCenter().x-a.getWidth()/2,a.getCenter().y+a.getHeight()/2));d.push(new esri.geometry.Point(a.getCenter().x+a.getWidth()/2,a.getCenter().y+a.getHeight()/2));d.push(new esri.geometry.Point(a.getCenter().x+a.getWidth()/2,a.getCenter().y-a.getHeight()/2));d.push(new esri.geometry.Point(a.getCenter().x-a.getWidth()/2,a.getCenter().y-a.getHeight()/2));b.addRing(d);return b};f.pointsAreEqual=function(a,b){return a&&!b||
!a&&b?!1:a?a.x!==b.x||a.y!==b.y||!a.spatialReference&&b.spatialReference||a.spatialReference&&!b.spatialReference||!a.spatialReference.equals(b.spatialReference)?!1:!0:!0};f.registerDefaultDatumTransforms=function(){var a=[];a.push({transformWkid:108457,fromWkid:28992,toWkid:4326});a.push({transformWkid:1195,fromWkid:27700,toWkid:4326});a.push({transformWkid:1623,fromWkid:102067,toWkid:4326});m(a)};f.registerDatumTransforms=m;f.getDatumTransformParameters=q;f.intersects=function(a,b){return new Promise(function(d,
g){h(["esri/geometry/geometryEngine"],function(c){try{d(c.intersects(a,b))}catch(m){g(m)}})})};f.unionGeometries=function(a){return new Promise(function(b,d){h(["esri/geometry/geometryEngine"],function(g){try{b(g.union(a))}catch(c){d(c)}})})};f.convertMetersToMapPoints=function(a,b){var d=this;return new Promise(function(m,e){h(["esri/geometry/geometryEngine"],function(q){var n=new esri.SpatialReference(a.spatialReference.toJson()),p=a.units;try{if(p&&!p.isLinear()||n.wkid&&c.isGeographicWkid(n.wkid))m(b/
111319.4907932738);else{var s=new esri.geometry.Point(0,0,n),l=new esri.geometry.Point(0,100,n),f=new esri.tasks.ProjectParameters;f.geometries=[s,l];f.outSR=new esri.SpatialReference(102100);g(f,function(a){a=q.distance(a[0],a[1],"meters");m(100/a*b)},function(a){return e(a)},d.app)}}catch(k){e(k)}})})};f.explodeGeometry=function(a){switch(a.type){case "polygon":return a.rings.map(function(b){return(new esri.geometry.Polygon(b)).setSpatialReference(a.spatialReference)});case "polyline":return a.paths.map(function(b){return(new esri.geometry.Polyline(b)).setSpatialReference(a.spatialReference)});
case "multipoint":return a.points.map(function(b){return new esri.geometry.Point(b,a.spatialReference)})}return[a]};f.cutGeometries=function(a,b,d){var g=this;return new Promise(function(c,m){var e=g.getGeometryService(d);if(!e)return Promise.reject(Error("Unable to get the geometry service. Make sure a geometry service url is configured in the application."));try{e.cut(a,b).then(function(a){for(var b=[],d=0;d<a.geometries.length;d++){var g=a.cutIndexes[d];b[g]||(b[g]=[]);b[g].push(a.geometries[d])}c(b)})}catch(q){m(q)}})};
f.toRing=function(a){return[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]};f.createToleranceEnvelope=function(a,b,d){if(b&&"point"===b.type){var g=a.extent.getWidth()/a.width;d*=g;return new esri.geometry.Extent(b.x-d,b.y-d,b.x+d,b.y+d,a.spatialReference)}return b};f.getRamerDouglasPeuckerSimplifiedGeometry=function(b,d){var g=function(a,d){void 0===a&&(a=!1);void 0===d&&(d="");a&&console.log("An error occurred during the Ramer Douglas Pecker geometry simplification process."+
d+". Using original geometry. This may have performance implications.");return esri.geometry.fromJson(b.toJson())};if(!(b instanceof esri.geometry.Polygon||b instanceof esri.geometry.Polyline))return g();try{for(var c=[],m=b.rings||b.paths,e=0;e<m.length;e++)c.push(n(m[e],d));if(b instanceof esri.geometry.Polygon){var q=new esri.geometry.Polygon(b.spatialReference);c.forEach(function(a){return q.addRing(a)});return a(q)?q:g(!0)}var p=new esri.geometry.Polyline(b.spatialReference);c.forEach(function(a){return p.addPath(a)});
return a(p)?p:g(!0)}catch(s){return g(!0,s.message)}}});
define("infrastructure/MatrixUtils",["require","exports","infrastructure/GeometryUtils"],function(h,f,k){h=function(){function l(){}l.translate=function(e,c,a,b){if(!e||!c)return null;switch(e.type){case "point":e=c.toScreen(e);e=c.toMap(e.offset(a,b));break;case "polyline":e=this._applyOffset(e,e.paths,a,b,c);break;case "polygon":e=this._applyOffset(e,e.rings,a,b,c)}return{geometry:e,transform:dojox.gfx.matrix.translate(a,b)}};l.rotate=function(e,c,a,b){if(!e||!c)return null;b=b||this.getCentroid(e);
var d=dojox.gfx.matrix.rotategAt(-a,b.x,b.y);switch(e.type){case "polyline":e=this._applyTransform(e,e.paths,d);break;case "polygon":e=this._applyTransform(e,e.rings,d)}c=c.toScreen(b);return{geometry:e,transform:dojox.gfx.matrix.rotategAt(-a,c.x,c.y)}};l.scale=function(e,c,a,b){void 0===b&&(b=null);if(!e||!c)return null;if(isNaN(a)||Infinity===a||-Infinity===a)a=1;if(null===b||"undefined"===typeof b)b=a;var d=this.getCentroid(e),g=dojox.gfx.matrix.scaleAt(a,b,d.x,d.y);switch(e.type){case "polyline":e=
this._applyTransform(e,e.paths,g);break;case "polygon":e=this._applyTransform(e,e.rings,g)}c=c.toScreen(d);return{geometry:e,transform:dojox.gfx.matrix.scaleAt(a,b,c.x,c.y)}};l.getCentroid=function(e){if(!e||!e.type||!k.isValidGeometry(e))return null;var c;switch(e.type){case "point":return e;case "multipoint":case "polyline":case "polygon":if(c=e.getExtent())return c.getCenter();case "extent":return e.getCenter()}return null};l._applyOffset=function(e,c,a,b,d){if(e&&c){var g=e.getPoint(0,0);b=d.toMap(d.toScreen(g).offset(a,
b));a=b.x-g.x;g=b.y-g.y;for(b=0;b<c.length;b++)for(d=0;d<c[b].length;d++){var m=e.getPoint(b,d);e.setPoint(b,d,m.offset(a,g))}}return e};l._applyTransform=function(e,c,a){if(e&&c)for(var b=0;b<c.length;b++)for(var d=0;d<c[b].length;d++){var g=e.getPoint(b,d),m=dojox.gfx.matrix.multiplyPoint(a,g.x,g.y);g.setX(m.x);g.setY(m.y);e.setPoint(b,d,g)}return e};return l}();f.MatrixUtils=h});define("infrastructure/eventArgs/EditVertexMovedEventArgs",["require","exports"],function(h,f){});
define("infrastructure/accessibility/GraphicMover",["require","exports","infrastructure/accessibility/EditCapabilityBase","infrastructure/MatrixUtils"],function(h,f,k,l){h=function(e){function c(a,b,d,g,c){a=e.call(this,a,b,d)||this;a._options={offsetX:10,offsetY:10,preciseOffsetX:1,preciseOffsetY:1};a._modified=!1;a._isMoving=!1;a._transform=null;a._textAnchor=null;a._keyDownHandle=null;a._keyUpHandle=null;a._options=dojo.mixin(a._options,c||{});a._textAnchor=g;a._init();return a}__extends(c,e);
c.prototype.hasMoved=function(){return this._modified};c.prototype.destroy=function(){e.prototype.destroy.call(this);this._cleanUp()};c.prototype.refresh=function(a){void 0===a&&(a=!1);e.prototype.refresh.call(this,a);this.graphic&&(a||this._needsRefresh())&&(this._cleanUp(),this._init())};c.prototype._needsRefresh=function(){return null==this._keyDownHandle};c.prototype._init=function(){this._keyDownHandle=dojo.on(this.map.root,"keydown",dojo.hitch(this,"_onKeyDownHandler"));this._keyUpHandle=dojo.on(this.map.root,
"keyup",dojo.hitch(this,"_onKeyUpHandler"))};c.prototype._cleanUp=function(){this._isMoving=this._modified=!1;this._textAnchor=this._transform=null;this._keyDownHandle&&(this._keyDownHandle.remove(),this._keyDownHandle=null);this._keyUpHandle&&(this._keyUpHandle.remove(),this._keyUpHandle=null)};c.prototype._onKeyDownHandler=function(a){if(!this.suspended){var b=a.altKey,d=b?this._options.preciseOffsetX:this._options.offsetX,b=b?this._options.preciseOffsetY:this._options.offsetY,g=0,c=0;switch(a.keyCode||
a.which){case dojo.keys.UP_ARROW:case dojo.keys.NUMPAD_8:c=-1;break;case dojo.keys.RIGHT_ARROW:case dojo.keys.NUMPAD_6:g=1;break;case dojo.keys.DOWN_ARROW:case dojo.keys.NUMPAD_2:c=1;break;case dojo.keys.LEFT_ARROW:case dojo.keys.NUMPAD_4:g=-1;break;case dojo.keys.PAGE_UP:case dojo.keys.NUMPAD_9:g=1;c=-1;break;case dojo.keys.PAGE_DOWN:case dojo.keys.NUMPAD_3:c=g=1;break;case dojo.keys.END:case dojo.keys.NUMPAD_1:g=-1;c=1;break;case dojo.keys.HOME:case dojo.keys.NUMPAD_7:c=g=-1;break;default:return}this._moveGraphic(g*
d,c*b);a.preventDefault();a.stopPropagation()}};c.prototype._onKeyUpHandler=function(a){if(!this.suspended){switch(a.keyCode||a.which){case dojo.keys.UP_ARROW:case dojo.keys.NUMPAD_8:case dojo.keys.RIGHT_ARROW:case dojo.keys.NUMPAD_6:case dojo.keys.DOWN_ARROW:case dojo.keys.NUMPAD_2:case dojo.keys.LEFT_ARROW:case dojo.keys.NUMPAD_4:case dojo.keys.PAGE_UP:case dojo.keys.NUMPAD_9:case dojo.keys.PAGE_DOWN:case dojo.keys.NUMPAD_3:case dojo.keys.END:case dojo.keys.NUMPAD_1:case dojo.keys.HOME:case dojo.keys.NUMPAD_7:this._isMoving=
!1;this.map.enableMapNavigation();this.owner.onGraphicMoveStop(this.graphic,this._transform);break;default:return}a.preventDefault();a.stopPropagation()}};c.prototype._moveGraphic=function(a,b){this._isMoving||(this.owner.onGraphicMoveStart(this.graphic),this.owner.onGraphicFirstMove(this.graphic),this._isMoving=!0,this.map.disableMapNavigation());var d=l.MatrixUtils.translate(this.graphic.geometry,this.map,a,b);this._transform=d.transform;this._modified=!0;this.graphic.setGeometry(d.geometry);this._textAnchor&&
this._textAnchor.setGeometry(new esri.geometry.Point(this.graphic.geometry.toJson()));this.owner.refresh();this.owner.onGraphicMove(this.graphic,d.transform);this.graphic.geometry instanceof esri.geometry.Point&&(d=this.graphic.geometry.offset(0,0),d={sender:this,mapPoint:d,screenPoint:this.map.toScreen(d)},this._raiseEditVertexMoved(d))};c.prototype._raiseEditVertexMoved=function(a){this.owner&&this.owner.app&&this.owner.app.event("EditVertexMovedEvent").publish(a)};return c}(k.EditCapabilityBase);
f.GraphicMover=h});define("infrastructure/accessibility/VertexInfo",["require","exports"],function(h,f){});define("infrastructure/accessibility/VertexEditorOptions",["require","exports"],function(h,f){});define("infrastructure/eventArgs/SnappingFeedbackEventArgs",["require","exports"],function(h,f){var k=function(){return function(){}}();f.SnappingFeedbackEventArgs=k});
define("infrastructure/accessibility/VertexEditor",["require","exports","infrastructure/accessibility/EditCapabilityBase","infrastructure/GeometryUtils","infrastructure/MatrixUtils"],function(h,f,k,l,e){h=function(c){function a(a,d,g,m){a=c.call(this,a,d,g)||this;a._keyDownHandle=null;a._keyUpHandle=null;a._keyDx=0;a._keyDy=0;a._transform=null;a._isMoving=!1;a._isActive=!1;a._vertexControls=null;a._midpointControls=null;a._allControls=null;a._selectedControl=null;a._vertexHandleGraphic=null;a._options=
{offsetX:10,offsetY:10,preciseOffsetX:1,preciseOffsetY:1,allowAddVertices:!0,allowDeleteVertices:!0};a._snappingInputMovedToken=null;a._options=dojo.mixin(a._options,m||{});a._init();a.owner&&a.owner.app&&(a._snappingInputMovedToken=a.owner.app.event("SnappingFeedbackEvent").subscribe(a,a._handleSnappingInputMovedEvent));return a}__extends(a,c);a.create=function(a,d,g,c){console.log("This method is obsolete. Call createVertexEditor in VertexEditorFactory instead.");throw Error("This method is obsolete. Call createVertexEditor in VertexEditorFactory instead.");
};a.prototype._handleSnappingInputMovedEvent=function(a){a&&a.snappingPoint&&this.graphic&&this.getSelectedVertex()&&this._vertexHandleGraphic&&this._vertexHandleGraphic.visible&&(this._updateGraphicVertex(a.snappingPoint,this.getSelectedVertex().segmentIndex,this.getSelectedVertex().pointIndex),this.owner.refresh())};a.prototype.isActive=function(){return this._isActive};a.prototype.hideVertexHandle=function(){this._vertexHandleGraphic&&(this._vertexHandleGraphic.hide(),this.owner&&this.owner.app&&
this.owner.app.event("VertexHandleHiddenEvent").publish())};a.prototype.showVertexHandle=function(){if(this._selectedControl){var a=this._selectedControl.point.offset(0,0);this._vertexHandleGraphic?(this._vertexHandleGraphic.setGeometry(a).setSymbol(this._options.selectedVertexSymbol),this._vertexHandleGraphic.show()):this._vertexHandleGraphic=this.map.graphics.add(new esri.Graphic(a,this._options.selectedVertexSymbol));this.owner&&this.owner.app&&this.owner.app.event("VertexHandleShownEvent").publish(a);
(a=this._vertexHandleGraphic.getDojoShape())&&a.moveToFront()}};a.prototype.destroy=function(){this._cleanUp();c.prototype.destroy.call(this)};a.prototype.refresh=function(a){void 0===a&&(a=!1);this._transform=null;a?(this._removeControllers(),this._addControllers()):this._refreshControllers()};a.prototype.getSelectedVertex=function(){return this._selectedControl};a.prototype.onVertexAdd=function(a){if(a&&a.segmentIndex===this._selectedControl.segmentIndex){var d=null,g=this._selectedControl.segmentIndex,
c=this._selectedControl.pointIndex;this._selectedControl.isGhost?(d=this._midpointControls,a.pointIndex<c+1?c+=1:a.pointIndex===c+1&&(c=a.pointIndex,d=this._vertexControls)):(d=this._vertexControls,c+=a.pointIndex<=c?1:0);this._selectedControl=d[g][c]}};a.prototype.onVertexDelete=function(a){if(a&&a.segmentIndex===this._selectedControl.segmentIndex){var d=null,g=this._selectedControl.segmentIndex,c=this._selectedControl.pointIndex;this._selectedControl.isGhost?(d=this._midpointControls,c-=a.pointIndex<=
c?1:0):(d=this._vertexControls,c-=a.pointIndex<=c&&0<c?1:0);this._selectedControl=d[g][c]}};a.prototype._init=function(){this._keyDownHandle=dojo.on(this.map.root,"keydown",dojo.hitch(this,"_onKeyDownHandler"))};a.prototype._cleanUp=function(){this._isMoving=this._isActive=!1;this._selectedControl=this._transform=null;this._removeControllers();this._vertexHandleGraphic&&(this.map.graphics.remove(this._vertexHandleGraphic),this._vertexHandleGraphic=null);this._keyDownHandle&&(this._keyDownHandle.remove(),
this._keyDownHandle=null);this._keyUpHandle&&(this._keyUpHandle.remove(),this._keyUpHandle=null);this.owner.app&&this.owner.app&&this._snappingInputMovedToken&&this.owner.app.event("SnappingFeedbackEvent").unsubscribe(this._snappingInputMovedToken)};a.prototype._getSegments=function(a){throw Error("This method is abstract");};a.prototype._getMidpointSegments=function(a){throw Error("This method is abstract");};a.prototype._updatePoints=function(a){throw Error("This method is abstract");};a.prototype._insertGraphicVertex=
function(a,d,g){throw Error("This method is abstract");};a.prototype._updateGraphicVertex=function(a,d,g){throw Error("This method is abstract");};a.prototype._deleteGraphicVertex=function(a,d){throw Error("This method is abstract");};a.prototype._findVertex=function(a,d){for(var g=d?d.length:0,c=0;c<g;c++)for(var e=d[c],n=0;n<e.length;n++){var p=e[n];if(p&&l.pointsAreEqual(p.point,a))return p}return null};a.prototype._addControllers=function(){var a=this;this._vertexControls=this._add(this._getSegments(this.graphic.geometry));
this._options.allowAddVertices&&(this._midpointControls=this._add(this._getMidpointSegments(this.graphic.geometry),!0));this._allControls=[];this._vertexControls.forEach(function(d,g){d.forEach(function(d,c){a._allControls.push(d);a._midpointControls&&a._midpointControls[g]&&c<a._midpointControls[g].length&&a._allControls.push(a._midpointControls[g][c])})})};a.prototype._removeControllers=function(){this._remove(this._vertexControls);this._remove(this._midpointControls);this._vertexControls=this._midpointControls=
this._allControls=null};a.prototype._refreshControllers=function(){this._refresh(this._vertexControls,this._getSegments(this.graphic.geometry));this._options.allowAddVertices&&this._refresh(this._midpointControls,this._getMidpointSegments(this.graphic.geometry),!0)};a.prototype._add=function(a,d){void 0===d&&(d=!1);for(var g=[],c=0;c<a.length;c++){for(var e=a[c],n=[],p=0;p<e.length;p++)n.push({isGhost:d,segmentIndex:c,pointIndex:p,point:e[p]});g.push(n)}return g};a.prototype._remove=function(a){a&&
(a.forEach(function(a){a.length=0}),a.length=0)};a.prototype._refresh=function(a,d,g){void 0===g&&(g=!1);a&&d&&a.forEach(function(a,b){a.forEach(function(a,g){a.point=d[b][g]})})};a.prototype._previous=function(){var a=this._allControls.indexOf(this._selectedControl);this._selectedControl=0==a?this._allControls[this._allControls.length-1]:this._allControls[a-1];this.showVertexHandle();this._refreshControllers()};a.prototype._next=function(){var a=this._allControls.indexOf(this._selectedControl);this._selectedControl=
this._allControls[(a+1)%this._allControls.length];this.showVertexHandle();this._refreshControllers()};a.prototype._onKeyDownHandler=function(a){this.suspended||(this._isActive?this._onKeyDownWhenActive(a):86===(a.keyCode||a.which)&&(a.preventDefault(),a.stopImmediatePropagation(),this._isActive=!0,this.owner.suspend(),this.resume(),this._addControllers(),this._selectedControl=this._vertexControls[0][0],this.showVertexHandle()))};a.prototype._onKeyDownWhenActive=function(a){var d=a.altKey,g=d?this._options.preciseOffsetX:
this._options.offsetX,d=d?this._options.preciseOffsetY:this._options.offsetY;switch(a.keyCode||a.which){case 86:a.preventDefault();a.stopImmediatePropagation();a.shiftKey?this._previous():this._next();return;case dojo.keys.ENTER:case dojo.keys.NUMPAD_ENTER:a.preventDefault();a.stopImmediatePropagation();this.owner.resume();this._isActive=this._isMoving=!1;this._selectedControl=null;this._vertexHandleGraphic&&(this.hideVertexHandle(),this.map.graphics.remove(this._vertexHandleGraphic),this._vertexHandleGraphic=
null);return;case 68:this._options.allowDeleteVertices&&(this._delete(this.getSelectedVertex()),a.preventDefault(),a.stopImmediatePropagation());return;case dojo.keys.UP_ARROW:case dojo.keys.NUMPAD_8:this._keyDy-=d;break;case dojo.keys.RIGHT_ARROW:case dojo.keys.NUMPAD_6:this._keyDx+=g;break;case dojo.keys.DOWN_ARROW:case dojo.keys.NUMPAD_2:this._keyDy+=d;break;case dojo.keys.LEFT_ARROW:case dojo.keys.NUMPAD_4:this._keyDx-=g;break;case dojo.keys.PAGE_UP:case dojo.keys.NUMPAD_9:this._keyDx+=g;this._keyDy-=
d;break;case dojo.keys.PAGE_DOWN:case dojo.keys.NUMPAD_3:this._keyDx+=g;this._keyDy+=d;break;case dojo.keys.END:case dojo.keys.NUMPAD_1:this._keyDx-=g;this._keyDy+=d;break;case dojo.keys.HOME:case dojo.keys.NUMPAD_7:this._keyDx-=g;this._keyDy-=d;break;default:return}a.preventDefault();a.stopImmediatePropagation();this._move(this.getSelectedVertex(),this._keyDx,this._keyDy);this._moveStop(this.getSelectedVertex(),this._keyDx,this._keyDy);this._keyDx=this._keyDy=0};a.prototype._move=function(a,d,g){var c=
{isGhost:a.isGhost,pointIndex:a.pointIndex,segmentIndex:a.segmentIndex};this._isMoving||(this._isMoving=!0,this.owner.onVertexMoveStart(this.graphic,c),this.owner.onVertexFirstMove(this.graphic,c));a=this.map.toScreen(a.point).offset(d,g);this._vertexHandleGraphic.setGeometry(this.map.toMap(a));this.owner.onVertexMove(this.graphic,c,this._transform);c={sender:this,mapPoint:this.map.toMap(a),screenPoint:a};this._raiseEditVertexMoved(c)};a.prototype._raiseEditVertexMoved=function(a){this.owner&&this.owner.app&&
this.owner.app.event("EditVertexMovedEvent").publish(a)};a.prototype._moveStop=function(a,d,g){this._isMoving=!1;if(a&&a.point){var c={isGhost:a.isGhost,pointIndex:a.pointIndex,segmentIndex:a.segmentIndex};a=e.MatrixUtils.translate(a.point,this.map,d,g);this._transform=a.transform;c.isGhost?(c.pointIndex+=1,this._insertGraphicVertex(a.geometry,c.segmentIndex,c.pointIndex)):this._updateGraphicVertex(a.geometry,c.segmentIndex,c.pointIndex);this.owner.refresh();this.owner.onVertexMoveStop(this.graphic,
c,this._transform);c.isGhost&&(c.isGhost=!1,this.owner.onVertexAdd(this.graphic,c))}};a.prototype._delete=function(a){if(a&&!a.isGhost){var d={isGhost:a.isGhost,pointIndex:a.pointIndex,segmentIndex:a.segmentIndex};this._deleteGraphicVertex(a.segmentIndex,a.pointIndex);this.owner.refresh();this.owner.onVertexDelete(this.graphic,d)}};return a}(k.EditCapabilityBase);f.VertexEditor=h});define("infrastructure/accessibility/BoxEditorOptions",["require","exports"],function(h,f){});
define("infrastructure/accessibility/BoxEditor","require exports infrastructure/accessibility/EditCapabilityBase infrastructure/GeometryUtils geocortex/framework/utils/utils infrastructure/MatrixUtils".split(" "),function(h,f,k,l,e,c){h=function(a){function b(d,b,c,e,n){d=a.call(this,d,b,c)||this;d._options={rotateEnabled:!1,scaleEnabled:!1,uniformScaling:!1,rotationAngle:15,preciseRotationAngle:1,scaleFactor:0.2,preciseScaleFactor:0.01};d._scaleEnabled=!1;d._rotateEnabled=!1;d._uniformScaling=!1;
d._isTextPoint=!1;d._modified=!1;d._isRotating=!1;d._isScaling=!1;d._lineSymbol=null;d._markerSymbol=null;d._transform=null;d._keyDownHandle=null;d._keyUpHandle=null;d._options=dojo.mixin(d._options,n||{});c=c.getOptions();d._markerSymbol=d._options.boxHandleSymbol?d._options.boxHandleSymbol:c.boxHandleSymbol;d._lineSymbol=d._options.boxLineSymbol?d._options.boxLineSymbol:c.boxLineSymbol;d._scaleEnabled=!!d._options.scaleEnabled;d._rotateEnabled=!!d._options.rotateEnabled;d._uniformScaling=!!d._options.uniformScaling;
d._isTextPoint=e;d._init();return d}__extends(b,a);b.prototype.destroy=function(){a.prototype.destroy.call(this);this._cleanUp()};b.prototype._init=function(){this._keyDownHandle=dojo.on(this.map.root,"keydown",dojo.hitch(this,"_onKeyDownHandler"));this._keyUpHandle=dojo.on(this.map.root,"keyup",dojo.hitch(this,"_onKeyUpHandler"))};b.prototype._cleanUp=function(){this._isRotating=this._isScaling=this._modified=this._scaleEnabled=this._rotateEnabled=this._uniformScaling=this._isTextPoint=!1;this._lineSymbol=
this._markerSymbol=this._transform=null;this._keyDownHandle&&(this._keyDownHandle.remove(),this._keyDownHandle=null);this._keyUpHandle&&(this._keyUpHandle.remove(),this._keyUpHandle=null)};b.prototype._onKeyDownHandler=function(a){if(!this.suspended){var b=a.altKey,c=a.shiftKey,e=!1,n=b?this._options.preciseScaleFactor:this._options.scaleFactor,b=b?this._options.preciseRotationAngle:this._options.rotationAngle,p=a.keyCode||a.which;if(this._scaleEnabled)switch(p){case 83:n=c?-1*n:n,this._scaleGraphic(1+
n,1+n),e=!0}if(this._rotateEnabled)switch(p){case 82:this._rotateGraphic(c?-1*b:b),e=!0}e&&(a.preventDefault(),a.stopPropagation())}};b.prototype._onKeyUpHandler=function(a){if(!this.suspended){var b=a.keyCode||a.which,c=!1;if(this._scaleEnabled)switch(b){case 83:this._isScaling=!1,this.owner.onScaleStop(this.graphic,this._transform),c=!0}if(this._rotateEnabled)switch(b){case 82:this._isRotating=!1,this.owner.onRotateStop(this.graphic,this._transform),c=!0}c&&(a.preventDefault(),a.stopPropagation())}};
b.prototype._rotateGraphic=function(a,b){this._isRotating||(this.owner.onRotateStart(this.graphic),this.owner.onRotateFirstMove(this.graphic),this._isRotating=!0);var m=this.graphic.geometry,q=b||l.getMiddle(m);if(l.isValidGeometry(m)&&!e.isNullOrUndefined(q)){m=c.MatrixUtils.rotate(m,this.map,a,q);this._transform=m.transform;this._modified=!0;if(this._isTextPoint){var n=this.graphic.symbol;n.angle+=a;this.graphic.setSymbol(n)}else this.graphic.setGeometry(m.geometry);q={transform:m.transform,angle:a,
scaleX:1,scaleY:1,around:this.map.toScreen(q)};this.owner.refresh();this.owner.onRotate(this.graphic,q)}};b.prototype._scaleGraphic=function(a,b){this._isScaling||(this.owner.onScaleStart(this.graphic),this.owner.onScaleFirstMove(this.graphic),this._isScaling=!0);if(null===b||"undefined"===typeof b)b=a;var m=c.MatrixUtils.scale(this.graphic.geometry,this.map,a,b);this._transform=m.transform;this._modified=!0;if(this._isTextPoint){var e=this.graphic.symbol;e.font.setSize(Math.round(100*e.font.size*
a)/100);this.graphic.setSymbol(e)}else this.graphic.setGeometry(m.geometry);m={transform:m.transform,angle:0,scaleX:a,scaleY:b,around:null};this.owner.refresh();this.owner.onScale(this.graphic,m)};return b}(k.EditCapabilityBase);f.BoxEditor=h});define("infrastructure/eventArgs/GraphicEditActivatedEventArgs",["require","exports"],function(h,f){});define("infrastructure/tools/ToolConfig",["require","exports"],function(h,f){});
define("infrastructure/tools/ToolBase",["require","exports"],function(h,f){var k=function(){function l(e,c){this.name="";this.isActive=!1;dojo.mixin(this,c);this.app=e}l.prototype.setActive=function(e){e?(this.isActive=!0,this.onActivated()):(this.isActive=!1,this.onDeactivated())};l.prototype.onActivated=function(){};l.prototype.onDeactivated=function(){};return l}();f.ToolBase=k});define("infrastructure/tools/MapToolConfig",["require","exports"],function(h,f){});
define("infrastructure/eventArgs/ToolInputMethodChangedEvent",["require","exports"],function(h,f){});
define("infrastructure/tools/MapTool",["require","exports","infrastructure/tools/ToolBase","infrastructure/accessibility/Draw"],function(h,f,k,l){h=function(e){function c(a,b){var d=e.call(this,a,b)||this;d._drawIsActive=!1;d._drawEndHandlerToken=null;d._inputMethodChangeHandle=null;d._mapMouseHoverToken=null;d._mapMouseDownToken=null;d._autoPanPixelTolerance=15;d._autoPanStep=1/3;d._unsupportedAutoPanDrawModes=["FREEHAND_POLYGON","FREEHAND_POLYLINE","POINT","MULTI_POINT"];d._drawEndSuspended=!1;
return d}__extends(c,e);c.prototype._createDrawObject=function(){this._drawObject=this.app.accessibilityManager.createComponent("geocortex.accessibility.draw",this.app.map);this._drawObject.setMarkerSymbol(new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,10,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new esri.Color([0,0,0,0.8]),2),new esri.Color([0,0,0,0.8])));this._drawObject.setFillSymbol(new esri.symbol.SimpleFillSymbol(esri.symbol.SimpleFillSymbol.STYLE_SOLID,
new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new esri.Color([0,0,0,0.8]),2),new esri.Color([0,0,0,0.25])));this._drawObject.setLineSymbol(new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new esri.Color([0,0,0,0.8]),2))};c.prototype._activateToolbar=function(){this._drawObject||this._createDrawObject();this._drawEndHandlerToken||(this._drawEndHandlerToken=dojo.aspect.after(this._drawObject,"onDrawEnd",dojo.hitch(this,"onDrawEnd"),!0));this._drawObject instanceof
l.Draw&&(this._inputMethodChangeHandle=dojo.aspect.after(this._drawObject,"onInputMethodChange",dojo.hitch(this,"onInputMethodChange"),!0));this._drawObject.activate(esri.toolbars.Draw[this.drawMode]);this._drawIsActive=!0;this._drawEndSuspended=!1};c.prototype._deactivateToolbar=function(){this._drawEndHandlerToken&&(this._drawEndHandlerToken.remove(),this._drawEndHandlerToken=null);this._inputMethodChangeHandle&&(this._inputMethodChangeHandle.remove(),this._inputMethodChangeHandle=null);this._drawObject&&
this._drawIsActive&&(this._drawObject.deactivate(),this._drawEndSuspended=this._drawIsActive=!1)};c.prototype.onActivated=function(){this._drawObject||this._createDrawObject();this._drawIsActive&&this._deactivateToolbar();if("CURRENT_EXTENT"==this.drawMode)this.onDrawEnd(this.app.map.extent);else{if(!this.app.map.graphics)return;this.app.command("ShowMap").execute();this._activateToolbar()}this._mapMouseDownToken=this.app.event("MapMouseDownEvent").subscribe(this,this.onMapMouseDown);this._mapMouseHoverToken=
this.app.event("MapMouseHoverEvent").subscribe(this,this.onMapMouseHover)};c.prototype.onDeactivated=function(){this._mapMouseHoverToken&&(this.app.event("MapMouseHoverEvent").unsubscribe(this._mapMouseHoverToken),this._mapMouseHoverToken=null);this._mapMouseDownToken&&(this.app.event("MapMouseDownEvent").unsubscribe(this._mapMouseDownToken),this._mapMouseDownToken=null);this._deactivateToolbar();this.app.command("ShowMap").execute()};c.prototype.onDrawEnd=function(a){var b=this;if(!this._drawEndSuspended){if(this.command){var d=
this.app.command(this.command);d.canExecute(a)?(d.execute(a),this.app.command("LogOptimizerEvent").execute(this.name,this.command)):this.app.trace.warning("Could not invoke command '{0}' for tool '{1}'.".format(this.command,this.name))}this.isSticky?(this._drawEndSuspended=!0,setTimeout(function(){return b._drawEndSuspended=!1},100)):this.setActive(!1)}};c.prototype.onInputMethodChange=function(a){a={tool:this,previousMethod:a?a.previousMethod:null,newMethod:a?a.newMethod:null};this.app.event("ToolInputMethodChangedEvent").publish(a)};
c.prototype.onMapMouseDown=function(a){3===a.which&&this._drawObject&&(this.app.command("ClearActiveTool").execute(),this._deactivateToolbar(),this.app.command("RemoveStatus").execute())};c.prototype.onMapMouseHover=function(a){if(null!=this._drawObject&&this._drawIsActive&&!(0<=this._unsupportedAutoPanDrawModes.indexOf(this.drawMode))&&a.hasOwnProperty("clientX")&&a.hasOwnProperty("clientY")){var b=$(this.app.map.root).offset();a.clientX<b.left+this._autoPanPixelTolerance?this.app.command("PanLeft").execute(this._autoPanStep):
b.left+this.app.map.width-this._autoPanPixelTolerance<a.clientX?this.app.command("PanRight").execute(this._autoPanStep):a.clientY<b.top+this._autoPanPixelTolerance?this.app.command("PanUp").execute(this._autoPanStep):b.top+this.app.map.height-this._autoPanPixelTolerance<a.clientY&&this.app.command("PanDown").execute(this._autoPanStep)}};return c}(k.ToolBase);f.MapTool=h;h.prototype.command=null;h.prototype.drawMode=null;h.prototype.isSticky=!1});
define("infrastructure/tools/DrawMode",["require","exports"],function(h,f){var k=function(){return function(){}}();k.POINT="POINT";k.MULTI_POINT="MULTI_POINT";k.LINE="LINE";k.POLYGON="POLYGON";k.FREEHAND_POLYGON="FREEHAND_POLYGON";k.POLYLINE="POLYLINE";k.FREEHAND_POLYLINE="FREEHAND_POLYLINE";k.RECTANGLE="RECTANGLE";k.TRIANGLE="TRIANGLE";k.CIRCLE="CIRCLE";k.ELLIPSE="ELLIPSE";k.ARROW="ARROW";k.LEFT_ARROW="LEFT_ARROW";k.RIGHT_ARROW="RIGHT_ARROW";k.UP_ARROW="UP_ARROW";k.DOWN_ARROW="DOWN_ARROW";k.EXTENT=
"EXTENT";f.DrawMode=k});define("infrastructure/eventArgs/GraphicEditDeactivatedEventArgs",["require","exports"],function(h,f){});define("infrastructure/commandArgs/ImageProperties",["require","exports"],function(h,f){});define("infrastructure/commandArgs/DisplayNotificationArgs",["require","exports"],function(h,f){});
define("infrastructure/accessibility/MultipointVertexEditor",["require","exports","infrastructure/accessibility/VertexEditor"],function(h,f,k){h=function(l){function e(){return null!==l&&l.apply(this,arguments)||this}__extends(e,l);e.prototype._getSegments=function(c){for(var a=0,b=[];a<c.points.length;a++)b.push(c.getPoint(a));return[b]};e.prototype._getMidpointSegments=function(c){return[]};e.prototype._insertGraphicVertex=function(c,a,b){};e.prototype._updateGraphicVertex=function(c,a,b){a=this.graphic.geometry;
a.setPoint(b,c.offset(0,0));this.graphic.setGeometry(a)};e.prototype._deleteGraphicVertex=function(c,a){var b=this.graphic.geometry;b.removePoint(a);this.graphic.setGeometry(b)};return e}(k.VertexEditor);f.MultipointVertexEditor=h});
define("infrastructure/accessibility/PolylineVertexEditor",["require","exports","infrastructure/accessibility/VertexEditor","infrastructure/GeometryUtils"],function(h,f,k,l){h=function(e){function c(){return null!==e&&e.apply(this,arguments)||this}__extends(c,e);c.prototype._getSegments=function(a){for(var b=[],d=0;d<a.paths.length;d++){for(var g=a.paths[d].length,c=[],e=0;e<g;e++)c.push(a.getPoint(d,e));b.push(c)}return b};c.prototype._getMidpointSegments=function(a){for(var b=[],d=0;d<a.paths.length;d++){for(var g=
a.paths[d].length,c=[],e=0;e<g-1;e++){var n=a.getPoint(d,e),p=a.getPoint(d,e+1),n=l.getMidpoint(n,p);c.push(n)}b.push(c)}return b};c.prototype._insertGraphicVertex=function(a,b,d){var g=this.graphic.geometry;g.insertPoint(b,d,a.offset(0,0));this.graphic.setGeometry(g)};c.prototype._updateGraphicVertex=function(a,b,d){var g=this.graphic.geometry;g.setPoint(b,d,a.offset(0,0));this.graphic.setGeometry(g)};c.prototype._deleteGraphicVertex=function(a,b){var d=this.graphic.geometry;d.removePoint(a,b);this.graphic.setGeometry(d)};
return c}(k.VertexEditor);f.PolylineVertexEditor=h});
define("infrastructure/accessibility/PolygonVertexEditor",["require","exports","infrastructure/accessibility/VertexEditor","infrastructure/GeometryUtils"],function(h,f,k,l){h=function(e){function c(){return null!==e&&e.apply(this,arguments)||this}__extends(c,e);c.prototype._getSegments=function(a){for(var b=[],d=0;d<a.rings.length;d++){for(var g=a.rings[d].length,c=[],e=0;e<g-1;e++)c.push(a.getPoint(d,e));b.push(c)}return b};c.prototype._getMidpointSegments=function(a){for(var b=[],d=0;d<a.rings.length;d++){for(var g=
a.rings[d].length,c=[],e=0;e<g-1;e++){var n=a.getPoint(d,e),p=a.getPoint(d,e+1),n=l.getMidpoint(n,p);c.push(n)}b.push(c)}return b};c.prototype._insertGraphicVertex=function(a,b,d){var g=this.graphic.geometry;g.insertPoint(b,d,a.offset(0,0));this.graphic.setGeometry(g)};c.prototype._updateGraphicVertex=function(a,b,d){var g=this.graphic.geometry;g.setPoint(b,d,a.offset(0,0));0===d&&g.setPoint(b,g.rings[b].length-1,a.offset(0,0));this.graphic.setGeometry(g)};c.prototype._deleteGraphicVertex=function(a,
b){var d=this.graphic.geometry;d.removePoint(a,b);if(0===b){var g=d.rings[a],c=d.getPoint(a,0);d.setPoint(a,g.length-1,c.offset(0,0))}this.graphic.setGeometry(d)};return c}(k.VertexEditor);f.PolygonVertexEditor=h});
define("infrastructure/accessibility/VertexEditorFactory",["require","exports","infrastructure/accessibility/MultipointVertexEditor","infrastructure/accessibility/PolylineVertexEditor","infrastructure/accessibility/PolygonVertexEditor"],function(h,f,k,l,e){f.createVertexEditor=function(c,a,b,d){if(!c||!c.geometry)return null;switch(c.geometry.type){case "multipoint":return new k.MultipointVertexEditor(c,a,b,d);case "polyline":return new l.PolylineVertexEditor(c,a,b,d);case "polygon":return new e.PolygonVertexEditor(c,
a,b,d)}return null}});define("infrastructure/eventArgs/GeometryChangedEventArgs",["require","exports"],function(h,f){});define("infrastructure/ui/components/Table/TableColumnViewModelInterface",["require","exports"],function(h,f){var k=function(){return function(){}}();f.TableColumnViewModelInterface=k});define("infrastructure/ui/components/Table/TableRowViewModelInterface",["require","exports"],function(h,f){});
define("infrastructure/gis/DomainInfo",["require","exports"],function(h,f){var k=function(){function l(){}l.create=function(e){var c=new l;c.domain=e;return c};l.prototype.isCodedValueDomain=function(){return this.domain&&"codedValue"==this.domain.type};l.prototype.getCodedValueDomain=function(){return this.domain};l.prototype.getName=function(e){if(this.isCodedValueDomain())for(var c=0;c<this.getCodedValueDomain().codedValues.length;c++){var a=this.getCodedValueDomain().codedValues[c];if(a.code+
""==e+"")return a.name}return null};return l}();f.DomainInfo=k});
define("infrastructure/TimeZoneUtils",["require","exports","geocortex/framework/utils/ArrayUtils"],function(h,f,k){function l(c){if(!c)return null;var a=null,b=null,a=c.timeZoneId;c.essentialsMap&&c.essentialsMap.site&&(b=c.essentialsMap.site.timeZoneId);return k.firstOrDefault([a,b],function(a){return!!a})}function e(c,a){if(null===c||void 0===c)return null;if(!a)return c;var b=-moment.tz(c.getTime(),a).utcOffset();return moment(c).add(b,"minutes").toDate()}f.UTC_ZONE_ID="Etc/UTC";f.getTimeZoneFromLayer=
function(c){if(!c)return null;var a=null,b=null,a=c.timeZoneId;c.mapService&&(b=l(c.mapService));return k.firstOrDefault([a,b],function(a){return!!a})};f.getTimeZoneFromMapService=l;f.getDisplayTimeZoneFromMapService=function(c){return c?c.essentialsMap&&c.essentialsMap.site?c.essentialsMap.site.displayTimeZoneId:null:null};f.correctDatesForDisplayInDisplayTimeZone=function(c,a,b){if(null===c||void 0===c)return null;a||(a=f.UTC_ZONE_ID);if(!b)return e(c,a);var d=-c.getTimezoneOffset();b=moment.tz(c.getTime(),
b).utcOffset();d=-(d-b);c=e(c,a);return moment(c).add(d,"minutes").toDate()};f.correctDatesForDisplayInLocalTime=e;f.correctDatesToSubmitInDatabaseTime=function(c,a,b){if(null===c||void 0===c)return null;a||(a=f.UTC_ZONE_ID);a=moment.tz(c.getTime(),a).utcOffset();if(!b)return moment(c).add(a,"minutes").toDate();b=moment.tz(c.getTime(),b).utcOffset();b=a-b;a=-c.getTimezoneOffset();return moment(c).add(a+b,"minutes").toDate()};f.correctDatesToQueryInDatabaseTime=function(c,a,b){if(null===c||void 0===
c)return null;a||(a=f.UTC_ZONE_ID);a=moment.tz(c.getTime(),a).utcOffset();if(!b)return b=c.getTimezoneOffset(),moment(c).add(b+a,"minutes").toDate();b=moment.tz(c.getTime(),b).utcOffset();a-=b;return moment(c).add(a,"minutes").toDate()}});
define("infrastructure/NumberFormat",["require","exports"],function(h,f){var k=function(){return function(){}}();k.NUMBER="n";k.FIXED_POINT="f";k.CURRENCY="c";k.ACCOUNTING="a";k.PERCENT="p";k.ROUND_TRIP="r";k.DEFAULT=k.FIXED_POINT;f.NumberFormat=k;f.isNumeric=function(l){return!isNaN(parseFloat(l))&&isFinite(l)}});
define("infrastructure/FormatUtils",["require","exports","infrastructure/TimeZoneUtils","geocortex/framework/index","infrastructure/NumberFormat"],function(h,f,k,l,e){function c(b,d,c){void 0===d&&(d=q.DEFAULT);var m=null;if(!b||!b.getTime||isNaN(b.getTime()))return"";if(!moment)throw Error('Error: The "moment.js" library is required for formatting dates.');var e=a(b,c);c&&(b=moment(b.toISOString()),c.displayTimeZoneId&&(m=b.tz(c.displayTimeZoneId).format("Z")));return moment(e).format(g(d,m))}function a(a,
b){return b&&(b.timeZoneId||b.displayTimeZoneId)?b.displayTimeZoneId?b.timeZoneId?k.correctDatesForDisplayInDisplayTimeZone(a,b.timeZoneId,b.displayTimeZoneId):k.correctDatesForDisplayInDisplayTimeZone(a,k.UTC_ZONE_ID,b.displayTimeZoneId):k.correctDatesForDisplayInLocalTime(a,b.timeZoneId):a}function b(a,b,d){void 0===b&&(b=n.DEFAULT);void 0===d&&(d={});if(null===a||void 0===a||isNaN(a))return"";b=b||n.DEFAULT;d=d||{};if(b===n.ROUND_TRIP)return a.toString();if(!_globalize)throw Error('Error: The "globalize.js" library is required for formatting numbers.');
var g=b.toLowerCase();if(g===n.CURRENCY||g===n.ACCOUNTING)b=g+(void 0!==d.fractionalDigits?d.fractionalDigits:""),b+=d.currency?"$"+d.currency.toUpperCase():"";else if(g===n.NUMBER||g===n.FIXED_POINT||g===n.PERCENT)b=g+(void 0!==d.fractionalDigits?d.fractionalDigits:"");d=(_globalize.locale()?_globalize.locale().locale:"en")+"|"+b;g=s[d];g||(g=[],b=b.split(";",3),1===b.length?(g[0]=m(b[0]),g[1]=g[0],g[2]=g[0]):2===b.length?(g[0]=m(b[0]),g[1]=m(b[1]),g[2]=g[0]):3===b.length&&(g[0]=m(b[0]),g[1]=m(b[1]),
g[2]=m(b[2])),s[d]=g);return 0<a?g[0](a):0>a?g[1](a):g[2](a)}function d(a,b,d){if(a instanceof Date)return a;if("number"===typeof a)return new Date(a);if(!a||"string"!==typeof a)return p;if((void 0===d||null===d)&&e.isNumeric(a))return new Date(parseFloat(a));if(!moment)throw Error('Error: The "moment.js" library is required for parsing dates.');d=d||q.DEFAULT_PARSING_FORMATS;d=[].concat(d);d=d.map(function(a){a=g(a);return void 0===a?moment.ISO_8601:a});a=b?moment.utc(a,d):moment(a,d);return a.isValid()?
a.toDate():p}function g(a,b){a=a||q.DEFAULT;var d=a+(b?b:"");switch(a){case q.DATE_SHORT:return"L";case q.DATE_LONG:return"LL";case q.TIME_SHORT:return"LT";case q.TIME_LONG:return"LTS";case q.DATE_TIME_SHORT:return"lll";case q.DATE_TIME_LONG:return"LLL";case q.FULL:return"LLLL";case q.ISO_8601:break;default:var g=t[d];if(g)return g;for(var c=a.match(/%?([dfFghHKmMstyz])\1*|\\.|(["'])[^\2]+\2|[^dfFghHKmMstyz\\'"]+/g),g="",m=0;m<c.length;m++){var e=c[m];e.startsWith("%")&&(e=e.slice(1));switch(e[0]){case "y":g=
2>=e.length?g+"YY":4>=e.length?g+"YYYY":g+"YYYYY";break;case "d":g=2>=e.length?g+e.slice(0,2).toUpperCase():g+e.slice(0,4);break;case "f":case "F":g+=e.slice(0,3).replace(/[Ff]/g,"S");break;case "t":g+="A";break;case "z":g+=b?"["+b+"]":"Z";break;case "M":g+=e.slice(0,4);break;case "h":case "H":case "m":case "s":g+=e.slice(0,2);break;case "g":case "K":console.warn('The "{0}" date format specifier is not supported.'.format(e));break;default:e.startsWith('"')||e.startsWith("'")?e=e.slice(1,-1):e.startsWith("\\")&&
(e=e.slice(1)),g+="["+e+"]"}}return t[d]=g}}function m(a,b){var d=b||{},g=a.match(/^([acfnp])(\d*)(?:\$([a-zA-Z]{3}))?$/i);if(g){var c=g[1].toLowerCase(),m=Math.min(20,parseInt(g[2])),g=g[3];c===n.CURRENCY||c===n.ACCOUNTING?g||(g=(g=l.applications[0])&&g.configuration&&g.configuration.defaultCurrency?g.configuration.defaultCurrency:"USD"):(g="",void 0===d.minimumFractionDigits&&(d.minimumFractionDigits=0),void 0===d.maximumFractionDigits&&(d.maximumFractionDigits=Math.max(4,d.minimumFractionDigits)));
c===n.PERCENT?d.style="percent":c===n.ACCOUNTING?d.style="accounting":c===n.FIXED_POINT&&(d.useGrouping=!1);isNaN(m)||(d.minimumFractionDigits=m,d.maximumFractionDigits=m);return g?_globalize.currencyFormatter(g,d):_globalize.numberFormatter(d)}var g=a.match(/[0#]+|\.|,|%|\\.|(["'])[^\1]+\1|[^0#.,\\'"]+/g),e=!1,q=m=c="",p="";d.minimumFractionDigits=0;d.maximumFractionDigits=0;d.useGrouping=!1;for(var s=0;s<g.length;s++){var r=g[s];switch(r[0]){case ".":e=!0;break;case ",":d.useGrouping=!0;break;case "%":d.style=
"percent";break;case "0":case "#":e?m+=r:c+=r;break;default:r.startsWith('"')||r.startsWith("'")?r=r.slice(1,-1):r.startsWith("\\")&&(r=r.slice(1)),c||m?p+=r:q+=r}}c&&(g=c.indexOf("0"),0<=g&&(d.minimumIntegerDigits=c.length-g));m&&(g=m.lastIndexOf("0"),d.minimumFractionDigits=0<=g?g+1:0,d.maximumFractionDigits=Math.min(20,m.length));if(c||m){var f=_globalize.numberFormatter(d);return function(a){return void 0!==d.minimumIntegerDigits&&0>a?q+"-"+f(-1*a)+p:q+f(a)+p}}return function(a){return q+p}}var q=
function(){return function(){}}();q.DATE_SHORT="d";q.DATE_LONG="D";q.TIME_SHORT="t";q.TIME_LONG="T";q.DATE_TIME_SHORT="g";q.DATE_TIME_LONG="G";q.FULL="f";q.ISO_8601="u";q.ROUND_TRIP="u";q.DEFAULT="g";q.DEFAULT_PARSING_FORMATS=[q.ISO_8601,q.DATE_TIME_SHORT,q.DATE_TIME_LONG,q.DATE_SHORT,q.DATE_LONG];f.DateFormat=q;var n=function(){return function(){}}();n.NUMBER="n";n.FIXED_POINT="f";n.CURRENCY="c";n.ACCOUNTING="a";n.PERCENT="p";n.ROUND_TRIP="r";n.DEFAULT=n.FIXED_POINT;f.NumberFormat=n;var p=new Date(NaN);
f.format=function(a){return a instanceof Date?c(a):"number"===typeof a?b(a):null===a||void 0===a?"":a.toString()};f.formatDate=c;f.formatDateFromNow=function(b,d){if(!b||!b.getTime||isNaN(b.getTime()))return"";if(!moment)throw Error('Error: The "moment.js" library is required for formatting dates.');var g=a(b,d);return moment(g).fromNow()};f.formatNumber=b;f.parseDate=function(a,b){return d(a,!1,b)};f.parseUtcDate=function(a,b){return d(a,!0,b)};f.parseNumber=function(a,b){if("number"===typeof a)return a;
if("boolean"===typeof a)return a?1:0;if(null===a||void 0===a)return NaN;if(!_globalize)throw Error('Error: The "globalize.js" library is required for parsing numbers.');a=a.toString().trim();a=a.replace(" ","\u00a0");var d=_globalize.locale()?_globalize.locale().locale:"en",g=r[d];g||(g=_globalize.numberParser(),r[d]=g);d=1;a&&"("===a[0]&&")"===a[a.length-1]&&(d=-1,a=a.slice(1,-1));var c=g(a);isNaN(c)&&(c=parseFloat(a));if(isNaN(c))return c;var c=c*d,g=[].concat(b||[]),e=/^([acfnp])(?:\$([a-zA-Z]{3}))?$/i;
return!g.length||g.some(function(b){var d=m(b,{minimumFractionDigits:0,maximumFractionDigits:20});if(a===d(c))return!0;if(b.match(e))for(var g=0;20>=g;g++)if(d=m(b,{minimumFractionDigits:g,maximumFractionDigits:g}),a===d(c))return!0;return!1})?c:NaN};var s={},r={},t={}});
define("infrastructure/gis/FieldInfo","require exports infrastructure/gis/DomainInfo geocortex/essentials/Field infrastructure/TimeZoneUtils infrastructure/FormatUtils".split(" "),function(h,f,k,l,e,c){h=function(){function a(){this.subtypeDomains={};this.subtypeDomainInfos={};this.isVisible=!0}a.fromEsriField=function(b,d,g){var c=new a;c.name=b.name;c.type=b.type;c.alias=g?g.displayName||b.alias:b.alias;c.isVisible=g?g.visible:!0;c.searchable=g?g.searchable:!0;c.editable=b.editable;c.nullable=b.nullable;
c.length=b.length;c.esriField=b;c.isTypeField=d&&d.typeIdField===b.name;if(d){if(c.isTypeField&&!b.domain){var q=new esri.layers.CodedValueDomain;q.codedValues=[];q.type="codedValue";d.types.forEach(function(a){q.codedValues.push({name:a.name,code:a.id})});c.domainInfo=k.DomainInfo.create(q);c.domain=q}else c.domainInfo=k.DomainInfo.create(b.domain),c.domain=b.domain;d.types&&d.types.forEach(function(a){for(var d in a.domains)if(a.domains.hasOwnProperty(d)&&d===b.name&&null!==a.id){d=a.domains[d];
c.subtypeDomains[a.id.toString()]=d;c.subtypeDomainInfos[a.id.toString()]=k.DomainInfo.create(d);break}})}if(g){c.format=g.format;if(!c.format)if(c._isNumericFormat()){if(d=[g.layer.defaultNumberFormat,g.layer.mapService.defaultNumberFormat].filter(function(a){return!!a})[0])c.format="{0:"+d+"}"}else c.isDate()&&(d=[g.layer.defaultDateFormat,g.layer.mapService.defaultDateFormat].filter(function(a){return!!a})[0])&&(c.format="{0:"+d+"}");c.timeZoneId||(c.timeZoneId=e.getTimeZoneFromLayer(g.layer));
c.displayTimeZoneId||(c.displayTimeZoneId=e.getDisplayTimeZoneFromMapService(g.layer.mapService))}return c};a.fromGcxField=function(b){var d=new esri.layers.Field;new a;d.name=b.name;d.type=l.Field.convertToEsriFieldType(b.dataType);d.alias=b.displayName;d.editable=!1;d.nullable=!0;return a.fromEsriField(d,null,b)};a.prototype.isNumeric=function(){return 0<=dojo.indexOf([l.EsriFieldTypes.esriFieldTypeOID,l.EsriFieldTypes.esriFieldTypeSmallInteger,l.EsriFieldTypes.esriFieldTypeInteger,l.EsriFieldTypes.esriFieldTypeSingle,
l.EsriFieldTypes.esriFieldTypeDouble],this.type)?!0:!1};a.prototype.isDate=function(){return 0<=dojo.indexOf([l.EsriFieldTypes.esriFieldTypeDate],this.type)?!0:!1};a.prototype.isText=function(){return 0<=dojo.indexOf([l.EsriFieldTypes.esriFieldTypeString],this.type)?!0:!1};a.prototype.isCodedValueDomain=function(){return this.domainInfo&&this.domainInfo.isCodedValueDomain()};a.prototype.hasSubtypeCodedValueDomains=function(){for(var a in this.subtypeDomainInfos)if(this.subtypeDomainInfos.hasOwnProperty(a)&&
this.subtypeDomainInfos[a].isCodedValueDomain())return!0;return!1};a.prototype.getCodedValueDomain=function(){return this.domain};a.prototype.getSubtypeCodedValueDomains=function(){var a={},d;for(d in this.subtypeDomainInfos)this.subtypeDomainInfos.hasOwnProperty(d)&&this.subtypeDomainInfos[d].isCodedValueDomain()&&(a[d]=this.subtypeDomainInfos[d].domain);return a};a.prototype.resolveCodedDomainValue=function(a,d){var g=null;this.domainInfo&&(g=this.domainInfo.getName(a));if(null==g){var c=this.subtypeDomainInfos[d];
c&&(g=c.getName(a))}return g};a.prototype.formatValue=function(a,d){var g=this;if(this.isCodedValueDomain()||this.hasSubtypeCodedValueDomains()){var m=this.resolveCodedDomainValue(a,d);if(null!=m)return m}return this.format?this.format.replace(/\{0(?::([^}]*))?\}/,function(d,m){if(g.isDate()){var e={timeZoneId:g.timeZoneId,displayTimeZoneId:g.displayTimeZoneId};return c.formatDate(c.parseDate(a),m,e)}return g._isNumericFormat()?c.formatNumber(c.parseNumber(a),m):null===a||void 0===a?a:a.toString()}):
this.isDate()?(m={timeZoneId:this.timeZoneId,displayTimeZoneId:this.displayTimeZoneId},c.formatDate(c.parseDate(a),null,m)):this._isNumericFormat()?c.formatNumber(c.parseNumber(a)):null===a||void 0===a?a:a.toString()};a.prototype._isNumericFormat=function(){return this.isNumeric()&&this.type!==l.EsriFieldTypes.esriFieldTypeOID&&(!this.name||"OBJECTID"!==this.name.toUpperCase())};return a}();f.FieldInfo=h});
define("infrastructure/DateFormat",["require","exports"],function(h,f){var k=function(){return function(){}}();k.DATE_SHORT="d";k.DATE_LONG="D";k.TIME_SHORT="t";k.TIME_LONG="T";k.DATE_TIME_SHORT="g";k.DATE_TIME_LONG="G";k.FULL="f";k.ISO_8601="u";k.ROUND_TRIP="u";k.DEFAULT="g";k.DEFAULT_PARSING_FORMATS=[k.ISO_8601,k.DATE_TIME_SHORT,k.DATE_TIME_LONG,k.DATE_SHORT,k.DATE_LONG];f.DateFormat=k});
define("infrastructure/PresentableDelegateFactory","require exports geocortex/essentials/Field infrastructure/gis/FieldInfo infrastructure/DateFormat infrastructure/FormatUtils infrastructure/NumberFormat geocortex/framework/utils/utils".split(" "),function(h,f,k,l,e,c,a,b){h=function(){function d(){}d.typeIdForLayerAndAttributes=function(a,b){return a.typeIdField?b[a.typeIdField]:null};d.typeFromLayerAndId=function(a,b){for(var d=0;d<a.types.length;d++)if(a.types[d].id==b)return a.types[d];return null};
d.makeValueTruthy=function(a){return 0===a?"0":!1===a?"false":a};d.valuePresenterDelegate=function(g,m){var q,n;"string"===typeof g?(n=g,m&&m.layer&&(q=m.layer.fields.filter(function(a){return a.name===n})[0])):g instanceof k.Field?(q=g,n=q.name):g&&g.name&&(n=g.name);return function(p){return function(){var s=m?m.featureLayer:null,r=m?m.getType():null,f=s?s.getField(n):null,k;g instanceof l.FieldInfo&&(k=g);if(!f&&!q&&!k)return p instanceof Date?c.formatDate(p,m?m.defaultDateFormat:e.DateFormat.DEFAULT):
"number"===typeof p?c.formatNumber(p,m?m.defaultNumberFormat:a.NumberFormat.DEFAULT):d.makeValueTruthy(p);q&&q.hyperlinkLabel&&b.isUrl(p)&&(p=q.hyperlinkLabel);if(m){var h=m.esriFeature.get();if(h&&h.attributes.hasOwnProperty(n+".Name()"))return d.makeValueTruthy(h.attributes[n+".Name()"])}k||(k=f?l.FieldInfo.fromEsriField(f,s,q):l.FieldInfo.fromGcxField(q));k.isDate()&&!k.format&&m&&m.defaultDateFormat?k.format="{0:"+m.defaultDateFormat+"}":k.isNumeric()&&!k.format&&m&&m.defaultNumberFormat&&(k.format=
"{0:"+m.defaultNumberFormat+"}");return k.formatValue(p,r?r.id.toString():null)}}};return d}();f.PresentableDelegateFactory=h});
define("infrastructure/FeatureAttribute","require exports geocortex/framework/observables geocortex/framework-ui/LazyObservable infrastructure/PresentableDelegateFactory geocortex/framework/utils/utils".split(" "),function(h,f,k,l,e,c){h=function(){function a(a,d,g,m,q,n,p){this.value=new k.Observable("undefined"===typeof a?"":a);this.name=new k.Observable("undefined"===typeof d?"":d);this.alias=new k.Observable("undefined"===typeof g?this.name.get():g);this.displayName=new k.Observable("undefined"===
typeof m?this.alias.get()?this.alias.get():this.name.get():m);this.visible=new k.Observable("undefined"===typeof q?!0:q);this.type=new k.Observable("undefined"===typeof p?"":p);n=n||e.PresentableDelegateFactory.valuePresenterDelegate(null,null);this.presentableValue=new l.LazyObservable(null,n(a),!0);this.displayAsUrl=c.isUrl(a)}a.ignoreAttribute=function(b){return b&&a.ignoreAttributeMatcher.test(b)};return a}();h.ignoreAttributeMatcher=/.*\.Name\(\)$/;f.FeatureAttribute=h});
define("infrastructure/Dictionary",["require","exports"],function(h,f){var k=function(){function l(){this._backingStore={}}l.prototype.containsKey=function(e){return this._backingStore.hasOwnProperty(e)};l.prototype.get=function(e){return this._backingStore[e]};l.prototype.set=function(e,c){this._backingStore[e]=c};l.prototype.remove=function(e){return this.containsKey(e)?(delete this._backingStore[e],!0):!1};l.prototype.clear=function(){this._backingStore={}};l.prototype.values=function(){var e=
[],c;for(c in this._backingStore)this._backingStore.hasOwnProperty(c)&&e.push(this._backingStore[c]);return e};l.prototype.keys=function(){var e=[],c;for(c in this._backingStore)this._backingStore.hasOwnProperty(c)&&e.push(c+"");return e};return l}();f.Dictionary=k;f.toDictionary=function(l,e,c){for(var a=new k,b=0;b<l.length;b++){var d=l[b];a.set(e(d),c(d))}return a}});
define("infrastructure/TaskUtils","require exports geocortex/essentials/Layer geocortex/essentials/MapServiceConstants geocortex/essentials/FeatureLayerService geocortex/essentials/RestHelperHTTPService geocortex/essentials/Field infrastructure/NumberFormat infrastructure/FormatUtils".split(" "),function(h,f,k,l,e,c,a,b,d){function g(a,d){var b=null,g=null,c;a instanceof k.Layer?(b=a,c=b.mapService,d&&(g=d.serviceLayer)):a instanceof esri.layers.Layer&&(g=a,d&&(c=d));if(g instanceof esri.layers.FeatureLayer&&
"table"===g.type||g instanceof esri.layers.FeatureLayer&&!c)return g.url;if(!r(c))return null;c=null;if(g instanceof esri.layers.WMSLayer||g instanceof esri.layers.WFSLayer){if(!b)return null;c=b.url}else b?c=b.mapService.serviceLayer.url:g&&(c=g.url);var m,e=null;if(b)if(b.isDynamic){m="dynamicLayer";var e=null,q=b.mapService.getDynamicLayerInfoById(b.id);if(q&&q.source&&(q.source instanceof esri.layers.LayerDataSource||q.source instanceof esri.layers.LayerMapSource)){if(e=new t,e.source=q.source.toJson(),
q.id&&(e.id=q.id),b=b.getDefinitionExpression(b.mapService.serviceLayer))e.definitionExpression=b}else throw Error("A dynamic layer must have a DataSource!");}else m=b.id;else g&&(m=g.id);g instanceof esri.layers.FeatureLayer||c.match(/\/\d+(\?.*)?$/)||(g=c.indexOf("?"),b=c.indexOf("#"),c=-1!=g?c.substring(0,g)+"/"+m+c.substring(g):-1!=b?c.substring(0,b)+"/"+m+c.substring(b):c+("/"+m));c=n(c,d);e&&(c+=-1<c.indexOf("?")?"&layer=":"?layer=",c+=encodeURIComponent(JSON.stringify(e)));return c}function m(a){var b=
null;a instanceof esri.layers.ArcGISDynamicMapServiceLayer?a.gdbVersion&&(b=a.gdbVersion):a instanceof esri.layers.FeatureLayer&&a.gdbVersion&&(b=a.gdbVersion);return b}function q(a){if(!a||!a.serviceUrl)return null;if(a.mapServiceType===l.MapServiceType.WMS||a.mapServiceType===l.MapServiceType.WFS){for(var b=0;b<a.layers.length;b++)if(p(a.layers[b]))return n(a.url,a);return null}return r(a)?a instanceof e.FeatureLayerService?a.serviceUrl.substring(0,a.serviceUrl.lastIndexOf("/")).replace(/FeatureServer$/i,
"MapServer"):a.mapServiceType==l.MapServiceType.DYNAMIC||a.mapServiceType==l.MapServiceType.TILED?n(a.serviceUrl,a):null:null}function n(a,b){if(!a)return null;if(!b)return a;if(b.mapServiceType===l.MapServiceType.WMS||b.mapServiceType===l.MapServiceType.WFS){var d=c.RestHelperHTTPService.getTokenForScope(b.url);d&&(a=c.RestHelperHTTPService.appendTokenToUrl(a,d))}else b.serviceToken&&!/.*token=.*/.test(a)&&(a=c.RestHelperHTTPService.appendTokenToUrl(a,b.serviceToken));return a}function p(a){return a&&
a.identifiable&&a.supportsIdentify?!0:!1}function s(a){return a&&a.queryable&&a.supportsQuery?!0:!1}function r(a){if(!a||!a.serviceLayer)return!1;if(a.mapServiceType===l.MapServiceType.WMS||a.mapServiceType===l.MapServiceType.WFS){for(var b=0;b<a.layers.length;b++)if(s(a.layers[b]))return!0;return!1}a=a.serviceLayer;return a.capabilities?10>a.version?!0:a.capabilities&&0<=a.capabilities.indexOf("Query"):!1}var t=function(){return function(){}}(),u=function(){return function(a){this.searchText=a?(a+
"").trim():"";this.searchTextLower=this.searchText.toLowerCase();this.searchTextQuotesFixed=this.searchText.replace("'","''");this.searchTextLowerQuotesFixed=this.searchTextLower.replace("'","''");this.searchNum=d.parseNumber(this.searchText,[b.NumberFormat.ACCOUNTING,b.NumberFormat.CURRENCY,b.NumberFormat.FIXED_POINT,b.NumberFormat.NUMBER,b.NumberFormat.PERCENT,b.NumberFormat.ROUND_TRIP]);if(!isNaN(this.searchNum)){a=d.formatNumber(this.searchNum,b.NumberFormat.ROUND_TRIP);var g;a.indexOf(".")?(g=
a.length-a.indexOf(".")-1,g=Math.pow(10,-g)):g=1;0>this.searchNum?(this.searchLowerBound=d.formatNumber(this.searchNum-g,b.NumberFormat.ROUND_TRIP),this.searchUpperBound=a):(this.searchLowerBound=a,this.searchUpperBound=d.formatNumber(this.searchNum+g,b.NumberFormat.ROUND_TRIP))}}}();f.getQueryTaskUrl=g;f.getQueryTask=function(a,b){var d=null,c=null,e=null,q=null;if(a instanceof esri.layers.Layer)c=a,b&&(e=b);else if(a instanceof k.Layer&&a.mapService&&a.mapService.serviceLayer)c=a.mapService.serviceLayer,
e=a.mapService,q=a;else throw Error("Cannot generate a QueryTask from the given parameters.");if(c){var n=m(c);n&&(d={gdbVersion:n})}return new esri.tasks.QueryTask(g(q?q:c,e),d)};f.getIdentifyTaskUrl=q;f.getIdentifyTask=function(a){var b=null;if(a.serviceLayer){var d=m(a.serviceLayer);d&&(b={gdbVersion:d})}return new esri.tasks.IdentifyTask(q(a),b)};f.getTokenizedUrl=n;f.canIdentifyLayer=p;f.canQueryLayer=s;f.canQueryMapService=r;f.getSearchTextWhereClause=function(b,d,g,c){var m=new u(g);if(!b||
!d||0==d.length||!m.searchText)return"";var e="";for(g=0;g<d.length;g++){var q=d[g];if(q.searchable&&"gml:id"!==q.name)if(q.isCodedValueDomain()||q.hasSubtypeCodedValueDomains()){var n=[],p=q.getCodedValueDomain();p&&p.codedValues.forEach(function(a){return n.push(a)});var p=q.getSubtypeCodedValueDomains(),r;for(r in p)p.hasOwnProperty(r)&&p[r].codedValues.forEach(function(a){return n.push(a)});n.forEach(function(b){-1<b.name.toLowerCase().indexOf(m.searchTextLower)&&(0<e.length&&(e+=" OR "),e=q.type===
a.EsriFieldTypes.esriFieldTypeString?e+(encodeURI(q.name)+" = '"+b.code.replace("'","''")+"'"):e+(encodeURI(q.name)+" = "+b.code))})}else switch(q.type){case a.EsriFieldTypes.esriFieldTypeString:0<e.length&&(e+=" OR ");e=b.mapService.serviceLayer instanceof esri.layers.WMSLayer||b.mapService.serviceLayer instanceof esri.layers.WFSLayer?e+(encodeURI(q.name)+" LIKE '%"+m.searchTextQuotesFixed+"%'"):e+("LOWER("+q.name+") LIKE '%"+m.searchTextLowerQuotesFixed+"%'");break;case a.EsriFieldTypes.esriFieldTypeSmallInteger:case a.EsriFieldTypes.esriFieldTypeInteger:case a.EsriFieldTypes.esriFieldTypeOID:case a.EsriFieldTypes.esriFieldTypeSingle:case a.EsriFieldTypes.esriFieldTypeDouble:if(isNaN(m.searchNum))break;
0<e.length&&(e+=" OR ");e+="("+encodeURI(q.name.toLowerCase())+" <= "+m.searchUpperBound+" AND "+encodeURI(q.name.toLowerCase())+" >= "+m.searchLowerBound+")";break;case a.EsriFieldTypes.esriFieldTypeDate:break;case a.EsriFieldTypes.esriFieldTypeGlobalID:case a.EsriFieldTypes.esriFieldTypeBlob:break;default:c&&c.warning("Unhandled layer data type: '{0}'. Field '{1}' in layer '{2}' has been excluded from search.".format(q.type,q.alias,b.displayName))}}(b=b.getDefinitionExpression(b.mapService.serviceLayer))&&
(e="("+e+") AND ("+b+")");return e}});define("infrastructure/commandArgs/ProjectArgs",["require","exports"],function(h,f){var k=function(){return function(l,e,c,a,b){this.geometries=l;this.outputSpatialReference=a;this.callback=e;this.errback=c;this.transformation=b}}();f.ProjectArgs=k});
define("infrastructure/MapUtils","require exports geocortex/essentials/GeometryUtilities infrastructure/commandArgs/ProjectArgs geocortex/framework/utils/ArrayUtils geocortex/essentials/ReportParameters geocortex/framework/utils/utils".split(" "),function(h,f,k,l,e,c,a){function b(b,d,g){if(a.isNullOrUndefined(b)||a.isNullOrUndefined(d))return!1;if(b===d)return!0;var c=Object.keys(b),m=Object.keys(d);if(!c.length||!m.length)return!1;c=e.difference(c,g);m=e.difference(m,g);if(c.length!==m.length)return!1;
for(g=0;g<c.length;g++)if(m=c[g],b[m]!==d[m])return!1;return!0}function d(a,b){return a===b||a.type===b.type&&a.spatialReference&&b.spatialReference&&a.spatialReference.equals(b.spatialReference)}function g(a,b){return a===b||a.x==b.x&&a.y==b.y&&d(a,b)}function m(a,b){var g=d(a,b);if(g&&a.points.length===b.points.length){for(var c=0;g&&c<a.points.length;c++)g=a.points[c][0]===b.points[c][0]&&a.points[c][1]===b.points[c][1];return g}return!1}function q(a,b){var g=d(a,b);g&&dojo.forEach(a.paths,function(a,
d){if(a.length===b.paths[d].length){for(var c=0;g&&c<a.length;c++)g=a[c][0]===b.paths[d][c][0]&&a[c][1]===b.paths[d][c][1];if(!g)return g}else g=!1});return g}function n(a,b){var g=d(a,b);g&&dojo.forEach(a.rings,function(a,d){if(a.length===b.rings[d].length){for(var c=0;g&&c<a.length;c++)g=a[c][0]===b.rings[d][c][0]&&a[c][1]===b.rings[d][c][1];if(!g)return g}else g=!1});return g}function p(a,b){return d(a,b)&&a.xmin==b.xmin&&a.xmax==b.xmax&&a.ymin==b.ymin&&a.ymax==b.ymax}f.stepZoom=function(a,b,d){null==
d&&(d=a.extent);b=k.scaleEnvelopeWithoutTranslation(d,1/b);a.setExtent(b,!!a._fitTiledMapsToExtent);return b};f.stepZoomWithPriority=function(a,b,d,g){null==d&&(d=a.getMap().extent);var c=a.essentialsMap.getMap();d=k.scaleEnvelopeWithoutTranslation(d,1/b);var m=c.getLevel();if(void 0!==m&&null!==m&&-1<m)return a=m,1<b?a=m+1:1>b&&(a=m-1),c.setLevel(a),d;a.essentialsMap.extentManager.setExtentWithPriority(d,g);return d};f.getExtent=function(a){return a?"point"==a.type?new esri.geometry.Extent(a.x,a.y,
a.x,a.y,a.spatialReference):a.getExtent():null};f.panToPointWithPriority=function(a,b,d,g){function c(b){a.trace.warning("PanToPoint: "+b.message)}var m=function(b){var c=null,m=null;b&&0<b.length&&(c=b[0]);a.map&&c&&((g||void 0===g)&&a.command("ShowMap").execute(),"point"==c.type?a.site.essentialsMap.extentManager.centerAtWithPriority(c,d):"extent"==c.type?a.site.essentialsMap.extentManager.centerAtWithPriority(c.getCenter(),d):("polyline"==c.type||"polygon"==c.type||"multipoint"==c.type)&&(m=c.getExtent())&&
a.site.essentialsMap.extentManager.centerAtWithPriority(m.getCenter(),d))};b&&b.isInstanceOf(esri.geometry.Geometry)&&(b=new l.ProjectArgs([b],m,c),a.command("Project").execute(b))};f.zoomToExtent=function(a,b,d){this.zoomToExtentWithPriority(a,b,null,null,d)};f.zoomToExtentWithPriority=function(a,b,d,g){var c=function(b){b&&0<b.length&&((g||void 0===g)&&a.command("ShowMap").execute(),null==d?a.map.setExtent(b[0],!!a.map._fitTiledMapsToExtent):a.site.essentialsMap.extentManager.setExtentWithPriority(b[0],
d),a.event("MapStartupExtentChangedEvent").publish(b[0]))};b&&b.isInstanceOf(esri.geometry.Extent)&&(!b.spatialReference&&a.map.spatialReference?(b.spatialReference=a.map.spatialReference,c([b])):(b.spatialReference&&!b.spatialReference.toJson&&(b.spatialReference.wkid||b.spatialReference.wkt)&&(b.spatialReference=new esri.SpatialReference(b.spatialReference)),b=new l.ProjectArgs([b],c,function(b){a.trace.warning("ZoomToExtent: "+b.message)}),a.command("Project").execute(b)))};f.getClosestScale=function(a,
b,d){a=a.__tileInfo&&a.__tileInfo.lods;if(!a||!a.length)return d;for(var g=0,c=0;c<a.length;c++){if(a[c].scale===d)return d;if(b===s.LessThan){if(d<a[c].scale)continue}else if(a[c].scale>d){g=a[c].scale;continue}return b===s.LessThan?a[c].scale:g}};var s;(function(a){a[a.LessThan=0]="LessThan";a[a.GreaterThan=1]="GreaterThan"})(s=f.ScaleChangeMode||(f.ScaleChangeMode={}));f.cloneEsriFeature=function(a){var b=new esri.Graphic(a.toJson());b._graphicsLayer=a._graphicsLayer;return b};f.esriFeatureAttributesEqual=
b;f.esriFeaturesEqual=function(d,g){if(a.isNullOrUndefined(d)||a.isNullOrUndefined(g))return!1;if(d===g)return!0;var c=["timestamp","clusterId","clusterCount","extent"],m=d.getLayer();m&&m instanceof esri.layers.FeatureLayer||(m=g.getLayer());if(m instanceof esri.layers.FeatureLayer){var e=m.objectIdField;if(e&&d.attributes&&g.attributes&&d.attributes[e]===g.attributes[e])return!0;if(m.editFieldsInfo)for(var e=0,q=Object.keys(m.editFieldsInfo);e<q.length;e++)c.push(m.editFieldsInfo[q[e]])}return b(d.attributes,
g.attributes,c)};f.esriGeometriesEqual=function(a,b){switch(a?a.type:null){case "point":return g(a,b);case "multipoint":return m(a,b);case "polyline":return q(a,b);case "polygon":return n(a,b);case "extent":return p(a,b)}return!1};f.compareTypeSR=d;f.esriPointsEqual=g;f.esriMultipointsEqual=m;f.esriPolylinesEqual=q;f.esriPolygonsEqual=n;f.esriExtentsEqual=p;f.findFeatureInLayer=function(a,b){if(!a||!b)return null;var d=b.objectIdField,g=b.graphics;if(1>g.length)return null;var c=["timestamp","clusterId",
"clusterCount","extent"];if(b.editFieldsInfo)for(var m in b.editFieldsInfo)b.editFieldsInfo.hasOwnProperty(m)&&c.push(b.editFieldsInfo[m]);m=function(a){var b=0,d;for(d in a)!e.contains(c,d)&&a.hasOwnProperty(d)&&++b;return b};var q=g[0].attributes;if(m(q)!==m(a.attributes))return null;var n=0,p=[],s=[],l;for(l in q){var f=e.contains(c,l);if(!(f||q.hasOwnProperty(l)&&a.attributes.hasOwnProperty(l)))return null;f||(p.push(l),s.push(l),++n)}for(l=0;l<n;++l)if(p[l]!==s[l])return null;for(n=0;n<g.length;n++)if(p=
g[n],m(q)===m(a.attributes)&&p.attributes[d]===a.attributes[d])return p._graphicsLayer=b,p;return null};f.findFeatureInMap=function(a,b,d){var g=null;if(d&&(g=this.findFeatureInLayer(a,d)))return g._graphicsLayer=d,g;b=b.getFeatureServices();for(var c=0;c<b.length;c++){var m=b[c].serviceLayer;if(!d||m!==d)if(g=this.findFeatureInLayer(a,m))return g}!g&&a.getLayer&&a.getLayer()&&(g=a);return g};f.getThumbnailUri=function(a,b,d,g,m){void 0===d&&(d=150);void 0===g&&(g=150);void 0===m&&(m=20);var e=new c.ReportParameters;
e.outputFormat="PNG";e.includeData=!0;e.imageWidth=d;e.imageHeight=g;e.resolution={displayName:"custom",dpi:m};e.customExtent=b||a.map.extent;e.extentType=c.ReportParameters.CUSTOM_EXTENT;e.populateMapGraphicsLayers(a.map);return new Promise(function(b,d){a.site.essentialsMap.exportMap(e,function(a){a.data?b("data:image/png;base64,{0}".format(a.data)):a.href?b(a.href):b(null)},function(d){a.trace.error("Error exporting map for thumbnail: {0}".format(d.message));b(null)})})}});
define("infrastructure/KmlFeature",["require","exports","infrastructure/Feature"],function(h,f,k){f.isKmlProperty="__isKml";h=function(l){function e(c){c=l.call(this,c)||this;var a=c.esriFeature.get(),b=a?a.attributes||{}:{};c.labelFormat.set(b.hasOwnProperty("name")?"{name}":"{id}");c.descriptionFormat.set("{snippet}");c.longDescriptionFormat.set(b.hasOwnProperty("balloonStyleText")?"{balloonStyleText}":"{description}");a&&!a[f.isKmlProperty]&&(a[f.isKmlProperty]=!0);return c}__extends(e,l);return e}(k.Feature);
f.KmlFeature=h});define("infrastructure/AttributeGroup",["require","exports"],function(h,f){var k=function(){return function(){}}();f.AttributeGroup=k});
define("infrastructure/DataLinkingResult",["require","exports","infrastructure/AttributeGroup","geocortex/framework/observables"],function(h,f,k,l){h=function(){function e(){this.dataLink=new l.Observable;this.table=new l.Observable}e.prototype.toAttributes=function(){var c=this.table.get();if(!c)return null;for(var a={},b=0;b<c.columns.length;b++)a[c.columns[b]]=0<c.rows.length?c.rows[0].row[b]:null;return a};e.prototype.asAttributeGroup=function(){this._attributeGroup||(this._attributeGroup=new k.AttributeGroup,
this._attributeGroup.owner=this,this._attributeGroup.attributes=this.toAttributes());return this._attributeGroup};return e}();f.DataLinkingResult=h});
define("infrastructure/FeatureSet","require exports geocortex/framework-ui/LazyObservable geocortex/framework/observables infrastructure/Feature infrastructure/FeatureAttribute infrastructure/NumberFormat infrastructure/DateFormat infrastructure/Dictionary geocortex/framework/utils/utils geocortex/framework/events/CollectionChangedArgs geocortex/framework/utils/ArrayUtils geocortex/geocortex infrastructure/TaskUtils infrastructure/MapUtils infrastructure/KmlFeature infrastructure/PresentableDelegateFactory infrastructure/DataLinkingResult".split(" "),function(h,
f,k,l,e,c,a,b,d,g,m,q,n,p,s,r,t,u){var v;(function(a){a[a.Unresolved=0]="Unresolved";a[a.Resolving=1]="Resolving";a[a.Resolved=2]="Resolved"})(v=f.DataLinksState||(f.DataLinksState={}));h=function(){function f(c){var m=this;this.id="";this.featureLayer=null;this.displayName=new k.LazyObservable;this.features=new l.ObservableCollection;this.attributes=new l.ObservableCollection;this.iconUri=new k.LazyObservable;this.extendedProperties=new l.ObservableCollection;this.isSelectedInCollection=new l.Observable(!1);
this.dataLinksResolved=new l.Observable(!1);this.defaultNumberFormat=a.NumberFormat.DEFAULT;this.defaultDateFormat=b.DateFormat.DEFAULT;this._objectIds=new d.Dictionary;this._watchHandles={};this._dataLinksState=v.Unresolved;var e=null,q=null;c=c||{};c.hasOwnProperty("esriFeatureSet")&&(e=c.esriFeatureSet);c.hasOwnProperty("featureLayer")&&(this.featureLayer=c.featureLayer);c.hasOwnProperty("layer")&&(q=c.layer);c.hasOwnProperty("allowUnsafeContent")?this._allowUnsafeContent=c.allowUnsafeContent:
this._allowUnsafeContent=!1;c.hasOwnProperty("app")&&(this.app=c.app);this.defaultDateFormat=c.defaultDateFormat||b.DateFormat.DEFAULT;this.defaultNumberFormat=c.defaultNumberFormat||a.NumberFormat.DEFAULT;this.uniqueId="fs_"+g.alphaNumericToken();this.esriFeatureSet=e;q&&(this.layer=q);c.hasOwnProperty("id")&&!String.isNullOrEmpty(c.id)&&(this.id=c.id);String.isNullOrEmpty(this.id)&&this.layer&&this.layer.mapService&&(this.id="{0}/{1}".format(this.layer.mapService.id,this.layer.id));this.displayName.delegateGetter=
function(){return m.layer&&m.layer.displayName?m.layer.displayName:""};this.iconUri.delegateGetter=function(){return m.layer&&m.layer.iconUri?m.layer.iconUri:""};this.loadFeatures();this.loadAttributes()}Object.defineProperty(f.prototype,"dataLinksState",{get:function(){return this._dataLinksState},enumerable:!0,configurable:!0});f.prototype.setDataLinksState=function(a){this._dataLinksState=a;this.dataLinksResolved.set(a===v.Resolved)};f.prototype.getExtendedPropertyByName=function(a){for(var b=
0;b<this.extendedProperties.getLength();b++){var d=this.extendedProperties.getAt(b);if(d&&d.name==a)return d.value}return null};f.prototype.setExtendedProperty=function(a,b){for(var d=0;d<this.extendedProperties.getLength();d++){var g=this.extendedProperties.getAt(d);if(g&&g.name==a){g.value=b;return}}this.extendedProperties.addItem({name:a,value:b})};f.prototype.addFeature=function(a,b){var d=new m.CollectionChangedArgs,g=this.features.length();d.type="append";d.rangeStart=g;d.rangeEnd=g;d.sender=
this.features;return this._addFeatureWithoutNotification(a,b)?(this.features.bindingEvent.publish(d),!0):!1};f.prototype._addFeatureWithoutNotification=function(a,b){if(!a)throw Error("Feature cannot be null.");var d=this.features.getItems();return b||!this.containsFeature(a)?(a.featureSet=this,d.push(a),this.esriFeatureSet&&this.esriFeatureSet.features&&this.esriFeatureSet.features.push(a.esriFeature.get()),!0):!1};f.prototype.removeFeature=function(a){if(!a)throw Error("Feature cannot be null.");
var b=a.id.get();if(!String.isNullOrEmpty(b)&&!this._objectIds.containsKey(b))return!1;b=new m.CollectionChangedArgs;b.type="remove";for(var d=this.features.length();d--;){var g=this.features.getAt(d);if(g&&g.structurallyEquals(a))return b.rangeStart=d,b.rangeEnd=d,b.sender=this.features,this.features.bindingEvent.publish(b),this._removeWithoutNotificationAt(d),!0}return!1};f.prototype._removeWithoutNotificationAt=function(a){var b=this.features.getItems();if(0<=a&&a<b.length){var d=b[a],g=d.esriFeature.get();
g&&this.esriFeatureSet&&this.esriFeatureSet.features&&q.removeItem(this.esriFeatureSet.features,g);d.featureSet=null;q.remove(b,a,a);this._objectIds.remove(d.id.get());return!0}return!1};f.prototype.containsFeature=function(a){if(!a)throw Error("Feature cannot be null.");var b=a.id.get();if(b&&this._objectIds.containsKey(b))return!0;for(b=0;b<this.features.length();b++)if(this.features.getAt(b).structurallyEquals(a))return!0;return!1};f.prototype.clearFeatures=function(){if(0!=this.features.length()){var a=
new m.CollectionChangedArgs;a.type="clear";a.rangeStart=0;a.rangeEnd=this.features.length()-1;a.sender=this.features;for(this.features.bindingEvent.publish(a);0<this.features.length();)this._removeWithoutNotificationAt(0)}};f.prototype.loadGeometries=function(a,b,d){var g=this,c=new dojo.Deferred;if(!this.layer){var m=Error("loadGeometries: Layer must be present.");n.deferredReject(c,m);"function"==typeof d&&d(m);return c}if(!this.layer.primaryKeyField)return m=Error("loadGeometries: Layer must have a PrimaryKeyField to load geometries."),
n.deferredReject(c,m),"function"==typeof d&&d(m),c;var e=this.layer.primaryKeyField.name;a||(a=this.features.getItems());var q=[];if(a)for(m=0;m<a.length;m++){var s=a[m];if(!s.hasGeometry.get()){var r=s.esriFeature.get();r&&r.attributes[e]&&q.push(s)}}if(0<q.length){a=[];for(m=0;m<q.length;m++)a.push(q[m].esriFeature.get().attributes[e]);m=p.getQueryTask(this.layer);s=new esri.tasks.Query;s.objectIds=a;s.returnGeometry=!0;s.outFields=[e];this.layer&&this.layer.mapService&&this.layer.mapService.essentialsMap&&
this.layer.mapService.essentialsMap.site&&this.layer.mapService.essentialsMap.site.getMap()&&(s.outSpatialReference=this.layer.mapService.essentialsMap.site.getMap().spatialReference);m.execute(s).then(function(a){if(a&&a.features&&0<a.features.length)for(var d=0;d<a.features.length;d++){var m=a.features[d],p=g._findFeature(m.attributes[e],e,q);p&&(p.esriFeature.get().geometry=m.geometry)}n.deferredResolve(c,void 0);"function"==typeof b&&b()},function(a){a=Error("loadGeometries: Query error: "+a.message);
n.deferredReject(c,a);"function"==typeof d&&d(a)})}else n.deferredResolve(c,void 0),"function"==typeof b&&b();return c};f.prototype.findFeatureById=function(a){return this._objectIds.get(a)};f.prototype.findFeatureByEsriFeature=function(a){var b=null,d=a.getLayer();if(d&&this.layer&&this.layer.mapService&&this.layer.mapService.serviceLayer!==d)return null;for(d=0;d<this.features.length();d++){var g=this.features.getAt(d);if(g.esriFeature&&(g.esriFeature.get()===a||s.esriFeaturesEqual(g.esriFeature.get(),
a))){b=g;break}}return b};f.prototype._findFeature=function(a,b,d){var g=null,c,m;if(d&&0<d.length)for(c=0;c<d.length;c++)if((m=d[c].esriFeature.get())&&m.attributes&&m.attributes[b]==a){g=d[c];break}return g};f.prototype.loadFeatures=function(){this._watchFeatureSetChanges();this.features.clear();var a=[],b;if(this.esriFeatureSet&&this.esriFeatureSet.features)for(var d=0;d<this.esriFeatureSet.features.length;++d){b=this.esriFeatureSet.features[d];var g={graphic:b,layer:this.layer,featureLayer:this.featureLayer,
resolveLayerFields:!0,allowUnsafeContent:this._allowUnsafeContent};b=b&&b[r.isKmlProperty]?new r.KmlFeature(g):new e.Feature(g);b.featureSet=this;b.defaultDateFormat=this.defaultDateFormat;b.defaultNumberFormat=this.defaultNumberFormat;a.push(b)}this.features.useThrottling=!1;this.features.addItems(a)};f.prototype.loadAttributes=function(){this.attributes.clear();var a=[],b=[];if(this.layer&&this.layer.fields){for(var d=0;d<this.layer.fields.length;d++){var g=this.layer.fields[d];c.FeatureAttribute.ignoreAttribute(g.name)?
b.push(g):a.push(new c.FeatureAttribute("",g.name,g.alias,g.displayName,g.visible,t.PresentableDelegateFactory.valuePresenterDelegate(g,null)))}for(d=0;d<b.length;d++){var m=b[d];m.visible&&(g=a.filter(function(a){return a.name.get()===m.name.substr(0,m.name.length-7)}),g=1===g.length?g[0]:null)&&(g.visible.get()||g.visible.set(!0),g.alias.set(m.alias),g.displayName.set(m.displayName))}}else if(this.features&&0<this.features.getLength())for(b=this.features.getAt(0),d=0;d<b.attributes.getLength();d++)g=
b.attributes.getAt(d),a.push(new c.FeatureAttribute("",g.name.get(),g.alias.get(),g.displayName.get()));else if(this.esriFeatureSet&&this.esriFeatureSet.features&&0<this.esriFeatureSet.features.length)for(d in b=this.esriFeatureSet.features[0],b.attributes)b.attributes.hasOwnProperty(d)&&a.push(new c.FeatureAttribute("",d,d,d));this.attributes.addItems(a)};f.prototype.featureSetChanged=function(a){if("append"==a.type||"insert"==a.type)for(var b=a.rangeStart;b<=a.rangeEnd;b++){var d=this.features.getAt(b),
g=d.featureSetUniqueIds.indexOf(this.uniqueId);0<=g&&d.featureSetUniqueIds.splice(g,1);d.featureSet=this;d.featureSetUniqueIds.push(this.uniqueId);(g=d.id.get())&&this._objectIds.set(g,d)}if("remove"==a.type||"clear"==a.type)for(b=a.rangeStart;b<=a.rangeEnd;b++)d=this.features.getAt(b),g=d.featureSetUniqueIds.indexOf(this.uniqueId),0<=g&&d.featureSetUniqueIds.splice(g,1),d.featureSet===this&&(d.featureSet=null),(g=d.id.get())&&this._objectIds.remove(g)};f.prototype._applyDataLinks=function(a,b,d,
g,c){for(var m=0;m<a.features.length();m++){var e=a.features.getAt(m);if(0<e.linkedAttributes.length()){var q=e.linkedAttributes.getAt(0);e.linkedAttributes.clear();e.linkedAttributes.addItem(q);e.dataLinkingResults.clear()}}for(a=0;a<d.length;a++)for(var m=g[a],q=d[a],n=0;n<m.length;n++){var e=m[n],p=new u.DataLinkingResult;p.table.set(e.linkedData);p.dataLink.set(q);e=b[e.index];e.dataLinkingResults.addItem(p);c&&c(e);q.isOneToOne&&e.linkedAttributes.addItem(p.asAttributeGroup())}};f.prototype.resolveDataLinks=
function(a,b,d,g,c){var m=this,e=this;if(this.dataLinksState===v.Resolving)c&&c(this,Error("Currently performing data linking"),d);else if("undefined"===typeof b&&(b=!0),e.layer&&e.layer.hasDataLinks&&0<e.features.length()){e.setDataLinksState(v.Resolving);var q=this.features.get().slice(),n=[],n=b?dojo.filter(e.layer.dataLinks,function(a){return a.visible}):e.layer.dataLinks,n=dojo.filter(n,function(a){return!!(a&&a.parameters&&a.parameters.length)}),p=[],s=0,r=0,l=!1;for(b=0;b<n.length&&!l;b++){var f=
function(b){return function(c){if(!l&&(p[b]=c,s++,s>=n.length)){m._applyDataLinks(e,q,n,p,a);e.setDataLinksState(v.Resolved);if("undefined"!==typeof m.app)for(c=0;c<n.length;c++)m.app.event("DatalinkResolutionCompletedEvent").publish(n[c].id,e);g&&g(e,d)}}},k=f(b),t=function(a){return function(b){r++;r>=n.length?(console.error("There was an error in resolving {0} datalink. Message : {1}".format(n[a].displayName,b.message)),l=!0,e.setDataLinksState(v.Unresolved),c&&c(e,b,d)):(console.error("There was an error in resolving {0} datalink. Message : {1}".format(n[a].displayName,
b.message)),f(a)(new u.DataLinkingResult))}}(b);"undefined"!==typeof this.app&&this.app.event("DatalinkResolutionStartedEvent").publish(n[b].id,e);n[b].performDataLinking(e.esriFeatureSet,k,t)}}else e.setDataLinksState(v.Resolved),g&&g(e,d)};f.prototype.doWhenDataLinkingCompleted=function(a){var b=this;if("function"===typeof a)if(this.dataLinksResolved.get())a(this);else var d=this.dataLinksResolved.bind(this,function(g){g&&(b.dataLinksResolved.unbind(d),a(b))})};f.prototype.append=function(a){for(var b=
{},d=0;d<this.features.length();d++){var g=this.features.getAt(d),c;this.layer&&this.layer.primaryKeyField&&(c=this.layer.primaryKeyField.name);if(c){var m=g.esriFeature.get().attributes[c];b[m]=g}}for(d=0;d<a.features.length();d++)g=a.features.getAt(d),a.layer&&a.layer.primaryKeyField&&(c=a.layer.primaryKeyField.name),c?(m=g.esriFeature.get().attributes[c],b[m]||this.features.addItem(g)):this.features.addItem(g)};f.prototype.union=function(a){for(var b=this.clone(),d=a&&a.features?a.features.length():
0,g=0;g<d;g++)b.containsFeature(a.features.getAt(g))||b.addFeature(a.features.getAt(g),!0);return b};f.prototype.unionInPlace=function(a){if(!a||!a.features||0===a.features.length())return!1;var b=new m.CollectionChangedArgs;b.type="append";b.rangeStart=this.features.length();for(var d=!1,g=0,c=0;c<a.features.length();c++){var e=a.features.getAt(c);!this.containsFeature(e)&&this._addFeatureWithoutNotification(e,!0)&&(d=!0,g++)}d&&(b.rangeEnd=b.rangeStart+g-1,b.sender=this.features,this.features.bindingEvent.publish(b));
return d};f.prototype.subtract=function(a){for(var b=this.cloneStructure(),d=0;null!=a&&d<this.features.length();d++)a.containsFeature(this.features.getAt(d))||b.addFeature(this.features.getAt(d));return b};f.prototype.subtractInPlace=function(a){if(!a||!a.features||0===a.features.length())return!1;for(var b=!1,d=this.features.length();d--;){var g=this.features.getAt(d);a.containsFeature(g)&&(this._removeWithoutNotificationAt(d),b=!0)}b&&this.features.pulse();return b};f.prototype.intersect=function(a){for(var b=
this.cloneStructure(),d=0;null!=a&&d<this.features.length();d++)a.containsFeature(this.features.getAt(d))&&b.addFeature(this.features.getAt(d));return b};f.prototype.intersectInPlace=function(a){if(!a||!a.features)return!1;for(var b=!1,d=this.features.length();d--;){var g=this.features.getAt(d);a.containsFeature(g)||(this._removeWithoutNotificationAt(d),b=!0)}b&&this.features.pulse();return b};f.prototype.clone=function(){for(var a=this.cloneStructure(),b=0;b<this.features.length();b++)a.addFeature(this.features.getAt(b),
!0);return a};f.prototype.cloneStructure=function(){var a=new f({app:this.app,layer:this.layer,featureLayer:this.featureLayer,allowUnsafeContent:this._allowUnsafeContent,defaultDateFormat:this.defaultDateFormat,defaultNumberFormat:this.defaultNumberFormat,id:this.id});a.id=this.id;a.isSelectedInCollection.set(this.isSelectedInCollection.get());a.setDataLinksState(this.dataLinksState);a.displayName.set(this.displayName.get());a.iconUri.set(this.iconUri.get());a.attributes.set(this.attributes.get());
a.extendedProperties.set(this.extendedProperties.get());a.esriFeatureSet=this._cloneEsriStructure(this.esriFeatureSet);return a};f.prototype._cloneEsriStructure=function(a){if(!a)return null;var b=new esri.tasks.FeatureSet;b.displayFieldName=a.displayFieldName;b.exceededTransferLimit=a.exceededTransferLimit;b.fieldAliases=a.fieldAliases;b.geometryType=a.geometryType;b.spatialReference=a.spatialReference;a.fields&&(b.fields=a.fields);return b};f.prototype._watchFeatureSetChanges=function(){var a=this;
this._unwatchFeatureSetChanges();var b=this.features.bind(this,this.featureSetChanged),d={remove:function(){return a.features.unbind(b)}};return this._watchHandles.features=d};f.prototype._unwatchFeatureSetChanges=function(){var a=this._watchHandles.features;a&&a.remove();this._watchHandles.features=null};return f}();f.FeatureSet=h});
define("infrastructure/AttachmentInfo",["require","exports","geocortex/framework/observables"],function(h,f,k){h=function(){return function(){this.id=new k.Observable;this.contentType=new k.Observable;this.size=new k.Observable;this.name=new k.Observable;this.url=new k.Observable}}();f.AttachmentInfo=h});
define("infrastructure/FilterUtils",["require","exports"],function(h,f){function k(c,a){void 0===a&&(a={});html4.ATTRIBS["*::aria-label"]=0;html4.ATTRIBS["*::data-replacement-token"]=0;html4.ATTRIBS["a::target"]=0;a.allowFrames&&(html4.ATTRIBS["iframe::src"]=1);return html.sanitize(c,function(b,d,g,c){if(a.uriTransformer){b=b.toString();d=void 0;if("MARKUP"===c.TYPE)d={uri:b,type:"a"===c.XML_TAG&&"href"===c.XML_ATTR?l.NavigableLink:l.Markup,tag:c.XML_TAG,attribute:c.XML_ATTR};else if("CSS"===c.TYPE)d=
{uri:b,type:l.Css,property:c.CSS_PROP};else throw Error("Unknown URI hint type: '"+c.TYPE+"'");return a.uriTransformer(b,d)}return""})}f.sanitize=k;f.stripHtml=function(c){c=String.unescapeHtml(c);c=k(c);var a=document.createElement("div");a.innerHTML=c;return a.innerText||a.textContent};var l;(function(c){c[c.Markup=0]="Markup";c[c.Css=1]="Css";c[c.NavigableLink=2]="NavigableLink"})(l=f.UriType||(f.UriType={}));var e=function(){function c(a,b){void 0===b&&(b={});this.sanitize(a,b)}c.prototype.sanitize=
function(a,b){void 0===b&&(b={});this._unsafeHtml=a;this._safeHtml=k(this._unsafeHtml,b)};Object.defineProperty(c.prototype,"unsafeHtml",{get:function(){return this._unsafeHtml},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"safeHtml",{get:function(){return this._safeHtml},enumerable:!0,configurable:!0});return c}();f.UnsafeHtml=e;(function(c){function a(a){var d=a.match(/^\s*data:(.*?),.+/i);if(!d)return null;for(var d=d[1],g,c,e,n=0,p=d.split(";");n<p.length;n++){var s=p[n];
if(/^charset=(.+)$/i.test(s)){if(c)return null;c=s}else if(/^base64$/i.test(s)){if(e)return null;e=s}else if(/^.+$/i.test(s)){if(g)return null;g=s}}n=a.indexOf(",")+1;return{uri:a,meta:d,mediaType:g,charset:c,extension:e,payloadIndex:n}}c.dataUriMediaTypeWhitelist=["image/jpeg","image/png","image/gif","image/svg+xml"];c.parseDataUri=a;c.isDataUriSafe=function(b){b=a(b);if(!b)return!1;var d=b.mediaType;d||(d="text/plain");return c.dataUriMediaTypeWhitelist.some(function(a){return d.toLowerCase()===
a.toLowerCase()})?!0:!1}})(f.DataUri||(f.DataUri={}))});
define("infrastructure/Feature","require exports geocortex/essentials/Layer geocortex/framework-ui/LazyObservable geocortex/framework/observables infrastructure/FeatureAttribute infrastructure/AttachmentInfo infrastructure/AttributeGroup infrastructure/NumberFormat infrastructure/DateFormat geocortex/framework/utils/utils infrastructure/GeometryUtils infrastructure/FilterUtils geocortex/essentials/Field infrastructure/PresentableDelegateFactory infrastructure/gis/FieldInfo infrastructure/MapUtils geocortex/essentials/utilities/StringUtilities geocortex/essentials/RestHelperHTTPService".split(" "),function(h,
f,k,l,e,c,a,b,d,g,m,q,n,p,s,r,t,u,v){h=function(){function f(a){var b=this;this._isAttachmentInfosLoaded=!1;this._defaultFieldFormatString="{0}: {1}";this.featureSet=this.featureLayer=this.token=null;this.featureSetUniqueIds=[];this.labelFormat=new l.LazyObservable;this.minScale=new l.LazyObservable;this.maxScale=new l.LazyObservable;this.zoomScale=new l.LazyObservable;this.zoomFactor=new l.LazyObservable;this.zoomExtent=new e.Observable;this.borderColor=new l.LazyObservable;this.borderWidth=new l.LazyObservable;
this.fillColor=new l.LazyObservable;this.id=new l.LazyObservable;this.attributes=new e.ObservableCollection;this.label=new l.LazyObservable;this.plainLabel=new l.LazyObservable;this.description=new l.LazyObservable;this.descriptionFormat=new l.LazyObservable;this.longDescription=new l.LazyObservable;this.longDescriptionFormat=new l.LazyObservable;this.hyperlinks=new e.ObservableCollection;this.extendedProperties=new e.ObservableCollection;this.attachmentInfos=null;this.attachmentInfosInitialized=
new e.Observable(!1);this.hasAttachments=new e.Observable(!1);this.hasRelationships=new e.Observable(!1);this.hasVisibleRelationships=new e.Observable(!1);this.hasGeometry=new l.LazyObservable;this.hasValidGeometry=new l.LazyObservable;this.iconUri=new l.LazyObservable;this.linkedAttributes=new e.ObservableCollection;this.dataLinkingResults=new e.ObservableCollection;this.defaultNumberFormat=d.NumberFormat.DEFAULT;this.defaultDateFormat=g.DateFormat.DEFAULT;this.isModified=!1;this.displayTimeZoneId=
this.timeZoneId=null;this._resolveLayerFields=this._allowUnsafeContent=!1;this._attributeValueBindingTokens={};var c=null;a&&a.hasOwnProperty("graphic")&&(this._graphic=a.graphic);a&&a.hasOwnProperty("featureLayer")&&(this.featureLayer=a.featureLayer);a&&a.hasOwnProperty("layer")&&(c=a.layer)&&!this.featureLayer&&c.getFeatureLayer().then(function(a){(b.featureLayer=a)&&b._refreshPresentableValues()});a&&a.hasOwnProperty("resolveLayerFields")?this._resolveLayerFields=a.resolveLayerFields:c&&c.fields&&
(this._resolveLayerFields=!0);a&&a.hasOwnProperty("allowUnsafeContent")?this._allowUnsafeContent=a.allowUnsafeContent:this._allowUnsafeContent=!1;a&&a.hasOwnProperty("timeZoneId")&&(this.timeZoneId=a.timeZoneId);a&&a.hasOwnProperty("displayTimeZoneId")&&(this.displayTimeZoneId=a.displayTimeZoneId);this.token=m.alphaNumericToken();this.esriFeature=new e.Observable(this._graphic);this.esriFeature.bind(this,function(){b._graphic=b.esriFeature.get();b.loadAttributes(b._resolveLayerFields);b._setupLinkedAttributes();
b.attachmentInfos.clear();b._isAttachmentInfosLoaded=!1;b.attachmentInfosInitialized.set(!1);b._refreshPresentableValues()});this.connectDelegates();if(c){this.layer=c;this.hasAttachments.set(this.layer.hasAttachments);if(this.layer.relationships&&0<this.layer.relationships.length)for(this.hasRelationships.set(!0),a=0;a<this.layer.relationships.length;a++)if(this.layer.relationships[a].visible){this.hasVisibleRelationships.set(!0);break}null!=c.featureHyperlinks&&this.hyperlinks.addItems(c.featureHyperlinks)}this.loadAttributes(this._resolveLayerFields);
this.isModified=!1;this._prepAttachmentInfos();this._graphic&&this._setupLinkedAttributes()}f.prototype.getExtendedPropertyByName=function(a){for(var b=0;b<this.extendedProperties.getLength();b++){var d=this.extendedProperties.getAt(b);if(d&&d.name==a)return d.value}return null};f.prototype.setExtendedProperty=function(a,b){for(var d=0;d<this.extendedProperties.getLength();d++){var g=this.extendedProperties.getAt(d);if(g&&g.name==a){g.value=b;return}}this.extendedProperties.addItem({name:a,value:b})};
f.prototype.connectDelegates=function(){var a=this;this.hasGeometry.delegateGetter=function(){return!(!a._graphic||!a._graphic.geometry)};this.hasValidGeometry.delegateGetter=function(){return!(!a._graphic||!a._graphic.geometry)&&q.isValidGeometry(a._graphic.geometry)};this.id.cacheDelegateResults=!0;this.id.delegateGetter=function(){var b="";if(a._graphic&&a.layer){var d=null;a.layer&&(d=a.layer.getObjectIdFieldName());d&&a._graphic.attributes&&a._graphic.attributes.hasOwnProperty(d)&&(b=a._graphic.attributes[d])}return b};
this.label.delegateGetter=function(){var b=null,b=a.labelFormat.get(),b=a.formatTemplateString(b);null!=b&&void 0!=b&&b.toString().trim()||(b=a._getDefaultFieldValue(),void 0!=b&&null!=b&&a.layer&&(b=a.layer.displayName&&a.layer.displayName.toString().trim()?a.layer.displayName+(b.toString().trim()?", "+b:""):b.toString().trim()?b:""));return n.sanitize(b,{allowFrames:!1,uriTransformer:function(a,b){return b.type!==n.UriType.NavigableLink?a:/^mailto\:/.test(a)?a:"command:OpenWebPage?"+a}})};this.plainLabel.delegateGetter=
function(){return n.stripHtml(a.label.get())};this.labelFormat.delegateGetter=function(){return a.layer&&a.layer.featureLabel?a.layer.featureLabel:a.layer&&a.layer.displayField?"{"+a._sanitizeFieldName(a.layer.displayField.name)+"}":a.featureSet&&a.featureSet.esriFeatureSet&&a.featureSet.esriFeatureSet.displayFieldName&&a.featureSet.layer&&a.featureSet.layer.displayName?a.featureSet.layer.displayName+", {"+a.featureSet.esriFeatureSet.displayFieldName+"}":a.featureSet&&a.featureSet.esriFeatureSet&&
a.featureSet.esriFeatureSet.displayFieldName?"{"+a._sanitizeFieldName(a.featureSet.esriFeatureSet.displayFieldName)+"}":""};this.borderColor.delegateGetter=function(){return a.layer&&a.layer.featureBorderColor?a.layer.featureBorderColor:null};this.borderWidth.delegateGetter=function(){return a.layer&&"number"==typeof a.layer.featureBorderWidth&&0<=a.layer.featureBorderWidth?a.layer.featureBorderWidth:null};this.fillColor.delegateGetter=function(){return a.layer&&a.layer.featureFillColor?a.layer.featureFillColor:
null};this.description.delegateGetter=function(){var b=a.descriptionFormat.get();return a.formatTemplateString(b)};this.descriptionFormat.delegateGetter=function(){return a.layer&&a.layer.featureDescription?a.layer.featureDescription:null};this.longDescription.delegateGetter=function(){var b=a.longDescriptionFormat.get();return a.formatTemplateString(b)};this.longDescriptionFormat.delegateGetter=function(){return a.layer&&a.layer.featureLongDescription?a.layer.featureLongDescription:a.descriptionFormat.get()};
this.minScale.delegateGetter=function(){return a.layer&&!isNaN(a.layer.minScale)?a.layer.minScale:Infinity};this.maxScale.delegateGetter=function(){return a.layer&&!isNaN(a.layer.maxScale)?a.layer.maxScale:0};this.iconUri.delegateGetter=function(){return a.layer&&a.layer.iconUri?a.layer.iconUri:a.featureSet&&a.featureSet.iconUri&&a.featureSet.iconUri.get()?a.featureSet.iconUri.get():null};this.zoomScale.delegateGetter=function(){return a.layer&&a.layer.featureZoomScale?a.layer.featureZoomScale:null};
this.zoomFactor.delegateGetter=function(){return a.layer&&a.layer.featureZoomFactor?a.layer.featureZoomFactor:null}};f.prototype.withinScaleRange=function(a){return 0==this.maxScale.get()&&Infinity==this.minScale.get()||isNaN(this.maxScale.get())&&isNaN(this.minScale.get())?!0:a?this.maxScale.get()<=a&&a<=this.minScale.get():!1};f.prototype.calculateScaleToMakeVisible=function(a){return this.withinScaleRange(a)?a:a<this.maxScale.get()?this.maxScale.get():this.minScale.get()};f.prototype._sanitizeFieldName=
function(a){return a?a.replace(/\W/g,""):""};f.prototype._getDefaultFieldValue=function(){var a="",b=this.esriFeature.get();b&&this.layer&&this.layer.displayField&&(a=b.attributes[this.layer.displayField.name],null!==a&&void 0!==a&&(a=a.toString().trim()));null!=a&&void 0!=a&&a||!b||!b.attributes||(a=b.attributes.OBJECTID,null!==a&&void 0!==a&&(a=a.toString().trim()));if((null==a||void 0==a||!a)&&b&&b.attributes)for(var d in b.attributes)if(a=b.attributes[d],null!==a&&void 0!==a&&(a=a.toString().trim()),
a)break;return String.escapeHtmlEncode(a)};f.prototype.resetAttachmentInfos=function(){this.attachmentInfos.clear();this._isAttachmentInfosLoaded=!1;this.attachmentInfosInitialized.set(!1)};f.prototype._prepAttachmentInfos=function(){var a=this,b=new e.ObservableCollection,d=b.get;b.get=function(){a._isAttachmentInfosLoaded||a._loadAttachmentsInfos();return d.call(b)};var g=b.getItems;b.getItems=function(){a._isAttachmentInfosLoaded||a._loadAttachmentsInfos();return g.call(b)};var c=b.getAt;b.getAt=
function(d){a._isAttachmentInfosLoaded||a._loadAttachmentsInfos();return c.call(b,d)};this.attachmentInfos=b};f.prototype.loadAttributes=function(a){var b=this,d={};this.attributes.get().forEach(function(a){d[a.name.get()]=a.value.get();var g=b._attributeValueBindingTokens[a.name.get()];g&&a.value.unbind(g)});this.attributes.clear();this._attributeValueBindingTokens={};if(this._graphic&&this._graphic.attributes){a=this.getAttributesFromEsriFeature(this._graphic.attributes,a);a.forEach(function(a){var g=
a.name.get(),c=a.value.get();b._attributeValueBindingTokens[g]=a.value.bind(b,function(){b.isModified=!0});b.isModified=b.isModified||d.hasOwnProperty(g)&&c!==d[g]||!d.hasOwnProperty(g)});var g=this._graphic.attributes||{};this.isModified=this.isModified||Object.keys(d).some(function(a){return!g.hasOwnProperty(a)});this.attributes.addItems(a)}};f.prototype.getAttributesFromEsriFeature=function(a,b){var d=this,g=[];if(!1!==b&&this.layer&&this.layer.fields){var m=null;this.layer.mapService&&(m=this.layer.mapService.serviceLayer);
for(var e=[],q=0;q<this.layer.fields.length;q++){var n=this.layer.fields[q],l;a&&(n.name||n.alias)&&(l=a.hasOwnProperty(n.name)?a[n.name]:a[n.alias]);c.FeatureAttribute.ignoreAttribute(n.name)?e.push(n):"undefined"===typeof l||null==l?g.push(new c.FeatureAttribute("",n.name,n.alias,n.displayName,n.visible,s.PresentableDelegateFactory.valuePresenterDelegate(n,this),n.dataType)):g.push(new c.FeatureAttribute(l,n.name,n.alias,n.displayName,n.visible,s.PresentableDelegateFactory.valuePresenterDelegate(n,
this),n.dataType))}for(l=0;l<e.length;l++){var f=e[l];f.visible&&(q=g.filter(function(a){return a.name.get()===f.name.substr(0,f.name.length-7)}),q=1===q.length?q[0]:null)&&(q.visible.get()||q.visible.set(!0),q.alias.set(f.alias),q.displayName.set(f.displayName))}if(m instanceof esri.layers.WMSLayer)for(var k in a){m=!1;e=a[k];for(l=0;l<this.layer.fields.length;l++)if(k===this.layer.fields[l].name){m=!0;break}m||g.push(new c.FeatureAttribute(e,k))}}else if(this.featureLayer)this.featureLayer.fields.forEach(function(b){var m=
b.alias?b.alias:b.name;if(b.type===p.EsriFieldTypes.esriFieldTypeDate){var e=r.FieldInfo.fromEsriField(b,d.featureLayer);e.timeZoneId||(e.timeZoneId=d.timeZoneId);e.displayTimeZoneId||(e.displayTimeZoneId=d.displayTimeZoneId);!d.layer&&d.defaultDateFormat&&(e.format="{0:"+d.defaultDateFormat+"}");g.push(new c.FeatureAttribute(a[b.name],b.name,m,m,!0,s.PresentableDelegateFactory.valuePresenterDelegate(e,null)))}else g.push(new c.FeatureAttribute(a[b.name],b.name,m,m,!0,s.PresentableDelegateFactory.valuePresenterDelegate(b.name,
d)))});else if(this.featureSet&&this.featureSet.attributes&&0<this.featureSet.attributes.length()&&a)for(l=0;l<this.featureSet.attributes.length();l++)k=this.featureSet.attributes.getAt(l),m=k.name.get(),c.FeatureAttribute.ignoreAttribute(m)||a.hasOwnProperty(m)&&g.push(new c.FeatureAttribute(a[m],m,k.alias.get(),k.displayName.get(),k.visible.get(),s.PresentableDelegateFactory.valuePresenterDelegate(m,this)));else if(a)for(m in a)g.push(new c.FeatureAttribute(a[m],m,m,m,!0,s.PresentableDelegateFactory.valuePresenterDelegate(m,
this)));return g};f.prototype.getAttributes=function(a){a=this.linkedAttributes.get();for(var b=[],d=0;d<a.length;d++){var g=a[d];if(0===d)for(var g=this.attributes.get(),m=0;m<g.length;m++)b.push(g[m]);else{var g=g.attributes,e;for(e in g)g.hasOwnProperty(e)&&b.push(new c.FeatureAttribute(g[e],e,e,e,!0,s.PresentableDelegateFactory.valuePresenterDelegate(null,null)))}}return b};f.prototype.getPrimaryKeyValue=function(){var a=null;if(this.layer&&this.layer.primaryKeyField){var b=this.layer.primaryKeyField;
b&&(a=this._graphic.attributes[b.name])}return a};f.prototype.getFeatureUrl=function(){var a=null,b=this.layer.getLayerUrl?this.layer.getLayerUrl():this.layer.url,d=null;this.layer instanceof k.Layer?d=this.getPrimaryKeyValue():this.layer instanceof esri.layers.Layer&&(d=this.layer,d=this.esriFeature.get().attributes[d.objectIdField]);b&&d&&(a=b+"/"+d);return a};f.prototype.getType=function(){if(!this.featureLayer)return null;var a=s.PresentableDelegateFactory.typeIdForLayerAndAttributes(this.featureLayer,
this._graphic.attributes);if(null!==a)return s.PresentableDelegateFactory.typeFromLayerAndId(this.featureLayer,a)};f.prototype.structurallyEquals=function(a){return a&&a instanceof f?this===a||this._graphic&&a._graphic&&this._graphic===a._graphic?!0:null!=this._graphic&&null!=a._graphic&&this._getLayerUniqueId()==a._getLayerUniqueId()&&this.id.get()===a.id.get()?String.isNullOrEmpty(this.id.get())?t.esriFeaturesEqual(this._graphic,a._graphic):!0:!1:!1};f.prototype.equals=function(a){if(!(a&&a instanceof
f&&this._graphic&&a._graphic))return!1;if(this===a)return!0;var b=this._graphic.geometry,d=a._graphic.geometry,g=this.id.get()===a.id.get()||this.id.get()&&a.id.get()&&this.id.get()==a.id.get(),c=this.layer===a.layer||this.layer&&a.layer&&this.layer.id==a.layer.id,m=this.layer===a.layer||this.layer&&a.layer&&this.layer.mapService===a.layer.mapService||this.layer&&a.layer&&this.layer.mapService&&a.layer.mapService&&this.layer.mapService.id==a.layer.mapService.id,e=b===d||b&&d&&b.declaredClass==d.declaredClass;
if(!(g&&c&&m&&e&&t.esriFeaturesEqual(this._graphic,a._graphic)))return!1;if(b===d)return!0;switch(b.declaredClass){case "esri.geometry.Point":case "esri.geometry.ScreenPoint":return t.esriPointsEqual(b,d);case "esri.geometry.MultiPoint":return t.esriMultipointsEqual(b,d);case "esri.geometry.Polyline":return t.esriPolylinesEqual(b,d);case "esri.geometry.Polygon":return t.esriPolygonsEqual(b,d);case "esri.geometry.Extent":return t.esriExtentsEqual(b,d);default:throw Error("Warning: equals() in Feature.ts - declared class does not match known geometry.");
}};f.prototype._loadAttachmentsInfos=function(){var b=this;this._isAttachmentInfosLoaded=!0;if(!this.layer)throw Error("Error fetching attachment infos: Feature was not associated with any known layer.");var d={url:this.getFeatureUrl()+"/attachments/?f=json&ts={0}".format((new Date).getTime()),handleAs:"json"},g=this.layer.mapService&&this.layer.mapService.serviceToken?this.layer.mapService.serviceToken:null,c=this.layer;!this.layer.mapService&&c.credential&&c.credential.token&&(g=c.credential.token);
g&&(d.url=v.RestHelperHTTPService.appendTokenToUrl(d.url,g));c=null;try{c=this.layer.mapService.serviceLayer.queryAttachmentInfos(parseInt(this.id.get()))}catch(m){c=esri.request(d)}c.then(function(d){if(0<d.length&&!d.attachmentInfos&&d instanceof Array){d.attachmentInfos=[];for(var c=0;c<d.length;c++)d.attachmentInfos[c]=d[c]}if(d&&d.attachmentInfos&&0<d.attachmentInfos.length)for(c=0;c<d.attachmentInfos.length;c++){var m=d.attachmentInfos[c],e=new a.AttachmentInfo;e.id.set(m.id);e.contentType.set(m.contentType);
e.size.set(m.size);e.name.set(m.name);m="{0}/attachments/{1}".format(b.getFeatureUrl(),m.id);g&&(m=v.RestHelperHTTPService.appendTokenToUrl(m,g));e.url.set(m);b.attachmentInfos.addItem(e)}b.attachmentInfosInitialized.set(!0)},function(a){b.attachmentInfosInitialized.set(!0)})};f.prototype.formatTemplateString=function(a){var b=this;return a?a.replace(/{{.+?}}|{.+?}/g,function(a){if(a.match(/{{.+?}}/g))return a.substring(1,a.length-1);a=a.substring(1,a.length-1);var d="",g=a.match(/(.*)\.Name\(\)$/);
g&&(a=g[1]);for(var g=b.getAttributes(),c=0;c<g.length;c++)if(g[c].name&&g[c].name.get()===a||g[c].alias&&g[c].alias.get()===a){if(b.layer&&b.layer.getFieldByName(a)&&m.isUrl(g[c].value.get())){d=g[c].value.get();break}d=g[c].presentableValue.get();break}!d&&b.layer&&(d=u.StringUtilities.replaceLayerTokens(a,b.layer));!d&&b.layer&&b.layer.mapService&&(d=u.StringUtilities.replaceMapServicetokens(a,b.layer.mapService));if(!d&&(g={},b.parseDataLinkId(a,g)&&b.dataLinkingResults.get()))for(c=0;c<b.dataLinkingResults.length();c++){var e=
b.dataLinkingResults.getAt(c);if(e.dataLink.get()&&e.dataLink.get().id===g.dataLinkId){if("_rowcount"===g.attributeName.toLowerCase())d=e.table?e.table.get().rows.length:0;else if(e.table.get())for(c=e.table.get(),e=0;e<c.columns.length;e++)if(c.columns[e].toLowerCase()===g.attributeName.toLowerCase()){0<c.rows.length&&(d=c.rows[0].row[e]);break}break}}d||"RestToken"!==a||(d=v.RestHelperHTTPService.token);b._allowUnsafeContent?null==d&&(d=""):d=d||0===d?n.sanitize(d.toString()):"";if(null===d||void 0===
d)d="";return d}):""};f.prototype.parseDataLinkId=function(a,b){var d=a.indexOf(".");if(0>d)return!1;b.dataLinkId=a.substring(0,d);b.attributeName=a.substring(d+1);return!0};f.prototype._getLayerUniqueId=function(){var a="";this.layer&&(a=this.layer.id,this.layer.mapService&&(a=this.layer.mapService.id+"/"+a));return a};f.prototype._setupLinkedAttributes=function(){var a=new b.AttributeGroup;a.owner=this._graphic;a.attributes=this._graphic.attributes;this.linkedAttributes.clear();this.linkedAttributes.addItem(a)};
f.prototype._refreshPresentableValues=function(){this.attributes.get().forEach(function(a){a.presentableValue.clear();a.presentableValue.pulse()});this.label.clear();this.plainLabel.clear();this.description.clear();this.longDescription.clear();this.label.pulse();this.plainLabel.pulse();this.description.pulse();this.longDescription.pulse()};return f}();f.Feature=h});define("infrastructure/clickableGraphics/ClickableOptions",["require","exports"],function(h,f){});
define("infrastructure/clickableGraphics/ClickableLayerInfo",["require","exports"],function(h,f){});
define("infrastructure/GraphicsLayerIds",["require","exports"],function(h,f){f.MARKUP_LAYER_ID="Drawings";f.COORDINATES_LAYER_ID=f.MARKUP_LAYER_ID+"_coordinates";f.MEASUREMENT_LAYER_ID=f.MARKUP_LAYER_ID+"_measurement";f.PUSHPINS_LAYER_ID="DefaultPushpinsLayer";f.COLLABORATION_LAYER_ID="__CollaborationGraphicsLayer";f.COLLABORATION_SCRATCH_LAYER_ID="CollaborationScratch";f.SNAPPING_GRAPHICS_LAYER_ID="snapping_graphics";f.SNAPPING_HELPER_GRAPHICS_LAYER_ID="snapping_helper_graphics";f.TEMP_SNAPPING_EDITOR_LAYER_ID=
"temp_snapping_graphics_editing";f.AOI_MASK_LAYER_ID="AreaOfInterestMask";f.EDITING_LAYER_ID="editing_layer";f.EDITOR_CLONE_LAYER_ID="editor_clone_layer";f.GEOLOCATION_LAYER_ID="geolocation_layer";f.VIEWPOINT_INDICATOR_GRAPHICS_LAYER_ID="viewpointIndicatorGraphicsLayer";f.MARKER_GRAPHICS_LAYER_ID="MarkerGraphicsLayer";f.TEMP_GRAPHICS_LAYER_ID="TemporaryMarkup";f.changeGraphicsLayerIdBase=function(k){f.MARKUP_LAYER_ID=k;f.COORDINATES_LAYER_ID=k+"_coordinates";f.MEASUREMENT_LAYER_ID=k+"_measurement"}});
define("infrastructure/FeatureSetCollection",["require","exports","geocortex/framework/observables","geocortex/framework/utils/utils","infrastructure/Dictionary"],function(h,f,k,l,e){h=function(){function c(){this.displayName=new k.Observable("");this.isModified=new k.Observable(!1);this.featureSets=new k.ObservableCollection;this.extendedProperties=new k.ObservableCollection;this.id="FSC-{0}".format(l.alphaNumericToken());this.featureSets.useThrottling=!1}c.prototype.getExtendedPropertyByName=function(a){for(var b=
0;b<this.extendedProperties.getLength();b++){var d=this.extendedProperties.getAt(b);if(d&&d.name==a)return d.value}return null};c.prototype.setExtendedProperty=function(a,b){for(var d=0;d<this.extendedProperties.getLength();d++){var g=this.extendedProperties.getAt(d);if(g&&g.name==a){g.value=b;return}}this.extendedProperties.addItem({name:a,value:b})};c.prototype.getFeatureSetById=function(a){return this._getFeatureSetByIdImpl(a)};c.prototype.getFeatureSetByUniqueId=function(a){return this._getFeatureSetByIdImpl(a,
!0)};c.prototype.getFeatureSetByLayer=function(a){if(!a)return null;for(var b=0;b<this.featureSets.getLength();++b){var d=this.featureSets.getAt(b),g=d.layer,c=a===g||a&&g&&a.mapService===g.mapService||a&&g&&a.mapService&&g.mapService&&a.mapService.id==g.mapService.id;if((a===g||a&&g&&a.id==g.id)&&c)return d}return null};c.prototype.getFeatureSetbyEsriLayer=function(a){if(!a)return null;for(var b=0;b<this.featureSets.getLength();++b){var d=this.featureSets.getAt(b);if(d.esriFeatureSet&&d.esriFeatureSet.features&&
0<d.esriFeatureSet.features.length&&d.esriFeatureSet.features[0].getLayer()&&d.esriFeatureSet.features[0].getLayer()===a)return d}return null};c.prototype.findFeatureByEsriFeature=function(a){for(var b=0;b<this.featureSets.getLength();b++){var d=this.featureSets.getAt(b).findFeatureByEsriFeature(a);if(d)return d}return null};c.prototype.firstFeature=function(){for(var a=0;a<this.featureSets.getLength();a++){var b=this.featureSets.getAt(a);if(0<b.features.getLength())return b.features.getAt(0)}return null};
c.prototype.countFeatures=function(){for(var a=0,b=0;b<this.featureSets.length();b++)a+=this.featureSets.getAt(b).features.length();return a};c.prototype.clear=function(){for(var a=0;a<this.featureSets.getLength();a++)this.featureSets.getAt(a).features.clear();this.featureSets.clear()};c.prototype.clone=function(a){void 0===a&&(a=!1);for(var b=this.cloneStructure(),d=0;d<this.featureSets.length();d++){var g=a?this.featureSets.getAt(d).clone():this.featureSets.getAt(d);b.featureSets.addItem(g)}return b};
c.prototype.cloneStructure=function(){var a=new c;a.sourceName=this.sourceName;a.displayName.set(this.displayName.get());a.isModified.set(this.isModified.get());a.tag=this.tag;this.extendedProperties.getItems().forEach(function(b){return a.setExtendedProperty(b.name,b.value)});return a};c.prototype.unionInPlace=function(a){if(!a||0===a.featureSets.length())return!1;for(var b=this._buildFeatureSetLookup(),d=this._buildLayerLookup(),g=!1,c=0;c<a.featureSets.length();c++){var e=a.featureSets.getAt(c),
n=e.id,p=e.layer,s=null;n&&b.containsKey(n)&&(s=b.get(n));!s&&p&&p.mapService&&(n=this._generateLayerKey(p.mapService.id,p.id),s=d.get(n));s?s.unionInPlace(e)&&(g=!0):(this.featureSets.addItem(e),g=!0)}return g};c.prototype.unionManyInPlace=function(a){if(!a||0==a.length)return!1;for(var b=!1,d=0;d<a.length;d++)this.unionInPlace(a[d])&&(b=!0);return b};c.prototype.subtractInPlace=function(a){if(!a||0===a.featureSets.length())return!1;var b=a._buildFeatureSetLookup();a=a._buildLayerLookup();for(var d=
!1,g=this.featureSets.length();g--;){var c=this.featureSets.getAt(g),e=c.id,n=c.layer,p=null;e&&b.containsKey(e)&&(p=b.get(e));!p&&n&&n.mapService&&(e=this._generateLayerKey(n.mapService.id,n.id),p=a.get(e));p&&(c.subtractInPlace(p)&&(d=!0),0==c.features.length()&&(this.featureSets.removeAt(g),d=!0))}return d};c.prototype.subtractManyInPlace=function(a){if(!a||0==a.length)return!1;for(var b=!1,d=0;d<a.length;d++)this.subtractInPlace(a[d])&&(b=!0);return b};c.prototype.intersectInPlace=function(a){if(!a)return!1;
var b=a._buildFeatureSetLookup();a=a._buildLayerLookup();for(var d=!1,g=this.featureSets.length();g--;){var c=this.featureSets.getAt(g),e=c.id,n=c.layer,p=null;e&&b.containsKey(e)&&(p=b.get(e));!p&&n&&n.mapService&&(e=this._generateLayerKey(n.mapService.id,n.id),p=a.get(e));p?(c.intersectInPlace(p)&&(d=!0),0==c.features.length()&&(this.featureSets.removeAt(g),d=!0)):(this.featureSets.removeAt(g),d=!0)}return d};c.prototype.intersectManyInPlace=function(a){if(!a||0==a.length)return!1;for(var b=!1,
d=0;d<a.length;d++)this.intersectInPlace(a[d])&&(b=!0);return b};c.prototype._generateLayerKey=function(a,b){return"{0}/{1}".format(a,b)};c.prototype._buildLayerLookup=function(){for(var a=new e.Dictionary,b=0;b<this.featureSets.length();b++){var d=this.featureSets.getAt(b);if(d&&d.layer&&d.layer.mapService){var g=this._generateLayerKey(d.layer.mapService.id,d.layer.id);a.containsKey(g)||a.set(g,d)}}return a};c.prototype._buildFeatureSetLookup=function(){for(var a=new e.Dictionary,b=0;b<this.featureSets.length();b++){var d=
this.featureSets.getAt(b);d&&d.id&&!a.containsKey(d.id)&&a.set(d.id,d)}return a};c.prototype._getFeatureSetByIdImpl=function(a,b){void 0===b&&(b=!1);for(var d=0;d<this.featureSets.getLength();++d){var g=this.featureSets.getAt(d);if(b){if(g.uniqueId==a)return g}else if(g.id==a)return g}return null};return c}();f.FeatureSetCollection=h});
define("infrastructure/BrowserUtils",["require","exports"],function(h,f){function k(){var l=window.navigator.userAgent,e=-1,c=l.indexOf("Trident/");0<c&&(c=parseInt(l.substring(c+8,l.indexOf(".",c)),10),4===c&&(e=8),5===c&&(e=9),6===c&&(e=10),7===c&&(e=11));-1===e&&(c=l.indexOf("MSIE "),0<c&&(e=parseInt(l.substring(c+5,l.indexOf(".",c)),10)));-1===e&&(c=l.indexOf("Edge/"),0<c&&(e=parseInt(l.substring(c+5,l.indexOf(".",c)),10)));return e}f.isIE=function(){var l=k();return-1!==l&&12>l?l:-1};f.isEdge=
function(){var l=k();return-1!==l&&12<=l?l:-1};f.isChrome=function(){return/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)};f.isInternetExplorerOrEdge=k});
define("infrastructure/ClusterLayer","require exports geocortex/framework/observables infrastructure/Feature infrastructure/FeatureSet infrastructure/FeatureSetCollection infrastructure/BrowserUtils".split(" "),function(h,f,k,l,e,c,a){f.ClusterHidingOptions={none:0,unselected:1};h=function(b){function d(d,c){var e=b.call(this)||this;e.gcxLayer=null;e.featureLayer=null;e.singleFeatureLayer=null;e.clusterRadius=new k.Observable(null);e.maxFeaturesInCluster=new k.Observable(null);e.hideClusters=new k.Observable(f.ClusterHidingOptions.none);
e.renderer=null;e.rendererInformation=[];e.featureLayerRenderer=null;e._featureLayerGraphics=[];e._clusters=[];e._hiddenClusters=[];e._clusterLabelColor=null;e._clusterBackgroundColor=null;e._featureSetName=null;e._esriEventHandlers=[];e._gcxEventHandlers=[];e._fontSize="10pt";e._fontFamily="Segoe UI, sans-serif";e._clusterExploded=!1;e._mapClickEnabled=!0;e.MAP_CLICK_PREVENTION_DELAY=300;e._isChrome=!1;if(!(d.mapService.serviceLayer instanceof esri.layers.FeatureLayer))throw Error("ClusterLayers require an Esri FeatureLayer to be passed in as a parameter.");
e.app=c;e.id=d.mapService.id+"-cluster";e._featureSetName=e.id+"FeatureSet";e.gcxLayer=d;e.featureLayer=d.mapService.serviceLayer;e.singleFeatureLayer=new esri.layers.GraphicsLayer;e.url=e.featureLayer.url;e.setVisibility(e.featureLayer.visible&&e.featureLayer.visibleAtMapScale);e.setOpacity(e.featureLayer.opacity);e.featureLayerRenderer=e.featureLayer.renderer;e.featureLayer.setRenderer(null);e.featureLayer.redraw();e.singleFeatureLayer.id=d.mapService.id+"-explodedClusterLayer";e.singleFeatureLayer.setRenderer(e.featureLayerRenderer);
e.singleFeatureLayer.setOpacity(e.featureLayer.opacity);e.singleFeatureLayer.url=e.url;e.clusterRadius.set(d.mapService.featureClustering.radius||50);e.maxFeaturesInCluster.set(d.mapService.featureClustering.maximumFeatures||0);e._clusterLabelColor=new esri.Color(d.mapService.featureClustering.labelColor);e._clusterBackgroundColor=new esri.Color(d.mapService.featureClustering.backgroundColor);for(var n=0;4>n;n++)e.rendererInformation.push({isVisible:new k.Observable(!1),rangeString:new k.Observable("")});
e.maxFeaturesInCluster.bind(e,function(a){e.gcxLayer.mapService.featureClustering.maximumFeatures=a;e._loadRenderer()});e.clusterRadius.bind(e,function(a){e.gcxLayer.mapService.featureClustering.radius=a});0<e.maxFeaturesInCluster.get()&&e._loadRenderer();if(e.app.map&&e.app.map.loaded)e._setupEventListeners(e.app.map);else e.app.event("MapLoadedEvent").once(e,function(a){e._setupEventListeners(a)});e._isChrome=a.isChrome();e.recluster();return e}__extends(d,b);d.prototype.recluster=function(){this.singleFeatureLayer.clear();
this._clusterExploded=!1;this._featureLayerGraphics=this.featureLayer.graphics.slice(0,this.featureLayer.graphics.length);this._generateClusters();this.redraw()};d.prototype.destroy=function(){this.app.map.getLayer(this.singleFeatureLayer.id)===this.singleFeatureLayer&&this.app.map.removeLayer(this.singleFeatureLayer);this.app.featureSetManager.getCollectionById(this._featureSetName)&&(this.app.featureSetManager.closeCollection(this._featureSetName),this.app.featureSetManager.removeCollectionById(this._featureSetName));
this.app.map.removeLayer(this);this.featureLayer.setRenderer(this.featureLayerRenderer);this.featureLayer.redraw();for(var a=0;a<this._esriEventHandlers.length;a++)this._esriEventHandlers[a].remove();for(a=0;a<this._gcxEventHandlers.length;a++)this.app.event(this._gcxEventHandlers[a].eventName).unsubscribe(this._gcxEventHandlers[a].token)};d.prototype.onFeatureClicked=function(a){if(a.graphic instanceof esri.Graphic&&!this.app.toolRegistry.getActiveTool()){a=a.graphic;var b=this.isClusterExploded();
this.singleFeatureLayer.clear();this._addClusterToMapTip(a.attributes.clusterId,b)}};d.prototype.isClusterExploded=function(){return 0<this.singleFeatureLayer.graphics.length};d.prototype._addClusterToMapTip=function(a,b){var d=this;this._hiddenClusters=[];var n=[],p=[];this.hideClusters.get()===f.ClusterHidingOptions.none&&b&&this.recluster();for(var s=0;s<this._featureLayerGraphics.length;s++)if(this._featureLayerGraphics[s].attributes.clusterId===a){var r={graphic:this._featureLayerGraphics[s],
layer:this.gcxLayer,resolveLayerFields:!0};r.symbol=this._getRenderedSymbol(this._featureLayerGraphics[s]);n.push(new l.Feature(r));p.push(this._featureLayerGraphics[s])}1<p.length?this._explodeCluster(a,p,b):this.app.command("EnableMapClick").execute();s=new e.FeatureSet;s.features.set(n);s.layer=this.gcxLayer;s.esriFeatureSet=new esri.tasks.FeatureSet;s.esriFeatureSet.features=p;s.resolveDataLinks(function(a){d.app.event("FeatureChangedEvent").publish(a)});n=new c.FeatureSetCollection;n.featureSets.addItem(s);
n.id=this._featureSetName;n.sourceName="ClusterFeatures";1<s.features.length()&&this.app.command("ScreenReaderNarrate").execute("Cluster with "+s.features.length()+" features exploded");this.app.featureSetManager.getCollectionById(this._featureSetName)&&this.app.featureSetManager.removeCollectionById(this._featureSetName);this.app.featureSetManager.addCollection(n);this.app.featureSetManager.openCollection(this._featureSetName);this.app.featureSetManager.closeCollection(this._featureSetName)};d.prototype._explodeCluster=
function(a,b,d){var c=this;for(d=0;d<b.length;d++)this.singleFeatureLayer.add(b[d]);if(this.hideClusters.get()===f.ClusterHidingOptions.unselected)this._hiddenClusters=this.graphics.slice(0,this.graphics.length),this.clear(),this.redraw();else{for(b=0;b<this.graphics.length;b++)this.graphics[b].attributes.clusterId==a&&this._hiddenClusters.push(this.graphics[b]);this._hiddenClusters.forEach(function(a){c.remove(a)})}a=this.app.map.graphicsLayerIds.indexOf(this.featureLayer.id);b=this.app.map.graphicsLayerIds.indexOf(this.id);
a=Math.max(a,b);this.app.map.getLayer(this.singleFeatureLayer.id)||this.app.map.addLayer(this.singleFeatureLayer,a+1);this.singleFeatureLayer.redraw();this._clusterExploded=!0;this._disableMapClick()};d.prototype._implodeCluster=function(){0<this.app.stateManager.getActiveStates().filter(function(a){return"EditorActiveState"===a.stateDefinition.name}).length?this.singleFeatureLayer.redraw():(this.recluster(),this.app.command("ScreenReaderNarrate").execute("Exploded cluster was collapsed"),this._clusterExploded=
!1)};d.prototype._setupEventListeners=function(a){var b=this;this._isChrome?this._gcxEventHandlers.push({eventName:"MapMouseDownEvent",token:this.app.event("MapMouseDownEvent").subscribe(this,function(a){return b._mapMouseDownEvent(a)})}):this._esriEventHandlers.push(a.on("click",function(a){b._mapClickedEvent(a)}));this._gcxEventHandlers.push({eventName:"MapExtentChangedEvent",token:this.app.event("MapExtentChangedEvent").subscribe(this,function(a,d){return b._mapExtentChangedEvent(a,d)})});this._gcxEventHandlers.push({eventName:"MapTipClosedEvent",
token:this.app.event("MapTipClosedEvent").subscribe(this,function(){return b._mapTipClosedEvent()})});this._gcxEventHandlers.push({eventName:"ClusterLayerRemovedEvent",token:this.app.event("ClusterLayerRemovedEvent").subscribe(this,function(a){return b._clusterLayerRemovedEvent(a)})});this._gcxEventHandlers.push({eventName:"LayerVisibilityChangedEvent",token:this.app.event("LayerVisibilityChangedEvent").subscribe(this,function(a){return b._layerVisibilityChangedEvent(a)})});this._gcxEventHandlers.push({eventName:"GeometryEditInvokedEvent",
token:this.app.event("GeometryEditInvokedEvent").subscribe(this,function(a){b.isClusterExploded()||b.recluster()})});this._gcxEventHandlers.push({eventName:"GeometryEditCompletedEvent",token:this.app.event("GeometryEditCompletedEvent").subscribe(this,function(a){return b._handleGeometryChange()})});this._gcxEventHandlers.push({eventName:"EditorClosedEvent",token:this.app.event("EditorClosedEvent").subscribe(this,function(){return b._handleEditorClosedEvent()})});this._esriEventHandlers.push(this.featureLayer.on("update-end",
function(a){b.isClusterExploded()||b.recluster()}))};d.prototype._handleGeometryChange=function(){this.isClusterExploded()?this.singleFeatureLayer.redraw():this.recluster()};d.prototype._handleEditorClosedEvent=function(){this.isClusterExploded()?this.singleFeatureLayer.redraw():this.recluster()};d.prototype._mapMouseDownEvent=function(a){var b=this;if(this.visible&&(!a.button||0===a.button)){var d=!1,c=!1,e=this.app.event("MapMouseUpEvent").once(this,function(a){d=!0}),s=dojo.connect(this.app.map,
"onDblClick",function(a){c=!0});setTimeout(function(){b.app.event("MapMouseUpEvent").unsubscribe(e);dojo.disconnect(s);d&&!c&&b._mapClickedEvent(a)},300)}};d.prototype._mapClickedEvent=function(a){if(this.visible&&null===this.app.toolRegistry.getActiveTool())if(this._clusterExploded)this._implodeCluster(),this._enableMapClick();else if(this._mapClickEnabled){this._isChrome&&this.recluster();var b=a&&a.graphic?a.graphic:null;if(b&&b.getLayer()===this&&b.attributes&&b.geometry instanceof esri.geometry.Point)if(this.app.command("CancelSearch").execute(),
this.app.command("DisableMapClick").execute(),b.attributes.clusterId&&b.attributes.clusterCount)this.onFeatureClicked(a);else this.app.command("ShowMapTip").execute(new l.Feature({graphic:b,layer:this.gcxLayer}))}else this._enableMapClick()};d.prototype._mapExtentChangedEvent=function(a,b){this._currExtent&&JSON.stringify(a.toJson())===JSON.stringify(this._currExtent.toJson())||(this._currExtent=a,this.featureLayer.visibleAtMapScale&&this.featureLayer.visible?(this.setVisibility(!0),!this.visible||
!this.featureLayer.visibleAtMapScale||this.isClusterExploded()&&this.hideClusters.get()!==f.ClusterHidingOptions.none||(this.isClusterExploded()&&this._enableMapClick(),this.recluster()),this._loadRenderer()):(this.setVisibility(!1),this._enableMapClick()))};d.prototype._mapTipClosedEvent=function(){this.visible&&(this._enableMapClick(),this.recluster())};d.prototype._clusterLayerRemovedEvent=function(a){a===this&&this.destroy()};d.prototype._layerVisibilityChangedEvent=function(a){var b=this;a.forEach(function(a){a.layer===
b.gcxLayer&&(b.setVisibility(a.visibility&&b.featureLayer.visibleAtMapScale),b._loadRenderer())})};d.prototype._loadRenderer=function(){var a=new esri.renderer.ClassBreaksRenderer(null,"clusterCount"),b=null;if(0<this.maxFeaturesInCluster.get())b=this.maxFeaturesInCluster.get();else for(var d=b=0;d<this._clusters.length;d++)this._clusters[d].attributes.clusterCount>b&&(b=this._clusters[d].attributes.clusterCount);d=Math.ceil(0.309999999999*b);1===d&&d++;var c=Math.ceil(0.31*b);c<=d&&(c=d+1);var e=
Math.ceil(0.609999999999*b);e<c&&(e=c);var s=Math.ceil(0.61*b);s<=e&&(s=e+1);var r=Math.ceil(0.909999999999*b);r<s&&(r=s);var l=Math.ceil(0.91*b);l<=r&&(l=r+1);this._addBreak(a,21,2,d,b,0);this._addBreak(a,28,c,e,b,1);this._addBreak(a,35,s,r,b,2);this._addBreak(a,42,l,Infinity,b,3);this.setRenderer(a)};d.prototype._addBreak=function(a,b,d,c,e,s){e>=d&&this.visible&&this.featureLayer.visibleAtMapScale?(d!==c?Infinity!==c?this.rendererInformation[s].rangeString.set(d+" - "+c):this.rendererInformation[s].rangeString.set(d+
"+"):this.rendererInformation[s].rangeString.set(d.toString()),this.rendererInformation[s].isVisible.set(!0)):this.rendererInformation[s].isVisible.set(!1);e=null;e=8===dojo.isIE?new esri.symbol.SimpleMarkerSymbol({color:this._clusterBackgroundColor.toRgba(),size:b,type:"esriSMS",style:"esriSMSCircle",outline:{color:this._makeTransparent(this._clusterBackgroundColor.toRgba()),width:8,type:"esriSLS",style:"esriSLSSolid"}}):new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,
b,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new esri.Color(this._makeTransparent(this._clusterBackgroundColor.toRgba())),8),this._clusterBackgroundColor);a.addBreak(d,c,e)};d.prototype._makeTransparent=function(a){4===a.length&&(a[3]=0.25);return a};d.prototype._isValidCluster=function(a,b,d){return Math.sqrt(Math.pow(b.x-a.x,2)+Math.pow(b.y-a.y,2))/d<=this.clusterRadius.get()&&this._isClusterFull(b)};d.prototype._isClusterFull=function(a){return a.attributes.clusterCount<
this.maxFeaturesInCluster.get()||0==this.maxFeaturesInCluster.get()||""==this.maxFeaturesInCluster.get().toString()};d.prototype._generateClusters=function(){this.clear();this._clusters=[];this._addGraphicsToClusters(!1);for(var a=[],b=0;b<this._clusters.length;b++)a[b]={x:this._clusters[b].x,y:this._clusters[b].y,attributes:{clusterCount:0,clusterId:this._clusters[b].attributes.clusterId,extent:this._clusters[b].attributes.extent}};this._clusters=a;this._addGraphicsToClusters(!0);this._showAllClusters()};
d.prototype._addGraphicsToClusters=function(a){for(var b=this._featureLayerGraphics.length,d=this.app.map.extent.getWidth()/this.app.map.width,c=0;c<b;c++){var e=null;if(this._featureLayerGraphics[c].geometry instanceof esri.geometry.Point&&this._featureLayerGraphics[c].visible)if(e=this._featureLayerGraphics[c].geometry,this.app.map.extent.contains(e)){for(var s=this._featureLayerGraphics[c],r=[],l=0;l<this._clusters.length;l++){var f=this._clusters[l];this._isValidCluster(e,f,d)&&r.push(f)}if(1===
r.length)this._clusterAddPoint(s,e,r[0],a);else if(1<r.length){f=[];for(l=0;l<r.length;l++)f[l]=Math.sqrt(Math.pow(r[l].x-e.x,2)+Math.pow(r[l].y-e.y,2));for(var k=null,h=null,l=0;l<f.length;l++)if(null===h||h>f[l])h=f[l],k=r[l];this._clusterAddPoint(s,e,k,a)}else this._createCluster(s,e)}else this._featureLayerGraphics[c].attributes.clusterId=-1}};d.prototype._showAllClusters=function(){0!=this.maxFeaturesInCluster.get()&&""!=this.maxFeaturesInCluster.get().toString()||this._loadRenderer();for(var a=
0,b=this._clusters.length;a<b;a++)this._showCluster(this._clusters[a])};d.prototype._showCluster=function(a){var b=new esri.geometry.Point(a.x,a.y,this.app.map.spatialReference),d=new esri.Graphic(b,null,a.attributes);d.setSymbol(this._getRenderedSymbol(d));this.add(d);2>a.attributes.clusterCount||(d=null,8===dojo.isIE?(d=new esri.symbol.TextSymbol({type:"esriTS",color:this._clusterLabelColor.toRgba(),xoffset:0,yoffset:-5,font:{family:this._fontFamily,size:this._fontSize,weight:"bold"}}),d.setText(a.attributes.clusterCount.toString())):
(d=new esri.symbol.TextSymbol(a.attributes.clusterCount),d.setColor(this._clusterLabelColor),d.setOffset(0,-5),d.setFont((new esri.symbol.Font(this._fontSize)).setFamily(this._fontFamily).setWeight(esri.symbol.Font.WEIGHT_BOLD))),a=new esri.Graphic(b,d,a.attributes),this.add(a))};d.prototype._getRenderedSymbol=function(a){if(1!==a.attributes.clusterCount)return null;var b=this.featureLayerRenderer;if(!b)return null;if(b instanceof esri.renderer.SimpleRenderer)return b.getSymbol(a);for(var d=0;d<this._featureLayerGraphics.length;d++){var c=
this._featureLayerGraphics[d];if(c.attributes.clusterId===a.attributes.clusterId)return b.getSymbol(c)}};d.prototype._clusterAddPoint=function(a,b,d,c){var e;c||(e=d.attributes.clusterCount,c=(b.x+d.x*e)/(e+1),e=(b.y+d.y*e)/(e+1),d.x=c,d.y=e);b.x<d.attributes.extent[0]?d.attributes.extent[0]=b.x:b.x>d.attributes.extent[2]&&(d.attributes.extent[2]=b.x);b.y<d.attributes.extent[1]?d.attributes.extent[1]=b.y:b.y>d.attributes.extent[3]&&(d.attributes.extent[3]=b.y);d.attributes.clusterCount++;b.hasOwnProperty("attributes")||
(b.attributes={});a.attributes.clusterId=b.attributes.clusterId=d.attributes.clusterId};d.prototype._createCluster=function(a,b){var d=this._clusters.length+1;a.attributes.clusterId=d;this._clusters.push({x:b.x,y:b.y,attributes:{clusterCount:1,clusterId:d,extent:[b.x,b.y,b.x,b.y]}})};d.prototype._enableMapClick=function(){var a=this;this.visible&&setTimeout(function(){a.app.command("CancelSearch").execute();a.app.command("EnableMapClick").execute();a._mapClickEnabled=!0},this.MAP_CLICK_PREVENTION_DELAY)};
d.prototype._disableMapClick=function(){var a=this;this.visible&&setTimeout(function(){a.app.command("DisableMapClick").execute();a._mapClickEnabled=!1},this.MAP_CLICK_PREVENTION_DELAY)};return d}(esri.layers.GraphicsLayer);f.ClusterLayer=h});
define("infrastructure/GraphicsLayerUtils",["require","exports","infrastructure/ClusterLayer","geocortex/essentials/utilities/GraphicsLayerUtilities"],function(h,f,k,l){function e(c,e,q,n){var p=q.map.getLayer(c);!p&&e?($.isNumeric(n)||(n=q.map.graphicsLayerIds.length-a-b-d),p=new esri.layers.GraphicsLayer,p.id=c,q.map.addLayer(p,n)):e=!1;return{layer:p,create:e}}function c(a,b){if(!b.clickableGraphics.isLayerRegistered(a)){var d={autoEditable:!0};d.displayName=b.getResource("Mapping.Infrastructure",
"language-clickable-graphics-label-drawing");b.clickableGraphics.register(a,d)}}f.ExcludeFromEnum={WebMapName:"WebMap",ExportApplyStateName:"ExportApplyState",ExportMapTaskName:l.excludeFromExportMapTaskName};f.GraphicsLayerType={Pushpin:"Pushpin",Label:"Label",Highlight:"Highlight",Markup:"Markup"};var a=0,b=0,d=0;f.getInternalGraphicsLayer=function(g,m,q,n){void 0===n&&(n=!0);if(!q)return g=e(g,!1,m,m.map.graphicsLayerIds.length-a-b-d),g.layer;if(q===f.GraphicsLayerType.Pushpin)return g=e(g,!0,
m,m.map.graphicsLayerIds.length),g.create&&a++,g.layer;if(q===f.GraphicsLayerType.Label)return g=e(g,!0,m,m.map.graphicsLayerIds.length-a),g.create&&b++,g.layer;if(q===f.GraphicsLayerType.Highlight)return g=e(g,!0,m,m.map.graphicsLayerIds.length-a-b),g.create&&d++,g.layer;if(q===f.GraphicsLayerType.Markup){q=n;n=m.map.graphicsLayerIds.length-a-b-d;var p=m.map.getLayer(g);p||($.isNumeric(n)||(n=m.map.graphicsLayerIds.length-1),p=new esri.layers.GraphicsLayer,p.id=g,m.map.addLayer(p,n));q&&c(p,m);return p}};
f.removeInternalGraphicsLayer=function(c,e,q){if(c=e.map.getLayer(c))e.map.removeLayer(c),q!==f.GraphicsLayerType.Pushpin||0!==a&&a--,q!==f.GraphicsLayerType.Highlight||0!==d&&d--,q!==f.GraphicsLayerType.Label||0!==b&&b--};f.registerMarkupLayerAsClickable=c;f.getGraphicsLayersExceptExcluded=function(a,b){var d=function(b){return a.site.essentialsMap.mapServices.some(function(a){return a.serviceLayer===b||a.serviceLayer instanceof esri.layers.KMLLayer&&0<=a.serviceLayer.getLayers().indexOf(b)})},c=
[];a.map.graphicsLayerIds.forEach(function(e){var s=a.map.getLayer(e);d(s)||s instanceof k.ClusterLayer||s.id.endsWith("-explodedClusterLayer")||0<=l.getGraphicsLayerIdsToExclude(b).indexOf(e)||c.push(s)});return c};f.addGraphicToLayer=function(a,b,d){return a&&(b=e(b,!1,d),b.layer)?(b.layer.add(a),b.layer.visible||b.layer.setVisibility(!0),!0):!1}});
define("infrastructure/GraphicUtils",["require","exports","infrastructure/GeometryUtils","infrastructure/GraphicsLayerUtils"],function(h,f,k,l){function e(a,b){return b&&a&&a.name&&(-1!==a.name.indexOf(".Name()",a.name.length-7)||b.getFieldByName(a.name+".Name()"))?!0:!1}function c(b,d,c,g,e,m,n,p){void 0===e&&(e=!1);void 0===p&&(p="Mapping");var q=[],s=[],r=0,l={},f=function(){for(var a=0;a<q.length;a++)if(q[a].visible)if(e&&!q[a].hasOwnProperty("measurementId"))q.splice(a,1);else{var b=q[a].getLayer();
b&&b.remove(q[a])}else q.splice(a,1)};if(b&&d&&d.length&&c){for(var k=0;k<d.length;k++){var t=c.map.getLayer(d[k]);t&&s.push(t)}if(s.length){for(d=0;d<s.length;d++)(k=a(b,s[d],c))&&k.length&&(q=q.concat(k));for(b=0;b<q.length&&!(s=q[b],s.visible&&(s.hasOwnProperty("measurementId")?l.hasOwnProperty(s.measurementId)||(l[s.measurementId]=!0,r++):e||r++),1<r);b++);0===r?g&&g(q):1!==r&&m?(m=c.getResource(p,m),n=n?c.getResource(p,n):null,c.command("Confirm").execute(m,n,function(a){a?f():q=[];g&&g(q)})):
(f(),g&&g(q))}else c.trace.error("Error deleting markup. No graphics layer(s) found."),g&&g(q)}else c?c.trace.error("Error deleting markup. Required parameters missing."):console.log("Error deleting markup. Required parameters missing."),g&&g(q)}function a(a,c,g,e,p){void 0===p&&(p=6);var s=null,r=[];if(!a||!c||!g)return g?g.trace.error("Error retrieving markup. Required parameters missing."):console.log("Error retrieving markup. Required parameters missing."),r;if(!c.graphics.length)return r;s=b(a,
g,p);if(null==s)return g.trace.error("Error retrieving markup. Could not compute extent."),r;a=c.graphics;for(p=0;p<a.length;p++)if(s.intersects(a[p].geometry))r.push(c.graphics[p]);else if(a[p].symbol instanceof esri.symbol.SimpleMarkerSymbol||a[p].symbol instanceof esri.symbol.PictureMarkerSymbol)if(a[p].geometry instanceof esri.geometry.Point)s.intersects(d(a[p],a[p].symbol,g,e||n(a[p],g)))&&r.push(c.graphics[p]);else{if(a[p].geometry instanceof esri.geometry.Multipoint)for(var l=m(a[p],g,e||n(a[p],
g)),f=0;f<l.length;f++)if(s.intersects(l[f])){r.push(c.graphics[p]);break}}else a[p].symbol instanceof esri.symbol.TextSymbol&&s.intersects(q(a[p],a[p].symbol,g))&&r.push(c.graphics[p]);return r}function b(a,b,d){var c=null;"point"==a.type?c=r(a,d,b).getExtent():"polyline"==a.type?c=a.getExtent():"polygon"==a.type&&(c=a.getExtent());null==c&&b.trace.error("Could not compute extent.");return c}function d(a,b,d,c){return r(a.geometry,c,d,b.xoffset,b.yoffset)}function g(a,b,d,c){a=a.geometry;var g=a.spatialReference,
e=new esri.geometry.Polygon(g);a.points.forEach(function(a){a=new esri.geometry.Point(a,g);r(a,c,d,b.xoffset,b.yoffset).rings.forEach(function(a){e.addRing(a)})});return e}function m(a,b,d){for(var c=a.geometry,g=[],e=0;e<c.points.length;e++){var m=new esri.geometry.Point(c.points[e],c.spatialReference);g.push(r(m,d,b,a.symbol.xoffset,a.symbol.yoffset))}return g}function q(a,b,d){var c=d.map.toScreen(a.geometry),g=t(b.text,b.font.family,b.font.size,b.font.weight),e=g.height,g=g.width;c.x+=b.xoffset;
c.y-=b.yoffset;switch(b.align){case esri.symbol.TextSymbol.ALIGN_START:var m=new esri.geometry.Point(c.x,c.y-e,null),n=new esri.geometry.Point(c.x+g,c.y-e,null),p=new esri.geometry.Point(c.x,c.y,null),q=new esri.geometry.Point(c.x+g,c.y,null);break;case esri.symbol.TextSymbol.ALIGN_MIDDLE:m=new esri.geometry.Point(c.x-g/2,c.y-e,null);n=new esri.geometry.Point(c.x+g/2,c.y-e,null);p=new esri.geometry.Point(c.x-g/2,c.y,null);q=new esri.geometry.Point(c.x+g/2,c.y,null);break;case esri.symbol.TextSymbol.ALIGN_END:m=
new esri.geometry.Point(c.x-g,c.y-e,null),n=new esri.geometry.Point(c.x,c.y-e,null),p=new esri.geometry.Point(c.x-g,c.y,null),q=new esri.geometry.Point(c.x,c.y,null)}m=d.map.toMap(m);n=d.map.toMap(n);p=d.map.toMap(p);q=d.map.toMap(q);d=new esri.geometry.Polygon({rings:[[[m.x,m.y],[n.x,n.y],[q.x,q.y],[p.x,p.y]]],spatialReference:m.spatialReference});return d=s(b.angle,a.geometry,d)}function n(a,b){if(!a)return b&&b.trace.error("cound not compute size of bounding box."),null;var d;d=a.symbol;var c=
0,g=0;if(!d&&a.getLayer()&&a.getLayer().renderer){var e=a.getLayer().renderer;d=e.getSymbol(a);c=e.getSize(a);try{g=e.getRotationAngle(a)}catch(m){}}if(d instanceof esri.symbol.SimpleMarkerSymbol)c||(c=d.size),c+=d.outline?d.outline.width:0;else if(d instanceof esri.symbol.PictureMarkerSymbol)c||(c=Math.max(d.height,d.width));else return b&&b.trace.error("cound not compute size of bounding box"),null;!g&&d.angle&&(g=d.angle);g&&(g=p(g),c*=Math.abs(Math.sin(g))+Math.abs(Math.cos(g)));return c}function p(a){return Math.PI/
180*a}function s(a,b,d){d=new esri.geometry.Polygon(d.toJson());a=Math.PI/180*(360-(0>a?360+a:a)%360);for(var c=0;c<d.rings.length;c++)for(var g=0;g<d.rings[c].length;g++){var e=d.getPoint(c,g),m=(e.x-b.x)*Math.cos(a)-(e.y-b.y)*Math.sin(a)+b.x,n=(e.x-b.x)*Math.sin(a)+(e.y-b.y)*Math.cos(a)+b.y;e.setX(m);e.setY(n);d.setPoint(c,g,e)}return d}function r(a,b,d,c,g){b=parseFloat(b);a=d.map.toScreen(a);b/=2;a.x+=c||0;a.y-=g||0;c=new esri.geometry.Point(a.x-b,a.y-b,null);g=new esri.geometry.Point(a.x+b,a.y-
b,null);var e=new esri.geometry.Point(a.x-b,a.y+b,null);a=new esri.geometry.Point(a.x+b,a.y+b,null);c=d.map.toMap(c);g=d.map.toMap(g);e=d.map.toMap(e);a=d.map.toMap(a);return new esri.geometry.Polygon({rings:[[[c.x,c.y],[g.x,g.y],[a.x,a.y],[e.x,e.y],[c.x,c.y]]],spatialReference:c.spatialReference})}function t(a,b,d,c){void 0===c&&(c="normal");var g=document.body,e=document.createElement("div");b={fontFamily:b,fontSize:void 0!=d&&"number"===typeof d?d+"px":d,fontWeight:c,padding:"0",position:"absolute",
lineHeight:"1",visibility:"hidden"};for(var m in b)e.style[m]=b[m];e.appendChild(document.createTextNode(a));g.appendChild(e);a={width:e.clientWidth,height:e.clientHeight};g.removeChild(e);return a}function u(a,b){var d=null,c=b?b.getLayer():null;c&&c instanceof esri.layers.GraphicsLayer&&a.clickableGraphics.isLayerRegistered(c)&&(d=a.clickableGraphics.getLayerInfo(c));return d}function v(a,b,d){var c=[];d||(d=u(a,b));d&&"function"===typeof d.canEdit&&d.canEdit(b)&&c.push("edit");d&&"function"===
typeof d.canDelete&&d.canDelete(b)&&c.push("delete");d&&"function"===typeof d.canChangeStyles&&d.canChangeStyles(b)&&c.push("style");return c}function y(a,b){return b&&b.some(function(b){return b==a})}var x={};f.sanitizeAttributeNames=function(a,b){var d=b.mapService?"{0}.{1}".format(b.mapService.id,b.id):null,c;if(d&&x[d])c=x[d];else{c={};for(var g=0;g<b.fields.length;g++){var m=b.fields[g];e(m,b)||(c[m.alias]=m.name)}d&&(x[d]=c)}var d=[],n;for(n in c)c.hasOwnProperty(n)&&a.attributes.hasOwnProperty(n)&&
("Null"===a.attributes[n]&&(a.attributes[n]=null),g=a.attributes[n],void 0!==g&&(g={alias:n,name:c[n],value:g},g.alias!=g.name&&d.push(g)));for(c=0;c<d.length;c++)n=d[c],delete a.attributes[n.alias],a.attributes[n.name]=n.value};f._isSEPCodedDomainField=e;f.deleteMarkupSilently=function(a,b,d,g,e){void 0===e&&(e=!1);c(a,b,d,g,e)};f.deleteMarkup=c;f.getMarkupFromGeometry=a;f.getExtentFromGeometry=b;f.geometryIntersectsGraphic=function(a,b,c){return new Promise(function(e,m){k.intersects(a,b.geometry).then(function(p){p?
e(!0):(p=b.symbol,!p&&b.getLayer()&&b.getLayer().renderer&&(p=b.getLayer().renderer.getSymbol(b)),p instanceof esri.symbol.SimpleMarkerSymbol||p instanceof esri.symbol.PictureMarkerSymbol?b.geometry instanceof esri.geometry.Point?k.intersects(a,d(b,p,c,n(b,c))).then(function(a){e(a)},function(a){m(a)}):b.geometry instanceof esri.geometry.Multipoint&&(p=g(b,p,c,n(b,c)),k.intersects(a,p).then(function(a){e(a)},function(a){m(a)})):p instanceof esri.symbol.TextSymbol?k.intersects(a,q(b,p,c)).then(function(a){e(a)},
function(a){m(a)}):e(!1))},function(a){m(a)})})};f._getEnhancedGeometryOfPointGraphic=d;f._getenhancedPolygonGeometryOfMultipoint=g;f._getEnhancedGeometriesOfMultiPoint=m;f._getEnhancedGeometryOfTextGraphic=q;f.getBoundingBoxSize=n;f._toRadians=p;f.rotatePolygon=s;f.getPolygonFromPoint=r;f.getRenderedTextMarkupSize=t;f.moveGraphicToTop=function(a){a&&(a=a.getDojoShape())&&a.moveToFront()};f.isClickableGraphic=function(a,b){if(b){var d=b.getLayer();if(d&&d instanceof esri.layers.GraphicsLayer&&a.clickableGraphics.isLayerRegistered(d))return!0}return!1};
f.isEditableButNotAutoEditableClickableFeature=function(a,b){if(b&&b.esriFeature.get()&&b.esriFeature.get().geometry){var d=u(a,b.esriFeature.get()),c=v(a,b.esriFeature.get(),d),c=y("edit",c),d=d&&d.autoEditable;return c&&!d}return!1};f.isAutoEditableClickableFeature=function(a,b){if(b&&b.esriFeature.get()&&b.esriFeature.get().geometry){var d=u(a,b.esriFeature.get()),c=v(a,b.esriFeature.get(),d),c=y("edit",c),d=d&&d.autoEditable;return c&&d}return!1};f.getClickableLayerInfo=u;f.getCapabilitiesForGraphic=
v;f.getGraphicsLayer=function(a,b,d){return b?l.getInternalGraphicsLayer(a,d,l.GraphicsLayerType.Markup):l.getInternalGraphicsLayer(a,d)};f.getMarkupLayer=function(a,b){return l.getInternalGraphicsLayer(a,b,l.GraphicsLayerType.Markup)};f.getUserGraphicsLayers=function(a){var b=["snapping_graphics","snapping_helper_graphics","DefaultPushpinsLayer"],d=a.highlightManager.getHighlightLayers(),c;for(c in d)b.push(d[c].id);return l.getGraphicsLayersExceptExcluded(a,b)};f.addGraphicToLayer=function(a,b,
d){return l.addGraphicToLayer(a,b,d)}});
define("infrastructure/accessibility/Edit","require exports infrastructure/accessibility/AccessibleMapComponent infrastructure/accessibility/GraphicMover infrastructure/accessibility/BoxEditor infrastructure/tools/MapTool infrastructure/tools/DrawMode geocortex/framework/utils/utils infrastructure/accessibility/InputMethod infrastructure/accessibility/VertexEditorFactory infrastructure/GraphicUtils".split(" "),function(h,f,k,l,e,c,a,b,d,g,m){var q=function(n){function p(a,b,d){d=n.call(this,a,d)||
this;d._editObject=null;d._options=null;d._defaultOptions=null;d._tool=0;d._isTextPoint=!1;d._editHandle=[];d._isGeo=!1;d._active=!1;d._modified=!1;d._cancelled=!1;d._needsRefresh=!1;d._handles=[];d._snappingFeedbackEventToken=null;d._lastSnapPoint=null;d._graphicMover=null;d._vertexEditor=null;d._boxEditor=null;d._symbolChangeHandle=null;d._editNotificationViewId="edit-notification-view";var c=Modernizr&&!!Modernizr.touch,c={vertexSymbol:new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,
c?20:12,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new esri.Color([0,0,0,0.5]),1),new esri.Color([128,128,128])),ghostVertexSymbol:new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,c?18:10,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new esri.Color([0,0,0,0.5]),1),new esri.Color([255,255,255,0.75])),ghostLineSymbol:new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_DOT,new esri.Color([128,128,
128]),2),allowDeleteVertices:!0,allowAddVertices:!0,narrateKeyboardShortcuts:!0,rotateHandleOffset:c?24:16,boxLineSymbol:new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_DASH,new esri.Color([64,64,64]),1),boxHandleSymbol:new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_SQUARE,c?16:9,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new esri.Color([0,0,0,0.5]),1),new esri.Color([255,255,255,0.75])),textAnchorSymbol:new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,
10,null,new esri.Color([255,0,0])),selectedVertexSymbol:new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,c?25:15,null,new esri.Color([0,0,255,0.75]))};d._defaultOptions=dojo.mixin(c,b||{});d._editObject=new esri.toolbars.Edit(a,b);d._addPointerEventsOnRedraw();return d}__extends(p,n);p.prototype._addPointerEventsOnRedraw=function(){var a=this;this.app.site.getMap().graphics.on("graphic-draw",function(b){if(a._editHandle&&0<a._editHandle.length)for(var d=0;d<a._editHandle.length;d++)b.graphic===
a._editHandle[d]&&$(a._editHandle[d].getNode()).css("pointer-events","none")})};p.prototype.activate=function(a,b,d){var c=this;this.deactivate();this.app&&(this._snappingFeedbackEventToken=this.app.event("SnappingFeedbackEvent").subscribe(this,function(a){c._lastSnapPoint=a&&a.snappingPoint?a.snappingPoint:null}));this._active=!0;this._graphic=b;this._tool=a;this._options=dojo.mixin(dojo.mixin({},this._defaultOptions),d||{});if(0<a){d=this._map.spatialReference;var g=b&&b.geometry?b.geometry.spatialReference:
null;this._isGeo=d&&g&&!d.equals(g)&&d.isWebMercator()&&4326===g.wkid;this._isTextPoint=b&&b.geometry&&"point"===b.geometry.type?(d=this._getSymbol(b))&&"textsymbol"===d.type:!1;b&&b.geometry&&"multipoint"===b.geometry.type&&(this._options.allowAddVertices=!1);this._handles.push(dojo.aspect.after(this._editObject,"onGraphicClick",dojo.hitch(this,"_onGraphicClickImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,"onGraphicFirstMove",dojo.hitch(this,"_onGraphicFirstMoveImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,
"onGraphicMove",dojo.hitch(this,"_onGraphicMoveImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,"onGraphicMoveStart",dojo.hitch(this,"_onGraphicMoveStartImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,"onGraphicMoveStop",dojo.hitch(this,"_onGraphicMoveStopImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,"onRotate",dojo.hitch(this,"_onRotateImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,"onRotateFirstMove",dojo.hitch(this,"_onRotateFirstMoveImpl"),
!0));this._handles.push(dojo.aspect.after(this._editObject,"onRotateStart",dojo.hitch(this,"_onRotateStartImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,"onRotateStop",dojo.hitch(this,"_onRotateStopImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,"onScale",dojo.hitch(this,"_onScaleImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,"onScaleFirstMove",dojo.hitch(this,"_onScaleFirstMoveImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,
"onScaleStart",dojo.hitch(this,"_onScaleStartImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,"onScaleStop",dojo.hitch(this,"_onScaleStopImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,"onVertexAdd",dojo.hitch(this,"_onVertexAddImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,"onVertexClick",dojo.hitch(this,"_onVertexClickImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,"onVertexDelete",dojo.hitch(this,"_onVertexDeleteImpl"),!0));
this._handles.push(dojo.aspect.after(this._editObject,"onVertexFirstMove",dojo.hitch(this,"_onVertexFirstMoveImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,"onVertexMouseOut",dojo.hitch(this,"_onVertexMouseOutImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,"onVertexMouseOver",dojo.hitch(this,"_onVertexMouseOverImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,"onVertexMove",dojo.hitch(this,"_onVertexMoveImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,
"onVertexMoveStart",dojo.hitch(this,"_onVertexMoveStartImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,"onVertexMoveStop",dojo.hitch(this,"_onVertexMoveStopImpl"),!0));this._symbolChangeHandle=this.app.event("GraphicSymbolChangedEvent").subscribe(this,this._updateSizePointEditHandles);this.activateMouseControls();this.activateKeyboardControls();var e=g=d=!1;(a&p.MOVE)===p.MOVE&&(d=this._enableMove(b));var m=(a&p.SCALE)===p.SCALE,n=(a&p.ROTATE)===p.ROTATE;if(m||n)g=this._enableBoxEditing(b,
m,n);(a&p.EDIT_VERTICES)===p.EDIT_VERTICES&&(e=this._enableVertexEditing(b));if(!d&&!g&&!e)throw Error("[esri.toolbars.Edit::activate] Unable to activate the tool. Check if the tool is valid for the given geometry type.");this.onKeyboardStart();this._updateToolStatusMessage();this._addPointEditHandles(b);this.onActivate(a,b);this.raiseGraphicEditActivated({sender:this,graphic:b,tool:a})}};p.prototype._addPointEditHandles=function(a){if(a.getLayer()!=this.app.map.graphics&&this._graphic==a&&0<this._tool&&
("point"===a.geometry.type||"multipoint"===a.geometry.type)){var b;b=a.getLayer().renderer;var d;b=a.symbol?a.symbol:b.getSymbol(a);if("textsymbol"!==b.type){d=m.getBoundingBoxSize(a,this.app);d*=1.5;44>d&&(d=44);var c=d/4;this._editHandle.push(this._getTargetGraphic(a,b,d,c,esri.symbol.SimpleLineSymbol.STYLE_SOLID,new esri.Color("#FFFFFF")));this._editHandle.push(this._getTargetGraphic(a,b,d,c,esri.symbol.SimpleLineSymbol.STYLE_DASH,new esri.Color("#000000")));a=this.app.site.getMap().graphics;a.add(this._editHandle[0]);
a.add(this._editHandle[1]);$(this._editHandle[0].getNode()).css("pointer-events","none");$(this._editHandle[1].getNode()).css("pointer-events","none")}}};p.prototype._calculatePath=function(a,b){var d=a/2;return"M 0 0 "+a+" 0 "+a+" "+a+" 0 "+a+" 0 0M "+(0-b)+" "+d+" 0 "+d+"M "+d+" "+(a+b)+" "+d+" "+a+"M "+(a+b)+" "+d+" "+a+" "+d+"M "+d+" 0 "+d+" "+(0-b)};p.prototype._getTargetGraphic=function(a,b,d,c,g,e){var m=new esri.Graphic;m.setGeometry(esri.geometry.fromJson(a.geometry.toJson()));a=new esri.symbol.SimpleMarkerSymbol;
a.setOutline(new esri.symbol.SimpleLineSymbol(g,e,2));a.setColor(new esri.Color([0,0,0,0]));a.setPath(this._calculatePath(d,c));a.setSize(d);b&&a.setOffset(b.xoffset||0,b.yoffset||0);m.setSymbol(a);return m};p.prototype.deactivate=function(){var b=this._tool;this._active=!1;this.app&&this._snappingFeedbackEventToken&&(this.app.event("SnappingFeedbackEvent").unsubscribe(this._snappingFeedbackEventToken),this._snappingFeedbackEventToken=null);if(0<b){var d=this._modified,g=this._cancelled,e=this._graphic;
this._graphicMover&&this._graphicMover.hasMoved()&&this._adjustGraphicMoverPoint(e,this._lastSnapPoint);this._symbolChangeHandle&&this.app.event("GraphicSymbolChangedEvent").unsubscribe(this._symbolChangeHandle);this._symbolChangeHandle=null;this._removePointEditHandles(e);this._clear();this._graphic=null;this._isGeo=this._isTextPoint=!1;this.deactivateMouseControls();this.deactivateKeyboardControls();if(this.app.toolRegistry&&this.app.toolRegistry.getActiveTool){var m=this.app.toolRegistry.getActiveTool();
m instanceof c.MapTool&&m.drawMode===a.DrawMode.EXTENT&&e.setGeometry(this._convertPolygonToExtent(e.geometry))}this.onDeactivate(b,e,{isModified:d,cancelled:g});this.raiseGraphicEditDeactivated({sender:this,graphic:e,tool:b,isModified:d,cancelled:g})}};p.prototype._removePointEditHandles=function(a){if(this._graphic===a&&0!=this._editHandle.length){var b=this.app.site.getMap().graphics;this._editHandle.forEach(function(a){return b.remove(a)});this._editHandle=[]}};p.prototype._hidePointEditHandles=
function(a){this._graphic===a&&0!=this._editHandle.length&&this._editHandle.forEach(function(a){return a.hide()})};p.prototype._showPointEditHandles=function(a){this._graphic===a&&0!=this._editHandle.length&&(this._editHandle.forEach(function(a){return a.show()}),$(this._editHandle[0].getNode()).css("pointer-events","none"),$(this._editHandle[1].getNode()).css("pointer-events","none"))};p.prototype._updateLocationPointEditHandles=function(a){this._graphic===a&&0!=this._editHandle.length&&this._editHandle.forEach(function(b){b.setGeometry(esri.geometry.fromJson(a.geometry.toJson()))})};
p.prototype._updateSizePointEditHandles=function(a){this._graphic!==a||a.symbol instanceof esri.symbol.TextSymbol||(this._removePointEditHandles(a),this._addPointEditHandles(a))};p.prototype._convertPolygonToExtent=function(a){if(a.getExtent)return a.getExtent();this.app.trace.warning("Tried to convert polygon to extent, but failed. Polygon object lacks getExtent() method.");return null};p.prototype.getOptions=function(){return this._options||this._defaultOptions||{}};p.prototype.getCurrentState=
function(){return{tool:this._tool,graphic:this._graphic,isModified:this._modified}};p.prototype.getEnabledTools=function(){return[this._graphicMover,this._boxEditor,this._vertexEditor].filter(function(a){return!b.isNullOrUndefined(a)})};p.prototype.refresh=function(){this._editObject.refresh();this._needsRefresh=!1;this._updateLocationPointEditHandles(this._graphic)};p.prototype.setNeedsRefresh=function(a){this._needsRefresh=a};p.prototype.suspend=function(){n.prototype.suspend.call(this);this.getEnabledTools().forEach(function(a){return a.suspend()})};
p.prototype.resume=function(){n.prototype.resume.call(this);this.getEnabledTools().forEach(function(a){return a.resume()})};p.prototype.isActive=function(){return this._active};p.prototype.activateMouseControls=function(a){void 0===a&&(a=!0);n.prototype.activateMouseControls.call(this,a);if(0<this._tool)this._editObject.__attached_stopEvent=!0,this._editObject.activate(this._tool,this._graphic,this._options);else throw Error("[esri.toolbars.Edit::activate] Unable to activate the tool. Check if the tool is valid for the given geometry type.");
};p.prototype.deactivateMouseControls=function(a){void 0===a&&(a=!0);n.prototype.deactivateMouseControls.call(this,a);this._editObject.__attached_stopEvent=!0;this._editObject.deactivate()};p.prototype.on=function(a,b){throw Error("[geocortex.essentialsHtmlViewer.mapping.infrastructure.accessibility.Edit] On style events not implemented yet. Use connect instead.");};p.prototype.onActivate=function(a,b){};p.prototype.onDeactivate=function(a,b,d){};p.prototype.onGraphicClick=function(a,b){};p.prototype._onGraphicClickImpl=
function(a,b){this.onGraphicClick(a,b)};p.prototype.onGraphicFirstMove=function(a){this._modified=!0};p.prototype._onGraphicFirstMoveImpl=function(a){this.suspend();null!==this._vertexEditor&&this._vertexEditor.isActive()&&this._vertexEditor.hideVertexHandle();this.onGraphicFirstMove(a)};p.prototype.onGraphicMove=function(a,b){};p.prototype._onGraphicMoveImpl=function(a,b){this.onGraphicMove(a,b)};p.prototype.onGraphicMoveStart=function(a){};p.prototype._onGraphicMoveStartImpl=function(a){a&&a.geometry&&
"point"==a.geometry.type&&this._hidePointEditHandles(a);this.onGraphicMoveStart(a)};p.prototype.onGraphicMoveStop=function(a,b){var d={graphic:a};this.app.eventRegistry.event("GeometryChangedEvent").publish(d)};p.prototype._onGraphicMoveStopImpl=function(a,b){this.resume();null!==this._vertexEditor&&this._vertexEditor.isActive()&&(this.suspend(),this._vertexEditor.resume(),this._vertexEditor.refresh(),this._vertexEditor.showVertexHandle());a&&a.geometry&&"point"==a.geometry.type&&(this._updateLocationPointEditHandles(a),
this._showPointEditHandles(a));this.onGraphicMoveStop(a,b)};p.prototype.onRotate=function(a,b){};p.prototype._onRotateImpl=function(a,b){this.onRotate(a,b)};p.prototype.onRotateFirstMove=function(a){this._modified=!0};p.prototype._onRotateFirstMoveImpl=function(a){this.suspend();null!==this._vertexEditor&&this._vertexEditor.isActive()&&this._vertexEditor.hideVertexHandle();this.onRotateFirstMove(a)};p.prototype.onRotateStart=function(a){};p.prototype._onRotateStartImpl=function(a){this.onRotateStart(a)};
p.prototype.onRotateStop=function(a,b){var d={graphic:a};this.app.eventRegistry.event("GeometryChangedEvent").publish(d)};p.prototype._onRotateStopImpl=function(a,b){this.resume();null!==this._vertexEditor&&this._vertexEditor.isActive()&&(this.suspend(),this._vertexEditor.resume(),this._vertexEditor.refresh(),this._vertexEditor.showVertexHandle());this.onRotateStop(a,b)};p.prototype.onScale=function(a,b){};p.prototype._onScaleImpl=function(a,b){this.onScale(a,b)};p.prototype.onScaleFirstMove=function(a){this._modified=
!0};p.prototype._onScaleFirstMoveImpl=function(a){this.suspend();null!==this._vertexEditor&&this._vertexEditor.isActive()&&this._vertexEditor.hideVertexHandle();this.onScaleFirstMove(a)};p.prototype.onScaleStart=function(a){};p.prototype._onScaleStartImpl=function(a){this.onScaleStart(a)};p.prototype.onScaleStop=function(a,b){var d={graphic:a};this.app.eventRegistry.event("GeometryChangedEvent").publish(d)};p.prototype._onScaleStopImpl=function(a,b){this.resume();null!==this._vertexEditor&&this._vertexEditor.isActive()&&
(this.suspend(),this._vertexEditor.resume(),this._vertexEditor.refresh(),this._vertexEditor.showVertexHandle());this.onScaleStop(a,b)};p.prototype.onVertexAdd=function(a,b){this._modified=!0;null!==this._vertexEditor&&this._vertexEditor.isActive()&&(this._vertexEditor.refresh(!0),this._vertexEditor.onVertexAdd(b),this._vertexEditor.showVertexHandle())};p.prototype._onVertexAddImpl=function(a,b){this.onVertexAdd(a,b)};p.prototype.onVertexClick=function(a,b){};p.prototype._onVertexClickImpl=function(a,
b){this.onVertexClick(a,b)};p.prototype.onVertexDelete=function(a,b){this._modified=!0;null!==this._vertexEditor&&this._vertexEditor.isActive()&&(this._vertexEditor.refresh(!0),this._vertexEditor.onVertexDelete(b),this._vertexEditor.showVertexHandle())};p.prototype._onVertexDeleteImpl=function(a,b){this.onVertexDelete(a,b)};p.prototype.onVertexFirstMove=function(a,b){this._modified=!0};p.prototype._onVertexFirstMoveImpl=function(a,b){this.suspend();null!==this._vertexEditor&&this._vertexEditor.isActive()&&
this._vertexEditor.hideVertexHandle();this.onVertexFirstMove(a,b)};p.prototype.onVertexMouseOut=function(a,b){};p.prototype._onVertexMouseOutImpl=function(a,b){this.onVertexMouseOut(a,b)};p.prototype.onVertexMouseOver=function(a,b){};p.prototype._onVertexMouseOverImpl=function(a,b){this.onVertexMouseOver(a,b)};p.prototype.onVertexMove=function(a,b,d){b&&b.graphic&&this.app.event("EditVertexHandleMovedEvent").publish(b.graphic)};p.prototype._onVertexMoveImpl=function(a,b,d){this.onVertexMove(a,b,d)};
p.prototype.onVertexMoveStart=function(a,b){};p.prototype._onVertexMoveStartImpl=function(a,b){a&&a.geometry&&"multipoint"==a.geometry.type&&this._hidePointEditHandles(a);this.onVertexMoveStart(a,b)};p.prototype.onVertexMoveStop=function(a,b,d){null!==this._vertexEditor&&this._vertexEditor.isActive()&&!b.isGhost&&(this._vertexEditor.refresh(),this._vertexEditor.showVertexHandle());a={graphic:a};this.app.eventRegistry.event("GeometryChangedEvent").publish(a)};p.prototype._onVertexMoveStopImpl=function(a,
b,d){this.resume();null!==this._vertexEditor&&this._vertexEditor.isActive()&&(this.suspend(),this._vertexEditor.resume());a&&a.geometry&&"multipoint"==a.geometry.type&&(this._updateLocationPointEditHandles(a),this._showPointEditHandles(a));this.onVertexMoveStop(a,b,d)};p.prototype.onKeyboardStart=function(){n.prototype.onKeyboardStart.call(this)};p.prototype.onKeyboardStop=function(a){void 0===a&&(a=!1);n.prototype.onKeyboardStop.call(this,a);this._cancelled=a;this.deactivate()};p.prototype._onKeyDown=
function(a){n.prototype._onKeyDown.call(this,a);if(!this.suspended&&this._active&&this.inputMethod!==d.InputMethod.MOUSE){var b=!1;switch(a.keyCode||a.which){case dojo.keys.ENTER:case dojo.keys.NUMPAD_ENTER:this.toggleKeyboardMode();b=!0;break;case dojo.keys.ESCAPE:this.onKeyboardStop(!0),b=!0}b&&(a.preventDefault(),a.stopPropagation())}};p.prototype.raiseGraphicEditActivated=function(a){this.app.event("GraphicEditActivatedEvent").publish(a)};p.prototype.raiseGraphicEditDeactivated=function(a){this.app.event("GraphicEditDeactivatedEvent").publish(a)};
p.prototype._updateToolStatusMessage=function(){if(this._graphic&&this._graphic.geometry&&"point"!==this._graphic.geometry.type){var a=null;if(this.app.toolRegistry&&this.app.toolRegistry.getActiveTool()){var b=this.app.toolRegistry.getActiveTool(),d=this.app.getResource("Mapping.Infrastructure","language-toolbar-markup-edit-zoomin-tool"),c=this.app.getResource("Mapping.Infrastructure","language-toolbar-markup-edit-zoomout-tool");if(b.name===d||b.name===c)a=this.app.getResource("Mapping.Infrastructure",
"language-toolbar-markup-edit-desc-shortcuts-zoom")}a&&(b={id:this._editNotificationViewId,text:a,closeButton:{}},this.app.command("DisplayNotification").execute(b),this._options.narrateKeyboardShortcuts&&this.app.command("ScreenReaderNarrate").execute(a))}};p.prototype._clear=function(){this._disableMove();this._disableBoxEditing();this._disableVertexEditing();this._tool=0;this.suspended=this._cancelled=this._modified=!1;this.setInputMethod(null)};p.prototype._getSymbol=function(a){if(a){var b=a.symbol;
if(b)return b;if(b=a.getLayer()?a.getLayer().renderer:null)return b.getSymbol(a)}return null};p.prototype._enableMove=function(a){switch(a.geometry.type){case "point":return this._graphicMover=new l.GraphicMover(a,this._map,this,this._isTextPoint&&this._editObject._textAnchor?this._editObject._textAnchor:null),!0;case "polyline":case "polygon":return this._graphicMover=new l.GraphicMover(a,this._map,this,null),!0}return!1};p.prototype._enableBoxEditing=function(a,b,d){b={scaleEnabled:b,rotateEnabled:d,
uniformScaling:this._options.uniformScaling,boxHandleSymbol:this._options.boxHandleSymbol,boxLineSymbol:this._options.boxLineSymbol};return this._isTextPoint||-1<["polyline","polygon"].indexOf(a.geometry.type)?(this._boxEditor=new e.BoxEditor(a,this._map,this,this._isTextPoint,b),!0):!1};p.prototype._enableVertexEditing=function(a){var b={allowAddVertices:this._options.allowAddVertices,allowDeleteVertices:this._options.allowDeleteVertices,selectedVertexSymbol:this._options.selectedVertexSymbol};switch(a.geometry.type){case "multipoint":case "polyline":case "polygon":return this._vertexEditor=
g.createVertexEditor(a,this._map,this,b),!0}return!1};p.prototype._adjustGraphicMoverPoint=function(a,b){b&&a&&b instanceof esri.geometry.Point&&a.geometry instanceof esri.geometry.Point&&a.setGeometry(b)};p.prototype._disableMove=function(){this._graphicMover&&(this._graphicMover.destroy(),this._graphicMover=null)};p.prototype._disableBoxEditing=function(){this._boxEditor&&(this._boxEditor.destroy(),this._boxEditor=null)};p.prototype._disableVertexEditing=function(){this._vertexEditor&&(this._vertexEditor.destroy(),
this._vertexEditor=null)};return p}(k.AccessibleMapComponent);q._edit=function(){h(["esri/toolbars/edit"],function(a){q.EDIT_TEXT=a.EDIT_TEXT;q.EDIT_VERTICES=a.EDIT_VERTICES;q.MOVE=a.MOVE;q.ROTATE=a.ROTATE;q.SCALE=a.SCALE})}();f.Edit=q});define("infrastructure/eventArgs/GraphicDrawActivatedEventArgs",["require","exports"],function(h,f){});define("infrastructure/eventArgs/GraphicDrawDeactivatedEventArgs",["require","exports"],function(h,f){});
define("infrastructure/eventArgs/GraphicVertexAddedEventArgs",["require","exports"],function(h,f){});define("infrastructure/eventArgs/GraphicVertexMovedEventArgs",["require","exports"],function(h,f){});
define("infrastructure/accessibility/Draw","require exports infrastructure/accessibility/AccessibleMapComponent infrastructure/accessibility/Edit infrastructure/accessibility/InputMethod infrastructure/GeometryUtils".split(" "),function(h,f,k,l,e,c){var a=function(a){function g(c,g,e){var p=a.call(this,c,e)||this;p.respectDrawingVertexOrder=!1;p._arrowShapeTemplate=[[0,0],[-24,24],[-24,12],[-96,12],[-96,-12],[-24,-12],[-24,-24],[0,0]];p._leftArrowShapeTemplate=[[0,0],[24,24],[24,12],[96,12],[96,-12],
[24,-12],[24,-24],[0,0]];p._rightArrowShapeTemplate=[[0,0],[-24,24],[-24,12],[-96,12],[-96,-12],[-24,-12],[-24,-24],[0,0]];p._upArrowShapeTemplate=[[0,0],[-24,24],[-12,24],[-12,96],[12,96],[12,24],[24,24],[0,0]];p._downArrowShapeTemplate=[[0,0],[-24,-24],[-12,-24],[-12,-96],[12,-96],[12,-24],[24,-24],[0,0]];p._triangleShapeTemplate=[[0,-48],[41.56921938165306,24],[-41.56921938165306,24],[0,-48]];p._rectangleShapeTemplate=[[0,-48],[96,-48],[96,0],[0,0],[0,-48]];p._drawObject=null;p._editObject=null;
p._options=null;p._defaultOptions=null;p._active=!1;p._graphic=null;p._createGeometryDeferred=null;p._isPlottingPolyGeometry=!1;p._lastVertexPosition=null;p._vertexAnchor=null;p._ghostLine=null;p._handles=[];p._polyGeometryKeyDownHandle=null;p._editCompletedHandle=null;p._dblClickHandlerToken=null;p._lastSnappingPoint=null;var l=Modernizr&&!!Modernizr.touch,l={enableEditing:!0,vertexOffsetX:10,vertexOffsetY:10,preciseVertexOffsetX:1,preciseVertexOffsetY:1,vertexSymbol:new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,
l?20:12,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new esri.Color([0,0,0,0.5]),1),new esri.Color([128,128,128])),selectedVertexSymbol:new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,l?25:15,null,new esri.Color([0,0,255,0.75]))};p._defaultOptions=dojo.mixin(l,g||{});p._points=[];p._drawObject=new esri.toolbars.Draw(c,g);p._twoClicksWithin300MsFixup();p._editObject=new b(c,null,e);p.fillSymbol=p._drawObject.fillSymbol;p.lineSymbol=p._drawObject.lineSymbol;
p.markerSymbol=p._drawObject.markerSymbol;p.respectDrawingVertexOrder=p._drawObject.respectDrawingVertexOrder;p.setVertexSymbol(p._defaultOptions.vertexSymbol);p.setSelectedVertexSymbol(p._defaultOptions.selectedVertexSymbol);p.app&&p.app.event("SnappingFeedbackEvent").subscribe(p,p._handleSnappingEvent);return p}__extends(g,a);g.createEllipse=function(a){var b=a.center,d=a.longAxis||48,c=a.shortAxis||24,g=a.numberOfPoints||60,e=a.map;a=[];for(var l=2*Math.PI/g,f=0;f<g;f++){var k=Math.cos(f*l),h=
Math.sin(f*l),k=e.toMap(new esri.geometry.ScreenPoint({x:d*k+b.x,y:c*h+b.y}));a.push(k)}a.push(a[0]);b=new esri.geometry.Polygon(e.spatialReference);b.addRing(a);return b};g.createCircle=function(a){return g.createEllipse({center:a.center,longAxis:a.radius,shortAxis:a.radius,numberOfPoints:a.numberOfPoints,map:a.map})};g.prototype.activate=function(a,b){var d=this;(this._active||this._geometryType)&&this.deactivate();this._handles.push(this.app.map.on("click",function(a){return d.app.trace.debug("[DrawTool] map-click")}));
this._handles.push(this.app.map.on("dbl-click",function(a){return d.app.trace.debug("[DrawTool] map-double-click")}));this._active=!0;this._geometryType=a;this._options=dojo.mixin(dojo.mixin({},this._defaultOptions),b||{});a===g.MULTI_POINT&&(this._options.enableEditing=!1);this.setVertexSymbol(this._options.vertexSymbol);this.setSelectedVertexSymbol(this._options.selectedVertexSymbol);this._handles.push(dojo.aspect.after(this._drawObject,"onDrawEnd",dojo.hitch(this,"onDrawEnd"),!0));this._handles.push(dojo.aspect.after(this._drawObject,
"onDrawComplete",dojo.hitch(this,"onDrawComplete"),!0));this._drawObject&&"function"===typeof this._drawObject._onClickHandler&&this._handles.push(dojo.aspect.after(this._drawObject,"_onClickHandler",dojo.hitch(this,"_onClickHandler"),!0));this._extraPointOnTouchDevicesFixup();this.activateMouseControls();this._supportsKeyboardInput(this._geometryType)&&this.activateKeyboardControls();this.onActivate();this.raiseGraphicDrawActivated({sender:this,geometryType:a})};g.prototype.deactivate=function(){var a=
this._geometryType;this._active=!1;this._clear();this.setInputMethod(null);this._dblClickHandlerToken&&(this._dblClickHandlerToken.remove(),this._dblClickHandlerToken=null);this._handles.forEach(function(a){a.remove()});this._handles.length=0;this._geometryType=this.vertexSymbol=this.selectedVertexSymbol=null;this.onDeactivate();this.raiseGraphicDrawDeactivated({sender:this,geometryType:a})};g.prototype.finishDrawing=function(){switch(this.inputMethod){case e.InputMethod.MOUSE:this._drawObject.finishDrawing();
this._syncPointsCollection();break;case e.InputMethod.KEYBOARD:this._finishKeyboardDrawing()}};g.prototype.setFillSymbol=function(a){this.fillSymbol=a;this._drawObject.setFillSymbol(a)};g.prototype.setLineSymbol=function(a){this.lineSymbol=a;this._drawObject.setLineSymbol(a)};g.prototype.setMarkerSymbol=function(a){this.markerSymbol=a;this._drawObject.setMarkerSymbol(a)};g.prototype.setRespectDrawingVertexOrder=function(a){this.respectDrawingVertexOrder=a;this._drawObject.setRespectDrawingVertexOrder(a)};
g.prototype.setVertexSymbol=function(a){this.vertexSymbol=a};g.prototype.setSelectedVertexSymbol=function(a){this.selectedVertexSymbol=a};g.prototype.activateMouseControls=function(b){void 0===b&&(b=!0);a.prototype.activateMouseControls.call(this,b);this._geometryType&&(this._drawObject.__attached_stopEvent=!0,this._drawObject.activate(this._geometryType,this._options))};g.prototype.deactivateMouseControls=function(b){void 0===b&&(b=!0);a.prototype.deactivateMouseControls.call(this,b);this._drawObject.__attached_stopEvent=
!0;this._drawObject.deactivate()};g.prototype.raiseGraphicDrawActivated=function(a){this.app.event("GraphicDrawActivatedEvent").publish(a)};g.prototype.raiseGraphicDrawDeactivated=function(a){this.app.event("GraphicDrawDeactivatedEvent").publish(a)};g.prototype.raiseGraphicVertexAdded=function(a){this.app.event("GraphicVertexAddedEvent").publish(a)};g.prototype.raiseGraphicVertexMoved=function(a){this.app.event("GraphicVertexMovedEvent").publish(a)};g.prototype.on=function(a,b){throw Error("[geocortex.essentialsHtmlViewer.mapping.infrastructure.accessibilit.Draw::on] On style events not implemented yet. Use connect instead.");
};g.prototype.onActivate=function(){};g.prototype.onDeactivate=function(){};g.prototype.onDrawComplete=function(a){this.inputMethod==e.InputMethod.MOUSE&&this._clear()};g.prototype.onDrawEnd=function(a){this.app.trace.debug("[DrawTool] Number of vertices drawn "+this._vertexCount(a));this.inputMethod==e.InputMethod.MOUSE&&this._clear();this.app.event("GraphicDrawCompletedEvent").publish(a)};g.prototype.onKeyboardStart=function(){var b=this;a.prototype.onKeyboardStart.call(this);this.deactivateMouseControls();
var c=this._map.extent.getCenter();this._plotShape(c,this._geometryType).then(function(a){return b._editShape(a)})};g.prototype.onKeyboardStop=function(b){void 0===b&&(b=!1);a.prototype.onKeyboardStop.call(this,b);this._graphic&&!b?(b=this._graphic.geometry,this._clear(),this._drawEnd(b)):this._clear()};g.prototype._onKeyDown=function(b){a.prototype._onKeyDown.call(this,b);if(!this.suspended&&this._active&&this.inputMethod!==e.InputMethod.MOUSE){var c=!1;switch(b.keyCode||b.which){case dojo.keys.ENTER:case dojo.keys.NUMPAD_ENTER:this.toggleKeyboardMode();
c=!0;break;case dojo.keys.ESCAPE:this.onKeyboardStop(!0),c=!0}c&&(b.preventDefault(),b.stopPropagation())}};g.prototype._onClickHandler=function(a){this.inputMethod===e.InputMethod.MOUSE&&this._syncPointsCollection()};g.prototype._supportsKeyboardInput=function(a){switch(a){case g.ARROW:case g.CIRCLE:case g.DOWN_ARROW:case g.ELLIPSE:case g.EXTENT:case g.LEFT_ARROW:case g.MULTI_POINT:case g.POINT:case g.POLYGON:case g.POLYLINE:case g.RECTANGLE:case g.RIGHT_ARROW:case g.TRIANGLE:case g.UP_ARROW:return!0}return!1};
g.prototype._finishKeyboardDrawing=function(a){void 0===a&&(a=!0);if(this._active){var b,d=this._map.spatialReference,c=this._points.slice(0,this._points.length);switch(this._geometryType){case g.POLYLINE:if(!this._graphic||2>c.length)return;b=new esri.geometry.Polyline(d);b.addPath(c);this._graphic.setGeometry(b);break;case g.POLYGON:if(!this._graphic||2>c.length)return;c.push(c[0].offset(0,0));esri.geometry.Polygon.prototype.isClockwise(c)||this.respectDrawingVertexOrder||(this.app.trace.debug("Polygons drawn in anti-clockwise direction will be reversed to be clockwise."),
c.reverse());b=new esri.geometry.Polygon(d);b.addRing(c);this._graphic.setGeometry(b);break;case g.MULTI_POINT:b=new esri.geometry.Multipoint(d);c.forEach(function(a){b.addPoint(a)});this._graphic.setGeometry(b);break;default:if(!this._graphic||!this._graphic.geometry)return;b=this._graphic.geometry}if(a)this.onKeyboardStop()}};g.prototype._clear=function(){this._graphic&&this._map.graphics.remove(this._graphic);this._ghostLine&&this._map.graphics.remove(this._ghostLine);this._vertexAnchor&&this._map.graphics.remove(this._vertexAnchor);
this._editCompletedHandle&&this._editCompletedHandle.remove();this._polyGeometryKeyDownHandle&&this._polyGeometryKeyDownHandle.remove();this._editObject&&this._editObject.deactivate();this._polyGeometryKeyDownHandle=this._editCompletedHandle=this._createGeometryDeferred=this._graphic=this._vertexAnchor=this._ghostLine=null;this._isPlottingPolyGeometry=!1;this._lastVertexPosition=null;this.suspended=!1;this._points.length=0;this.deactivateMouseControls();this._supportsKeyboardInput(this._geometryType)&&
this.deactivateKeyboardControls();this.setInputMethod(null);this._active&&(this.activateMouseControls(),this._supportsKeyboardInput(this._geometryType)&&this.activateKeyboardControls())};g.prototype._drawEnd=function(a){if(a){this.onDrawEnd(a);var b,d=this._map.spatialReference;d&&(d.isWebMercator()?b=esri.geometry.webMercatorToGeographic(a):4326===d.wkid&&(b=esri.geometry.fromJson(a.toJson())));this.onDrawComplete({geometry:a,geographicGeometry:b})}};g.prototype._moveVertexAnchor=function(a,b){if(this._vertexAnchor&&
!isNaN(a)&&!isNaN(b)){var d=this._vertexAnchor.geometry,c=this._map.toMap(this._map.toScreen(d).offset(a,b)),d=d.offset(c.x-d.x,c.y-d.y);-1<[g.POLYLINE,g.POLYGON].indexOf(this._geometryType)&&this._updateGhostLine(d);this._vertexAnchor.setGeometry(d).setSymbol(this.selectedVertexSymbol);this._vertexAnchor.getDojoShape().moveToFront();d={sender:this,mapPoint:d,screenPoint:this._map.toScreen(d),snappingPoint:this._lastSnappingPoint};this.raiseGraphicVertexMoved(d)}};g.prototype._handleSnappingEvent=
function(a){this._active&&this._editObject.isActive()||(this._lastSnappingPoint=a.snappingPoint)&&this._ghostLine&&this._updateGhostLine(this._lastSnappingPoint)};g.prototype._updateGhostLine=function(a){if(this._points&&0<this._points.length){var b=this._ghostLine.geometry;b.setPoint(0,0,this._points[this._points.length-1].offset(0,0));b.setPoint(0,1,a);this._ghostLine.setGeometry(b)}};g.prototype._addVertex=function(a){var b=a;this._lastSnappingPoint&&(a=this._lastSnappingPoint);var d;this._points.push(a.offset(0,
0));switch(this._geometryType){case g.POLYLINE:1===this._points.length?(d=new esri.geometry.Polyline(this._map.spatialReference),d.addPath(this._points),this._graphic=this._map.graphics.add(new esri.Graphic(d,this.lineSymbol)),d=new esri.geometry.Polyline(this._map.spatialReference),d.addPath([a.offset(0,0),a.offset(0,0)]),this._ghostLine=this._map.graphics.add(new esri.Graphic(d,this.lineSymbol))):(d=this._graphic.geometry,d.insertPoint(0,d.paths[0].length,a.offset(0,0)),this._graphic.setGeometry(d).setSymbol(this.lineSymbol),
d=this._ghostLine.geometry,d.setPoint(0,0,a.offset(0,0)),d.setPoint(0,1,a.offset(0,0)),this._ghostLine.setGeometry(d));break;case g.POLYGON:1===this._points.length?(d=new esri.geometry.Polygon(this._map.spatialReference),d.addRing(this._points),this._graphic=this._map.graphics.add(new esri.Graphic(d,this.fillSymbol)),d=new esri.geometry.Polyline(this._map.spatialReference),d.addPath([a.offset(0,0),a.offset(0,0)]),this._ghostLine=this._map.graphics.add(new esri.Graphic(d,this.fillSymbol))):(d=this._graphic.geometry,
d.insertPoint(0,d.rings[0].length,a.offset(0,0)),this._graphic.setGeometry(d).setSymbol(this.fillSymbol),d=this._ghostLine.geometry,d.setPoint(0,0,a.offset(0,0)),d.setPoint(0,1,a.offset(0,0)),this._ghostLine.setGeometry(d));break;case g.MULTI_POINT:1===this._points.length?(d=new esri.geometry.Multipoint(this._map.spatialReference),d.addPoint(a.offset(0,0)),this._graphic=this._map.graphics.add(new esri.Graphic(d,this.markerSymbol))):(d=this._graphic.geometry,d.addPoint(a.offset(0,0)),this._graphic.setGeometry(d).setSymbol(this.markerSymbol))}this._lastVertexPosition=
b.offset(0,0);this._vertexAnchor.setGeometry(b.offset(0,0)).setSymbol(this.selectedVertexSymbol);this._vertexAnchor.getDojoShape().moveToFront()};g.prototype._drawPolyGeometry=function(a,b){var d=this;if(!a||this._isPlottingPolyGeometry)return Promise.resolve(null);this._lastSnappingPoint&&(a=this._lastSnappingPoint);this._isPlottingPolyGeometry=!0;this.app.map.disableMapNavigation();this.suspend();this._lastVertexPosition=null;this._vertexAnchor=this._map.graphics.add(new esri.Graphic(a.offset(0,
0),this.selectedVertexSymbol));var c={sender:this,mapPoint:a,screenPoint:this._map.toScreen(a),snappingPoint:this._lastSnappingPoint};this.raiseGraphicVertexMoved(c);this._polyGeometryKeyDownHandle&&(this._polyGeometryKeyDownHandle.remove(),this._polyGeometryKeyDownHandle=null);var g=null;return(new Promise(function(a,b){return d._polyGeometryKeyDownHandle=d._drawPolyGeometry_handleKeyDown(a,b)})).then(function(a){return g=a})["catch"](function(){d.onKeyboardStop(!0);return g=null}).lastly(function(){d._isPlottingPolyGeometry=
!1;d.app.map.enableMapNavigation();d._polyGeometryKeyDownHandle&&(d._polyGeometryKeyDownHandle.remove(),d._polyGeometryKeyDownHandle=null);d.resume();return g})};g.prototype._drawPolyGeometry_handleKeyDown=function(a,b){var d=this;return dojo.on(this._map.root,"keydown",function(g){var e=g.altKey,l=e?d._options.preciseVertexOffsetX:d._options.vertexOffsetX,e=e?d._options.preciseVertexOffsetY:d._options.vertexOffsetY;switch(g.keyCode||g.which){case dojo.keys.UP_ARROW:case dojo.keys.NUMPAD_8:d._moveVertexAnchor(0,
-e);break;case dojo.keys.RIGHT_ARROW:case dojo.keys.NUMPAD_6:d._moveVertexAnchor(l,0);break;case dojo.keys.DOWN_ARROW:case dojo.keys.NUMPAD_2:d._moveVertexAnchor(0,e);break;case dojo.keys.LEFT_ARROW:case dojo.keys.NUMPAD_4:d._moveVertexAnchor(-l,0);break;case dojo.keys.PAGE_UP:case dojo.keys.NUMPAD_9:d._moveVertexAnchor(l,-e);break;case dojo.keys.PAGE_DOWN:case dojo.keys.NUMPAD_3:d._moveVertexAnchor(l,e);break;case dojo.keys.END:case dojo.keys.NUMPAD_1:d._moveVertexAnchor(-l,e);break;case dojo.keys.HOME:case dojo.keys.NUMPAD_7:d._moveVertexAnchor(-l,
-e);break;case dojo.keys.ENTER:case dojo.keys.NUMPAD_ENTER:c.pointsAreEqual(d._vertexAnchor.geometry,d._lastVertexPosition)?(d._graphic&&d._map.graphics.remove(d._graphic),d._vertexAnchor&&d._map.graphics.remove(d._vertexAnchor),d._finishKeyboardDrawing(!1),a(d._graphic?d._graphic.geometry:null)):(l=d._vertexAnchor.geometry,d._addVertex(l),l={sender:d,mapPoint:l,screenPoint:d._map.toScreen(l),snappingPoint:d._lastSnappingPoint},d.raiseGraphicVertexAdded(l));break;case dojo.keys.ESCAPE:b(null);break;
default:return}g.preventDefault();g.stopPropagation()})};g.prototype._plotShape=function(a,b){var d=this._map.toScreen(a);switch(b){case g.POINT:return Promise.resolve(a.offset(0,0));case g.POLYLINE:return this._drawPolyGeometry(a,b);case g.POLYGON:return this._drawPolyGeometry(a,b);case g.MULTI_POINT:return this._drawPolyGeometry(a,b);case g.ARROW:return Promise.resolve(this._toPolygon(this._arrowShapeTemplate,d.x,d.y));case g.LEFT_ARROW:return Promise.resolve(this._toPolygon(this._leftArrowShapeTemplate,
d.x,d.y));case g.RIGHT_ARROW:return Promise.resolve(this._toPolygon(this._rightArrowShapeTemplate,d.x,d.y));case g.UP_ARROW:return Promise.resolve(this._toPolygon(this._upArrowShapeTemplate,d.x,d.y));case g.DOWN_ARROW:return Promise.resolve(this._toPolygon(this._downArrowShapeTemplate,d.x,d.y));case g.TRIANGLE:return Promise.resolve(this._toPolygon(this._triangleShapeTemplate,d.x,d.y));case g.RECTANGLE:case g.EXTENT:return Promise.resolve(this._toPolygon(this._rectangleShapeTemplate,d.x-48,d.y+24));
case g.CIRCLE:return d=g.createCircle({center:d,radius:48,numberOfPoints:60,map:this._map}),Promise.resolve(d);case g.ELLIPSE:return d=g.createEllipse({center:d,longAxis:48,shortAxis:24,numberOfPoints:60,map:this._map}),Promise.resolve(d)}return Promise.resolve(null)};g.prototype._editShape=function(a){if(a)if(!1===this._options.enableEditing)this._clear(),this._drawEnd(a);else{this.suspend();var b;switch(a.type){case "point":case "multipoint":b=this.markerSymbol;break;case "polyline":b=this.lineSymbol;
break;case "polygon":case "extent":b=this.fillSymbol}var d=this._getEditMode(this._geometryType);this._graphic=this._map.graphics.add(new esri.Graphic(a,b));this._editCompletedHandle&&(this._editCompletedHandle.remove(),this._editCompletedHandle=null);this._editCompletedHandle=dojo.aspect.after(this._editObject,"onDeactivate",dojo.hitch(this,"_onEditShapeCompleted"),!0);this._editObject.activate(d.mode,this._graphic,d.options)}};g.prototype._onEditShapeCompleted=function(a,b,d){a=d?!!d.isModified:
!1;d=d?!!d.cancelled:!1;b&&a&&(this._graphic=b);this.resume();this.onKeyboardStop(d)};g.prototype._toPolygon=function(a,b,d){var c=this._map;a=a.map(function(a){return c.toMap(new esri.geometry.ScreenPoint(a[0]+b,a[1]+d))});var g=new esri.geometry.Polygon(c.spatialReference);g.addRing(a);return g};g.prototype._syncPointsCollection=function(){this._points=this._drawObject._points};g.prototype._getEditMode=function(a){var b={mode:0,options:{}};switch(a){case g.POINT:b.mode=l.Edit.MOVE;break;case g.MULTI_POINT:b.mode=
l.Edit.EDIT_VERTICES;b.options.allowAddVertices=!1;b.options.allowDeleteVertices=!0;break;case g.POLYLINE:case g.ARROW:case g.LEFT_ARROW:case g.RIGHT_ARROW:case g.UP_ARROW:case g.DOWN_ARROW:case g.TRIANGLE:case g.RECTANGLE:case g.POLYGON:b.mode=l.Edit.MOVE|l.Edit.ROTATE|l.Edit.SCALE|l.Edit.EDIT_VERTICES;b.options.allowAddVertices=!0;b.options.allowDeleteVertices=!0;b.options.uniformScaling=!1;break;case g.EXTENT:b.mode=l.Edit.MOVE|l.Edit.SCALE;b.options.allowAddVertices=!1;b.options.allowDeleteVertices=
!1;b.options.uniformScaling=!1;break;case g.CIRCLE:b.mode=l.Edit.MOVE|l.Edit.SCALE;b.options.uniformScaling=!0;break;case g.ELLIPSE:b.mode=l.Edit.MOVE|l.Edit.ROTATE|l.Edit.SCALE,b.options.uniformScaling=!1}return b};g.prototype._vertexCount=function(a){return a&&"polyline"===a.type?a.paths[0].length:a&&"polygon"===a.type?a.rings[0].length-1:a&&"multipoint"===a.type?a.points.length:0};g.prototype._twoClicksWithin300MsFixup=function(){var a=this,b=this._drawObject;if(b&&"function"===typeof b._onClickHandler){var d=
b._onClickHandler;b._onClickHandler=function(b){return a._twoClicksWithin300MsFixup_handleClick(b,d)}}else this.app.trace.warning("The _drawObject _onClickHandler hook is dysfunctional. Markup and Measurement (tool) functionality may be affected on touch devices.")};g.prototype._twoClicksWithin300MsFixup_handleClick=function(a,b){var d=!1,c=0,e=0,l=function(a){c=a[0].mapPoint.x;e=a[0].mapPoint.y};if(this._geometryType===g.POLYLINE||this._geometryType===g.POLYGON||this._geometryType===g.POINT||this._geometryType===
g.MULTI_POINT){if(!d&&(a.mapPoint.x!==c||a.mapPoint.y!==e)){d=!0;setTimeout(function(){d=!1},300);var f={sender:this,mapPoint:a.mapPoint,screenPoint:a.screenPoint,snappingPoint:this._lastSnappingPoint};b.apply(this._drawObject,arguments);this.raiseGraphicVertexAdded(f)}l(arguments)}else b.apply(this._drawObject,arguments)};g.prototype._extraPointOnTouchDevicesFixup=function(){var a=this,b=function(b){var d=a._drawObject,c=!!(h&&h.has&&h.has("esri-touch"));a.app.trace.debug("[DrawTool] IsTouch = "+
c);var g=d?d._points:null;if(g)if(c){if(2<=g.length){var e=g.push;g.push=function(){a.app.trace.debug("[DrawTool] points.length "+g.length);g.push=e}}}else if(2>g.length||g[g.length-1].x!==b.mapPoint.x&&g[g.length-1].y!==b.mapPoint.y)a._lastSnappingPoint?a.app.trace.debug("[DrawTool] Bailout due to snapping"):(g.push(b.mapPoint),a.raiseGraphicVertexAdded({sender:a,mapPoint:b.mapPoint,screenPoint:b.screenPoint,snappingPoint:a._lastSnappingPoint}))};this._dblClickHandlerToken?this.app.trace.debug("[DrawTool] No double click subscribed"):
this._dblClickHandlerToken=this.app.map.on("dbl-click",b)};return g}(k.AccessibleMapComponent);a._draw=function(){h(["esri/toolbars/draw"],function(b){a.ARROW=b.ARROW;a.CIRCLE=b.CIRCLE;a.DOWN_ARROW=b.DOWN_ARROW;a.ELLIPSE=b.ELLIPSE;a.EXTENT=b.EXTENT;a.FREEHAND_POLYGON=b.FREEHAND_POLYGON;a.FREEHAND_POLYLINE=b.FREEHAND_POLYLINE;a.LEFT_ARROW=b.LEFT_ARROW;a.LINE=b.LINE;a.MULTI_POINT=b.MULTI_POINT;a.POINT=b.POINT;a.POLYGON=b.POLYGON;a.POLYLINE=b.POLYLINE;a.RECTANGLE=b.RECTANGLE;a.RIGHT_ARROW=b.RIGHT_ARROW;
a.TRIANGLE=b.TRIANGLE;a.UP_ARROW=b.UP_ARROW})}();f.Draw=a;var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}__extends(b,a);b.prototype.raiseGraphicEditActivated=function(a){this.app.event("GraphicDrawAccessibleEditActivatedEvent").publish(a)};b.prototype.raiseGraphicEditDeactivated=function(a){this.app.event("GraphicDrawAccessibleEditDeactivatedEvent").publish(a)};return b}(l.Edit);f.EditInternal=b});
define("infrastructure/accessibility/AccessibilityManager",["require","exports"],function(h,f){var k=function(){function l(e){this._registeredComponentTypes={"esri.toolbars.draw":"esri.toolbars.Draw","esri.toolbars.edit":"esri.toolbars.Edit","geocortex.accessibility.draw":"geocortex.essentialsHtmlViewer.mapping.infrastructure.accessibility.Draw","geocortex.accessibility.edit":"geocortex.essentialsHtmlViewer.mapping.infrastructure.accessibility.Edit"};this._stack=[];this.app=e;this.app.event("AccessibleComponentStartedEvent").subscribe(this,
this._handleAccessibleComponentStarted);this.app.event("AccessibleComponentCompletedEvent").subscribe(this,this._handleAccessibleComponentCompleted)}l.prototype.registerComponent=function(e,c){if(null==e||null==c)throw Error("[AccessibilityManager::registerComponent] Null name or typeName passed to registerComponent");this._registeredComponentTypes[e]=c};l.prototype.unregisterComponent=function(e){return e&&this._registeredComponentTypes.hasOwnProperty(e)?(delete this._registeredComponentTypes[e],
!0):!1};l.prototype.createComponent=function(e,c,a){if(e&&this._registeredComponentTypes.hasOwnProperty(e)){var b=this._registeredComponentTypes[e],d=dojo.getObject(b);if(d)return new d(c,a,this.app);this.app.trace.warning("Could not create component '{0}' from type name '{1}'".format(e,b))}return null};l.prototype._handleAccessibleComponentStarted=function(e){if(e&&this._stack){var c=this._stack.indexOf(e);-1<c&&this._stack.splice(c,1);this._stack.forEach(function(a){return!a.suspended&&a.suspend()});
this._stack.push(e);e.resume()}};l.prototype._handleAccessibleComponentCompleted=function(e){if(e&&this._stack&&0!=this._stack.length){var c=this._stack.indexOf(e);-1<c&&(this._stack.splice(c,1),!e.suspended&&e.suspend());0<this._stack.length&&this._stack[this._stack.length-1].resume()}};return l}();f.AccessibilityManager=k});define("infrastructure/coordinates/CoordinateSystem",["require","exports"],function(h,f){});
define("infrastructure/coordinates/CoordinateBase",["require","exports"],function(h,f){});define("infrastructure/coordinates/Coordinate",["require","exports"],function(h,f){});define("infrastructure/coordinates/CoordinatesModelConfig",["require","exports"],function(h,f){});
define("infrastructure/coordinates/CoordinatesModel",["require","exports","geocortex/framework/ui/ViewModelBase","geocortex/framework/observables"],function(h,f,k,l){h=function(e){function c(){var a=null!==e&&e.apply(this,arguments)||this;a.isActive=new l.Observable(!1);a.coordinateSystems=new l.ObservableCollection([]);a.currentCoordinateSystem=new l.Observable(null);a.fractionalDigits=5;a.defaultGcsWkid=4326;a.inputStream=new l.Observable(null);a.outputStream=new l.Observable(null);a.isRegistered=
!1;return a}__extends(c,e);c.prototype.initialize=function(a){this.configuration=a};return c}(k.ViewModelBase);f.CoordinatesModel=h});define("infrastructure/coordinates/AngleFormat",["require","exports"],function(h,f){f.DD="dd";f.DDM="ddm";f.DMS="dms"});
define("infrastructure/coordinates/CoordinateUtils","require exports infrastructure/GeometryUtils infrastructure/coordinates/AngleFormat infrastructure/FormatUtils infrastructure/NumberFormat".split(" "),function(h,f,k,l,e,c){function a(a,b,n,p){if(null==p||"undefined"===typeof p)p=4;b||(b=l.DD);b=b.toLowerCase();switch(b){case l.DDM:b=p;p=Math.floor(Math.abs(a));var f=60*(Math.abs(a)-p);return"{0}{1} {2}{3}".format(p*g(a),d(n,"degrees"),e.formatNumber(f,c.NumberFormat.NUMBER,{fractionalDigits:b}),
d(n,"minutes"));case l.DMS:b=p;p=Math.floor(Math.abs(a));var f=Math.floor(60*(Math.abs(a)-p)),r=3600*(Math.abs(a)-p-f/60);return"{0}{1} {2}{3} {4}{5}".format(p*g(a),d(n,"degrees"),f,d(n,"minutes"),e.formatNumber(r,c.NumberFormat.NUMBER,{fractionalDigits:b}),d(n,"seconds"));default:return"{0}{1}".format(e.formatNumber(a,c.NumberFormat.NUMBER,{fractionalDigits:p}),d(n,"degrees"))}}function b(b,c,g,e,l){var f=null,k=null,f=0<b?d(e,"north-abbrev"):d(e,"south-abbrev"),k=0<c?d(e,"east-abbrev"):d(e,"west-abbrev");
return{latitude:"{0} {1}".format(a(Math.abs(b),g,e,l),f),longitude:"{0} {1}".format(a(Math.abs(c),g,e,l),k)}}function d(a,b){b=b.startsWith("language-coordinates-")?b:"language-coordinates-"+b;return a.getResource("Mapping.Infrastructure",b)}function g(a){return"number"!==typeof a?NaN:0<a?1:0>a?-1:a}f.getCoordinate=function(a,d,g,p,l){void 0===p&&(p=5);void 0===l&&(l=4326);return new Promise(function(f,h){var u=esri.geometry,v=d.spatialReference,y=(a.map.spatialReference.wkt?g.wkt!==a.map.spatialReference.wkt:
g.wkid!==a.map.spatialReference.wkid)||"xy"===g.output?new esri.SpatialReference(g.wkid||g.wkt):new esri.SpatialReference(l),x=function(d){var q=p;void 0===q&&(q=5);var l={};l.targetCoordinateSystem=g;l.x=d.x;l.y=d.y;l.spatialReference=d.spatialReference;"xy"==g.output?(l.formattedLatitudeOrX=e.formatNumber(d.x,c.NumberFormat.DEFAULT,{fractionalDigits:q}),l.formattedLongitudeOrY=e.formatNumber(d.y,c.NumberFormat.DEFAULT,{fractionalDigits:q})):(d=b(d.y,d.x,g.output,a,q),l.formattedLatitudeOrX=d.latitude,
l.formattedLongitudeOrY=d.longitude);f(l)},w=function(){k.projectGeometry(d,y,function(a){x(a)},function(a){h(Error("Unable to project geometry for coordinate tracking: {0}".format(a.message)))},a)},A=function(){a.command("NativeHasCapability").execute("project",function(a){a?w():h(Error("Offline Mode. Unable to project geometry for coordinate tracking."))})};u.canProject(v,y)?(u=u.project(d,y),x(u)):a.isOffline.get()?A():w()})};f.convertDmsToDecimalDegrees=function(a,b,c,g,e){var l=d(a,"west-abbrev").toUpperCase(),
f=d(a,"east-abbrev").toUpperCase(),k=d(a,"north-abbrev").toUpperCase();a=d(a,"south-abbrev").toUpperCase();e=e.toUpperCase();b=parseFloat(b);c=parseFloat(c);g=parseFloat(g);if(isNaN(b)||isNaN(c)||isNaN(g)||0>b||180<b||0>c||60<c||0>g||60<g||e!=l&&e!=f&&e!=k&&e!=a)return null;f=b+c/60+g/3600;if(e===a||e===l)f=-f;return f};f.formatAngle=a;f.formatLatLon=b;f.formatXYCoordinate=function(a,b,d){if(null==d||"undefined"===typeof d)d=4;return e.formatNumber(a,c.NumberFormat.NUMBER,{fractionalDigits:d})};f.formatBearing=
function(b,c,g,e){if(0===b)return d(g,"north-abbrev");if(90===b)return d(g,"east-abbrev");if(180===b)return d(g,"south-abbrev");if(270===b)return d(g,"west-abbrev");var l=d(g,"north-abbrev"),f=d(g,"east-abbrev");90<=b&&180>b?(l=d(g,"south-abbrev"),b=180-b):180<=b&&270>b?(l=d(g,"south-abbrev"),f=d(g,"west-abbrev"),b-=180):270<=b&&360>b&&(f=d(g,"west-abbrev"),b=360-b);return"{0} {1} {2}".format(l,a(b,c,g,e),f)};f.getResource=d});
define("infrastructure/coordinates/CoordinatesManager",["require","exports","infrastructure/coordinates/CoordinatesModel","infrastructure/coordinates/CoordinateUtils"],function(h,f,k,l){f.featureSetExtendedProperty="containsCoordinates";f.coordinateIdentifierProperty="coordinateId";h=function(){function e(c){this._registeredCoordinateModels=[];this.app=c}e.prototype.registerModel=function(c,a){void 0===a&&(a=!1);if(!this._validateModelRegistration(c))return!1;this._processCoordinatesModel(c);if(0===
this._registeredCoordinateModels.length||a)this._defaultCoordinatesModel=c;this._registeredCoordinateModels.push(c.id);return!0};e.prototype.getCoordinate=function(c,a,b){var d=this;if(!this.hasRegisteredCoordinatesModel(b))return Promise.reject(Error("Coordinates Manager: Could not resolve coordinates. Target coordinates model incorrectly configured or not registered."));var g=c instanceof esri.geometry.Point?c:new esri.geometry.Point(c.x,c.y,c.spatialReference);c=this._defaultCoordinatesModel;if(b&&
c.id!==b)this.getCoordinatesModel(b).then(function(b){return l.getCoordinate(d.app,g,a||b.currentCoordinateSystem.get(),b.fractionalDigits,b.defaultGcsWkid)},function(a){return Promise.reject(a)});else return l.getCoordinate(this.app,g,a||c.currentCoordinateSystem.get(),c.fractionalDigits,c.defaultGcsWkid)};e.prototype.getCoordinatesModel=function(c){var a=this;return new Promise(function(b,d){a.app.getFrameworkObjectByIdAsync(c,function(a){a instanceof k.CoordinatesModel?b(a):d(Error("CoordinatesManager: getCoordinatesModel - {0} is not an instance of a Coordinates Model.".format(c)))},
function(a){return d(a)})})};e.prototype.hasRegisteredCoordinatesModel=function(c){return!c&&this._defaultCoordinatesModel&&this._defaultCoordinatesModel.isRegistered?!0:c?-1<this._registeredCoordinateModels.indexOf(c):!1};e.prototype._validateModelRegistration=function(c){if(!(c&&c.id&&c.coordinateSystems.length()&&c.currentCoordinateSystem.get())||this._registeredCoordinateModels.filter(function(a){return c.id===a}).length)return!1;for(var a=0;a<c.coordinateSystems.length();a++){var b=c.coordinateSystems.getAt(a);
if(!this._validateCoordinateSystem(b))return!1}return!0};e.prototype._validateCoordinateSystem=function(c){return null!=c.displayName&&null!=c.output&&(null!=c.wkid||null!=c.wkt)};e.prototype._processCoordinatesModel=function(c){var a=this;this._addModelSubscriptionHooks(c);var b=!1;c.inputStream.bind(this,function(d){b||!c.isActive.get()||a._prevCoord&&a._prevCoord.x==d.x&&a._prevCoord.y==d.y&&a._prevCoord.spatialReference&&d.spatialReference&&(a._prevCoord.spatialReference.wkid===d.spatialReference.wkid||
a._prevCoord.spatialReference.wkt==d.spatialReference.wkt)?a._prevCoord=d:(a._prevCoord=d,d=d instanceof esri.geometry.Point?d:new esri.geometry.Point(d.x,d.y,d.spatialReference),b=!0,l.getCoordinate(a.app,d,c.currentCoordinateSystem.get(),c.fractionalDigits,c.defaultGcsWkid).then(function(a){c.outputStream.set(a);b=!1},function(d){a.app.trace.error("CoordinatesManager: An error occurred while attempting to map from input to output coordinate streams for model: {0}".format(c.id));b=!1}))});c.isRegistered=
!0};e.prototype._addModelSubscriptionHooks=function(c){var a=this,b=c.outputStream.bindingEvent;dojo.aspect.after(b,"subscribe",function(d){a._handleModelSubscriptionsChanged(c,b.subscriptions);return d});dojo.aspect.after(b,"unsubscribe",function(d){a._handleModelSubscriptionsChanged(c,b.subscriptions);return d});dojo.aspect.after(b,"clear",function(){return a._handleModelSubscriptionsChanged(c,b.subscriptions)});this._handleModelSubscriptionsChanged(c,b.subscriptions)};e.prototype._handleModelSubscriptionsChanged=
function(c,a){var b=!1,d;for(d in a)if(a.hasOwnProperty(d)){b=!0;break}b!==c.isActive.get()&&c.isActive.set(b)};return e}();f.CoordinatesManager=h});define("infrastructure/eventArgs/FeatureSetManagerEventArgs",["require","exports"],function(h,f){var k=function(){return function(l){dojo.safeMixin(this,l)}}();f.FeatureSetManagerEventArgs=k});
define("infrastructure/FeatureSetManager",["require","exports","geocortex/framework/observables","infrastructure/eventArgs/FeatureSetManagerEventArgs"],function(h,f,k,l){h=function(){function e(c){this.featureSetCollections=new k.ObservableCollection;this._featureSetCollectionsMap={};this._collectionChangedEventMap={};this._collectionOpenCount={};this._searchSuggestions={};this.app=c;this._registerCommands()}e.prototype._registerCommands=function(){this.app.command("OpenFeatureSetCollection").register(this,
this.openCollection);this.app.command("CloseFeatureSetCollection").register(this,this.closeCollection);this.app.command("RemoveCollection").register(this,this.removeCollection);this.app.command("RemoveFeatureSetCollection").register(this,this.removeCollection);this.app.command("RemoveCollectionById").register(this,this.removeCollectionById);this.app.command("RemoveFeatureSetCollectionById").register(this,this.removeCollectionById)};e.prototype.openCollection=function(c){if(!this._featureSetCollectionsMap.hasOwnProperty(c))return this.app.trace.warning("Cannot open feature set collection '{0}': No feature set collection with matching ID found.".format(c)),
null;this._collectionOpenCount.hasOwnProperty(c)||(this._collectionOpenCount[c]=0);++this._collectionOpenCount[c];if(1==this._collectionOpenCount[c]){var a=new l.FeatureSetManagerEventArgs({sender:this,featureSetCollection:this._featureSetCollectionsMap[c],featureSetCollectionId:c});this.app.event("FSMCollectionOpenedEvent").publish(a)}return this._featureSetCollectionsMap[c]};e.prototype.closeCollection=function(c){if(!this._featureSetCollectionsMap.hasOwnProperty(c))return this.app.trace.warning("Cannot close feature set collection '{0}': No feature set collection with matching ID found.".format(c)),
!1;if(!this._collectionOpenCount.hasOwnProperty(c)||0==this._collectionOpenCount[c])return this.app.trace.warning("Attempted to close an already-closed FeatureSetCollection."),!1;--this._collectionOpenCount[c];0==this._collectionOpenCount[c]&&(c=new l.FeatureSetManagerEventArgs({sender:this,featureSetCollection:this._featureSetCollectionsMap[c],featureSetCollectionId:c}),this.app.event("FSMCollectionClosedEvent").publish(c));return!0};e.prototype.tryCloseCollection=function(c){return this._featureSetCollectionsMap.hasOwnProperty(c)?
this.isCollectionOpen(c)?this.closeCollection(c):!0:!1};e.prototype.isCollectionOpen=function(c){return this._featureSetCollectionsMap.hasOwnProperty(c)?this._collectionOpenCount.hasOwnProperty(c)&&0<this._collectionOpenCount[c]:(this.app.trace.warning("Cannot check open state of feature set collection '{0}': No feature set collection with matching ID found.".format(c)),!1)};e.prototype.addCollection=function(c){return this._addCollectionImpl(c)};e.prototype._addCollectionImpl=function(c){if(!c)throw Error("FeatureSetManager.addCollection: Parameter 'fsc' required.");
var a=this._featureSetCollectionsMap[c.id];if(c===a)return!0;if(a)return this.app.trace.warning("Cannot add feature set collection '{0}': A feature set collection with that ID already exists.".format(c.id)),!1;this._featureSetCollectionsMap[c.id]=c;this.featureSetCollections.addItem(c);a=c.featureSets.bind(this,dojo.hitch(this,function(a){this.handleCollectionChanged(c,a)}));this._collectionChangedEventMap[c.id]=a;a=new l.FeatureSetManagerEventArgs({sender:this,featureSetCollection:this._featureSetCollectionsMap[c.id],
featureSetCollectionId:c.id});this.app.event("FSMCollectionAddedEvent").publish(a);return!0};e.prototype.handleCollectionChanged=function(c,a){var b=new l.FeatureSetManagerEventArgs({sender:this,featureSetCollection:c,featureSetCollectionId:c.id,collectionChangedEventArgs:a});this.app.event("FSMCollectionChangedEvent").publish(b)};e.prototype.removeCollection=function(c){return this.canRemoveCollection(c)?this.removeCollectionById(c.id):!1};e.prototype.removeCollectionById=function(c){if(!this._featureSetCollectionsMap.hasOwnProperty(c))return this.app.trace.warning("Cannot remove feature set collection '{0}': Collection not found.".format(c)),
!1;this.isCollectionOpen(c)&&this.closeCollection(c);var a=this._featureSetCollectionsMap[c];a.featureSets.unbind(this._collectionChangedEventMap[c]);this.featureSetCollections.removeItem(this._featureSetCollectionsMap[c]);delete this._collectionOpenCount[c];delete this._collectionChangedEventMap[c];var b=new l.FeatureSetManagerEventArgs({sender:this,featureSetCollection:this._featureSetCollectionsMap[c],featureSetCollectionId:c});this.app.event("FSMCollectionRemovedEvent").publish(b);a.featureSets.get().forEach(function(a){a.features.get().forEach(function(b){if(!(b.featureSet&&
b.featureSet.uniqueId!==a.uniqueId||1<b.featureSetUniqueIds.length||b.getExtendedPropertyByName("isShownInMaptip")||b.getExtendedPropertyByName("isShownInFeaturedetails"))){for(var c in b)b.hasOwnProperty(c)&&null!==b[c]&&void 0!==b[c]&&(b[c].isObservableCollection&&(b[c].clear(),b[c].bindingEvent.clear()),b[c].delegateGetter&&(b[c].delegateGetter=null));b.esriFeature.get()&&(b.esriFeature.bindingEvent.clear(),b.esriFeature.set(null))}});a.features.clear();a.features.bindingEvent.clear();a.esriFeatureSet&&
(a.esriFeatureSet.features=[],a.esriFeatureSet=null)});a.featureSets.clear();delete this._featureSetCollectionsMap[c];return!0};e.prototype.canRemoveCollection=function(c){return null!=c&&null!=this.getCollectionById(c.id)};e.prototype.getCollectionById=function(c){return this._featureSetCollectionsMap[c]};e.prototype.getCollectionIds=function(){var c=[],a;for(a in this._featureSetCollectionsMap)this._featureSetCollectionsMap.hasOwnProperty(a)&&c.push(a);return c};e.prototype.findFeatureSetByUniqueId=
function(c){for(var a=0,b=this.featureSetCollections.length();a<b;a++){var d=this.featureSetCollections.getAt(a).getFeatureSetByUniqueId(c);if(d)return d}return null};e.prototype.findFeaturesByEsriFeature=function(c){var a=[];this.featureSetCollections.get().forEach(function(b){(b=b.findFeatureByEsriFeature(c))&&a.push(b)});return a};e.prototype.addSearchSuggestions=function(c){for(var a in c)c.hasOwnProperty(a)&&(this._searchSuggestions.hasOwnProperty(a)?this.app.trace.warning("Cannot add search suggestion '{0}': A search suggestion for that feature set type already exists.".format(c[a])):
c[a]&&(this._searchSuggestions[a]=c[a]))};e.prototype.getSearchSuggestion=function(c){return this._searchSuggestions[c]};e.prototype.updateCollectionsOnFeatureDeletion=function(c,a){void 0===a&&(a=!0);(this.featureSetCollections.get()||[]).forEach(function(b){for(var d=b.featureSets.length();d--;){var g=b.featureSets.getAt(d),e=g.findFeatureByEsriFeature(c);e&&(g.removeFeature(e),a&&0===g.features.length()&&b.featureSets.removeItem(g))}})};e.prototype.findOpenFeatureSetCollectionByFeatureSetUniqueId=
function(c){for(var a=0,b=this.featureSetCollections.length();a<b;a++){var d=this.featureSetCollections.getAt(a);if(this.isCollectionOpen(d.id)&&d.getFeatureSetByUniqueId(c))return d}return null};return e}();f.FeatureSetManager=h});
define("infrastructure/search/SearchProviderBase",["require","exports","geocortex/framework/utils/utils","infrastructure/search/SearchManager"],function(h,f,k,l){h=function(){function e(c,a){this.app=c;this.libraryId=a;this.id="SearchProvider-"+k.alphaNumericToken();this.supportsHints=this.supportsOffline=!1;this.status=l.Status.IDLE}e.prototype.initialize=function(c){};e.prototype.search=function(c,a){};e.prototype.cancelSearch=function(){};e.prototype.getResource=function(c,a){return this.app.getResource(this.libraryId,
c,a)};return e}();f.SearchProviderBase=h});
define("infrastructure/search/SearchHintItem",["require","exports","geocortex/framework/observables","infrastructure/FilterUtils"],function(h,f,k,l){h=function(){function e(c,a){var b=this;this.iconUri=new k.Observable("");this.text=new k.Observable(c);this.plainText=new k.Observable("");this.plainText.syncTransform(this.text,function(a){return l.stripHtml(a)});this.safeText=new k.Observable("");this.safeText.syncTransform(this.text,function(a){return b.sanitizeText(a)})}e.prototype.sanitizeText=
function(c){var a={allowFrames:!1,uriTransformer:function(a){return a}};return c?l.sanitize(c,a):""};e.prototype.toString=function(){return this.plainText.get()};return e}();f.SearchHintItem=h});define("infrastructure/search/SearchHintProvider",["require","exports"],function(h,f){});
define("infrastructure/eventArgs/SearchProgressEventArgs",["require","exports"],function(h,f){var k=function(){return function(){this.query=this.results=this.message=this.error=this.endpointUrl=this.searchType=this.status=null}}();f.SearchProgressEventArgs=k});
define("infrastructure/search/SearchManager",["require","exports","infrastructure/FeatureSetCollection"],function(h,f,k){var l;(function(e){e.IDLE="Idle";e.SEARCHING="Searching";e.ERROR="Error"})(l=f.Status||(f.Status={}));h=function(){function e(c){this._searchProviders=[];this._fscRootID="SearchResultsCollection";this._count=0;this._fscSourceName="Search";this.app=c;this._registerCommands();this.app.event("SearchProgressEvent").subscribe(this,this._searchProgress)}e.prototype._resetFeatureSetCollection=
function(){this._fsc||(this._fsc=this.app.featureSetManager.getCollectionById(this._fscRootID));this._fsc?(this.app.featureSetManager.getCollectionById(this._fsc.id)||this.app.featureSetManager.addCollection(this._fsc),this._fsc.clear(),this.app.featureSetManager.tryCloseCollection(this._fsc.id)):(this._fsc=new k.FeatureSetCollection,this._fsc.id=this._fscRootID,this._fsc.sourceName=this._fscSourceName,this.app.featureSetManager.addCollection(this._fsc))};e.prototype.getSearchHints=function(c,a){var b=
this._enabledProviders();if(0==b.length)this.app.trace.warning("No search providers enabled.");else for(var d=0;d<b.length;d++)b[d].supportsHints&&b[d].getSearchHints(c,a)};e.prototype._registerCommands=function(){this.app.command("RegisterSearchProvider").register(this,this._registerProvider);this.app.command("Search").register(this,this._search);this.app.command("GlobalSearch").register(this,this._search);this.app.command("CancelSearch").register(this,this._cancelSearch);this.app.command("ClearSearch").register(this,
this._clearSearch)};e.prototype._registerProvider=function(c){if(!c)throw Error("Search Provider cannot be null.");for(var a=0;a<this._searchProviders.length;a++)if(this._searchProviders[a].id==c.id)throw Error("Search Provider '{0}' already registered.".format(c.name));this._searchProviders.push(c)};e.prototype._enabledProviders=function(){for(var c=[],a=0;a<this._searchProviders.length;a++){var b=this._searchProviders[a];b.isEnabled&&(!0===this.app.isOffline.get()?b.supportsOffline&&c.push(b):c.push(b))}return c};
e.prototype._isSearching=function(){for(var c=0;c<this._searchProviders.length;c++)if(this._searchProviders[c].status==l.SEARCHING)return!0;return!1};e.prototype._cancelSearch=function(){if(this._isSearching())for(var c=0;c<this._searchProviders.length;c++){var a=this._searchProviders[c];a.status==l.SEARCHING&&a.cancelSearch()}};e.prototype._clearSearch=function(){this._isSearching()&&this._cancelSearch();this._resetFeatureSetCollection()};e.prototype._search=function(c){this._isSearching()&&this._cancelSearch();
this._resetFeatureSetCollection();if(c&&""!=c.replace(/ /g,"")){var a=this._enabledProviders();if(0==a.length)this.app.trace.warning("No search providers enabled.");else{var b=this.app.getResource("Mapping","language-search-fsc-display-name");this._fsc.displayName.set(b.format(c));this.app.featureSetManager.isCollectionOpen(this._fsc.id)||this.app.featureSetManager.openCollection(this._fsc.id);for(b=0;b<a.length;b++)a[b].search(this._fsc,c)}}else this.app.trace.warning("Cannot perform search without search text.")};
e.prototype._searchProgress=function(c){var a=!0;if(c.status!=l.SEARCHING){for(var b=0;b<this._searchProviders.length;b++)this._searchProviders[b].status==l.SEARCHING&&(a=!1);a&&this.app.featureSetManager.tryCloseCollection(c.results.id)}};return e}();f.SearchManager=h});define("infrastructure/project/ModuleState",["require","exports"],function(h,f){});define("infrastructure/webMap/ServiceLayer",["require","exports"],function(h,f){});
define("infrastructure/webMap/SpatialReference",["require","exports"],function(h,f){});
define("infrastructure/webMap/Geometry",["require","exports"],function(h,f){(function(f){f.POINT="esriGeometryPoint";f.MULTIPOINT="esriGeometryMultipoint";f.POLYLINE="esriGeometryPolyline";f.POLYGON="esriGeometryPolygon";f.EXTENT="esriGeometryEnvelope";f.fromEsriGeometryType=function(l){if(l){if(l.startsWith("esriGeometry"))return l;switch(l){case "point":return f.POINT;case "multipoint":return f.MULTIPOINT;case "polyline":return f.POLYLINE;case "polygon":return f.POLYGON;case "extent":return f.EXTENT;
default:throw Error("GeometryType.fromEsriGeometryType: Unrecognized geometry type.");}}}})(f.GeometryType||(f.GeometryType={}))});define("infrastructure/webMap/Feature",["require","exports"],function(h,f){});define("infrastructure/webMap/FeatureSet",["require","exports"],function(h,f){});
define("infrastructure/webMap/Symbol",["require","exports"],function(h,f){(function(f){f.SIMPLE_MARKER="esriSMS";f.SIMPLE_LINE="esriSLS";f.SIMPLE_FILL="esriSFS";f.PICTURE_MARKER="esriPMS";f.PICTURE_FILL="esriPFS";f.TEXT="esriTS"})(f.SymbolType||(f.SymbolType={}));(function(f){f.CIRCLE="esriSMSCircle";f.CROSS="esriSMSCross";f.DIAMOND="esriSMSDiamond";f.SQUARE="esriSMSSquare";f.X="esriSMSX";f.TRIANGLE="esriSMSTriangle";f.PATH="esriSMSPath"})(f.SimpleMarkerStyle||(f.SimpleMarkerStyle={}));(function(f){f.DASH=
"esriSLSDash";f.DASH_DOT="esriSLSDashDot";f.DASH_DOT_DOT="esriSLSDashDotDot";f.DOT="esriSLSDot";f.NONE="esriSLSNull";f.SOLID="esriSLSSolid"})(f.SimpleLineStyle||(f.SimpleLineStyle={}));(function(f){f.BACKWARD_DIAGONAL="esriSFSBackwardDiagonal";f.CROSS="esriSFSCross";f.DIAGONAL_CROSS="esriSFSDiagonalCross";f.FORWARD_DIAGONAL="esriSFSForwardDiagonal";f.HORIZONTAL="esriSFSHorizontal";f.NONE="esriSFSNull";f.SOLID="esriSFSSolid";f.VERTICAL="esriSFSVertical"})(f.SimpleFillStyle||(f.SimpleFillStyle={}));
(function(f){f.BASELINE="baseline";f.TOP="top";f.MIDDLE="middle";f.BOTTOM="bottom"})(f.VerticalAlignment||(f.VerticalAlignment={}));(function(f){f.LEFT="left";f.RIGHT="right";f.CENTER="center";f.JUSTIFY="justify"})(f.HorizontalAlignment||(f.HorizontalAlignment={}));(function(f){f.ITALIC="italic";f.NORMAL="normal";f.OBLIQUE="oblique"})(f.FontStyle||(f.FontStyle={}));(function(f){f.BOLD="bold";f.BOLDER="bolder";f.LIGHTER="lighter";f.NORMAL="normal"})(f.FontWeight||(f.FontWeight={}));(function(f){f.LINE_THROUGH=
"line-through";f.UNDERLINE="underline";f.NONE="none"})(f.TextDecoration||(f.TextDecoration={}))});
define("infrastructure/webMap/Renderer",["require","exports"],function(h,f){(function(f){f.SIMPLE="simple";f.UNIQUE_VALUE="uniqueValue";f.CLASS_BREAKS="classBreaks";f.HEATMAP="heatmap"})(f.RendererType||(f.RendererType={}));(function(f){f.BY_FIELD="esriNormalizeByField";f.BY_LOG="esriNormalizeByLog";f.BY_PERCENT_OF_TOTAL="esriNormalizeByPercentOfTotal"})(f.NormalizationType||(f.NormalizationType={}));(function(f){f.NATURAL_BREAKS="esriClassifyNaturalBreaks";f.EQUAL_INTERVAL="esriClassifyEqualInterval";
f.QUANTILE="esriClassifyQuantile";f.STANDARD_DEVIATION="esriClassifyStandardDeviation";f.GEOMETRICAL_INTERVAL="esriClassifyGeometricalInterval"})(f.ClassificationMethod||(f.ClassificationMethod={}))});define("infrastructure/webMap/DrawingInfo",["require","exports"],function(h,f){});define("infrastructure/webMap/Domain",["require","exports"],function(h,f){var k=f.DomainType||(f.DomainType={});k.INHERITED="inherited";k.RANGE="range";k.CODED_VALUE="codedValue"});
define("infrastructure/webMap/Field",["require","exports"],function(h,f){});define("infrastructure/webMap/Template",["require","exports"],function(h,f){});define("infrastructure/webMap/Type",["require","exports"],function(h,f){});define("infrastructure/webMap/LayerDefinition",["require","exports"],function(h,f){});define("infrastructure/webMap/PopupInfo",["require","exports"],function(h,f){});define("infrastructure/webMap/Layer",["require","exports"],function(h,f){});
define("infrastructure/webMap/FeatureCollection",["require","exports"],function(h,f){});define("infrastructure/webMap/OperationalLayer",["require","exports"],function(h,f){var k=f.OperationalLayerType||(f.OperationalLayerType={});k.CSV="CSV";k.WMS="WMS";k.KML="KML"});define("infrastructure/project/DrawingInfo",["require","exports"],function(h,f){});define("infrastructure/project/LayerDefinition",["require","exports"],function(h,f){});
define("infrastructure/project/Feature",["require","exports"],function(h,f){});define("infrastructure/project/FeatureSet",["require","exports"],function(h,f){});define("infrastructure/project/Layer",["require","exports"],function(h,f){});define("infrastructure/project/ServiceLayer",["require","exports"],function(h,f){});define("infrastructure/project/FeatureCollection",["require","exports"],function(h,f){});define("infrastructure/project/OperationalLayer",["require","exports"],function(h,f){});
define("infrastructure/SimpleRenderer",["require","exports"],function(h,f){var k=function(){function l(){this.fillColor=new esri.Color([236,236,0,0.22745]);this.borderColor=new esri.Color([204,204,51,1]);this.borderWidth=2;this.polylineOpacity=1;this.defaultSymbol=null;this._pictureMarkerSymbolCache={}}l.prototype.clone=function(){var e=new l;e.fillColor=this.fillColor;e.borderColor=this.borderColor;e.borderWidth=this.borderWidth;return e};l.prototype.getSymbol=function(e,c,a){void 0===a&&(a=!1);
if(!e||!e.geometry)return null;e.getLayer();var b=0,d=0,g=0,m=0;c&&(c instanceof esri.symbol.SimpleLineSymbol&&(b=Math.max(c.width,this.borderWidth),a&&3<b&&(b-=2)),c instanceof esri.symbol.SimpleMarkerSymbol&&(d=c.size+(c.outline?c.outline.width:0),g=c.xoffset,m=c.yoffset),c instanceof esri.symbol.PictureMarkerSymbol&&(d=Math.max(c.height,c.width),g=c.xoffset,m=c.yoffset),24>d&&(d=24));c||(c=e.symbol);return e.geometry instanceof esri.geometry.Point||e.geometry instanceof esri.geometry.Multipoint?
(b=new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,d||24,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,this.borderColor,this.borderWidth),this.fillColor),b.setOffset(g,m),b):e.geometry instanceof esri.geometry.Polygon?(g=esri.symbol.SimpleLineSymbol.STYLE_SOLID,a&&c&&(g=c.outline?c.outline.style:esri.symbol.SimpleLineSymbol.STYLE_SOLID),new esri.symbol.SimpleFillSymbol(esri.symbol.SimpleFillSymbol.STYLE_SOLID,new esri.symbol.SimpleLineSymbol(g,
this.borderColor,this.borderWidth),this.fillColor)):e.geometry instanceof esri.geometry.Polyline?(g=esri.symbol.SimpleLineSymbol.STYLE_SOLID,a&&c&&(g=c.style),c=new esri.Color(this.borderColor.toHex()),c.a=this.polylineOpacity,new esri.symbol.SimpleLineSymbol(g,c,(b||this.borderWidth)+2)):null};l.prototype.toJson=function(){return{fillColor:this.fillColor,borderColor:this.borderColor,borderWidth:this.borderWidth}};return l}();f.SimpleRenderer=k});
define("infrastructure/symbology/SymbolColor",["require","exports"],function(h,f){var k=function(){function l(e){if(e instanceof esri.Color)this._fromEsriColor(e);else if(this._isHSV(e))this.hue=this._clamp(e.h,0,1),this.value=this._clamp(e.v,0,1),this.saturation=this._clamp(e.s,0,1),this.alpha=null==e.a?1:this._clamp(e.a,0,1);else if(this._isRGB(e)){var c=void 0,c=1<e.r&&1<e.g&&1<e.b?this._fromRGB({r:e.r/255,g:e.g/255,b:e.b/255,a:e.a}):this._fromRGB({r:this._clamp(e.r,0,1),g:this._clamp(e.g,0,1),
b:this._clamp(e.b,0,1)});this.hue=c.h;this.value=c.v;this.saturation=c.s;this.alpha=null==e.a?1:this._clamp(e.a,0,1)}else(c=esri.Color.fromRgb(e))?this._fromEsriColor(c):(e=this._hexToRGB(e),c=this._fromRGB(e),this.hue=c.h,this.value=c.v,this.saturation=c.s,this.alpha=1)}l.prototype.toHex=function(){return this._rgbToHex(this.toRGB())};l.prototype.toRGBAString=function(){var e=this.toRGB();return"rgba("+Math.round(255*e.r).toString()+","+Math.round(255*e.g).toString()+","+Math.round(255*e.b).toString()+
","+e.a.toString()+")"};l.prototype.toEsriColor=function(e){void 0===e&&(e=!0);var c=new esri.Color,a=this.toRGB();c.r=Math.round(255*a.r);c.g=Math.round(255*a.g);c.b=Math.round(255*a.b);c.a=e?a.a:1;return c};l.prototype.darken=function(e,c){void 0===c&&(c=!0);e=this._clamp(e,0,1);return new l({h:this.hue,v:this.value*(1-e),s:this.saturation,a:c?this.alpha:1})};l.prototype.lighten=function(e,c){void 0===c&&(c=!0);e=this._clamp(e,0,1);return new l({h:this.hue,v:this.value+(1-this.value)*e,s:this.saturation*
(1-e),a:c?this.alpha:1})};l.prototype.blend=function(e,c){e=this._clamp(e,0,1);var a=c.toRGB(),b=this.toRGB();return new l({r:b.r+(a.r-b.r)*e,g:b.g+(a.g-b.g)*e,b:b.b+(a.b-b.b)*e,a:b.a+(a.a-b.a)*e})};l.prototype.toRGB=function(){var e,c,a,b=this.saturation*this.value,d=6*this.hue,g=b*(1-Math.abs(d%2-1)),m=this.value-b;switch(Math.floor(d)%6){case 0:e=b+m;c=g+m;a=m;break;case 1:e=g+m;c=b+m;a=m;break;case 2:e=m;c=b+m;a=g+m;break;case 3:e=m;c=g+m;a=b+m;break;case 4:e=g+m;c=m;a=b+m;break;case 5:e=b+m,
c=m,a=g+m}return{r:e,g:c,b:a,a:this.alpha}};l.prototype.equals=function(e){return e.hue===this.hue&&e.value===this.value&&e.saturation===this.saturation&&e.alpha===this.alpha?!0:!1};l.prototype.setAlpha=function(e){return new l({h:this.hue,s:this.saturation,v:this.value,a:e})};l.prototype._fromRGB=function(e){var c,a=Math.max(e.r,e.g,e.b);c=Math.min(e.r,e.g,e.b);var b=a-c;c=(0===b?0:a===e.r?(e.g-e.b)/b:a===e.g?2+(e.b-e.r)/b:4+(e.r-e.g)/b)/6;0>c&&(c+=1);return{h:c,s:0===b?0:b/a,v:a,a:null==e.a?1:e.a}};
l.prototype._fromEsriColor=function(e){e=this._fromRGB({r:e.r/255,g:e.g/255,b:e.b/255,a:e.a});this.hue=e.h;this.value=e.v;this.saturation=e.s;this.alpha=e.a};l.prototype._rgbToHex=function(e){var c=("00"+Math.floor(255*e.r).toString(16)).slice(-2),a=("00"+Math.floor(255*e.g).toString(16)).slice(-2);e=("00"+Math.floor(255*e.b).toString(16)).slice(-2);return"#"+c+a+e};l.prototype._hexToRGB=function(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(c,a,b,d){return a+a+b+b+d+d});return(e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e))?
{r:parseInt(e[1],16)/255,g:parseInt(e[2],16)/255,b:parseInt(e[3],16)/255,a:1}:null};l.prototype._clamp=function(e,c,a){return Math.min(Math.max(e,c),a)};l.prototype._isHSV=function(e){return $.isNumeric(e.h)&&$.isNumeric(e.s)&&$.isNumeric(e.v)?!0:!1};l.prototype._isRGB=function(e){return $.isNumeric(e.r)&&$.isNumeric(e.g)&&$.isNumeric(e.b)?!0:!1};return l}();f.SymbolColor=k});
define("infrastructure/ColorUtils",["require","exports","infrastructure/symbology/SymbolColor"],function(h,f,k){function l(c){if("string"===typeof c){var a=e(c);if(a)return new dojo.Color({r:a.r,g:a.g,b:a.b,a:a.a})}dojo.isArray(c)&&4===c.length&&1<c[3]&&(c[3]/=255);return new dojo.Color(c)}function e(c){if(dojo.isArray(c))return new esri.Color(l(c));if("string"===typeof c&&c.startsWith("#")&&9===c.length){var a=parseInt(c.slice(1,3),16),b=parseInt(c.slice(3,5),16),d=parseInt(c.slice(5,7),16);c=parseInt(c.slice(7,
9),16);return new esri.Color([b,d,c,a/255])}return new esri.Color(c)}f.getColorFromList=l;f.getColorFromString=e;f.getStringFromList=function(c){if(c){if(4===c.length)return 1<c[3]&&(c[3]/=255),"rgba({0}, {1}, {2}, {3})".format(c[0],c[1],c[2],c[3]);if(3===c.length)return"rgb({0}, {1}, {2})".format(c[0],c[1],c[2])}};f.getStringFromHex=function(c){if("string"===typeof c&&c.startsWith("#")){if(9===c.length){var a=parseInt(c.slice(1,3),16),b=parseInt(c.slice(3,5),16),d=parseInt(c.slice(5,7),16);c=parseInt(c.slice(7,
9),16);return"rgba({0}, {1}, {2}, {3})".format(b,d,c,a/255)}if(7===c.length)return b=parseInt(c.slice(1,3),16),d=parseInt(c.slice(3,5),16),c=parseInt(c.slice(5,7),16),"rgb({0}, {1}, {2})".format(b,d,c)}};f.generateRandomColors=function(c){void 0===c&&(c=6);for(var a=[],b=Math.random(),d=0;d<c;d++){var g=b+1/c*d,g=g-Math.floor(g),g=new k.SymbolColor({h:g,s:0.8,v:1});0===d%3&&(g=g.darken(Math.random()/1.8));1===d%3&&(g=g.lighten(Math.random()/1.1));a.push(g)}return a.sort(function(a){return 0.5-Math.random()})};
f.generateRandomColor=function(){var c=Math.random();return new k.SymbolColor({h:c,s:0.8,v:1})};f.isColorInputSupported=function(){if(-1<window.navigator.userAgent.indexOf("GeocortexApp.Windows"))return!1;var c=document.createElement("input");c.setAttribute("type","color");return"text"!==c.type}});
define("infrastructure/PromiseUtils",["require","exports"],function(h,f){(function(f){f.allSkipRejected=function(f,e){var c={};return Promise.resolve(f).then(function(a){a=(a||[]).map(function(a){return Promise.resolve(a)["catch"](function(a){e&&console.error(a);return c})});return Promise.all(a).then(function(a){return a.filter(function(a){return a!==c})})})};f.mapSkipRejected=function(f,e,c,a){var b={};return Promise.resolve(f).then(function(d){d=(d||[]).map(function(a){return Promise.resolve(a)["catch"](function(a){return b})});
return Promise.map(d,function(d,c,q){return Promise["try"](function(){return e(d,c,q)})["catch"](function(d){a&&console.error(d);return b})},c).then(function(a){return a.filter(function(a){return a!==b})})})};f.propsSkipRejected=function(f){return Promise.resolve(f).then(function(e){var c={};return Promise.map(Object.keys(e),function(a){return Promise.resolve(e[a]).then(function(b){c[a]=b},function(a){})})["return"](c)})};f.warnOnReject=function(f,e,c){return Promise.resolve(f)["catch"](function(a){e.trace.warning(c.format(a));
return Promise.reject(a)})}})(f.PromiseUtils||(f.PromiseUtils={}))});define("infrastructure/symbology/SymbolType",["require","exports"],function(h,f){var k=function(){return function(){}}();k.POINT="point";k.MULTIPOINT="multipoint";k.POLYLINE="polyline";k.POLYGON="polygon";k.TEXT="text";f.SymbolType=k});
define("infrastructure/SymbolUtils","require exports infrastructure/symbology/SymbolType geocortex/framework/utils/utils geocortex/framework-ui/LazyObservable infrastructure/BrowserUtils".split(" "),function(h,f,k,l,e,c){function a(a){a||(a={});return new dojo.Color({a:a.a?a.a:p.a,r:a.r?a.r:p.r,g:a.g?a.g:p.g,b:a.b?a.b:p.b})}function b(){return new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,14,d().setWidth(0),a())}function d(){return new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,
a({a:0.8}),2)}function g(){return new esri.symbol.SimpleFillSymbol(esri.symbol.SimpleFillSymbol.STYLE_SOLID,d(),a({a:0.5}))}function m(a){void 0===a&&(a=!1);var b=new esri.symbol.TextSymbol(""),d=new esri.symbol.Font;d.setSize("14pt");d.setFamily("Calibri");d.setWeight(esri.symbol.Font.WEIGHT_BOLD);b.setFont(d);b.setAlign(esri.symbol.TextSymbol.ALIGN_START);a||(b.setHaloColor(new esri.Color("#FFFFFF")),b.setHaloSize(1));return b}function q(a,b){return a.color.toHex()===b.color.toHex()&&a.style===
b.style&&a.type===b.type&&a.width===b.width}var n=c.isIE();f.defaultPointMarkup=new e.LazyObservable(null,function(){return b()},!1);f.defaultPolylineMarkup=new e.LazyObservable(null,function(){return d()},!1);f.defaultPolygonMarkup=new e.LazyObservable(null,function(){return g()},!1);f.defaultTextMarkup=new e.LazyObservable(null,function(){return m(9===n||11===n)},!1);f.POINTS_TO_PIXELS=96/72;var p={r:204,g:51,b:51,a:1};f.defaultSymbolColor=a;f.defaultMarkerSymbol=b;f.defaultLineSymbol=d;f.defaultFillSymbol=
g;f.defaultTextSymbol=m;f.defaultSymbol=function(a){switch(a){case k.SymbolType.POINT:case k.SymbolType.MULTIPOINT:return b();case k.SymbolType.POLYLINE:return d();case k.SymbolType.POLYGON:return g();case k.SymbolType.TEXT:return m()}};f.defaultMarkupSymbol=function(a){switch(a){case k.SymbolType.POINT:case k.SymbolType.MULTIPOINT:return f.defaultPointMarkup.get();case k.SymbolType.POLYLINE:return f.defaultPolylineMarkup.get();case k.SymbolType.POLYGON:return f.defaultPolygonMarkup.get();case k.SymbolType.TEXT:return f.defaultTextMarkup.get()}};
f.stringToHash=function(a){for(var b=5381,d=a.length;d;)b=33*b^a.charCodeAt(--d);return b>>>0};f.layerFeatureTypeToSymbolType=function(a){return"None"===a?null:"Line"==a?k.SymbolType.POLYLINE:a.toLowerCase()};f.fromEsriSymbolType=function(a){return"simplemarkersymbol"===a||"picturemarkersymbol"===a?k.SymbolType.POINT:"simplelinesymbol"===a?k.SymbolType.POLYLINE:"simplefillsymbol"===a?k.SymbolType.POLYGON:"textsymbol"===a?k.SymbolType.TEXT:null};f.webMapAngleToJSAPIAngle=function(a){a%=360;return a=
0>a?Math.abs(a):360-a};f.rotate=function(a,b,d,c,g){var e=Math.PI/180*g;g=Math.cos(e);e=Math.sin(e);return{x:g*(d-a)+e*(c-b)+a,y:g*(c-b)-e*(d-a)+b}};f.createSymbolSwatch=function(a,b,d){a=dojox.gfx.createSurface(a,b,b);d=esri.symbol.getShapeDescriptors(d);a.createShape(d.defaultShape).setFill(d.fill).setStroke(d.stroke).applyTransform({dx:0.5*b,dy:0.5*b})};f.createTextSymbolSwatch=function(a,b,d,c){a=dojox.gfx.createSurface(a,b,b);d.setText("Aa");var g=esri.symbol.getShapeDescriptors(d);g.defaultShape.x+=
0.5*b;g.defaultShape.y+=0.5*b;b=a.createShape(g.defaultShape).setFill(g.fill).setFont(g.font);d.haloColor&&d.haloSize&&(a=l.alphaNumericToken(),d=c._getDilateFilter(d.haloColor,d.haloSize,a),delete c._svgFilters[a],d.x=0,d.y=0,d.width="120%",d.height="120%",b.setFilter(d),b.rawNode.setAttribute("filter","url(#"+a+")"))};f.esriSymbolsEqual=function(a,b){if(!a||!b)return!1;if(a===b)return!0;if(a.type!==b.type)return!1;switch(a.type){case "simplemarkersymbol":return a.color.toHex()===b.color.toHex()&&
a.angle===b.angle&&a.size===b.size&&a.style===b.style&&a.xoffset===b.xoffset&&a.yoffset===b.yoffset&&q(a.outline,b.outline);case "picturemarkersymbol":return a.color.toHex()===b.color.toHex()&&a.angle===b.angle&&a.height===b.height&&a.size===b.size&&a.url===b.url&&a.width===b.width&&a.xoffset===b.xoffset&&a.yoffset===b.yoffset;case "simplelinesymbol":return q(a,b);case "cartographiclinesymbol":return a.color.toHex()===b.color.toHex()&&a.cap===b.cap&&a.miterLimit===b.miterLimit&&a.join===b.join&&a.style===
b.style&&a.type===b.type&&a.width===b.width;case "simplefillsymbol":return a.color.toHex()===b.color.toHex()&&a.style===b.style&&q(a.outline,b.outline);case "picturefillsymbol":return a.color.toHex()===b.color.toHex()&&a.height===b.height&&a.url===b.url&&a.width===b.width&&a.xoffset===b.xoffset&&a.yoffset===b.yoffset&&a.xscale===b.xscale&&a.yscale===b.yscale&&q(a.outline,b.outline);case "textsymbol":return a.color.toHex()===b.color.toHex()&&a.align===b.align&&a.angle===b.angle&&a.decoration===b.decoration&&
a.font.decoration===b.font.decoration&&a.font.family===b.font.family&&a.font.size===b.font.size&&a.font.style===b.font.style&&a.font.variant===b.font.variant&&a.font.weight===b.font.weight&&a.haloColor.toHex()===b.haloColor.toHex()&&a.haloSize===b.haloSize&&a.horizontalAlignment===b.horizontalAlignment&&a.kerning===b.kerning&&a.rotated===b.rotated&&a.text===b.text&&a.verticalAlignment===b.verticalAlignment&&a.xoffset===b.xoffset&&a.yoffset===b.yoffset;default:return!1}}});
define("infrastructure/HighlightManager","require exports infrastructure/SimpleRenderer infrastructure/ColorUtils infrastructure/Feature infrastructure/PromiseUtils infrastructure/GraphicUtils infrastructure/GraphicsLayerUtils infrastructure/symbology/SymbolColor infrastructure/SymbolUtils geocortex/essentials/utilities/GraphicsLayerUtilities infrastructure/GeometryUtils".split(" "),function(h,f,k,l,e,c,a,b,d,g,m,q){f.HIGHLIGHT_ID_PROPERTY="__gcxHlId";h=function(){function n(a){this.activeHighlightLayerName=
null;this.onMaxGeometryVerticesExceeded=function(){};this._highlightLayers={};this._managedGraphics={};this._outerHighlightRenderer=new k.SimpleRenderer;this._highlightRenderer=new k.SimpleRenderer;this._focusRenderer=new k.SimpleRenderer;this._outerFocusRenderer=new k.SimpleRenderer;this._defaultHighlightLayerName=null;this._minBorder=1;this._defaultBorderOffset=3;this._ramerGeomGeneralizationDisabled=!0;this._ramerDeviationInMeters=100;this._maxHighlightableGeometryVertices=this._ramerGeomVerticesThreshold=
this._ramerEpsilon=0;this._geometryCache=[];this._maxGeomCacheItems=50;this._supressedHighlightIds=[];this.app=a}n.prototype.getHighlightFillColor=function(){return this._toARGBHex(this._outerHighlightRenderer.fillColor)};n.prototype.getHighlightBorderColor=function(){return this._toARGBHex(this._highlightRenderer.borderColor)};n.prototype.getHighlightBorderWidth=function(){return this._outerHighlightRenderer.borderWidth};n.prototype.setHighlightFillColor=function(a){a=a instanceof esri.Color?a:l.getColorFromString(a);
this._outerHighlightRenderer.fillColor=a;this._highlightRenderer.fillColor=new esri.Color("transparent")};n.prototype.setHighlightBorderColor=function(a){a=a instanceof esri.Color?a:l.getColorFromString(a);this.setInnerHighlightBorderColor(a);this.setOuterHighlightBorderColor((new d.SymbolColor(a)).darken(0.4,!0).toEsriColor())};n.prototype.setOuterHighlightBorderColor=function(a){a=a instanceof esri.Color?a:l.getColorFromString(a);this._outerHighlightRenderer.borderColor=a};n.prototype.setInnerHighlightBorderColor=
function(a){a=a instanceof esri.Color?a:l.getColorFromString(a);this._highlightRenderer.borderColor=a};n.prototype.setBorderWidth=function(a){a<this._minBorder&&(a=this._minBorder);this.setOuterBorderWidth(a);a-=this._defaultBorderOffset;a<this._minBorder&&(a=this._minBorder);this.setInnerBorderWidth(a)};n.prototype.setInnerBorderWidth=function(a){this._highlightRenderer.borderWidth=a;this._focusRenderer.borderWidth=a};n.prototype.setOuterBorderWidth=function(a){this._outerHighlightRenderer.borderWidth=
a;this._outerFocusRenderer.borderWidth=a};n.prototype.getFocusedFillColor=function(){return this._toARGBHex(this._outerFocusRenderer.fillColor)};n.prototype.getFocusedBorderColor=function(){return this._toARGBHex(this._focusRenderer.borderColor)};n.prototype.setFocusedFillColor=function(a){a=l.getColorFromString(a);this._outerFocusRenderer.fillColor=a;this._focusRenderer.fillColor=new esri.Color("transparent")};n.prototype.setFocusedBorderColor=function(a){a=l.getColorFromString(a);this.setInnerFocusedBorderColor(a);
this.setOuterFocusedBorderColor((new d.SymbolColor(a)).darken(0.4,!0).toEsriColor())};n.prototype.setOuterFocusedBorderColor=function(a){a=a instanceof esri.Color?a:l.getColorFromString(a);this._outerFocusRenderer.borderColor=a};n.prototype.setInnerFocusedBorderColor=function(a){a=a instanceof esri.Color?a:l.getColorFromString(a);this._focusRenderer.borderColor=a};n.prototype.setHighlightLineOpacity=function(a){this._outerHighlightRenderer.polylineOpacity=a;this._highlightRenderer.polylineOpacity=
a};n.prototype.getHighlightLayers=function(){return this._highlightLayers};n.prototype.getMaxHighlightableGeometryVertices=function(){return this._maxHighlightableGeometryVertices};n.prototype.setMaxHighlightableGeometryVertices=function(a){this._maxHighlightableGeometryVertices=(a=parseInt(a.toString(),10))&&!isNaN(a)?a:0};n.prototype.getOrCreateHighlightLayer=function(a,d,c){if(!a)return this._highlightLayers[this._defaultHighlightLayerName];if(this._highlightLayers.hasOwnProperty(a))return this._highlightLayers[a];
var g=b.getInternalGraphicsLayer(a,this.app,b.GraphicsLayerType.Highlight);if(null!==d&&void 0!==d||null!==c&&void 0!==c)g.renderer=this._outerHighlightRenderer.clone(),null!==d&&void 0!==d&&(g.renderer.fillColor="string"==typeof d?l.getColorFromString(d):l.getColorFromList(d)),null!==c&&void 0!==c&&(g.renderer.borderColor="string"==typeof c?l.getColorFromString(c):l.getColorFromList(c));this._highlightLayers[a]=g;m.addToGraphicsLayerIdsToExclude([b.ExcludeFromEnum.ExportApplyStateName,b.ExcludeFromEnum.WebMapName],
g.id);this.activeHighlightLayerName&&""!==this.activeHighlightLayerName||(this.activeHighlightLayerName=a);this.app.event("HighlightLayerCreated").publish(a);return g};n.prototype.setActiveHighlightLayer=function(a){a&&(this._highlightLayers.hasOwnProperty(a)||this.getOrCreateHighlightLayer(a),this.activeHighlightLayerName=a)};n.prototype.setGeometryGeneralizationParams=function(a,b){var d=this;this._ramerGeomVerticesThreshold=0<=a?a:0;this._ramerDeviationInMeters=0<=b?b:0;if(0===this._ramerGeomVerticesThreshold||
0===this._ramerDeviationInMeters)return this._ramerEpsilon=0,this._ramerGeomGeneralizationDisabled=!0,Promise.resolve();this._ramerGeomGeneralizationDisabled=!1;return q.convertMetersToMapPoints(this.app.site.essentialsMap,this._ramerDeviationInMeters).then(function(a){d._clearGeometryCache();d._ramerEpsilon=a},function(a){return a})};n.prototype.getGeometryGeneralizationParams=function(){return{thresholdVertices:this._ramerGeomVerticesThreshold,maxDeviationMeters:this._ramerDeviationInMeters}};n.prototype.highlightEsriFeatureSet=
function(b,d){if(b&&b.features&&0!=b.features.length){var c=this.getHighlightLayerOrActive(d);c&&c.graphics||(c=this.getOrCreateHighlightLayer(d));for(var g=[],e=0;e<b.features.length;e++){var m=this._highlightGraphic(b.features[e],c,c.id);m&&g.push(m)}for(e=0;e<g.length;e++)a.moveGraphicToTop(g[e])}};n.prototype.highlightFeatures=function(a,b){this._highlightFeaturesImpl(a,b)};n.prototype.emphasizeFeatures=function(a,b){this._highlightFeaturesImpl(a,b,!0)};n.prototype.clearHighlight=function(a,b){var d=
this;if(a&&a.length&&a[0]){var c=null;b&&(c=this.getHighlightLayerOrActive(b));a[0]instanceof e.Feature?a.filter(function(a){return!!a&&!!a.esriFeature}).forEach(function(a){return d._clearFeatureHighlight(a.esriFeature.get(),c)}):a.filter(function(a){return!!a}).forEach(function(a){return d._clearFeatureHighlight(a,c)})}};n.prototype.suppressHighlight=function(a){this._supressedHighlightIds.push(this._getHighlightId(a));this.redrawHighlights()};n.prototype.enableHighlight=function(a){var b=this._getHighlightId(a),
d=this._supressedHighlightIds.indexOf(b);-1<d&&(this._supressedHighlightIds.splice(d,1),this.updateHighlightId(a,b))};n.prototype.updateHighlightId=function(a,b){var d=this;b||(b=this._getHighlightId(a));var c=this._managedGraphics[b];if(c){var g=this._refreshHighlightId(a,b);g!==b&&c.forEach(function(b){b.managedGraphic.geometry=a.geometry;b.bottomGraphic.geometry=a.geometry;b.topGraphic.geometry=a.geometry;b.gcxFeature&&b.gcxFeature.esriFeature&&b.gcxFeature.esriFeature.get()&&(b.gcxFeature.esriFeature.get()[f.HIGHLIGHT_ID_PROPERTY]=
g)});c.map(function(a){return a.highlightLayer}).forEach(function(a){return d.redrawHighlights(a)})}};n.prototype.clearEmphasis=function(a,b){var d=this;if(a&&a.length&&a[0]){var c=null;b&&(c=this.getHighlightLayerOrActive(b));a[0]instanceof e.Feature?a.filter(function(a){return!!a&&!!a.esriFeature}).forEach(function(a){return d._clearFeatureEmphasis(a.esriFeature.get(),c)}):a.filter(function(a){return!!a}).forEach(function(a){return d._clearFeatureEmphasis(a,c)})}};n.prototype.highlightGraphics=
function(b,d){if(b&&0!==b.length&&b[0]){var c=this.getHighlightLayerOrActive(d);c||(c=this.getOrCreateHighlightLayer(d));for(var g=[],e=0;e<b.length;e++){var m=this._highlightGraphic(b[e],c);m&&g.push(m)}for(e=0;e<g.length;e++)a.moveGraphicToTop(g[e])}};n.prototype.removeHighlightLayer=function(a){if(a&&this._highlightLayers.hasOwnProperty(a)){var d=this._highlightLayers[a];this.clearHighlights(d);this.app.map.removeLayer(d);delete this._highlightLayers[a];m.removeFromGraphicsLayerIdsToExclude([b.ExcludeFromEnum.ExportApplyStateName,
b.ExcludeFromEnum.WebMapName],a);this.activeHighlightLayerName===a&&(this.activeHighlightLayerName=null)}};n.prototype.clearHighlights=function(a){a||(a=this._defaultHighlightLayerName);var b;a instanceof esri.layers.GraphicsLayer?(b=a,a=this._getHighlightLayerNameFromLayerId(a.id)):b=this.getHighlightLayer(a);if(b&&a)for(var d in this._managedGraphics)if(this._managedGraphics.hasOwnProperty(d)){for(var c=this._managedGraphics[d].length-1;0<=c;c--){var g=this._managedGraphics[d][c];g.highlightLayer===
a&&(g.gcxFeature&&this.app.command("RemovePushpin").execute({feature:g.gcxFeature,tag:a}),b.remove(this._managedGraphics[d][c].bottomGraphic),b.remove(this._managedGraphics[d][c].topGraphic),this._managedGraphics[d].splice(c,1))}0==this._managedGraphics[d].length&&delete this._managedGraphics[d]}};n.prototype.refreshHighlights=function(a){var b=[],d;for(d in this._managedGraphics)if(this._managedGraphics.hasOwnProperty(d)){var c=this._managedGraphics[d],g=this._outerHighlightRenderer.borderColor,
m=this._highlightRenderer.borderColor,n=this._outerHighlightRenderer.fillColor,q=this._outerHighlightRenderer.borderWidth;try{for(var f=function(d){var g=c[d];if(a&&g.highlightLayer!==a)return"continue";d=new e.Feature({graphic:g.managedGraphic});var m=void 0;d.borderColor&&d.borderColor.get()&&(m=l.getColorFromList(d.borderColor.get()))&&k.setHighlightBorderColor(m);d.fillColor&&d.fillColor.get()&&(m=l.getColorFromList(d.fillColor.get()))&&k.setHighlightFillColor(m);d.borderWidth&&d.borderWidth.get()&&
(z=d.borderWidth.get(),0<z&&k.setBorderWidth(z));d=k._outerHighlightRenderer.getSymbol(g.managedGraphic,g.originalSymbol);g.bottomGraphic.setSymbol(d);0===b.filter(function(a){return a===g.highlightLayer}).length&&b.push(g.highlightLayer)},k=this,z,B=0;B<c.length;B++)f(B)}finally{this.setOuterHighlightBorderColor(g),this.setInnerHighlightBorderColor(m),this.setHighlightFillColor(n),this.setBorderWidth(q)}}for(d=0;d<b.length;d++)(g=this.getHighlightLayer(b[d]))&&g.redraw()};n.prototype.redrawHighlights=
function(a){var b=this;setTimeout(function(){var d={},c;for(c in b._managedGraphics)if(b._managedGraphics.hasOwnProperty(c)){var g=b._managedGraphics[c];if(g)for(var e=0;e<g.length;e++){var m=g[e];!m||a&&m.highlightLayer!==a||(d[m.highlightLayer]||(d[m.highlightLayer]=[]),d[m.highlightLayer].push({feature:m.gcxFeature||m.managedGraphic,isEmphasized:m.highlightFocused}))}}for(var n in d)d.hasOwnProperty(n)&&(c=d[n],b._highlightFeaturesImpl(c.filter(function(a){return!a.isEmphasized}).map(function(a){return a.feature}),
n,!1),b._highlightFeaturesImpl(c.filter(function(a){return a.isEmphasized}).map(function(a){return a.feature}),n,!0),b._highlightLayers[n].redraw())},0)};n.prototype.getHighlightLayer=function(a){return a?this._highlightLayers[a]:(this.app.trace.warning("Unable to get a highlight layer with null or empty name"),null)};n.prototype.getHighlightLayerOrActive=function(a){return a?this.getHighlightLayer(a):this._activeHighlightLayer()};n.prototype.activeHighlightLayerGraphics=function(){var a=this._activeHighlightLayer();
return a&&a.graphics?a.graphics.slice(0):null};n.prototype.defaultHighlightLayerGraphics=function(){var a=this.getHighlightLayer(this._defaultHighlightLayerName);return a?a.graphics.slice(0):null};n.prototype._highlightFeaturesImpl=function(b,d,c){void 0===d&&(d="");void 0===c&&(c=!1);if(b&&b.length&&b[0]){d=d||this._defaultHighlightLayerName;var g=this.getOrCreateHighlightLayer(d);if(g){for(var m=this._outerHighlightRenderer.borderColor,n=this._highlightRenderer.borderColor,q=this._outerHighlightRenderer.fillColor,
f=this._outerHighlightRenderer.borderWidth,k=[],h=0;h<b.length;h++){var z=b[h];if(z instanceof e.Feature)try{var B;z.borderColor&&z.borderColor.get()&&(B=l.getColorFromList(z.borderColor.get()))&&this.setHighlightBorderColor(B);z.fillColor&&z.fillColor.get()&&(B=l.getColorFromList(z.fillColor.get()))&&this.setHighlightFillColor(B);if(z.borderWidth&&z.borderWidth.get()){var C=z.borderWidth.get();0<=C&&this.setBorderWidth(C)}var D=this._highlightGraphic(z.esriFeature.get(),g,d,c,z);D&&k.push(D)}finally{this.setOuterHighlightBorderColor(m),
this.setInnerHighlightBorderColor(n),this.setHighlightFillColor(q),this.setBorderWidth(f)}else(D=this._highlightGraphic(z,g,d,c))&&k.push(D)}for(b=0;b<k.length;b++)a.moveGraphicToTop(k[b])}}};n.prototype._highlightGraphic=function(a,b,d,c,g){void 0===c&&(c=!1);if(a&&a.geometry&&b){var e;d||(d=this._defaultHighlightLayerName);e=this.getOrCreateHighlightLayer(d);a=this._getOrCreateMangedGraphic(a,b,d,g);if(!a)return null;var m=c?this._focusRenderer:this._highlightRenderer,n=c?this._outerFocusRenderer:
this._outerHighlightRenderer;a.bottomGraphic.hide();a.topGraphic.hide();if(a.bottomGraphic.geometry){a.highlightFocused&&!c&&(a.highlightFocused=!1);c?a.highlightFocused=!0:a.highlightStandard=!0;if(-1<this._supressedHighlightIds.indexOf(this._getHighlightId(a.managedGraphic))){this.app.command("RemovePushpin").execute({feature:a.gcxFeature,tag:d});a.bottomGraphic.hide();a.topGraphic.hide();return}b=b.renderer?b.renderer.getSymbol(a.bottomGraphic):null;m=m.getSymbol(a.bottomGraphic,a.originalSymbol,
!0);b?m=null:b=n.getSymbol(a.bottomGraphic,a.originalSymbol);a.bottomGraphic.setSymbol(b);a.topGraphic.setSymbol(m);-1===e.graphics.indexOf(a.bottomGraphic)&&e.add(a.bottomGraphic);-1===e.graphics.indexOf(a.topGraphic)&&e.add(a.topGraphic);a.bottomGraphic.show();a.topGraphic.show();(e=a.bottomGraphic.getNode())&&e.setAttribute("style","pointer-events: none");(e=a.topGraphic.getNode())&&e.setAttribute("style","pointer-events: none");c&&this._addPushpinIfNeeded(a.topGraphic,a,d,g)}return a.topGraphic}};
n.prototype._clearFeatureEmphasis=function(a,b){var d=this;if(a){var c=[];if(b)c.push(b);else for(var g in this._highlightLayers)this._highlightLayers.hasOwnProperty(g)&&c.push(this._highlightLayers[g]);c.forEach(function(b){d._refreshHighlightId(a);var c=d._retrieveManagedGraphic(a,b);if(c&&c.highlightFocused)if(c.gcxFeature&&d.app.command("RemovePushpin").execute({feature:c.gcxFeature,tag:c.highlightLayer}),c.highlightStandard){c.highlightFocused=!1;b=d._outerHighlightRenderer.borderColor;var g=
d._highlightRenderer.borderColor,e=d._outerHighlightRenderer.fillColor,m=d._outerHighlightRenderer.borderWidth;if(c.gcxFeature&&c.gcxFeature.borderColor&&c.gcxFeature.borderColor.get()){var n=l.getColorFromList(c.gcxFeature.borderColor.get());n&&d.setHighlightBorderColor(n)}c.gcxFeature&&c.gcxFeature.fillColor&&c.gcxFeature.fillColor.get()&&(n=l.getColorFromList(c.gcxFeature.fillColor.get()))&&d.setHighlightFillColor(n);c.gcxFeature&&c.gcxFeature.borderWidth&&c.gcxFeature.borderWidth.get()&&(n=c.gcxFeature.borderWidth.get(),
0<=n&&d.setBorderWidth(n));c.bottomGraphic.setSymbol(d._outerHighlightRenderer.getSymbol(c.bottomGraphic,c.originalSymbol));c.topGraphic.setSymbol(d._highlightRenderer.getSymbol(c.topGraphic,c.originalSymbol,!0));d.setOuterHighlightBorderColor(b);d.setInnerHighlightBorderColor(g);d.setHighlightFillColor(e);d.setBorderWidth(m)}else c.highlightFocused=!1,d._clearFeatureHighlight(a,b)})}};n.prototype._clearFeatureHighlight=function(a,b){var d=this;if(a){var c=[];if(b)c.push(b);else for(var g in this._highlightLayers)this._highlightLayers.hasOwnProperty(g)&&
c.push(this._highlightLayers[g]);c.forEach(function(b){var c=d._retrieveManagedGraphic(a,b);if(c)if(c.highlightFocused&&c.highlightStandard)c.highlightStandard=!1;else{var g=d._getHighlightLayerNameFromLayerId(b.id);c.highlightFocused&&c.gcxFeature&&d.app.command("RemovePushpin").execute({feature:c.gcxFeature,tag:g});b.remove(c.bottomGraphic);b.remove(c.topGraphic);c=d._getHighlightId(a);if(1===d._managedGraphics[c].length)delete d._managedGraphics[c];else if(g=d._managedGraphics[c].filter(function(a){return a.highlightLayer===
d._getHighlightLayerNameFromLayerId(b.id)})[0])g=d._managedGraphics[c].indexOf(g),d._managedGraphics[c].splice(g,1)}})}};n.prototype._getOrCreateMangedGraphic=function(a,b,d,c){var g=this._retrieveManagedGraphic(a,b);if(g)return g;var e=this._getHighlightId(a),m=this._getOrCreateHighlightGeometry(a.geometry,e);if(!m)return null;if(this._geometryExceedsMaxVertices(m)){if(dojo.isFunction(this.onMaxGeometryVerticesExceeded))this.onMaxGeometryVerticesExceeded(a);return null}g=new esri.Graphic(m,a.symbol?
esri.symbol.fromJson(a.symbol.toJson()):null);m=new esri.Graphic(m,a.symbol?esri.symbol.fromJson(a.symbol.toJson()):null);this._setHighlightId(g,e);this._setHighlightId(m,e);var e=a.getLayer(),n=null,n=e?e.renderer?e.renderer.getSymbol(a):a.symbol:a.symbol;return this._trackGraphic(a,g,m,b.id,d,n,c)};n.prototype._trackGraphic=function(a,b,d,c,g,e,m){var n=this._getHighlightId(a);this._managedGraphics.hasOwnProperty(n)?c=this._managedGraphics[n]:(c=[],this._managedGraphics[n]=c);for(n=0;n<c.length;n++)if(c[n].highlightLayer===
g)return c[n];n="";m&&m.layer&&(n=m.layer.id);a={originalLayer:n,highlightLayer:g,managedGraphic:a,bottomGraphic:b,topGraphic:d,originalSymbol:e,highlightStandard:!1,highlightFocused:!1,gcxFeature:m};c.push(a);return a};n.prototype._addPushpinIfNeeded=function(a,b,d,c){var g=a.geometry instanceof esri.geometry.Point||a.geometry instanceof esri.geometry.Multipoint;if(!g){var m=this.app.site.essentialsMap.allLayers().filter(function(a){return a.id===b.originalLayer})[0];m&&m.minScale&&m.minScale<this.app.map.getScale()?
g=!0:b.gcxFeature&&this.app.command("RemovePushpin").execute({feature:b.gcxFeature,tag:d})}g&&(c=c||new e.Feature({graphic:a}),b.gcxFeature=c,b.gcxFeature.esriFeature.get().geometry=a.geometry,this.app.command("AddPushpin").execute({feature:c,tag:d}),this.app.command("ShowPushpins").execute())};n.prototype._getHighlightLayerNameFromLayerId=function(a){if(a=this.app.map.getLayer(a))for(var b in this._highlightLayers)if(this._highlightLayers.hasOwnProperty(b)&&this._highlightLayers[b]===a)return b;
return null};n.prototype._toARGBHex=function(a){var b=("00"+Math.floor(255*a.a).toString(16)).slice(-2),d=("00"+a.r.toString(16)).slice(-2),c=("00"+a.g.toString(16)).slice(-2);a=("00"+a.b.toString(16)).slice(-2);return"#"+b+d+c+a};n.prototype._getHighlightId=function(a){if(a&&a.geometry){if(a[f.HIGHLIGHT_ID_PROPERTY])return a[f.HIGHLIGHT_ID_PROPERTY];var b=this._getGeometryHash(a.geometry);return a[f.HIGHLIGHT_ID_PROPERTY]=b}};n.prototype._getGeometryHash=function(a){return g.stringToHash(JSON.stringify(a,
"rings paths points x y xmax ymax xmin ymin".split(" "))).toString()};n.prototype._getCachedGeometry=function(a){var b=this._geometryCache.filter(function(b){return b.highlightId===a});return b.length?b[0].geometry:null};n.prototype._cacheGeometry=function(a,b){this._geometryCache.unshift({highlightId:a,geometry:b});this._geometryCache.length>this._maxGeomCacheItems&&(this._geometryCache.length=this._maxGeomCacheItems)};n.prototype._clearGeometryCache=function(){this._geometryCache.length=0};n.prototype._setHighlightId=
function(a,b){a[f.HIGHLIGHT_ID_PROPERTY]=b};n.prototype._refreshHighlightId=function(a,b){b||(b=this._getHighlightId(a));a[f.HIGHLIGHT_ID_PROPERTY]=null;var d=this._getHighlightId(a);if(d!==b&&this._managedGraphics[b]){this._managedGraphics[d]=this._managedGraphics[b];delete this._managedGraphics[b];this._managedGraphics[d].forEach(function(a){return a.managedGraphic[f.HIGHLIGHT_ID_PROPERTY]=d});var c=this._supressedHighlightIds.indexOf(b);-1<c&&(this._supressedHighlightIds.splice(c,1),this._supressedHighlightIds.push(d))}return d};
n.prototype._showHighlightLayer=function(a){this.app.map.reorderLayer(a,this.app.map.graphicsLayerIds.length-1);a.visible||a.setVisibility(!0);a!=this._highlightLayers[this._defaultHighlightLayerName]&&this.app.map.reorderLayer(this._highlightLayers[this._defaultHighlightLayerName],this.app.map.graphicsLayerIds.length-1)};n.prototype._activeHighlightLayer=function(){return this.activeHighlightLayerName?this.getHighlightLayer(this.activeHighlightLayerName):null};n.prototype._shouldGeneralizeGeometry=
function(a){if(this._ramerGeomGeneralizationDisabled||!a||!a.rings&&!a.paths)return!1;var b=0;a instanceof esri.geometry.Polygon?a.rings.forEach(function(a){return b+=a.length}):a.paths.forEach(function(a){return b+=a.length});return b>this._ramerGeomVerticesThreshold&&0<this._ramerEpsilon?!0:!1};n.prototype._getOrCreateHighlightGeometry=function(a,b){if(!a)return null;if(!this._shouldGeneralizeGeometry(a)||!b)return esri.geometry.fromJson(a.toJson());var d=this._getCachedGeometry(b);d||(d=q.getRamerDouglasPeuckerSimplifiedGeometry(a,
this._ramerEpsilon),this._cacheGeometry(b,d));return d};n.prototype._geometryExceedsMaxVertices=function(a){if(!a||!a.rings&&!a.paths||0===this._maxHighlightableGeometryVertices)return!1;var b=0;a instanceof esri.geometry.Polygon?a.rings.forEach(function(a){return b+=a.length}):a.paths.forEach(function(a){return b+=a.length});return b>this._maxHighlightableGeometryVertices};n.prototype._retrieveManagedGraphic=function(a,b){var d=null,c=this._getHighlightId(a);if(this._managedGraphics.hasOwnProperty(c))for(var g=
0;g<this._managedGraphics[c].length;g++)if(this._managedGraphics[c][g].highlightLayer===this._getHighlightLayerNameFromLayerId(b.id)){d=this._managedGraphics[c][g];break}return d};n.prototype.exportState=function(){var a=this;return Promise["try"](function(){var b=a.app.project.convert,d={highlightLayers:{},activeHighlightLayerName:a.activeHighlightLayerName,highlights:[]},c;for(c in a._highlightLayers)d.highlightLayers[c]=b.fromEsriLayer(a._highlightLayers[c]),d.highlightLayers[c].layers=[],d.highlightLayers[c].featureCollection.layers=
[];for(var g in a._managedGraphics)a._managedGraphics[g].forEach(function(a){a.highlightFocused&&!a.highlightStandard||d.highlights.push({feature:b.fromEsriGraphic(a.managedGraphic),originalLayer:a.originalLayer,highlightLayer:a.highlightLayer})});return d})};n.prototype.applyState=function(d){var g=this,e=this.app.project.convert,n={},q;for(q in d.highlightLayers)n[q]=e.toEsriLayer(d.highlightLayers[q]);n={highlightLayers:c.PromiseUtils.propsSkipRejected(n),highlights:c.PromiseUtils.mapSkipRejected(d.highlights,
function(a){return Promise.props({graphic:e.toEsriGraphic(a.feature),originalLayer:a.originalLayer,highlightLayer:a.highlightLayer})})};return Promise.props(n).then(function(c){for(var e in g._highlightLayers)g.clearHighlights(e);g._highlightLayers={};g._managedGraphics={};for(e in c.highlightLayers)g._highlightLayers[e]=c.highlightLayers[e],m.addToGraphicsLayerIdsToExclude([b.ExcludeFromEnum.ExportApplyStateName,b.ExcludeFromEnum.WebMapName],e);g.activeHighlightLayerName=d.activeHighlightLayerName;
var n=[];e=function(a){var b=c.highlights[a];g._getHighlightId(b.graphic);var d=g._highlightLayers[b.highlightLayer].graphics.filter(function(a){return g._getHighlightId(a)===g._getHighlightId(b.graphic)});0<d.length?(a=d[0],d=d[1]||new esri.Graphic(a.toJson()),g._trackGraphic(b.graphic,a,d,b.originalLayer,b.highlightLayer,null).highlightStandard=!0):(d=g._highlightGraphic(b.graphic,b.highlightLayer))&&n.push(d)};for(var q=0;q<c.highlights.length;q++)e(q);for(e=0;e<n.length;e++)a.moveGraphicToTop(n[e])})};
return n}();f.HighlightManager=h});define("infrastructure/CancellationToken",["require","exports"],function(h,f){});define("infrastructure/native/NativeMessage",["require","exports"],function(h,f){});
define("infrastructure/native/MessageClient",["require","exports","infrastructure/Dictionary"],function(h,f,k){h=function(){function f(e){this.app=e;this._handlers=new k.Dictionary;window.__geocortexNativeMessageClient=this}f.prototype._postMessage=function(e,c){var a;try{a=JSON.parse(c)}catch(b){this.app.trace.warning("Native message could not be parsed to JSON: "+c);return}for(var d=0,g=this._handlers.get(e)||[];d<g.length;d++)(0,g[d])(a)};f.prototype.subscribe=function(e,c){var a=this._handlers.get(e);
a||(a=[],this._handlers.set(e,a));a.push(c)};f.prototype.unsubscribe=function(e,c){var a=this._handlers.get(e);if(a){var b=a.indexOf(c);0<=b&&a.splice(b,1)}};f.prototype.message=function(e,c,a,b){var d=this;return new Promise(function(g,m){if(d.app.nativeManager.isNative()){var q;a&&a.register(function(){d.cancel(q)});if(b){var n=function(a){a.parameters.jobId===q&&("inProgress"===a.parameters.status?b(a.parameters):"complete"===a.parameters.status?(g(a.parameters.details),d.unsubscribe("JobProgress",
n)):"canceled"===a.parameters.status?(a=Error(a.parameters.details.message),a.name="OperationCanceled",m(a),d.unsubscribe("JobProgress",n)):"error"===a.parameters.status&&(m(Error(a.parameters.details.message)),d.unsubscribe("JobProgress",n)))};d.subscribe("JobProgress",n)}d.app.nativeManager.onNativeInitialized().then(function(){return d.app.nativeManager.xhrPost({url:d.app.localServerAddress+"/message/"+e,postData:JSON.stringify(c),method:"POST"})}).then(function(b){b=JSON.parse(b);q=b.jobId;a&&
a.isCancellationRequested?d.cancel(q):q?d.app.nativeManager.xhrPost({url:d.app.localServerAddress+"/message/JobHandshake",postData:JSON.stringify({jobId:q}),method:"POST"}):g(b.result)})["catch"](function(a){try{var b=JSON.parse(a.response.data);m(Error(b.error.message))}catch(d){m(a)}})}else m(Error("Method not supported in browser."))})};f.prototype.cancel=function(e){if(e)return this.app.nativeManager.xhrPost({url:this.app.localServerAddress+"/message/CancelJob",postData:JSON.stringify({jobId:e}),
method:"POST"})};return f}();f.MessageClient=h});define("infrastructure/native/ResourceInfo",["require","exports"],function(h,f){});
define("infrastructure/native/NativeManager",["require","exports","infrastructure/native/MessageClient"],function(h,f,k){h=function(){function f(e){this.app=e;this.nativeInitialized=!1;this._messageClient=new k.MessageClient(e)}f.prototype.isNative=function(){return/\bGeocortexApp\b/.test(navigator.userAgent)||/http:\/\/127.0.0.1(:[0-9]*)?\/viewerpackages\//gi.test(window.location.href)||this.app.isNative.get()};f.prototype.xhrGet=function(e){var c=this;return this.onNativeInitialized().then(function(){c.appendAuthorizationHeader(e);
return dojo.xhrGet(e)})};f.prototype.xhrPost=function(e){var c=this;return this.onNativeInitialized().then(function(){c.appendAuthorizationHeader(e);return dojo.xhrPost(e)})};f.prototype.appendAuthorizationHeader=function(e){e||(e={});e.headers||(e.headers={});e.headers.Authorization||(e.headers.Authorization="Token "+this.app.localServerToken)};f.prototype.message=function(e,c,a,b){return this._messageClient.message(e,c,a,b)};f.prototype.subscribe=function(e,c){return this._messageClient.subscribe(e,
c)};f.prototype.onNativeInitialized=function(){var e=this;return this._nativeInitializedPromise?this._nativeInitializedPromise:this._nativeInitializedPromise=new Promise(function(c,a){e._nativeInitializedResolve=c})};f.prototype.signalNativeInitialized=function(){this.onNativeInitialized();this.nativeInitialized=!0;this._nativeInitializedResolve()};f.prototype.getViewerResourceInfo=function(e){return this.xhrGet({url:this.app.localServerAddress+"/resource/"+this.app.localServerNamespace+"/"+e+"/info"}).then(function(c){c=
JSON.parse(c);return{name:c.name,exists:c.exists,length:c.length,lastAccessTime:c.lastAccessTime?new Date(c.lastAccessTime):null,lastWriteTime:c.lastWriteTime?new Date(c.lastWriteTime):null}})};f.prototype.hasNativeCapability=function(e){var c=this;return new Promise(function(a,b){c._capabilities?a(-1<c._capabilities.indexOf(e)):c.isNative()?geocortex.GeocortexNativeApp.capabilities(function(b){c._capabilities=b;a(-1<c._capabilities.indexOf(e))},function(b){a(!1)}):a(!1)})};return f}();f.NativeManager=
h});
define("infrastructure/CancellationTokenSource",["require","exports"],function(h,f){var k=function(){function e(){this._tokenImpl=new l}e.prototype.token=function(){return this._tokenImpl};e.prototype.cancel=function(){this._tokenImpl.cancel()};e.prototype.dispose=function(){this._tokenImpl.dispose()};e.none=function(){this._none||(this._none={isCancellationRequested:!1,register:function(c){}});return this._none};return e}();f.CancellationTokenSource=k;var l=function(){function e(){this._listeners=[];
this.isCancellationRequested=!1}e.prototype.register=function(c){this._listeners.push(c)};e.prototype.cancel=function(){this.isCancellationRequested=!0;for(var c=0;c<this._listeners.length;c++)this._listeners[c]()};e.prototype.dispose=function(){this._listeners.length=0};return e}()});
define("infrastructure/offline/OfflineMap",["require","exports"],function(h,f){(function(f){function l(e,c){return e===c||JSON.stringify(e)===JSON.stringify(c)}f.verify=function(e){if(!e)throw Error("offlineMap is null or undefined.");if(!e.id)throw Error("offlineMap.id is null or undefined.");if(!e.content)throw Error("offlineMap.content is null or undefined.");if(!e.content.geometry)throw Error("offlineMap.content.geometry is null or undefined.");if(e.content.basemaps)for(var c=0;c<e.content.basemaps.length;c++){if(!e.content.basemaps[c].url)throw Error("offlineMap.content.basemaps["+
c+"].url is null or undefined.");if(!e.content.basemaps[c].baseMapId)throw Error("offlineMap.content.basemaps["+c+"].baseMapId is null or undefined.");if(!e.content.basemaps[c].filename)throw Error("offlineMap.content.basemaps["+c+"].filename is null or undefined.");if(!e.content.basemaps[c].sourceType)throw Error("offlineMap.content.basemaps["+c+"].sourceType is null or undefined.");}else throw Error("offlineMap.content.basemaps is null or undefined.");if(e.content.layers)for(c=0;c<e.content.layers.length;c++){if(!e.content.layers[c].layerInfoUniqueId)throw Error("offlineMap.content.layers["+
c+"].layerInfoUniqueId is null or undefined.");}else throw Error("offlineMap.content.layers is null or undefined.");if(!e.properties.siteId)throw Error("offlineMap.properties.siteId is null or undefined.");if(!e.properties.viewerId)throw Error("offlineMap.properties.viewerId is null or undefined.");};f.diff=function(e,c){var a={};e.description!==c.description&&(a.description=c.description);l(e.grants,c.grants)||(a.grants=c.grants);l(e.properties,c.properties)||(a.properties=c.properties);l(e.shape,
c.shape)||(a.shape=c.shape);l(e.tags||[],c.tags||[])||(a.tags=c.tags);e.title!==c.title&&(a.title=c.title);l(e.thumbnail,c.thumbnail)||(a.thumbnail=c.thumbnail);e.version!==c.version&&(a.version=c.version);null==e.content!==(null==c.content)?a.content=c.content:null==c.content?a.content=null:l(e.content,c.content)||(a.content={},l(e.content.geometry,c.content.geometry)||(a.content.geometry=c.content.geometry),l(e.content.layers,c.content.layers)||(a.content.layers=c.content.layers),l(e.content.basemaps,
c.content.basemaps)||(a.content.basemaps=c.content.basemaps),e.content.includeAttachments!==c.content.includeAttachments&&(a.content.includeAttachments=c.content.includeAttachments));for(var b in a)if(a.hasOwnProperty(b))return a;return null}})(f.OfflineMap||(f.OfflineMap={}));(function(f){f.Type={EXPORT_TILES:"exportTiles",PREGENERATED:"pregenerated"}})(f.OfflineMapBasemap||(f.OfflineMapBasemap={}))});
define("infrastructure/offline/bundle/RequestContext",["require","exports"],function(h,f){var k=function(){return function(f,e,c){this.url=this.timeOut=this.handleAs=this.content=this.options=null;f&&dojo.mixin(this,f);this.dfd=e||new dojo.Deferred;this.options=c||null}}();f.RequestContext=k});define("infrastructure/offline/bundle/RoutingRule",["require","exports"],function(h,f){});
define("infrastructure/offline/bundle/offlineHandlers/OfflineHandler",["require","exports"],function(h,f){f.hookDeferredCallbacks=function(f){var l=f.dfd,e=f.load;e&&l.addCallback(function(a){var b=l._pendingDfd,b=b&&b.ioArgs;return e.call(b&&b.args,a,b)});var c=f.error;c&&l.addErrback(function(a){var b=l._pendingDfd,b=b&&b.ioArgs;return c.call(b&&b.args,a,b)})}});
define("infrastructure/offline/bundle/offlineHandlers/RewriteHandler",["require","exports"],function(h,f){var k=function(){function f(e,c){this.app=e;this.unhackedRequesthandler=c;this.name="Rewrite"}f.prototype.handle=function(e,c,a,b){e.url=this.rewriteRequest(e,c,a);!h.has("esri-cors")&&Modernizr.cors&&(delete h.has.cache["esri-cors"],h.has.add("esri-cors",function(){return!0}));var d=null;b.register(function(){d&&d.cancel("Pass through from ESRI cancellation.")});d=this.unhackedRequesthandler(e,
e.options).then(function(a){return e.dfd.resolve(a)},function(a){return e.dfd.errback(a)});return!0};f.prototype.rewriteRequest=function(e,c,a){if(!c||!c.parameters||!c.parameters.newUrl)throw Error("Not a rewrite rule.");e=c.parameters.newUrl;e=e.format.apply(e,a);e=e.replace("{localserver}",this.app.localServerAddress);this.app.localServerAddress&&0<this.app.localServerAddress.length&&e.startsWith(this.app.localServerAddress)&&(e=this._appendLocalServerToken(e));return e};f.prototype._appendLocalServerToken=
function(e){this.app.localServerToken&&(e.endsWith("?")||(e+=0<e.indexOf("?")?"&":"?"),e+="localServerToken="+this.app.localServerToken);return e};return f}();f.RewriteHandler=k});
define("infrastructure/offline/bundle/OfflineRouter",["require","exports","geocortex/framework/observables","infrastructure/offline/bundle/RequestContext","infrastructure/CancellationTokenSource"],function(h,f,k,l,e){h=function(){function c(a){var b=this;this.app=a;this.isReady=new k.Observable(!1);this._handlers={};this._rules=[];this.app.command("RewriteUrlForOffline").register(this,function(a,c){c(b.rewriteUrl(a))})}c.prototype.addHandler=function(a){this._handlers[a.name]=a};c.prototype.removeHandler=
function(a){return this._handlers.hasOwnProperty(a)?(delete this._handlers[a],!0):!1};c.prototype.setDefaultHandler=function(a){this._defaultHandler=a};c.prototype.setRoutingRules=function(a){this._rules=a.concat();this.isReady.set(!0)};c.prototype.setRoutingRulesFromPromise=function(a){var b=this;this._rules.length=0;this.isReady.set(!1);a.then(function(a){if(a)try{b.setRoutingRules(JSON.parse(a))}catch(c){b.app.trace.error("Unable to parse routing rules: {0}".format(c))}else b.app.trace.debug("No offline request routing table was found.")},
function(a){b.app.trace.warning("An error occurred while attempting to fetch offline request routing rules: {0}".format(a))})};c.prototype.clearRoutingRules=function(){this._rules.length=0;this.isReady.set(!1)};c.prototype.rewriteUrl=function(a){var b=this._handlers.Rewrite;if(!b)return a;a=this._stripOutProxy(a);for(var d=0;d<this._rules.length;++d){var c=this._rules[d];if("Rewrite"===c.handlerName){var e=RegExp(c.pattern).exec(a);if(e&&e.length&&0<e.length)return b.rewriteRequest(null,c,e)}}return null};
c.prototype.handle=function(a,b){var d=this,c=new e.CancellationTokenSource,m=new dojo.Deferred(function(a){c.cancel()});this._whenReady(function(){for(var e=new l.RequestContext(a,m,b),n=d._stripOutProxy(e.url),f=!1,k=0;k<d._rules.length;++k){var r=d._rules[k],h=RegExp(r.pattern).exec(n),u=!0;if(h&&r.queryParameterPatterns)for(var v in r.queryParameterPatterns)var y=RegExp(r.queryParameterPatterns[v].pattern).exec(a.content?a.content[v]:null),u=u&&!!y;if(h&&h.length&&0<h.length&&u)if(u=d._handlers[r.handlerName]){f=
!0;try{if(!1===u.handle(e,r,h,c.token()))f=!1;else break}catch(x){d.app.trace.warning("Offline request failed for resource '"+a.url+"'. "+x);m.errback(Error("Offline request failed"));break}}else d.app.trace.warning("Offline request failed for resource '"+a.url+"'. Matching rule found without handler.")}f||d._defaultHandler.handle(e,null,null,c.token())});m.then(function(){return c.dispose()},function(){return c.dispose()});return m};c.prototype._whenReady=function(a){if(this.isReady.get())a();else this.isReady.once(this,
a)};c.prototype._stripOutProxy=function(a){if(!a)return null;var b=this.app.configuration.proxyUri;if(0<=a.indexOf(b)){if(a.replace)return a.replace(b,"")}else return a;return null};return c}();f.OfflineRouter=h});
define("infrastructure/offline/bundle/EsriRequestHacker",["require","exports"],function(h,f){var k=function(){function f(e,c){this.app=e;this.requestHandler=c;this._isEnabled=!0;this._setupEsriRequestHooks()}f.prototype.unhackedRequest=function(e,c){return this._hooked_esri_request.call(esri,e,c)};f.prototype.disable=function(){this._isEnabled=!1};f.prototype.enable=function(){this._isEnabled=!0};f.prototype._setupEsriRequestHooks=function(){var e=this;if(esri.request){this._hooked_esri_request=esri.request;
esri.request=function(a,b){return e.app.offlineManager.getActiveOfflineMap()&&e._isEnabled?e.requestHandler(a,b):e._hooked_esri_request.call(esri,a,b)};var c=null;esri.request.setRequestPreCallback=function(a){c=a};this._hooked_esri_request.setRequestPreCallback(function(a){e.app.nativeManager.isNative()&&/^https:\/\/(localhost|127\.0\.0\.1)(:\d+)?\//.test(a.url)&&(a.url="http"+a.url.substring(5));c&&(a=c(a));return a})}else this.app.trace.error("Offline module could not hook into ESRI API.")};return f}();
f.EsriRequestHacker=k});
define("infrastructure/offline/bundle/EsriLayerHacker",["require","exports"],function(h,f){var k=function(){function f(e,c){this.app=e;this.urlRewriter=c;this.errorReporter=function(a){};this._captureHooks();this._extendEsriLayers()}f.prototype._captureHooks=function(){this._hooked_esri_getTileUrl=esri.layers.ArcGISTiledMapServiceLayer._meta.hidden.getTileUrl;this._hooked_ogc_getWMTSTileUrl=esri.layers.WMTSLayer._meta.hidden.getTileUrl;this._ogc__tileLoadHandler=esri.layers.WMTSLayer.superclass._tileLoadHandler;this._hooked_BingMaps_getTileUrl=
esri.virtualearth.VETiledLayer._meta.hidden.getTileUrl;this._bingMaps__tileLoadHandler=esri.virtualearth.VETiledLayer.superclass._tileLoadHandler;this._hooked_WebTiledLayer_getTileUrl=esri.layers.WebTiledLayer._meta.hidden.getTileUrl;this._webTiledLayer__tileLoadHandler=esri.layers.WebTiledLayer.superclass._tileLoadHandler;this._hooked_esri_getImageUrl=esri.layers.ArcGISDynamicMapServiceLayer._meta.hidden.getImageUrl;this._hooked_ogc_getImageUrl=esri.layers.WMSLayer._meta.hidden.getImageUrl};f.prototype._extendEsriLayers=
function(){var e=this;esri.virtualearth.VETiledLayer.extend({getTileUrl:function(c,a,b){c=e._hooked_BingMaps_getTileUrl.apply(this,[c,a,b]);return e.app.offlineManager.isOfflineMapActive.get()?e.urlRewriter(c)||c:c},_tileLoadHandler:function(c){e._bingMaps__tileLoadHandler.apply(this,[c])}});esri.layers.WMTSLayer.extend({getTileUrl:function(c,a,b){c=e._hooked_ogc_getWMTSTileUrl.apply(this,[c,a,b]);return e.app.offlineManager.isOfflineMapActive.get()?e.urlRewriter(c)||c:c},_tileLoadHandler:function(c){e._ogc__tileLoadHandler.apply(this,
[c])}});esri.layers.WebTiledLayer.extend({getTileUrl:function(c,a,b){c=e._hooked_WebTiledLayer_getTileUrl.apply(this,[c,a,b]);return e.app.offlineManager.isOfflineMapActive.get()?e.urlRewriter(c)||c:c},_tileLoadHandler:function(c){e._webTiledLayer__tileLoadHandler.apply(this,[c])}});esri.layers.ArcGISTiledMapServiceLayer.extend({getTileUrl:function(c,a,b){c=e._hooked_esri_getTileUrl.apply(this,[c,a,b]);return e.app.offlineManager.isOfflineMapActive.get()?e.urlRewriter(c)||c:c}});esri.layers.WMSLayer.extend({getImageUrl:function(c,
a,b,d){e.app.offlineManager.isOfflineMapActive.get()?e._hooked_ogc_getImageUrl.apply(this,[c,a,b,function(a){a=e.urlRewriter(a)||a;d&&d(a)}]):(a&&b||e.errorReporter("Invalid dimensions on requested map image. This is usually due to an invalid map resize event."),e._hooked_ogc_getImageUrl.apply(this,arguments))}});esri.layers.ArcGISDynamicMapServiceLayer.extend({getImageUrl:function(c,a,b,d){e.app.offlineManager.isOfflineMapActive.get()?e._hooked_esri_getImageUrl.apply(this,[c,a,b,function(a){a=e.urlRewriter(a)||
a;d&&d(a)}]):(a&&b||e.errorReporter("Invalid dimensions on requested map image. This is usually due to an invalid map resize event."),e._hooked_esri_getImageUrl.apply(this,arguments))}})};return f}();f.EsriLayerHacker=k});define("infrastructure/offline/bundle/BundleResourceEntry",["require","exports"],function(h,f){var k=function(){return function(f){f?dojo.safeMixin(this,f):this.key=""}}();f.BundleResourceEntry=k});define("infrastructure/offline/bundle/Bundle",["require","exports"],function(h,f){});
define("infrastructure/offline/bundle/offlineHandlers/ServeResourceHandler",["require","exports","infrastructure/offline/bundle/offlineHandlers/OfflineHandler","geocortex/framework/observables","geocortex/framework/utils/utils"],function(h,f,k,l,e){h=function(){function c(a,b,d,c){this.app=a;this.resourceGetter=b;this.resourceSetter=d;this.resourceRemover=c;this.name="ServeResource";this.isReady=new l.Observable(!1)}c.prototype.handle=function(a,b,d,c){var e=this;if(!this._bundle||!b.parameters||
!b.parameters.key)return!1;b=b.parameters.key;b=b.format.apply(b,d);d=0;for(c=this._bundle.resources.length;d<c;d++)if(this._bundle.resources[d].key===b)return k.hookDeferredCallbacks(a),this._getResourceValue(this._bundle.resources[d]).then(function(b){a.dfd.resolve(b)})["catch"](function(b){e.app.trace.error(b.message);a.dfd.reject(b.message)}),!0;return!1};c.prototype.loadBundle=function(a){this.isReady.set(!0);this._bundle=a};c.prototype.clear=function(){this.isReady.set(!1);this._bundle=null};
c.prototype.stripAndStoreBundle=function(a){var b=this;if(!a)return Promise.reject(Error("Bundle cannot be null."));var d=a.resources.map(function(d){return null==d.value?Promise.reject(Error("Bundle resoure entry value is already null: "+d.key)):d.value&&d.value.length>c._resourceCachingLength?b.resourceSetter(c.getResourceStorageKey(a.id,d.key),d.value).then(function(){d.value=null},function(a){b.app.trace.error("Unable to strip '"+d.key+"' out of the bundle and store it separately. "+a)}):null});
return Promise.all(d).then(function(){return a})};c.prototype.unstoreBundle=function(a){var b=this;if(!a)return Promise.reject(Error("Bundle cannot be null."));var d=a.resources.map(function(d){return null==d.value?b.resourceRemover(c.getResourceStorageKey(a.id,d.key)):null});return Promise.all(d).then(function(){return a})};c.prototype.getResourceValue=function(a){for(var b=0,d=this._bundle.resources.length;b<d;b++)if(this._bundle.resources[b].key===a)return this._getResourceValue(this._bundle.resources[b]);
return Promise.reject(Error("No such entry found."))};c.prototype._getResourceValue=function(a){var b=this;return Promise.resolve(a.value).then(function(d){return null==d?b.resourceGetter(c.getResourceStorageKey(b._bundle.id,a.key)):d}).then(function(b){if(!b)throw Error("Resource entry missing for: "+a.key);return b}).then(function(b){!0===a.isEncoded&&(b=e.base64Decode(b));!0===a.isJson&&(b=JSON.parse(b));return b})};c.getResourceStorageKey=function(a,b){return a+"-"+b};return c}();h._resourceCachingLength=
200;f.ServeResourceHandler=h});define("infrastructure/offline/bundle/offlineHandlers/PassthroughHandler",["require","exports"],function(h,f){var k=function(){function f(e,c){this.app=e;this.unhackedRequesthandler=c;this.name="Passthrough"}f.prototype.handle=function(e,c,a,b){this.unhackedRequesthandler(e,e.options).then(function(a){return e.dfd.resolve(a)},function(a){return e.dfd.errback(a)});return!0};return f}();f.PassthroughHandler=k});
define("infrastructure/offline/bundle/offlineHandlers/FailHandler",["require","exports","infrastructure/offline/bundle/offlineHandlers/OfflineHandler"],function(h,f,k){h=function(){function f(){this.name="Fail"}f.prototype.handle=function(e,c,a,b){e.dfd.reject();k.hookDeferredCallbacks(e);return!0};return f}();f.FailHandler=h});
define("infrastructure/offline/bundle/offlineHandlers/SiteHandler",["require","exports","infrastructure/offline/bundle/offlineHandlers/OfflineHandler","infrastructure/offline/bundle/RequestContext"],function(h,f,k,l){h=function(){function e(c,a,b,d){this.app=c;this.siteJsonGetter=a;this.siteJsonSetter=b;this.unhackedRequesthandler=d;this.name="Site"}e.prototype.handle=function(c,a,b,d){var g=this;k.hookDeferredCallbacks(c);this.siteJsonGetter(a.parameters.key).then(function(b){b.__loadedOffline=!0;
return g._hasToken(c)?g._getOnlineSitePrincipal(c).then(function(d){b.principal=d;return g.siteJsonSetter(a.parameters.key,JSON.stringify(b)).then(function(){return b})})["catch"](function(a){return g._getGmafPrincipal(b.principal).then(function(a){b.principal=a;return b})["catch"](function(a){return b})}):b}).then(function(a){c.dfd.resolve(a)})["catch"](function(a){c.dfd.errback(a)});return!0};e.prototype._hasToken=function(c){return/[?&]token=/.test(c.url)||c.content&&c.content.token};e.prototype._getOnlineSitePrincipal=
function(c){var a=this,b=new l.RequestContext({callbackParamName:c.callbackParamName,content:c.content,form:c.form,handleAs:c.handleAs,timeOut:1E4,url:c.url},null,c.options);return(new Promise(function(d,c){return a.unhackedRequesthandler(b,b.options).then(d,c)})).then(function(a){if(!a||a.error||!a.principal)throw Error("Site JSON looks malformed.");return a.principal})};e.prototype._getGmafPrincipal=function(c){return this.app.nativeManager.nativeInitialized?this.app.nativeManager.xhrGet({url:this.app.localServerAddress+
"/account/userinfo",handleAs:"json"}).then(function(a){if(!a||!a.token)throw Error("GMAF has no login info.");return dojo.mixin(c,{isAuthenticated:!0,label:a.userName,expiry:(new Date).toISOString(),tokens:{site:a.token}})}):Promise.reject(Error("Not a native app."))};return e}();f.SiteHandler=h});
define("infrastructure/offline/SyncInfo",["require","exports","geocortex/essentials/utilities/LayerUtilities"],function(h,f,k){h=function(){function f(e){this.servers=[];this.lastSyncNotificationDate=new Date(0);for(var c=0;c<e.servers.length;c++)"string"==typeof e.servers[c].lastSyncTime&&(e.servers[c].lastSyncTime=new Date(e.servers[c].lastSyncTime)),this.servers.push(e.servers[c]);this.lastSyncNotificationDate=new Date(e.lastSyncNotificationDate)}f.prototype.isSynced=function(e){return!!this.findLayerOrTable(e)};
f.prototype.findLayerOrTable=function(e){var c=k.LayerUtilities.decomposeFeatureLayerUrl(e);e=this.servers.filter(function(a){return a.featureServiceUrl==c.serviceUrl});for(var a=0;a<e.length;a++){var b=e[a],d=b.layers.filter(function(a){return a.id==c.layerId})[0];if(d)return d;if(b=b.layers.filter(function(a){return a.id==c.layerId})[0])return b}return null};f.prototype.getOldestSyncTime=function(){if(this.servers.length){for(var e=this.servers[0].lastSyncTime,c=0;c<this.servers.length;c++)this.servers[c].lastSyncTime<
e&&(e=this.servers[c].lastSyncTime);return e}return null};return f}();f.SyncInfo=h});define("infrastructure/offline/bundle/BundleBuilderContext",["require","exports"],function(h,f){});
define("infrastructure/ArrayUtils",["require","exports"],function(h,f){var k=function(){function f(){}f.sortBy=function(e,c){e.sort(function(a,b){var d=c(a),g=c(b);return d==g?0:d<g?-1:1});return e};f.sum=function(e,c){for(var a=0,b=0;b<e.length;b++)a+=c(e[b]);return a};f.max=function(e,c){for(var a=null,b=0;b<e.length;b++){var d=c(e[b]);if(null==a||a<d)a=d}return a};f.mapWithErrorCallback=function(e,c,a,b){if("function"!==typeof c)throw Error("Callback required.");if("function"!==typeof a)throw Error("Error callback required.");
if(!e)return e;for(var d=[],g=0;g<e.length;g++){var m=e[g];try{d.push(c.call(b,m,g,e))}catch(f){a.call(b,m,f,d)}}return d};f.findIndex=function(e,c){for(var a=0;a<e.length;a++)if(c(e[a]))return a;return-1};return f}();f.ArrayUtils=k});
define("infrastructure/gis/LayerInfo","require exports infrastructure/gis/FieldInfo geocortex/essentials/utilities/DecomposedUri geocortex/essentials/MapServiceConstants geocortex/essentials/Field infrastructure/ArrayUtils".split(" "),function(h,f,k,l,e,c,a){h=function(){function b(){this.fields=[];this.isUserCreated=!1;this.isExpanded=this.includeInLayerList=!0;this._fieldsRetrieved=this._visible=!1}b.fromEsriLayerInfo=function(a,c){var e=new b;e.esriLayerInfo=a;e.id=a.id+"";e.name=a.name;e.displayName=
a.name;e.parentLayerId=a.parentLayerId?a.parentLayerId.toString():null;e.subLayerIds=a.subLayerIds?dojo.map(a.subLayerIds,function(a){return a.toString()}):null;e.uniqueId=c.id.replace(".","..")+"."+a.id;e.url=l.DecomposedUri.appendToPath(c.url,"/"+a.id);e.queryable=!0;e.dataProvider="Default";e._visible=a.defaultVisibility;return e};b.fromEsriFeatureLayer=function(a){var c=new b;c.id=a.id+"";c.name=a.name;c.displayName=a.name;c.uniqueId=a.id;c.url=a.url;c.queryable=!0;c.dataProvider="Default";c._featureLayer=
a;c._visible=a.defaultVisibility;c.subLayerIds=null;c.parentLayerId=null;c.relationships=a.relationships;return c};b.fromGcxLayer=function(a){var c=new b;c.gcxLayer=a;c.id=a.id;c.name=a.name;c.displayName=a.displayName||a.name;c.uniqueId=a.mapService.id+"."+a.id;c.dataProvider=a.dataProvider||"Default";c.isExpanded=a.isExpanded;c.isUserCreated=a.isUserCreated;c.relationships=a.relationships;if(a.mapService.drawingBehavior==e.DrawingBehavior.FEATURE_LAYER)c.url=a.mapService.serviceLayer.url;else if(a.mapService.mapServiceType==
e.MapServiceType.DYNAMIC||a.mapService.mapServiceType==e.MapServiceType.TILED)c.url=l.DecomposedUri.appendToPath(a.mapService.serviceLayer.url,"/"+a.id);else if(a.mapService.serviceLayer instanceof esri.layers.WMSLayer||a.mapService.serviceLayer instanceof esri.layers.WFSLayer)c.url=a.url;a.parentLayerId&&(c.parentLayerId=a.parentLayerId);c.subLayerIds=a.subLayerIds?a.subLayerIds:null;c.includeInLayerList=a.includeInLayerList;c.queryable=a.queryable&&0<a.fields.length&&a.supportsQuery;c._visible=
a.configuredVisible;return c};b.prototype.getUrlWithoutParameters=function(){var a=this.url.indexOf("?");return 0<=a?this.url.substr(0,a):this.url};b.prototype.getFields=function(){var a=this,b=new dojo.Deferred;this._fieldsRetrieved?b.resolve(this.fields):this.getInitializedFeatureLayer().then(function(c){for(var e=0;e<c.fields.length;e++){var n=c.fields[e],f=a.gcxLayer?a.gcxLayer.getFieldByName(n.name):null,n=k.FieldInfo.fromEsriField(n,c,f);a.fields.push(n)}a._fieldsRetrieved=!0;b.isCanceled()||
b.resolve(a.fields)},function(a){b.errback(a)});return b};b.prototype.getInitializedFeatureLayer=function(){var a=this;return this.gcxLayer?this.gcxLayer.getFeatureLayer():new Promise(function(b,e){a._featureLayer||(a._featureLayer=new esri.layers.FeatureLayer(a.url));if(a._featureLayer.loaded)return b(a._featureLayer);if(a._featureLayer.__attached_error)return e(a._featureLayer.__attached_error);var f=a._featureLayer.on("load",function(){f.remove();n.remove();if(a.gcxLayer.wmsLayerName||a.gcxLayer.wfsLayerName)for(var e=
a.gcxLayer.fields,m=a._featureLayer.fields.length-1;0<=m;m--){var l=a._featureLayer.fields[m];"gml:id"===l.name&&a._featureLayer.fields.splice(m,1);l.type=c.Field.convertToEsriFieldType(e[m].dataType)}return b(a._featureLayer)}),n=a._featureLayer.on("error",function(b){f.remove();n.remove();a._featureLayer.__attached_error=b;return e(b)})})};b.prototype.setDefinitionExpression=function(a){var b=this.serviceLayerInfo.serviceLayer;if(b instanceof esri.layers.ArcGISDynamicMapServiceLayer){var c=b.layerDefinitions||
[];a&&"1 = 1"!=a?c[parseInt(this.id)]=a:delete c[parseInt(this.id)];b.setLayerDefinitions(c)}else b instanceof esri.layers.FeatureLayer&&(a&&"1 = 1"!=a?b.setDefinitionExpression(a):b.setDefinitionExpression(null))};b.prototype.getDefinitionExpression=function(){var a=this.serviceLayerInfo.serviceLayer;return a instanceof esri.layers.ArcGISDynamicMapServiceLayer?(a.layerDefinitions||[])[parseInt(this.id)]:a instanceof esri.layers.FeatureLayer?a.getDefinitionExpression():null};b.prototype.isVisible=
function(){return this.gcxLayer?this.gcxLayer.isVisible():this._visible};b.prototype.areAllAncestorsVisible=function(){for(var a=this.serviceLayerInfo.findLayerById(this.parentLayerId);null!==a&&void 0!==a;){if(!a.isVisible())return!1;a=this.serviceLayerInfo.findLayerById(a.parentLayerId)}return!0};b.prototype.setVisibility=function(a,b,c,e){void 0===b&&(b=!1);void 0===c&&(c=!1);void 0===e&&(e=150);var n=!1;c&&this.serviceLayerInfo&&this.serviceLayerInfo.serviceLayer&&(n=this.serviceLayerInfo.supportsLayerVisibility());
this.gcxLayer?this.gcxLayer.setVisibility(a,b||n):this.setEsriLayerVisibility(a,b||n);n&&this.serviceLayerInfo.refresh(e)};b.prototype.setEsriLayerVisibility=function(b,c){var m=this;void 0===c&&(c=!1);if((this._visible=b)||this.serviceLayerInfo.serviceLayer.visible){var f={mapServiceId:this.serviceLayerInfo.id,layerId:this.id,visibility:b},n,l;l=this.serviceLayerInfo.serviceLayer;switch(this.serviceLayerInfo.serviceType){case e.MapServiceType.DYNAMIC:if(l instanceof esri.layers.FeatureLayer)b?l.show():
l.hide(),dojo.publish("LayerVisibilityChange",[Array(f)]);else if((n=this.serviceLayerInfo.serviceLayer.visibleLayers.slice(0).map(function(a){return a.toString()}))&&n.length||l.layerInfos&&l.layerInfos.length){1===n.length&&"-1"==n[0]&&n.pop();l=a.ArrayUtils.findIndex(n,function(a){return a==m.id});if(b){if(-1!==l)break;if(this.subLayerIds&&this.subLayerIds.length)break;n.push(this.id)}else{if(-1===l)break;n.splice(l,1)}n.length||n.push("-1");n.InternallyChangedLayer=f;this.serviceLayerInfo.serviceLayer.setVisibleLayers(n,
c)}else l.setVisibility(b),dojo.publish("LayerVisibilityChange",[Array(f)]);break;case e.MapServiceType.WMS:if(null!==l){var k=[];k.InternallyChangedLayer=f;for(l=n=0;l<this.serviceLayerInfo.layers.length;l++){var r=this.serviceLayerInfo.layers[l];r.isVisible()&&(null===r.subLayerIds||0===r.subLayerIds.length)&&r.areAllAncestorsVisible()&&(r=r.gcxLayer?r.gcxLayer.wmsLayerName:r.serviceLayerInfo.serviceLayer.id,this.gcxLayer&&this.gcxLayer.wmsLayerName===r||this.serviceLayerInfo.serviceLayer.id===
r||null!==r&&""!==r)&&(k[n]=r,n++)}c?(this.serviceLayerInfo.serviceLayer.visibleLayers=k.slice(0),dojo.publish("LayerVisibilityChange",[Array(f)])):this.serviceLayerInfo.serviceLayer.setVisibleLayers(k)}break;case e.MapServiceType.FEATURE:case e.MapServiceType.GEORSS:case e.MapServiceType.KML:case e.MapServiceType.BING:case e.MapServiceType.TILED:case e.MapServiceType.WMTS:case e.MapServiceType.IMAGE:case e.MapServiceType.WEBTILED:case e.MapServiceType.WFS:if(null!==l)if(1===this.serviceLayerInfo.layers.length)b?
l.show():l.hide(),dojo.publish("LayerVisibilityChange",[Array(f)]);else throw Error("Visibility of individual layers cannot be set for this Map Service: {0}".format(this.displayName));break;default:throw Error("Cannot set layer visibility. Unknown MapService type.");}}};b.prototype.getMinScale=function(){var a;a=this.gcxLayer?this.gcxLayer.minScale:this._featureLayer?this._featureLayer.minScale:this.esriLayerInfo.minScale;return this.serviceLayerInfo&&this.serviceLayerInfo.serviceLayer.minScale?Math.min(a,
this.serviceLayerInfo.serviceLayer.minScale):a};b.prototype.getMaxScale=function(){var a;a=this.gcxLayer?this.gcxLayer.maxScale:this._featureLayer?this._featureLayer.maxScale:this.esriLayerInfo.maxScale;return this.serviceLayerInfo&&this.serviceLayerInfo.serviceLayer.maxScale?Math.max(a,this.serviceLayerInfo.serviceLayer.maxScale):a};return b}();f.LayerInfo=h});
define("infrastructure/gis/GisUtils",["require","exports","geocortex/essentials/MapServiceConstants"],function(h,f,k){f.getServiceLayerType=function(f){return f instanceof esri.layers.DynamicMapServiceLayer?f instanceof esri.layers.ArcGISDynamicMapServiceLayer?k.MapServiceType.DYNAMIC:f instanceof esri.layers.ArcGISImageServiceLayer?k.MapServiceType.IMAGE:f instanceof esri.layers.WMSLayer?k.MapServiceType.WMS:k.MapServiceType.DYNAMIC:f instanceof esri.layers.TiledMapServiceLayer?f instanceof esri.layers.WMTSLayer?
k.MapServiceType.WMTS:f instanceof esri.layers.WebTiledLayer?k.MapServiceType.WEBTILED:f instanceof esri.virtualearth.VETiledLayer?k.MapServiceType.BING:k.MapServiceType.TILED:f instanceof esri.layers.GraphicsLayer?f instanceof esri.layers.FeatureLayer?esri.layers.StreamLayer&&f instanceof esri.layers.StreamLayer?k.MapServiceType.STREAM:f instanceof esri.layers.CSVLayer?k.MapServiceType.CSV:k.MapServiceType.FEATURE:esri.layers.LabelLayer&&f instanceof esri.layers.LabelLayer?k.MapServiceType.LABEL:
f instanceof esri.layers.WFSLayer?k.MapServiceType.WFS:k.MapServiceType.GRAPHICS:f instanceof esri.layers.GeoRSSLayer?k.MapServiceType.GEORSS:f instanceof esri.layers.KMLLayer?k.MapServiceType.KML:f instanceof esri.layers.MapImageLayer?k.MapServiceType.MAPIMAGE:k.MapServiceType.UNKNOWN}});
define("infrastructure/gis/ServiceLayerInfo","require exports infrastructure/gis/LayerInfo infrastructure/gis/GisUtils geocortex/essentials/LayerType geocortex/essentials/MapServiceConstants".split(" "),function(h,f,k,l,e,c){h=function(){function a(){this.layers=[];this.tables=[];this.isUserCreated=!1;this.isExpanded=this.includeInLayerList=!0;this._delayedRefreshToken=null}a.fromEsriLayer=function(b){var d=new a;d.serviceLayer=b;d.serviceType=l.getServiceLayerType(b);d.id=b.id;if(b instanceof esri.layers.ArcGISDynamicMapServiceLayer||
b instanceof esri.layers.ArcGISTiledMapServiceLayer){d.capabilities=b.capabilities.split(",");for(var c=0;c<b.layerInfos.length;c++){var e=k.LayerInfo.fromEsriLayerInfo(b.layerInfos[c],b);e.serviceLayerInfo=d;d.layers.push(e)}}else b instanceof esri.layers.FeatureLayer&&(d.displayName=b.name,d.capabilities=b.capabilities.split(","),e=k.LayerInfo.fromEsriFeatureLayer(b),e.serviceLayerInfo=d,"Table"===b.type?d.tables.push(e):d.layers.push(e));return d};a.fromGcxMapService=function(b){var d=new a;d.gcxMapService=
b;d.serviceType=b.mapServiceType;d.serviceLayerFunction=b.mapServiceFunction;d.serviceLayer=b.serviceLayer;d.id=b.id;d.isExpanded=b.isExpanded;d.isUserCreated=b.isUserCreated;d.includeInLayerList=b.includeInLayerList;d.displayName=b.displayName;b.serviceLayer.capabilities&&(d.capabilities=b.serviceLayer.capabilities.split(","));for(var c=0;c<b.layers.length;c++){var m=b.layers[c],f=k.LayerInfo.fromGcxLayer(m);f.serviceLayerInfo=d;m.type===e.LayerType.TABLE_LAYER?d.tables.push(f):d.layers.push(f)}for(c=
0;c<b.tables.length;c++)m=k.LayerInfo.fromGcxLayer(b.tables[c]),m.serviceLayerInfo=d,d.tables.push(m);return d};a.prototype.findLayerById=function(a){for(var d=0,c=this.layers.length;d<c;d++){var e=this.layers[d];if(a===e.id.toString())return e}return null};a.prototype.isVisible=function(){var a=!1;this.serviceLayer&&"boolean"===typeof this.serviceLayer.visible&&(a=this.serviceLayer.visible);return a};a.prototype.setVisibility=function(a){this.gcxMapService?this.gcxMapService.setVisibility(a):null!==
this.serviceLayer&&this.serviceLayer.setVisibility(a)};a.prototype.opacity=function(){return this.gcxMapService?this.gcxMapService.opacity:this.serviceLayer?this.serviceLayer.opacity:null};a.prototype.setOpacity=function(a){if(this.gcxMapService)this.gcxMapService.setOpacity(a);else if(this.serviceLayer){if(null==a||isNaN(a))a=1;a=Math.min(1,Math.max(0,a));this.serviceLayer.setOpacity(a)}};a.prototype.refresh=function(a,d){var c=this,e=this.serviceLayer;if(e&&"function"===typeof e.refresh){var f=
function(){c._delayedRefreshToken=null;if(!0===a&&"function"===typeof e.setDisableClientCaching){var a=e.disableClientCaching;e.setDisableClientCaching(!0);e.refresh();e.setDisableClientCaching(a)}else e.refresh()};this._delayedRefreshToken&&clearTimeout(this._delayedRefreshToken);"number"!==typeof a?f():this._delayedRefreshToken=setTimeout(f,a)}};a.prototype.supportsLayerVisibility=function(){switch(this.serviceType){case c.MapServiceType.WMS:return!0;case c.MapServiceType.DYNAMIC:return null!==
this.serviceLayer&&!!this.serviceLayer.visibleLayers;default:return!1}};a.prototype.loaded=function(){var a=this;if(this._loadedDeferred)return this._loadedDeferred;this._loadedDeferred=new dojo.Deferred;if(this.serviceLayer.loaded)this._loadedDeferred.resolve(this.serviceLayer);else if(this.serviceLayer.loadError)this._loadedDeferred.resolve(this.serviceLayer.loadError);else var d=this.serviceLayer.on("load",function(){d.remove();c.remove();a._loadedDeferred.resolve(a.serviceLayer)}),c=this.serviceLayer.on("error",
function(e){d.remove();c.remove();a._loadedDeferred.errback(e)});return this._loadedDeferred};return a}();f.ServiceLayerInfo=h});
define("infrastructure/gis/MapInfo",["require","exports","infrastructure/gis/ServiceLayerInfo","geocortex/framework/observables"],function(h,f,k,l){h=function(){function e(){this.serviceLayers=[];this.markupLayer=new l.Observable}e.fromEsriMap=function(c){var a=new e;a.map=c;a.markupLayer.set(c.graphics);for(var b=c.layerIds.concat(c.graphicsLayerIds),d=0;d<b.length;d++){var g=c.getLayer(b[d]),g=k.ServiceLayerInfo.fromEsriLayer(g);a.serviceLayers.push(g)}return a};e.fromViewerApp=function(c){var a=
e.fromEssentialsMap(c.site.essentialsMap);a.markupLayer.sync(c.markupLayer);return a};e.fromEssentialsMap=function(c){var a=new e;a.gcxMap=c;a.map=c.getMap();a.markupLayer.set(c.getMap().graphics);for(var b=0;b<c.mapServices.length;b++){var d=k.ServiceLayerInfo.fromGcxMapService(c.mapServices[b]);a.serviceLayers.push(d)}return a};e.prototype.getLayerInfos=function(){for(var c=[],a=0;a<this.serviceLayers.length;a++)for(var b=this.serviceLayers[a].layers,d=0;d<b.length;d++)c.push(b[d]);return c};e.prototype.getTableInfos=
function(){for(var c=[],a=0;a<this.serviceLayers.length;a++)for(var b=this.serviceLayers[a].tables,d=0;d<b.length;d++)c.push(b[d]);return c};e.prototype.getGraphicsLayers=function(){var c=[];c.push(this.map.graphics);for(var a=0;a<this.map.graphicsLayerIds.length;a++)c.push(this.map.getLayer(this.map.graphicsLayerIds[a]));return c};e.prototype.findMapServiceById=function(c){for(var a=null,b,d=0,g=this.serviceLayers.length;d<g;d++){var e=this.serviceLayers[d];null==a&&(a=!(!e||!e.gcxMapService));if((b=
a?e.gcxMapService:e.serviceLayer)&&b.id===c)return e}return null};return e}();f.MapInfo=h});
define("infrastructure/gis/AppInfo",["require","exports","infrastructure/gis/MapInfo","infrastructure/GeometryUtils"],function(h,f,k,l){h=function(){function e(){}e.fromGeocortexApp=function(c){var a=new e;a.gcxApp=c;a.urlParameters=c.urlParameters;c.isArcGisWebApp?a.mapInfo=k.MapInfo.fromEsriMap(c.map):(a.essentialsVersion=c.site.getEssentialsVersion(),a.mapInfo=k.MapInfo.fromViewerApp(c));a.map=a.mapInfo.map;return a};e.prototype.getGeometryService=function(){return this._geometryService?this._geometryService:
this.geometryServiceUrl?this._geometryService=new esri.tasks.GeometryService(this.geometryServiceUrl):this.gcxApp?l.getGeometryService(this.gcxApp):null};return e}();f.AppInfo=h});
define("infrastructure/offline/SyncParameters",["require","exports","infrastructure/gis/AppInfo","infrastructure/gis/LayerInfo","geocortex/framework/utils/utils"],function(h,f,k,l,e){(function(c){function a(d,c,m,f){f||(f={});var n=[];if(f[m.uniqueId])return n;f[m.uniqueId]=!0;for(var p=function(p){var k=m.url.replace(/\/[0-9]+$/,"/"+p.relatedTableId),r=c.filter(function(a){return a.url==k})[0];r||(r=b(c,m,p.relatedTableId),r||(r=new l.LayerInfo,r.id=p.relatedTableId+"",r.relationships=[],r.uniqueId=
e.alphaNumericToken()),r.url=k);n.push(r);p=0;for(r=a(d,c,r,f);p<r.length;p++)n.push(r[p])},k=0,r=m.relationships;k<r.length;k++)p(r[k]);return n}function b(a,b,c){var e=b.serviceLayerInfo.gcxMapService.serviceTag;if(e){a=a.filter(function(a){return a.serviceLayerInfo.gcxMapService.serviceTag===e});var f=c+"";return a.filter(function(a){return a.id===f})[0]}}c.buildSyncParameters=function(b,c){var e=k.AppInfo.fromGeocortexApp(b),f=e.mapInfo.getLayerInfos(),n=f.concat(e.mapInfo.getTableInfos());n.forEach(function(a){return a.url=
a.getUrlWithoutParameters()});var l=[],s={};c.content.layers.forEach(function(b){var d,c,g,k,h,w=f.filter(function(a){return a.uniqueId==b.layerInfoUniqueId})[0];if(w||b.isUserCreated){if(w){c=w.url.substring(0,w.url.lastIndexOf("/"));g=parseInt(w.id);d={id:g,where:b.definitionExpression,displayName:w.displayName};if(w.gcxLayer.isDynamic){k=w.serviceLayerInfo.serviceLayer;if(h=k.dynamicLayerInfos.filter(function(a){return a.id===g})[0])d.dynamicLayerInfo=h.toJson();if(k=k.layerDrawingOptions[g])d.layerDrawingOptions=
k.toJson()}h=w.serviceLayerInfo.gcxMapService.serviceToken;k=w.serviceLayerInfo.capabilities}else if(b.isUserCreated&&b.serviceInfo&&b.layerJson)c=b.serviceInfo.url,k=b.serviceInfo.capabilities,g=parseInt(b.layerJson.id),d=JSON.parse(b.layerJson.dynamicDefinition),d={id:g,displayName:b.layerJson.name,where:b.definitionExpression,dynamicLayerInfo:d,layerDrawingOptions:d?d.drawingInfo:null};else return;var A=l.filter(function(a){return a.url===c})[0];A?s[w.uniqueId]||A.layers.push(d):(A={url:c,layers:[d],
capabilities:k,token:h},l.push(A));if(w)for(s[w.uniqueId]=w,d=function(a){var b=parseInt(a.id);s[a.id]||(A.layers.some(function(a){return a.id==b})||A.layers.push({id:b,displayName:a.displayName||a.name}),s[a.uniqueId]=a)},k=0,w=a(e.mapInfo,n,w);k<w.length;k++)d(w[k])}});return{profile:c.id,featureServices:l,geometry:c.content.geometry,includeAttachments:c.content.includeAttachments,mapSpatialReference:b.map.spatialReference.toJson()}}})(f.SyncParameters||(f.SyncParameters={}))});
define("infrastructure/offline/SyncProgress",["require","exports"],function(h,f){});
define("infrastructure/offline/SyncEngine",["require","exports","infrastructure/offline/SyncInfo","geocortex/essentials/FeatureLayerService","geocortex/essentials/utilities/LayerUtilities"],function(h,f,k,l,e){h=function(){function c(){}c.getSyncInfo=function(a,b){return a.nativeManager.xhrGet({url:a.localServerAddress+"/sync/"+a.localServerNamespace+"/info?profile="+b}).then(function(a){a=JSON.parse(a);return new k.SyncInfo(a)})};c.sync=function(a,b,d,c){var e=this;a.event("FeatureDataSyncStartedEvent").publish(b);
return this._unregisterOfflineDeletedReplicas(a).then(function(f){return e._sync(a,b,d,c)}).then(function(b){a.event("FeatureDataSyncCompletedEvent").publish();return b})};c._sync=function(a,b,d,c){var e=this;d.register(function(){return e._cancel(a)});return new Promise(function(d,f){var l=a.event("NativeMessageEvent").subscribe(e,function(b){"syncStatus"===b.type&&(b.parameters.state===e.STATUS_SUCCESS?(a.event("NativeMessageEvent").unsubscribe(l),c(b.parameters),d(b.parameters)):b.parameters.state===
e.STATUS_ERROR?(a.event("NativeMessageEvent").unsubscribe(l),f(b.parameters.text)):b.parameters.state===e.STATUS_IN_PROGRESS&&c(b.parameters))}),k={options:JSON.stringify(b)};a.nativeManager.xhrPost({url:a.localServerAddress+"/sync/"+a.localServerNamespace+"/execute",content:k,error:function(b){a.event("NativeMessageEvent").unsubscribe(l);f(b.responseText)}})})};c._cancel=function(a){return a.nativeManager.xhrPost({url:a.localServerAddress+"/sync/"+a.localServerNamespace+"/cancel",method:"POST"})};
c.deleteData=function(a,b){var d=this._getFeatureServiceTokenInfo(a),c=a.localServerAddress+"/sync/"+a.localServerNamespace+"/delete",d={parameters:JSON.stringify({profile:b,serviceInfo:d})};return a.nativeManager.xhrPost({url:c,content:d,method:"POST"})};c.deletePartialData=function(a,b,d){var c=this._getFeatureServiceTokenInfo(a);return a.nativeManager.message("DeletePartiallySyncedData",{profile:b,serviceInfo:c,localServerNamespace:a.localServerNamespace,firstDownload:d})};c._unregisterOfflineDeletedReplicas=
function(a){var b=this._getFeatureServiceTokenInfo(a),d=a.localServerAddress+"/sync/"+a.localServerNamespace+"/unregisterDeletedReplicas",b={parameters:JSON.stringify({serviceInfo:b})};return a.nativeManager.xhrPost({url:d,content:b})};c._getFeatureServiceTokenInfo=function(a){return a.site.essentialsMap.mapServices.filter(function(a){return a instanceof l.FeatureLayerService}).map(function(a){return{serviceUrl:e.LayerUtilities.decomposeFeatureLayerUrl(a.serviceUrl).serviceUrl,token:a.serviceToken}})};
return c}();h.STATUS_IN_PROGRESS="inProgress";h.STATUS_SUCCESS="success";h.STATUS_ERROR="error";f.SyncEngine=h});
define("infrastructure/offline/bundle/RoutingRulesBuilder",["require","exports","infrastructure/offline/bundle/BundleBuilder","geocortex/essentials/MapServiceConstants","geocortex/essentials/FeatureLayerService"],function(h,f,k,l,e){function c(a){return[{handlerName:"Rewrite",pattern:a,parameters:{newUrl:"Resources/Images/blank-tile.png"}}]}function a(a,b,d){d=[];d.push({handlerName:"ServeResource",pattern:a+"REST/v1/Imagery/Metadata/"+b.bingProperties.mapStyle,parameters:{key:a}});d.push({handlerName:"Rewrite",
pattern:"https?://[^/]*tiles.virtualearth.net/tiles",parameters:{newUrl:"Resources/Images/blank-tile.png"}});return d}function b(a,b,d){var c=[],g=-1!==b.serviceLayer.url.indexOf("?")?b.serviceLayer.url.substr(0,b.serviceLayer.url.indexOf("?")):b.serviceLayer.url,g=g.toLowerCase();(b=d.featureLayerSyncInfo.servers.filter(function(a){return!!a.layers.filter(function(b){return a.featureServiceUrl.toLowerCase()===g})[0]})[0])?c.push({handlerName:"Rewrite",pattern:a+"/+(?!tile)(.+)",parameters:{newUrl:b.localServerUrl.replace("FeatureServer",
"MapServer")+"/{1}"}}):c=c.concat(p(a));return c}function d(a){a=decodeURI(a).replace(/%24/g,"$");return[{handlerName:"Rewrite",pattern:a.replace(/\$?{subDomain}/ig,"(?:.*)").replace(/\$?{level}/ig,"[0-9]*").replace(/\$?{row}/ig,"[0-9]*").replace(/\$?{col}/ig,"[0-9]*"),parameters:{newUrl:"Resources/Images/blank-tile.png"}}]}function g(a,b,d){var c=[],g=m(b.serviceUrl).layerId,f=m(b.serviceUrl).serviceUrl,n=/^(.*)(\/\+?[0-9]+\/?\+?)$/.exec(a)[1];c.push({handlerName:"ServeResource",pattern:n+"/*$",
parameters:{key:n}});var l=-1!==b.serviceLayer.url.indexOf("?")?b.serviceLayer.url.substr(0,b.serviceLayer.url.indexOf("?")):b.serviceLayer.url,l=l.toLowerCase(),p=d.featureLayerSyncInfo.servers.filter(function(a){return!!a.layers.filter(function(b){return(a.featureServiceUrl+"/"+b.id).toLowerCase()===l})[0]})[0],r;if(!p&&0<b.serviceUrl.indexOf("/rest/services/x/")&&b.serviceTag)for(var h=0,F=b.essentialsMap.mapServices.filter(function(a){return a instanceof e.FeatureLayerService}).filter(function(a){return a.serviceTag===
b.serviceTag});h<F.length;h++){for(var I=F[h],H=0,J=I.serviceLayer.relationships;H<J.length&&!(J[H].relatedTableId===g&&(r=m(I.serviceUrl).serviceUrl+"/"+g,p=d.featureLayerSyncInfo.servers.filter(function(a){return!!a.layers.filter(function(b){return(a.featureServiceUrl+"/"+b.id).toLowerCase()===r.toLowerCase()})[0]})[0]));H++);if(p)break}p?(c.push({handlerName:"Rewrite",pattern:a+"/+(.+)",parameters:{newUrl:p.localServerUrl+"/"+g+"/{1}"}}),r&&(a=k.urlToPattern(k.cleanUpRestUrl(d,r)),c.push({handlerName:"Rewrite",
pattern:a+"/+(.+)",parameters:{newUrl:p.localServerUrl+"/"+g+"/{1}"}}))):c=c.concat(s(n,g));g=(b.serviceLayer.relationships||[]).map(function(a){return q(n,f,p?p.localServerUrl:null,a,d)});return c=c.concat.apply(c,g)}function m(a){var b=/^(.*)\/([0-9]+\/?)$/.exec(a);a=b[1];b=parseInt(b[2]);return{serviceUrl:a,layerId:b}}function q(a,b,d,c,g){var e=[{handlerName:"ServeResource",pattern:a+"/+"+c.relatedTableId+"/*$",parameters:{key:a+"/+"+c.relatedTableId}}];d&&g.featureLayerSyncInfo.servers.filter(function(a){return a.featureServiceUrl===
b}).some(function(a){return a.layers&&a.layers.some(function(a){return a.id===c.relatedTableId})})?e.push({handlerName:"Rewrite",pattern:a+"/+"+c.relatedTableId+"/+(.+)",parameters:{newUrl:d+"/"+c.relatedTableId+"/{1}"}}):e=e.concat(s(a,c.relatedTableId));return e}function n(a,b,d){if(d=d.basemaps.filter(function(a){return a.url===b.url||a.url===b.serviceUrl})[0]){var g=r(a);return[{handlerName:"Rewrite",pattern:a+"/+tile/+([0-9]*)/+([0-9]*)/+([0-9]*)",parameters:{newUrl:"{localserver}/"+d.localServicePath+
"/{{{0}}}/{{{1}}}/{{{2}}}".format(g+1,g+2,g+3)}}].concat(p(a))}return c(a+"/+(tile|tilemap)").concat(p(a))}function p(a){return[{handlerName:"ServeResource",pattern:a+"/+([^/]*/+)?(query|queryRelatedRecords|identify|find)",parameters:{key:"__no_features"}}]}function s(a,b){return[{handlerName:"ServeResource",pattern:a+"/+"+b+"/+(query|queryRelatedRecords|applyEdits)",parameters:{key:"__no_features"}}]}function r(a){a instanceof RegExp?(a=a.toString(),a=a.substring(1,a.length-2),a=RegExp(a+"|")):a=
RegExp(a.toString()+"|");return a.exec("").length-1}f.buildRoutingRules=function(m){var f=[{handlerName:"Rewrite",pattern:"/arcgis/+rest/+services/+Utilities/+Geometry/+GeometryServer/+(.*)",parameters:{newUrl:"{localserver}/GeometryServer/{1}"}},{handlerName:"ServeResource",pattern:"/map/+layerlist$",parameters:{key:"__layerlist_"}},{handlerName:"ServeResource",pattern:"/search$",parameters:{key:"__no_search_results"}},{handlerName:"Site",pattern:k.urlToPattern(m.app.site.originalUrl)+"/*$",parameters:{key:"__site_"}}],
q=[],r=m.app.site.essentialsMap.mapServices;m.app.site.overviewMap&&(r=r.concat(m.app.site.overviewMap.mapServices));r.forEach(function(r){if(-1===q.indexOf(r.url)){q.push(r.url);var s=r.serviceLayer&&r.serviceLayer.attributionDataUrl||r.attributionDataUrl;s&&f.push({handlerName:"ServeResource",pattern:k.urlToPattern(s),parameters:{key:"__empty_attribution_response"}});s=k.urlToPattern(k.cleanUpMapServiceUrl(m,r));r.mapServiceType===l.MapServiceType.WMS?f=f.concat(c(s)):(r.mapServiceType===l.MapServiceType.BING&&
(f=f.concat(a(s,r,m))),r.mapServiceType===l.MapServiceType.WMTS||r.mapServiceType===l.MapServiceType.WEBTILED?f=f.concat(d(s)):(f=r instanceof e.FeatureLayerService?f.concat(g(s,r,m)):f.concat(b(s,r,m)),r.mapServiceType===l.MapServiceType.TILED&&(f=f.concat(n(s,r,m))),r.mapServiceFunction===l.MapServiceFunction.BASE||r instanceof e.FeatureLayerService||(f=f.concat(p(s))),f.push({handlerName:"ServeResource",pattern:s+"/*$",parameters:{key:s}})))}});f.push({handlerName:"ServeResource",pattern:"/+map/+mapservices/+[0-9]+/+layers/+[0-9]+/+datalinks/+[^/]+/+link$",
parameters:{key:"__no_data_links"}});return f}});
define("infrastructure/offline/bundle/BundleBuilder","require exports infrastructure/offline/bundle/RoutingRulesBuilder geocortex/geocortex geocortex/essentials/MapServiceConstants geocortex/essentials/FeatureLayerService geocortex/framework/utils/utils".split(" "),function(h,f,k,l,e,c,a){function b(a,b){b.resources.push(t("__error_offline_no_endpoint",{error:{code:400,message:"This resource is not available offline.",details:[]}}));b.resources.push(t("__no_features",{objectIdFieldName:"OBJECTID",
globalIdFieldName:"GlobalID",features:[]}));b.resources.push(t("__no_search_results",{count:0,features:[],ResponseStatus:{}}));b.resources.push(t("__no_data_links",{results:[]}));b.resources.push(t("__empty_attribution_response",""));return null}function d(a,b){return new Promise(function(d,c){var g=y(a,a.app.site.url+"/map/layerlist");l.request({url:g,content:{f:"json"},load:function(a){b.resources.push(t("__layerlist_",a));d(null)},error:function(b){var d=r(a.app,g,b.message);a.app.trace.error(d);
c(b.message||d)},callbackParamName:"Callback"})})}function g(a,b){return new Promise(function(d,c){var g=y(a,a.app.site.url);l.request({url:g,content:{f:"json",deep:a.app.site.deepInitialize},load:function(a){b.resources.push(t("__site_",a));d(null)},error:function(b){var d=r(a.app,g,b.message);a.app.trace.error(d);c(b.message||d)},callbackParamName:"Callback"})})}function m(a,b){var d=[],g=a.app.site.essentialsMap.mapServices;a.app.site.overviewMap&&(g=g.concat(a.app.site.overviewMap.mapServices));
g=g.map(function(g){if(-1!=d.indexOf(g.url))return null;d.push(g.url);return g.mapServiceType===e.MapServiceType.WMS||g.mapServiceType===e.MapServiceType.WEBTILED?null:g.mapServiceType===e.MapServiceType.BING?n(a,b,g):g.mapServiceType===e.MapServiceType.GEORSS||g.mapServiceType===e.MapServiceType.KML?s(a,b,g):g instanceof c.FeatureLayerService?q(a,b,g):p(a,b,g)});return Promise.all(g)}function q(a,b,d){var c=[],g=/^(.*)(\/[0-9]+\/?)$/.exec(d.serviceUrl)[1],e=null;d.layers[0]?e=d.layers[0].relationships:
d.serviceLayer&&(e=d.serviceLayer.relationships);e&&(c=c.concat(e.map(function(c){return new Promise(function(e,m){var f=g+"/"+c.relatedTableId,n={f:"json"},q=d.findServiceToken();q&&(n.token=q);esri.request({url:f,handleAs:"json",content:n,callbackParamName:"Callback"}).then(function(a){b.resources.push(t(x(f),a));e(null)},function(b){var d=r(a.app,f,b.message);a.app.trace.error(d);m(b.message||d)})})})));c.push(p(a,b,d));return Promise.all(c)}function n(a,b,d){return new Promise(function(c,g){var e=
v(a,d),m=d.serviceLayer;esri.request({url:e+"/Imagery/Metadata/"+m.mapStyle,handleAs:"json",content:{ss:"true",c:m.culture,key:d.bingProperties.bingMapsKey},callbackParamName:"jsonp"}).then(function(a){b.resources.push(t(x(e),a));c(null)},function(b){var d=r(a.app,e,b.message);a.app.trace.error(d);g(b.message||d)})})}function p(a,b,d){return new Promise(function(c,g){var e=v(a,d),m={f:"json"},f=d.findServiceToken();f&&(m.token=f);esri.request({url:e,handleAs:"json",content:m,callbackParamName:"Callback"}).then(function(a){b.resources.push(t(x(e),
a));c(null)},function(b){var d=r(a.app,e,b.message);a.app.trace.error(d);g(b.message||d)})})}function s(a,b,d){return new Promise(function(c,g){var e=v(a,d);esri.request({url:e,handleAs:"xml",content:{},callbackParamName:"Callback"}).then(function(a){b.resources.push(u(x(e),(new XMLSerializer).serializeToString(a)));c(null)},function(b){var d=r(a.app,e,b.message);a.app.trace.error(d);g(b.message||d)})})}function r(a,b,d){a=a.offlineManager.getResource("language-offline-errors-fetch-error").format(b);
d&&(a+=" "+d);return a}function t(a,b,d){void 0===d&&(d=!1);return u(a,JSON.stringify(b),d)}function u(b,d,c){void 0===c&&(c=!1);return{isEncoded:c,isJson:!0,key:b,value:c?a.base64Encode(d):d}}function v(a,b){var d=b.serviceUrl;!d&&b.serviceLayer&&(d=b.serviceLayer.url);d&&(d=y(a,d));return d}function y(a,b){b=a.app.makeAbsolute(b);var d=document.createElement("a");d.href=b;var d=d.href,c=d.charAt(d.length-1);if("/"===c||"\\"===c)d=d.substr(0,d.length-1);return d}function x(a){var b=/^[a-z]+:\/\/(.*)/.exec(a);
b&&(a=b[1]);(b=/^(services|server)\.arcgisonline\.(.*)/.exec(a))&&(a="(services|server).arcgisonline."+b[2]);/^[^/]*virtualearth.net\//.exec(a)&&(a="[^/]*virtualearth.net/");(b=/^([a-zA-Z.]+):(80|443)(.*)/.exec(a))&&(a=b[1]+b[3]);return a=a.replace(/\//g,"/+").replace(/\./g,"\\.")}f.buildBundle=function(a){var c={id:a.bundleId,timestamp:(new Date).getTime(),routingRules:k.buildRoutingRules(a),resources:[]};a=[b(a,c),g(a,c),d(a,c),m(a,c)];return Promise.all(a).then(function(){return c})};f.cleanUpMapServiceUrl=
v;f.cleanUpRestUrl=y;f.urlToPattern=x});
define("infrastructure/offline/bundle/BundleManager","require exports infrastructure/offline/bundle/OfflineRouter infrastructure/offline/bundle/EsriRequestHacker infrastructure/offline/bundle/EsriLayerHacker infrastructure/offline/bundle/offlineHandlers/ServeResourceHandler infrastructure/offline/bundle/offlineHandlers/PassthroughHandler infrastructure/offline/bundle/offlineHandlers/FailHandler infrastructure/offline/bundle/offlineHandlers/RewriteHandler infrastructure/offline/bundle/offlineHandlers/SiteHandler infrastructure/offline/SyncEngine infrastructure/offline/bundle/BundleBuilder".split(" "),function(h,
f,k,l,e,c,a,b,d,g,m,q){h=function(){function f(m,n){var q=this;this.app=m;this.libraryId=n;this._router=new k.OfflineRouter(this.app);this._esriRequestHacker=new l.EsriRequestHacker(m,function(a,b){return q._router.handle(a,b)});this._esriLayerHacker=new e.EsriLayerHacker(m,function(a){return q._router.rewriteUrl(a)});this._esriLayerHacker.errorReporter=function(a){return q.app.trace.warning(a)};this._serveResourceHandler=new c.ServeResourceHandler(this.app,function(a){return q._appStoreGetPromise(a)},
function(a,b){return q._appStoreSetPromise(a,b)},function(a){return q._appStoreRemovePromise(a)});var h=new a.PassthroughHandler(this.app,function(a,b){return q._esriRequestHacker.unhackedRequest(a,b)});this._router.setDefaultHandler(h);this._router.addHandler(h);this._router.addHandler(this._serveResourceHandler);this._router.addHandler(new b.FailHandler);this._router.addHandler(new d.RewriteHandler(this.app,function(a,b){return q._esriRequestHacker.unhackedRequest(a,b)}));this._router.addHandler(new g.SiteHandler(this.app,
function(a){return q._serveResourceHandler.getResourceValue(a)},function(a,b){var d=c.ServeResourceHandler.getResourceStorageKey(q._activeBundle.id,a);return q._serveResourceHandler.resourceSetter(d,b)},function(a,b){return q._esriRequestHacker.unhackedRequest(a,b)}));this.app.event("ApplicationStorageClearedEvent").subscribe(this,function(){q._serveResourceHandler.clear();q._router.clearRoutingRules()})}f.prototype.createBundle=function(a,b){var d=this;return this._buildBundle(a,b).then(function(a){return d._storeBundle(a)}).then(function(a){})};
f.prototype.deleteBundle=function(a){var b=this;return this._getBundle(a).then(function(a){return a?b._serveResourceHandler.unstoreBundle(a):null}).then(function(a){return a?b._appStoreRemovePromise(b._getBundleKey(a)):null}).then(function(){})};f.prototype.updateBundle=function(a,b){var d=this;return this._buildBundle(a,b).then(function(b){return d.deleteBundle(a)["catch"](function(a){d.app.trace.warning("Unable to delete old bundle before replacing it. "+(a.message||a)+" Attempting to continue.");
return null}).then(function(){return b})}).then(function(a){return d._storeBundle(a)}).then(function(a){return d._router.setRoutingRules(a.routingRules)}).then(function(){})};f.prototype.loadBundle=function(a){var b=this;return a?this._getBundle(a).then(function(a){if(!a)throw Error(b.getResource("language-offline-errors-bundlenotfound"));b._activeBundle=a;b._serveResourceHandler.loadBundle(a);b._router.setRoutingRules(a.routingRules)}):Promise.reject(Error("Bundle ID cannot be null."))};f.prototype.unloadBundle=
function(){this._serveResourceHandler.clear();this._router.clearRoutingRules();return Promise.resolve()};f.prototype._buildBundle=function(a,b){var d=this;return m.SyncEngine.getSyncInfo(this.app,a).then(function(c){c={app:d.app,bundleId:a,basemaps:b,featureLayerSyncInfo:c};d._esriRequestHacker.disable();return q.buildBundle(c)["finally"](function(){d._esriRequestHacker.enable()})})};f.prototype._storeBundle=function(a){var b=this;return null==a?Promise.reject(Error("Bundle is null.")):null==a.id?
Promise.reject(Error("Bundle ID is null.")):this._serveResourceHandler.stripAndStoreBundle(a).then(function(){b._appStoreSetPromise(b._getBundleKey(a),JSON.stringify(a));return a},function(d){b.app.trace.warning("Failed to save offline bundle '"+a.id+"'. "+(d.message||d));22==d.code&&window.localStorage&&window.localStorage.remainingSpace&&b.app.trace.warning("Local storage has "+window.localStorage.remainingSpace+" bytes remaining.");throw d;})};f.prototype._getBundle=function(a){return a?this._appStoreGetPromise(this._getBundleKey(a)).then(function(a){return a?
JSON.parse(a):null}):Promise.reject(Error("Bundle ID is null."))};f.prototype._getBundleKey=function(a){return"__bundle-"+("string"===typeof a?a:a.id)};f.prototype.getStoreResource=function(a,b){var d=c.ServeResourceHandler.getResourceStorageKey(a,b);return this._appStoreGetPromise(d)};f.prototype.setStoreResource=function(a,b,d){a=c.ServeResourceHandler.getResourceStorageKey(a,b);return this._appStoreSetPromise(a,d)};f.prototype._appStoreGetPromise=function(a){var b=this;return new Promise(function(d,
c){return b.app.store.get(a,d,c)})};f.prototype._appStoreSetPromise=function(a,b){var d=this;return new Promise(function(c,g){return d.app.store.set(a,b,function(){return c()},g)})};f.prototype._appStoreRemovePromise=function(a){var b=this;return new Promise(function(d,c){return b.app.store.remove(a,function(){return d()},c)})};f.prototype.getResource=function(a){return this.app.getResource(this.libraryId,a)};return f}();f.BundleManager=h});
define("infrastructure/offline/OfflineMapProgressClient",["require","exports"],function(h,f){var k=function(){function f(e){this.app=e}f.prototype.getLastOperationProgress=function(e){return this.app.nativeManager.message("GetOfflineMapProgress",{localServerNamespace:this.app.localServerNamespace,offlineMapId:e})};f.prototype.resetOfflineMapProgress=function(e){return this.app.nativeManager.message("ResetOfflineMapProgress",{localServerNamespace:this.app.localServerNamespace,offlineMapId:e}).then(function(c){})};
f.prototype.setOfflineBasemapProgress=function(e,c){return this.app.nativeManager.message("SetOfflineBasemapProgress",{localServerNamespace:this.app.localServerNamespace,offlineMapId:e,progress:c}).then(function(a){})};return f}();f.OfflineMapProgressClient=k;f.wasOfflineMapSyncInterupted=function(l){return l.basemaps.some(function(e){return e.status===f.ProgressStatus.InProgress||e.status==f.ProgressStatus.NotStarted})||l.layers.some(function(e){return e.status===f.ProgressStatus.InProgress||e.status==
f.ProgressStatus.NotStarted})?!0:!1};f.ProgressStatus={NotStarted:"notStarted",InProgress:"inProgress",Complete:"complete",Error:"error"}});define("infrastructure/offline/Progress",["require","exports"],function(h,f){});
define("infrastructure/offline/WorkCalculator",["require","exports"],function(h,f){var k=function(){function f(){}f.calculateFirstDownloadWork=function(e){return{saveProfileWork:0.25,featureLayerWork:e.content.layers.length+2,basemapWork:4*e.content.basemaps.length,bundleWork:0.5}};f.calculateSyncWork=function(e,c){return{saveProfileWork:0,featureLayerWork:c.featureDataSync?e.content.layers.length+2:0,basemapWork:c.basemapDownloads?2*e.content.basemaps.length:0,bundleWork:c.updateBundle?0.5:0}};f.noWork=
function(){return{saveProfileWork:0,bundleWork:0,featureLayerWork:0,basemapWork:0}};f.calculatePercentageComplete=function(e,c){return this._calculateTotalWork(e)/this._calculateTotalWork(c)*100};f._calculateTotalWork=function(e){return e.saveProfileWork+e.bundleWork+e.featureLayerWork+e.basemapWork};return f}();f.WorkCalculator=k});
define("infrastructure/offline/StringFormatting",["require","exports"],function(h,f){f.formatByteTransferRateString=function(f,l){var e=l/1024;if(1>e)return f.getResource("Mapping.Infrastructure","language-offline-progress-bytes-per-second").format(Math.round(l));var c=l/1048576;return 1>c?f.getResource("Mapping.Infrastructure","language-offline-progress-kilobytes-per-second").format(Math.round(e)):f.getResource("Mapping.Infrastructure","language-offline-progress-megabytes-per-second").format(Math.round(10*
c)/10)};f.formatBytesString=function(f,l){var e=l/1024;if(1>e)return f.getResource("Mapping.Infrastructure","language-offline-progress-bytes").format(l);var c=l/1048576;if(1>c)return f.getResource("Mapping.Infrastructure","language-offline-progress-kilobytes").format(Math.round(e));e=l/1073741824;return 1>e?f.getResource("Mapping.Infrastructure","language-offline-progress-megabytes").format(Math.round(c)):f.getResource("Mapping.Infrastructure","language-offline-progress-gigabytes").format(Math.round(100*
e)/100)}});
define("infrastructure/offline/BasemapDownloading","require exports infrastructure/offline/OfflineMap infrastructure/offline/OfflineMapProgressClient geocortex/essentials/Site infrastructure/offline/StringFormatting geocortex/essentials/RestHelperHTTPService".split(" "),function(h,f,k,l,e,c,a){function b(a,b){a.map.layerIds.filter(function(d){return 0<=a.map.getLayer(d).url.indexOf(b)}).map(function(b){return a.map.getLayer(b)});return a.site.essentialsMap.mapServices.filter(function(a){return 0<=a.serviceUrl.indexOf(b)}).map(function(a){return a.serviceToken})[0]}
function d(a,b,d,c,e){if(!d)throw Error("basemap cannot be null.");if(!d.filename)throw Error("basemap.filename cannot be null.");if(!d.url)throw Error("basemap.url cannot be null.");switch(d.sourceType){case k.OfflineMapBasemap.Type.PREGENERATED:return g(a,d,c,e);case k.OfflineMapBasemap.Type.EXPORT_TILES:return m(a,b,d,c,e)}return null}function g(b,d,g,m){var f=b.makeAbsolute(d.url,b.site.url),l=b.site.getTokenFromPrincipal(f,e.Site)||b.site.getTokenFromPrincipal(f,esri.IdentityManagerBase);null!=
l&&(f=a.RestHelperHTTPService.appendTokenToUrl(f,l));return b.nativeManager.message("DownloadResource",{url:f,fileName:d.filename,overwrite:"OnNewer"},g,function(a){var g=a.details;switch(g.status){case q.connecting:m&&m({message:b.getResource("Mapping.Infrastructure","language-offline-progress-basemapdownload-connecting").format(d.filename),percentage:0});break;case q.downloading:if(m){a=Math.round(g.bytesDownloaded/g.bytesTotal*100);var e=c.formatBytesString(b,g.bytesDownloaded),f=c.formatBytesString(b,
g.bytesTotal),g=c.formatByteTransferRateString(b,g.bytesPerSecond);m({message:b.getResource("Mapping.Infrastructure","language-offline-progress-basemapdownload-downloading").format(d.filename,e,f,a,g),percentage:a})}break;default:b.trace.error("Unknown ResourceDownloadEvent status "+g.status)}})}function m(d,g,m,f,l){var k=m.url,h=d.site.getTokenFromPrincipal(k,esri.IdentityManagerBase)||d.site.getTokenFromPrincipal(k,e.Site);null!=h&&(k=a.RestHelperHTTPService.appendTokenToUrl(k,h));h=b(d,k);g={url:k,
fileName:m.filename,minLevel:m.minLevel,maxLevel:m.maxLevel,areaOfInterest:JSON.stringify({features:[{geometry:g.content.geometry}]}),refreshInterval:m.refreshInterval,token:h};return d.nativeManager.message("ExportTiles",g,f,function(a){var b=a.details;switch(b.status){case q.connecting:l&&l({message:d.getResource("Mapping.Infrastructure","language-offline-progress-basemapexport-connecting").format(m.filename),percentage:0});break;case q.processing:l&&l({message:b.message||d.getResource("Mapping.Infrastructure",
"language-offline-progress-basemapexport-processing").format(m.filename),percentage:0});break;case q.downloading:if(l){a=Math.round(b.bytesDownloaded/b.bytesTotal*100);var g=c.formatBytesString(d,b.bytesDownloaded),e=c.formatBytesString(d,b.bytesTotal),b=c.formatByteTransferRateString(d,b.bytesPerSecond);l({message:d.getResource("Mapping.Infrastructure","language-offline-progress-basemapexport-downloading").format(m.filename,g,e,a,b),percentage:a})}break;default:d.trace.error("Unknown ResourceDownloadEvent status "+
b.status)}})}f.downloadBasemaps=function(a,b,c,g,e){var m=new l.OfflineMapProgressClient(a),f=0;return Promise.reduce(b.content.basemaps,function(q,k){if(g.isCancellationRequested)throw Error("Operation cancelled.");var h=c?c.basemaps.filter(function(a){return a.referenceId==k.baseMapId})[0]:null;return Promise.resolve().then(function(){return h&&h.status===l.ProgressStatus.Complete?Promise.resolve():m.setOfflineBasemapProgress(b.id,{referenceId:k.baseMapId,status:l.ProgressStatus.InProgress,type:k.sourceType,
filename:k.filename,statusUrl:h?h.statusUrl:null})}).then(function(){return h&&h.status===l.ProgressStatus.Complete?Promise.resolve():d(a,b,k,g,function(a){var d=(a.percentage+100*f)/b.content.basemaps.length;e&&e({message:a.message,percentage:d})})}).then(function(){return m.setOfflineBasemapProgress(b.id,{referenceId:k.baseMapId,status:l.ProgressStatus.Complete,type:k.sourceType,filename:k.filename})})["catch"](function(d){e&&e({isWarning:!0,message:a.getResource("Mapping.Infrastructure","language-offline-progress-basemapdownload-failed").format(k.filename,
d.message||d),percentage:100});return m.setOfflineBasemapProgress(b.id,{referenceId:k.baseMapId,status:l.ProgressStatus.Error,errorMessage:d.message||d,type:k.sourceType,filename:k.filename})})["finally"](function(){f++})},null)};f.getServiceTokenForMapService=b;var q={connecting:"Connecting",processing:"Processing",downloading:"Downloading"}});
define("infrastructure/offline/BasemapDeleting",["require","exports","infrastructure/offline/OfflineMap"],function(h,f,k){function l(e,c){if(!c)return Promise.reject("basemap cannot be null.");if(!c.filename)return Promise.reject("basemap.filename cannot be null.");switch(c.sourceType){case k.OfflineMapBasemap.Type.PREGENERATED:return e.nativeManager.message("RemoveResource",{fileName:c.filename});case k.OfflineMapBasemap.Type.EXPORT_TILES:return e.nativeManager.message("RemoveExportedTiles",{fileName:c.filename})}return null}
f.deleteBasemaps=function(e,c){return Promise.all(c.map(function(a){return l(e,a)})).then(function(){return null})}});
define("infrastructure/offline/TokenRefresher",["require","exports"],function(h,f){var k=function(){function f(){}f.ensureAllTokensAreUpToDate=function(e){var c=6E4>(new Date(e.site.principal.expiry)).valueOf()-(new Date).valueOf();return e.site.principal.isAuthenticated&&c?e.site.refreshPrincipal().then(function(){return Promise.resolve(e.site.updateServiceTokensIfStale())}).then(function(){}):Promise.resolve(e.site.updateServiceTokensIfStale()).then(function(){})};return f}();f.TokenRefresher=k});
define("infrastructure/offline/OfflineManager","require exports infrastructure/CancellationTokenSource infrastructure/offline/OfflineMap infrastructure/offline/bundle/BundleManager infrastructure/offline/OfflineMapProgressClient infrastructure/AreaOfInterestMask geocortex/framework/observables infrastructure/ArrayUtils infrastructure/offline/WorkCalculator infrastructure/offline/SyncParameters infrastructure/offline/SyncEngine infrastructure/offline/BasemapDownloading infrastructure/offline/BasemapDeleting infrastructure/offline/TokenRefresher geocortex/essentials/FeatureLayerService infrastructure/gis/AppInfo geocortex/essentials/Layer geocortex/essentials/MapServiceConstants geocortex/essentials/utilities/DecomposedUri".split(" "),
function(h,f,k,l,e,c,a,b,d,g,m,q,n,p,s,r,t,u,v,y){h=function(){function f(d,g){this.app=d;this.libraryId=g;this._activeOfflineMapId=null;this._isCancelling=!1;this._previousActiveOfflineMapId=null;this._offlineMaps=[];this.canCancel=new b.Observable(!1);this.isOfflineMapActive=new b.Observable(!1);this.currentOperation=null;this._bundleManager=new e.BundleManager(d,g);this._progressClient=new c.OfflineMapProgressClient(d);this.aoiMask=new a.AreaOfInterestMask(d,{enabled:!1})}f.prototype.addOfflineMap=
function(a,b){var d=this,e;return this._lastOperation=this._waitForLast().then(function(){d.currentOperation=x.Download;d._throwIfNotNativeInitialized();return d._progressClient.getLastOperationProgress(a.id)}).then(function(b){return(e=b)&&c.wasOfflineMapSyncInterupted(e)?d._loadOfflineMapFromStorage(a.id):a}).then(function(c){c&&(a=c);l.OfflineMap.verify(a);d.canCancel.set(!0);d._cancellationTokenSource=new k.CancellationTokenSource;b||(b=function(){});var f=g.WorkCalculator.calculateFirstDownloadWork(a),
p=g.WorkCalculator.noWork(),h=function(){return g.WorkCalculator.calculatePercentageComplete(p,f)};b({message:d.getResource("language-offline-progress-updating-tokens"),percentage:h()});return s.TokenRefresher.ensureAllTokensAreUpToDate(d.app).then(function(){return d._appStoreSetPromise(d._getOfflineMapKey(a),JSON.stringify(a))}).then(function(){b({message:d.getResource("language-offline-progress-savingofflinemap"),percentage:h()});d._setOfflineMap({id:a.id,isDownloaded:!1,hasProgress:!0},a);return d._save()}).then(function(){d._throwIfCanceled();
p.saveProfileWork=f.saveProfileWork;b({message:d.getResource("language-offline-progress-starting-sync"),percentage:h()});var c=m.SyncParameters.buildSyncParameters(d.app,a);return q.SyncEngine.sync(d.app,c,d._cancellationTokenSource.token(),function(a){if(a.warnings)for(var d=0,c=a.warnings;d<c.length;d++)b({message:c[d],percentage:h(),isWarning:!0});p.featureLayerWork=a.overallProgress/100*f.featureLayerWork;b({message:a.text,percentage:h()})})}).then(function(){d._throwIfCanceled();p.featureLayerWork=
f.featureLayerWork;b({message:d.getResource("language-offline-progress-starting-basemap-download"),percentage:h()});return n.downloadBasemaps(d.app,a,e,d._cancellationTokenSource.token(),function(a){p.basemapWork=a.percentage/100*f.basemapWork;b({message:a.message,percentage:h(),isWarning:a.isWarning})})}).then(function(){d._throwIfCanceled();p.basemapWork=f.basemapWork;b({message:d.getResource("language-offline-progress-downloadingsite"),percentage:h()});return d._bundleManager.createBundle(a.id,
d._getOfflineMapBasemapMapping(a))}).then(function(){return d._progressClient.resetOfflineMapProgress(a.id)}).then(function(){d._setOfflineMap({id:a.id,isDownloaded:!0,hasProgress:!1},a);return d._save()}).then(function(){d._throwIfCanceled();p.bundleWork=f.bundleWork;b({message:d.getResource("language-offline-progress-complete"),percentage:h()});d.app.event("OfflineMapAddedEvent").publish({offlineMap:a})})["catch"](function(b){d._isCancelling&&d._removeOfflineMapNow(a,function(){});d.app.event("OfflineMapSyncErrorEvent").publish({offlineMap:a,
error:b});throw b;})["finally"](function(){d._cancellationTokenSource.dispose();d._cancellationTokenSource=null;d.canCancel.set(!1);d._isCancelling=!1;d.currentOperation=null})}).then(function(){})};f.prototype.removeOfflineMap=function(a,b){var d=this;return this._lastOperation=this._waitForLast()["finally"](function(){return d._removeOfflineMapNow(a,b)})};f.prototype.removeOfflineMapPartialData=function(a,b){var d=this;if(!a)throw Error(this.getResource("language-offline-errors-offlinemapnull"));
this._throwIfNotNativeInitialized();this.currentOperation=x.RemovePartial;if(-1===this._getOfflineMapIx(a))throw Error(this.getResource("language-offline-errors-notfound"));return q.SyncEngine.deletePartialData(this.app,a.id,b)["catch"](function(a){d.app.trace.error("Error deleting feature data: "+a)}).then(function(){return d._progressClient.resetOfflineMapProgress(a.id)})["catch"](function(a){d.app.trace.error("Error resetting offline map progress. "+a)})["finally"](function(){d.currentOperation=
null;d.app.event("OfflineMapPartialDataRemovedEvent").publish({offlineMap:a})})};f.prototype._removeOfflineMapNow=function(a,b){var d=this;if(!a)throw Error(this.getResource("language-offline-errors-offlinemapnull"));this._throwIfNotNativeInitialized();this.currentOperation=x.Remove;var c="string"===typeof a||a instanceof String?a:a.id,g=this._getOfflineMapIx(a);if(-1===g)throw Error(this.getResource("language-offline-errors-notfound"));var e=this._offlineMaps[g].offlineMap;if(e.id===this._activeOfflineMapId)throw Error(this.getResource("language-offline-errors-isactive"));
return q.SyncEngine.deleteData(this.app,e.id)["catch"](function(a){d.app.trace.error("Error deleting feature data: "+a)}).then(function(){b&&b(d.getResource("language-offline-progress-unregisteringreplica"));return d._bundleManager.deleteBundle(e.id)})["catch"](function(a){d.app.trace.error("Error deleting bundle: "+a)}).then(function(){b&&b(d.getResource("language-offline-progress-removingofflinemap"));var c=e.content.basemaps.filter(function(a){return a.sourceType===l.OfflineMapBasemap.Type.EXPORT_TILES});
p.deleteBasemaps(d.app,c).then(null,function(a){d.app.trace.error("Error deleting offline map. "+a)});return d._appStoreRemovePromise(d._getOfflineMapKey(a))})["catch"](function(a){d.app.trace.error("Error deleting offline map. "+a)}).then(function(){e.id===d._previousActiveOfflineMapId&&(d._previousActiveOfflineMapId=null);d._offlineMaps.splice(g,1);return d._save()}).then(function(){return d._progressClient.resetOfflineMapProgress(c)})["catch"](function(a){d.app.trace.error("Error resetting offline map progress. "+
a)})["finally"](function(){d.app.event("OfflineMapRemovedEvent").publish({offlineMap:a});d.currentOperation=null})};f.prototype.syncFeatureData=function(a,b){for(var d=[],c=0;c<a.length;c++)d.push(this.syncOfflineMap(a[c],function(d){b&&b({isWarning:d.isWarning,message:d.message,percentage:d.percentage/a.length})}));return Promise.all(d)};f.prototype.syncOfflineMap=function(a,b,d){var e=this;d||(d={basemapDownloads:!0,updateBundle:!0,featureDataSync:!0,refreshMap:!0});var f,h=this._getOfflineMapIx(a),
r="string"===typeof a||a instanceof String?this._offlineMaps[h].offlineMap:a;return this._lastOperation=this._waitForLast().then(function(){if(!a)throw Error(e.getResource("language-offline-errors-offlinemapnull"));if(-1===h)throw Error(e.getResource("language-offline-errors-notfound"));e._throwIfNotNativeInitialized();e.currentOperation=x.Sync;return e._progressClient.getLastOperationProgress(r.id)}).then(function(a){return(f=a)&&c.wasOfflineMapSyncInterupted(f)?e._loadOfflineMapFromStorage(r.id):
r}).then(function(a){a&&(r=a);e._setOfflineMap({id:r.id,isDownloaded:!0,hasProgress:!0},r);return e._save()}).then(function(){var a=null;r!==e._offlineMaps[h].offlineMap&&(a=l.OfflineMap.diff(e._offlineMaps[h].offlineMap,r));e.canCancel.set(!0);e._cancellationTokenSource=new k.CancellationTokenSource;var c=g.WorkCalculator.calculateSyncWork(r,d),u=g.WorkCalculator.noWork(),t=function(){return g.WorkCalculator.calculatePercentageComplete(u,c)};b({message:e.getResource("language-offline-progress-updating-tokens"),
percentage:t()});return Promise.resolve().then(function(){return s.TokenRefresher.ensureAllTokensAreUpToDate(e.app)}).then(function(){if(d.featureDataSync){var a=m.SyncParameters.buildSyncParameters(e.app,r);return q.SyncEngine.sync(e.app,a,e._cancellationTokenSource.token(),function(a){if(a.warnings)for(var d=0,g=a.warnings;d<g.length;d++)b({message:g[d],percentage:t(),isWarning:!0});u.featureLayerWork=a.overallProgress/100*c.featureLayerWork;b({message:a.text,percentage:t()})})}}).then(function(){e._throwIfCanceled();
u.featureLayerWork=c.featureLayerWork;if(d.basemapDownloads){var b=[];a&&a.content&&a.content.geometry?b=r.content.basemaps.filter(function(a){return a.sourceType===l.OfflineMapBasemap.Type.EXPORT_TILES}):a&&a.content&&a.content.basemaps&&(b=r.content.basemaps.filter(function(a){return a.sourceType===l.OfflineMapBasemap.Type.EXPORT_TILES}).filter(function(b){return!a.content.basemaps.some(function(a){return a.baseMapId===b.baseMapId&&a.sourceType===b.sourceType&&a.url===b.url&&a.minLevel===b.minLevel&&
a.maxLevel===b.maxLevel})}));return 0<b.length?p.deleteBasemaps(e.app,b):null}}).then(function(){e._throwIfCanceled();if(d.basemapDownloads)return b({message:e.getResource("language-offline-progress-starting-basemap-download"),percentage:t()}),n.downloadBasemaps(e.app,r,f,e._cancellationTokenSource.token(),function(a){u.basemapWork=a.percentage/100*c.basemapWork;b({message:a.message,percentage:t(),isWarning:a.isWarning})})}).then(function(){e._throwIfCanceled();e.canCancel.set(!1);u.basemapWork=c.basemapWork;
if(d.updateBundle)return b({message:e.getResource("language-offline-progress-downloadingsite"),percentage:t()}),e._bundleManager.updateBundle(r.id,e._getOfflineMapBasemapMapping(r))}).then(function(){if(!a)return null;b({message:e.getResource("language-offline-progress-savingofflinemap"),percentage:t()});return e._appStoreSetPromise(e._getOfflineMapKey(r),JSON.stringify(r))}).then(function(){e._setOfflineMap({id:r.id,isDownloaded:!0,hasProgress:!1},r);return e._save()}).then(function(){return e._progressClient.resetOfflineMapProgress(r.id)}).then(function(){u.bundleWork=
c.bundleWork;b({message:e.getResource("language-offline-progress-complete"),percentage:t()});d.refreshMap&&(e.aoiMask.show(new esri.geometry.Polygon(r.content.geometry)),e.app.site.essentialsMap.mapServices.forEach(function(a){return a.refresh()}));e.app.event("OfflineMapSyncedEvent").publish({offlineMap:r})})["catch"](function(a){if(e._isCancelling)return e._setOfflineMap({id:r.id,isDownloaded:!0,hasProgress:!1},r),e._progressClient.resetOfflineMapProgress(r.id).then(function(){e.app.event("OfflineMapSyncErrorEvent").publish({offlineMap:r,
error:a})});e.app.event("OfflineMapSyncErrorEvent").publish({offlineMap:r,error:a});throw a;})["finally"](function(){e._cancellationTokenSource.dispose();e._cancellationTokenSource=null;e.canCancel.set(!1);e._isCancelling=!1;e.currentOperation=null})})};f.prototype.updateBundle=function(a){var b=this;return this._lastOperation=this._waitForLast()["finally"](function(){if(!a)throw Error(b.getResource("language-offline-errors-offlinemapnull"));a=b._getOfflineMapIx(a);if(-1===a)throw Error(b.getResource("language-offline-errors-notfound"));
b._throwIfNotNativeInitialized();var a=b._offlineMaps[a].offlineMap;return b._bundleManager.updateBundle(a.id,b._getOfflineMapBasemapMapping(a))})};f.prototype.activateOfflineMap=function(a,b){var d=this;return this._lastOperation=this._waitForLast()["finally"](function(){if(!a)throw Error(d.getResource("language-offline-errors-offlinemapnull"));var c=d._getOfflineMapIx(a);if(-1===c)throw Error(d.getResource("language-offline-errors-notfound"));d.currentOperation=x.Activate;var g=d._offlineMaps[c].offlineMap;
d._throwIfNotNativeInitialized();var e=d._activeOfflineMapId;d._activeOfflineMapId=g.id;return d._bundleManager.loadBundle(d._activeOfflineMapId).then(function(){return d.refreshSyncInfo()}).then(function(){return d._save()})["catch"](function(a){d._activeOfflineMapId=e;return Promise.resolve().then(function(){return e?d._bundleManager.loadBundle(d._activeOfflineMapId):d._bundleManager.unloadBundle()}).then(function(){return d.refreshSyncInfo()})["catch"](function(a){d.app.trace.error("Error undoing attempt to activate offline map. "+
(a.message||a))}).then(function(){throw a;})}).then(function(){d.app.isOffline.set(!0);d.isOfflineMapActive.set(!0);var a=new esri.geometry.Polygon(g.content.geometry);d.aoiMask.show(a);d._restoreOfflineUserAddedLayers(g);d.app.site.essentialsMap.mapServices.forEach(function(a){if(a instanceof r.FeatureLayerService){var b=a.serviceLayer;b.suspended&&b.resume()}a.refresh()});d.app.event("OfflineMapActivatedEvent").publish({offlineMap:d._offlineMaps[c].offlineMap,userAction:!!b})})["finally"](function(){d.currentOperation=
null})})};f.prototype.deactivateOfflineMap=function(a){var b=this;return this._lastOperation=this._waitForLast()["finally"](function(){b._throwIfNotNativeInitialized();if(null==b._activeOfflineMapId)return Promise.resolve();b.currentOperation=x.Deactivate;b._previousActiveOfflineMapId=b._activeOfflineMapId;b._activeOfflineMapId=null;return b._bundleManager.unloadBundle().then(function(){return b.refreshSyncInfo()}).then(function(){return b._save()}).then(function(){b.app.isOffline.set(!1);b.isOfflineMapActive.set(!1);
b.aoiMask.hide();b.app.site.updateServiceTokensIfStale().then(function(){b.app.site.essentialsMap.mapServices.forEach(function(a){if(a instanceof r.FeatureLayerService){var b=a.serviceLayer,d=new esri.tasks.Query;d.objectIds=[0];b.queryIds(d,function(){a.refresh()},function(){b.suspend()})}else a.refresh()})});b.app.event("OfflineMapActivatedEvent").publish({offlineMap:null,userAction:!!a})})["finally"](function(){b.currentOperation=null})})};f.prototype.cancel=function(){return this.canCancel.get()?
(this._isCancelling=!0,this._cancellationTokenSource.cancel(),this.canCancel.set(!1),this._lastOperation):Promise.reject(this.getResource("language-offline-errors-cancelrejected"))};f.prototype.forgetLast=function(){this._lastOperation=Promise.resolve()};f.prototype.getOfflineMapById=function(a){return this._offlineMaps.map(function(a){return a.offlineMap}).filter(function(b){return b.id===a})[0]};f.prototype.getOfflineMapWithStateById=function(a){return this._offlineMaps.filter(function(b){return b.offlineMap.id===
a})[0]};f.prototype.getOfflineMaps=function(){return this._offlineMaps.map(function(a){return a.offlineMap})};f.prototype.getOfflineMapsWithState=function(){return this._offlineMaps.concat()};f.prototype.getActiveOfflineMap=function(){return this._activeOfflineMapId?this.getOfflineMapById(this._activeOfflineMapId):null};f.prototype.refreshSyncInfo=function(){var a=this;if(!this._activeOfflineMapId)return this.syncInfo=null,Promise.resolve();console.log("refreshing sync info");return q.SyncEngine.getSyncInfo(this.app,
this._activeOfflineMapId).then(function(b){console.log("sync info refreshed");a.syncInfo=b})};f.prototype._save=function(){var a=this,b={offlineMapStates:this._offlineMaps.map(function(a){return a.state}),activeOfflineMapId:this._activeOfflineMapId,previousActiveOfflineMapId:this._previousActiveOfflineMapId};return this._appStoreSetPromise("__offlineManager",JSON.stringify(b))["catch"](function(b){a.app.trace.error("Error saving offline manager state. "+(b.message||b));b.message=a.getResource("language-offline-errors-savefailed");
throw b;}).then(function(){})};f.prototype.load=function(){var a=this;if(!this._lastOperation)return this.app.trace.info("loading offline map"),this._lastOperation=this._appStoreGetPromise("__offlineManager").then(function(b){a.app.trace.info("offline map loaded");if(!b)return null;var d=JSON.parse(b);d.offlineMapIds&&!d.offlineMapStates&&(d.offlineMapStates=d.offlineMapIds.map(function(a){return{id:a,isDownloaded:!0,hasProgress:!1}}));b=d.offlineMapStates.map(function(b){return a._loadOfflineMapFromStorage(b.id)["catch"](function(d){a.app.trace.warning("Unable to restore offline map '"+
b.id+"'. "+(d.message||d));return null})});return Promise.filter(b,function(a){return null!=a}).then(function(b){a._offlineMaps=b.map(function(a){return{offlineMap:a,state:d.offlineMapStates.filter(function(b){return b.id===a.id})[0]}});b=a._prioritizeOfflineMaps(d,a._offlineMaps.map(function(a){return a.offlineMap}));return a._initializeMap(b).then(function(){a.app.trace.info("offline map initialized")})}).then(function(){a.app.event("OfflineMapsLoadedEvent").publish({offlineMaps:a._offlineMaps.map(function(a){return a.offlineMap}),
activeOfflineMap:a.getActiveOfflineMap(),offlineMapStates:a._offlineMaps.map(function(a){return a.state})})})})["catch"](function(b){a.app.trace.error("Error loading offline manager state. "+(b.message||b));b.message=a.getResource("language-offline-errors-loadfailed");throw b;}),this._lastOperation.then(function(){})};f.prototype.setStoreResource=function(a,b,d){return this._bundleManager.setStoreResource(a.id,b,d)};f.prototype.getStoreResource=function(a,b){return this._bundleManager.getStoreResource(a.id,
b)};f.prototype.hasInternetCheck=function(){return this.app.nativeManager.message("CanReachHost",{url:this.app.site.url})};f.prototype._prioritizeOfflineMaps=function(a,b){for(var d=[a.activeOfflineMapId,a.previousActiveOfflineMapId],c=0,g=b.map(function(a){return a.id});c<g.length;c++){var e=g[c];e!==a.activeOfflineMapId&&e!==a.previousActiveOfflineMapId&&d.push(e)}return d};f.prototype._initializeMap=function(a){var b=this;if(0===a.length&&this.app.isOffline.get())return Promise.resolve();var d=
a[0];return this.app.isOffline.get()&&!d?this._initializeMap(a.slice(1)):d?this._bundleManager.loadBundle(d).then(function(){b._activeOfflineMapId=d;b.app.isOffline.set(!!d);b.isOfflineMapActive.set(!!d);var a=b._getOfflineMapIx(d),c=b._offlineMaps[a].offlineMap,a=new esri.geometry.Polygon(b._offlineMaps[a].offlineMap.content.geometry);b.aoiMask.show(a);b._restoreOfflineUserAddedLayers(c);return b.refreshSyncInfo()})["catch"](function(d){return b._initializeMap(a.slice(1))}):Promise.resolve()};f.prototype._waitForLast=
function(){return this._lastOperation["catch"](function(a){})};f.prototype._throwIfCanceled=function(){if(this._cancellationTokenSource.token().isCancellationRequested)throw Error(this.getResource("language-offline-errors-canceled"));};f.prototype._throwIfNotNativeInitialized=function(){if(!this.app.nativeManager.nativeInitialized)throw Error(this.getResource("language-offline-errors-notnativeinitialized"));};f.prototype._loadOfflineMapFromStorage=function(a){var b=this;return this._appStoreGetPromise(this._getOfflineMapKey(a)).then(function(a){if(!a)throw b.app.trace.error("Offline profile '{offlineMapId}' not found."),
Error(b.getResource("language-offline-errors-notfound"));return JSON.parse(a)},function(a){b.app.trace.error("Error loading offline map. "+(a.message||a));a.message=b.getResource("language-offline-errors-loadfailed");throw a;})};f.prototype._restoreOfflineUserAddedLayers=function(a){var b=this;this.app.waitUntilSiteServiceLayersLoaded().then(function(){var d=[],c=t.AppInfo.fromGeocortexApp(b.app);a.content.layers.forEach(function(b){if(b.isUserCreated&&b.serviceInfo){var g=b.serviceInfo.url;if(g){var e=
c.mapInfo.getLayerInfos().filter(function(a){return a.uniqueId===b.layerInfoUniqueId})[0];if(e)e.gcxLayer&&e.gcxLayer.properties.offlineMapId&&(e.gcxLayer.properties.offlineMapId=a.id);else{var m=c.mapInfo.serviceLayers.filter(function(a){return a.serviceLayer.url===g})[0];if(m&&m.gcxMapService){e=new u.Layer(b.layerJson.url);e.createFromDefinition(b.layerJson);e.isUserCreated=!0;e.catalogId=b.layerJson.catalogId;e.includeInLayerList=!0;e.setInActiveTheme(!0);e.properties.offlineMapId=a.id;e.parentLayerId=
null;m.gcxMapService.add(e);var f=d.filter(function(a){return a.service===m.gcxMapService})[0];f?f.layers.push(e):d.push({service:m.gcxMapService,layers:[e]})}}}}});d.forEach(function(a){b.app.event("MapServiceLayersChangedWithResultEvent").publish({mapService:a.service,newItems:a.layers,oldItems:[]});b.app.event("MapServiceLayersChangedEvent").publish(a.service)})})};f.prototype._getOfflineMapIx=function(a){a="string"===typeof a?a:a.id;for(var b=0;b<this._offlineMaps.length;b++)if(this._offlineMaps[b].offlineMap.id===
a)return b;return-1};f.prototype._getOfflineMapBasemapMapping=function(a){var b=this.app.site.essentialsMap.baseMaps;return a.content.basemaps.map(function(a){var d=b.filter(function(b){return a.baseMapId===b.id})[0];return d?(d=d.services.filter(function(a){return a.mapService.mapServiceType===v.MapServiceType.TILED}).pop())?{url:y.DecomposedUri.removeQueryParameters(d.mapService.serviceLayer.url,"token"),localServicePath:(a.sourceType===l.OfflineMapBasemap.Type.PREGENERATED?"tile":"viewertile")+
"/"+a.filename.replace(" ","_")}:null:null}).filter(function(a){return!!a})};f.prototype._getOfflineMapKey=function(a){return"string"===typeof a?"__offlineMap-"+a:"__offlineMap-"+a.id};f.prototype._appStoreGetPromise=function(a){var b=this;return new Promise(function(d,c){return b.app.store.get(a,d,c)})};f.prototype._appStoreSetPromise=function(a,b){var d=this;return new Promise(function(c,g){return d.app.store.set(a,b,function(){return c()},g)})};f.prototype._appStoreRemovePromise=function(a){var b=
this;return new Promise(function(d,c){return b.app.store.remove(a,function(){return d()},c)})};f.prototype.getResource=function(a){return this.app.getResource(this.libraryId,a)};f.prototype._setOfflineMap=function(a,b){var c=d.ArrayUtils.findIndex(this._offlineMaps,function(a){return a.offlineMap.id==b.id});0<=c?this._offlineMaps.splice(c,1,{state:a,offlineMap:b}):this._offlineMaps.push({state:a,offlineMap:b})};return f}();f.OfflineManager=h;var x;(function(a){a[a.Download=1]="Download";a[a.Sync=
2]="Sync";a[a.Remove=3]="Remove";a[a.Activate=4]="Activate";a[a.Deactivate=5]="Deactivate";a[a.RemovePartial=6]="RemovePartial"})(x=f.OfflineManagerOperation||(f.OfflineManagerOperation={}))});define("infrastructure/states/State",["require","exports"],function(h,f){var k=function(){return function(f,e){this.stateDefinition=f;this.activatedBy=e}}();f.ActiveState=k});
define("infrastructure/states/States",["require","exports"],function(h,f){f.definedStates=[{name:"DefaultState",description:"language-states-default-description",isModal:!1},{name:"TransientActiveState",description:"language-states-transient-active-description",isModal:!1,enterEvents:[{name:"TransientActivatedEvent"}],exitEvents:[{name:"TransientsDeactivatedEvent"}]},{name:"IdentifyState",description:"language-states-identify-state-description",isModal:!1,enterCommands:[{name:"SetActiveTool",parameter:"PointIdentifyTool-Navigation"},
{name:"SetActiveTool",parameter:"IdentifyRectangleTool"},{name:"SetActiveTool",parameter:"RectangleIdentifyTool"}],exitEvents:[{name:"ToolCommandDeactivatedEvent",parameter:"Identify"}]},{name:"IdentifyBufferingState",parentState:"IdentifyState",description:"language-states-buffering-description",isModal:!1,enterEvents:[{name:"BufferingActivatedEvent",parameter:"Identify"}],exitEvents:[{name:"BufferingDeactivatedEvent",parameter:"Identify"}]},{name:"IdentifyCombineModeUnionState",parentState:"IdentifyState",
description:"language-states-identify-combine-description",isModal:!1,enterEvents:[{name:"IdentifyCombineModeChangeEvent",parameter:"union"}],exitEvents:[{name:"IdentifyCombineModeChangeEvent",parameter:"replace"},{name:"IdentifyCombineModeChangeEvent",parameter:"intersect"},{name:"IdentifyCombineModeChangeEvent",parameter:"subtract"}]},{name:"IdentifyCombineModeSubtractState",parentState:"IdentifyState",description:"language-states-identify-combine-description",isModal:!1,enterEvents:[{name:"IdentifyCombineModeChangeEvent",
parameter:"subtract"}],exitEvents:[{name:"IdentifyCombineModeChangeEvent",parameter:"replace"},{name:"IdentifyCombineModeChangeEvent",parameter:"union"},{name:"IdentifyCombineModeChangeEvent",parameter:"intersect"}]},{name:"PlotCoordinatesState",description:"language-states-plotcoordinates-state-description",isModal:!1,enterCommands:[{name:"SetActiveTool",parameter:"PlotCoordinatesTool"}],exitEvents:[{name:"ToolCommandDeactivatedEvent",parameter:"PlotCoordinates"}]},{name:"SnappingState",description:"language-states-snapping-description",
isModal:!1,enterCommands:[{name:"ActivateSnapping"}],exitCommands:[{name:"DeactivateSnapping"}]},{name:"FindDataState",description:"language-states-identify-state-description",isModal:!0,enterEvents:[{name:"ToolCommandActivatedEvent",parameter:"Identify"}],exitEvents:[{name:"ToolCommandDeactivatedEvent",parameter:"Identify"}]},{name:"FindDataBufferingState",parentState:"FindDataState",description:"language-states-buffering-description",isModal:!1,enterEvents:[{name:"BufferingActivatedEvent",parameter:"Identify"}],
exitEvents:[{name:"BufferingDeactivatedEvent",parameter:"Identify"}]},{name:"FindDataCombineModeUnionState",parentState:"FindDataState",description:"language-states-identify-combine-description",isModal:!1,enterEvents:[{name:"IdentifyCombineModeChangeEvent",parameter:"union"}],exitEvents:[{name:"IdentifyCombineModeChangeEvent",parameter:"replace"},{name:"IdentifyCombineModeChangeEvent",parameter:"intersect"},{name:"IdentifyCombineModeChangeEvent",parameter:"subtract"}]},{name:"FindDataCombineModeSubtractState",
parentState:"FindDataState",description:"language-states-identify-combine-description",isModal:!1,enterEvents:[{name:"IdentifyCombineModeChangeEvent",parameter:"subtract"}],exitEvents:[{name:"IdentifyCombineModeChangeEvent",parameter:"replace"},{name:"IdentifyCombineModeChangeEvent",parameter:"union"},{name:"IdentifyCombineModeChangeEvent",parameter:"intersect"}]},{name:"DrawMarkupState",description:"language-states-draw-markup-state-description",isModal:!0,enterEvents:[{name:"ToolCommandActivatedEvent",
parameter:"AddMarkup"},{name:"ToolCommandActivatedEvent",parameter:"AddTextMarkup"}],exitEvents:[{name:"ToolCommandDeactivatedEvent",parameter:"AddMarkup"},{name:"ToolCommandDeactivatedEvent",parameter:"AddTextMarkup"}]},{name:"MeasureState",description:"language-states-measure-state-description",isModal:!0,enterEvents:[{name:"ToolCommandActivatedEvent",parameter:"MeasureDistance"},{name:"ToolCommandActivatedEvent",parameter:"MeasureArea"}],exitEvents:[{name:"ToolCommandDeactivatedEvent",parameter:"MeasureDistance"},
{name:"ToolCommandDeactivatedEvent",parameter:"MeasureArea"}]},{name:"SelectMarkupForEditingState",description:"language-states-edit-state-description",isModal:!0,enterEvents:[{name:"ToolCommandActivatedEvent",parameter:"DeleteMeasurement"},{name:"ToolCommandActivatedEvent",parameter:"DeleteMarkup"},{name:"ToolCommandActivatedEvent",parameter:"EditMarkup"}],exitEvents:[{name:"ToolCommandDeactivatedEvent",parameter:"DeleteMeasurement"},{name:"ToolCommandDeactivatedEvent",parameter:"DeleteMarkup"},
{name:"ToolCommandDeactivatedEvent",parameter:"EditMarkup"}]},{name:"EditorActiveState",description:"language-states-editing-active-state-description",isModal:!1,enterCommands:[{name:"StartEditingFeature"},{name:"StartEditingNewFeature"},{name:"StartEditingNewRelatedRecord"}],exitEvents:[{name:"EditorClosedEvent"}]},{name:"EditingMarkupState",description:"language-states-editing-state-description",isModal:!1,enterEvents:[{name:"MarkupEditingStartedEvent"}],exitEvents:[{name:"MarkupEditingStoppedEvent"}]},
{name:"EditingMeasurementMarkupState",description:"language-states-editing-state-description",isModal:!1,enterEvents:[{name:"MeasurementEditingStartedEvent"}],exitEvents:[{name:"MarkupEditingStoppedEvent"}]},{name:"FeaturePlacementState",description:"language-states-feature-editing-state-description",isModal:!0,enterEvents:[{name:"StartFeaturePlacementEvent"},{name:"ToolCommandActivatedEvent",parameter:"SetEditorFeatureGeometry"}],exitEvents:[{name:"StopFeaturePlacementEvent"},{name:"ToolCommandDeactivatedEvent",
parameter:"SetEditorFeatureGeometry"}]},{name:"FeaturePlacementGraphicState",parentState:"FeaturePlacementState",description:"language-states-feature-editing-state-graphic-description",isModal:!1,enterCommands:[{name:"StartEditingGraphicGeometry"}],enterEvents:[{name:"ToolCommandActivatedEvent",parameter:"SetEditorFeatureGeometry"}],exitEvents:[{name:"StopFeaturePlacementEvent"},{name:"ToolCommandDeactivatedEvent",parameter:"SetEditorFeatureGeometry"}]},{name:"FeaturePlacementPointGraphicState",parentState:"FeaturePlacementState",
description:"language-states-feature-editing-state-point-graphic-description",isModal:!1,enterEvents:[{name:"GeometryEditPointActivatedEvent"}],exitEvents:[{name:"StopFeaturePlacementEvent"},{name:"ToolCommandDeactivatedEvent",parameter:"SetEditorFeatureGeometry"}]},{name:"MarkupStyleToggleState",description:"State for the markup style toggle button",isModal:!1,enterCommands:[{name:"_showMarkupStyleSelectorView"}],exitEvents:[{name:"_markupToggleDeactivated"}]}]});
define("infrastructure/states/StateManager",["require","exports","infrastructure/states/State","infrastructure/states/States"],function(h,f,k,l){h=function(){function e(c,a){this.registeredStates=[];this.activeStates=[];this.previousModalState=this.modalState=null;this.commandTokens=[];this.eventTokens=[];this.app=c;this.libraryId=a;for(var b=0;b<l.definedStates.length;b++)this.registerState(l.definedStates[b])}e.prototype.registerState=function(c){var a=this;if(this.registeredStates.some(function(a){return a.name===
c.name}))this.app.trace.info("States with duplicate names registered! New state ignored. Name is: "+c.name);else if(this.registeredStates.filter(function(a){return a.hasOwnProperty("parentState")}).some(function(a){return a.name===c.parentState}))this.app.trace.info("Tried to load a state with a parent that references another state that has a parent. Only parent -> child relationships are allowed. State name: "+c.name);else{var b=dojo.connect(this.app,"onLibrariesDownloaded",this,function(){dojo.disconnect(b);
a.app.hasLibrary(a.libraryId)&&-1===c.description.search(" ")&&(c.description=a.app.getResource(a.libraryId,c.description))});c.enterCommands&&c.enterCommands.forEach(function(b){var g=a.app.command(b.name).register(a,function(g){return a._stateEntered(c,b,g)});a.commandTokens.push({instance:b,token:g})});c.exitCommands&&c.exitCommands.forEach(function(b){var g=a.app.command(b.name).register(a,function(g){return a._stateExited(c,b,g)});a.commandTokens.push({instance:b,token:g})});c.enterEvents&&c.enterEvents.forEach(function(b){var g=
a.app.event(b.name).subscribe(a,function(g){return a._stateEntered(c,b,g)});a.eventTokens.push({instance:b,token:g})});c.exitEvents&&c.exitEvents.forEach(function(b){var g=a.app.event(b.name).subscribe(a,function(g){return a._stateExited(c,b,g)});a.eventTokens.push({instance:b,token:g})});this.registeredStates.push(c);"DefaultState"===c.name&&this.activeStates.push(new k.ActiveState(c))}};e.prototype.onDestroy=function(){for(var c=0;c<this.eventTokens.length;c++)this.app.event(this.eventTokens[c].instance.name).unsubscribe(this.eventTokens[c].token);
for(c=0;c<this.commandTokens.length;c++)this.app.command(this.commandTokens[c].instance.name).unregister(this.commandTokens[c].token)};e.prototype.getActiveStates=function(){for(var c=[],a=0;a<this.activeStates.length;a++)c[this.activeStates[a].stateDefinition.name]=this.activeStates[a];return this.activeStates.filter(function(a){return a.stateDefinition.parentState&&c[a.stateDefinition.parentState]||!a.stateDefinition.parentState})};e.prototype.getStateByName=function(c){for(var a=0;a<this.registeredStates.length;a++)if(this.registeredStates[a].name===
c)return this.registeredStates[a];return null};e.prototype.getModalState=function(){return this.modalState||null};e.prototype.isModalStateActive=function(){return null!==this.modalState};e.prototype.isCurrentlyActive=function(c){return this.activeStates.some(function(a){return a.stateDefinition.name===c})};e.prototype.getAllStateNames=function(){for(var c=[],a=0;a<this.registeredStates.length;a++)c.push(this.registeredStates[a].name);return c};e.prototype._stateEntered=function(c,a,b){if(!(c.parentState&&
!this.activeStates.some(function(a){return a.stateDefinition.name===c.parentState})||this.isCurrentlyActive(c.name)||a.parameter&&a.parameter!==b)){var d=null;if("string"===typeof b||b instanceof String)d=b;this.app.trace.debug("State entered: "+c.name);c.isModal&&(null!==this.modalState&&(this.previousModalState=this.modalState,this._exitState(this.modalState,a,d)),this.app.trace.debug("Modal State entered: "+c.name),this.modalState=c);this.activeStates.push(new k.ActiveState(c,a));this.app.event("StateEnteredEvent").publish({stateDefinition:c,
activeStates:this.activeStates,modalState:this.modalState,previousModalState:this.modalState})}};e.prototype._stateExited=function(c,a,b){if(!a.parameter||a.parameter===b){for(var d=!1,g=0;g<this.activeStates.length;g++)this.activeStates[g].stateDefinition===c&&(d=!0);g=!1;c.parentState&&(g=this.activeStates.some(function(a){return a.stateDefinition.name===c.parentState}));if(d&&(!c.parentState||g)){d=null;if("string"===typeof b||b instanceof String)d=b;this._exitState(c,a,d)}}};e.prototype._exitState=
function(c,a,b){this._exitChildStates(c,a,b);for(a=this.activeStates.length-1;0<=a;a--)this.activeStates[a].stateDefinition===c&&(this.activeStates.splice(a,1),this.app.trace.debug("State exited: "+c.name));this.modalState===c&&(this.modalState=null,this.previousModalState=c,this.app.trace.debug("Modal state exited: "+c.name));this.app.event("StateExitedEvent").publish({stateDefinition:c,activeStates:this.activeStates,modalState:this.modalState,previousModalState:this.previousModalState})};e.prototype._exitChildStates=
function(c,a,b){for(var d=[],g=0;g<this.activeStates.length;g++)if(this.activeStates[g].stateDefinition.parentState===c.name){var e=this.activeStates[g].stateDefinition;if(e.exitCommands)for(var f=0;f<e.exitCommands.length;f++)e.exitCommands[f].name!==a.name||e.exitCommands[f].parameter&&e.exitCommands[f].parameter!==b||d.push(e);if(e.exitEvents)for(f=0;f<e.exitEvents.length;f++)e.exitEvents[f].name!==a.name||e.exitEvents[f].parameter&&e.exitEvents[f].parameter!==b||d.push(e)}for(g=0;g<d.length;g++)this._exitState(d[g],
a,b)};return e}();f.StateManager=h});define("infrastructure/undo/Undoable",["require","exports"],function(h,f){});define("infrastructure/undo/TransactionStatus",["require","exports"],function(h,f){var k=f.TransactionStatus||(f.TransactionStatus={});k.PENDING="pending";k.COMMITTING="committing";k.COMMITTED="committed";k.ABORTING="aborting";k.ABORTED="aborted"});
define("infrastructure/undo/UndoTransaction",["require","exports","infrastructure/undo/TransactionStatus"],function(h,f,k){h=function(){function f(e,c,a){void 0===c&&(c="[anonymous]");void 0===a&&(a={});if(!e)throw Error("Transaction manager is required");this.owner=e;this.displayName=c;this.state=a;this.transactionStatus=k.TransactionStatus.PENDING;this.changes=[]}f.prototype.isTopLevel=function(){return!this.parentTransaction};f.prototype.isComplete=function(){return this.isCommitted()||this.isAborted()};
f.prototype.isAborted=function(){return this.transactionStatus==k.TransactionStatus.ABORTED};f.prototype.isCommitted=function(){return this.transactionStatus==k.TransactionStatus.COMMITTED};f.prototype.add=function(e,c,a){void 0===a&&(a={});c&&!this.isComplete()&&(e=c instanceof f?c:this._wrapInTransaction(e,c,a),this.changes.push(e))};f.prototype._wrapInTransaction=function(e,c,a){void 0===a&&(a={});c.state=c.state||a;e=new f(this.owner,e);e.transactionStatus=k.TransactionStatus.PENDING;e.parentTransaction=
this;e.changes.push(c);return e};f.prototype.hasChanges=function(){return 0<this.changes.length};f.prototype.commit=function(){return this.owner.commitTransaction(this)};f.prototype.rollback=function(){return this.owner.rollbackTransaction(this)};f.prototype.performUndo=function(e,c){var a=this;return this.hasChanges()?Promise.reduce(this.changes.slice().reverse(),function(b,d){if(d)return d.performUndo(d.state,a)},null):Promise.resolve()};f.prototype.performRedo=function(e,c){var a=this;return this.hasChanges()?
Promise.reduce(this.changes,function(b,d){if(d)return d.performRedo(d.state,a)},null):Promise.resolve()};return f}();f.UndoTransaction=h});define("infrastructure/undo/TransactionManager",["require","exports"],function(h,f){});define("infrastructure/undo/UndoManagerState",["require","exports"],function(h,f){});
define("infrastructure/undo/UndoManager",["require","exports","infrastructure/undo/UndoTransaction","infrastructure/undo/TransactionStatus"],function(h,f,k,l){var e;(function(c){c.IDLE="Idle";c.UNDOING="Undoing";c.REDOING="Redoing";c.COMMITTING="Committing";c.ROLLINGBACK="RollingBack"})(e=f.Status||(f.Status={}));h=function(){function c(a,b){this.maxOperations=0;this.canUndo=this.canRedo=this.isRedoing=this.isUndoing=this.isSuspended=!1;this.position=this.length=0;this.rootTransaction=null;this._status=
e.IDLE;this._historyStack=[];this.app=a;b=b||{};"number"==typeof b.maxOperations&&this.setMaxOperations(b.maxOperations);this.registerCommands()}c.prototype.registerCommands=function(){var a=this;this.app.command("Undo").register(this,this.undo,function(b){return a.canUndo});this.app.command("Redo").register(this,this.redo,function(b){return a.canRedo})};c.prototype.suspend=function(){this.isSuspended=!0};c.prototype.resume=function(){this.isSuspended=!1};c.prototype.setMaxOperations=function(a){this.maxOperations=
a};c.prototype.getCurrentState=function(){return{historyStack:(this._historyStack||[]).slice(),position:this.position,rootTransaction:this.rootTransaction,status:this._status}};c.prototype.add=function(a){if(!a)throw Error("Undo operation cannot be null");for(;0<this.maxOperations&&this._historyStack.length>=this.maxOperations;){var b=this._historyStack.shift();this.app.event("UndoOperationDiscardedEvent").publish({sender:this,operation:b})}this._historyStack.splice(this.position,0,a);this.position++;
this.clearRedo();this.app.event("UndoOperationAddedEvent").publish({sender:this,operation:a});this._checkAvailability()};c.prototype.undo=function(){var a=this;if(0===this.position)return Promise.resolve();var b=this.peekUndo();this.position--;if(!b||"function"!==typeof b.performUndo)return Promise.resolve();this._updateStatus(e.UNDOING);this.app.event("UndoStartedEvent").publish({sender:this,operation:b});return b.performUndo(b.state).lastly(function(){a._updateStatus(e.IDLE);a.app.event("UndoCompletedEvent").publish({sender:a,
operation:b});a._checkAvailability()})};c.prototype.redo=function(){var a=this;if(this.position===this._historyStack.length)return Promise.resolve();var b=this.peekRedo();this.position++;if(!b||"function"!==typeof b.performRedo)return Promise.resolve();this._updateStatus(e.REDOING);this.app.event("RedoStartedEvent").publish({sender:this,operation:b});return b.performRedo(b.state).lastly(function(){a._updateStatus(e.IDLE);a.app.event("RedoCompletedEvent").publish({sender:a,operation:b});a._checkAvailability()})};
c.prototype.peekUndo=function(){return 0<this._historyStack.length&&0<this.position?this.getAt(this.position-1):null};c.prototype.peekRedo=function(){return 0<this._historyStack.length&&this.position<this._historyStack.length?this.getAt(this.position):null};c.prototype.clearUndo=function(){this._historyStack.splice(0,this.position);this.position=0;this._checkAvailability()};c.prototype.clearRedo=function(){this._historyStack.splice(this.position,this._historyStack.length-this.position);this.position=
this._historyStack.length;this._checkAvailability()};c.prototype.getAt=function(a){return this._historyStack[a]};c.prototype.removeAt=function(a){0<=a&&a<this._historyStack.length&&(this._historyStack.splice(a,1),0<this.position&&this.position>a&&this.position--,this._checkAvailability())};c.prototype.beginTransaction=function(a,b){var d=new k.UndoTransaction(this,a);this.rootTransaction?d.parentTransaction=b||this.rootTransaction:this.rootTransaction=d;return d};c.prototype.commitTransaction=function(a){var b=
this;a=a||this.rootTransaction;if(!a)return Promise.reject(Error("Cannot find the transaction to commit"));if(a.isComplete())return Promise.reject(Error("Transaction has been closed already"));a.transactionStatus=l.TransactionStatus.COMMITTING;if(!a.hasChanges())return a.transactionStatus=l.TransactionStatus.COMMITTED,this._onTransactionCommitted(a),Promise.resolve();var d=function(b){if(b instanceof k.UndoTransaction)return b.isComplete()?Promise.resolve():b.commit();if(b&&"function"==typeof b.performRedo)return b.performRedo(b.state,
a)},c=function(a,b){return b?d(b):null};return d(a.changes[0]).then(function(){return Promise.reduce(a.changes.slice(1),c,null)}).then(function(){a.transactionStatus==l.TransactionStatus.COMMITTING&&(a.transactionStatus=l.TransactionStatus.COMMITTED,b._onTransactionCommitted(a))})};c.prototype.rollbackTransaction=function(a){var b=this;a=a||this.rootTransaction;if(!a)return Promise.reject(Error("Cannot find the transaction to rollback"));if(a.isComplete())return Promise.reject(Error("Transaction has been closed already"));
a.transactionStatus=l.TransactionStatus.ABORTING;return a.hasChanges()?Promise.reduce(a.changes.slice().reverse(),function(b,c){if(c instanceof k.UndoTransaction)return c.isAborted()?Promise.resolve():c.rollback();if(c&&"function"==typeof c.performUndo)return c.performUndo(c.state,a)},null).then(function(){a.isAborted()||(a.transactionStatus=l.TransactionStatus.ABORTED,b._onTransactionAborted(a));if(!a.isTopLevel()&&!a.parentTransaction.isAborted())return b.rollbackTransaction(a.parentTransaction)}):
(a.transactionStatus=l.TransactionStatus.ABORTED,this._onTransactionAborted(a),Promise.resolve())};c.prototype.destroy=function(){this._historyStack=null};c.prototype._onTransactionCommitted=function(a){a&&a.isTopLevel()&&a==this.rootTransaction&&(this.rootTransaction=null,this.add(a))};c.prototype._onTransactionAborted=function(a){if(a){var b=a.parentTransaction;if(b){var d=b.changes.indexOf(a);-1<d&&b.changes.splice(d,1)}a.isTopLevel()&&a==this.rootTransaction&&(this.rootTransaction=null)}};c.prototype._checkAvailability=
function(){this.length=this._historyStack.length;this.isUndoing=this._status==e.UNDOING;this.isRedoing=this._status==e.REDOING;0===this.length?this.canUndo=this.canRedo=!1:0===this.position?(this.canUndo=!1,this.canRedo=!0):this.position===this.length?(this.canUndo=!0,this.canRedo=!1):this.canUndo=this.canRedo=!0;this.app.command("Undo").raiseCanExecuteChanged();this.app.command("Redo").raiseCanExecuteChanged();this.app.event("UndoStackChangedEvent").publish({sender:this})};c.prototype._updateStatus=
function(a){this._status=a||e.IDLE;this.isUndoing=this._status==e.UNDOING;this.isRedoing=this._status==e.REDOING};return c}();f.UndoManager=h});define("infrastructure/menus/BatchItemConfig",["require","exports"],function(h,f){});
define("infrastructure/menus/BatchItemModel",["require","exports"],function(h,f){var k=function(){return function(f,e){e&&e.command?(this.app=f,this.command=f.command(e.command),this.commandParameter=e.commandParameter||null,this.abortBatchOnFailure=!!e.abortBatchOnFailure):f&&f.trace.warning("BatchItemModel: Could not create batch item. Configuration or command not specified.")}}();f.BatchItemModel=k});define("infrastructure/menus/MenuItemConfig",["require","exports"],function(h,f){});
define("infrastructure/menus/MenuItemModel",["require","exports","infrastructure/menus/BatchItemModel","geocortex/framework-ui/StringLocalizer"],function(h,f,k,l){h=function(){function e(c,a){var b=this;if(!c||!a)throw Error("MenuItemModel: Required input parameters cannot be undefined");this.menuModel=c;this.app=c.app;this.id=a.id||"";this.text=a.text||"";this.description=a.description||"";this.iconUri=a.iconUri||this.menuModel.defaultIconUri;this.hideOnDisable=void 0!=a.hideOnDisable?a.hideOnDisable:
!1;a.batch?(this.batchItems=[],this._setBatchItems(a.batch)):a.command&&(this.command=this.app.command(a.command),this.commandParameter=a.commandParameter||null);a.libraryId&&(l.localizeString(this.app,a.libraryId,this.text,function(a){return b.text=a}),l.localizeString(this.app,a.libraryId,this.description,function(a){return b.description=a}))}e.prototype._setBatchItems=function(c){var a=this;c&&c.length&&c.forEach(function(b){b&&b.command&&a.batchItems.push(new k.BatchItemModel(a.app,b))})};return e}();
f.MenuItemModel=h});define("infrastructure/menus/MenuEntryConfig",["require","exports"],function(h,f){});
define("infrastructure/menus/MenuModel",["require","exports","infrastructure/menus/MenuItemModel"],function(h,f,k){h=function(){function f(e,c){if(!e||!c||!c.id)throw Error("MenuModel: Required input parameters cannot be undefined");this.app=e;this.id=c.id;this.title=c.title||"";this.description=c.description||"";this.defaultIconUri=c.defaultIconUri||"";this.items=this._createMenuItems(c.items)}f.prototype._createMenuItems=function(e){var c=this,a=[];e&&e.length&&e.forEach(function(b){try{var d=new k.MenuItemModel(c,
b);d&&(d.command||d.batchItems)?a.push(d):c.app.trace.warning("MenuModel: Could not create menu item for menu with id: {0}. Invalid configuration.".format(c.id))}catch(g){c.app.trace.warning("Unexpected configuration error: {0}".format(g.message))}});return a};return f}();f.MenuModel=h});
define("infrastructure/menus/MenuItemViewModel",["require","exports","geocortex/framework/observables","infrastructure/menus/MenuViewModel"],function(h,f,k,l){h=function(){function e(c,a){this._canExecuteChangedBindingTokens=[];this._contextPropertyBindingTokens={};if(!l.MenuViewModel||!a)throw Error("MenuViewModel: Could not create menu view model. Input arguments cannot be undefined.");this.menuViewModel=c;this.menuItem=a;this.app=a.app;this.text=new k.Observable(a.text);this.description=new k.Observable(a.description);
this.canExecute=new k.Observable(this.computeCanExecute());this.iconUri=new k.Observable(a.iconUri);this._setupBindings()}e.prototype.execute=function(){var c=this;this.computeCanExecute()&&(this.menuItem.command?this.menuItem.command.execute(e._computeCommandParameter(this,this.menuItem.commandParameter)):this.menuItem.batchItems.forEach(function(a){return a.command.execute(e._computeCommandParameter(c,a.commandParameter))}))};e.prototype.computeCanExecute=function(){if(this.menuItem.batchItems&&
this.menuItem.batchItems.length){for(var c=!!this.menuItem.batchItems.length,a=0;a<this.menuItem.batchItems.length;a++){var b=this.menuItem.batchItems[a];if(c&&b.abortBatchOnFailure)if(b.command)try{c=b.command.canExecute(e._computeCommandParameter(this,b.commandParameter))}catch(d){c=!1}else c=!1}return c}if(this.menuItem.command)try{return this.menuItem.command.canExecute(e._computeCommandParameter(this,this.menuItem.commandParameter))}catch(g){return!1}else return!1};e.prototype.refreshCanExecute=
function(){var c=this.computeCanExecute();this.canExecute.get()!==c&&this.canExecute.set(c)};e.prototype.destroy=function(){for(var c=this._canExecuteChangedBindingTokens.length-1;0<=c;c--){var a=this._canExecuteChangedBindingTokens[c];a.canExecuteEvent.unsubscribe(a.token);this._canExecuteChangedBindingTokens.pop()}for(var b in this._contextPropertyBindingTokens)this._contextPropertyBindingTokens.hasOwnProperty(b)&&(c=this.menuViewModel.menuContext.get(),c[b]&&c[b].unbind(this._contextPropertyBindingTokens[b]));
this._canExecuteChangedBindingTokens=this._contextPropertyBindingTokens=null};e.prototype._setupBindings=function(){var c=this,a=function(a){a&&c._canExecuteChangedBindingTokens.push({canExecuteEvent:a.canExecuteChanged,token:a.canExecuteChanged.subscribe(c,c.refreshCanExecute)})};this.menuItem.batchItems&&this.menuItem.batchItems.length?this.menuItem.batchItems.forEach(function(b){a(b.command)}):a(this.menuItem.command)};e._computeCommandParameter=function(c,a){var b=c.menuViewModel.menuContext.get(),
d=function(a){a=a.trim();if(0===a.indexOf("{{")&&0<a.indexOf("}}")){a=a.replace("{{","").replace("}}","");if(a.toLowerCase()===l.MenuViewModel.DefaultParameterName.toLowerCase())return b;if(b&&"undefined"!==typeof b[a])return b[a].isObservable&&(c._contextPropertyBindingTokens[a]&&b[a].unbind(c._contextPropertyBindingTokens[a]),c._contextPropertyBindingTokens[a]=b[a].once(c,c.refreshCanExecute)),b[a];c.app.trace.warning("Could not find menu item '{0}'.".format(a));return null}return a};if(null===
a||"undefined"===typeof a)return b;if("string"===typeof a)return d(a);if(b&&a&&"object"===typeof a){var g={},e;for(e in a)if(a.hasOwnProperty(e)){var f=a[e];g[e]="string"===typeof f?d(f):f}return g}return a};return e}();f.MenuItemViewModel=h});
define("infrastructure/menus/MenuViewModel",["require","exports","geocortex/framework/ui/ViewModelBase","geocortex/framework/observables","infrastructure/menus/MenuItemViewModel"],function(h,f,k,l,e){h=function(c){function a(a,d){var g=c.call(this,a,d)||this;g.menuTitle=new l.Observable("");g.menuDescription=new l.Observable("");g.menuItems=new l.ObservableCollection([]);g.visibleMenuItems=new l.ObservableCollection([]);g.hasExecutableMenuItems=new l.Observable(!1);g.menuContext=new l.Observable(null);
g.auto(g.menuContext,g,g._handleContextChanged);g.auto(g.menuItems,g,g._handleMenuItemsChanged);return g}__extends(a,c);a.prototype.initialize=function(a){c.prototype.initialize.call(this,a);this.menuId=a&&a.menuId||null;this.libraryId=a&&a.libraryId||this.libraryId};a.prototype.setupMenu=function(a){var d=this;if(this.menuId=a||this.menuId)if(this.menuItems.clear(),a=this.app.menuRegistry.getMenu(this.menuId)){if(a.title&&this.menuTitle.set(a.title),a.description&&this.menuDescription.set(a.description),
a.items&&a.items.length){var c=[];a.items.forEach(function(a){a=new e.MenuItemViewModel(d,a);c.push(a);d.auto(a.canExecute,d,d._computeExecutableMenuItems)});this.menuItems.addItems(c)}}else this.app.trace.error("MenuViewModel: Could not load menu '{0}'. Menu not registered.".format(this.menuId));else this.app.trace.error("MenuViewModel: Could not load menu. Menu id not specified.")};a.prototype.onDestroy=function(){c.prototype.onDestroy.call(this);this.menuItems.get().forEach(function(a){return a.destroy()});
this.menuItems.clear();this.visibleMenuItems.clear()};a.prototype._computeExecutableMenuItems=function(){var a=!1,d=[];this.visibleMenuItems.clear();for(var c=0;c<this.menuItems.length();c++){var e=this.menuItems.getAt(c);e.canExecute.get()?(a=!0,d.push(e)):e.menuItem.hideOnDisable||d.push(e)}this.visibleMenuItems.set(d);this.hasExecutableMenuItems.set(a)};a.prototype._handleContextChanged=function(a){this.menuItems.get().forEach(function(a){return a.refreshCanExecute()})};a.prototype._handleMenuItemsChanged=
function(a){if("clear"===a.type)this.visibleMenuItems.clear();else if("append"===a.type)this._computeExecutableMenuItems();else if("remove"===a.type){a=a.sender.get().slice(a.rangeStart,a.rangeEnd+1);for(var d=0;d<a.length;d++)this.visibleMenuItems.removeItem(a[d])}else"insert"===a.type&&this._computeExecutableMenuItems()};return a}(k.ViewModelBase);h.DefaultParameterName="context";f.MenuViewModel=h});
define("infrastructure/menus/MenuView",["require","exports","geocortex/framework/ui/ViewBase","infrastructure/menus/MenuViewModel"],function(h,f,k,l){h=function(e){function c(){return null!==e&&e.apply(this,arguments)||this}__extends(c,e);c.prototype.attach=function(a){var b=this.configuration.libraryId||a.libraryId||this.libraryId;!1===a instanceof l.MenuViewModel&&(b=new l.MenuViewModel(this.app,b),b.menuContext.set(a),a=b);(this.viewModel=a)&&!this.viewModel.menuId&&(this.viewModel.menuId=this.configuration&&
this.configuration.menuId||null);this.viewModel.setupMenu();this.viewModel&&this.viewModel.menuId?(this.title.set(this.getResource("language-menu-default-title")),e.prototype.attach.call(this,a)):this.app.trace.warning("Could not set up menu view '{0}'. View model or 'menuId' option not found.".format(this.id))};c.prototype.handleMenuItemClick=function(a,b,d){d&&(this.app.event("MenuItemInvokedEvent").publish({menuView:this,menuId:this.viewModel.menuId,menuItem:d}),d.execute())};c.prototype.getDescription=
function(a,b,d){d.description&&(b.title=d.description.get())};c.prototype.onDestroy=function(){e.prototype.onDestroy.call(this);this.app.menuRegistry.destroyMenuWidget(this)};return c}(k.ViewBase);f.MenuView=h});define("infrastructure/menus/MenuWidgetParameters",["require","exports"],function(h,f){});define("infrastructure/menus/MenuConfig",["require","exports"],function(h,f){});
define("infrastructure/menus/MenuRegistry",["require","exports","infrastructure/menus/MenuModel","infrastructure/menus/MenuViewModel"],function(h,f,k,l){h=function(){function e(c){this.menuList=[];this._viewMenuEntries={};this._menuConfig=[];this.app=c}e.prototype.loadMenus=function(c){var a=this;c&&c.menus&&c.menus.length&&(c.menus.forEach(function(b){return a.register(b)}),this._menuConfig=this._menuConfig.concat(c.menus))};e.prototype.register=function(c){var a=c&&c.id;this._validMenuId(a)?(c=
c instanceof k.MenuModel?c:new k.MenuModel(this.app,c),this._validateMenuModel(c)?this.menuList.push(c):this.app.trace.warning("Could not register menu with id: {0}. Invalid menu configuration.".format(a))):this.app.trace.warning("Could not register menu with id: {0}. Menu id should be defined and unique.".format(a))};e.prototype.unregister=function(c){for(var a=this.menuList.length-1;0<=a;a--)this.menuList[a].id===c&&this.menuList.splice(a,1)};e.prototype.getMenu=function(c){for(var a=this.menuList,
b=0;b<a.length;b++)if(a[b].id===c)return a[b];return null};e.prototype.getDefaultIconUri=function(c){return(c=this.getMenu(c))&&c.defaultIconUri?c.defaultIconUri:""};e.prototype.getMenuWidgetsForView=function(c){return this._viewMenuEntries[c.id]||[]};e.prototype.createMenuWidget=function(c,a,b,d,g){var e=this,f=b.domElement,n=b.viewModel;g=g?g:f.getAttribute("data-menu-id");if(!g||!this.getMenu(g))return console.log("Warning: Could not create menu view from DOM element attributes. Menu Id: {0} not registered with the MenuRegistry.".format(g)),
null;var p=f.getAttribute("data-menu-template")||"Mapping/infrastructure/menus/MenuView.html",k=f.getAttribute("data-menu-type")||"geocortex.essentialsHtmlViewer.mapping.infrastructure.menus.MenuView",h=f.getAttribute("data-menu-library-id")||d||"Mapping";d=!f.hasAttribute("data-menu-hoist-disabled");p=this.app.viewManager.createView({typeName:k,markupResource:p,isVisible:!0});if(!p)return console.log("Warning: Could not create menu '{0}' for view '{1}': Could not construct the menu widget view.".format(g,
c.id)),null;p.app=this.app;p.configuration.menuId=g;h&&(p.libraryId=h);k=new l.MenuViewModel(this.app,h);k.id="MenuViewModel-{0}".format(p.id);k.menuSourceView=c;(h=a)&&a.isObservable?k.menuContext.sync(h):n&&b&&n[b.target]&&n[b.target].isObservable?(h=n[b.target],k.menuContext.sync(h)):k.menuContext.set(h);p.attach(k);a={view:c,widgetView:p,widgetViewModel:k,context:h,menuId:g,hoistMenu:d,domElement:f};this._viewMenuEntries[c.id]||(this._viewMenuEntries[c.id]=[]);this._viewMenuEntries[c.id].push(a);
var t=c.id;dojo.aspect.after(c,"onDestroy",function(){return e._viewMenuEntries[t]=null});this.app.event("MenuWidgetCreatedForView").publish(a);return p};e.prototype.destroyMenuWidget=function(c){var a=this;c.viewModel&&(c.viewModel.menuContext.removeSync(),c.viewModel.destroy());for(var b in this._viewMenuEntries)this._viewMenuEntries.hasOwnProperty(b)&&null!=this._viewMenuEntries[b]&&this._viewMenuEntries[b].filter(function(a){return a.widgetView===c}).forEach(function(d,c){a._viewMenuEntries[b].splice(c,
1)})};e.prototype._validMenuId=function(c){var a=c?this.menuList.filter(function(a){return a.id===c}):null;return null!==a&&0===a.length};e.prototype._validateMenuModel=function(c){return!!(c&&c.id&&c.items&&c.items.length)};return e}();f.MenuRegistry=h});
define("infrastructure/tools/ToolRegistry",["require","exports","infrastructure/tools/MapTool"],function(h,f,k){h=function(){function f(e){this.tools={};this._subscriptions={};this._toolTypes={};this.app=e;this._registerCommands()}f.prototype._registerCommands=function(){var e=this;this.app.command("SetActiveTool").register(this,function(c){return e.setActiveTool(c)},function(c){return e._setActiveToolCanExecute(c)});this.app.command("ClearActiveTool").register(this,function(){return e.clearActiveTool()})};
f.prototype._setActiveToolCanExecute=function(e){return this.tool(e)?!0:!1};f.prototype.clearActiveTool=function(){for(var e in this.tools)if(this.tools.hasOwnProperty(e)){var c=this.tools[e];c&&c.isActive&&c.setActive(!1)}};f.prototype.getActiveTool=function(){for(var e in this.tools)if(this.tools.hasOwnProperty(e)){var c=this.tools[e];if(c&&c.isActive)return c}return null};f.prototype.setActiveTool=function(e){var c=this.getActiveTool();this.clearActiveTool();if(e){var a=this.tool(e);a?(this.app.event("ActiveToolChangingEvent").publish({tool:a,
previousTool:c}),a.setActive(!0)):this.app.trace.warning("Could not activate tool '{0}'. The tool does not exist in the registry.".format(e))}};f.prototype.tool=function(e){return this.tools[e]};f.prototype.register=function(e){var c=this;this.unregister(e);e&&e.name&&(this.tools[e.name]=e,this._subscriptions[e.name]=dojo.connect(e,"setActive",function(a){if(!0===a){for(var b in c.tools)c.hasOwnProperty(b)&&(a=c.tools[b])&&a!=e&&a.isActive&&a.setActive(!1);c.app.event("ActiveToolChanged").publish({tool:e,
previousTool:null});c.app.event("ActiveToolChanged").publish({tool:e,previousTool:null});c.app.event("ActiveToolChangedEvent").publish({tool:e,previousTool:null});e instanceof k.MapTool&&c.app.event("ToolCommandActivatedEvent").publish(e.command)}else c.getActiveTool()||(c.app.event("ActiveToolChanged").publish({tool:null,previousTool:e}),c.app.event("ActiveToolChangedEvent").publish({tool:null,previousTool:e}),e instanceof k.MapTool&&c.app.event("ToolCommandDeactivatedEvent").publish(e.command))}))};
f.prototype.unregister=function(e){if(e&&e.name&&this.tools[e.name]==e){this.tools[e.name]=null;var c=this._subscriptions[e.name];c&&(dojo.disconnect(c),this._subscriptions[e.name]=null)}};f.prototype.clear=function(){for(var e in this.tools){var c=this.tools[e];c&&this.unregister(c)}};f.prototype.createTools=function(e,c){var a=this,b=[];e&&e.forEach(function(d){var g=d.typeName?d.typeName:"geocortex.essentialsHtmlViewer.mapping.infrastructure.tools.MapTool";a._toolTypes.hasOwnProperty(d.command)&&
(g=a._toolTypes[d.command]);var e=dojo.getObject(g);e?(d=new e(a.app,d),b.push(d),c&&a.register(d)):a.app.trace.warning("Could not create tool '{0}' from type name '{1}'.".format(d.name,g))});return b};f.prototype.registerToolTypeForCommand=function(e,c){this._toolTypes[e]=c};return f}();f.ToolRegistry=h});
define("infrastructure/CommandViewModel",["require","exports","geocortex/framework/ui/ViewModelBase","geocortex/framework/observables"],function(h,f,k,l){h=function(c){function a(a,d,g,e){a=c.call(this,a,d)||this;a.commandName="";a.commandParameter=null;a.canExecute=new l.Observable(!0);a.notExecuteHidden=new l.Observable(!1);g&&a._bindToCommand(g,e);return a}__extends(a,c);a.prototype.applyContext=function(a){this._command&&a&&this.canExecute.set(this._command.canExecute(a))};a.prototype._bindToCommand=
function(a,d){this._canExecuteChangedBindingToken&&this._command&&this._command.canExecuteChanged.unsubscribe(this._canExecuteChangedBindingToken);this.commandName=a;this.commandParameter=d||null;this._command=this.app.command(a);this._canExecuteChangedBindingToken=this._command.canExecuteChanged.subscribe(this,this._handleCanExecuteChanged);this.canExecute.set(this._command.canExecute(d))};a.prototype._handleCanExecuteChanged=function(){this.canExecute.set(this._command.canExecute(this.commandParameter))};
return a}(k.ViewModelBase);f.CommandViewModel=h;var e;(function(c){c=c.essentialsHtmlViewer||(c.essentialsHtmlViewer={});c=c.mapping||(c.mapping={});c=c.modules||(c.modules={});c=c.command||(c.command={});c.CommandViewModel=c.CommandViewModel})(e||(e={}))});
define("infrastructure/toolbarGroup/ToolbarGroupItemBase",["require","exports","geocortex/framework/observables","geocortex/framework-ui/StringLocalizer"],function(h,f,k,l){h=function(){function e(c,a,b){this.libraryId="";this.isActive=new k.Observable(!0);this.activeTransient=new k.Observable(!1);this.disabled=new k.Observable(!1);this.hidden=new k.Observable(!1);this.cssClass=new k.Observable;this.items=new k.ObservableCollection;this.hasSmallLayout=new k.Observable(!1);this.selectedTool=new k.Observable(null);
this.toolChangeActive=new k.Observable(!1);b&&(this.id=b.id,this.app=c,this.libraryId=a,this.type=b.type,this.name=new k.Observable(b.name),this.tooltip=new k.Observable(b.tooltip||null),this.hideOnDisable=new k.Observable(!!b.hideOnDisable),b.libraryId&&l.localizeObservables(c,b.libraryId,[this.name,this.tooltip]))}e.prototype.areAllHidden=function(c){for(var a=0;a<c.length();a++)if(!1===c.getAt(a).disabled.get()||!1===c.getAt(a).hideOnDisable.get())return!1;return!0};e.prototype.setHidden=function(){!0===
this.disabled.get()&&!0===this.hideOnDisable.get()?this.hidden.set(!0):this.hidden.set(!1)};e.prototype.execute=function(){};e.prototype.activate=function(){this.isActive.set(!0)};e.prototype.deactivate=function(){this.isActive.set(!1);this.activeTransient.set(!1)};e.prototype.onDestroy=function(){};return e}();f.ToolbarGroupItemBase=h});
define("infrastructure/toolbarGroup/ToolbarGroupBase",["require","exports","geocortex/framework/observables","geocortex/framework/utils/utils","geocortex/framework-ui/StringLocalizer"],function(h,f,k,l,e){function c(b,d,c){var e=c.type,f=a[e];if(f)return f(b,d,c);throw Error("Could not find factory delegate for toolbar item type '"+e+"'");}var a={};f.registerToolbarFactoryMethod=function(b,d){a[b]=d};f.createToolbarItem=c;h=function(){function a(b,c,m){this.libraryId="";this.isActive=new k.Observable(!1);
this.disabled=new k.Observable(!1);this.cssClass=new k.Observable;this.app=b;this.libraryId=c;m&&(this.name=new k.Observable(m.name),this.id=m.id||m.name||l.alphaNumericToken(),this.tooltip=new k.Observable(m.tooltip||null),this.type=m.type||"toolbarGroup",this.isDefault=!!m.isDefault,this.items=m.items?this.getToolbarGroupItems(m.items):new k.ObservableCollection,m.libraryId&&e.localizeObservables(b,m.libraryId,[this.name,this.tooltip]))}a.prototype.getToolbarGroupItems=function(a){for(var b=new k.ObservableCollection,
e=0;e<a.length;e++){var f=null,f=c(this.app,this.libraryId,a[e]);b.addItem(f)}return b};return a}();f.ToolbarGroupBase=h});
define("infrastructure/toolbarGroup/ToolbarGroupRegistry",["require","exports","geocortex/framework/observables","infrastructure/toolbarGroup/ToolbarGroupBase"],function(h,f,k,l){h=function(){function e(c){this.toolbarGroupList=new k.ObservableCollection;this._toolbarGroupsConfig=[];this.app=c}e.prototype.getToolbarGroupById=function(c){if(0===this.toolbarGroupList.get().length||null===c)return null;for(var a=0;a<this.toolbarGroupList.get().length;a++)if(this.toolbarGroupList.getAt(a).id==c)return this.toolbarGroupList.getAt(a);
return null};e.prototype.registerToolbarGroups=function(c,a){if(c)for(var b=0;b<c.length;b++){var d=c[b],g=new l.ToolbarGroupBase(this.app,a,d);this._toolbarGroupsConfig.push(d);this.unregisterToolbarGroup(d.id);this.toolbarGroupList.addItem(g)}};e.prototype.unregisterToolbarGroup=function(c){c=this.getPosition(c);null!=c&&this.toolbarGroupList.get().splice(c,1)};e.prototype.getPosition=function(c){for(var a=0;a<this.toolbarGroupList.getLength();a++)if(this.toolbarGroupList.getAt(a).id===c)return a;
return null};return e}();f.ToolbarGroupRegistry=h});
define("infrastructure/clickableGraphics/ClickableGraphicsRegistry",["require","exports","infrastructure/Dictionary"],function(h,f,k){h=function(){function f(e){this._clickableGraphicLayers=new k.Dictionary;this._defaultOptions={displayName:null,autoEditable:!0,aliases:{},canEdit:this._defaultCallback,canDelete:this._defaultCallback,canChangeStyles:this._defaultCallback};this.app=e;this.app.event("LayerRemovedEvent").subscribe(this,this._handleLayerRemoved)}f.prototype._defaultCallback=function(e){return!0};
f.prototype.register=function(e,c){if(e instanceof esri.layers.GraphicsLayer){var a=$.extend({},this._defaultOptions,c||{}),b={};b.graphicsLayerId=e.id;b.displayName=a.displayName?a.displayName:"";b.aliases=a.aliases;b.autoEditable=a.autoEditable;b.canEdit=a.canEdit;b.canDelete=a.canDelete;b.canChangeStyles=a.canChangeStyles;this._clickableGraphicLayers.containsKey(e.id)&&this.app.trace.debug("Graphic layer with id '"+e.id+"' was already registered. ClickableLayerInfo will be overridden.");this._clickableGraphicLayers.set(e.id,
b)}};f.prototype.unregister=function(e){if(this._clickableGraphicLayers.containsKey(e.id)){var c=this._clickableGraphicLayers.get(e.id);this._disposeLayerInfoObject(c);this._clickableGraphicLayers.remove(e.id)}else this.app.trace.debug("Graphic layer with id '"+e.id+"' was not found.")};f.prototype.getLayerInfo=function(e){if(this._clickableGraphicLayers.containsKey(e.id))return e=this._clickableGraphicLayers.get(e.id),$.extend({},e);this.app.trace.debug("Graphic layer with id '"+e.id+"' is not registered.");
return null};f.prototype.getLayerInfos=function(){var e=this,c=this.app.map.graphicsLayerIds.slice(0);c.reverse();return c.map(function(a){return e._clickableGraphicLayers.get(a)}).filter(function(a){return null!=a}).map(function(a){return $.extend({},a)})};f.prototype.clear=function(){this._clickableGraphicLayers.clear()};f.prototype.isLayerRegistered=function(e){return this._clickableGraphicLayers.containsKey(e.id)?!0:!1};f.prototype._disposeLayerInfoObject=function(e){e.canEdit=null;e.canDelete=
null;e.canChangeStyles=null};f.prototype._handleLayerRemoved=function(e){e instanceof esri.layers.GraphicsLayer&&this.isLayerRegistered(e)&&this.unregister(e)};return f}();f.ClickableGraphicsRegistry=h});
define("infrastructure/LayerIntegrationUtils","require exports geocortex/essentials/FeatureLayerService geocortex/framework/utils/utils geocortex/essentials/MapServiceConstants geocortex/essentials/Layer geocortex/essentials/LayerType geocortex/essentials/KmlService infrastructure/GeometryUtils".split(" "),function(h,f,k,l,e,c,a,b,d){f.discoverFeatureServices=function(a){return new Promise(function(b,d){esri.request({url:a,content:{f:"json"},handleAs:"json"}).then(function(c){if("layers"in c){var g=
[],e=0;for(c=c.layers;e<c.length;e++){var m=c[e];m.subLayerIds||g.push(a+"/"+m.id)}b(g)}else"fields"in c?b([a]):d(Error("Unknown response type from url ("+a+")."))},d)})};f.buildFeatureLayerService=function(b){var d=new k.FeatureLayerService;d._createFrom({id:l.alphaNumericToken(),displayName:l.alphaNumericToken(),serviceType:e.MapServiceType.FEATURE,serviceFunction:e.MapServiceFunction.OPERATIONAL,connectionString:b});d.serviceUrl=b;d.outFields="*";d.isUserCreated=!0;d.userLayerType=e.UserLayerType.UPLOAD;
d._createServiceLayer();return new Promise(function(b,g){d.serviceLayer.on("load",function(g){d.displayName=d.serviceLayer.name;g=new c.Layer;g._createFrom(d.serviceLayer);g.id=d.serviceLayer.layerId.toString();g.type=a.LayerType.FEATURE_LAYER;g.userLayerType=e.UserLayerType.UPLOAD;g.isUserCreated=!0;var m=d.serviceLayer;"esriGeometryPoint"===m.geometryType&&(g.featureType="Point");"esriGeometryPolyline"===m.geometryType&&(g.featureType="Line");"esriGeometryPolygon"===m.geometryType&&(g.featureType=
"Polygon");g.mapService=d;d.layers.push(g);b(d)})})};f.buildKmlService=function(a,d){void 0===d&&(d={});var c=new b.KmlService;d=$.extend({id:l.alphaNumericToken(),serviceType:e.MapServiceType.KML,serviceFunction:e.MapServiceFunction.OPERATIONAL,serviceUrl:a,drawingBehavior:e.DrawingBehavior.KML_SERVICE,connectionString:a},d);c._createFrom(d);c.isUserCreated=!0;c.userLayerType=e.UserLayerType.UPLOAD;c._createServiceLayer();return new Promise(function(a,b){c.serviceLayer.on("load",function(b){a(c)})})};
f.buildLocalFeatureLayerService=function(b,d){void 0===d&&(d={});var c=new m;d=$.extend({id:l.alphaNumericToken()+":Local",displayName:b.layerDefinition.name,serviceType:e.MapServiceType.FEATURE,serviceFunction:e.MapServiceFunction.OPERATIONAL,connectionString:c.url},d);c._createFrom(d);c.isUserCreated=!0;c.userLayerType=e.UserLayerType.UPLOAD;var f=c.serviceLayer=new g(dojo.clone(b));f.id=c.id;f.layerId=0;f.name=b.layerDefinition.name;f.graphics.length&&(f.fullExtent=esri.graphicsExtent(f.graphics));
f.setEditable(!1);var k=new q;k._createFrom(f);k.id=f.layerId.toString();k.primaryKeyField=k.getFieldByName(f.objectIdField);k.mapService=c;k.type=a.LayerType.FEATURE_LAYER;k.userLayerType=e.UserLayerType.UPLOAD;k.isUserCreated=!0;b.layerDefinition&&b.layerDefinition.geometryType&&(f=b.layerDefinition.geometryType.toLowerCase(),-1<f.indexOf("point")?k.featureType="Point":-1<f.indexOf("line")?k.featureType="Line":-1<f.indexOf("polygon")&&(k.featureType="Polygon"));k.queryable=!1;k.supportsQuery=!1;
k.supportsIdentify=!0;k.identifiable=!0;k.searchable=!0;k.showMapTips=!0;k.snappable=!0;k.snappingEnabled=!0;c.layers.push(k);return Promise.resolve(c)};var g=function(a){function b(d){return a.call(this,d,{mode:esri.layers.FeatureLayer.MODE_SNAPSHOT})||this}__extends(b,a);b.prototype.queryFeatures=function(b,c,g){var e=new esri.tasks.Query;b.hasOwnProperty("geometry")&&(e.geometry="extent"!==b.geometry.type?b.geometry.getExtent():b.geometry);for(var m=0,f=["num","objectIds","returnGeometry","spatialRelationship"];m<
f.length;m++){var q=f[m];e[q]=b[q]}return a.prototype.queryFeatures.call(this,e,c,g).then(function(a){return Promise.all(a.features.map(function(a){return d.intersects(b.geometry,a.geometry)})).then(function(b){return a.features.filter(function(a,d){return!!b[d]})}).then(function(b){a.features=b;return a})})};return b}(esri.layers.FeatureLayer);f.LocalFeatureLayer=g;var m=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}__extends(b,a);return b}(k.FeatureLayerService);f.LocalFeatureLayerService=
m;var q=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}__extends(b,a);return b}(c.Layer);f.LocalLayer=q});define("infrastructure/webMap/BaseMapLayer",["require","exports"],function(h,f){var k=f.BaseMapType||(f.BaseMapType={});k.OPEN_STREET_MAP="OpenStreetMap";k.BING_AERIAL="BingMapsAerial";k.BING_ROAD="BingMapsRoad";k.BING_HYBRID="BingMapsHybrid";k.WEB_TILED="WebTiledLayer"});
define("infrastructure/webMap/WebMapConverter","require exports infrastructure/webMap/Symbol geocortex/essentials/MapService geocortex/essentials/Layer infrastructure/FeatureSet infrastructure/Feature infrastructure/webMap/Geometry infrastructure/webMap/Renderer geocortex/framework/utils/ArrayUtils infrastructure/webMap/OperationalLayer infrastructure/LayerIntegrationUtils geocortex/framework/utils/utils geocortex/essentials/Field geocortex/essentials/LayerType infrastructure/PromiseUtils geocortex/essentials/MapServiceConstants infrastructure/webMap/BaseMapLayer".split(" "),function(h,
f,k,l,e,c,a,b,d,g,m,q,n,p,s,r,t,u){var v=function(){return function(){}}();f.CONVERSION_TYPE_PROPERTY="__conversionType";var y={type:k.SymbolType.SIMPLE_MARKER,style:k.SimpleMarkerStyle.CIRCLE,size:0,color:[0,0,0,0]},x;(function(a){a.FeatureLayer="ArcGISFeatureLayer";a.MapService="ArcGISMapServiceLayer";a.TiledMapService="ArcGISTiledMapServiceLayer";a.ImageService="ArcGISImageServiceLayer";a.BingAerial="BingMapsAerial";a.BingHybrid="BingMapsHybrid";a.BingRoad="BingMapsRoad";a.OpenStreetMap="OpenStreetMap";
a.WebTiled="WebTiledLayer";a.KML="KML";a.WMS="WMS"})(x=f.LayerType||(f.LayerType={}));var w;(function(a){a.WEB_MAP_SERVICE_LAYER="webMapServiceLayer";a.WEB_MAP_LAYER="webMapLayer";a.WEB_MAP_FEATURE_SET="webMapFeatureSet";a.WEB_MAP_FEATURE="webMapFeature";a.WEB_MAP_GEOMETRY="webMapGeometry";a.WEB_MAP_SYMBOL="webMapSymbol";a.WEB_MAP_RENDERER="webMapRenderer";a.WEB_MAP_SPATIAL_REFERENCE="webMapSpatialReference";a.WEB_MAP_COLOR="webMapColor";a.WEB_MAP_DATA="webMapData";a.GCX_MAP_SERVICE="gcxMapService";
a.GCX_LAYER="gcxLayer";a.GCX_FEATURE_SET="gcxFeatureSet";a.GCX_FEATURE="gcxFeature";a.ESRI_LAYER="esriLayer";a.ESRI_FEATURE_SET="esriFeatureSet";a.ESRI_GRAPHIC="esriGraphic";a.ESRI_GEOMETRY="esriGeometry";a.ESRI_SYMBOL="esriSymbol";a.ESRI_RENDERER="esriRenderer";a.ESRI_SPATIAL_REFERENCE="esriSpatialReference";a.ESRI_COLOR="esriColor";a.OBJECT="object"})(w=f.ConversionType||(f.ConversionType={}));h=function(){function h(a){this._resultCache={};this._nextSymbolId=1;this._nestingLevel=0;this._hasReferences=
!1;this._converting={};this.app=a}h.prototype.fromGcxMapService=function(a){return this._convert(a,w.WEB_MAP_SERVICE_LAYER,this._fromGcxMapService)};h.prototype.fromGcxLayer=function(a){return this._convert(a,w.WEB_MAP_LAYER,this._fromGcxlayer)};h.prototype.fromGcxFeatureSet=function(a){return this._convert(a,w.WEB_MAP_FEATURE_SET,this._fromGcxFeatureSet)};h.prototype.fromGcxFeature=function(a){return this._convert(a,w.WEB_MAP_FEATURE,this._fromGcxFeature)};h.prototype.fromEsriLayer=function(a){return this._convert(a,
w.WEB_MAP_SERVICE_LAYER,this._fromEsriLayer)};h.prototype.fromEsriFeatureSet=function(a){return this._convert(a,w.WEB_MAP_FEATURE_SET,this._fromEsriFeatureSet)};h.prototype.fromEsriGraphic=function(a){return this._convert(a,w.WEB_MAP_FEATURE,this._fromEsriGraphic)};h.prototype.fromEsriGeometry=function(a){return this._convert(a,w.WEB_MAP_GEOMETRY,this._fromEsriGeometry)};h.prototype.fromEsriSymbol=function(a){return this._convert(a,w.WEB_MAP_SYMBOL,this._fromEsriSymbol)};h.prototype.fromEsriRenderer=
function(a){return this._convert(a,w.WEB_MAP_RENDERER,this._fromEsriRenderer)};h.prototype.fromEsriSpatialReference=function(a){return this._convert(a,w.WEB_MAP_SPATIAL_REFERENCE,this._fromEsriSpatialReference)};h.prototype.fromEsriColor=function(a){return this._convert(a,w.WEB_MAP_COLOR,this._fromEsriColor)};h.prototype.fromObject=function(a){return this._convert(a,w.WEB_MAP_DATA,this._fromObject)};h.prototype.toGcxMapService=function(a){return Promise.resolve(this._convert(a,w.GCX_MAP_SERVICE,this._toGcxMapService))};
h.prototype.toGcxLayer=function(a,b){return Promise.resolve(this._convert(a,w.GCX_LAYER,this._toGcxLayer,[b]))};h.prototype.toGcxFeatureSet=function(a){return Promise.resolve(this._convert(a,w.GCX_FEATURE_SET,this._toGcxFeatureSet))};h.prototype.toGcxFeature=function(a){return Promise.resolve(this._convert(a,w.GCX_FEATURE,this._toGcxFeature))};h.prototype.toEsriLayer=function(a){return Promise.resolve(this._convert(a,w.ESRI_LAYER,this._toEsriLayer))};h.prototype.toEsriFeatureSet=function(a){return Promise.resolve(this._convert(a,
w.ESRI_FEATURE_SET,this._toEsriFeatureSet))};h.prototype.toEsriGraphic=function(a){return Promise.resolve(this._convert(a,w.ESRI_GRAPHIC,this._toEsriGraphic))};h.prototype.toEsriGeometry=function(a){return this._convert(a,w.ESRI_GEOMETRY,this._toEsriGeometry)};h.prototype.toEsriSymbol=function(a){return this._convert(a,w.ESRI_SYMBOL,this._toEsriSymbol)};h.prototype.toEsriRenderer=function(a){return this._convert(a,w.ESRI_RENDERER,this._toEsriRenderer)};h.prototype.toEsriSpatialReference=function(a){return this._convert(a,
w.ESRI_SPATIAL_REFERENCE,this._toEsriSpatialReference)};h.prototype.toEsriColor=function(a){return this._convert(a,w.ESRI_COLOR,this._toEsriColor)};h.prototype.toObject=function(a){return Promise.resolve(this._convert(a,w.OBJECT,this._toObject))};h.prototype.clearCache=function(){this._resultCache={}};h.prototype._convert=function(a,b,d,c){void 0===c&&(c=[]);if(null===a||void 0===a||"string"===typeof a||"number"===typeof a||"boolean"===typeof a||a instanceof Date)return a;var g=this._resultCache[b];
g||(g=this._resultCache[b]=new WeakMap);var e=this._converting[b];e||(e=this._converting[b]=new WeakMap);if(g.has(a))return g.get(a);if(e.has(a)){var m=new v;g.set(a,m);this._hasReferences=!0;return m}b=void 0;0===this._nestingLevel&&(this._hasReferences=!1);this._nestingLevel++;e.set(a,!0);try{b=d.apply(this,[a].concat(c));if(m=g.get(a))m.result=b;g.set(a,b)}catch(f){throw g["delete"](a),f;}finally{this._nestingLevel--,e["delete"](a)}0===this._nestingLevel&&this._hasReferences&&this._resolveReferences(b);
return b};h.prototype._resolveReferences=function(a){if(a){var b=new WeakMap,d=function(a){if(!(a instanceof l.MapService||a instanceof e.Layer)){b.set(a,!0);for(var c in a){var g=a[c];"object"===typeof g&&(g instanceof v?a[c]=g.result:g&&!b.has(g)&&d(g))}}};d(a)}};h.prototype._getWebMapLayerDefinitionFromFeatureLayer=function(a){var b={};b.definitionExpression=a.getDefinitionExpression();b.drawingInfo={renderer:this.fromEsriRenderer(a.renderer)};return b};h.prototype._getWebMapLayerDefinitionFromDynamicLayer=
function(a,b){var d={},c=!1;a.layerDefinitions&&a.layerDefinitions[b]&&(c=!0,d.definitionExpression=a.layerDefinitions[b]);if(a.dynamicLayerInfos){var e=g.firstOrDefault(a.dynamicLayerInfos,function(a){return a.id===b});e&&(c=!0,d.minScale=e.minScale,d.maxScale=e.maxScale,d.source=e.source.toJson())}a.layerDrawingOptions&&a.layerDrawingOptions[b]&&(c=!0,d.drawingInfo={renderer:this.fromEsriRenderer(a.layerDrawingOptions[b].renderer),fixedSymbols:!a.layerDrawingOptions[b].scaleSymbols});return c?d:
null};h.prototype._applyWebMapServiceLayerToMapService=function(a,b){var d=this;return Promise["try"](function(){b.setOpacity(a.opacity);b.setVisibility(a.visibility);var c=b.serviceLayer;c instanceof esri.layers.FeatureLayer&&(b.layers[0].setVisibility(a.visibility),a.layerDefinition&&a.layerDefinition.definitionExpression&&c.setDefinitionExpression(a.layerDefinition.definitionExpression));if(d._isFeatureCollection(a)&&a.featureCollection.layers[0].layerDefinition)return d._applyDrawingInfo(a.featureCollection.layers[0].layerDefinition.drawingInfo,
b);if(a.layerDefinition)return d._applyDrawingInfo(a.layerDefinition.drawingInfo,b)})};h.prototype._applyWebMapLayersToGcxLayers=function(a,b){var d=this,c=[];(a.layers||[]).forEach(function(a,g){var e=d._findOrCreateMatchingGcxLayer(a,b).then(function(b){return b?d._applyWebMapLayerToGcxLayer(a,g,b):!1});c.push(e)});return Promise.all(c).then(function(a){return a.some(function(a){return a})})};h.prototype._applyWebMapLayerToGcxLayer=function(a,b,d){var c=this,e=d.mapService.serviceLayer;return a.layerDefinition&&
e instanceof esri.layers.ArcGISDynamicMapServiceLayer?this.app.waitUntilServiceLayerLoaded(e).then(function(){var b=parseInt(d.id),m=!1;a.layerDefinition.definitionExpression&&(m=(e.layerDefinitions||[]).slice(),m[b]=a.layerDefinition.definitionExpression,e.setLayerDefinitions(m,!0),m=!0);if(a.layerDefinition.drawingInfo){d.mapService.convertToDynamicLayers();m=(e.layerDrawingOptions||[]).slice();m[b]=new esri.layers.LayerDrawingOptions;m[b].renderer=c.toEsriRenderer(a.layerDefinition.drawingInfo.renderer);
m[b].scaleSymbols=!a.layerDefinition.drawingInfo.fixedSymbols;a.layerDefinition.drawingInfo.hasOwnProperty("showLabels")&&(m[b].showLabels=a.layerDefinition.drawingInfo.showLabels);if(a.layerDefinition.drawingInfo.hasOwnProperty("labelingInfo")&&a.layerDefinition.drawingInfo.labelingInfo){var f=a.layerDefinition.drawingInfo.labelingInfo;m[b].labelingInfo=m[b].labelingInfo||[];m[b].labelingInfo.length?m[b].labelingInfo[0]=new esri.layers.LabelClass(f[0]):m[b].labelingInfo.push(new esri.layers.LabelClass(f[0]));
var n=f[0],f=n.symbol.color,n=n.symbol.haloColor;f&&m[b].labelingInfo[0].symbol.setColor(new esri.Color([f.r,f.g,f.b,f.a]));n&&m[b].labelingInfo[0].symbol.setHaloColor(new esri.Color([n.r,n.g,n.b,n.a]));f=m[b].labelingInfo[0].symbol;m[b].labelingInfo[0].symbol.font.setSize(0.75*f.font.size);m[b].labelingInfo[0].symbol.setHaloSize(0.75*f.haloSize)}e.setLayerDrawingOptions(m,!0);m=!0}e.dynamicLayerInfos&&(f=g.firstOrDefault(e.dynamicLayerInfos,function(a){return a.id===b}))&&(f.minScale=a.layerDefinition.minScale,
f.maxScale=a.layerDefinition.maxScale,e.setDynamicLayerInfos(e.dynamicLayerInfos,!0),m=!0);return m}):Promise.resolve(!1)};h.prototype._applyDrawingInfo=function(a,b){var c=this;if(!a)return Promise.resolve();var g=b.serviceLayer;return this.app.waitUntilServiceLayerLoaded(g).then(function(){!b.heatMap||!b.heatMap.userCanToggle||b.isUserCreated&&b.heatMap.enabled||c.app.command("RemoveHeatMap").execute({gcxLayer:b.layers[0]});if(a.renderer)if(b.heatMap&&b.heatMap.userCanToggle&&a.renderer.type===
d.RendererType.HEATMAP){var e=a.renderer;if(e){var m=b.heatMap;m.intensity=e.blurRadius;m.field=e.field;m.gradient=[];m.offset=[];(e.colorStops||[]).forEach(function(a,b){m.gradient[b]=a.color;m.offset[b]=a.ratio});c.app.command("AddHeatMap").execute({gcxLayer:b.layers[0]})}}else g instanceof esri.layers.GraphicsLayer&&c._setGraphicsLayerRenderer(g,c.toEsriRenderer(a.renderer))})};h.prototype._setGraphicsLayerRenderer=function(a,b){a.setRenderer(b);a.redraw()};h.prototype._findMatchingGcxMapService=
function(a){var b=this.app.site.essentialsMap.findMapServiceById(a.id);return b=b||g.firstOrDefault(this.app.site.essentialsMap.mapServices,function(b){return b.serviceUrl===a.url})};h.prototype._findMatchingGcxLayer=function(a,b){var d="object"===typeof a?a:null,c=null;d&&(c=b.findLayerOrTableByName(d.name));var e=d?d.id.toString():a.toString(),c=(c=c||b.findLayerOrTableById(e))||g.firstOrDefault(b.layers,function(a){return a.wmsLayerName===e}),m=void 0;!c&&d&&d.layerDefinition&&d.layerDefinition.source&&
"mapLayer"===d.layerDefinition.source.type&&(m=d.layerDefinition.source.mapLayerId);c||null===m||void 0===m||(c=b.findLayerById(m.toString()));c||b.layers.forEach(function(a){if(a.dynamicDefinition){var b=JSON.parse(a.dynamicDefinition);!b||!b.source||"mapLayerId"!==b.source.type||!b.source.mapLayerId&&0!==b.source.mapLayerId||b.source.mapLayerId.toString()!==e&&b.source.mapLayerId.toString()!==m||(c=a)}});return c};h.prototype._findOrCreateMatchingGcxLayer=function(a,b){var d=this._findMatchingGcxLayer(a,
b);return!d&&this._canCreateGcxLayer(a,b)?this._createGcxLayer(a,b):Promise.resolve(d)};h.prototype._findOrCreateMatchingGcxMapService=function(a){var b=this._findMatchingGcxMapService(a);return!b&&this._canCreateGcxMapService(a)?this._createGcxMapService(a):Promise.resolve(b)};h.prototype._canCreateGcxLayer=function(a,b){return b.serviceLayer instanceof esri.layers.ArcGISDynamicMapServiceLayer};h.prototype._createGcxLayer=function(a,b){if(!this._canCreateGcxLayer(a,b))return Promise.reject(Error("WebMapConverter._createGcxLayer: Unsupported layer type."));
var d={source:{type:"mapLayerId",mapLayerId:a.id}};a.layerDefinition&&a.layerDefinition.drawingInfo&&(d.drawingInfo=a.layerDefinition.drawingInfo);var d={id:a.id.toString(),name:a.name,displayName:a.title||a.name,isDynamic:!0,dynamicDefinition:JSON.stringify(d)},c=new e.Layer(b.url+"/layers/"+a.id.toString());c.createFromDefinition(d);b.add(c);return Promise.resolve(c)};h.prototype._canCreateGcxMapService=function(a){return this._isFeatureCollection(a)||this._isKmlLayer(a)||this._isLayerCatalogService(a)};
h.prototype._createGcxMapService=function(a){var b=this,d=this._getMapServiceDefinition(a);if(this._isLayerCatalogService(a)){var c=a.gcxMapServiceDefinition.catalogId,g=a.layers.map(function(a){return a.gcxLayerDefinition.catalogId});return new Promise(function(d,e){var m={mapServiceId:a.id,layerLookupIds:g,lookupId:c,callback:function(a){a&&d(a);e(Error("WebMapConverter._createGcxMapService: Unsupported layer catalog id."))},serviceLayer:a};b.app.waitUntilAllLibrariesLoaded().then(function(){b.app.command("LayerCatalogRestoreMapService").execute(m)})})}if(this._isFeatureCollection(a)){var e=
a.featureCollection.layers[0],m=e.featureSet||{},f=m.features||[];m.features=[];d={mapService:q.buildLocalFeatureLayerService(e,d),graphics:Promise.map(f,function(a){return b.toEsriGraphic(a)})};return Promise.props(d).then(function(a){var d=a.mapService,c=b._toEsriRenderer(e.layerDefinition.drawingInfo.renderer);d.serviceLayer.setRenderer(c);a.graphics.forEach(function(a){d.serviceLayer.add(a)});a.graphics.length&&(d.serviceLayer.fullExtent=esri.graphicsExtent(a.graphics));b.app.site.essentialsMap.addMapService(d);
return d})}return this._isKmlLayer(a)?q.buildKmlService(a.url,d).then(function(a){b.app.site.essentialsMap.addMapService(a);return a}):Promise.reject(Error("WebMapConverter._createGcxMapService: Unsupported service layer type."))};h.prototype._getMapServiceDefinition=function(a){return{id:a.id,displayName:a.title}};h.prototype._isFeatureCollection=function(a){return a.featureCollection&&a.featureCollection.layers&&1===a.featureCollection.layers.length&&!!a.featureCollection.layers[0].featureSet};
h.prototype._isKmlLayer=function(a){return a.type===m.OperationalLayerType.KML};h.prototype._isGraphicsLayer=function(a){return a.id&&a.id.startsWith("graphics-layer-")};h.prototype._isLayerCatalogService=function(a){return a.gcxMapServiceDefinition&&a.gcxMapServiceDefinition.catalogId};h.prototype._addSourceType=function(a,b){b[f.CONVERSION_TYPE_PROPERTY]=a;return b};h.prototype._getWebMapLayerType=function(a){if(a instanceof esri.layers.FeatureLayer)return x.FeatureLayer;if(a instanceof esri.layers.ArcGISDynamicMapServiceLayer)return x.MapService;
if(a instanceof esri.layers.ArcGISTiledMapServiceLayer)return x.TiledMapService;if(a instanceof esri.layers.ArcGISImageServiceLayer)return x.ImageService;if(a instanceof esri.virtualearth.VETiledLayer)switch(a.mapStyle.toLowerCase()){case esri.virtualearth.VETiledLayer.MAP_STYLE_AERIAL.toLowerCase():return x.BingAerial;case esri.virtualearth.VETiledLayer.MAP_STYLE_AERIAL_WITH_LABELS.toLowerCase():return x.BingHybrid;case esri.virtualearth.VETiledLayer.MAP_STYLE_ROAD.toLowerCase():return x.BingRoad}else{if(a instanceof
esri.layers.WebTiledLayer)return a.url&&0<=a.url.indexOf("tile.openstreetmap.org")?x.OpenStreetMap:x.WebTiled;if(a instanceof esri.layers.KMLLayer)return x.KML;if(a instanceof esri.layers.WMSLayer)return x.WMS;if(a instanceof esri.layers.WMTSLayer)return x.WebTiled}};h.prototype._inferAttributeType=function(a,b){var d=g.firstOrDefault(a,function(a){return a.attributes&&!n.isNullOrUndefined(a.attributes[b])});if(!d)return p.EsriFieldTypes.esriFieldTypeString;d=d.attributes[b];return"number"===typeof d?
p.EsriFieldTypes.esriFieldTypeDouble:d instanceof Date?p.EsriFieldTypes.esriFieldTypeDate:p.EsriFieldTypes.esriFieldTypeString};h.prototype._setVisibleLayers=function(a,b){var d=this;if(!b.supportsLayerVisibility())return!1;var c=!1,e=[],m=a.layers||[];(a.visibleLayers||[]).forEach(function(a){var c=void 0;if(m){var f=g.firstOrDefault(m,function(b){return b.id===a});(f=f||g.firstOrDefault(m,function(b){return b.name===a}))&&(c=d._findMatchingGcxLayer(f,b))}c||(c=d._findMatchingGcxLayer(a,b));c&&e.push(c)});
b.layers.forEach(function(a){if(a.type!==s.LayerType.GROUP_LAYER){var b=0<=e.indexOf(a);c=c||b!==a.isVisible();a.setVisibility(b,!0)}});return c};h.prototype._toGcxMapService=function(a){var b=this,d=void 0;return Promise.all([this.app.waitUntilSiteInitialized(),this.app.waitUntilMapLoaded()]).then(function(){return b._findOrCreateMatchingGcxMapService(a)}).then(function(c){d=c;if(!d)throw Error('No matching Essentials map service was found for service "{0}".'.format(a.id));return b._applyWebMapServiceLayerToMapService(a,
d)}).then(function(){return b._applyWebMapLayersToGcxLayers(a,d)}).then(function(c){(c=b._setVisibleLayers(a,d)||c)&&d.refresh();return d})};h.prototype._toGcxLayer=function(a,b){var d=this;if(!b)throw Error('WebMapConverter.toGcxLayer: Parameter "serviceLayer" is required.');return this.toGcxMapService(b).then(function(c){c=d._findMatchingGcxLayer(a,c);if(!c)throw Error('No matching Essentials layer was found for layer "{0}" for service "{1}".'.format(a.id,b.id));return c})};h.prototype._toGcxFeatureSet=
function(a){var b=this;return this.toEsriFeatureSet(a).then(function(a){return new c.FeatureSet({app:b.app,esriFeatureSet:a})})};h.prototype._toEsriLayer=function(a){if(this._isGraphicsLayer(a))return this._toEsriGraphicsLayer(a);if(a.layerType===x.FeatureLayer)return this._toEsriFeatureLayer(a);throw Error("WebMapConverter.toEsriLayer: Unsupported layer type.");};h.prototype._toEsriGraphicsLayer=function(a){var b=this,d=a.id.slice(15),c=this.app.map.getLayer(d);return!c||c instanceof esri.layers.GraphicsLayer?
Promise.all([this.app.waitUntilSiteInitialized(),this.app.waitUntilMapLoaded()]).then(function(){var g=c;g||(g=new esri.layers.GraphicsLayer({id:d}),b.app.map.addLayer(g));g.setVisibility(a.visibility);g.setOpacity(a.opacity);g.clear();var e=[];((a.featureCollection||{}).layers||[]).forEach(function(a){((a.featureSet||{}).features||[]).forEach(function(a){a.attributes&&(e[a.attributes.__id]=b.toEsriGraphic(a))});!g.renderer&&a.layerDefinition&&a.layerDefinition.drawingInfo&&a.layerDefinition.drawingInfo.renderer&&
(a=a.layerDefinition.drawingInfo.renderer,a.uniqueValueInfos&&a.uniqueValueInfos[0]&&JSON.stringify(a.uniqueValueInfos[0].symbol)===JSON.stringify(y)||g.setRenderer(b.toEsriRenderer(a)))});return Promise.all(e).then(function(a){a.forEach(function(a){a&&g.add(a)});return g})}):Promise.resolve(c)};h.prototype._toEsriFeatureLayer=function(a){var b=this;if(a.url){var d=new esri.layers.FeatureLayer(a.url);d.setVisibility(a.visibility);d.setOpacity(a.opacity);return this.app.waitUntilServiceLayerLoaded(d)["return"](d)}if(this._isFeatureCollection(a)){var c=
new esri.layers.FeatureLayer(a.featureCollection.layers[0]);c.setVisibility(a.visibility);c.setOpacity(a.opacity);c.clear();return Promise.map((a.featureCollection.layers[0].featureSet||{}).features||[],function(a){return b.toEsriGraphic(a).then(function(a){return c.add(a)})})["return"](c)}throw Error("WebMapConverter.toEsriLayer: Unsupported layer type.");};h.prototype._toEsriFeatureSet=function(a){var b=this;return r.PromiseUtils.mapSkipRejected(a.features||[],function(a){return b.toEsriGraphic(a)}).then(function(a){var b=
new esri.tasks.FeatureSet;b.features=a;return b})};h.prototype._toGcxFeature=function(b){return this.toEsriGraphic(b).then(function(b){return new a.Feature({graphic:b})})};h.prototype._toEsriGraphic=function(a){var b=this;return this.toObject(a.attributes).then(function(d){var c=b.toEsriGeometry(a.geometry),g,e=!0;d&&(g=d.__symbol,delete d.__symbol,d.hasOwnProperty("__visible")&&(e=d.__visible,delete d.__visible),delete d.__id);d=new esri.Graphic(c,g,d,null);d.visible=e;return d})};h.prototype._toEsriGeometry=
function(a){if(a.hasOwnProperty("x")&&a.hasOwnProperty("y"))return new esri.geometry.Point(a);if(a.hasOwnProperty("points"))return new esri.geometry.Multipoint(a);if(a.hasOwnProperty("paths"))return new esri.geometry.Polyline(a);if(a.hasOwnProperty("rings"))return new esri.geometry.Polygon(a);if(a.hasOwnProperty("xmin")&&a.hasOwnProperty("xmax")&&a.hasOwnProperty("ymin")&&a.hasOwnProperty("ymax"))return new esri.geometry.Extent(a);throw Error("WebMapConverter.toEsriGeometry: Unrecognized type of geometry object.");
};h.prototype._toEsriSymbol=function(a){switch(a.type){case k.SymbolType.SIMPLE_MARKER:var b=new esri.symbol.SimpleMarkerSymbol(a);a.size!==b.size&&(b.size=a.size);return b;case k.SymbolType.SIMPLE_LINE:return new esri.symbol.SimpleLineSymbol(a);case k.SymbolType.SIMPLE_FILL:return new esri.symbol.SimpleFillSymbol(a);case k.SymbolType.PICTURE_MARKER:return new esri.symbol.PictureMarkerSymbol(a);case k.SymbolType.PICTURE_FILL:return new esri.symbol.PictureFillSymbol(a);case k.SymbolType.TEXT:return new esri.symbol.TextSymbol(a);
default:throw Error('WebMapConverter.toEsriSymbol: Unsupported symbol type "{0}".'.format(a.type));}};h.prototype._toEsriRenderer=function(a){var b=this;switch(a.type){case d.RendererType.SIMPLE:var c=new esri.renderer.SimpleRenderer(dojo.clone(a));c.symbol=this.toEsriSymbol(a.symbol);return c;case d.RendererType.UNIQUE_VALUE:return c=new esri.renderer.UniqueValueRenderer(dojo.clone(a)),c.defaultSymbol=this.toEsriSymbol(a.defaultSymbol),c.infos.forEach(function(d,c){d.symbol=b.toEsriSymbol(a.uniqueValueInfos[c].symbol)}),
c;case d.RendererType.CLASS_BREAKS:return c=new esri.renderer.ClassBreaksRenderer(dojo.clone(a)),c.defaultSymbol=this.toEsriSymbol(a.defaultSymbol),c.infos.forEach(function(d,c){d.symbol=b.toEsriSymbol(a.classBreakInfos[c].symbol)}),c;case d.RendererType.HEATMAP:c=new esri.renderer.HeatmapRenderer(dojo.clone(a));if(a.colorStops){var g=[];a.colorStops.forEach(function(a,d){var c=dojo.clone(a);c.color=b.toEsriColor(c.color);g.push(c)})}c.setColorStops(g);return c;default:throw Error('WebMapConverter.toEsriRenderer: Unsupported renderer type "{0}".'.format(a.type));
}};h.prototype._toEsriSpatialReference=function(a){return new esri.SpatialReference(a)};h.prototype._toEsriColor=function(a){a.constructor===Array&&4===a.length&&(a[3]/=255);return new esri.Color(a)};h.prototype._toObject=function(a){var b=this;if("string"===typeof a||"number"===typeof a||"boolean"===typeof a||a instanceof Date||null===a||void 0===a)return Promise.resolve(a);if(a.hasOwnProperty(f.CONVERSION_TYPE_PROPERTY))switch(a[f.CONVERSION_TYPE_PROPERTY]){case w.GCX_MAP_SERVICE:return this.toGcxMapService(a);
case w.GCX_LAYER:return this.toGcxLayer(a,null);case w.GCX_FEATURE_SET:return this.toGcxFeatureSet(a);case w.GCX_FEATURE:return this.toGcxFeature(a);case w.ESRI_LAYER:return this.toEsriLayer(a);case w.ESRI_FEATURE_SET:return this.toEsriFeatureSet(a);case w.ESRI_GRAPHIC:return this.toEsriGraphic(a);case w.ESRI_GEOMETRY:return Promise.resolve(this.toEsriGeometry(a));case w.ESRI_SYMBOL:return Promise.resolve(this.toEsriSymbol(a));case w.ESRI_RENDERER:return Promise.resolve(this.toEsriRenderer(a));case w.ESRI_SPATIAL_REFERENCE:return Promise.resolve(this.toEsriSpatialReference(a))}var d=
{},c=[];Object.keys(a).forEach(function(g){c.push(b.toObject(a[g]).then(function(a){d[g]=a}))});return Promise.all(c)["return"](d)};h.prototype._fromGcxMapService=function(a){var b=this,d=a.serviceLayer,c={id:a.id,url:a.serviceUrl,opacity:a.opacity,visibility:a.isVisible(),layerType:this._getWebMapLayerType(d)};if(a.mapServiceFunction===t.MapServiceFunction.OPERATIONAL){c.title=a.displayName;c.minScale=Infinity===a.minScale?0:a.minScale;c.maxScale=a.maxScale;if(d instanceof esri.layers.ArcGISDynamicMapServiceLayer){c.capabilities=
d.capabilities;c.visibleLayers=d.visibleLayers.map(function(a){return parseInt(a)});var g=a.layers;d.dynamicLayerInfos&&(g=[],d.dynamicLayerInfos.forEach(function(b,d){var c=a.findLayerById(b.id.toString());c&&g.push(c)}));c.layers=g.map(function(a){return b.fromGcxLayer(a)})}else d instanceof esri.layers.WMSLayer?(c.visibleLayers=d.visibleLayers,c.type=m.OperationalLayerType.WMS):d instanceof esri.layers.KMLLayer?c.type=m.OperationalLayerType.KML:d instanceof esri.layers.FeatureLayer&&(c.layerDefinition=
this._getWebMapLayerDefinitionFromFeatureLayer(d),c.capabilities=d.capabilities,a.isUserCreated&&d.graphics&&d.graphics.length&&(c.featureCollection=this._esriFeatureLayerToFeatureCollection(d),c.featureCollection.showLegend=a.layers[0].includeInLegend));d instanceof esri.layers.GraphicsLayer&&d.renderer instanceof esri.renderer.HeatmapRenderer&&!c.featureCollection&&(c.layerDefinition=c.layerDefinition||{},c.layerDefinition.drawingInfo={renderer:this.fromEsriRenderer(d.renderer)})}else if(d instanceof
esri.virtualearth.VETiledLayer)c.type=c.layerType,delete c.url;else if(d instanceof esri.layers.WebTiledLayer)c.type=c.layerType,c.templateUrl=d.url,delete c.url;else if(d instanceof esri.layers.WMTSLayer){c.type=u.BaseMapType.WEB_TILED;if(!a.tileRestUrl)throw Error('WebMapConverter.fromGcxMapService: WMTS layers are only supported if the "tileRestUrl" property is set.');a.tileRestUrl&&!d.resourceUrls&&(d.resourceUrls=[{template:a.tileRestUrl}]);c.templateUrl=d._getTileUrlTemplate();delete c.url}return c};
h.prototype._esriFeatureLayerToFeatureCollection=function(a){var b=a.toJson().layerDefinition||{};return{layers:[{featureSet:{geometryType:a.geometryType,features:a.graphics.map(this.fromEsriGraphic,this)},layerDefinition:{displayField:b.displayField,fields:b.fields,geometryType:b.geometryType,hasAttachments:b.hasAttachments,minScale:b.minScale,maxScale:b.maxScale,name:b.name,objectIdField:b.objectIdField,templates:b.templates,type:b.type,typeIdField:b.typeIdField,types:b.types,drawingInfo:{renderer:this.fromEsriRenderer(a.renderer)}}}],
showLegend:!0}};h.prototype._fromGcxlayer=function(a){var b={name:a.wmsLayerName,title:a.displayName,layerUrl:a.getLayerUrl(),legendUrl:a.legendUrl},d=parseInt(a.id);isNaN(d)||void 0===d||(b.id=d);a=a.mapService.serviceLayer;a instanceof esri.layers.ArcGISDynamicMapServiceLayer&&(d=this._getWebMapLayerDefinitionFromDynamicLayer(a,d))&&(b.layerDefinition=d);return b};h.prototype._fromGcxFeatureSet=function(a){var d,c=a.esriFeatureSet;c?(d=b.GeometryType.fromEsriGeometryType(c.geometryType),!d&&c.features&&
0<c.features.length&&c.features[0].geometry&&(d=b.GeometryType.fromEsriGeometryType(c.features[0].geometry.type))):a.features.length&&(c=a.features.getAt(0),c.hasGeometry.get()&&(d=b.GeometryType.fromEsriGeometryType(c.esriFeature.get().geometry.type)));return{features:a.features.get().map(this.fromGcxFeature,this),geometryType:d||b.GeometryType.POINT}};h.prototype._fromEsriLayer=function(a){if(a instanceof esri.layers.FeatureLayer)return this._fromEsriFeatureLayer(a);if(a instanceof esri.layers.GraphicsLayer)return this._fromEsriGraphicsLayer(a);
throw Error("WebMapConverter.fromEsriLayer: Unsupported layer type.");};h.prototype._fromEsriGraphicsLayer=function(a){var c=this,e={id:"graphics-layer-"+a.id,title:a.id,visibility:a.visible,opacity:a.opacity,minScale:a.minScale,maxScale:a.maxScale},m={};a.graphics.forEach(function(e,f){var n=e.geometry.type,q=m[n];q||(q={featureSet:{features:[],geometryType:b.GeometryType.fromEsriGeometryType(n)},layerDefinition:{geometryType:b.GeometryType.fromEsriGeometryType(n),objectIdField:"__id",name:c.app.getResource("Mapping.Infrastructure",
"language-webmap-layer-name-"+n),fields:[{name:"__id",alias:"OBJECTID",type:p.EsriFieldTypes.esriFieldTypeOID,editable:!1,nullable:!1},{name:"__visible",alias:c.app.getResource("Mapping.Infrastructure","language-webmap-field-name-visible"),type:p.EsriFieldTypes.esriFieldTypeInteger,editable:!0,nullable:!1}],drawingInfo:{renderer:a.renderer?c.fromEsriRenderer(a.renderer):{type:d.RendererType.UNIQUE_VALUE,field1:"__symbolId",uniqueValueInfos:[{value:0,symbol:y}]}}}},m[e.geometry.type]=q);n=c.fromEsriGraphic(e);
n.attributes=n.attributes||{};n.attributes.__id=f;Object.keys(n.attributes).forEach(function(b){if("__symbolId"!==b&&"__symbol"!==b){var d=function(a){return g.firstOrDefault(q.layerDefinition.fields,function(b){return b.name===a})}(b);d||(d=c._inferAttributeType(a.graphics,b),d={name:b,alias:b,type:d,nullable:!0,editable:!0},q.layerDefinition.fields.push(d))}});if(!a.renderer){var l=q.layerDefinition.drawingInfo.renderer,h=n.attributes.__symbolId;h&&!g.firstOrDefault(l.uniqueValueInfos,function(a){return a.value===
h})&&l.uniqueValueInfos.push({value:h,symbol:n.attributes.__symbol})}q.featureSet.features.push(n)});e.featureCollection={layers:[],showLegend:!1};for(var f=0,n=Object.keys(m);f<n.length;f++)e.featureCollection.layers.push(m[n[f]]);return e};h.prototype._fromEsriFeatureLayer=function(a){var b={id:a.id,title:a.id,visibility:a.visible,opacity:a.opacity,minScale:a.minScale,maxScale:a.maxScale,layerType:x.FeatureLayer};a.url?b.url=a.url:b.featureCollection=this._esriFeatureLayerToFeatureCollection(a);
return b};h.prototype._fromEsriFeatureSet=function(a){return{features:a.features.map(this.fromEsriGraphic,this),geometryType:b.GeometryType.fromEsriGeometryType(a.geometryType)}};h.prototype._fromGcxFeature=function(a){var b=this,d={};a.attributes.get().forEach(function(a){d[a.name.get()]=b.fromObject(a.value.get())});return{attributes:d,geometry:this.fromEsriGeometry(a.esriFeature.get().geometry)}};h.prototype._fromEsriGraphic=function(a){var b={attributes:this.fromObject(a.attributes)||{},geometry:this.fromEsriGeometry(a.geometry)};
b.attributes.__visible=a.visible?1:0;a.symbol&&(b.attributes.__symbol=this._addSourceType(w.ESRI_SYMBOL,this.fromEsriSymbol(a.symbol)),a.symbol.__symbolId||(a.symbol.__symbolId=this._nextSymbolId++),b.attributes.__symbolId=a.visible?a.symbol.__symbolId:0);return b};h.prototype._fromEsriGeometry=function(a){var b={spatialReference:this.fromEsriSpatialReference(a.spatialReference)};switch(a.type){case "point":b.x=a.x;b.y=a.y;break;case "multipoint":b.points=a.points;case "polyline":b.paths=a.paths;
break;case "polygon":b.rings=a.rings;break;case "extent":b.xmin=a.xmin,b.xmax=a.xmax,b.ymin=a.ymin,b.ymax=a.ymax}return b};h.prototype._fromEsriSymbol=function(a){var b=a.toJson();a.size!==b.size&&(b.size=a.size);return b};h.prototype._fromEsriRenderer=function(a){var b=this,d=a.toJson();a instanceof esri.renderer.SimpleRenderer?d.symbol=this.fromEsriSymbol(a.symbol):a instanceof esri.renderer.UniqueValueRenderer?(d.defaultSymbol=this.fromEsriSymbol(a.defaultSymbol),d.uniqueValueInfos.forEach(function(d,
c){d.symbol=b.fromEsriSymbol(a.infos[c].symbol)})):a instanceof esri.renderer.ClassBreaksRenderer&&(d.defaultSymbol=this.fromEsriSymbol(a.defaultSymbol),d.classBreakInfos.forEach(function(d,c){d.symbol=b.fromEsriSymbol(a.infos[c].symbol)}));return d};h.prototype._fromEsriSpatialReference=function(a){return a.toJson()};h.prototype._fromEsriColor=function(a){return a.toRgba()};h.prototype._fromObject=function(b){if(b instanceof l.MapService)return this._addSourceType(w.GCX_MAP_SERVICE,this.fromGcxMapService(b));
if(b instanceof e.Layer)return this._addSourceType(w.GCX_LAYER,this.fromGcxLayer(b));if(b instanceof c.FeatureSet)return this._addSourceType(w.GCX_FEATURE_SET,this.fromGcxFeatureSet(b));if(b instanceof a.Feature)return this._addSourceType(w.GCX_FEATURE,this.fromGcxFeature(b));if(b instanceof esri.layers.Layer)return this._addSourceType(w.ESRI_LAYER,this.fromEsriLayer(b));if(b instanceof esri.tasks.FeatureSet)return this._addSourceType(w.ESRI_FEATURE_SET,this.fromEsriFeatureSet(b));if(b instanceof
esri.Graphic)return this._addSourceType(w.ESRI_GRAPHIC,this.fromEsriGraphic(b));if(b instanceof esri.geometry.Geometry)return this._addSourceType(w.ESRI_GEOMETRY,this.fromEsriGeometry(b));if(b instanceof esri.symbol.Symbol)return this._addSourceType(w.ESRI_SYMBOL,this.fromEsriSymbol(b));if(b instanceof esri.renderer.Renderer)return this._addSourceType(w.ESRI_RENDERER,this.fromEsriRenderer(b));if(b instanceof esri.SpatialReference)return this._addSourceType(w.ESRI_SPATIAL_REFERENCE,this.fromEsriSpatialReference(b));
var d={},g;for(g in b)b.hasOwnProperty(g)&&"function"!==typeof b[g]&&"__symbolId"!==g&&(d[g]=this.fromObject(b[g]));return d};return h}();f.WebMapConverter=h});define("infrastructure/project/FeatureSetCollection",["require","exports"],function(h,f){});
define("infrastructure/project/ProjectConverter","require exports infrastructure/webMap/WebMapConverter geocortex/essentials/Layer infrastructure/FeatureSetCollection infrastructure/FeatureSet infrastructure/Feature infrastructure/LayerIntegrationUtils geocortex/essentials/LayerStyle infrastructure/PromiseUtils infrastructure/KmlFeature infrastructure/DateFormat infrastructure/NumberFormat geocortex/framework/utils/ArrayUtils infrastructure/TaskUtils infrastructure/coordinates/CoordinatesManager geocortex/framework/utils/utils infrastructure/webMap/BaseMapLayer infrastructure/ArrayUtils geocortex/essentials/utilities/ServiceDiscoveryUtilities infrastructure/webMap/WebMapConverter infrastructure/webMap/Renderer".split(" "),function(h,
f,k,l,e,c,a,b,d,g,m,q,n,p,s,r,t,u,v,y,x,w){f.PROPERTY_MEASUREMENT_ID="measurementId";f.PROPERTY_HIGHLIGHT_ID="__gcxHlId";h=function(h){function k(){var a=null!==h&&h.apply(this,arguments)||this;a._exclusionCache={};return a}__extends(k,h);k.prototype.exclude=function(a,b){var d=this._exclusionCache[b];d||(d=this._exclusionCache[b]=[]);d.push(a)};k.prototype.clearExclusionCache=function(){this._exclusionCache={}};k.prototype.clearCache=function(){h.prototype.clearCache.call(this);this.clearExclusionCache()};
k.prototype.fromGcxMapService=function(a){return h.prototype.fromGcxMapService.call(this,a)};k.prototype.fromGcxLayer=function(a){return h.prototype.fromGcxLayer.call(this,a)};k.prototype.fromGcxFeatureSetCollection=function(a){return this._convert(a,"projectFeatureSetCollection",this._fromGcxFeatureSetCollection)};k.prototype.fromGcxFeatureSet=function(a){return h.prototype.fromGcxFeatureSet.call(this,a)};k.prototype.fromEsriFeatureSet=function(a){return h.prototype.fromEsriFeatureSet.call(this,
a)};k.prototype.fromEsriLayer=function(a){return h.prototype.fromEsriLayer.call(this,a)};k.prototype.fromGcxFeature=function(a){return h.prototype.fromGcxFeature.call(this,a)};k.prototype.fromEsriGraphic=function(a){return h.prototype.fromEsriGraphic.call(this,a)};k.prototype.toGcxFeatureSetCollection=function(a){return Promise.resolve(this._convert(a,"gcxFeatureSetCollection",this._toGcxFeatureSetCollection))};k.prototype._canCreateGcxLayer=function(a,b){return!!a.gcxLayerDefinition};k.prototype._canCreateGcxMapService=
function(a){return!!a.gcxMapServiceDefinition};k.prototype._createGcxMapService=function(a){var d=this;return Promise["try"](function(){if(h.prototype._canCreateGcxMapService.call(d,a))return h.prototype._createGcxMapService.call(d,a);var b=d._getMapServiceDefinition(a);return b?(b.layers=a.layers.map(function(a){return a.gcxLayerDefinition}).filter(function(a){return null!=a}),y.ServiceDiscoveryUtilities.buildMapService(d.app.site.essentialsMap,b).then(function(a){d.app.site.essentialsMap.addMapService(a);
return a})):Promise.reject(Error("ProjectConverter._createGcxMapService: Unsupported service layer type."))}).then(function(d){d instanceof b.LocalFeatureLayerService&&a.layers&&a.layers[0]&&a.layers[0].gcxLayerDefinition&&d.layers[0].createFromDefinition(a.layers[0].gcxLayerDefinition);return d})};k.prototype._createGcxLayer=function(a,b){var d=this,c=a.gcxLayerDefinition;if(c&&c.catalogId)return new Promise(function(a,g){var e={catalogId:c.catalogId,callback:function(b){b&&a(b);g(Error("ProjectConverter._createGcxLayer: Unsupported layer catalog id."))},
gcxLayerDefinition:c,mapService:b};d.app.waitUntilAllLibrariesLoaded().then(function(){d.app.command("RestoreDynamicLayer").execute(e)})});var g=new l.Layer(c.url);g.createFromDefinition(c);b.add(g);g.isUserCreated=!0;return Promise.resolve(g)};k.prototype._getMapServiceDefinition=function(a){return a.gcxMapServiceDefinition};k.prototype._getWebMapLayerDefinitionFromDynamicLayer=function(a,b){var d=h.prototype._getWebMapLayerDefinitionFromDynamicLayer.call(this,a,b);a.layerDrawingOptions&&a.layerDrawingOptions[b]&&
(d.drawingInfo.showLabels=a.layerDrawingOptions[b].showLabels,d.drawingInfo.labelingInfo=a.layerDrawingOptions[b].labelingInfo);return d};k.prototype._applyDynamicLayerInfo=function(a,b,d){var c=d.mapService.serviceLayer,g=parseInt(d.id);d.mapService.convertToDynamicLayers();d=c.dynamicLayerInfos||[];var e=d.filter(function(a){return a.id===g})[0];e?(a=d.indexOf(e),a!=b&&d.splice(b,0,d.splice(a,1)[0])):(e=new esri.layers.DynamicLayerInfo,e.id=g,e.name=a.name,a.layerDefinition&&(e.minScale=a.layerDefinition.minScale,
e.maxScale=a.layerDefinition.maxScale),d.splice(b,0,e));c.setDynamicLayerInfos(d)};k.prototype._applyDrawingInfo=function(a,b){var d=this;return a?h.prototype._applyDrawingInfo.call(this,a,b).then(function(){var c=a.clustering&&(a.clustering.enabled||"undefined"===typeof a.clustering.enabled);d.app.command("RemoveClusterLayer").execute({gcxLayer:b.layers[0]});b.featureClustering&&b.featureClustering.userCanToggle&&a.clustering&&(b.featureClustering.radius=a.clustering.radius,b.featureClustering.backgroundColor=
a.clustering.backgroundColor,b.featureClustering.labelColor=a.clustering.labelColor,b.featureClustering.maximumFeatures=a.clustering.maximumFeatures);c?d.app.command("AddClusterLayer").execute({gcxLayer:b.layers[0]}):b.heatMap&&b.heatMap.userCanToggle&&a.renderer&&a.renderer.type===w.RendererType.HEATMAP||(c=b.serviceLayer,c.setRenderer(d.toEsriRenderer(a.renderer)),c.redraw())}):Promise.resolve()};k.prototype._setGraphicsLayerRenderer=function(a,b){};k.prototype._applyWebMapLayerToGcxLayer=function(a,
b,c){var g=this;return h.prototype._applyWebMapLayerToGcxLayer.call(this,a,b,c).then(function(e){for(var m=c.mapService.serviceLayer,f=0,n=c.styles;f<n.length;f++){var q=n[f];q.enabled=!1}a.layerStyleId&&(q=c.styles.filter(function(b){return b.id===a.layerStyleId})[0],f=void 0,m instanceof esri.layers.ArcGISDynamicMapServiceLayer?f=JSON.stringify(g.toEsriRenderer(a.layerDefinition.drawingInfo.renderer).toJson()):m instanceof esri.layers.FeatureLayer&&(f=JSON.stringify(g.toEsriRenderer(a.serviceLayer.layerDefinition.drawingInfo.renderer).toJson())),
q?(f&&q.setRenderer(f),q.enabled=!0):f&&c.styles.push(new d.LayerStyle(f,a.layerStyleId,a.layerStyleId,!0)));return a.isDynamic&&m instanceof esri.layers.ArcGISDynamicMapServiceLayer?g.app.waitUntilServiceLayerLoaded(m).then(function(){g._applyDynamicLayerInfo(a,b,c);return e}):e})};k.prototype._toGcxLayer=function(a,b){b||(b=a.serviceLayer);return h.prototype._toGcxLayer.call(this,a,b)};k.prototype._toGcxFeatureSetCollection=function(a){var b=this,d=this.app.featureSetManager.featureSetCollections.get().filter(function(b){return b.id===
a.id})[0];d||(d=new e.FeatureSetCollection,d.id=a.id,this.app.featureSetManager.addCollection(d));d.displayName.set(a.displayName);d.sourceName=a.sourceName;var c='feature set collection "{0}"'.format(a.id);return g.PromiseUtils.mapSkipRejected(a.featureSets,function(a){return g.PromiseUtils.warnOnReject(b.toGcxFeatureSet(a),b.app,'Unable to restore feature set "{0}" for {1}: {{0}}'.format(a.id,c))}).then(function(a){d.clear();d.featureSets.addItems(a)}).then(function(){return g.PromiseUtils.warnOnReject(b.toObject(a.tag),
b.app,"Unable to restore tag for {0}: {{0}}".format(c))}).then(function(a){d.tag=a}).then(function(){return b._toGcxExtendedProperties(a.extendedProperties,c)}).then(function(a){d.extendedProperties.addItems(a)}).then(function(){return d})};k.prototype._toGcxFeatureSet=function(a){var b=this,d,e=a.layer,m=a.features||[],f={gcxLayer:this.toGcxLayer(e,e?e.serviceLayer:null),esriFeatureSet:this.toEsriFeatureSet(a),extendedProperties:this._toGcxExtendedProperties(a.extendedProperties,"feature set")};
return Promise.props(f).then(function(g){d=new c.FeatureSet({app:b.app,layer:g.gcxLayer,esriFeatureSet:g.esriFeatureSet,allowUnsafeContent:b.app.configuration&&b.app.configuration.allowUnsafeContent&&a.allowUnsafeContent});e||(d.loadAttributes(),d.displayName.set(a.displayName),d.iconUri.set(a.iconUri));d.id=a.id;d.extendedProperties.addItems(g.extendedProperties)}).then(function(){return g.PromiseUtils.mapSkipRejected(m,function(a){return b._findMatchingGcxFeature(a,d).then(function(d){return b._applyFeatureToGcxFeature(a,
d)})})}).then(function(){b.app.waitUntilAllLibrariesLoaded().then(function(){d.dataLinksState===c.DataLinksState.Unresolved&&d.resolveDataLinks(function(a){b.app.event("FeatureChangedEvent").publish(a)})})}).then(function(){return d})};k.prototype._toGcxFeature=function(a){var b=this;return a.featureSet?this.toGcxFeatureSet(a.featureSet).then(function(d){return b._findMatchingGcxFeature(a,d)}).then(function(b){if(!b)throw Error('Unable to restore feature with ID "{0}": feature no longer exists.'.format(a.id));
return b}):this._createGcxFeature(a)};k.prototype._createGcxFeature=function(b){var d=this,c=b.layer,c={gcxLayer:this.toGcxLayer(c,c?c.serviceLayer:null),featureLayer:c?null:this.toEsriLayer(b.featureLayer),graphic:this.toEsriGraphic(b),extendedProperties:this._toGcxExtendedProperties(b.extendedProperties,"feature")};return Promise.props(c).then(function(c){var g={layer:c.gcxLayer,featureLayer:c.featureLayer,graphic:c.graphic,allowUnsafeContent:d.app.configuration&&d.app.configuration.allowUnsafeContent&&
b.allowUnsafeContent},g=b[m.isKmlProperty]?new m.KmlFeature(g):new a.Feature(g);g.defaultDateFormat=b.defaultDateFormat||q.DateFormat.DEFAULT;g.defaultNumberFormat=b.defaultNumberFormat||n.NumberFormat.DEFAULT;g.timeZoneId=b.timeZoneId;g.displayTimeZoneId=b.displayTimeZoneId;g.borderColor.set(b.borderColor);g.fillColor.set(b.fillColor);g.borderWidth.set(b.borderWidth);g.extendedProperties.addItems(c.extendedProperties);return g})};k.prototype._applyFeatureToGcxFeature=function(a,b){if(!a||!b)return Promise.resolve();
b.defaultDateFormat=a.defaultDateFormat||q.DateFormat.DEFAULT;b.defaultNumberFormat=a.defaultNumberFormat||n.NumberFormat.DEFAULT;b.timeZoneId=a.timeZoneId;return this._toGcxExtendedProperties(a.extendedProperties,"feature").then(function(a){return b.extendedProperties.addItems(a)})};k.prototype._findMatchingGcxFeature=function(a,b){return a.id?Promise.resolve(b.findFeatureById(a.id)):this.toEsriGraphic(a).then(function(a){return p.firstOrDefault(b.features.get(),function(b){return b.esriFeature.get()===
a})})};k.prototype._queryFeatures=function(a,b){var d=this;return a&&a.length&&b&&b.layer?Promise["try"](function(){for(var c=a.map(function(a){return a.id}),e=[];1E3<c.length;)e.push(c.splice(0,1E3));e.push(c);c=b.layer;return d.toGcxLayer(c,c?c.serviceLayer:null).then(function(a){if(!a||!a.getObjectIdFieldName())throw Error('Cannot restore features for layer "{0}": no primary key field defined.'.format(a?a.name:""));a.getObjectIdFieldName();var b=s.getQueryTask(a);return g.PromiseUtils.mapSkipRejected(e,
function(a){var d=new esri.tasks.Query;d.objectIds=a.map(function(a){return parseInt(a)});d.returnGeometry=!0;d.outFields=["*"];return b.execute(d).then(function(a){return a.features})},{concurrency:2}).then(function(a){return p.flatten(a)})})}):Promise.resolve([])};k.prototype._toEsriGraphic=function(a){return h.prototype._toEsriGraphic.call(this,a).then(function(b){a.hasOwnProperty(f.PROPERTY_MEASUREMENT_ID)&&(b[f.PROPERTY_MEASUREMENT_ID]=a[f.PROPERTY_MEASUREMENT_ID]);a.hasOwnProperty(r.coordinateIdentifierProperty)&&
(b[r.coordinateIdentifierProperty]=a[r.coordinateIdentifierProperty]);a.hasOwnProperty(m.isKmlProperty)&&(b[m.isKmlProperty]=a[m.isKmlProperty]);a.hasOwnProperty(f.PROPERTY_HIGHLIGHT_ID)&&(b[f.PROPERTY_HIGHLIGHT_ID]=a[f.PROPERTY_HIGHLIGHT_ID]);return b})};k.prototype._toEsriFeatureSet=function(a){var b=this,d=a.layer,c=d?d.serviceLayer:null,e=a.features||[],m=e.filter(function(a){return!t.isNullOrUndefined(a.id)}),e=e.filter(function(a){return t.isNullOrUndefined(a.id)});a={gcxLayer:this.toGcxLayer(d,
c),queryResults:this._queryFeatures(m,a),rehydratedGraphics:g.PromiseUtils.mapSkipRejected(e,function(a){return b.toEsriGraphic(a)})};return Promise.props(a).then(function(a){a=a.queryResults.concat(a.rehydratedGraphics);var b=new esri.tasks.FeatureSet;b.features=a;return b})};k.prototype._fromGcxMapService=function(a){var b=this;if(0<=(this._exclusionCache[x.ConversionType.GCX_MAP_SERVICE]||[]).indexOf(a))throw Error("ProjectConverter.fromGcxMapService: Services added through layer addition dialog are only supported if they have been whitelisted by your administrator.");
var d;d=a&&a.serviceLayer instanceof esri.layers.WMTSLayer&&!a.tileRestUrl?{id:a.id,url:a.serviceUrl,type:u.BaseMapType.WEB_TILED,opacity:a.opacity,visibility:a.isVisible(),layers:[]}:h.prototype._fromGcxMapService.call(this,a);a.isUserCreated&&(d.gcxMapServiceDefinition=a.toJson(),d.isUserCreated=a.isUserCreated,d.userLayerType=a.userLayerType);d.layers||(d.layers=v.ArrayUtils.mapWithErrorCallback(a.layers,function(a){return b.fromGcxLayer(a)},function(a,b){console.warn('Unable to convert layer "{0}": {1}'.format(a.id,
b))}));if(a.featureClustering){var c=void 0;this._isFeatureCollection(d)?(d.featureCollection.layers[0].layerDefinition=d.featureCollection.layers[0].layerDefinition||{drawingInfo:{}},c=d.featureCollection.layers[0].layerDefinition):(d.layerDefinition=d.layerDefinition||{drawingInfo:{}},c=d.layerDefinition);c.drawingInfo=c.drawingInfo||{};c.drawingInfo.clustering={radius:a.featureClustering.radius,backgroundColor:a.featureClustering.backgroundColor,labelColor:a.featureClustering.labelColor,maximumFeatures:a.featureClustering.maximumFeatures,
enabled:a.featureClustering.enabled};if(a=this.app.map.getLayer(a.id+"-cluster"))c.drawingInfo.renderer=this.fromEsriRenderer(a.featureLayerRenderer)}return d};k.prototype._fromGcxlayer=function(a){if(0<=(this._exclusionCache[x.ConversionType.GCX_MAP_SERVICE]||[]).indexOf(a.mapService))throw Error("ProjectConverter.fromGcxLayer: Services added through layer addition dialog are only supported if they have been whitelisted by your administrator.");var b=h.prototype._fromGcxlayer.call(this,a);b.serviceLayer=
this.fromGcxMapService(a.mapService);var d=a.mapService.serviceLayer;b.isDynamic=a.isDynamic;d instanceof esri.layers.ArcGISDynamicMapServiceLayer&&d.supportsDynamicLayers&&(b.isDynamic=b.isDynamic||d.dynamicLayerInfos&&!!d.dynamicLayerInfos[parseInt(a.id)]);a.isUserCreated&&(b.gcxLayerDefinition=a.toJson(),b.isUserCreated=a.isUserCreated,b.userLayerType=a.userLayerType);if(a=a.styles.filter(function(a){return a.enabled})[0])b.layerStyleId=a.id;return b};k.prototype._fromGcxFeatureSetCollection=function(a){var b=
{id:a.id,displayName:a.displayName.get(),featureSets:a.featureSets.get().map(this.fromGcxFeatureSet,this),sourceName:a.sourceName,tag:this.fromObject(a.tag)};a.extendedProperties.getLength()&&(b.extendedProperties=this._fromGcxExtendedProperties(a.extendedProperties));return b};k.prototype._fromGcxFeatureSet=function(a){var b=h.prototype._fromGcxFeatureSet.call(this,a);b.id=a.id;b.layer=this.fromGcxLayer(a.layer);b.allowUnsafeContent=a._allowUnsafeContent;a.layer||(b.displayName=a.displayName.get(),
b.iconUri=a.iconUri.get());return b};k.prototype._fromGcxFeature=function(a){var b={};this._canRequeryFeatureData(a)?b={id:a.id.get(),featureSet:this.fromGcxFeatureSet(a.featureSet)}:(b=h.prototype._fromGcxFeature.call(this,a),b.featureSet=this.fromGcxFeatureSet(a.featureSet));b.featureSet||(b.layer=this.fromGcxLayer(a.layer));a.featureLayer&&!a.layer&&(b.featureLayer=this.fromEsriLayer(a.featureLayer));b.allowUnsafeContent=a._allowUnsafeContent;a.borderColor.get()&&(b.borderColor=a.borderColor.get());
a.fillColor.get()&&(b.fillColor=a.fillColor.get());0<=a.borderWidth.get()&&(b.borderWidth=a.borderWidth.get());a.extendedProperties.getLength()&&(b.extendedProperties=this._fromGcxExtendedProperties(a.extendedProperties));a.defaultDateFormat!==q.DateFormat.DEFAULT&&(b.defaultDateFormat=a.defaultDateFormat);a.defaultNumberFormat!==n.NumberFormat.DEFAULT&&(b.defaultNumberFormat=a.defaultNumberFormat);var d=a.esriFeature.get();d&&d.hasOwnProperty(m.isKmlProperty)&&(b[m.isKmlProperty]=d[m.isKmlProperty]);
a.timeZoneId&&(b.timeZoneId=a.timeZoneId);a.displayTimeZoneId&&b.displayTimeZoneId;return b};k.prototype._fromEsriGraphic=function(a){var b=h.prototype._fromEsriGraphic.call(this,a);a.hasOwnProperty(f.PROPERTY_MEASUREMENT_ID)&&(b[f.PROPERTY_MEASUREMENT_ID]=a[f.PROPERTY_MEASUREMENT_ID]);a.hasOwnProperty(r.coordinateIdentifierProperty)&&(b[r.coordinateIdentifierProperty]=a[r.coordinateIdentifierProperty]);a.hasOwnProperty(m.isKmlProperty)&&(b[m.isKmlProperty]=a[m.isKmlProperty]);a.hasOwnProperty(f.PROPERTY_HIGHLIGHT_ID)&&
(b[f.PROPERTY_HIGHLIGHT_ID]=a[f.PROPERTY_HIGHLIGHT_ID]);return b};k.prototype._toGcxExtendedProperties=function(a,b){var d=this;a=a||{};return g.PromiseUtils.mapSkipRejected(Object.keys(a),function(c){var e=d.toObject(a[c]).then(function(a){return{name:c,value:a}});return g.PromiseUtils.warnOnReject(e,d.app,"Unable to restore extended property '{0}' for {1}: {{0}}".format(c,b))})};k.prototype._fromGcxExtendedProperties=function(a){var b=this,d={};a.get().forEach(function(a){d[a.name]=b.fromObject(a.value)});
return d};k.prototype._canRequeryFeatureData=function(a){return a&&!a.isModified&&!t.isNullOrUndefined(a.id.get())&&""!==a.id.get()&&a.featureSet&&a.featureSet.layer&&(a.featureSet.layer.getLayerUrl()&&a.featureSet.layer.supportsQuery||!String.isNullOrEmpty(a.featureSet.layer.catalogId))};return k}(k.WebMapConverter);f.ProjectConverter=h});define("infrastructure/validation/Validator",["require","exports"],function(h,f){});
define("infrastructure/validation/NumberValidator",["require","exports","infrastructure/FormatUtils","geocortex/framework/utils/utils"],function(h,f,k,l){h=function(){function e(){}e.prototype.validate=function(c,a){var b=a&&!!a.invalidNumbersAsNaN,d=k.parseNumber(c);return l.isNullOrUndefined(c)?Promise.resolve({validatedValue:c}):isNaN(d)&&!b?Promise.reject(Error("Invalid number.")):Promise.resolve({validatedValue:d})};return e}();f.NumberValidator=h});
define("infrastructure/UrlUtilities",["require","exports","infrastructure/Dictionary"],function(h,f,k){function l(a){var b="";if(!a)return b;for(var d=a.keys(),c=0;c<d.length;c++)0<b.length&&(b+="&"),b+="{0}={1}".format(d[c],a.get(d[c]));return"{0}{1}".format(0<b.length?"?":"",b)}function e(a){var b=new k.Dictionary;if(!a)return b;a.startsWith("?")&&(a=a.slice(1));a.split(/[&;]/g).forEach(function(a){a&&(a=a.split("=",2),b.set(a[0],a[1]))});return b}function c(a){var b=document.createElement("a");
b.href=a;return b}f.queryStringDictionaryToString=l;f.queryStringToDictionary=e;f.parseUrl=c;f.addQueryParameter=function(a,b,d){a=c(a);var g=e(a.search);g.set(b,d);a.search=l(g);return a.toString()};f.removeQueryParameter=function(a,b){var d=c(a),g=e(d.search);g.remove(b);d.search=l(g);return d.toString()};f.getFolder=function(a){a="string"===typeof a?c(a):dojo.clone(a);var b=null==a.pathname?"":a.pathname;if(null==b)return a;b=b.split("/");0<=b[b.length-1].indexOf(".")&&(b.pop(),a.pathname=b.join("/"));
a.pathname.endsWith("/")||(a.pathname+="/");a.search="";a.hash="";a.href=a.href.replace(/[\?#]+$/,"");return a};f.removeParameters=function(a){a="string"===typeof a?c(a):dojo.clone(a);if(null==(null==a.pathname?"":a.pathname))return a;a.pathname.endsWith("/")||(a.pathname+="/");a.search="";a.hash="";a.href=a.href.replace(/[\?#]+$/,"");return a}});
define("infrastructure/validation/SiteUrlValidator",["require","exports","infrastructure/UrlUtilities","geocortex/essentials/RestHelper","geocortex/framework/utils/utils"],function(h,f,k,l,e){h=function(){function c(a){if(!a)throw Error('Argument "app" is required.');this.app=a;this._initializeAllowedUrls();this.app.command("ClearTrustedUrls").register(this,this.executeClearTrustedUrls)}c.prototype.executeClearTrustedUrls=function(){for(var a=Object.keys(window.localStorage),b=0;b<a.length;b++)a[b].match("^uri.markup|^uri.css|^uri.navigablelink")&&
window.localStorage.removeItem(a[b])};c.prototype.validate=function(a,b){var d=this;return a?"string"!==typeof a?Promise.reject(Error("Input is not a URL.")):this._initializeAllowedUrls().then(function(){var b=k.parseUrl(l.RestHelper.processClientSideTokens(d.app.site,a));if(d._allowedUrls.some(function(a){return d._isMatch(a,b)}))return Promise.resolve({validatedValue:a});var c="The following URL is not defined by this Essentials site and will be skipped: {0}".format(a);return Promise.reject(c)}):
Promise.resolve({validatedValue:a})};c.prototype.tryValidateSynchronously=function(a){var b=this;if(!this._allowedUrls)return!1;var d=k.parseUrl(l.RestHelper.processClientSideTokens(this.app.site,a));return this._allowedUrls.some(function(a){return b._isMatch(a,d)})};c.prototype._isMatch=function(a,b){return"mailto:"===b.protocol?!0:e.isNullOrUndefined(b.pathname)?!1:b.host==a.host&&b.protocol==a.protocol&&(b.pathname.startsWith(a.pathname)||b.pathname+"/"===a.pathname)};c.prototype._initializeAllowedUrls=
function(){var a=this;return this._allowedUrls?Promise.resolve():this.app.waitUntilSiteInitialized().then(function(){var b=a.app.site;a._allowedUrls=[];a._allowUrl(b.url);a._allowUrl("http://localhost:8181");a._allowUrl("http://127.0.0.1:8181");for(var d=0;d<b.trustedUrls.length;d++)a._allowUrl(b.trustedUrls[d].url);b.properties.trustedUrls&&b.properties.trustedUrls.split(",").forEach(function(b){a._allowUrl(b)});b.essentialsMap&&b.essentialsMap.mapServices.filter(function(a){return!a.isUserCreated}).forEach(function(b){a._allowUrl(b.serviceUrl);
a._allowUrl(b.tileRestUrl);a._allowUrl(b.mapUrl);a._allowUrl(b.iconUri);(b.layerHyperlinks||[]).forEach(function(b){a._allowUrl(b.uri);a._allowUrl(b.iconUri)});(b.layers||[]).forEach(function(b){a._allowUrl(b.getLayerUrl());a._allowUrl(b.legendUrl);a._allowUrl(b.iconUri);(b.featureHyperlinks||[]).forEach(function(b){a._allowUrl(b.uri);a._allowUrl(b.iconUri)});(b.layerHyperlinks||[]).forEach(function(b){a._allowUrl(b.uri);a._allowUrl(b.iconUri)});a._extractUrls(b.featureLabel).forEach(function(b){return a._allowUrl(b)});
a._extractUrls(b.featureDescription).forEach(function(b){return a._allowUrl(b)});a._extractUrls(b.featureLongDescription).forEach(function(b){return a._allowUrl(b)})})})})};c.prototype._allowUrl=function(a){if(a)try{this._allowedUrls.push(k.getFolder(a))}catch(b){}};c.prototype._extractUrls=function(a){return a?(a.match(/(https?:\/\/[A-Za-z0-9\-\._~:\/\?#[\]@!\$&'()*\+,;=%]+)/g)||[]).map(function(a){return 0<=a.indexOf("{")?a.slice(0,a.indexOf("{")):a}):[]};return c}();f.SiteUrlValidator=h});
define("infrastructure/webMap/WebMapFilter","require exports infrastructure/validation/NumberValidator infrastructure/validation/SiteUrlValidator infrastructure/webMap/Domain infrastructure/webMap/Renderer infrastructure/webMap/Symbol infrastructure/webMap/WebMapConverter".split(" "),function(h,f,k,l,e,c,a,b){var d="__conversionType";h=function(){function g(a){var c=this;this._numberValidator=new k.NumberValidator;this.object=function(a){if(!a||"object"!==typeof a)return!0;if(Array.isArray(a))return{item:c.object};
switch(a[d]){case b.ConversionType.GCX_MAP_SERVICE:case b.ConversionType.ESRI_LAYER:return c.serviceLayer;case b.ConversionType.GCX_LAYER:return c.layer;case b.ConversionType.GCX_FEATURE_SET:case b.ConversionType.ESRI_FEATURE_SET:return c.featureSet;case b.ConversionType.GCX_FEATURE:case b.ConversionType.ESRI_GRAPHIC:return c.feature;case b.ConversionType.ESRI_GEOMETRY:return c.geometry;case b.ConversionType.ESRI_SYMBOL:return c.symbol;case b.ConversionType.ESRI_RENDERER:return c.renderer;case b.ConversionType.ESRI_SPATIAL_REFERENCE:return c.spatialReference}var g=
{},e=0;for(a=Object.keys(a);e<a.length;e++)g[a[e]]=c.object;return g};this.app=a;this._urlValidator=new l.SiteUrlValidator(a)}Object.defineProperty(g.prototype,"baseMap",{get:function(){this._baseMap||(this._baseMap={baseMapLayers:{item:this.baseMapLayer},title:!0});return this._baseMap},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"baseMapLayer",{get:function(){this._baseMapLayer||(this._baseMapLayer=$.extend({},this._serviceLayerCommon,{type:!0,isReference:!0,templateUrl:this._urlValidator}),
this._baseMapLayer[d]=!0);return this._baseMapLayer},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"bookmark",{get:function(){this._bookmark||(this._bookmark={name:!0,extent:this.extent});return this._bookmark},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"color",{get:function(){this._color||(this._color={item:this._numberValidator});return this._color},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"csvLayer",{get:function(){this._csvLayer||
(this._csvLayer=$.extend({},this.operationalLayer,{columnDelimiter:!0,locationInfo:this.locationInfo}));return this._csvLayer},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"domain",{get:function(){var a=this;this._domain||(this._domain=function(b){if(!b)return!1;switch(b.type){case e.DomainType.INHERITED:return a.inheritedDomain;case e.DomainType.RANGE:return a.rangeDomain;case e.DomainType.CODED_VALUE:return a.codedValueDomain;default:return!1}});return this._domain},enumerable:!0,
configurable:!0});Object.defineProperty(g.prototype,"inheritedDomain",{get:function(){this._inheritedDomain||(this._inheritedDomain={type:!0});return this._inheritedDomain},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"rangeDomain",{get:function(){this._rangeDomain||(this._rangeDomain={type:!0,name:!0,range:{item:this._numberValidator}});return this._rangeDomain},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"codedValueDomain",{get:function(){this._codedValueDomain||
(this._codedValueDomain={type:!0,name:!0,codedValues:{item:{name:!0,code:!0}}});return this._codedValueDomain},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"drawingInfo",{get:function(){this._drawingInfo||(this._drawingInfo={renderer:this.renderer,fixedSymbols:!0});return this._drawingInfo},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"feature",{get:function(){this._feature||(this._feature={attributes:this.object,geometry:this.geometry},this._feature[d]=!0);
return this._feature},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"featureCollection",{get:function(){this._featureCollection||(this._featureCollection={layers:{item:this.layer},showLegend:!0});return this._featureCollection},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"featureSet",{get:function(){this._featureSet||(this._featureSet={features:{item:this.feature},geometryType:!0},this._featureSet[d]=!0);return this._featureSet},enumerable:!0,configurable:!0});
Object.defineProperty(g.prototype,"field",{get:function(){this._field||(this._field={alias:!0,domain:this.domain,editable:!0,length:!0,name:!0,nullable:!0,type:!0});return this._field},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"geometry",{get:function(){var a=this;this._geometry||(this._geometry=function(b){return b?b.hasOwnProperty("x")?a.point:b.hasOwnProperty("points")?a.multiPoint:b.hasOwnProperty("paths")?a.polyline:b.hasOwnProperty("rings")?a.polygon:b.hasOwnProperty("xmin")?
a.extent:!1:!1});return this._geometry},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"point",{get:function(){this._point||(this._point={spatialReference:this.spatialReference,x:this._numberValidator,y:this._numberValidator,z:this._numberValidator,m:this._numberValidator},this._point[d]=!0);return this._point},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"multiPoint",{get:function(){this._multipoint||(this._multipoint={spatialReference:this.spatialReference,
hasM:!0,hasZ:!0,points:{item:{item:this._numberValidator}}},this._multipoint[d]=!0);return this._multipoint},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"polyline",{get:function(){this._polyline||(this._polyline={spatialReference:this.spatialReference,hasM:!0,hasZ:!0,paths:{item:{item:{item:this._numberValidator}}}},this._polyline[d]=!0);return this._polyline},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"polygon",{get:function(){this._polygon||(this._polygon=
{spatialReference:this.spatialReference,hasM:!0,hasZ:!0,rings:{item:{item:{item:this._numberValidator}}}},this._polygon[d]=!0);return this._polygon},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"extent",{get:function(){this._extent||(this._extent={spatialReference:this.spatialReference,xmin:this._numberValidator,xmax:this._numberValidator,ymin:this._numberValidator,ymax:this._numberValidator,zmin:this._numberValidator,zmax:this._numberValidator,mmin:this._numberValidator,mmax:this._numberValidator},
this._extent[d]);return this._extent},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"layer",{get:function(){this._layer||(this._layer={featureSet:this.featureSet,id:!0,layerDefinition:this.layerDefinition,layerUrl:this._urlValidator,legendUrl:this._urlValidator,name:!0,title:!0,popupInfo:this.popupInfo},this._layer[d]=!0);return this._layer},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"layerDefinition",{get:function(){this._layerDefinition||(this._layerDefinition=
{definitionExpression:!0,displayField:!0,drawingInfo:this.drawingInfo,fields:{item:this.field},geometryType:!0,hasAttachments:!0,maxScale:this._numberValidator,minScale:this._numberValidator,name:!0,objectIdField:!0,templates:{item:this.template},type:!0,typeIdField:!0,types:{item:this.type},source:{type:!0,mapLayerId:this._numberValidator}});return this._layerDefinition},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"locationInfo",{get:function(){this._locationInfo||(this._locationInfo=
{locationType:!0,latitudeFieldName:!0,longitudeFieldName:!0});return this._locationInfo},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"operationalLayer",{get:function(){this._operationalLayer||(this._operationalLayer=$.extend({},this._serviceLayerCommon,{type:!0,capabilities:!0,featureCollection:this.featureCollection,itemId:!0,layerDefinition:this.layerDefinition,layers:{item:this.layer},maxScale:this._numberValidator,minScale:this._numberValidator,mode:this._numberValidator,
popupInfo:this.popupInfo,title:!0,visibleLayers:{item:!0}}),this._operationalLayer[d]=!0);return this._operationalLayer},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"popupInfo",{get:function(){return{}},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"renderer",{get:function(){var a=this;this._renderer||(this._renderer=function(b){if(!b)return!1;switch(b.type){case c.RendererType.SIMPLE:return a.simpleRenderer;case c.RendererType.UNIQUE_VALUE:return a.uniqueValueRenderer;
case c.RendererType.CLASS_BREAKS:return a.classBreaksRenderer;case c.RendererType.HEATMAP:return a.heatmapRenderer;default:return!1}});return this._renderer},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"serviceLayer",{get:function(){this._serviceLayer||(this._serviceLayer=$.extend({},this.operationalLayer,this.wmsLayer,this.csvLayer,this.baseMapLayer));return this._serviceLayer},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"simpleRenderer",{get:function(){this._simpleRenderer||
(this._simpleRenderer={type:!0,symbol:this.symbol,label:!0,description:!0},this._simpleRenderer[d]=!0);return this._simpleRenderer},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"uniqueValueRenderer",{get:function(){this._uniqueValueRenderer||(this._uniqueValueRenderer={type:!0,field1:!0,field2:!0,field3:!0,fieldDelimiter:!0,defaultSymbol:this.symbol,defaultLabel:!0,uniqueValueInfos:{item:{value:!0,label:!0,description:!0,symbol:this.symbol}}},this._uniqueValueRenderer[d]=!0);
return this._uniqueValueRenderer},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"classBreaksRenderer",{get:function(){this._classBreaksRenderer||(this._classBreaksRenderer={type:!0,field:!0,classificationMethod:!0,normalizationType:!0,normalizationField:!0,normalizationTotal:this._numberValidator,defaultSymbol:this.symbol,defaultLabel:!0,backgroundFillSymbol:this.simpleFillSymbol,minValue:this._numberValidator,classBreakInfos:{item:{classMinValue:this._numberValidator,classMaxValue:this._numberValidator,
label:!0,description:!0,symbol:this.symbol}}},this._classBreaksRenderer[d]=!0);return this._classBreaksRenderer},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"heatmapRenderer",{get:function(){this._heatmapRenderer||(this._heatmapRenderer={type:!0,blurRadius:this._numberValidator,field:!0,maxPixelIntensity:this._numberValidator,minPixelIntensity:this._numberValidator,colorStops:{item:{ratio:!0,color:this.color}}});return this._heatmapRenderer},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,
"_serviceLayerCommon",{get:function(){return{id:!0,url:this._urlValidator,visibility:!0,opacity:this._numberValidator,layerType:!0}},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"spatialReference",{get:function(){this._spatialReference||(this._spatialReference={wkid:this._numberValidator,wkt:!0},this._spatialReference[d]=!0);return this._spatialReference},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"symbol",{get:function(){var b=this;this._symbol||(this._symbol=
function(d){if(!d)return!1;switch(d.type){case a.SymbolType.SIMPLE_MARKER:return b.simpleMarkerSymbol;case a.SymbolType.SIMPLE_LINE:return b.simpleLineSymbol;case a.SymbolType.SIMPLE_FILL:return b.simpleFillSymbol;case a.SymbolType.PICTURE_MARKER:return b.pictureMarkerSymbol;case a.SymbolType.PICTURE_FILL:return b.pictureFillSymbol;case a.SymbolType.TEXT:return b.textSymbol;default:return!1}});return this._symbol},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"simpleMarkerSymbol",
{get:function(){this._simpleMarkerSymbol||(this._simpleMarkerSymbol={type:!0,style:!0,color:this.color,size:!0,angle:this._numberValidator,path:!0,xoffset:this._numberValidator,yoffset:this._numberValidator,outline:{type:!0,style:!0,color:this.color,width:this._numberValidator}},this._simpleMarkerSymbol[d]=!0);return this._simpleMarkerSymbol},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"simpleLineSymbol",{get:function(){this._simpleLineSymbol||(this._simpleLineSymbol={type:!0,
style:!0,color:this.color,width:this._numberValidator},this._simpleLineSymbol[d]=!0);return this._simpleLineSymbol},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"simpleFillSymbol",{get:function(){this._simpleFillSymbol||(this._simpleFillSymbol={type:!0,style:!0,color:this.color,outline:this.simpleLineSymbol},this._simpleFillSymbol[d]=!0);return this._simpleFillSymbol},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"pictureMarkerSymbol",{get:function(){this._pictureMarkerSymbol||
(this._pictureMarkerSymbol={type:!0,url:this._urlValidator,imageData:!0,contentType:!0,width:this._numberValidator,height:this._numberValidator,angle:this._numberValidator,xoffset:this._numberValidator,yoffset:this._numberValidator},this._pictureMarkerSymbol[d]=!0);return this._pictureMarkerSymbol},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"pictureFillSymbol",{get:function(){this._pictureFillSymbol||(this._pictureFillSymbol={type:!0,url:this._urlValidator,imageData:!0,contentType:!0,
outline:this.simpleLineSymbol,width:this._numberValidator,height:this._numberValidator,angle:this._numberValidator,xoffset:this._numberValidator,yoffset:this._numberValidator,xscale:this._numberValidator,yscale:this._numberValidator},this._pictureFillSymbol[d]=!0);return this._pictureFillSymbol},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"textSymbol",{get:function(){this._textSymbol||(this._textSymbol={type:!0,color:this.color,backgroundColor:this.color,borderLineSize:this._numberValidator,
borderLineColor:this.color,haloSize:this._numberValidator,haloColor:this.color,verticalAlignment:!0,horizontalAlignment:!0,rightToLeft:!0,angle:this._numberValidator,xoffset:this._numberValidator,yoffset:this._numberValidator,kerning:!0,font:{family:!0,size:this._numberValidator,style:!0,weight:!0,decoration:!0},text:!0},this._textSymbol[d]=!0);return this._textSymbol},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"template",{get:function(){this._template||(this._template={description:!0,
drawingTool:!0,name:!0,prototype:this.feature});return this._template},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"type",{get:function(){var a=this;this._type||(this._type={domains:function(b){if(!b)return!0;var d={},c=0;for(b=Object.keys(b);c<b.length;c++)d[b[c]]=a.domain;return d},id:this._numberValidator,name:!0,templates:{item:this.template}});return this._type},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"webMap",{get:function(){this._webMap||(this._webMap=
{operationalLayers:{item:this.operationalLayer},baseMap:this.baseMap,bookmarks:{item:this.bookmark},version:!0,applicationProperties:!0});return this._webMap},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"wmsLayer",{get:function(){this.wmsLayer||(this._wmsLayer=$.extend({},this.operationalLayer,{copyright:!0,extent:this.extent,format:!0,mapUrl:this._urlValidator,maxHeight:this._numberValidator,maxWidth:this._numberValidator,spatialReferences:{item:this._numberValidator},version:!0}));
return this._wmsLayer},enumerable:!0,configurable:!0});return g}();f.WebMapFilter=h});
define("infrastructure/validation/ServiceDiscoveryUrlValidator",["require","exports","infrastructure/validation/SiteUrlValidator","geocortex/essentials/RestHelper","geocortex/essentials/serviceDiscovery/SiteServiceDiscoveryProvider"],function(h,f,k,l,e){h=function(c){function a(a,d){var g=c.call(this,a)||this;g._serviceDiscovery=null;if(!a)throw Error('Argument "app" is required.');g.app=a;d&&g.setDiscoveryProvider(d);return g}__extends(a,c);a.prototype.getDiscoveryProvider=function(){return this._serviceDiscovery};
a.prototype.setDiscoveryProvider=function(a){this._serviceDiscovery=a};a.prototype.validate=function(a,d){var g=this;return a?"string"!==typeof a?Promise.reject(Error("Input is not a URL.")):this._initializeDiscoveryProvider().then(function(){return c.prototype.validate.call(g,a,d)})["catch"](function(){return g._validate(a,d)}):Promise.resolve({validatedValue:a})};a.prototype._validate=function(a,d){var c=l.RestHelper.processClientSideTokens(this.app.site,a),e="The following URL is not allowed by this Essentials service connection whitelist and will be skipped: "+
a;return Promise.resolve(this._serviceDiscovery.findServices(c)).then(function(d){if(d&&0<d.length&&d[0].isWhitelisted)return Promise.resolve({validatedValue:a});throw Error(e);})["catch"](function(){return Promise.reject(Error(e))})};a.prototype._initializeDiscoveryProvider=function(){var a=this;return this._serviceDiscovery?Promise.resolve():this.app.waitUntilSiteInitialized().then(function(){var d=a.app.site,c=new e.SiteServiceDiscoveryProvider;c.initialize(d);a.setDiscoveryProvider(c)})};return a}(k.SiteUrlValidator);
f.ServiceDiscoveryUrlValidator=h});define("infrastructure/commandArgs/ConfirmOptionArgs",["require","exports"],function(h,f){});
define("infrastructure/ContentPolicy",["require","exports","infrastructure/FilterUtils","infrastructure/validation/SiteUrlValidator","infrastructure/UrlUtilities"],function(h,f,k,l,e){var c=[],a=!1;(function(a){a[a.DisableSecurityPrompt=1]="DisableSecurityPrompt";a[a.DisablePromptOnImages=2]="DisablePromptOnImages";a[a.TrustExactUrl=4]="TrustExactUrl"})(f.PolicyFlags||(f.PolicyFlags={}));h=function(){function b(a){this._debounceInterval=250;this._flags=0;this._app=a}b.prototype.hasFlag=function(a){return(this._flags&
a)===a};b.prototype.setFlag=function(a){this._flags|=a};b.prototype.screenUris=function(a){this._siteValidator||(this._siteValidator=new l.SiteUrlValidator(this._app));for(var b=[],c=0;c<a.length;c++){var e=a[c];e.uri=this._screenDataUri(e.uri);null===e.uri?this._app.trace.debug("Skipped unknown, untrusted data URI."):b.push(e)}return this._validateUris(b)};b.prototype.tryScreenNavLinkSynchronously=function(a){if(!this._siteValidator)return!1;var b=this._siteValidator.tryValidateSynchronously(a.uri);
return b?b:this._getMemoizedResult(a)||!1};b.prototype._validateUris=function(a){var b=this,c=[],e=[],e=a.map(function(a){return new Promise(function(d,e){var f=a.uri;return b.hasFlag(2)&&a.type===k.UriType.Markup&&"img"===a.tag&&"src"===a.attribute?d(a):b._validateUriAgainstSite(a).then(function(b){if(null==b.validatedValue||""===b.validatedValue)return a.uri=f,c.push(a),d(null);a.type===k.UriType.NavigableLink&&a.forcePrompt&&c.push(a);return d(a)},function(b){a.uri=f;c.push(a);return d(a)})})});
return Promise.all(e).then(function(){return b._promptForUris(c)}).then(function(){return a})};b.prototype._validateUriAgainstSite=function(a){return this._siteValidator?this._siteValidator.validate(a.uri):(a.uri="",Promise.resolve({validatedValue:null}))};b.prototype._promptForUris=function(a){var b=this;return Promise.map(a,function(a,d){return new Promise(function(d,c){b._enqueueConfirmation({uriDetails:a,resolve:d})})})};b.prototype._enqueueConfirmation=function(a){c.push(a);this._processConfirmationQueue()};
b.prototype._processConfirmationQueue=function(){if(!a){a=!0;try{for(;c.length;){var b=c.shift();if(this._getConfirmation(b))return}}catch(g){throw a=!1,g;}a=!1}};b.prototype._getConfirmation=function(b){var c=this;if(!b.uriDetails.forcePrompt&&this.hasFlag(1))return b.resolve(b.uriDetails),!1;var e=b.uriDetails.type===k.UriType.NavigableLink,f=this._getMemoizedResult(b.uriDetails);if(e||!0!==f){if(e||!1!==f){var f=function(f){a=!1;c._memoizeResult(b.uriDetails,f);!0!==f&&(b.uriDetails.uri="");b.resolve(b.uriDetails);
try{if(e){var n=b.uriDetails.linkChallengeCallback;n&&n(f,b.uriDetails)}}finally{c._processConfirmationQueue()}},n={okLabel:this._app.getResource("Mapping.Infrastructure","language-content-policy-prompt-uri-accept-btn"),cancelLabel:this._app.getResource("Mapping.Infrastructure","language-content-policy-prompt-uri-reject-btn")},l=this._app.getResource("Mapping.Infrastructure","language-content-policy-prompt-uri-title"),h=this._app.getResource("Mapping.Infrastructure","language-content-policy-prompt-uri-desc"),
h=h.format(b.uriDetails.uri);if(this._app.command("Confirm").canExecute(h,l,f,n))this._app.command("Confirm").execute(h,l,f,n);else return n=window.confirm(h),f(n),!1;return!0}b.uriDetails.uri="";b.resolve(b.uriDetails);return!1}b.resolve(b.uriDetails);return!1};b.prototype._getMemoizationKey=function(a){var b;b=this.hasFlag(4)?e.parseUrl(a.uri):e.getFolder(a.uri);b=String.quickHashCode(b.toString());return"uri."+k.UriType[a.type].toLowerCase()+"."+b};b.prototype._memoizeResult=function(a,b){var c=
this._getMemoizationKey(a);window.localStorage.setItem(c,b.toString())};b.prototype._getMemoizedResult=function(a){a=this._getMemoizationKey(a);a=window.localStorage.getItem(a);return null===a?null:"true"===a};b.prototype._screenDataUri=function(a){var b=!!k.DataUri.parseDataUri(a),c=k.DataUri.isDataUriSafe(a);return!b||c?a:""};return b}();f.ContentPolicy=h});
define("infrastructure/validation/XssHtmlValidator",["require","exports","infrastructure/FilterUtils"],function(h,f,k){h=function(){function f(e){void 0===e&&(e={});this._tokenLeft="{";this._tokenRight="}";this._tokenLeftEscaped="\\{";this._tokenRightEscaped="\\}";e.contentPolicy&&(this._contentPolicy=e.contentPolicy)}f.prototype.validate=function(e,c){var a=this;void 0===c&&(c={XssHtmlValidator:{}});var b={html:e,uris:[],contentPolicy:this._contentPolicy||c.XssHtmlValidator.defaultContentPolicy};
if(!b.contentPolicy)throw Error("XssHtmlValidator cannot perform validation without a ContentPolicy instance.");var d=c.sanitizeOptions;return Promise.resolve(b).then(function(b){return a._escape(b)}).then(function(b){return a._sanitize(b,d)}).then(function(b){return a._runUrisThroughContentPolicy(b)}).then(function(b){return a._applyUris(b)}).then(function(b){return a._unescape(b)}).then(function(a){return{validatedValue:a.html}})};f.prototype._escape=function(e){e.html=e.html.split(this._tokenLeft).join(this._tokenLeftEscaped);
e.html=e.html.split(this._tokenRight).join(this._tokenRightEscaped);return e};f.prototype._sanitize=function(e,c){var a=this;void 0===c&&(c={});var b=c?c.uriTransformer:null;c.uriTransformer=function(d,g){b&&(d=b(d,g),g.uri=d);if(c.allowArbitraryHyperlinks&&g.type===k.UriType.NavigableLink)return d;e.uris.push(g);return a._tokenize(e.uris.length-1)};e.html=k.sanitize(e.html,c);return e};f.prototype._runUrisThroughContentPolicy=function(e){return this._contentPolicy?this._contentPolicy.screenUris(e.uris).then(function(c){return e}):
e.contentPolicy.screenUris(e.uris).then(function(c){return e})};f.prototype._applyUris=function(e){var c=this;e.uris.forEach(function(a,b){var d=c._tokenize(b);e.html=e.html.replace(d,a.uri)});return e};f.prototype._unescape=function(e){e.html=e.html.split(this._tokenLeftEscaped).join(this._tokenLeft);e.html=e.html.split(this._tokenRightEscaped).join(this._tokenRight);return e};f.prototype._tokenize=function(e){return this._tokenLeft+e.toString()+this._tokenRight};return f}();f.XssHtmlValidator=h});
define("infrastructure/project/BaseMapLayer",["require","exports"],function(h,f){});
define("infrastructure/project/ProjectFilter","require exports infrastructure/webMap/WebMapFilter infrastructure/validation/NumberValidator infrastructure/validation/SiteUrlValidator infrastructure/validation/ServiceDiscoveryUrlValidator infrastructure/validation/XssHtmlValidator infrastructure/project/ProjectConverter infrastructure/KmlFeature infrastructure/webMap/WebMapConverter infrastructure/webMap/OperationalLayer geocortex/essentials/MapServiceConstants".split(" "),function(h,f,k,l,e,c,a,b,
d,g,m,q){h=function(){function f(b){var d=this;this._numberValidator=new l.NumberValidator;this._xssHtmlValidator=new a.XssHtmlValidator;this.baseMapLayer=function(a){a=d._getUrlValidator(a);return $.extend({},d._webMapFilter.baseMapLayer,d._serviceLayerCommon,{url:a,templateUrl:a,gcxMapServiceDefinition:$.extend({},d._serviceLayerCommon.gcxMapServiceDefinition,{url:a,serviceUrl:a,tileRestUrl:a,mapUrl:a})})};this.layer=function(a){a=d._getUrlValidator(a);return $.extend({},d._webMapFilter.layer,{serviceLayer:function(){return d.serviceLayer},
layerDefinition:d.layerDefinition,featureSet:function(){return d.featureSet},isDynamic:!0,layerStyleId:!0,isUserCreated:!0,userLayerType:!0,layerUrl:a,legendUrl:a,gcxLayerDefinition:{id:!0,name:d._xssHtmlValidator,url:a,defaultVisibility:!0,visible:!0,displayName:d._xssHtmlValidator,description:!0,featureType:!0,featureZoomScale:!0,featureZoomFactor:!0,hasAttachments:!0,nativeID:!0,parentLayerId:!0,subLayerIds:!0,styleName:!0,legendUrl:a,isDynamic:!0,dynamicDefinition:!0,defaultDateFormat:!0,defaultNumberFormat:!0,
timeZoneId:!0,fullExtent:!0,drawIndex:!0,identifiable:!0,includeInLayerList:!0,includeInLegend:!0,isExpanded:!0,featureBorderColor:!0,featureBorderWidth:!0,featureFillColor:!0,minScale:d._numberValidator,maxScale:d._numberValidator,queryable:!0,searchable:!0,snappable:!0,snappingEnabled:!0,showFeatureHyperlinks:!0,canToggleLabels:!0,showLabels:!0,showMapTips:!0,supportsIdentify:!0,supportsQuery:!0,type:!0,fields:!0,primaryKeyField:!0,displayField:!0,catalogId:d.object,isUserCreated:!0,userLayerType:!0,
featureDescription:!1,featureLongDescription:!1,featureLabel:!1,featureHyperlinks:!1,layerHyperlinks:!1,relationships:!1,dataLinks:!1,reports:!1,charts:!1}})};this.operationalLayer=function(a){a=d._getUrlValidator(a);return $.extend({},d._webMapFilter.operationalLayer,d._serviceLayerCommon,{layers:{item:function(){return d.layer}},featureCollection:d.featureCollection,layerDefinition:d.layerDefinition,url:a,gcxMapServiceDefinition:$.extend({},d._serviceLayerCommon.gcxMapServiceDefinition,{url:a,serviceUrl:a,
tileRestUrl:a,mapUrl:a})})};this.serviceLayer=function(a){return $.extend({},d.operationalLayer(a),d.baseMapLayer(a))};this.object=function(a){if(!a||"object"!==typeof a)return!0;switch(a[g.CONVERSION_TYPE_PROPERTY]){case g.ConversionType.GCX_MAP_SERVICE:case g.ConversionType.ESRI_LAYER:return function(){return d.serviceLayer};case g.ConversionType.GCX_LAYER:return function(){return d.layer};case g.ConversionType.GCX_FEATURE_SET:case g.ConversionType.ESRI_FEATURE_SET:return function(){return d.featureSet};
case g.ConversionType.GCX_FEATURE:case g.ConversionType.ESRI_GRAPHIC:return function(){return d.feature};case g.ConversionType.ESRI_GEOMETRY:return d.geometry;case g.ConversionType.ESRI_SYMBOL:return d.symbol;case g.ConversionType.ESRI_RENDERER:return d.renderer;case g.ConversionType.ESRI_SPATIAL_REFERENCE:return d.spatialReference}var b={},c=0;for(a=Object.keys(a);c<a.length;c++)b[a[c]]=d.object;return b};this.app=b;this._urlValidator=new e.SiteUrlValidator(b);this._serviceDiscoveryUrlValidator=
new c.ServiceDiscoveryUrlValidator(b);this._webMapFilter=new k.WebMapFilter(b);this._xssHtmlValidator=new a.XssHtmlValidator(b.defaultContentPolicy)}Object.defineProperty(f.prototype,"baseMap",{get:function(){return this._webMapFilter.baseMap},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"bookmark",{get:function(){return this._webMapFilter.bookmark},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"color",{get:function(){return this._webMapFilter.color},enumerable:!0,
configurable:!0});Object.defineProperty(f.prototype,"coordinateSystem",{get:function(){this._coordinateSystem||(this._coordinateSystem={wkid:this._numberValidator,wkt:!0,output:!0});return this._coordinateSystem},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"domain",{get:function(){return this._webMapFilter.domain},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"inheritedDomain",{get:function(){return this._webMapFilter.inheritedDomain},enumerable:!0,configurable:!0});
Object.defineProperty(f.prototype,"rangeDomain",{get:function(){return this._webMapFilter.rangeDomain},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"codedValueDomain",{get:function(){return this._webMapFilter.codedValueDomain},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"drawingInfo",{get:function(){this._drawingInfo||(this._drawingInfo=$.extend({},this._webMapFilter.drawingInfo,{showLabels:!0,clustering:{radius:this._numberValidator,backgroundColor:this.color,
labelColor:this.color,maximumFeatures:this._numberValidator,enabled:!0},labelingInfo:{item:{fieldInfos:{item:this.object},labelExpression:!0,labelExpressionInfo:this.object,labelPlacement:!0,maxScale:this._numberValidator,minScale:this._numberValidator,sizeInfo:this.object,symbol:{align:!0,angle:this._numberValidator,color:{a:this._numberValidator,b:this._numberValidator,g:this._numberValidator,r:this._numberValidator},decoration:!0,font:{decoration:!0,family:!0,size:this._numberValidator,style:!0,
variant:!0,weight:!0},haloColor:{a:this._numberValidator,b:this._numberValidator,g:this._numberValidator,r:this._numberValidator},haloSize:!0,horizontalAlignment:!0,kerning:!0,rotated:!0,text:!0,type:!0,verticalAlignment:!0,xoffset:this._numberValidator,yoffset:this._numberValidator},useCodedValues:!0,where:!0}}}));return this._drawingInfo},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"feature",{get:function(){var a=this;this._feature||(this._feature=$.extend({},this._webMapFilter.feature,
{id:!0,layer:function(){return a.layer},featureLayer:function(){return a.serviceLayer},featureSet:function(){return a.featureSet},allowUnsafeContent:!0,extendedProperties:this.object,defaultNumberFormat:this._xssHtmlValidator,defaultDateFormat:this._xssHtmlValidator,timeZoneId:!0,displayTimeZoneId:!0,borderColor:this.color,fillColor:this.color,borderWidth:!0,attributes:this.object}),this._feature[b.PROPERTY_MEASUREMENT_ID]=!0,this._feature[b.PROPERTY_HIGHLIGHT_ID]=!0,this._feature[d.isKmlProperty]=
!0);return this._feature},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"featureCollection",{get:function(){this._featureCollection||(this._featureCollection=$.extend({},this._webMapFilter.featureCollection,{layers:{item:this.layer}}));return this._featureCollection},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"featureSet",{get:function(){var a=this;this._featureSet||(this._featureSet=$.extend({},this._webMapFilter.featureSet,{id:!0,features:{item:function(){return a.feature}},
allowUnsafeContent:!0,extendedProperties:this.object,layer:function(){return a.layer},displayName:this._xssHtmlValidator,iconUri:this._urlValidator}));return this._featureSet},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"featureSetCollection",{get:function(){var a=this;this._featureSetCollection||(this._featureSetCollection={id:!0,displayName:this._xssHtmlValidator,featureSets:{item:function(){return a.featureSet}},sourceName:!0,tag:this.object,extendedProperties:this.object});
return this._featureSetCollection},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"field",{get:function(){return this._webMapFilter.field},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"geometry",{get:function(){return this._webMapFilter.geometry},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"graphic",{get:function(){this._graphic||(this._graphic=$.extend({},this._webMapFilter.feature),this._graphic[b.PROPERTY_MEASUREMENT_ID]=!0,this._graphic[b.PROPERTY_HIGHLIGHT_ID]=
!0,this._graphic[d.isKmlProperty]=!0);return this._graphic},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"point",{get:function(){return this._webMapFilter.point},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"multiPoint",{get:function(){return this._webMapFilter.multiPoint},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"polyline",{get:function(){return this._webMapFilter.polyline},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,
"polygon",{get:function(){return this._webMapFilter.polygon},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"extent",{get:function(){return this._webMapFilter.extent},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"layerDefinition",{get:function(){this._layerDefinition||(this._layerDefinition=$.extend({},this._webMapFilter.layerDefinition,{drawingInfo:this.drawingInfo}));return this._layerDefinition},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,
"renderer",{get:function(){return this._webMapFilter.renderer},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"simpleRenderer",{get:function(){return this._webMapFilter.simpleRenderer},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"uniqueValueRenderer",{get:function(){return this._webMapFilter.uniqueValueRenderer},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"classBreaksRenderer",{get:function(){return this._webMapFilter.classBreaksRenderer},
enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"heatmapRenderer",{get:function(){return this._webMapFilter.heatmapRenderer},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"spatialReference",{get:function(){return this._webMapFilter.spatialReference},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"symbol",{get:function(){return this._webMapFilter.symbol},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"simpleMarkerSymbol",{get:function(){return this._webMapFilter.simpleMarkerSymbol},
enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"simpleLineSymbol",{get:function(){return this._webMapFilter.simpleLineSymbol},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"simpleFillSymbol",{get:function(){return this._webMapFilter.simpleFillSymbol},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"pictureMarkerSymbol",{get:function(){return this._webMapFilter.pictureMarkerSymbol},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,
"pictureFillSymbol",{get:function(){return this._webMapFilter.pictureFillSymbol},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"textSymbol",{get:function(){return this._webMapFilter.textSymbol},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"template",{get:function(){return this._webMapFilter.template},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"type",{get:function(){return this._webMapFilter.type},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,
"_serviceLayerCommon",{get:function(){var a=this;return{layers:{item:function(){return a.layer}},isUserCreated:!0,userLayerType:!0,gcxMapServiceDefinition:{id:!0,url:this._urlValidator,serviceUrl:this._urlValidator,tileRestUrl:this._urlValidator,mapUrl:this._urlValidator,subDomains:{item:!0},serviceType:!0,serviceFunction:!0,displayName:this._xssHtmlValidator,shortDisplayName:!0,baseMapGroup:!0,baseMapGroupIndex:!0,baseMapGroupIsMutuallyExclusive:!0,description:!0,copyright:!0,hasAttributionData:!0,
visible:!0,disableClientCaching:!0,opacity:this._numberValidator,instantSearch:!0,format:!0,isExpanded:!0,serverVersion:!0,failureAction:!0,tileMatrixSet:!0,requestEncoding:!0,operationalSpatialReference:!0,minScale:this._numberValidator,maxScale:this._numberValidator,identifiable:!0,includeCatalogItems:!0,includeMosaicDatasetValues:!0,defaultDateFormat:!0,defaultNumberFormat:!0,tileInfo:!0,includeInLayerList:!0,drawingBehavior:!0,featureClustering:{enabled:!0,userCanToggle:!0,radius:this._numberValidator,
maximumFeatures:this._numberValidator,backgroundColor:this.color,labelColor:this.color},featureHeatMap:{enabled:!0,userCanToggle:!0,respectScaleRange:!0,gradient:!0,offset:{item:this._numberValidator},intensity:this._numberValidator,field:!0,defaultRenderer:this.renderer,defaultMinScale:this._numberValidator,defaultMaxScale:this._numberValidator,includeInLegend:!0},catalogId:this.object,isUserCreated:!0,userLayerType:!0,dataProvider:!0,timeZoneId:!0,startTime:!0,endTime:!0,supportsDynamicLayers:!0,
hasLayerCatalog:!0,updateInterval:this._numberValidator,layerOptions:!1,layerHyperlinks:!1,attributionDataUrl:!1}}},enumerable:!0,configurable:!0});f.prototype._getUrlValidator=function(a){var b=this._urlValidator;this._getUserLayerType(a)===q.UserLayerType.LAYER_ADDITION&&(b=this._serviceDiscoveryUrlValidator);return b};f.prototype._getUserLayerType=function(a){if(a){if(a.isUserCreated&&void 0!=a.userLayerType)return a.userLayerType;var b=void 0,b=a.serviceLayer?a.serviceLayer:a;if(this._isLayerCatalogService(b))return q.UserLayerType.LAYER_CATALOG;
if(this._isFeatureCollection(b)||this._isKmlLayer(b))return q.UserLayerType.UPLOAD}return null};f.prototype._isFeatureCollection=function(a){return a&&a.featureCollection&&a.featureCollection.layers&&1===a.featureCollection.layers.length&&!!a.featureCollection.layers[0].featureSet};f.prototype._isKmlLayer=function(a){return a&&a.type===m.OperationalLayerType.KML};f.prototype._isLayerCatalogService=function(a){return a&&a.gcxMapServiceDefinition&&a.gcxMapServiceDefinition.catalogId};return f}();f.ProjectFilter=
h});define("infrastructure/project/Project",["require","exports"],function(h,f){});
define("infrastructure/ShellUtils",["require","exports"],function(h,f){function k(f,e,c,a){var b=this;void 0===a&&(a=200);var d=-1,g=[],m=function(){d=setTimeout(function(){d=null;for(var a=g.length-1;0<=a;a--){var b=g[a];f.event(b.eventName).unsubscribe(b.subscriptionToken);g.pop()}e()},a)};c.forEach(function(a){var c=f.event(a).subscribe(b,function(){null!==d&&(clearTimeout(d),m())});g.push({eventName:a,subscriptionToken:c})});m()}f.debounceViewEvents=function(f,e,c){void 0===c&&(c=400);k(f,e,"ViewInitializedEvent ViewActivatedEvent ViewDeactivatedEvent ViewDimensionsChangedEvent ViewHostedEvent ViewUnhostedEvent ApplicationResizeEvent".split(" "),
c)};f.debounceEvents=k;f.hasClass=function(f,e){return RegExp("(\\s|^)"+e+"(\\s|$)").test(f.className)}});
define("infrastructure/ObjectFilter",["require","exports","infrastructure/PromiseUtils"],function(h,f,k){(function(f){function e(a,b,d,g){if("object"===typeof a&&d.has(a))return Promise.resolve(d.get(a));for(;"function"===typeof b;)b=b(a,g);return b&&"function"===typeof b.validate?b.validate(a,g).then(function(a){return a.validatedValue}):"object"===typeof b&&"object"===typeof a?c(a,b,d,g):!0===b?Promise.resolve(a):Promise.reject(f.FILTERED)}function c(a,b,d,c){if(!a)return Promise.resolve(a);if(d.has(a))return d.get(a);
for(var m;"function"===typeof b;)b=b(a,c);if("object"===typeof b)if(Array.isArray(a))m=k.PromiseUtils.mapSkipRejected(a,function(a){return e(a,b.item,d,c)}),d.set(a,m);else{var f={};d.set(a,f);m=k.PromiseUtils.mapSkipRejected(Object.keys(b),function(m){if(m in a)return e(a[m],b[m],d,c).then(function(a){f[m]=a})})["return"](f)}else m=e(a,b,d);return m}f.FILTERED={};f.filter=function(a,b,d){if(!b)return Promise.reject(Error("Filter required."));var g=new WeakMap;return c(a,b,g,d)}})(f.ObjectFilter||
(f.ObjectFilter={}))});
define("infrastructure/project/ProjectManager","require exports infrastructure/project/ProjectConverter infrastructure/project/ProjectFilter infrastructure/ShellUtils infrastructure/MapUtils geocortex/framework/utils/utils infrastructure/UrlUtilities infrastructure/Dictionary infrastructure/PromiseUtils infrastructure/ObjectFilter geocortex/essentials/serviceDiscovery/SiteServiceDiscoveryProvider geocortex/essentials/MapServiceConstants infrastructure/webMap/WebMapConverter".split(" "),function(h,
f,k,l,e,c,a,b,d,g,m,q,n,p){f.PROJECT_TYPE="gvh-project";f.SITE_ID_PROPERTY_NAME="siteID";f.VIEWER_ID_PROPERTY_NAME="viewerID";f.PROJECT_QUERY_STRING_KEY="project";f.VIEWER_QUERY_STRING_KEY="viewer";h=function(){function h(a){this._serviceDiscovery=null;if(!a)throw Error("ProjectManager: Parameter 'app' is required.");this.app=a;this.convert=new k.ProjectConverter(a);this.filter=new l.ProjectFilter(a)}h.prototype.createEmpty=function(a){var b={};b[f.SITE_ID_PROPERTY_NAME]={string:this.app.site.id};
b[f.VIEWER_ID_PROPERTY_NAME]={string:this.app.configModel.viewerId};return{title:a,fileType:f.PROJECT_TYPE,contentType:"application/json",content:{moduleState:{}},properties:b}};h.prototype.create=function(a){a=this.createEmpty(a);return this.update(a)["return"](a)};h.prototype.update=function(a){return this._exportState().then(function(b){a.content=b})};h.prototype.remove=function(a){var b=this;if(!a)throw Error('RemoveProject: parameter "project" is required.');var d=this.getProjectID(a);return this.app.waitUntilSiteInitialized().then(function(){return b.app.event("ProjectDeletingEvent").publish(d)}).then(function(){return b.app.site.documentStore.deleteById(d)}).then(function(){b.current&&
b.current.id===d&&(b.current=null)}).then(function(){b.app.event("ProjectDeletedEvent").publish(d)})["catch"](function(a){b.app.event("ProjectErrorEvent").publish(null,a);var d=b._getResource("language-project-error-title"),c=b._getResource("language-project-error-delete");a&&"writer denied"===a.formalCode&&(c=b._getResource("language-project-error-delete-denied"));b.app.command("Alert").execute(c,d);throw a;})};h.prototype.save=function(a,b){var d=this;void 0===b&&(b=!0);if(!a)throw Error('SaveProject: parameter "project" is required.');
return this.app.waitUntilSiteInitialized().then(function(){return d.app.event("ProjectSavingEvent").publish(a)}).then(function(){return b?(new Promise(function(a,b){return e.debounceViewEvents(d.app,function(){return a()})})).then(function(){return d.update(a)}).then(function(){return c.getThumbnailUri(d.app)}).then(function(b){return a.thumbnail={location:b}})["catch"](function(b){d.app.event("ProjectErrorEvent").publish(a,b);var c=d._getResource("language-project-error-title"),g=d._getResource("language-project-error-write");
d.app.command("Alert").execute(g,c);throw b;}):Promise.resolve()}).then(function(){return d.write(a)}).then(function(b){return dojo.mixin(a,b)}).then(function(){return d.app.event("ProjectSavedEvent").publish(a)})};h.prototype.load=function(a){var b=this;if(!a)throw Error('LoadProject: parameter "project" is required.');var d=this.getProjectID(a);this.app.event("ProjectLoadingEvent").publish(d);"object"===typeof a&&void 0===a.content&&(a=d);return this.getProject(a).then(function(a){return b._beginLoad(a)}).then(function(){if(b.current&&
b.current.content)return b._applyState(b.current.content)}).then(function(){return b._finishLoad()})["catch"](function(a){b.isLoading=!1})};h.prototype.write=function(b){var d=this;if(!b)throw Error('ProjectManager.write: Parameter "project" is required.');b.content&&b.content.isDecoded&&this.encodeReferences(b.content);return this.app.waitUntilSiteInitialized().then(function(){return a.isNullOrUndefined(b.id)?d.app.site.documentStore.add(b).then(function(a){b.id=a.id;return a}):d.app.site.documentStore.updateById(b.id,
b)})["catch"](function(a){d.app.event("ProjectErrorEvent").publish(b,a);var c=d._getResource("language-project-error-title"),g=d._getResource("language-project-error-write");!a||"writer denied"!==a.formalCode&&"create denied"!==a.formalCode||(g=d._getResource("language-project-error-write-denied"));d.app.command("Alert").execute(g,c);throw a;})};h.prototype.read=function(a,d){var c=this;void 0===d&&(d=!0);if(!a)throw Error('ProjectManager.read: parameter "id" is required.');return this.app.waitUntilSiteInitialized().then(function(){return c.app.site.documentStore.getById(a,
d)}).then(function(a){return a?(c.decodeReferences(a.content),c._filterApplicationState(a.content).then(function(b){a.content=b;return a})):a})["catch"](function(d){c.app.event("ProjectErrorEvent").publish(null,d);var g=c._getResource("language-project-error-title"),e=c._getResource("language-project-error-read");if(d&&"item missing"===d.formalCode)e=c._getResource("language-project-error-read-not-found").format(a);else if(d&&"reader denied"===d.formalCode){e=c._getResource("language-project-error-read-denied");
if(c.app.command("SignIn").canExecute(null))throw e=c._getResource("language-project-error-sign-in-required"),c.app.command("Confirm").execute(e,g,function(a){a?c.app.command("SignIn").execute(null):window.location.assign(b.removeQueryParameter(window.location.href,"project"))},{okLabel:c._getResource("language-project-sign-in")}),d;e=c._getResource("language-project-error-read-denied")}c.app.command("Alert").execute(e,g);throw d;})};h.prototype.getProject=function(a,b){void 0===b&&(b=!0);if(!a)throw Error('ProjectManager.getProject: parameter "project" is required.');
return"string"===typeof a?this.app.project.read(a,b):Promise.resolve(a)};h.prototype.getProjectID=function(a){if(!a)throw Error('ProjectManager.getProjectID: parameter "project" is required.');return"string"===typeof a?a:a.id};h.prototype.getProjectUrl=function(a){if(!a||!a.id)return null;var c=this.getSiteID(a);if(!c)throw Error("ProjectManager.getProjectUrl: project siteId is null or undefined.");var g=this.getViewerID(a);if(!g)throw Error("ProjectManager.getProjectUrl: project viewerId is null or undefined.");
var e=window.location.href;-1<e.indexOf("?")?e=e.substring(0,e.indexOf("?")):-1<e.indexOf("#")&&(e=e.substring(0,e.indexOf("#")));var m=new d.Dictionary;"unknown"!==g&&(c=encodeURIComponent("{0}.{1}".format(c,g)),m.set(f.VIEWER_QUERY_STRING_KEY,c));m.set(f.PROJECT_QUERY_STRING_KEY,encodeURIComponent(a.id));return"{0}{1}".format(e,b.queryStringDictionaryToString(m))};h.prototype.getSiteID=function(a){if(!a)throw Error('ProjectManager.getSiteID: parameter "project" is required.');return a.properties?
(a=a.properties[f.SITE_ID_PROPERTY_NAME])?a.string:null:null};h.prototype.getViewerID=function(a){if(!a)throw Error('ProjectManager.getViewerID: parameter "project" is required.');return a.properties?(a=a.properties[f.VIEWER_ID_PROPERTY_NAME])?a.string:null:null};h.prototype.validateProjectOwnership=function(a){return this.app.site.documentStore.isOwner(a)?Promise.resolve(a):Promise.reject(this._getResource("language-project-error-owner"))};h.prototype._initializeDiscoveryProvider=function(){var a=
this;return this._serviceDiscovery?Promise.resolve():this.app.waitUntilSiteInitialized().then(function(){var b=a.app.site,d=new q.SiteServiceDiscoveryProvider;d.initialize(b);a._serviceDiscovery=d})};h.prototype._validateAgainstServiceDiscovery=function(a){var b=this,d={mapService:a,trusted:!1};return a.isUserCreated&&a.userLayerType===n.UserLayerType.LAYER_ADDITION?this._initializeDiscoveryProvider().then(function(){return b._serviceDiscovery.findServices(a.serviceUrl)}).then(function(a){Array.isArray(a)&&
a.some(function(a){return!!a.isWhitelisted})?d.trusted=!0:d.trusted=!1;return d})["catch"](function(){d.trusted=!1;return d}):(d.trusted=!0,Promise.resolve(d))};h.prototype._excludeUnsafeState=function(){var a=this;return Promise.map(this.app.site.essentialsMap.mapServices,function(b){return a._validateAgainstServiceDiscovery(b)}).then(function(b){for(var d=0;d<b.length;d++){var c=b[d];c.trusted||a.convert.exclude(c.mapService,p.ConversionType.GCX_MAP_SERVICE)}})};h.prototype._exportState=function(){var a=
this;this.convert.clearCache();return this._excludeUnsafeState().then(function(){var b=a._getModules(),d={};Object.keys(b).forEach(function(a){d[a]=Promise["try"](function(){return b[a].exportState()})});return g.PromiseUtils.propsSkipRejected(d)}).then(function(b){for(var d in b)b[d]||delete b[d];b={mapScale:a.app.map.getScale(),mapCenter:a.convert.fromEsriGeometry(a.app.map.extent.getCenter()),moduleState:b};return a._filterApplicationState(b)}).then(function(b){a.encodeReferences(b);return b})};
h.prototype._applyState=function(a){var b=this;if(!a)return Promise.resolve();this.decodeReferences(a);var d=a.moduleState||[];return Promise.map(Object.keys(d),function(a){var c=b._getModules()[a];if(c){var g=d[a];g.serialVersion||(g.serialVersion=1);return Promise["try"](function(){return c.applyState(g)})["catch"](function(d){return b.app.trace.warning('Unable to restore project state for module "{0}": {1}'.format(a,d))})}})["return"]()};h.prototype._applyMapExtent=function(a){this.app.site.essentialsMap.extentManager.setScaleWithPriority(a.content.mapScale,
Number.MAX_VALUE);a=this.convert.toEsriGeometry(a.content.mapCenter);this.app.site.essentialsMap.extentManager.centerAtWithPriority(a,Number.MAX_VALUE)};h.prototype._getResource=function(a){return this.app.getResource("Mapping.Infrastructure",a)};h.prototype._getModules=function(){return this.app.moduleManager._modules};h.prototype._beginLoad=function(a){var b=this;return this.app.waitUntilSiteInitialized().then(function(){if(b.isLoading)throw Error("Cannot load a new project until the current project has finished loading.");
var d=b.getSiteID(a);if(b.app.site.id!==d)throw Error('The project "{0}" was created for the Essentials site ID "{1}" and is not compatible with this site.'.format(a.title,d));b.convert.clearCache();b.isLoading=!0;b.current=a;b._applyMapExtent(a)})};h.prototype._finishLoad=function(){var a=this;setTimeout(function(){return a._applyMapExtent(a.current)},150);this.app.event("ProjectLoadedEvent").publish(this.current);this.isLoading=!1};h.prototype._filterApplicationState=function(a){var b=this,d={mapCenter:this.filter.point,
mapScale:!0,moduleState:{},isDecoded:!0},c=this._getModules();return Promise.map(Object.keys(c),function(g){var e=c[g];e&&(e=e.getStateFilter(),a.moduleState[g]&&!e?b.app.trace.warning('Module "{0}" has project state, but has no defined state filter. A module that participate in projects must implement ModuleBase.getStateFilter().'.format(g)):("object"===typeof e&&(e=$.extend({},e,{serialVersion:!0})),d.moduleState[g]=e))}).then(function(){return m.ObjectFilter.filter(a,d,{XssHtmlValidator:{defaultContentPolicy:b.app.defaultContentPolicy}})})};
h.prototype.encodeReferences=function(a){if(a){var b=RegExp("~","g"),d=new WeakMap,c=[],g=function(a){Array.isArray(a)||d.set(a,"~"+c.join("~"));for(var e=0,m=Object.keys(a);e<m.length;e++){var f=m[e],n=a[f];if(n&&"object"===typeof n){var q=d.get(n);q?a[f]=q:(c.push((f+"").replace(b,"\\x7e")),g(n),c.pop())}else n&&"string"===typeof n&&n.startsWith("~")&&(a[f]=n.replace("~","\\x7e"))}};g(a);delete a.isDecoded}};h.prototype.decodeReferences=function(a){if(a&&!a.isDecoded){var b=RegExp("\\x7e".replace("\\",
"\\\\"),"g"),d=new WeakMap,c=function(g){if(!d.has(g)){d.set(g,!0);for(var e=0,m=Object.keys(g);e<m.length;e++){var f=m[e],n=g[f];if(n&&"string"===typeof n)if(n.startsWith("~")){for(var n=n.split("~").map(function(a){return a.replace(b,"~")}),q=a,l=1;l<n.length;l++){var h=n[l];h&&q&&(q=q[h])}g[f]=q}else n.startsWith("\\x7e")&&(g[f]=n.replace("\\x7e","~"));else n&&"object"===typeof n&&c(n)}}};c(a);a.isDecoded=!0}};return h}();f.ProjectManager=h});
define("infrastructure/webMap/BaseMap",["require","exports"],function(h,f){});define("infrastructure/webMap/Bookmark",["require","exports"],function(h,f){});define("infrastructure/webMap/WebMap",["require","exports"],function(h,f){});
define("infrastructure/webMap/WebMapManager","require exports infrastructure/webMap/WebMapConverter infrastructure/webMap/WebMapFilter geocortex/essentials/MapServiceConstants infrastructure/ArrayUtils infrastructure/GraphicsLayerUtils".split(" "),function(h,f,k,l,e,c,a){h=function(){function b(a){if(!a)throw Error("ProjectManager: Parameter 'app' is required.");this.app=a;this.convert=new k.WebMapConverter(a);this.filter=new l.WebMapFilter(a)}b.prototype.create=function(){var b=this;if(!this.app.site||
!this.app.site.isInitialized)throw Error("WebMapConverter.fromCurrentMap: The Essentials site for this application is missing or not yet initialized.");this.convert.clearCache();var g=this.app.site.essentialsMap,m=function(a,b){console.warn('Unable to convert map service "{0}" to web map format: {1}'.format(a.displayName,b))},f=e.MapServiceFunction,n=g.mapServices.filter(function(a){return a.mapServiceFunction===f.OPERATIONAL}).reverse(),l=c.ArrayUtils.mapWithErrorCallback(n,function(a){return b.convert.fromGcxMapService(a)},
m);a.getGraphicsLayersExceptExcluded(this.app,[a.ExcludeFromEnum.WebMapName]).filter(function(a){return 0<a.graphics.length}).forEach(function(a){try{l.push(b.convert.fromEsriLayer(a))}catch(c){console.warn('Unable to convert graphics layer "{0}" to web map format: {1}'.format(a.id,c))}});var h=g.mapServices.filter(function(a){return a.isVisible()&&a.mapServiceFunction===f.BASE}).reverse(),k="",t=c.ArrayUtils.mapWithErrorCallback(h,function(a){return b.convert.fromGcxMapService(a)},m);h.length&&(g=
g.baseMaps.filter(function(a){return h.every(function(b){return a.services.some(function(a){return a.mapService===b})})}),k=1===g.length?g[0].displayName:h[h.length-1].displayName);t.length||(k="Light Gray Canvas",t[0]={id:"World_Light_Gray_Base_1486",layerType:"ArcGISTiledMapServiceLayer",opacity:1,visibility:!0,url:"http://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer"});return this.app.bookmarks["export"]().then(function(a){return{operationalLayers:l,baseMap:{title:k,
baseMapLayers:t},bookmarks:a,version:"1.7"}})};return b}();f.WebMapManager=h});define("infrastructure/Bookmark",["require","exports"],function(h,f){});
define("infrastructure/BookmarkManager",["require","exports"],function(h,f){var k;(function(e){e[e.Site=0]="Site";e[e.User=1]="User";e[e.Project=2]="Project"})(k=f.BookmarkSource||(f.BookmarkSource={}));var l=function(){function e(c){this._projectBookmarks=[];if(!c)throw Error('Parameter "app" required.');this.app=c}e.prototype.getAll=function(){var c=this;return Promise.join(this.getSiteBookmarks(),this.getUserBookmarks()).spread(function(a,b){return(a||[]).concat(b).concat(c._projectBookmarks)})};
e.prototype.getUserBookmarks=function(){var c=this;return new Promise(function(a,b){c.app.store.get("bookmarks",function(b){var g=[];if(b)try{g=JSON.parse(b)}catch(e){c.app.trace.warning("Unable to parse user bookmarks: {0}".format(e))}b=g.map(function(a){return c._deserialize(a)});a(b)},b)})};e.prototype.getSiteBookmarks=function(){var c=this;return this.app.waitUntilSiteInitialized().then(function(){return(c.app.site.namedExtents||[]).map(function(a){return{name:a.displayName,extent:a.extent,source:k.Site}})})};
e.prototype.getProjectBookmarks=function(){return Promise.resolve(this._projectBookmarks)};e.prototype.add=function(c){var a=this;if(!c)throw Error('Parameter "bookmark" required.');c.source=c.source||k.User;return c.source===k.Project?(this._projectBookmarks.push(c),this.app.event("BookmarksModifiedEvent").publish(""),Promise.resolve()):this.getUserBookmarks().then(function(b){b.push(c);return a._save(b)})};e.prototype.remove=function(c){var a=this;if(c)return"string"===typeof c?this._projectBookmarks=
this._projectBookmarks.filter(function(a){return a.name!==c}):"object"===typeof c&&(this._projectBookmarks=this._projectBookmarks.filter(function(a){return a!==c})),this.getUserBookmarks().then(function(b){"string"===typeof c?b=b.filter(function(a){return a.name!==c}):"object"===typeof c&&(b=b.filter(function(a){return a!==c}));return a._save(b)})};e.prototype["export"]=function(c){var a=this;c=c||[k.Site,k.User,k.Project];return this.getAll().then(function(b){return b.filter(function(a){return 0<=
c.indexOf(a.source)}).map(function(b){return{name:b.name,extent:a.app.project.convert.fromEsriGeometry(b.extent)}})})};e.prototype._save=function(c){var a=this;return new Promise(function(b,d){var g=JSON.stringify((c||[]).map(function(b){return a._serialize(b)}));a.app.store.set("bookmarks",g,function(d,c){b();a.app.event("BookmarksModifiedEvent").publish(g)},d)})};e.prototype._serialize=function(c){return{displayName:c.name,extent:this.app.webMap.convert.fromEsriGeometry(c.extent),isUserDefined:!0}};
e.prototype._deserialize=function(c){return{name:c.displayName,extent:this.app.webMap.convert.toEsriGeometry(c.extent),source:k.User}};return e}();f.BookmarkManager=l});
define("Viewer","require exports geocortex/framework/application/Application geocortex/framework/observables infrastructure/accessibility/AccessibilityManager infrastructure/coordinates/CoordinatesManager infrastructure/FeatureSetManager infrastructure/search/SearchManager infrastructure/HighlightManager infrastructure/native/NativeManager infrastructure/offline/OfflineManager infrastructure/states/StateManager infrastructure/undo/UndoManager infrastructure/menus/MenuRegistry infrastructure/tools/ToolRegistry infrastructure/toolbarGroup/ToolbarGroupRegistry infrastructure/clickableGraphics/ClickableGraphicsRegistry infrastructure/project/ProjectManager infrastructure/webMap/WebMapManager infrastructure/BookmarkManager infrastructure/ContentPolicy infrastructure/FilterUtils geocortex/essentials/documents/DocumentStore infrastructure/FormatUtils infrastructure/GeometryUtils geocortex/essentials/OAuth2Client".split(" "),function(h,
f,k,l,e,c,a,b,d,g,m,q,n,p,s,r,t,u,v,y,x,w,A,z,B,C){h=function(f){function h(k,w,z,A){k=f.call(this,k,w,z,A)||this;k.version=eval("geocortex.essentialsHtmlViewer.version");k.markupLayer=new l.Observable;k.isArcGisWebApp=!1;k._workflowActivityDispatcher=null;k._activityTypeHandlerQueue=[];k._activityIdHandlerQueue=[];k._localeResourcesLoaded=!1;k._initialProjectPromise=null;k._momentLocales="af ar ar-MA ar-SA ar-TN az be bg bn bo br bs ca cs cv cy da de de-AT el en-AU en-CA en-GB eo es et eu fa fi fo fr fr-CA fy gl he hi hr hu hy-AM id is it ja jv ka km ko lb lt lv me mk ml mr ms ms-MY my nb ne nl nn pl pt pt-BR ro ru si sk sl sq sr sr-Cyrl sv ta th tl-PH tr tzl tzm tzm-Latn uk uz vi zh-CN zh-TW".split(" ");
k._globalizeLocales="af ar ar-MA ar-SA ar-TN az be bg bn bo br bs ca cs cy da de de-AT el en en-AU en-CA en-GB eo es et eu fa fi fo fr fr-CA fy gl he hi hr hu hy id is it ja ka km ko lb lt lv mk ml mr ms my nb ne nl nn pl pt ro ru si sk sl sq sr sr-Cyrl sv ta th tr tzm tzm-Latn uk uz vi zh".split(" ");k.___uaIsiPad=!!navigator.userAgent.match(/iPad/i);k.accessibilityManager=new e.AccessibilityManager(k);k.coordinatesManager=new c.CoordinatesManager(k);k.featureSetManager=new a.FeatureSetManager(k);
k.searchManager=new b.SearchManager(k);k.highlightManager=new d.HighlightManager(k);k.nativeManager=new g.NativeManager(k);k.offlineManager=new m.OfflineManager(k,"Mapping.Infrastructure");k.toolRegistry=new s.ToolRegistry(k);k.menuRegistry=new p.MenuRegistry(k);k.toolbarGroupRegistry=new r.ToolbarGroupRegistry(k);k.stateManager=new q.StateManager(k,"Mapping.Infrastructure");k.undoManager=new n.UndoManager(k);k.project=new u.ProjectManager(k);k.webMap=new v.WebMapManager(k);k.bookmarks=new y.BookmarkManager(k);
k.clickableGraphics=new t.ClickableGraphicsRegistry(k);k._applicationContentPolicy=new x.ContentPolicy(k);k._registerApplicationLevelCommands();return k}__extends(h,f);Object.defineProperty(h.prototype,"defaultContentPolicy",{get:function(){return this._applicationContentPolicy},enumerable:!0,configurable:!0});h.prototype.followNavigationLink=function(a){var b=a.element;if(this._applicationContentPolicy.tryScreenNavLinkSynchronously({uri:a.url,attribute:"href",tag:"a",type:w.UriType.NavigableLink,
linkChallengeCallback:function(a,d){if(a){var c="_blank";b&&b.hasAttribute("target")&&(c=b.getAttribute("target"));window.open(d.uri,c)}return!1}}))return!0;this._executeOpenWebPage(a);return!1};h.prototype._registerApplicationLevelCommands=function(){this.command("OpenWebPage").register(this,this._executeOpenWebPage)};h.prototype._executeOpenWebPage=function(a){var b="string"===typeof a?a:a.url,d="string"===typeof a?null:a.element?a.element:null;("string"===typeof a?0:a.isLink&&a.isLink)||(b=decodeURIComponent(b));
a=new dojo._Url(b);if(0>"http https ftp ftps gopher mailto arcgis-navigator comgooglemaps comgooglemaps-x-callback comgooglemapsurl".split(" ").indexOf(a.scheme))this.trace.warning("Could not open '"+b+"': Invalid URI scheme.");else{var c=function(a,b){var d="_blank";b&&b.hasAttribute("target")&&(d=b.getAttribute("target"));window.open(a,d)},b={uri:b,attribute:"href",tag:"a",type:w.UriType.NavigableLink,linkChallengeCallback:function(a,b){a&&c(b.uri,d);return!1}};if(this._applicationContentPolicy.hasFlag(1)||
this._applicationContentPolicy.tryScreenNavLinkSynchronously(b))return c(b.uri,d),!1;b.forcePrompt=!0;this._applicationContentPolicy.screenUris([b])}};h.prototype.initialize=function(){var a=this;document.all&&!document.querySelector&&(this.debugMode=!0);var b=this.configUri?this.configUri.split("/"):window.location.href.split("/"),b=b.slice(0,b.length-1).join("/")+"/";this.configTokens.ViewerConfigUri=b;this.getUrlParameter("gcxLocalServer")&&(this.localServerAddress=this.getUrlParameter("gcxLocalServer"));
this.getUrlParameter("gcxLocalServerNamespace")&&(this.localServerNamespace=this.getUrlParameter("gcxLocalServerNamespace"));this.getUrlParameter("gcxLocalServerToken")&&(this.localServerToken=this.getUrlParameter("gcxLocalServerToken"));this._offlineManagerLoaded=this.offlineManager.load();f.prototype.initialize.call(this);var d=this.getUrlParameter(u.PROJECT_QUERY_STRING_KEY);if(d){var c=this.getUrlParameter(A.LINK_QUERY_STRING_KEY);c&&this.waitUntilSiteInitialized().then(function(){return a.site.documentStore.setGuestLink(c)});
this.waitUntilAllLibrariesLoaded().then(function(){return a.event("ProjectLoadingEvent").publish(d)});this._initialProjectPromise=this.project.read(d).then(function(b){return a.project._beginLoad(b)})["catch"](function(b){a.trace.error("Error loading project: {0}".format(b.message),b)});var g=this.initialStateAppliedCallback;this.initialStateAppliedCallback=function(b){a.project.isLoading&&a.project._finishLoad();g&&g(b)}}};h.prototype.waitUntilSiteInitialized=function(){var a=this;return new Promise(function(b,
d){a.site&&a.site.isInitialized?b():(a.event("SiteInitializedEvent").once(a,function(a){b()}),a.event("SiteInitializationFailedEvent").once(a,function(a){d(a)}),a.event("SiteAuthorizationFailedEvent").once(a,function(a){d(a)}))})};h.prototype.waitUntilDocumentStoreInitialized=function(){var a=this;return this.waitUntilSiteInitialized().then(function(){return a.site.documentStore.onInitialized()})};h.prototype.waitUntilOfflineManagerLoaded=function(){return this._offlineManagerLoaded};h.prototype.waitUntilMapLoaded=
function(){var a=this;return new Promise(function(b,d){if(a.map&&a.map.loaded)b();else if(a.map)var c=a.map.on("load",function(a){c.remove();b()});else a.event("SiteInitializingEvent").once(a,function(){var d=a.map.on("load",function(a){d.remove();b()})})})};h.prototype.waitUntilServiceLayerLoaded=function(a){return new Promise(function(b,d){if(a.loadError)d(a.loadError);else if(a.loaded)b();else var c=a.on("load",function(a){c.remove();g.remove();b()}),g=a.on("error",function(a){c.remove();g.remove();
d(a.error)})})};h.prototype.waitUntilSiteServiceLayersLoaded=function(){var a=this;return new Promise(function(b,d){a.site&&a.site.serviceLayersLoaded?b():(a.event("SiteServiceLayersLoadedEvent").once(a,function(a){b()}),a.event("SiteInitializationFailedEvent").once(a,function(a){d(a)}),a.event("SiteAuthorizationFailedEvent").once(a,function(a){d(a)}))})};h.prototype.waitUntilAllLibrariesLoaded=function(){var a=this;return new Promise(function(b,d){if(a.allLibrariesLoaded)b();else a.event("ViewerLibrariesDownloadedEvent").once(a,
function(a){b()})})};h.prototype.waitUntilViewInitialized=function(a){var b=this;return new Promise(function(d,c){var g=b.viewManager.getViewById(a);if(g&&g.initiallyBound)d(g);else var e=b.event("ViewInitializedEvent").subscribe(b,function(c){c.id===a&&(d(c),b.event("ViewInitializedEvent").unsubscribe(e))})})};h.prototype.registerActivityTypeHandler=function(a,b){this._workflowActivityDispatcher?this._workflowActivityDispatcher.registerActivityHandler(a,b):this._activityTypeHandlerQueue.push({typeName:a,
handler:b})};h.prototype.registerActivityIdHandler=function(a,b){this._workflowActivityDispatcher?this._workflowActivityDispatcher.registerExternalIdHandler(a,b):this._activityIdHandlerQueue.push({id:a,handler:b})};h.prototype.getWorkflowActivityDispatcher=function(){return this._workflowActivityDispatcher};h.prototype.setWorkflowActivityDispatcher=function(a){this._workflowActivityDispatcher=a;for(a=0;a<this._activityTypeHandlerQueue.length;++a){var b=this._activityTypeHandlerQueue[a];this._workflowActivityDispatcher.registerActivityHandler(b.typeName,
b.handler)}for(a=this._activityTypeHandlerQueue.length=0;a<this._activityIdHandlerQueue.length;++a)b=this._activityIdHandlerQueue[a],this._workflowActivityDispatcher.registerExternalIdHandler(b.id,b.handler);this._activityIdHandlerQueue.length=0};h.prototype.shutdown=function(a){this.toolRegistry.clear();this.undoManager.destroy();this.clickableGraphics.clear();f.prototype.shutdown.call(this,a)};h.prototype.onConfigurationLoaded=function(a){var b=this,d=a.configuration,c=!0;if(d.hasOwnProperty("application")&&
d.application.hasOwnProperty("contentPolicy")){var g=d.application.contentPolicy;g.disableSecurityPrompt&&this._applicationContentPolicy.setFlag(1);!1===g.disablePromptOnImages&&(c=!1);!0===g.trustExactUrl&&this._applicationContentPolicy.setFlag(4)}c&&this._applicationContentPolicy.setFlag(2);this._applicationContentPolicy.screenUris([]);d&&d.hasOwnProperty("application")&&d.application.locale&&(this.locale=d.application.locale);this.urlParameters&&this.getUrlParameter("locale")&&(this.locale=this.getUrlParameter("locale"));
document.documentElement.setAttribute("lang",this.locale||"en-US");this._loadThirdPartyLocaleResources().then(function(){if($&&$.timepicker){var c=Object.getPrototypeOf($.timepicker);c._onTimeChange&&(c._base_onTimeChange=c._onTimeChange,c._onTimeChange=function(){this._base_onTimeChange();if(this._defaults&&this._defaults.gcxTimeFormat&&this.$timeObj){var a=z.formatDate($(this.$input).datepicker("getDate"),this._defaults.gcxTimeFormat);this.$timeObj.text(a)}this._defaults&&!0===this._defaults.gcxTimeStyle&&
((a=this.$timeObj?this.$timeObj.prevObject:null)&&1!==$(".info-message",a).length&&a.append("<div class='info-message'></div>"),a=a?$(".info-message",a):null)&&(a.text(this._defaults.timeText+": "+this.$timeObj.text()),this.$timeObj.css("display","none"),$(this.$timeObj.selector+"_label").css("display","none"))})}$&&$.datepicker&&$.datepicker._showDatepicker&&($.datepicker.__base_showDatepicker=$.datepicker._showDatepicker,$.datepicker._showDatepicker=function(a){this.__base_showDatepicker(a);a=$(a).siblings(".gcxDatepicker");
a.length&&a.focus()});d.hasOwnProperty("application")&&d.application.hasOwnProperty("geometryServiceUrl")&&(esri.config.defaults.geometryService=new esri.tasks.GeometryService(d.application.geometryServiceUrl));d.hasOwnProperty("application")&&d.application.hasOwnProperty("datumTransforms")?B.registerDatumTransforms(d.application.datumTransforms):B.registerDefaultDatumTransforms();a.configuration.application&&a.configuration.application.oAuth2ClientId&&!C.OAuth2Client.applicationHasImplicitGrant()&&
!C.OAuth2Client.applicationHasImplicitGrantError()?(C.OAuth2Client.redirectToLogOnPage(a.configuration.application.oAuth2AuthorizeUri||"http://www.arcgisonline.com/sharing/oauth2/authorize",a.configuration.application.oAuth2ClientId),b.abortInitialization=!0):f.prototype.onConfigurationLoaded.call(b,a)})};h.prototype.getInitialState=function(a,b){var d=this;return!this._initialProjectPromise||this._initialProjectPromise.isRejected()?Promise.resolve(null):this._initialProjectPromise.then(function(){var b=
d.project.current;return b&&b.content&&b.content.moduleState?b.content.moduleState[a]:null})};Object.defineProperty(h.prototype,"locale",{get:function(){return this._locale},set:function(a){this._locale=this._canonicalizeLocale(a);this._localeResourcesLoaded&&(moment.locale(this._getMomentLocaleForLocale(this._locale)),_globalize.locale(this._getGlobalizeLocaleForLocale(this._locale)))},enumerable:!0,configurable:!0});h.prototype.doWhenMapInitialized=function(a){var b=this;if(this.isArcGisWebApp)a();
else if(this.site&&this.site.isInitialized)a();else var d=this.eventRegistry.event("SiteServiceLayersLoadedEvent").subscribe(this,function(){b.eventRegistry.event("SiteServiceLayersLoadedEvent").unsubscribe(d);a()})};h.prototype._loadThirdPartyLocaleResources=function(){var a=this,b;"function"===typeof define&&(b=define.amd,delete define.amd);return Promise.all([this._loadMomentLocaleData(),this._loadGlobalizeLocaleData()]).then(function(){"function"===typeof define&&(define.amd=b);a._localeResourcesLoaded=
!0},function(a){"function"===typeof define&&(define.amd=b)})};h.prototype._loadMomentLocaleData=function(){var a=this,b=this._getMomentLocaleForLocale(this.locale);return moment.localeData(b)?Promise.resolve():new Promise(function(d,c){"en"===b?d():a.includeScript("./Resources/Scripts/moment/locale/"+b+".js",function(a){moment.locale(b);d()},c)})};h.prototype._loadGlobalizeLocaleData=function(){var a=this._getGlobalizeLocaleForLocale(this.locale);return this.fetchConfigResource({url:"./Resources/Scripts/globalize/locale/"+
a+".json"}).then(function(b){b=JSON.parse(b);_globalize.load(b);_globalize.locale(a)})};h.prototype._getMomentLocaleForLocale=function(a){return this._getBestMatchLocale(a,this._momentLocales)};h.prototype._getGlobalizeLocaleForLocale=function(a){return this._getBestMatchLocale(a,this._globalizeLocales)};h.prototype._getBestMatchLocale=function(a,b){a=this._canonicalizeLocale(a);var d=this._parseLocale(a);if(0<=b.indexOf(a))return a;if(d.script){a=d.language+"-"+d.script;if(0<=b.indexOf(a))return a;
a=d.language+"-"+d.territory;if(0<=b.indexOf(a))return a}else if(d.territory&&(a=d.language,0<=b.indexOf(a)))return a;return"en"};h.prototype._parseLocale=function(a){if(!a)throw Error("Invalid locale: {0}".format(a));var b=a.split("-");if(1>b.length||3<b.length||b.some(function(a){return 0===a.length}))throw Error("Invalid locale: {0}".format(a));a={language:b[0].toLowerCase()};2==b.length?2==b[1].length?a.territory=b[1].toUpperCase():a.script=b[1][0].toUpperCase()+b[1].slice(1).toLowerCase():3===
b.length&&(a.script=b[1][0].toUpperCase()+b[1].slice(1).toLowerCase(),a.territory=b[2].toUpperCase());return a};h.prototype._canonicalizeLocale=function(a){a=this._parseLocale(a);var b=a.language;a.script&&(b+="-"+a.script);a.territory&&(b+="-"+a.territory);return b};return h}(k.Application);f.ViewerApplication=h});
define("infrastructure/AreaOfInterestMask","require exports infrastructure/GeometryUtils geocortex/framework/utils/utils infrastructure/GraphicsLayerIds infrastructure/GraphicsLayerUtils".split(" "),function(h,f,k,l,e,c){h=function(){function a(a,d){this.app=a;this._enabled=!0;this.matchMapBackground=!1;this.fillColor=null;this.boundaryColor=new esri.Color("red");this.boundaryWidth=2;this.boundaryStyle=esri.symbol.SimpleLineSymbol.STYLE_SOLID;this.layerId=e.AOI_MASK_LAYER_ID}a.prototype.show=function(a){var d=
this;this._aoi=a;this.app.waitUntilSiteServiceLayersLoaded().then(function(){if(d._enabled){var c=d._getLayer();c.clear();(d.fillColor||d.boundaryStyle!==esri.symbol.SimpleFillSymbol.STYLE_NULL)&&c.show();if(d.fillColor){for(var e=new esri.geometry.Polygon(a.spatialReference),f=d.app.map.getLayer(d.app.map.layerIds[0]),f=k.toRing(f.fullExtent.expand(1.5)),n=0;n<a.rings.length;n++)e.rings.push(dojo.clone(a.rings[n]).reverse());e.rings.push(f);f=new esri.symbol.SimpleFillSymbol(esri.symbol.SimpleFillSymbol.STYLE_SOLID,
new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_NULL),d.fillColor);e=new esri.Graphic({geometry:e});e.setSymbol(f);d.app.map.graphics.add(e)}d.boundaryStyle!==esri.symbol.SimpleFillSymbol.STYLE_NULL&&(e=new esri.symbol.SimpleFillSymbol(esri.symbol.SimpleFillSymbol.STYLE_NULL,new esri.symbol.SimpleLineSymbol(d.boundaryStyle,d.boundaryColor,d.boundaryWidth),new esri.Color("white")),f=new esri.Graphic({geometry:a}),f.setSymbol(e),c.add(f));d.matchMapBackground&&d.fillColor&&(c=d._getMapNode(),
d._originalMapBackground=c.css("background-color"),c.css("background-color","rgba("+d.fillColor.r+","+d.fillColor.g+","+d.fillColor.b+","+d.fillColor.a+")"))}})};a.prototype.hide=function(){this._aoi=null;c.removeInternalGraphicsLayer(this.layerId,this.app,c.GraphicsLayerType.Pushpin);this.matchMapBackground&&this._getMapNode().css("background-color",this._originalMapBackground)};a.prototype.enable=function(){this._enabled=!0;this._aoi&&this.show(this._aoi)};a.prototype.disable=function(){this._enabled=
!1};a.prototype.configure=function(a){a&&(l.isNullOrUndefined(a.boundaryColor)||(this.boundaryColor=new esri.Color(a.boundaryColor)),l.isNullOrUndefined(a.boundaryWidth)||(this.boundaryWidth=a.boundaryWidth),l.isNullOrUndefined(a.boundaryStyle)||("null"==a.boundaryStyle?this.boundaryStyle=esri.symbol.SimpleLineSymbol.STYLE_NULL:"solid"==a.boundaryStyle?this.boundaryStyle=esri.symbol.SimpleLineSymbol.STYLE_SOLID:"dash"==a.boundaryStyle?this.boundaryStyle=esri.symbol.SimpleLineSymbol.STYLE_DASH:"dot"==
a.boundaryStyle&&(this.boundaryStyle=esri.symbol.SimpleLineSymbol.STYLE_DOT)),l.isNullOrUndefined(a.enabled)||(a.enabled?this.enable():this.disable()),l.isNullOrUndefined(a.fillColor)||(this.fillColor=new esri.Color(a.fillColor)),l.isNullOrUndefined(a.layerId)||(this.layerId=a.layerId),l.isNullOrUndefined(a.matchMapBackground)||(this.matchMapBackground=a.matchMapBackground))};a.prototype._getLayer=function(){return c.getInternalGraphicsLayer(this.layerId,this.app,c.GraphicsLayerType.Pushpin)};a.prototype._getMapNode=
function(){return $(".esriMapContainer").first().parent()};return a}();f.AreaOfInterestMask=h});
define("infrastructure/DistanceConverter",["require","exports","geocortex/essentials/DistanceUnit"],function(h,f,k){function l(c){if(c=e[c])return c;throw Error("Units cannot be converted because are not supported");}var e={};e[k.DistanceUnitType.METERS]=1;e[k.DistanceUnitType.MILLIMETERS]=0.001;e[k.DistanceUnitType.CENTIMETERS]=0.01;e[k.DistanceUnitType.DECIMETERS]=0.1;e[k.DistanceUnitType.KILOMETERS]=1E3;e[k.DistanceUnitType.INCHES]=0.0254;e[k.DistanceUnitType.FEET]=0.3048;e[k.DistanceUnitType.US_SURVEY_FEET]=
0.3048006096012192;e[k.DistanceUnitType.YARDS]=0.9144;e[k.DistanceUnitType.MILES]=1609.344;e[k.DistanceUnitType.NAUTICAL_MILES]=1852;e[k.DistanceUnitType.DEGREES]=111319.49079327357;e[k.DistanceUnitType.GRADS]=100187.54171394621;e[k.DistanceUnitType.RADIANS]=6378136.999999998;f.canConvert=function(c,a){var b=!1,d=!1;if(c===a)return!0;for(var g in k.DistanceUnitType)k.DistanceUnitType.hasOwnProperty(g)&&(k.DistanceUnitType[g]===c?b=!0:k.DistanceUnitType[g]===a&&(d=!0));return d&&b};f.convert=function(c,
a,b){if(!a||c===b)return a;b=l(b);a*=b;c=l(c);return a/c}});
define("infrastructure/ExportTilesUtils",["require","exports"],function(h,f){function k(b,d,c){var e=b+"/"+d;a.hasOwnProperty(b)&&(e+="/submitjob");return esri.request({callbackParamName:"callback",content:dojo.mixin({f:"json"},c),handleAs:"json",url:e}).then(function(e){return!e.jobStatus&&e.executionType&&e.parameters?(a[b]=!0,k(b,d,c)):e})}function l(a,d,g,e,f){void 0===e&&(e=null);void 0===f&&(f=1E3);switch(g.jobStatus){case esri.tasks.JobInfo.STATUS_CANCELLED:case esri.tasks.JobInfo.STATUS_DELETED:case esri.tasks.JobInfo.STATUS_FAILED:case esri.tasks.JobInfo.STATUS_TIMED_OUT:return Promise.reject(c(g));case esri.tasks.JobInfo.STATUS_SUCCEEDED:return Promise.resolve(g);
default:return Promise.delay(f).then(function(){return esri.request({callbackParamName:"callback",content:e?{f:"json",token:e}:{f:"json"},handleAs:"json",url:a+"/"+d+"/jobs/"+g.jobId})}).then(function(c){return l(a,d,c,e,Math.min(2*f,6E4))})}}function e(a,d,c,e,f){void 0===f&&(f=null);return esri.request({callbackParamName:"callback",content:f?{f:"json",token:f}:{f:"json"},handleAs:"json",url:a+"/"+d+"/jobs/"+c+"/"+e})}function c(a){if(!a||!a.messages)return"";a=a.messages.filter(function(a){return a.type===
esri.tasks.GPMessage.TYPE_ERROR});var d=a.filter(function(a){return/^ERROR \d+:/.test(a.description)});0<d.length&&(a=d);return a.reduce(function(a,b){return b.description.length>a.length?b.description:a},"")}var a={};f.exportTiles=function(a,d){for(var c="string"===typeof a?a:a.url;"/"===c[c.length-1];)c=c.substring(0,c.length-1);return k(c,"exportTiles",d).then(function(a){return l(c,"exportTiles",a,d.token)}).then(function(a){return e(c,"exportTiles",a.jobId,a.results.out_service_url.paramUrl,
d.token)}).then(function(a){return esri.request({callbackParamName:"callback",content:{f:"json"},handleAs:"json",url:a.value})}).then(function(a){return a.files})};f.estimateExportTilesSize=function(a,d){for(var c="string"===typeof a?a:a.url;"/"===c[c.length-1];)c=c.substring(0,c.length-1);return k(c,"estimateExportTilesSize",d).then(function(a){return l(c,"estimateExportTilesSize",a,d.token)}).then(function(a){return e(c,"estimateExportTilesSize",a.jobId,a.results.out_service_url.paramUrl,d.token)}).then(function(a){return"string"===
typeof a.value?{totalSize:+a.value,totalTilesToExport:null}:a.value})}});
define("commands.meta",["require","exports"],function(h,f){(function(f){f.commandsMetadata=[{name:"ActivateView",metadata:{arguments:"string",description:"Activates a view.",isHyperlinkable:!0,visibility:"public"}},{name:"DeactivateView",metadata:{arguments:"string",description:"Deactivates a view.",isHyperlinkable:!0,visibility:"public"}},{name:"ToggleView",metadata:{arguments:"string",description:"Activates or deactivates a view.",isHyperlinkable:!0,visibility:"public"}},{name:"ToggleLogView",metadata:{arguments:"none",
description:"Activates or deactivates log view.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowLog",metadata:{arguments:"boolean",description:"Shows the log view if the parameter is true.",isHyperlinkable:!0,visibility:"public"}},{name:"HideLog",metadata:{arguments:"none",description:"Hides the log view.",isHyperlinkable:!0,visibility:"public"}},{name:"ToggleResultsFrame",metadata:{arguments:"none",description:"Activates or deactivates Results frame.",isHyperlinkable:!0,visibility:"public"}},
{name:"ToggleDataFrame",metadata:{arguments:"none",description:"Activates or deactivates data frame.",isHyperlinkable:!0,visibility:"public"}},{name:"DestroyView",metadata:{arguments:"string",description:"Destroys a view, wiping out its bindings and DOM substructure.",isHyperlinkable:!0,visibility:"public"}},{name:"CloseModalRegion",metadata:{arguments:"none",description:"Closes the ModalWindowRegion.",isHyperlinkable:!0,visibility:"public"}},{name:"OpenWebPage",metadata:{arguments:"string",description:"Opens a web page in another tab/window.",
isHyperlinkable:!0,visibility:"public"}},{name:"Alert",metadata:{arguments:"string",description:"Displays an alert.",isHyperlinkable:!0,visibility:"public"}},{name:"Confirm",metadata:{arguments:"list",description:"Displays a confirm.",isHyperlinkable:!0,visibility:"private"}},{name:"ConsoleDir",metadata:{arguments:"object",description:"Displays a representation of the specified parameter object in the browser's debugging console.",isHyperlinkable:!0,visibility:"public"}},{name:"Identify",metadata:{arguments:"esri.geometry.Geometry",
description:"Executes an identify operation on a geometry.",isHyperlinkable:!0,visibility:"private"}},{name:"IdentifyBufferedGeometry",metadata:{arguments:"esri.geometry.Geometry",description:"Activates the Buffer Options dialog, buffers input geometry using settings specified by the user, places temporary markup on the map and identifies using the buffered geometry.",isHyperlinkable:!0,visibility:"private"}},{name:"IdentifyBufferedFeature",metadata:{arguments:"esri.Graphic|essentialsHtmlViewer.mapping.infrastructure.Feature",
description:"Activates the Buffer Options dialog, buffers input feature geometry using settings specified by the user, places temporary markup on the map and identifies using the buffered geometry.",isHyperlinkable:!0,visibility:"private"}},{name:"IdentifyBufferedFeatureSet",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.FeatureSet|essentialsHtmlViewer.mapping.infrastructure.FeatureSetCollection|string",description:"Activates the Buffer Options dialog, buffers input feature set geometry using settings specified by the user, places temporary markup on the map and identifies using the buffered geometry.",
isHyperlinkable:!0,visibility:"private"}},{name:"IdentifyBufferedFeatureSetCollection",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.FeatureSetCollection|string",description:"Activates the Buffer Options dialog, buffers input feature set collection geometry using settings specified by the user, places temporary markup on the map and identifies using the buffered geometry.",isHyperlinkable:!0,visibility:"private"}},{name:"Prompt",metadata:{arguments:"object",description:"Displays a prompt.",
isHyperlinkable:!0,visibility:"private"}},{name:"StartOfflineSyncAndShowProgress",metadata:{arguments:"string",description:"Starts downloading or syncing an offline map an displays the progress to the user.",isHyperlinkable:!0,visibility:"public"}},{name:"StepZoomIn",metadata:{arguments:"none",description:"Zooms in a step.",isHyperlinkable:!0,visibility:"public"}},{name:"StepZoomOut",metadata:{arguments:"none",description:"Zooms out a step.",isHyperlinkable:!0,visibility:"public"}},{name:"RecenterMapOnNextMapResize",
metadata:{arguments:"none",description:"Recenters the map to its existing position the next time the map is resized.",isHyperlinkable:!0,visibility:"public"}},{name:"PanToPoint",metadata:{arguments:"esri.geometry.Geometry",description:"Pans to a point or other type of Geometry.",isHyperlinkable:!0,visibility:"private"}},{name:"PanUp",metadata:{arguments:"none",description:"Pans the map up.",isHyperlinkable:!0,visibility:"public"}},{name:"PlotCoordinates",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.coordinates.CoordinateBase|essentialsHtmlViewer.mapping.infrastructure.coordinates.CoordinateBase[]",
description:"Plots a coordinate (or a number of coordinates) on the map.",isHyperlinkable:!1,visibility:"public"}},{name:"PanDown",metadata:{arguments:"none",description:"Pans the map down.",isHyperlinkable:!0,visibility:"public"}},{name:"PanLeft",metadata:{arguments:"none",description:"Pans the map left.",isHyperlinkable:!0,visibility:"public"}},{name:"PanRight",metadata:{arguments:"none",description:"Pans the map right.",isHyperlinkable:!0,visibility:"public"}},{name:"ZoomToExtent",metadata:{arguments:"esri.geometry.Extent",
description:"Zooms to the given extent.",isHyperlinkable:!0,visibility:"public"}},{name:"ZoomToScale",metadata:{arguments:"number",description:"Zooms to the given scale.",isHyperlinkable:!0,visibility:"public"}},{name:"ZoomOutToExtent",metadata:{arguments:"esri.geometry.Extent",description:"Zooms out to the given extent.",isHyperlinkable:!0,visibility:"public"}},{name:"ZoomToLayerExtent",metadata:{arguments:"geocortex.essentials.Layer",description:"Zooms to the extent of all the features in a layer.",
isHyperlinkable:!0,visibility:"private"}},{name:"ZoomToLayerVisibleScale",metadata:{arguments:"geocortex.essentials.Layer",description:"Zooms to the scale at which features in a layer become visible.",isHyperlinkable:!0,visibility:"private"}},{name:"ZoomToInitialExtent",metadata:{arguments:"none",description:"Zooms to the initial extent of the current Site.",isHyperlinkable:!0,visibility:"public"}},{name:"ZoomToPreviousExtent",metadata:{arguments:"none",description:"Zooms to the previous recorded map extent if any.",
isHyperlinkable:!0,visibility:"public"}},{name:"ZoomToNamedExtent",metadata:{arguments:"string",description:"Zooms to the bookmarked extent with the specified name.",isHyperlinkable:!0,visibility:"public"}},{name:"ZoomToNextExtent",metadata:{arguments:"none",description:"Zooms to the next recorded map extent if any.",isHyperlinkable:!0,visibility:"public"}},{name:"ZoomToOfflineMapExtent",metadata:{arguments:"none",description:"Zooms to the extent of the currently active offline map.",isHyperlinkable:!0,
visibility:"public"}},{name:"ZoomToFullExtent",metadata:{arguments:"none",description:"Zooms to the full extent of the current Site.",isHyperlinkable:!0,visibility:"public"}},{name:"MapResize",metadata:{arguments:"none",description:"Tells the map control to resize itself. This should be called after altering the map container's dimensions.",isHyperlinkable:!0,visibility:"public"}},{name:"MaximizePanel",metadata:{arguments:"string",description:"Instructs the region hosting a view to maximize itself if it supports this action. As of v2.4, only the BottomPanelRegion and its sub regions support this action.",
isHyperlinkable:!0,visibility:"public"}},{name:"RestorePanel",metadata:{arguments:"string",description:"Instructs the region hosting a view to restore itself to default dimensions if it supports this action. As of v2.4, only the BottomPanelRegion and its sub regions support this action.",isHyperlinkable:!0,visibility:"public"}},{name:"AddTemporaryMarkupGeometry",metadata:{arguments:"esri.geometry.Geometry",description:"Adds a temporary markup graphic to the map. The {@link Commands.ClearTemporaryMarkup} command will clear this piece of markup.",
isHyperlinkable:!0,visibility:"private"}},{name:"ClearTemporaryMarkup",metadata:{arguments:"none",description:"Removes temporary markup created by the command 'AddTemporaryMarkupGeometry'",isHyperlinkable:!0,visibility:"public"}},{name:"RippleClick",metadata:{arguments:"MouseEvent",description:"Creates a ripple feedback effect when clicking on the map",isHyperlinkable:!1,visibility:"private"}},{name:"ToggleRippleClick",metadata:{arguments:"none",description:"Toggles the visibility of the ripple feedback given for map clicks",
isHyperlinkable:!0,visibility:"private"}},{name:"ClearTrustedUrls",metadata:{arguments:"none",description:"Clears list of trusted URLs which are added by clicking 'yes' on potentially untrusted content popup",isHyperlinkable:!0,visibility:"public"}},{name:"ZoomToFeature",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",description:"Zooms to a feature.",isHyperlinkable:!0,visibility:"private"}},{name:"ZoomToFeatureIfOutsideMapExtent",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",
description:"Zooms to a feature if the it's outside of the map's extent, otherwise nothing happens.",isHyperlinkable:!0,visibility:"private"}},{name:"ZoomToFeatures",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.FeatureSet",description:"Zooms to the extent of all the features in the feature set.",isHyperlinkable:!0,visibility:"private"}},{name:"ZoomToFeatureSetCollection",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.FeatureSetCollection",description:"Shows all of the features in the Feature Set Collection on the map",
isHyperlinkable:!0,visibility:"private"}},{name:"ZoomToAllFeatures",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature[]",description:"Zooms to the extent of all the features.",isHyperlinkable:!0,visibility:"private"}},{name:"ShowMap",metadata:{arguments:"none",description:"Activates map view.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowMapElement",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.ShowMapElementArgs",description:"Displays an element anchored to a specific point on the map.",
isHyperlinkable:!0,visibility:"private"}},{name:"ShowMapCallout",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.ShowMapElementArgs",description:"Displays a map callout anchored to a given point.",isHyperlinkable:!0,visibility:"private"}},{name:"HideMapElement",metadata:{arguments:"string",description:"Removes an element previously anchored to the map using {@link Commands.ShowMapElement}.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowMapTipResults",metadata:{arguments:"string",
description:"Shows map tip results for a FeatureSetCollection previously added to the FeatureSetManager.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowMapTipResultsInCallout",metadata:{arguments:"string",description:"Shows map tip results for a FeatureSetCollection previously added to the FeatureSetManager, in a floating callout window on the map (the default behavior prior to version 2.4).",isHyperlinkable:!0,visibility:"public"}},{name:"OpenDataFrame",metadata:{arguments:"none",description:"Opens the DataRegion, if it is present in the current shell.",
isHyperlinkable:!0,visibility:"public"}},{name:"CloseDataFrame",metadata:{arguments:"none",description:"Closes the DataRegion, if it is present in the current shell.",isHyperlinkable:!0,visibility:"public"}},{name:"ChangeDataFramePosition",metadata:{arguments:"args: {position: PanelPosition; callback?: () => void",description:"Change the DataRegion position to desidered one, if it is present in the current shell.",isHyperlinkable:!1,visibility:"private"}},{name:"OpenBottomRegion",metadata:{arguments:"none",
description:"Opens the BottomPanelRegion, if it is present in the current shell.",isHyperlinkable:!0,visibility:"public"}},{name:"CloseBottomRegion",metadata:{arguments:"none",description:"Closes the BottomPanelRegion, if it is present in the current shell.",isHyperlinkable:!0,visibility:"public"}},{name:"RunWorkflowById",metadata:{arguments:"string",description:"Runs a workflow.",isHyperlinkable:!0,visibility:"public"}},{name:"RunWorkflowWithGeometry",metadata:{arguments:"object",description:"Runs a workflow with a geometry used as an input argument.",
isHyperlinkable:!0,visibility:"private"}},{name:"RunWorkflowWithArguments",metadata:{arguments:"object",description:"Runs a workflow with a set of input arguments.",isHyperlinkable:!0,visibility:"public"}},{name:"DisplayWorkflowContainerContent",metadata:{arguments:"object",description:"Displays a view in a workflow container.",isHyperlinkable:!0,visibility:"private"}},{name:"ClearActiveTool",metadata:{arguments:"none",description:"Clears the active tool.",isHyperlinkable:!0,visibility:"public"}},
{name:"SetActiveTool",metadata:{arguments:"string",description:"Sets the active tool.",isHyperlinkable:!0,visibility:"public"}},{name:"Geolocate",metadata:{arguments:"object",description:"Zooms to the current location of the device when it becomes available.",isHyperlinkable:!0,visibility:"public"}},{name:"GeolocateTrack",metadata:{arguments:"none",description:"Enables the tracking of the device's location when it is available, without panning the map.",isHyperlinkable:!0,visibility:"public"}},{name:"GeolocateFollow",
metadata:{arguments:"none",description:"Enables the following of the device's location when it is available, panning the map.",isHyperlinkable:!0,visibility:"public"}},{name:"GeolocateStop",metadata:{arguments:"none",description:"Stops the tracking and following of the device's location.",isHyperlinkable:!0,visibility:"public"}},{name:"GeolocateShowBuffer",metadata:{arguments:"none",description:"Display a circular buffer showing the accuracy of the latest GPS reading.",isHyperlinkable:!0,visibility:"public"}},
{name:"GeolocateHideBuffer",metadata:{arguments:"none",description:"Hide a circular buffer showing the accuracy of the latest GPS reading.",isHyperlinkable:!0,visibility:"public"}},{name:"TakeApplicationOffline",metadata:{arguments:"none",description:"Puts the application in an offline state.",isHyperlinkable:!1,visibility:"public"}},{name:"TapToDismiss",metadata:{arguments:"args: {view: framework.ui.ViewBase; onOtherInteracted?: (evt?: Event) => void ; onElementInteracted?: (evt?: Event) => void}",
description:"Dismisses the specified view on the next tap anywhere on the screen. Optionally fires specified callbacks.",isHyperlinkable:!1,visibility:"private"}},{name:"TakeApplicationOnline",metadata:{arguments:"none",description:"Connects the application to the internet.",isHyperlinkable:!1,visibility:"public"}},{name:"SetGMAFOfflineButtonState",metadata:{arguments:"string",description:"Sets the visibility of the online/offline button in the GMAF app.",isHyperlinkable:!0,visibility:"public"}},
{name:"ToggleConnectivity",metadata:{arguments:"none",description:"Toggles the connectivity of the app, from offline to online or viceversa",isHyperlinkable:!0,visibility:"public"}},{name:"RefreshOfflineMapsList",metadata:{arguments:"string",description:"Refresh the list of offline maps on the OfflineMapsList view.",isHyperlinkable:!1,visibility:"public"}},{name:"OpenFeatureSetCollection",metadata:{arguments:"string",description:"Opens the FeatureSetCollection.",isHyperlinkable:!0,visibility:"public"}},
{name:"OpenPortalMyContentWindow",metadata:{arguments:"none",description:"Opens a new browser window to the authenticated users ArcGIS Portal 'My Content' page.",isHyperlinkable:!0,visibility:"public"}},{name:"CloseFeatureSetCollection",metadata:{arguments:"string",description:"Closes the FeatureSetCollection.",isHyperlinkable:!0,visibility:"public"}},{name:"RemoveFeatureSetCollection",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.FeatureSetCollection",description:"Removes the specified collection from the FeatureSetManager.",
isHyperlinkable:!0,visibility:"private"}},{name:"RemoveFeatureSetCollectionById",metadata:{arguments:"string",description:"Removes the collection specified by ID from the FeatureSetManager.",isHyperlinkable:!0,visibility:"public"}},{name:"Search",metadata:{arguments:"string",description:"Performs a search on all active providers.",isHyperlinkable:!0,visibility:"public"}},{name:"GlobalSearch",metadata:{arguments:"string",description:"Performs a search on all active providers.",isHyperlinkable:!0,visibility:"public"}},
{name:"BufferGeometry",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.buffer.BufferGeometryArgs",description:"Buffers input geometry, adds buffer markup to the map, and fires the callback and event with the buffered geometry. When the source command is specified, buffers using current settings for the command.",isHyperlinkable:!0,visibility:"private"}},{name:"CancelEditCoordinate",metadata:{arguments:"none",description:"Cancels editing of a coordinate if currently active.",isHyperlinkable:!0,
visibility:"public"}},{name:"CancelSearch",metadata:{arguments:"none",description:"Cancel the search on all providers.",isHyperlinkable:!0,visibility:"public"}},{name:"ClearSearch",metadata:{arguments:"none",description:"Clear the search results.",isHyperlinkable:!0,visibility:"public"}},{name:"ClearSelection",metadata:{arguments:"none",description:"Clears the open identify results/selection.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowExportWebMapDialog",metadata:{arguments:"none",description:"Activates the export web map view.",
isHyperlinkable:!0,visibility:"public"}},{name:"ShowFeatureDetails",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",description:"Creates and displays the Feature Details dialog for the Feature or FeatureSetCollection specified.",isHyperlinkable:!0,visibility:"private"}},{name:"ShowFeatureDetailsCompact",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",description:"Creates and displays the Feature Details dialog for the {@link geocortex.essentialsHtmlViewer.mapping.infrastructure.Feature} in Compact View mode. If the feature is not specified, details for the last feature will be displayed.",
isHyperlinkable:!0,visibility:"private"}},{name:"ShowFeatureDetailsExpanded",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",description:"Creates and displays the Feature Details dialog for the {@link geocortex.essentialsHtmlViewer.mapping.infrastructure.Feature} in Expanded View mode. If the feature is not specified, details for the last feature will be displayed.",isHyperlinkable:!0,visibility:"private"}},{name:"SetFeatureDetailsMode",metadata:{arguments:"string",description:"Sets the feature details dialog to the specified view mode.",
isHyperlinkable:!0,visibility:"public"}},{name:"ShowFeatureParentDetails",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",description:"Shows the previously opened feature when browsing related features in the feature details view.",isHyperlinkable:!0,visibility:"private"}},{name:"ShowFeatureAttributeEditor",metadata:{arguments:"none",description:"Shows the feature attribute editor used to set feature attributes.",isHyperlinkable:!0,visibility:"public"}},{name:"HideFeatureAttributeEditor",
metadata:{arguments:"none",description:"Hides the feature attribute editor used to set feature attributes.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowFeatureTemplatePicker",metadata:{arguments:"layer",description:"Shows the feature template picker used to create new features. If a layer is supplied, shows the templates for the layer.",isHyperlinkable:!0,visibility:"private"}},{name:"HideFeatureTemplatePicker",metadata:{arguments:"none",description:"Hides the feature template picker used to create new features.",
isHyperlinkable:!0,visibility:"public"}},{name:"FSMCollectionSetCommand",metadata:{arguments:"string, string",description:"Set the preferred command to open the FeatureSetCollection for the given source name.",isHyperlinkable:!0,visibility:"private"}},{name:"PanToAllFeatures",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature[]",description:"Pans to the extent of all the features.",isHyperlinkable:!0,visibility:"private"}},{name:"PanToFeature",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",
description:"Pans to a Geocortex feature.",isHyperlinkable:!0,visibility:"private"}},{name:"PanToFeatureIfOutsideMapExtent",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",description:"Pans to a Geocortex feature if the feature is outside of the map's extent, otherwise nothing happens.",isHyperlinkable:!0,visibility:"private"}},{name:"Project",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.ProjectArgs",description:"Calls a geometry service to project geometries between different coordinate systems.",
isHyperlinkable:!1,visibility:"private"}},{name:"InvokeMapTip",metadata:{arguments:"esri.geometry.Geometry",description:'Executes an Identify operation on the given geometry and sets "MapTip" as its source tag.',isHyperlinkable:!0,visibility:"private"}},{name:"ShowMapTip",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",description:"Displays a feature in the map tip view.",isHyperlinkable:!0,visibility:"private"}},{name:"ShowMapTipInCallout",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",
description:"Displays a feature in a map tip callout anchored to the map.",isHyperlinkable:!0,visibility:"private"}},{name:"SuspendMapTips",metadata:{arguments:"none",description:"Suspends the display of map tips, allowing other components the opportunity to interact with the map without invoking map tips on click/tap events.",isHyperlinkable:!0,visibility:"public"}},{name:"SwitchToLayerTheme",metadata:{arguments:"string",description:"Switches to the specified layer theme, identified by ID or display name.",
isHyperlinkable:!0,visibility:"public"}},{name:"ResumeMapTips",metadata:{arguments:"none",description:"Resumes the previously suspended display of map tips.",isHyperlinkable:!0,visibility:"public"}},{name:"ClearStorageForApplication",metadata:{arguments:"none",description:"Clears the offline data for the current application.",isHyperlinkable:!0,visibility:"public"}},{name:"ClearStorageForDomain",metadata:{arguments:"none",description:"Clears all offline data for the current domain. This includes data for all applications loaded from the current domain.",
isHyperlinkable:!0,visibility:"public"}},{name:"ListReports",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.FeatureSetCollection",description:"Presents a user interface for choosing to run a report from a list of reports that are available to the given reportable input (group of features).",isHyperlinkable:!1,visibility:"public"}},{name:"RunFeatureReport",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",description:"Alias to 'ListReports' for backwards compatibility with the Silverlight viewer.",
isHyperlinkable:!0,visibility:"public"}},{name:"RunFeaturesReport",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.FeatureSetCollection",description:"Alias to 'ListReports' for backwards compatibility with the Silverlight viewer.",isHyperlinkable:!1,visibility:"public"}},{name:"RunReport",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.RunReportArgs",description:"Runs a given report on the provided features, and displays the result (a download link to the report file) to the user.",
isHyperlinkable:!1,visibility:"public"}},{name:"ShowResultsList",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.FeatureSetCollection",description:"Displays the list of features in the given FeatureSetCollection as a list.",isHyperlinkable:!1,visibility:"private"}},{name:"ShowResultsTable",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.FeatureSetCollection",description:"Displays the list of features in the given FeatureSetCollection in a tabular view.",isHyperlinkable:!1,
visibility:"private"}},{name:"SwitchToListResultsView",metadata:{arguments:"none",description:"Switches from Results Table to Results List view if the Results Table view is currently active.",isHyperlinkable:!0,visibility:"public"}},{name:"SwitchToTabularResultsView",metadata:{arguments:"none",description:"Switches from Results List to Results Table view if the Results List view is currently active.",isHyperlinkable:!0,visibility:"public"}},{name:"OpenResultsFrame",metadata:{arguments:"none",description:"Activates the ResultsRegion.",
isHyperlinkable:!0,visibility:"public"}},{name:"CloseResultsFrame",metadata:{arguments:"none",description:"Deactivates the ResultsRegion.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowLayerList",metadata:{arguments:"none",description:"Displays the layer list.",isHyperlinkable:!0,visibility:"public"}},{name:"SwitchToLayerView",metadata:{arguments:"none",description:"Displays the layer list.",isHyperlinkable:!0,visibility:"public"}},{name:"SwitchToLegendView",metadata:{arguments:"none",description:"Displays the legend view.",
isHyperlinkable:!0,visibility:"public"}},{name:"ShowLayerActions",metadata:{arguments:"geocortex.essentials.Layer",description:"Shows available actions for a given layer.",isHyperlinkable:!0,visibility:"private"}},{name:"ShowMapServiceActions",metadata:{arguments:"geocortex.essentials.MapService",description:"Shows available actions for a given map service.",isHyperlinkable:!0,visibility:"private"}},{name:"HideMapServiceActions",metadata:{arguments:"none",description:"Closes the map service actions view.",
isHyperlinkable:!0,visibility:"private"}},{name:"PulseStatus",metadata:{arguments:"string",description:"Resets the timer of the status view model.",isHyperlinkable:!0,visibility:"public"}},{name:"RemoveStatus",metadata:{arguments:"string",description:"Removes the status indicator from the screen with the specified ID.",isHyperlinkable:!0,visibility:"public"}},{name:"AddStatus",metadata:{arguments:"string",description:"Adds a status indicator to the screen.",isHyperlinkable:!0,visibility:"public"}},
{name:"CreateHighlightLayer",metadata:{arguments:"string",description:"Creates a new highlight layer with the specified name.",isHyperlinkable:!0,visibility:"private"}},{name:"SetActiveHighlightLayer",metadata:{arguments:"string",description:"Sets the layer with the specified name as active, if there is one.",isHyperlinkable:!0,visibility:"private"}},{name:"SetActiveHighlightLayerDefault",metadata:{arguments:"none",description:"Sets the default highlight layer as the active highlight layer.",isHyperlinkable:!0,
visibility:"private"}},{name:"HighlightEsriFeatureSet",metadata:{arguments:"esri.tasks.FeatureSet",description:"Highlights all of the features in the specified Esri feature set in the active highlight layer.",isHyperlinkable:!1,visibility:"private"}},{name:"SetHighlightBorderColor",metadata:{arguments:"string",description:"Sets the border color used for new highlights, specified in 6 or 8 digit hex in RGB or ARGB form.",isHyperlinkable:!0,visibility:"public"}},{name:"SetHighlightBorderWidth",metadata:{arguments:"number",
description:"Sets the border width (in pixels) used for new highlights.",isHyperlinkable:!0,visibility:"public"}},{name:"SetHighlightFillColor",metadata:{arguments:"string",description:"Sets the current highlight fill color to use for a highlighted feature.",isHyperlinkable:!0,visibility:"public"}},{name:"SetFocusedBorderColor",metadata:{arguments:"string",description:"Sets the border color used for an focused feature.",isHyperlinkable:!0,visibility:"public"}},{name:"SetFocusedFillColor",metadata:{arguments:"string",
description:"Sets the current highlight fill color to use, if the feature does not specify one.",isHyperlinkable:!0,visibility:"public"}},{name:"RemoveHighlightLayer",metadata:{arguments:"string",description:"Removes the highlight layer with the specified name, if there is one.",isHyperlinkable:!0,visibility:"public"}},{name:"AddMapService",metadata:{arguments:"essentials.MapService",description:"Integrate a map service and its sub-components into the viewer and onto the map.",isHyperlinkable:!0,
visibility:"private"}},{name:"RemoveMapService",metadata:{arguments:"essentials.MapService",description:"Removes a user added map service off of the map and out of the viewer.",isHyperlinkable:!0,visibility:"private"}},{name:"RemoveUserAddedLayer",metadata:{arguments:"essentials.Layer",description:"Remove a user added layer (and its parent map service) off of the map and out of the viewer.",isHyperlinkable:!0,visibility:"private"}},{name:"ClearHighlights",metadata:{arguments:"string",description:"Removes the highlights from the default highlight layer (no parameter), or from the highlight layer with the supplied name",
isHyperlinkable:!0,visibility:"public"}},{name:"ClearDefaultHighlights",metadata:{arguments:"none",description:"Removes the highlights from the default highlight layer.",isHyperlinkable:!0,visibility:"private"}},{name:"HighlightFeatureSet",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.FeatureSet",description:"Highlights all of the features in the specified feature set in the active highlight layer.",isHyperlinkable:!0,visibility:"private"}},{name:"HighlightFeature",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",
description:"Highlights the feature (or array of features) in the active highlight layer.",isHyperlinkable:!0,visibility:"public"}},{name:"HighlightFeatures",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature[]",description:"Highlights the feature (or array of features) in the active highlight layer.",isHyperlinkable:!0,visibility:"public"}},{name:"ClearAndHighlightFeatures",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature[]",description:"Clears existing highlights and highlights all specified features on the active highlight layer.",
isHyperlinkable:!1,visibility:"public"}},{name:"FocusFeature",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",description:"Focuses the specified feature on the active highlight layer.",isHyperlinkable:!1,visibility:"public"}},{name:"ClearFeatureHighlight",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",description:"Clears the highlight from a feature if it's currently highlighted.",isHyperlinkable:!1,visibility:"public"}},{name:"ClearFeatureFocus",
metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",description:"Clears the feature emphasis from a feature if it's currently focused, returning it to the highlighted state.",isHyperlinkable:!1,visibility:"public"}},{name:"HighlightFeatureDefault",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",description:"Highlights the feature in the default highlight layer.",isHyperlinkable:!0,visibility:"private"}},{name:"AddMarkup",metadata:{arguments:"esri.geometry.Geometry",
description:"Adds the given geometry to the markup layer.",isHyperlinkable:!0,visibility:"private"}},{name:"AddMarkupGeometry",metadata:{arguments:"esri.geometry.Geometry",description:"Adds the given geometry to the markup layer.  (Identical to the AddMarkup command.)",isHyperlinkable:!0,visibility:"private"}},{name:"AddTextMarkup",metadata:{arguments:"esri.geometry.Geometry",description:"Prompts the user for text to add as markup. When completed, text markup is added at the provided geometry.",isHyperlinkable:!0,
visibility:"private"}},{name:"ClearMarkup",metadata:{arguments:"none",description:"Prompts the user for confirmation, and if approved, clears all of the markup from the markup layer.",isHyperlinkable:!0,visibility:"public"}},{name:"ClearMarkupQuiet",metadata:{arguments:"none",description:"Clears all of the markup from the markup layer without prompting for confirmation.",isHyperlinkable:!0,visibility:"public"}},{name:"MeasureDistance",metadata:{arguments:"esri.geometry.Polyline",description:"Computes the total and segment distance measurements for the specified Polyline geometry and plots it on the map along with its measurements. NOTE: An Esri or Geocortex feature may also be provided as arguments in lieu of a polyline geometry.",
isHyperlinkable:!0,visibility:"private"}},{name:"MeasureArea",metadata:{arguments:"esri.geometry.Polygon",description:"Computes the area, perimeter and individual segment distances for the specified Polylgon geometry and plots it on the map along with its measurements. NOTE: An Esri or Geocortex feature may also be provided as arguments in lieu of a polygon geometry.",isHyperlinkable:!0,visibility:"private"}},{name:"DeleteMeasurement",metadata:{arguments:"esri.geometry.Geometry",description:"Deletes measurement markup within the given geometry",
isHyperlinkable:!0,visibility:"private"}},{name:"SetMeasurementUnits",metadata:{arguments:"string, string",description:"Sets the measurement units for the measurements performed by the measurement module. Also updates existing measurements already on the map.",isHyperlinkable:!1,visibility:"private"}},{name:"ResizeShell",metadata:{arguments:"none",description:"Recalculate the size and layout of the shell and refresh the shell accordingly.",isHyperlinkable:!0,visibility:"public"}},{name:"ActivateHomePanel",
metadata:{arguments:"none",description:"Activates Home Panel if it is configured to be included.",isHyperlinkable:!0,visibility:"public"}},{name:"ActivatePlotCoordinatesView",metadata:{arguments:"none",description:"Activates the Plot Coordinates view.",isHyperlinkable:!0,visibility:"public"}},{name:"ApplyFilterControlQuery",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.eventArgs.FilterControlQueryChangedEventArgs",description:"Applies the current query to the specified Filter Control.",
isHyperlinkable:!1,visibility:"public"}},{name:"ShowHomePanel",metadata:{arguments:"none",description:"Activates Home Panel if it is configured to be included.",isHyperlinkable:!0,visibility:"public"}},{name:"HideHomePanel",metadata:{arguments:"none",description:"Deactivates/hides the Home Panel if it is configured to be included.",isHyperlinkable:!0,visibility:"public"}},{name:"AttachFileToFeature",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",description:"Checks for HTML5 FileReader / Cordova support and activates File Attachments if supported.",
isHyperlinkable:!0,visibility:"private"}},{name:"ToggleToolbar",metadata:{arguments:"none",description:"Toggles the visibility of the toolbar if present.",isHyperlinkable:!0,visibility:"public"}},{name:"OpenToolbar",metadata:{arguments:"none",description:"Opens the toolbar, if present.",isHyperlinkable:!0,visibility:"public"}},{name:"CloseToolbar",metadata:{arguments:"none",description:"Closes the toolbar, if present.",isHyperlinkable:!0,visibility:"public"}},{name:"PrintMap",metadata:{arguments:"none",
description:"Displays a dialog to create a printable map.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowExportMapDialog",metadata:{arguments:"none",description:"Displays a dialog to save a map image.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowLayerCatalog",metadata:{arguments:"none",description:"Shows the layer catalog view.",isHyperlinkable:!0,visibility:"public"}},{name:"ActivateTimeSlider",metadata:{arguments:"none",description:"Activates and shows the Time Slider if time slider profiles are available in the site.",
isHyperlinkable:!0,visibility:"public"}},{name:"DeactivateTimeSlider",metadata:{arguments:"none",description:"Deactivates time settings applied to the map and hides the Time Slider.",isHyperlinkable:!0,visibility:"public"}},{name:"HideTimeSlider",metadata:{arguments:"none",description:"Hides the time slider if currently visible but does not deactivate time settings applied to the map.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowTimeSliderSettings",metadata:{arguments:"none",description:"Shows the time slider settings view.",
isHyperlinkable:!0,visibility:"public"}},{name:"HideTimeSliderSettings",metadata:{arguments:"none",description:"Hides the time slider settings view.",isHyperlinkable:!0,visibility:"public"}},{name:"ToggleTimeSliderActions",metadata:{arguments:"none",description:"Toggles the time slider actions container visibility.",isHyperlinkable:!0,visibility:"public"}},{name:"SetTimeSliderProfile",metadata:{arguments:"none",description:"Validates and sets a specified time slider profile.",isHyperlinkable:!1,visibility:"private"}},
{name:"AddCatalogLayers",metadata:{arguments:"Comma seperated string of layer ids.",description:"Adds catalog layers.",isHyperlinkable:!1,visibility:"public"}},{name:"AppendCatalogLayers",metadata:{arguments:"Comma seperated string of layer ids.",description:"Appends catalog layers.",isHyperlinkable:!1,visibility:"public"}},{name:"ClearLayerCatalogLayers",metadata:{arguments:"none",description:"Clears all catalog layers.",isHyperlinkable:!0,visibility:"public"}},{name:"RemoveLayerCatalogIds",metadata:{arguments:"A string array of CatalogIds to be removed",
description:"Removes specific catalog layers",isHyperlinkable:!1,visibility:"public"}},{name:"ShowBookmarks",metadata:{arguments:"none",description:"Displays the Bookmarked Locations menu if the BookmarkViewModel's property, bookmarksEnabled, is set to true.",isHyperlinkable:!0,visibility:"public"}},{name:"AddBookmark",metadata:{arguments:"string",description:"Bookmark the current extent with the given name.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowAddBookmark",metadata:{arguments:"none",
description:"Prompts the user to bookmark the current extent by entering a name.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowCoordinateActions",metadata:{arguments:"string",description:"Shows the configured coordinate actions.",isHyperlinkable:!0,visibility:"public"}},{name:"RemoveBookmark",metadata:{arguments:"string",description:"Removes a bookmark with the given name if exists.",isHyperlinkable:!0,visibility:"public"}},{name:"SelectBaseMap",metadata:{arguments:"string",description:"A map can have a number of basemaps associated with it. SelectBaseMap allows you to programmatically select one of the basemaps to display. All other basemaps are then faded out.",
isHyperlinkable:!0,visibility:"public"}},{name:"ActivateSelectLayersForIdentify",metadata:{arguments:"none",description:"Activates the Layer Selector for Identify and applies current settings.",isHyperlinkable:!0,visibility:"public"}},{name:"DeactivateSelectLayersForIdentify",metadata:{arguments:"none",description:"Deactivates the Layer Selector for Identify and enables all default identifiable layers.",isHyperlinkable:!0,visibility:"public"}},{name:"ActivateBuffering",metadata:{arguments:"string|string[]",
description:"Activates buffering for the specified command(s). Uses currently configured settings for the command.",isHyperlinkable:!0,visibility:"public"}},{name:"ActivateBufferingAndDisplayOptions",metadata:{arguments:"string",description:"Activates buffering for the specified command and displays the associated Buffer Options dialog. ",isHyperlinkable:!0,visibility:"public"}},{name:"ActivateTransientElements",metadata:{arguments:"string",description:"Activates any transient elements configured against a specific ID in the toolbar module.",
isHyperlinkable:!0,visibility:"public"}},{name:"DeactivateBuffering",metadata:{arguments:"string|string[]",description:"Deactivates buffering, if active, for the specified command(s).",isHyperlinkable:!0,visibility:"public"}},{name:"DeactivateBufferingAndDismissOptions",metadata:{arguments:"string",description:"Deactivates buffering for the specified command and dismisses the associated Buffer Options dialog if its active. ",isHyperlinkable:!0,visibility:"public"}},{name:"DeactivateTransientElements",
metadata:{arguments:"string",description:"Deactivates any transient elements configured against a specific ID in the toolbar module.",isHyperlinkable:!0,visibility:"public"}},{name:"DeleteAllCoordinates",metadata:{arguments:"none",description:"Deletes all plotted Coordinates from the map.",isHyperlinkable:!0,visibility:"public"}},{name:"DeleteCoordinates",metadata:{arguments:"string|string[]",description:"Deletes one or many plotted Coordinates from the map.",isHyperlinkable:!0,visibility:"public"}},
{name:"EditCoordinate",metadata:{arguments:"string|null",description:"Edits a plotted Coordinate on the map or creates a new coordinate in edit mode if no descriptor Id is provided.",isHyperlinkable:!0,visibility:"public"}},{name:"EditMarkup",metadata:{arguments:"esri.geometry.Geometry",description:"Edits markup that intersects the extent of the provided geometry.",isHyperlinkable:!0,visibility:"private"}},{name:"DeleteMarkup",metadata:{arguments:"esri.geometry.Geometry",description:"Deletes markup within the given geometry",
isHyperlinkable:!0,visibility:"private"}},{name:"CreateMarkupStyleView",metadata:{arguments:"string",description:"Activates the style picker if 'point', 'polyline', 'polygon', or 'text' is the string provided. If it is null, then the app will try and detect what style selector to activate.",isHyperlinkable:!0,visibility:"public"}},{name:"ChangeMarkupStyle",metadata:{arguments:"MarkupTemplate",description:"Takes a MarkupTemplate, PointTemplate, PolylineTemplate, PolygonTemplate, or TextTemplate. It will change the style of the markup to suit the template provided.",
isHyperlinkable:!0,visibility:"private"}},{name:"StopEditingMarkup",metadata:{arguments:"boolean",description:"Stops editing. If arg is true, clears the active tool, if arg is false, doesn't clear active tool.",isHyperlinkable:!0,visibility:"public"}},{name:"StartEditingFeature",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",description:"Shows the editing form.",isHyperlinkable:!0,visibility:"private"}},{name:"EnableSearchRefinement",metadata:{arguments:"boolean",description:"Enables or disables the refinement of a global search from within search hints (if any).",
isHyperlinkable:!0,visibility:"public"}},{name:"ExportResultsTo",metadata:{arguments:"{ format: string, fsc: geocortex.essentialsHtmlViewer.mapping.infrastructure.FeatureSetCollection }",description:"Enables or disables the refinement of a global search from within search hints (if any).",isHyperlinkable:!0,visibility:"private"}},{name:"ExportMarkupLayer",metadata:{arguments:"none",description:"Exports markup layer.",isHyperlinkable:!0,visibility:"public"}},{name:"ExportGraphicsLayer",metadata:{arguments:"{ args:  geocortex.essentialsHtmlViewer.mapping.infrastructure.commandArgs.ExportGraphicsLayerArgs}",
description:"Exports graphics layer.",isHyperlinkable:!1,visibility:"public"}},{name:"HideAllCoordinates",metadata:{arguments:"none",description:"Hides all plotted Coordinates temporarily.",isHyperlinkable:!0,visibility:"public"}},{name:"HideCoordinates",metadata:{arguments:"string|string[]",description:"Hides one or many plotted Coordinates temporarily.",isHyperlinkable:!0,visibility:"public"}},{name:"HideCoordinateActions",metadata:{arguments:"none",description:"Hide any coordinate actions view that is currently open.",
isHyperlinkable:!0,visibility:"public"}},{name:"SignIn",metadata:{arguments:"string",description:"Navigates to the sign-in page. The sign in experience can be customized by crafting a custom sign-in URL, otherwise the default sign-in URL for the site will be used.",isHyperlinkable:!0,visibility:"public"}},{name:"SignOut",metadata:{arguments:"string",description:"Navigates to the sign-out page, which will sign the current user out.",isHyperlinkable:!0,visibility:"public"}},{name:"LogOptimizerEvent",
metadata:{arguments:"string, string",description:"Logs an event for Geocortex Optimizer.",isHyperlinkable:!0,visibility:"private"}},{name:"AddPushpin",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",description:"Creates and displays a pushpin for the Feature specified.",isHyperlinkable:!0,visibility:"private"}},{name:"AddPushpins",metadata:{arguments:"string",description:"Creates and displays pushpins for the FeatureSetCollection specified.",isHyperlinkable:!0,visibility:"public"}},
{name:"RemovePushpin",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",description:"Removes the pushpin from the map for the given feature, if there is one.",isHyperlinkable:!0,visibility:"private"}},{name:"RemovePushpins",metadata:{arguments:"none",description:"Removes all pushpins from the map.",isHyperlinkable:!0,visibility:"public"}},{name:"EnablePushpins",metadata:{arguments:"none",description:"Enables the display of pushpins/markers on the map.",isHyperlinkable:!0,visibility:"public"}},
{name:"DisablePushpins",metadata:{arguments:"none",description:"Disables the display of pushpins/markers on the map.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowPushpins",metadata:{arguments:"none",description:"Displays pushpins by setting their visibility to true, for each result in the results list or results table.  Pushpins must be enabled for this command to work.",isHyperlinkable:!0,visibility:"public"}},{name:"StopFeaturePlacementState",metadata:{arguments:"none",description:"Cancels any feature placement while a feature is being created or edited.",
isHyperlinkable:!0,visibility:"public"}},{name:"HidePushpins",metadata:{arguments:"none",description:"Prevents the display of pushpins by setting their visibility to false.  Pushpins must be enabled for this command to work.",isHyperlinkable:!0,visibility:"public"}},{name:"SetCollectionOfInterest",metadata:{arguments:"string",description:"Sets the FeatureSetCollection of interest that will be used to generate data for Charts.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowChartingView",metadata:{arguments:"none",
description:"Activates the charting view.",isHyperlinkable:!0,visibility:"public"}},{name:"DisplayBufferOptions",metadata:{arguments:"string",description:"Displays the Buffer Options dialog for the specified target command",isHyperlinkable:!0,visibility:"public"}},{name:"DisplayChartById",metadata:{arguments:"string",description:"Opens the specified chart in the charting view.",isHyperlinkable:!0,visibility:"public"}},{name:"RemoveChartById",metadata:{arguments:"string",description:"Removes the specified chart from the charting view.",
isHyperlinkable:!0,visibility:"public"}},{name:"ClearCharts",metadata:{arguments:"none",description:"Removes all charts from the charting view.",isHyperlinkable:!0,visibility:"public"}},{name:"ClearFeatureInformation",metadata:{arguments:"none",description:"Used to 'reset' the information stored within RelatedFeatures (which features are currently open, etc.)",isHyperlinkable:!0,visibility:"public"}},{name:"DisableMapClick",metadata:{arguments:"none",description:"Prevents the commands configured to execute on map click from executing and also prevents the MapClickedEvent from firing.",
isHyperlinkable:!0,visibility:"public"}},{name:"DisableMapTips",metadata:{arguments:"none",description:"Disables the display of map tips on the map.",isHyperlinkable:!0,visibility:"public"}},{name:"EnableAllLayersForIdentify",metadata:{arguments:"none",description:"Enables all identifiable layers such that they participate in Identify operations",isHyperlinkable:!0,visibility:"public"}},{name:"DisableAllLayersForIdentify",metadata:{arguments:"none",description:"Disables all identifiable layers such that they do not participate in Identify operations",
isHyperlinkable:!0,visibility:"public"}},{name:"EnableLayerForIdentify",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.identify.LayerDescriptor",description:"Enables the specified layer, if it's identifiable, such that it participates in Identify operations.",isHyperlinkable:!0,visibility:"public"}},{name:"DisableLayerForIdentify",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.identify.LayerDescriptor",description:"Disables the specified layer, if it's in the list of identifiable layers, such that it does not participate in Identify operations.",
isHyperlinkable:!0,visibility:"public"}},{name:"EnableMapClick",metadata:{arguments:"none",description:"Enables all configured commands to execute on map click and also wires up the MapClickEvent to fire when the map is clicked.",isHyperlinkable:!0,visibility:"public"}},{name:"EnableMapTips",metadata:{arguments:"none",description:"Enables the display of map tips on the map.",isHyperlinkable:!0,visibility:"public"}},{name:"HideAllMapTips",metadata:{arguments:"none",description:"Prevents the display of map tips by setting their visibility to `false`.  Map tips must be enabled for this command to work.",
isHyperlinkable:!0,visibility:"public"}},{name:"HideMapTips",metadata:{arguments:"none",description:"Prevents the display of map tips by setting their visibility to `false`, and suspends displaying map tips.  Map tips must be enabled for this command to work.",isHyperlinkable:!0,visibility:"public"}},{name:"RestoreAllMapTips",metadata:{arguments:"none",description:"Displays previously hidden map tips by setting their visibility to `true`.  Map tips must be enabled for this command to work.",isHyperlinkable:!0,
visibility:"public"}},{name:"ShowAllCoordinates",metadata:{arguments:"none",description:"Shows all plotted coordinates (including temporarily hidden ones) on the map.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowCoordinates",metadata:{arguments:"string|string[]",description:"Shows one or many plotted, hidden Coordinates on the map.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowMapTips",metadata:{arguments:"none",description:"Displays previously hidden map tips by setting their visibility to `true`, and resumes displaying map tips.  Map tips must be enabled for this command to work.",
isHyperlinkable:!0,visibility:"public"}},{name:"ToggleMouseCoordinates",metadata:{arguments:"none",description:"Toggles the visibility of the mouse coordinates widget if present.",isHyperlinkable:!0,visibility:"public"}},{name:"SetTimeExtent",metadata:{arguments:"esri.TimeExtent",description:"Sets the time extent for the map.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowShareView",metadata:{arguments:"none",description:"Activates the share view",isHyperlinkable:!0,visibility:"public"}},{name:"ShareOn",
metadata:{arguments:"string",description:"Shares the Viewer url on the specified platform",isHyperlinkable:!0,visibility:"public"}},{name:"ScreenReaderNarrate",metadata:{arguments:"string",description:"If a user has screenreader software enabled, then the provided string is immediately spoken to them.",isHyperlinkable:!0,visibility:"public"}},{name:"DisableScreenReaderNarrate",metadata:{arguments:"none",description:"Disables the 'ScreenReaderNarrate' command temporarily.",isHyperlinkable:!0,visibility:"public"}},
{name:"EnableScreenReaderNarrate",metadata:{arguments:"none",description:"Enables screen reader narration if it was previously disabled using DisableScreenReaderNarrate.",isHyperlinkable:!0,visibility:"public"}},{name:"BroadcastCurrentViewpoint",metadata:{arguments:"string",description:"Broadcasts the viewers current viewpoint to the specified external component.",isHyperlinkable:!0,visibility:"private"}},{name:"UpdateStatus",metadata:{arguments:"string",description:"Updates the message shown on the status indicator.",
isHyperlinkable:!0,visibility:"public"}},{name:"UploadData",metadata:{arguments:"none",description:"Prompt the user to upload layers onto the map straight from their own computer.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowExternalComponentView",metadata:{arguments:"none",description:"Activates the external component view.",isHyperlinkable:!0,visibility:"public"}},{name:"DisplayDockedExternalComponentById",metadata:{arguments:"string",description:"Opens the specified external component in the external components view. If this component is open in a separate window, it will be closed.",
isHyperlinkable:!0,visibility:"public"}},{name:"DisplayUndockedExternalComponentById",metadata:{arguments:"string",description:"Opens the specified external component in a separate window from the viewer. If this component is open in the viewer, it will be closed.",isHyperlinkable:!0,visibility:"public"}},{name:"RemoveExternalComponentById",metadata:{arguments:"string",description:"Removes the specified external component from the viewer. If the component is in a separate window, that window will be closed.",
isHyperlinkable:!0,visibility:"public"}},{name:"ToggleExternalComponentSyncById",metadata:{arguments:"string",description:"Toggle whether the specified external component is synchronized with the viewer.",isHyperlinkable:!0,visibility:"private"}},{name:"ListenToExternalComponentFrame",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.integration.ComponentFrameInfo",description:"Wires up a PostMessage Transport and enables bi-directional communication with the component.",isHyperlinkable:!0,
visibility:"private"}},{name:"CreateOrEditFeatureFromBarcodeScan",metadata:{arguments:"object",description:"Launch the barcode scanner, and use the result to create a new feature or edit an existing one.",isHyperlinkable:!0,visibility:"public"}},{name:"LaunchBarcodeScannerWithCallback",metadata:{arguments:"none",description:"Lauches a QR scan, then calls the provided callback with the result.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowMarkers",metadata:{arguments:"none",description:"Displays markers by setting their visibility to `true`.",
isHyperlinkable:!0,visibility:"private"}},{name:"HideMarkers",metadata:{arguments:"none",description:"Prevents the display of markers by setting their visibility to `false`.",isHyperlinkable:!0,visibility:"private"}},{name:"AddMarker",metadata:{arguments:"string",description:"Creates and displays a marker on the map.",isHyperlinkable:!0,visibility:"private"}},{name:"RemoveMarker",metadata:{arguments:"string",description:"Removes the marker from the map.",isHyperlinkable:!0,visibility:"private"}},
{name:"UpdateMarker",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.MarkerArgs",description:"Updates the marker with the given marker arguments.",isHyperlinkable:!0,visibility:"private"}},{name:"ShowAccessibilityView",metadata:{arguments:"none",description:"Activates the accessibility view.",isHyperlinkable:!0,visibility:"public"}},{name:"AddClusterLayer",metadata:{arguments:"string",description:"Adds a cluster layer to an existing Geocortex Layer that holds an Esri FeatureLayer.",
isHyperlinkable:!0,visibility:"public"}},{name:"RemoveClusterLayer",metadata:{arguments:"string",description:"Removes a cluster layer from an existing Geocortex Layer that holds an Esri FeatureLayer.",isHyperlinkable:!0,visibility:"public"}},{name:"AddHeatMap",metadata:{arguments:"string",description:"Adds a heat map visualization to a given Geocortex layer.",isHyperlinkable:!0,visibility:"public"}},{name:"Redo",metadata:{arguments:"none",description:"Reverses the last recorded undo operation or transaction.",
isHyperlinkable:!0,visibility:"public"}},{name:"RemoveHeatMap",metadata:{arguments:"string",description:"Removes a heat map visualization from a Geocortex layer.",isHyperlinkable:!0,visibility:"public"}},{name:"RemoveVisualization",metadata:{arguments:"string",description:"Removes the visualization from a Geocortex layer, if one is enabled.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowVisualizationView",metadata:{arguments:"string",description:"Shows the visualization options view for a given Geocortex layer if the layer supports any visualizations.",
isHyperlinkable:!0,visibility:"public"}},{name:"Undo",metadata:{arguments:"none",description:"Invokes the last recorded undo operation or transaction.",isHyperlinkable:!0,visibility:"public"}},{name:"CreateGraphicsInMemory",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.EditInMemoryArgs",description:"Creates new graphics. These edits are only applied to the graphics layer in memory.",isHyperlinkable:!0,visibility:"private"}},{name:"UpdateGraphicsInMemory",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.UpdateGraphicsArgs",
description:"Updates existing graphics. These edits are only applied to the graphics layer in memory.",isHyperlinkable:!0,visibility:"private"}},{name:"DeleteGraphicsInMemory",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.EditInMemoryArgs",description:"Deletes graphics. These edits are only applied to the graphics layer in memory.",isHyperlinkable:!0,visibility:"private"}},{name:"CutGraphicsInMemory",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.CutGraphicsArgs",
description:"Cut graphics using a polyline. These edits are only applied to the graphics layer in memory.",isHyperlinkable:!0,visibility:"private"}},{name:"ExplodeGraphicsInMemory",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.EditInMemoryArgs",description:"Separates multi-part graphics into individual graphics. These edits are only applied to the graphics layer in memory.",isHyperlinkable:!0,visibility:"private"}},{name:"UnionGraphicsInMemory",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.EditInMemoryArgs",
description:"Merge graphics into a single graphic. These edits are only applied to the graphics layer in memory.",isHyperlinkable:!0,visibility:"private"}},{name:"DeleteProject",metadata:{arguments:"string",description:"Deletes a project.",isHyperlinkable:!0,visibility:"public"}},{name:"LoadProject",metadata:{arguments:"string",description:"Loads a project and applies it to the viewer.",isHyperlinkable:!0,visibility:"public"}},{name:"ListSelections",metadata:{arguments:"none",description:"List the available selections.",
isHyperlinkable:!0,visibility:"public"}},{name:"RefreshProjectsList",metadata:{arguments:"none",description:"Refresh the list of browsable projects.",isHyperlinkable:!0,visibility:"public"}},{name:"RegisterChartPointAdapter",metadata:{arguments:"object",description:"Register the chart point adapter.",isHyperlinkable:!0,visibility:"private"}},{name:"SaveAsProject",metadata:{arguments:"none",description:"Displays the user interface to fill in details about a project to be saved.",isHyperlinkable:!0,
visibility:"public"}},{name:"SaveProject",metadata:{arguments:"none",description:"Save the current state of the viewer as a project or displays the user interface to fill in details about the project to be saved.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowProjectEditor",metadata:{arguments:"string",description:"Shows the user interface for editing a project.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowProjects",metadata:{arguments:"none",description:"Shows the user interface for browsing and loading projects.",
isHyperlinkable:!0,visibility:"public"}},{name:"ShowShareProject",metadata:{arguments:"string",description:"Shows the user interface for sharing projects.",isHyperlinkable:!0,visibility:"public"}},{name:"HideFeatureDetails",metadata:{arguments:"none",description:"Hides the Feature Details dialog.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowSaveSelectionDialog",metadata:{arguments:"string",description:"Displays a dialog to save a FeatureSetCollection as a named selection.",isHyperlinkable:!0,
visibility:"public"}},{name:"CreateSelection",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.SelectionArgs",description:"Creates a new named, saved selection based on the supplied FeatureSetCollection.",isHyperlinkable:!0,visibility:"private"}},{name:"DeleteSelection",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.SelectionArgs",description:"Deletes a named selection.",isHyperlinkable:!0,visibility:"private"}},{name:"FindSelection",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.FindSelectionArgs",
description:"Looks up a particular named selection.",isHyperlinkable:!0,visibility:"private"}},{name:"RenameSelection",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.RenameSelectionArgs",description:"Assigns a new name to a saved selection.",isHyperlinkable:!0,visibility:"private"}},{name:"RestoreSelection",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.SelectionArgs",description:"Loads a named, saved selection into the results view.",isHyperlinkable:!0,
visibility:"private"}},{name:"UpdateSelection",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.SelectionArgs",description:"Updates an existing named, saved selection with the supplied FeatureSetCollection.",isHyperlinkable:!0,visibility:"private"}},{name:"UpdateSelectionFindAllSelectionMetadata",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.FindAllSelectionMetadataArgs",description:"Lists all the available metadata for named selections.",
isHyperlinkable:!0,visibility:"private"}},{name:"FindMetadataForSelection",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.FindMetadataForSelectionArgs",description:"Looks up metadata about a particular named selection.",isHyperlinkable:!0,visibility:"private"}},{name:"AddFeatureToResults",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",description:"Adds an individual feature to the current FeatureSetCollection displayed in the results view.",
isHyperlinkable:!0,visibility:"public"}},{name:"RemoveFeatureFromResults",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",description:"Removes an individual feature from the current FeatureSetCollection displayed in the results view.",isHyperlinkable:!0,visibility:"public"}},{name:"CombineResults",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.CombineResultsArgs",description:"Performs advanced set operations with multiple lists of results.",
isHyperlinkable:!0,visibility:"public"}},{name:"CombineResultsInteractive",metadata:{arguments:"object",description:"Performs advanced set operations with multiple lists of results.",isHyperlinkable:!0,visibility:"public"}},{name:"ResultsIntersect",metadata:{arguments:"string",description:"Only keeps results from the current set of results that also appear in the supplied FeatureSetCollection.",isHyperlinkable:!0,visibility:"public"}},{name:"ResultsReplace",metadata:{arguments:"string",description:"Replaces the current set of results with the FeatureSetCollection supplied as argument.",
isHyperlinkable:!0,visibility:"public"}},{name:"ResultsSubtract",metadata:{arguments:"string",description:"Removes the supplied FeatureSetCollection from the current set of results.",isHyperlinkable:!0,visibility:"public"}},{name:"ResultsUnion",metadata:{arguments:"string",description:"Adds the supplied FeatureSetCollection to the current set of results.",isHyperlinkable:!0,visibility:"public"}},{name:"AddResultsStatus",metadata:{arguments:"string",description:"Displays a status indicator that can relay short messages in the results list or table.",
isHyperlinkable:!0,visibility:"public"}},{name:"RemoveResultsStatus",metadata:{arguments:"none",description:"Removes the status indicator from the results list or table.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowCopyDialogForEvent",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.collaboration.RestEvent",description:"Opens the Collaboration event copy view.",isHyperlinkable:!0,visibility:"public"}},{name:"OpenCollaboration",metadata:{arguments:"none",description:"Opens the Collaboration view.",
isHyperlinkable:!0,visibility:"public"}},{name:"OpenAfterActionPlayback",metadata:{arguments:"none",description:"Opens the After Action Playback view.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowEditCollaborationGraphicMessageView",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",description:"Edit the associated message for a collaboration event using one of its drawn features.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowEditCollaborationMessageView",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.collaboration.RestEvent",
description:"Edit the associated message for a collaboration event using its rest event",isHyperlinkable:!0,visibility:"public"}},{name:"AutoJoinCollaborationRoom",metadata:{arguments:"string",description:"Add a collaboration room to the auto join list.",isHyperlinkable:!0,visibility:"public"}}];f.metadataForCommandName=function(l){for(var e=0;e<f.commandsMetadata.length;e++){var c=f.commandsMetadata[e];if(c.name===l)return c.metadata}return null};f.publicCommands=function(){for(var l=[],e=0;e<f.commandsMetadata.length;e++){var c=
f.commandsMetadata[e];"public"===c.metadata.visibility&&l.push(c)}return l}})(f.Commands||(f.Commands={}))});
define("infrastructure/FeatureDescriptionPresenterView","require exports geocortex/framework/ui/ViewBase infrastructure/validation/XssHtmlValidator infrastructure/Feature geocortex/framework/utils/utils infrastructure/FilterUtils geocortex/essentials/utilities/StringUtilities commands.meta".split(" "),function(h,f,k,l,e,c,a,b,d){h=function(g){function m(a,b){var d=g.call(this,a,b)||this;d._xssHtmlValidator=new l.XssHtmlValidator({contentPolicy:a.defaultContentPolicy});return d}__extends(m,g);m.prototype.attach=
function(a){var b=this;if(a&&a instanceof e.Feature)return this.descriptionApply(a,this.root).then(function(){return g.prototype.attach.call(b,a)});g.prototype.attach.call(this,a);return Promise.resolve()};m.prototype.descriptionGet=function(a){return this.getDescriptionContent(a)};m.prototype.getContentFieldFormat=function(a){switch(this.contentField){case "label":return a.labelFormat.get();case "description":return a.descriptionFormat.get();case "longDescription":return a.longDescriptionFormat.get();
default:return a.longDescriptionFormat.get()}};m.prototype.getDescriptionContent=function(a,b){var d=this,c=b;c||(c=this.getContentFieldFormat(a));var g=this._extractCommandHyperlinks(c),c=g.html;return this._sanitizeHtml(a.formatTemplateString(c)).then(function(a){g.html=a;a=d._injectCommandHyperlinks(g);return a=d.insertLinkAndImageBindings(a)})};m.prototype.descriptionApply=function(a,b){return this.applyDescriptiveTemplate(a,b)};m.prototype.applyDescriptiveTemplate=function(a,b){var d=this,c=
[],g=this.getContentFieldFormat(a);if(g&&a.hasRelationships){var e=g.match(/{{.[^}]+?\..+?}}|{.[^}]+?\..+?}/g),m=[],f;for(f in e)if(e.hasOwnProperty(f)){var l=e[f],l=l.substr(1,l.length-2);m.push(l.match(/[^.].[^.]*/g))}if(m.length&&a.layer&&a.layer.relationships)for(f in a.layer.relationships)if(a.layer.relationships.hasOwnProperty(f)){var h=a.layer.relationships[f];-1==m.toString().indexOf(h.name)&&-1==m.toString().indexOf(h.displayName)||c.push(new Promise(function(c,f){d.app.command("GetRelatedFeatures").execute({mapService:a.layer.mapService,
currentFeature:a,relationshipId:h.id,objectId:a.id.get(),successCallback:function(f){return function(l){if(0<l.length)for(var h in m){if(m.hasOwnProperty(h)){var k=l[0],s=m[h],v=s[0].trim(),s=s[1].trim();if(-1!==f.indexOf(v)&&void 0!==k.attributes[s])for(h in e)if(e.hasOwnProperty(h)){var x=e[h];-1!==g.indexOf(x)&&-1!==x.indexOf(v)&&-1!==x.indexOf(s)&&(g=g.replace(x,k.attributes[s]),d.getDescriptionContent(a,g).then(function(a){return b.innerHTML=a}).then(function(){return c()}))}}}else c()}}("{0}-{1}".format(h.name,
h.displayName)),errorCallback:function(a){a.message="There was an error retrieving related features: "+a.message;d.app.trace.warning(a.message);c(a)}})}))}}c.push(this.getDescriptionContent(a).then(function(a){return b.innerHTML=a}));return Promise.all(c).then(function(){return null})};m.prototype._extractCommandHyperlinks=function(a){var b=[];if(!a)return{html:a,commandHyperlinkPlaceholders:b};a=a.replace(/\bhref="#?command:.*?"/ig,function(a){var d='href="mailto:'+c.alphaNumericToken()+'"';b.push({commandHyperlink:a,
placeholder:d});return d});return{html:a,commandHyperlinkPlaceholders:b}};m.prototype._injectCommandHyperlinks=function(a){var b=a.html,d=a.commandHyperlinkPlaceholders;return b?b.replace(/\bhref="mailto:.*?"/ig,function(a){for(var b=0;b<d.length;b++){var c=d[b];if(a===c.placeholder)return c.commandHyperlink}return a}):""};m.prototype._sanitizeHtml=function(b){return this._xssHtmlValidator.validate(b,{sanitizeOptions:{allowFrames:!0,allowArbitraryHyperlinks:!0,uriTransformer:function(b,d){return d.type!==
a.UriType.NavigableLink?b:/^mailto\:/.test(b)?b:"command:OpenWebPage?"+b}}}).then(function(a){return a.validatedValue})};m.prototype.cleansedFormatForFormat=function(a){return this.insertLinkAndImageBindings(a)};m.prototype.insertLinkAndImageBindings=function(a){var b=this;if(null===a)return null;if(a in this._descFormats)return this._descFormats[a];var d=/(<a.*?href\s*?=\s*?")(command:.+?)(".*?)(\/?>)/,c=a.replace(/<a[^>]*(\/?>)/g,function(a,c,g,e){return(c=a.match(d))?(g="",(a=a.match(/(title|aria-label)\s*?=\s*?"[^"]*?"/g))&&
(g=" "+a.join(" ")),'<a _key="'+b.keyForUri(c[2])+'" href="javascript:void(0)" data-binding="{@event-onclick: handleHyperlinkClick}{@event-mouseup: ignoreEvent}{@event-mousedown: ignoreEvent}"'+g+c[4]):a}),c=c.replace(/<img/g,'<img data-binding="{@event-load: handleImgLoad}"');return this._descFormats[a]=c};m.prototype.handleImgLoad=function(a){};m.prototype.keyForUri=function(a){var b=dojo.indexOf(this._uris,a);0<=b?b:(b=this._uris.length,this._uris.push(a));return b};m.prototype.parseArguments=
function(a,b,d){var c={};if("none"===b)return null;if("string"===b)return this.tryPerformTokenSubstitution(a,d,c)?[c.value]:[a];if("list"===b){var g;try{g=JSON.parse(a)}catch(e){g=a.split("&")}for(var m=0;m<g.length;m++)this.tryPerformTokenSubstitution(g[m],d,c)&&(g[m]=c.value);return g}try{m=JSON.parse(a)}catch(f){if(0>a.indexOf("=")){if(this.tryPerformTokenSubstitution(a,d,c))return[c.value];this.app.trace.warning("The specified parameter could not be parsed to a valid Object in JSON or Query String format.");
return[null]}m=dojo.queryToObject(a)}for(var l in m)m.hasOwnProperty(l)&&"function"!==typeof m[l]&&this.tryPerformTokenSubstitution(m[l],d,c)&&(m[l]=c.value);d=null;"object"!==b&&(b=dojo.getObject(b)(),d=m,m=dojo.safeMixin(b,m));d&&m.spatialReference&&!d.spatialReference&&(m.spatialReference=null);return[m]};m.prototype.tryPerformTokenSubstitution=function(a,d,c){var g=this;if(null===a||void 0===a||!(d&&d instanceof e.Feature))return c.value=null,!1;var m=d.esriFeature&&d.esriFeature.get&&d.esriFeature.get()||
null;if("{$Feature}"===a)return c.value=d,!0;if("{$Graphic}"===a)return c.value=m||null,null===c.value?!1:!0;if("{$Geometry}"===a)return c.value=m&&m.geometry||null,null===c.value?!1:!0;if("string"===typeof a){var f=!1;a=a.replace(/{.+?}/g,function(a){f=!0;var c=a.substring(1,a.length-1),e=m&&m.attributes[c];if(e)return e;!e&&d.layer&&(e=b.StringUtilities.replaceLayerTokens(c,d.layer));!e&&d.layer&&d.layer.mapService&&(e=b.StringUtilities.replaceMapServicetokens(c,d.layer.mapService));if(0<e.length)return e;
g.app.trace.warning("The token syntax {"+c+"} was detected, but could not be matched to a valid replacement value.");return a});c.value=a;return f}return!1};m.prototype.decodeHtmlQuotes=function(a){a=a.replace(/&quot;/g,'"');return a=a.replace(/&39;/g,"'")};m.prototype.decodeHtmlAmpersands=function(a){return a=a.replace(/&amp;/g,"&")};m.prototype.handleHyperlinkClick=function(a,b,d){a=b.getAttribute("_key");if(a=this._uris[a]){var c=new dojo._Url(a);"command"===c.scheme&&(a=c.path,b=c.query,(c=c.fragment)&&
(b+="#"+c),this.runCommand(a,b,d))}return!1};m.prototype.ignoreEvent=function(a,b,d){return!1};m.prototype.runCommand=function(a,b,c){var g=this.app.command(a),e=d.Commands.metadataForCommandName(a);if(null===e)this.app.trace.warning('The specified command "{0}" has no associated metadata.'.format(a));else if(e.isHyperlinkable){var m=[];b&&(b=this.decodeHtmlQuotes(b),b=this.decodeHtmlAmpersands(b),m=this.parseArguments(b,e.arguments,c));"OpenWebPage"==a?(a=[],a.push({url:m[0],isLink:!0}),g.execute.apply(g,
a)):g.execute.apply(g,m)}else this.app.trace.warning('The specified command "{0}" is not able to be hyperlinked.'.format(a))};return m}(k.ViewBase);f.FeatureDescriptionPresenterView=h;h.prototype._uris=[];h.prototype._descFormats={};h.prototype.contentField=null});
define("infrastructure/FocusUtils",["require","exports","geocortex/framework-ui/animation/AnimationSequence"],function(h,f,k){function l(e){e&&k.runWhenIdle(function(){try{e!==document.activeElement&&e.focus()}catch(c){}})}f.focusOnFirstInput=function(e){if(e&&e.root&&!(e.app&&e.app.modalRegionSingleton&&e.app.modalRegionSingleton.isActive&&"ModalViewContainerView"!==e.id))try{for(var c=$(e.root).find("input, a, button, select, textarea, [tabindex]").not(".inactive, .bound-invisible, .disabled, .close-16, .back-16, [tabindex=-1], [readonly]:not(.control-readonly)"),
a=0;a<c.length;a++){var b=c[a];if(!(1<=$(b).parentsUntil(e.root,".inactive, .bound-invisible, .disabled, .invisible, .hidden-hoisted-menu").length)){if(-1!==$.inArray(b.tagName.toLowerCase(),["select","input","textarea"])){if(b===document.activeElement)break;$(b).addClass("control-readonly");b.setAttribute("readonly","true");l(b);$(b).one("blur",function(a){b.removeAttribute("readonly");$(b).removeClass("control-readonly")});$(document).off("keypress.focus-control mousedown.focus-control touchstart.focus-control");
$(document).off("keydown.focus-control");$(document).on("keydown.focus-control",function(a){b.getAttribute("readonly")?8===a.keyCode&&a.preventDefault():$(document).off("keydown.focus-control")});$(document).one("keypress.focus-control mousedown.focus-control touchstart.focus-control",function(a){return function(a,b){b.removeAttribute("readonly");$(b).removeClass("control-readonly");if((a.target||a.srcElement)!==b)b.blur();else{b.blur();l(b);var d=b.getAttribute("type");d&&d.toLowerCase&&(d=d.toLowerCase());
("textarea"===b.tagName.toLowerCase()||"true"===b.contentEditable||d&&0<="date datetime datetime-local email month number password search text tel time week".split(" ").indexOf(d))&&"keypress"===a.type&&(0!=a.keyCode&&$(b).val($(b).val()+String.fromCharCode(a.keyCode)),/Edge\/\d+/i.test(navigator.userAgent)&&setTimeout(function(){b.setSelectionRange(1,1)},10))}$(document).off("keypress.focus-control mousedown.focus-control touchstart.focus-control");$(document).off("keydown.focus-control")}(a,b)})}else l(b);
break}}}catch(d){e.app&&e.app.trace.debug("Could not focus: "+d)}};f.focusOnMap=function(e){if(e){var c=function(a){a=a.root;$(a).find("svg").attr("focusable","false");a.tabIndex=0;l(a)};if(e.loaded)c(e);else var a=e.on("load",function(b){a.remove();c(b.map)})}};f.focus=l});
define("infrastructure/HtmlUtils",["require","exports"],function(h,f){f.pollUntil=function(f,l,e){return new Promise(function(c,a){if("undefined"===typeof l||null===l||1>l)l=500;if("undefined"===typeof e||null===e||1>e)e=2E4;if(f())c();else var b=(new Date).getTime(),d=setInterval(function(){f()&&(clearInterval(d),c());(new Date).getTime()-b>e&&(clearInterval(d),a("timeout"))},l)})}});
define("infrastructure/SecurityUtils",["require","exports","geocortex/framework/utils/ArrayUtils"],function(h,f,k){function l(e,c,a){return k.firstOrDefault(e.claims,function(b){return b.type===c&&b.value===a})}f.getIdentity=function(e,c){var a=c.site;return a&&a.principal&&a.principal.identities?k.firstOrDefault(a.principal.identities,function(a){return a.authenticationType===e}):null};f.getClaimsByType=function(e,c){return e.claims.filter(function(a){return a.type===c})};f.getClaimsByValue=function(e,
c){return e.claims.filter(function(a){return a.value===c})};f.getClaimByTypeAndValue=l;f.hasPrivilegeClaim=function(e,c){return!!l(e,"http://www.geocortex.net/security/claims/privilege",c)}});
define("infrastructure/PortalUtils",["require","exports","infrastructure/SecurityUtils"],function(h,f,k){function l(c){return k.getIdentity("ags-oauth2",c)}function e(c){c=l(c);return c?(c=k.getClaimsByType(c,"http://www.geocortex.com/security/ags/portal")[0])?c.value:null:null}f.getPortalIdentity=l;f.hasAccessToPortal=function(c){return!!l(c)};f.hasCreateContentPrivilege=function(c){return(c=l(c))?k.hasPrivilegeClaim(c,"portal:user:createItem"):!1};f.hasPublishFeaturePrivilege=function(c){return(c=
l(c))?k.hasPrivilegeClaim(c,"portal:publisher:publishFeatures"):!1};f.getPortalBaseUrl=e;f.getPortalMyContentUrl=function(c){var a=e(c);return a?String.format("{0}{1}",a,c.configuration.portalContentRelUrl||"home/content.html"):null};f.getPortalItemUrl=function(c,a){var b=e(a);return b?String.format("{0}{1}{2}",b,a.configuration.portalItemRelUrl||"home/item.html?id=",c):null}});
define("infrastructure/Reporting",["require","exports","infrastructure/FeatureSetCollection","infrastructure/FeatureSet","infrastructure/Feature"],function(h,f,k,l,e){f.getAllFeaturesFromReportable=function(c){var a=[];c instanceof k.FeatureSetCollection?c.featureSets.get().forEach(function(b){b.features.get().forEach(function(b){a.push(b)})}):c instanceof l.FeatureSet?c.features.get().forEach(function(b){a.push(b)}):c instanceof e.Feature?a.push(c):c&&c.constructor===Array&&(a=c);return a}});
define("infrastructure/ReverseGeocoder",["require","exports","geocortex/essentials/GeocodingEndpoint","infrastructure/GeometryUtils"],function(h,f,k,l){h=function(){function e(c,a){this.geocoder=this._noGeocoderConfigured;this.geocoderUrl=this.geocoderToken=null;this.SEARCH_RADIUS=1E3;this.AGS_ADDRESS_FIELD="Match_addr";this.BING_REQUEST_TEMPLATE="http://dev.virtualearth.net/REST/v1/Locations/{0},{1}?{2}key={3}";this.app=c;this._initializeGeocoder(a)}e.prototype.reverseGeocode=function(c){var a=this;
return new Promise(function(b,d){if(a.app.isOffline.get())return d(Error("Could not execute Reverse Geocode: Application is offline"));if(!c.spatialReference)return d(Error("Could not execute Reverse Geocode: Point had no spatial reference"));a.geocoder(c).then(function(a){b(a)},function(a){d(a)})})};e.prototype._initializeGeocoder=function(c){var a=this;c&&c.geocoderUrl&&(this.geocoderUrl=c.geocoderUrl);c&&c.geocoderToken&&(this.geocoderToken=c.geocoderToken);c.geocoderType===k.GeocodingEndpointType.ARCGIS_GEOCODER?
(this._agsGeocoder&&this._agsGeocoder.url===c.geocoderUrl||(c=this._updateUrl(this.geocoderToken),this._agsGeocoder=new esri.tasks.Locator(c)),this.geocoderToken&&dojo.subscribe("ServiceTokenRefreshed",function(b){b.serviceUrl==a.geocoderUrl&&(b=a._updateUrl(b.token),a._agsGeocoder=new esri.tasks.Locator(b))}),this.geocoder=this._executeAgsReverseGeocode):c.geocoderType===k.GeocodingEndpointType.BING_GEOCODER&&c.bingProperties&&c.bingProperties.bingMapsKey&&(this._bingMapsKey=c.bingProperties.bingMapsKey,
c.bingProperties.culture&&(this._bingMapsCulture=c.bingProperties.culture),this.geocoder=this._executeBingReverseGeocode)};e.prototype._updateUrl=function(c){this.geocoderToken=c;return this.geocoderUrl+(this.geocoderToken?"?token="+encodeURIComponent(this.geocoderToken):"")};e.prototype._parseAddressObject=function(c){var a=[],b=null,d;for(d in c)c[d]&&a.push(c[d]);0<a.length&&(b=a.join(", "));return b};e.prototype._executeAgsReverseGeocode=function(c){var a=this;return new Promise(function(b,d){a._agsGeocoder.locationToAddress(c,
a.SEARCH_RADIUS).then(function(c){if(!c.address||!c.location)return a.app.trace.warning("Check geocoder configuration. No results were returned from a reverse geocode."),d("Check geocoder configuration. No results were returned from a reverse geocode.");c={address:c.address[a.AGS_ADDRESS_FIELD]||a._parseAddressObject(c.address),location:c.location};return b(c)},function(a){return d(a)})})};e.prototype._executeBingReverseGeocode=function(c){var a=this;return new Promise(function(b,d){l.projectGeometry(c,
new esri.SpatialReference(4326),function(c){c=a.BING_REQUEST_TEMPLATE.format(c.y,c.x,a._bingMapsCulture?"c="+a._bingMapsCulture+"&":"",a._bingMapsKey);dojo.xhrGet({url:a.app.configuration.proxyUri+c,handleAs:"json",load:function(a){a&&0<a.resourceSets.length&&0<a.resourceSets[0].resources.length?(a=a.resourceSets[0].resources[0],a={location:new esri.geometry.Point(a.point.coordinates[1],a.point.coordinates[0],new esri.SpatialReference(4326)),address:a.address.formattedAddress},b(a)):d(Error("Reverse Geocode: No response from Bing Geocoder."))},
error:function(a){d(a)}})},function(a){},a.app)})};e.prototype._noGeocoderConfigured=function(c){return new Promise(function(a,b){b(Error("Reverse Geocoder: No geocoder configured"))})};return e}();f.ReverseGeocoder=h});
define("infrastructure/TimeSliderUtils",["require","exports","geocortex/essentials/TimeUnits"],function(h,f,k){function l(e){if(!e)return NaN;var c=0;switch(e){case k.TimeUnits.UNIT_MILLISECONDS:c=1;break;case k.TimeUnits.UNIT_SECONDS:c=1E3;break;case k.TimeUnits.UNIT_MINUTES:c=6E4;break;case k.TimeUnits.UNIT_HOURS:c=36E5;break;case k.TimeUnits.UNIT_DAYS:c=864E5;break;case k.TimeUnits.UNIT_WEEKS:c=6048E5;break;case k.TimeUnits.UNIT_MONTHS:c=Math.round(26784E5);break;case k.TimeUnits.UNIT_YEARS:c=
31536E6;break;case k.TimeUnits.UNIT_DECADES:c=31536E7;break;case k.TimeUnits.UNIT_CENTURIES:c=31536E8;break;default:c=NaN}return c}f.convertTimeUnitToMilliseconds=l;f.computeTimeIntervalInMs=function(e,c){var a=l(c);return isNaN(parseInt(e,10))||isNaN(a)?NaN:a*e}});
define("infrastructure/VisualizationUtils",["require","exports"],function(h,f){f.getFeatureHeatMap=function(f){return f&&f.mapService?(f.includeInLegend&&f.mapService.heatMap&&(f.mapService.heatMap.includeInLegend=f.includeInLegend),f.mapService.heatMap):null};f.getHeatMapRenderer=function(f){if(!f||!f.mapService||!f.mapService.serviceLayer)return null;f=f.mapService.serviceLayer.renderer;return f instanceof esri.renderer.HeatmapRenderer?f:null}});
define("infrastructure/accessibility/AccessibilityProviderBase",["require","exports"],function(h,f){var k=function(){function f(e,c){this.app=e;this.libraryId=c}f.prototype.initialize=function(e){e.id&&(this.id=e.id)};return f}();f.AccessibilityProviderBase=k});define("infrastructure/buffer/BufferDistanceChangedEventArgs",["require","exports"],function(h,f){});define("infrastructure/buffer/DisplayBufferOptionsArgs",["require","exports"],function(h,f){});
define("infrastructure/collaboration/RestRoom",["require","exports"],function(h,f){});define("infrastructure/collaboration/RestEvent",["require","exports"],function(h,f){});define("infrastructure/collaboration/ICollaborationEventViewModel",["require","exports"],function(h,f){});define("infrastructure/collaboration/RestRoomRequestArgs",["require","exports"],function(h,f){});define("infrastructure/collaboration/QueryResponse",["require","exports"],function(h,f){});
define("infrastructure/collaboration/QueryOptions",["require","exports"],function(h,f){});define("infrastructure/collaboration/RestEventRequestArgs",["require","exports"],function(h,f){});define("infrastructure/collaboration/RoomQueryOptions",["require","exports"],function(h,f){});define("infrastructure/collaboration/ICollaborationHandler",["require","exports"],function(h,f){});
define("infrastructure/commandArgs/AddStatusArgs",["require","exports"],function(h,f){var k=function(){return function(f,e,c,a,b,d){this.text=f;this.imageProperties=e;this.userClosedCallback=c;this.id=a;this.timeoutMS=b||3E4;this.showBusyIcon=!!d}}();f.AddStatusArgs=k});define("infrastructure/commandArgs/ClusterLayerArgs",["require","exports"],function(h,f){var k=function(){return function(){}}();f.ClusterLayerArgs=k});
define("infrastructure/selection/CombineResultsResponse",["require","exports"],function(h,f){});define("infrastructure/commandArgs/CombineResultsArgs",["require","exports"],function(h,f){});define("infrastructure/commandArgs/ContextMenuArgs",["require","exports"],function(h,f){});define("infrastructure/commandArgs/CreateOrEditFeatureFromBarcodeScanArgs",["require","exports"],function(h,f){});define("infrastructure/commandArgs/EditInMemoryArgs",["require","exports"],function(h,f){});
define("infrastructure/commandArgs/CutGraphicsArgs",["require","exports"],function(h,f){});define("infrastructure/commandArgs/DeleteAttachmentsArgs",["require","exports"],function(h,f){});define("infrastructure/commandArgs/DownloadOfflineResourcesArgs",["require","exports"],function(h,f){});define("infrastructure/commandArgs/EditAttachmentArgs",["require","exports"],function(h,f){});define("infrastructure/commandArgs/EditFeatureArgs",["require","exports"],function(h,f){});
define("infrastructure/commandArgs/EditRelatedRecordArgs",["require","exports"],function(h,f){});define("infrastructure/commandArgs/ExportGraphicsLayerArgs",["require","exports"],function(h,f){});define("infrastructure/selection/SelectionMetadata",["require","exports"],function(h,f){});define("infrastructure/commandArgs/FindAllSelectionMetadataArgs",["require","exports"],function(h,f){});define("infrastructure/commandArgs/FindMetadataForSelectionArgs",["require","exports"],function(h,f){});
define("infrastructure/commandArgs/FindSelectionArgs",["require","exports"],function(h,f){});define("infrastructure/commandArgs/GeolocateArgs",["require","exports"],function(h,f){});define("infrastructure/commandArgs/HeatMapArgs",["require","exports"],function(h,f){});define("infrastructure/commandArgs/HighlightFeatureArgs",["require","exports"],function(h,f){});define("infrastructure/identify/IdentifiableLayerInfo",["require","exports"],function(h,f){});
define("infrastructure/commandArgs/IdentifyArgs",["require","exports"],function(h,f){});define("infrastructure/commandArgs/MarkerArgs",["require","exports"],function(h,f){});define("infrastructure/commandArgs/PushpinArgs",["require","exports","infrastructure/Feature"],function(h,f,k){f.isPushpinArgs=function(f){return f&&f.feature&&f.feature instanceof k.Feature&&f.tag?!0:!1}});define("infrastructure/commandArgs/SelectionArgs",["require","exports"],function(h,f){});
define("infrastructure/commandArgs/RenameSelectionArgs",["require","exports"],function(h,f){});define("infrastructure/commandArgs/RunReportArgs",["require","exports"],function(h,f){});
define("infrastructure/commandArgs/ShowMapElementArgs",["require","exports","geocortex/framework/ui/ViewBase","infrastructure/FilterUtils"],function(h,f,k,l){h=function(){function e(c,a,b,d){this.destroyContentView=!1;this.delay=0;this.elementID=c||null;this.mapPoint=a||null;this.content=b||null;this.title=d||null}e.prototype.getNode=function(){if(this.content){if(this.contentIsView())return this.content.root;if(this.content.nodeName)return this.content;if("string"===typeof this.content){var c=document.createElement("div");
c.innerHTML=(new l.UnsafeHtml(this.content)).safeHtml;return c}}return null};e.prototype.getTitleNode=function(){if(this.title){if(this.titleIsView())return this.title.root;if(this.title.nodeName)return this.title;if("string"===typeof this.title){var c=document.createElement("div");c.innerHTML=(new l.UnsafeHtml(this.title)).safeHtml;return c}}return null};e.prototype.contentIsView=function(){return this.content&&this.content instanceof k.ViewBase};e.prototype.titleIsView=function(){return this.title&&
this.title instanceof k.ViewBase};return e}();f.ShowMapElementArgs=h});define("infrastructure/commandArgs/ShowOfflineProfileEditorArgs",["require","exports"],function(h,f){});define("infrastructure/commandArgs/TapToDismissArgs",["require","exports"],function(h,f){});define("infrastructure/commandArgs/UpdateGraphicsArgs",["require","exports"],function(h,f){});define("infrastructure/commandArgs/UpdateMetadataForSelectionArgs",["require","exports"],function(h,f){});
define("infrastructure/commandArgs/VisualizationArgs",["require","exports"],function(h,f){});define("infrastructure/coordinates/AngleDirectionSystem",["require","exports"],function(h,f){f.POLAR="polar";f.NORTH_AZIMUTH="north_azimuth";f.SOUTH_AZIMUTH="south_azimuth"});define("infrastructure/documents/DocumentCollectionConfig",["require","exports"],function(h,f){});define("infrastructure/documents/DocumentFieldSorter",["require","exports"],function(h,f){});
define("infrastructure/documents/DocumentCollection",["require","exports","geocortex/framework/FrameworkObject","geocortex/framework/observables","geocortex/essentials/documents/DocumentConstants"],function(h,f,k,l,e){h=function(c){function a(a,d,g){a=c.call(this,a,d)||this;a._pageSize=10;a._queryParams={};a.isInitialized=!1;a.stopFetching=!1;a.items=new l.ObservableCollection;a.numberOfItems=new l.Observable(0);a.currIndexStart=new l.Observable(0);a.currIndexStartFromOne=new l.Observable(1);a.currIndexEnd=
new l.Observable(0);a.currPageNumber=new l.Observable(1);a.firstPageNumber=new l.Observable(1);a.lastPageNumber=new l.Observable(1);a.statusFetching=new l.Observable(!1);a.statusOffline=new l.Observable(!1);a._mapCallback=g;return a}__extends(a,c);a.prototype.initialize=function(a){var d=this;void 0===a&&(a={});a.pageSize&&(this._pageSize=a.pageSize);a.queryParams&&(this._queryParams=dojo.mixin(this._queryParams,a.queryParams));a.fileType&&this.addFilter({field:e.DocumentField.FILE_TYPE,method:e.FilterMethod.VALUES,
range:[{string:a.fileType}]});this.isInitialized=!0;this.currIndexStartFromOne.syncTransform(this.currIndexStart,function(a){return a+1});this.currPageNumber.bind(this,function(){return d._handlePageChanged()});this._populateFromDocStore()};a.prototype.getLength=function(){return this.numberOfItems.get()};a.prototype.nextPage=function(){this.currPageNumber.set(this.currPageNumber.get()+1)};a.prototype.prevPage=function(){this.currPageNumber.set(this.currPageNumber.get()-1)};a.prototype.refresh=function(){this._populateFromDocStore()};
a.prototype.destroy=function(){c.prototype.destroy.call(this);this.items&&this.items.clear()};a.prototype.setQueryParameters=function(a){this._queryParams=a;this.currPageNumber.set(1)};a.prototype.getQueryParameters=function(){return this._queryParams};a.prototype.addFilter=function(a,d){void 0===d&&(d=e.FilterType.REQUIRE);this._queryParams.filters||(this._queryParams.filters={});this._queryParams.filters[d]||(this._queryParams.filters[d]=[]);this._queryParams.filters[d]=this._queryParams.filters[d].filter(function(d){return d.field!==
a.field});this._queryParams.filters[d].push(a);this.currPageNumber.set(1)};a.prototype.removeFilter=function(a,d){void 0===d&&(d=e.FilterType.REQUIRE);this._queryParams.filters&&this._queryParams.filters[d]&&(this._queryParams.filters[d]=this._queryParams.filters[d].filter(function(d){return d.field!==a}),0===this._queryParams.filters[d].length&&delete this._queryParams.filters[d],this.currPageNumber.set(1))};a.prototype.sortBy=function(a){a.fields&&0!==a.fields.length&&(a.descending?(delete this._queryParams.sort,
this._queryParams.sortDescending=a.fields):(delete this._queryParams.sortDescending,this._queryParams.sort=a.fields),this.currPageNumber.set(1))};a.prototype._handlePageChanged=function(){this.currPageNumber.value=Math.max(1,Number(this.currPageNumber.get()));this.currPageNumber.get()>this.lastPageNumber.get()&&0<this.lastPageNumber.get()?this.currPageNumber.set(this.lastPageNumber.get()):(this.currIndexStart.set((this.currPageNumber.get()-1)*this._pageSize),this.currIndexEnd.set(Math.min(this.numberOfItems.get(),
this.currIndexStart.get()+this._pageSize)),this._populateFromDocStore())};a.prototype._populateFromDocStore=function(){var a=this;if(this.app.site.documentStore.supported&&this.isInitialized&&!this.stopFetching){this.statusFetching.set(!0);var d=this._buildQueryParams();this.app.waitUntilSiteInitialized().then(function(){return a.statusOffline.set(!1)}).then(function(){return a.app.site.documentStore.query(d)}).then(function(d){return a._handleQueryResult(d)})["catch"](function(d){a.items.clear();
a.numberOfItems.set(0);a.statusOffline.set(!0);a.app.trace.error("Error fetching documents: {0}".format(d),d)})["finally"](function(){return a.statusFetching.set(!1)})}};a.prototype._buildQueryParams=function(){var a=dojo.mixin({},this._queryParams);a.start=this.currIndexStart.get();a.limit=this._pageSize;return a};a.prototype._handleQueryResult=function(a){this.items.set(a.results.map(this._mapCallback));a=a.total?a.total:0;this.numberOfItems.set(a);a=Math.ceil(a/this._pageSize);this.lastPageNumber.set(a);
this.firstPageNumber.set(1);this.currIndexStart.set((this.currPageNumber.get()-1)*this._pageSize);this.currIndexEnd.set(Math.min(this.numberOfItems.get(),this.currIndexStart.get()+this._pageSize))};return a}(k.FrameworkObject);f.DocumentCollection=h});define("infrastructure/documents/MonikerModelConfig",["require","exports"],function(h,f){});
define("infrastructure/documents/MonikerModel",["require","exports","geocortex/framework/observables","geocortex/essentials/documents/DocumentConstants"],function(h,f,k,l){h=function(){function e(c){this.grants=[];this.isPublic=this.isGlobal=!1;this.isRevoked=new k.Observable(!1);this.canEdit=this.canWrite=this.canRead=!1;this.enabled=new k.Observable(!0);if(!c.id&&!c.grant)throw Error('MonikerModel: parameter "id" or "grant" is required.');c.id&&(this.id=c.id);c.name&&(this.name=c.name);c.iconUri&&
(this.iconUri=c.iconUri);c.isGlobal&&(this.isGlobal=c.isGlobal);c.isPublic&&(this.isPublic=c.isPublic);c.grant&&(this.id=c.grant.globalId,c.grant.subject&&(this.name=c.grant.subject.title),this.addGrant(c.grant))}e.prototype.addGrant=function(c){this.grants.push(c);switch(c.kind){case l.GrantKind.READER:this.canRead=!0;break;case l.GrantKind.WRITER:this.canWrite=!0;break;case l.GrantKind.OWNER:this.canEdit=!0}};return e}();f.MonikerModel=h});
define("infrastructure/documents/MonikerKindDesc",["require","exports"],function(h,f){});
define("infrastructure/documents/GrantEditorViewModel","require exports geocortex/framework/ui/ViewModelBase geocortex/essentials/documents/DocumentConstants geocortex/framework/observables infrastructure/documents/MonikerModel geocortex/framework/utils/ArrayUtils geocortex/essentials/documents/BatchRequestBuilder".split(" "),function(h,f,k,l,e,c,a,b){h=function(d){function g(a,b){var c=d.call(this,a,b)||this;c._supportedGrantKinds=[l.GrantKind.READER,l.GrantKind.WRITER];c._globalGrantIds=[l.GrantID.PUBLIC,
l.GrantID.USER];c._allowPublicAccess=!1;c._lastSearchResults=[];c.defaultGrantKind=l.GrantKind.READER;c.userIconUri="Resources/Images/Icons/user-inactive-16.png";c.roleIconUri="Resources/Images/Icons/team-16.png";c.document=null;c.grants=[];c.monikers=new e.ObservableCollection;c.isValidMoniker=new e.Observable(!1);c.monikerKinds=new e.ObservableCollection;c.selectedMonikerKind=new e.Observable;c.selectedMoniker=new e.Observable;c.searchText=new e.Observable;c.enabled=new e.Observable(!0);c.editOwnership=
new e.Observable(!1);c.searchText.syncTransform(c.selectedMonikerKind,function(){return""});c.isValidMoniker.syncTransform(c.selectedMoniker,function(a){return!!a});c.enabled.bind(c,function(){return c._setMonikerEnableds()});c._setMonikerKinds();if(c.app.site&&c.app.site.isInitialized)c.onSiteInitialized();else c.app.event("SiteInitializedEvent").once(c,c.onSiteInitialized);return c}__extends(g,d);g.prototype.initialize=function(a){d.prototype.initialize.call(this,a);a&&a.editOwnership&&(this._supportedGrantKinds=
[l.GrantKind.READER,l.GrantKind.WRITER,l.GrantKind.OWNER],this.editOwnership.set(!0))};g.prototype.onSiteInitialized=function(){var a=this;this.app.site.documentStore.onInitialized().then(function(){a._allowPublicAccess=a.app.site.documentStore.hasPolicyGrant(function(a){return a.globalId===l.GrantID.PUBLIC&&a.kind===l.GrantKind.GLOBAL_READER})})};g.prototype.loadById=function(a){var b=this;return this.app.waitUntilSiteInitialized().then(function(){return b.app.site.documentStore.getById(a)}).then(function(a){return b._updateModel(a)})["catch"](function(a){b.app.trace.error("Error loading document: {0}".format(a),
a);b.reset()})};g.prototype.addMoniker=function(){var a=this._getSelectedMoniker();if(a)if(this._monikerExists(a))this.app.trace.warning("GrantEditorViewModel: Could not add the grant as it already exists.");else{var b;b=this.app.site.documentStore.userMonikers.some(function(b){return b.id===a.id})&&this._supportedGrantKinds.some(function(a){return a===l.GrantKind.OWNER})?this.addGrant(a.globalId,l.GrantKind.OWNER):this.addGrant(a.globalId,this.defaultGrantKind);this.monikers.addItem(new c.MonikerModel({grant:b,
name:a.title,iconUri:this._isUserKind(this.selectedMonikerKind.get())?this.userIconUri:this.roleIconUri}));this._setMonikerEnableds()}else this.app.trace.error("GrantEditorViewModel: Could not find moniker with title {0}.".format(this.searchText.get()))};g.prototype.addGrant=function(a,b){var d={globalId:a,kind:b,assert:!0};this.grants.push(d);return d};g.prototype.updateMoniker=function(b,d){b.grants.forEach(function(a){a.assert=!1;a.revoke=!0});switch(d){case l.GrantKind.READER:case l.GrantKind.WRITER:case l.GrantKind.OWNER:var c=
a.firstOrDefault(b.grants,function(a){return a.kind===d});c||(c=this.addGrant(b.id,d),b.addGrant(c));c.assert=!0;c.revoke=!1;this._globalGrantIds.some(function(a){return a===b.id})||b.isRevoked.set(!1);break;default:this._globalGrantIds.some(function(a){return a===b.id})||b.isRevoked.set(!0)}};g.prototype.searchMonikers=function(a){var d=this,c;c=this._isUserKind(this.selectedMonikerKind.get())?b.searchUsers(a):b.searchRoles(a);return this.app.waitUntilSiteInitialized().then(function(){return d.app.site.documentStore.perform(c)}).then(function(a){return d._lastSearchResults=
a.monikers})};g.prototype.validateSearchInput=function(){var a=this;this.selectedMoniker.get()&&this.searchText.get()&&this.isValidMoniker.set(this._lastSearchResults.some(function(b){return b.title===a.searchText.get()}))};g.prototype.resetOptions=function(){this.searchText.set(null);this.selectedMoniker.set(null)};g.prototype.reset=function(){this._updateModel(null)};g.prototype._getSelectedMoniker=function(){var a=this;return this.selectedMoniker.get().title===this.searchText.get()?this.selectedMoniker.get():
this._lastSearchResults.filter(function(b){return b.title===a.searchText.get()})[0]};g.prototype._isUserKind=function(a){return a===l.MonikerKind.USER};g.prototype._updateModel=function(a){this.grants=(this.document=a)&&a.grants?a.grants:[];this.resetOptions();this._updateMonikers(this.grants)};g.prototype._updateMonikers=function(b){this.monikers.clear();for(var d=[],g=0;g<this._globalGrantIds.length;g++){var e=this._globalGrantIds[g];d.push(new c.MonikerModel({id:e,name:this.app.getResource(this.libraryId,
"language-grant-editor-global-grant-name-{0}".format(e)),iconUri:this.roleIconUri,isGlobal:!0,isPublic:e===l.GrantID.PUBLIC}))}for(g=0;g<this._supportedGrantKinds.length;g++)for(e=0;e<b.length;e++){var f=b[e];if(f.kind===this._supportedGrantKinds[g]){var h=a.firstOrDefault(d,function(a){return a.id===f.globalId});h?h.addGrant(f):d.push(new c.MonikerModel({grant:f,iconUri:this._isUserKind(f.subject.kind)?this.userIconUri:this.roleIconUri}))}}this._allowPublicAccess||(d=d.filter(function(a){return!a.isPublic}));
this.monikers.addItems(d);this._setMonikerEnableds()};g.prototype._monikerExists=function(a){if(!a)return!1;var b=this.monikers.getItems();if(b.some(function(b){return b.id===a.globalId}))return!0;if(a.aliases)for(var d=0;d<a.aliases.length;d++){var c=a.aliases[d];if(b.some(function(a){return a.id===c}))return!0}return!1};g.prototype._setMonikerKinds=function(){this.monikerKinds.addItems([{kind:l.MonikerKind.USER,displayName:this.app.getResource(this.libraryId,"language-grant-editor-moniker-type-user")},
{kind:l.MonikerKind.ROLE,displayName:this.app.getResource(this.libraryId,"language-grant-editor-moniker-type-role")}]);this.selectedMonikerKind.set(this.monikerKinds.getAt(0).kind)};g.prototype._setMonikerEnableds=function(){for(var a=this.enabled.get(),b=0,d=this.monikers.get();b<d.length;b++){var c=d[b],g=this.app.site.documentStore.userMonikers.some(function(a){return a.id===c.id}),e=c.grants.some(function(a){return a.kind===l.GrantKind.OWNER&&!a.revoke});g&&e?c.enabled.set(!1):c.enabled.set(a)}};
return g}(k.ViewModelBase);f.GrantEditorViewModel=h});
define("infrastructure/documents/GrantEditorView",["require","exports","geocortex/framework/ui/ViewBase"],function(h,f,k){h=function(f){function e(){var c=null!==f&&f.apply(this,arguments)||this;c.autoCompleteMinLength=0;c.autoCompleteMaxEntries=10;return c}__extends(e,f);e.prototype.added=function(c){f.prototype.added.call(this,c);this._setupJQueryAutocomplete()};e.prototype.handleInputChanged=function(c,a,b){this.viewModel.validateSearchInput()};e.prototype.handleAddMonikerButtonClick=function(c,
a,b){this.viewModel.addMoniker();this.viewModel.resetOptions()};e.prototype.handleUpdateMoniker=function(c,a,b){this.viewModel.updateMoniker(b,a.value);return!0};e.prototype.handleAutoCompleteBlur=function(c,a,b){$(a).autocomplete("widget").hide()};e.prototype.getSuggestions=function(c,a){var b=this;this.viewModel.searchMonikers(c.term).then(function(a){return b._processMonikers(a)}).then(function(b){return a(b)})["catch"](function(b){return a([])})};e.prototype._processMonikers=function(c){var a=
[];0<c.length&&(a=c.slice(0,this.autoCompleteMaxEntries).map(function(a){return{label:a.title,moniker:a}}));return Promise.resolve(a)};e.prototype._setupJQueryAutocomplete=function(){var c=this,a=!(!dojo.isIE&&!navigator.userAgent.match(/Trident\/7\./)),b={minLength:this.autoCompleteMinLength,source:function(b,g){a&&!$(c.autoCompleteInput).is(":focus")||c.getSuggestions(b,g)},select:function(a,b){c._handleAutoCompleteSelect(a,b);return!1}};$(this.autoCompleteInput).autocomplete(b)};e.prototype._handleAutoCompleteSelect=
function(c,a){this.viewModel.searchText.set(a.item.label);this.viewModel.selectedMoniker.set(a.item.moniker)};return e}(k.ViewBase);f.GrantEditorView=h});define("infrastructure/documents/GuestLinkModelConfig",["require","exports"],function(h,f){});
define("infrastructure/documents/GuestLinkModel",["require","exports","geocortex/framework/observables"],function(h,f,k){h=function(){function f(e){this.name=new k.Observable;this.linkUrl=new k.Observable;e.kind&&(this.kind=e.kind);e.name&&this.name.set(e.name)}f.prototype.reset=function(){this.link=this.grant=null;this.linkUrl.set(null)};return f}();f.GuestLinkModel=h});define("infrastructure/eventArgs/ActiveToolChangedEventArgs",["require","exports"],function(h,f){});
define("infrastructure/eventArgs/AuthenticationEventArgs",["require","exports"],function(h,f){var k=function(){return function(){this.token=this.username=this.result=null}}();f.AuthenticationEventArgs=k});define("infrastructure/ui/components/FilterControl/FilterControlItemInfo",["require","exports"],function(h,f){});define("infrastructure/eventArgs/FilterControlEventArgs",["require","exports"],function(h,f){});
define("infrastructure/eventArgs/FilterControlQueryChangedEventArgs",["require","exports"],function(h,f){});define("infrastructure/eventArgs/GeolocationEventArgs",["require","exports"],function(h,f){var k=function(){return function(){this.accuracyThreshold=this.typeOfGeolocation=this.location=this.projectedMapPoint=this.mapPoint=null;this.timedOut=!1}}();f.GeolocationEventArgs=k});define("infrastructure/eventArgs/GeometryEditCompletedEventArg",["require","exports"],function(h,f){});
define("infrastructure/eventArgs/GraphicAttributesChangedEventArgs",["require","exports"],function(h,f){});define("infrastructure/eventArgs/GraphicEditingDoneEventArgs",["require","exports"],function(h,f){});define("infrastructure/eventArgs/GraphicRemovedEventArgs",["require","exports"],function(h,f){});define("infrastructure/eventArgs/LayerDefinitionExpressionAppliedEventArgs",["require","exports"],function(h,f){});
define("infrastructure/eventArgs/MapExtentEventArgs",["require","exports"],function(h,f){var k=function(){return function(){this.currentResolution=this.currentScale=this.centerLatLon=null}}();f.MapExtentEventArgs=k});define("infrastructure/eventArgs/MapServiceLayersChangedEventArgs",["require","exports"],function(h,f){});define("infrastructure/eventArgs/MarkerDragEventArgs",["require","exports"],function(h,f){});
define("infrastructure/eventArgs/MarkerPointerEventArgs",["require","exports"],function(h,f){});define("infrastructure/eventArgs/OfflineMapEditorFinishedEventArgs",["require","exports"],function(h,f){});define("infrastructure/eventArgs/OfflineMapEventArgs",["require","exports"],function(h,f){});define("infrastructure/eventArgs/PlotCoordinatesEventArgs",["require","exports"],function(h,f){});define("infrastructure/eventArgs/PlotCoordinatesIdUpdatedEventArgs",["require","exports"],function(h,f){});
define("infrastructure/eventArgs/ProjectEditorFinishedEventArgs",["require","exports"],function(h,f){});define("infrastructure/eventArgs/QueryCompletedEventArgs",["require","exports"],function(h,f){});define("infrastructure/eventArgs/ReportResultEventArgs",["require","exports"],function(h,f){});define("infrastructure/eventArgs/ResultsPageChangedEventArgs",["require","exports"],function(h,f){var k=function(){return function(){}}();f.ResultsPageChangedEventArgs=k});
define("infrastructure/eventArgs/SelectionEventArgs",["require","exports"],function(h,f){});define("infrastructure/eventArgs/SelectionChangedEventArgs",["require","exports"],function(h,f){});define("infrastructure/eventArgs/StateChangedEventArgs",["require","exports"],function(h,f){});
define("infrastructure/toolbarGroup/types/ToolbarToggleButton","require exports infrastructure/toolbarGroup/ToolbarGroupItemBase infrastructure/CommandViewModel geocortex/framework/observables infrastructure/toolbarGroup/ToolbarGroupBase".split(" "),function(h,f,k,l,e,c){var a;(function(a){a[a.TOGGLE_BUTTON_OFF=0]="TOGGLE_BUTTON_OFF";a[a.TOGGLE_BUTTON_ON=1]="TOGGLE_BUTTON_ON"})(a=f.ToggleButtonState||(f.ToggleButtonState={}));var b=function(b){function c(g,f,n){var h=b.call(this,g,f,n)||this;h.state=
new e.Observable(null);h.toggleButtonEntry=n;h.toggleOnCommand=new l.CommandViewModel(h.app,f,n.toggleOn.command,n.toggleOn.commandParameter);h.toggleOffCommand=new l.CommandViewModel(h.app,f,n.toggleOff.command,n.toggleOff.commandParameter);h.isToggledOn=new e.Observable(!1);h.iconUri=new e.Observable(null);h.state.bind(h,function(a){return h.setState(a)});h.toggleButtonEntry.toggleStateName&&""!==h.toggleButtonEntry.toggleStateName?(h.app.event("StateEnteredEvent").subscribe(h,function(b){b.stateDefinition.name===
h.toggleButtonEntry.toggleStateName&&h.state.set(a.TOGGLE_BUTTON_ON);h.isToggledOn.get()&&"TransientActiveState"===b.stateDefinition.name&&h.activeTransient.set(!0)}),h.app.event("StateExitedEvent").subscribe(h,function(b){b.stateDefinition.name===h.toggleButtonEntry.toggleStateName&&h.state.set(a.TOGGLE_BUTTON_OFF);"TransientActiveState"===b.stateDefinition.name&&h.activeTransient.set(!1)})):h._setUpBindings();if(!h.app.site||!h.app.site.isInitialized)h.app.event("SiteInitializedEvent").once(h,function(){h.toggleOffCommand.commandName&&
h.app.command(h.toggleOffCommand.commandName).raiseCanExecuteChanged();h.toggleOnCommand.commandName&&h.app.command(h.toggleOnCommand.commandName).raiseCanExecuteChanged();h.state.get()===a.TOGGLE_BUTTON_OFF?h.disabled.set(!h.toggleOffCommand.canExecute.get()):h.disabled.set(!h.toggleOnCommand.canExecute.get())});n.toggleStateName&&h.app.stateManager.isCurrentlyActive(n.toggleStateName)?h.state.set(a.TOGGLE_BUTTON_ON):h.state.set(a.TOGGLE_BUTTON_OFF);return h}__extends(c,b);c.prototype.execute=function(){this.command&&
this.command.commandName&&(this.command.commandParameter?this.app.commandRegistry.command(this.command.commandName).execute(this.command.commandParameter):this.app.commandRegistry.command(this.command.commandName).execute())};c.prototype.setState=function(b){if(b===a.TOGGLE_BUTTON_OFF)var d=this.toggleButtonEntry.toggleOn.name||this.toggleButtonEntry.name||"",c=this.toggleButtonEntry.toggleOn.iconUri||this.toggleButtonEntry.iconUri||null,g=this.toggleButtonEntry.toggleOn.tooltip||this.toggleButtonEntry.tooltip||
null,e=void 0!=this.toggleButtonEntry.toggleOn.hideOnDisable?!!this.toggleButtonEntry.toggleOn.hideOnDisable:!!this.toggleButtonEntry.hideOnDisable,f=!1;else d=this.toggleButtonEntry.toggleOff.name||this.toggleButtonEntry.name||"",c=this.toggleButtonEntry.toggleOff.iconUri||this.toggleButtonEntry.iconUri||null,g=this.toggleButtonEntry.toggleOff.tooltip||this.toggleButtonEntry.tooltip||null,e=void 0!=this.toggleButtonEntry.toggleOff.hideOnDisable?!!this.toggleButtonEntry.toggleOff.hideOnDisable:!!this.toggleButtonEntry.hideOnDisable,
f=!0;this.name.set(d);this.isToggledOn.set(f);this.iconUri.set(c);this.tooltip.set(g);this.command=b===a.TOGGLE_BUTTON_OFF?this.toggleOnCommand:this.toggleOffCommand;this.disabled.set(!this.command.canExecute.get());this.hideOnDisable.set(e);this.setHidden();this.app.event("ToggleButtonStateChangedEvent").publish({toggleButtonEntry:this.toggleButtonEntry,state:b})};c.prototype.onDestroy=function(){this._disconnectBindings()};c.prototype._setUpBindings=function(){var a=this;this._toggleOnCommandCanExecuteBindingToken=
this.toggleOnCommand.canExecute.bind(this,function(b){return a._handleCommandCanExecuteChanged(a.toggleOnCommand,b)});this._toggleOnCommandPostExecSubscriptionToken=this.app.command(this.toggleButtonEntry.toggleOn.command).postExecute.subscribe(this,this._handleToggleOnCommandPostExecute);this._toggleOffCommandCanExecuteBindingToken=this.toggleOffCommand.canExecute.bind(this,function(b){return a._handleCommandCanExecuteChanged(a.toggleOffCommand,b)});this._toggleOffCommandPostExecSubscriptionToken=
this.app.command(this.toggleButtonEntry.toggleOff.command).postExecute.subscribe(this,this._handleToggleOffCommandPostExecute)};c.prototype._disconnectBindings=function(){this.toggleOnCommand.canExecute.unbind(this._toggleOnCommandCanExecuteBindingToken);this.app.command(this.toggleButtonEntry.toggleOn.command).postExecute.unsubscribe(this._toggleOnCommandPostExecSubscriptionToken);this.toggleOffCommand.canExecute.unbind(this._toggleOffCommandCanExecuteBindingToken);this.app.command(this.toggleButtonEntry.toggleOff.command).postExecute.unsubscribe(this._toggleOffCommandPostExecSubscriptionToken)};
c.prototype._handleToggleOnCommandPostExecute=function(b){b&&this.command.commandParameter!==b||this.state.get()!==a.TOGGLE_BUTTON_ON&&this.state.set(a.TOGGLE_BUTTON_ON)};c.prototype._handleToggleOffCommandPostExecute=function(b){b&&this.command.commandParameter!==b||this.state.get()!==a.TOGGLE_BUTTON_OFF&&this.state.set(a.TOGGLE_BUTTON_OFF)};c.prototype._handleCommandCanExecuteChanged=function(a,b){this.command===a&&(this.disabled.set(!b),this.setHidden())};return c}(k.ToolbarGroupItemBase);f.ToolbarToggleButton=
b;c.registerToolbarFactoryMethod("toggleButton",function(a,c,e){return new b(a,c,e)})});define("infrastructure/eventArgs/ToggleButtonStateChangedEventArgs",["require","exports"],function(h,f){});define("infrastructure/eventArgs/ToolbarButtonClickedEventArgs",["require","exports"],function(h,f){});define("infrastructure/eventArgs/ToolbarTabChangedEventArgs",["require","exports"],function(h,f){});define("infrastructure/eventArgs/TransientActivatedEventArgs",["require","exports"],function(h,f){});
define("infrastructure/eventArgs/UndoRedoEventArgs",["require","exports"],function(h,f){});define("infrastructure/eventArgs/UserEventArgs",["require","exports"],function(h,f){var k=function(){return function(){this.isCancelled=!1}}();f.UserEventArgs=k});define("infrastructure/featureDetails/FeatureProviderConfig",["require","exports"],function(h,f){});
define("infrastructure/featureDetails/FeatureProviderBase",["require","exports","geocortex/framework/ui/ViewModelBase","geocortex/framework/observables"],function(h,f,k,l){h=function(e){function c(a,b){var d=e.call(this,a,b)||this;d.currentFeature=new l.Observable(null);d.providerEnabled=new l.Observable(!1);d.currentFeature.bind(d,d.handleCurrentFeatureChanged);return d}__extends(c,e);c.prototype.initialize=function(a){};c.prototype.handleCurrentFeatureChanged=function(a){};c.prototype.updateProviderState=
function(a){a=!!this.currentFeature.get()&&!!a;this.providerEnabled.get()!==a&&this.providerEnabled.set(a)};c.prototype.createAttachedViews=function(a,b,d,c){var e=this,f=[];if(a.viewType&&a.markup&&b){var l=function(d,l,n){var h=b[l];null!==h&&(h?(d=e.app.viewManager.createView({viewId:n,markupResource:d,typeName:a.viewType,iconUri:a.iconUri,title:a.title||"",regionName:h,isVisible:!0,libraryId:a.libraryId||e.libraryId,configuration:a.viewConfig}),d.attach(c||e),f.push(d)):e.app.trace.warning("FeatureProviderBase: Could not resolve target region for view mode {0}. Failed to create view with id {1}".format(l,
n)))};if("string"===typeof a.markup)l(a.markup,"default",a.viewId||null);else for(var h in a.markup)if(a.markup.hasOwnProperty(h)){var k=a.viewId?"{0}-{1}".format(a.viewId,h):null;l(a.markup[h],h,k)}d&&"function"===typeof d&&d(f)}else this.app.trace.warning("FeatureProviderBase: View type, markup or region not specified. Cannot create view for {0}".format(a.type))};return c}(k.ViewModelBase);f.FeatureProviderBase=h});
define("infrastructure/highlightedLabel/HighlightedLabelState",["require","exports"],function(h,f){});
define("infrastructure/highlightedLabel/HighlightedLabelUtils",["require","exports"],function(h,f){function k(a){return a.split(c)}var l=null,e={},c=/\r\n|\r|\n/g;f.getLabelSize=function(a,b,d,g){for(var f=!0,h=null,n=(c.test(a)?a.match(c).length:0)+1,p=k(a),s=0,r=0;p&&r<p.length;r++){for(var t=a.length,u=0,v=0;v<t;v++){var y=p[r].charAt(v),y=" "===y?".":y;if(!e.hasOwnProperty(y)){f?(f=document.getElementById(g+"_layer"),h=document.createElementNS("http://www.w3.org/2000/svg","text"),h.setAttributeNS(null,
"font-size",d),h.setAttributeNS(null,"font-family",b),h.setAttributeNS(null,"visibility","hidden"),h.textContent=y,f.appendChild(h),f=!1):h.textContent=y;var x=h.getBBox();l=null===l?x.height:l;e[y]=h.getComputedTextLength()}y=e[y];u+=y}u>s&&(s=u)}return{width:Math.ceil(s),height:Math.ceil(l*n)}};f.getTextLines=k;f.generateSvgHighlightLabelPath=function(a,b,d,c,e){void 0===c&&(c=!1);void 0===e&&(e=a/5);var f="",f=0===d?"M1,0h"+a+"v"+b:"M1,0h"+(a-d)+"a"+d+","+d+" 0 0 1 "+d+","+d+"v"+(b-2*d)+"a"+d+
","+d+" 0 0 1 "+-d+","+d,f=c?f+("h"+(d-(a-e))/2+"l"+-(e/2)+","+e/2+"l"+-(e/2)+","+-(e/2)+"h"+(d-(a-e))/2):f+("h"+(d-a));return 0===d?f+"z":f+("a"+d+","+d+" 0 0 1 "+-d+","+-d+"v"+(2*d-b)+"a"+d+","+d+" 0 0 1 "+d+","+-d+"z")};f.generateSvgCirclePath=function(a){if(!a)throw Error("HighlightLabelUtils: Cannot generate SVG circle path. Radius cannot be zero or undefined.");return"M0,0a"+a+","+a+" 0 0 1 "+a+","+a+"a"+a+","+a+" 0 0 1 "+-a+","+a+"a"+a+","+a+" 0 0 1 "+-a+","+-a+"a"+a+","+a+" 0 0 1 "+a+","+
-a+"z"}});
define("infrastructure/highlightedLabel/HighlightedLabelGraphic",["require","exports","infrastructure/GraphicsLayerUtils","infrastructure/highlightedLabel/HighlightedLabelUtils"],function(h,f,k,l){var e;(function(c){c[c.BOTTOM_LEFT=0]="BOTTOM_LEFT";c[c.MIDDLE=1]="MIDDLE";c[c.CALLOUT=2]="CALLOUT"})(e=f.HighlightedLabelAnchor||(f.HighlightedLabelAnchor={}));h=function(){function c(a,b){this.textGraphics=[];this.textSymbols=[];this._padding=this._width=this._height=0;this._calloutSizeWidthFraction=5;
this._tagHeightPercentage=0.6;if(!b||!this._processConfig(a))throw Error("HighlightedLabelGraphic: Initialization failed.");this.app=b;this.graphicsLayer=k.getInternalGraphicsLayer(this._config.layerId,this.app,k.GraphicsLayerType.Label);a._isRestoringState||this._executeSetupRoutine()}c.prototype.getTextFontFamily=function(){return this.textSymbols&&0<this.textSymbols.length?this.textSymbols[0].font.family:this._config.fontFamily};c.prototype.getTextFontSize=function(){return this.textSymbols&&0<
this.textSymbols.length?this.textSymbols[0].font.size+"px":this._config.fontSize};c.prototype.getWidth=function(){return this._width};c.prototype.getTotalWidth=function(){return this._width+this._padding};c.prototype.getHeight=function(){return this._height};c.prototype.getTotalHeight=function(){return this._height+this._padding};c.prototype.getMapPoint=function(){return this._config.mapPoint};c.prototype.getConfig=function(){return this._config};c.prototype.addToLayer=function(a){var b=this;void 0===
a&&(a=!0);k.addGraphicToLayer(this.highlightGraphic,this._config.layerId,this.app);k.addGraphicToLayer(this.highlightIdTagGraphic,this._config.layerId,this.app);this.textGraphics.forEach(function(a){k.addGraphicToLayer(a,b._config.layerId,b.app)});a?this.show():this.hide()};c.prototype.removeFromLayer=function(a){this.hide();var b=function(a){var b=a.getLayer();b&&b.remove(a)};this.textGraphics&&0<this.textGraphics.length&&(this.textGraphics.forEach(function(a){return b(a)}),a&&(this.textGraphics.length=
0,this.textSymbols.length=0));this.highlightIdTagGraphic&&(b(this.highlightIdTagGraphic),a&&(this.highlightIdTagSymbol=this.highlightIdTagGraphic=null));this.highlightGraphic&&(b(this.highlightGraphic),a&&(this.highlightIdTagSymbol=this.highlightGraphic=null))};c.prototype.isVisible=function(){return this.highlightGraphic?this.highlightGraphic.visible&&(!this._config.calloutWithIdTag||this.highlightIdTagGraphic.visible)&&0<this.textGraphics.filter(function(a){return a.visible}).length:!1};c.prototype.show=
function(){this.highlightGraphic&&this.highlightGraphic.show();this.highlightIdTagGraphic&&this.highlightIdTagGraphic.show();this.textGraphics&&0<this.textGraphics.length&&this.textGraphics.forEach(function(a){a.show()});return this};c.prototype.hide=function(){this.textGraphics&&0<this.textGraphics.length&&this.textGraphics.forEach(function(a){a.hide()});this.highlightIdTagGraphic&&this.highlightIdTagGraphic.hide();this.highlightGraphic&&this.highlightGraphic.hide();return this};c.prototype.update=
function(a,b){if(this.highlightGraphic&&this.textGraphics.length){var d=this.isVisible(),c=this._key?this.highlightGraphic[this._key]:null;this._config.text=b||"";this._config.mapPoint=a&&a instanceof esri.geometry.Point?a:this._config.mapPoint;this.removeFromLayer(!0);this._executeSetupRoutine();this.addToLayer(d);c&&this.assignGraphicIdentifierKey(this._key,c)}};c.prototype.refresh=function(a){if(this.highlightGraphic&&this.textGraphics.length){var b=this.isVisible(),d=this._key?this.highlightGraphic[this._key]:
null;this._config.text=a||"";this.removeFromLayer(!0);this._executeSetupRoutine();this.addToLayer(b);d&&this.assignGraphicIdentifierKey(this._key,d)}};c.prototype.moveToTop=function(){var a=this.highlightGraphic.getDojoShape();a&&a.moveToFront();this.highlightIdTagGraphic&&(a=this.highlightIdTagGraphic.getDojoShape())&&a.moveToFront();for(var b=0;b<this.textGraphics.length;b++)(a=this.textGraphics[b].getDojoShape())&&a.moveToFront()};c.prototype.assignGraphicIdentifierKey=function(a,b){this._key=
a;this.highlightGraphic[a]=b;this.highlightIdTagGraphic&&(this.highlightIdTagGraphic[a]=b);this.textGraphics.forEach(function(d){d[a]=b})};c.prototype.updateIdTagText=function(a){if(a&&this._config.calloutWithIdTag){this._config.idTagText=a;var b=this.textGraphics[this.textGraphics.length-1];b&&b.symbol&&(b.symbol.setText(a),b.setSymbol(b.symbol))}};c.prototype.setHighlightColor=function(a){a&&a instanceof esri.Color&&this.highlightSymbol&&(this._config.highlightColor=a,this.highlightSymbol&&this.highlightGraphic&&
(this.highlightSymbol.setColor(a),this.highlightGraphic.setSymbol(this.highlightSymbol)));if(this._config.calloutWithIdTag){var b=this.textGraphics[this.textGraphics.length-1];this.highlightIdTagSymbol&&this.highlightIdTagGraphic&&(this.highlightIdTagSymbol.outline.setColor(a),this.highlightIdTagGraphic.setSymbol(this.highlightIdTagSymbol));b&&(b.symbol.setColor(a),b.setSymbol(b.symbol))}};c.prototype.setTextColor=function(a){if(a&&a instanceof esri.Color){this._config.textColor=a;var b=this.textGraphics.length;
this._config.calloutWithIdTag&&(this.highlightIdTagSymbol&&this.highlightIdTagGraphic&&(this.highlightIdTagSymbol.setColor(a),this.highlightIdTagGraphic.setSymbol(this.highlightIdTagSymbol)),b--);for(var d=0;d<b;d++){var c=this.textGraphics[d];c&&(c.symbol.setColor(a),c.setSymbol(c.symbol))}}};c.prototype.exportState=function(a){var b=a.project.convert;a=this.getConfig();return{highlightGraphic:b.fromEsriGraphic(this.highlightGraphic),highlightSymbol:b.fromEsriSymbol(this.highlightSymbol),textGraphics:this.textGraphics.map(function(a){return b.fromEsriGraphic(a)}),
textSymbols:this.textSymbols.map(function(a){return b.fromEsriSymbol(a)}),layerId:a.layerId,mapPoint:b.fromEsriGeometry(this.getMapPoint()),labelXoffset:a.labelXoffset,labelYoffset:a.labelYoffset,text:a.text,fontFamily:a.fontFamily,fontSize:a.fontSize,cornerRadius:a.cornerRadius,angle:a.angle,anchor:a.anchor,textColor:b.fromEsriColor(a.textColor),highlightColor:b.fromEsriColor(a.highlightColor),highlightOutlineSymbol:b.fromEsriSymbol(a.highlightOutlineSymbol)}};c.fromExportedState=function(a,b,d){return Promise["try"](function(){if(!a||
!a.highlightGraphic)throw Error("HighlightedLabelGraphic.fromExportedState: Invalid state.");if(!b)throw Error('HighlightedLabelGraphic.fromExportedState: Parameter "app" is required.');var g=b.project.convert,e={highlightGraphic:g.toEsriGraphic(a.highlightGraphic),textGraphics:Promise.map(a.textGraphics,function(a){return g.toEsriGraphic(a)})};return Promise.props(e).then(function(e){var f={layerId:a.layerId,mapPoint:g.toEsriGeometry(a.mapPoint),text:a.text,labelXoffset:a.labelXoffset,labelYoffset:a.labelYoffset,
fontFamily:a.fontFamily,fontSize:a.fontSize,cornerRadius:a.cornerRadius,angle:a.angle,anchor:a.anchor,textColor:g.toEsriColor(a.textColor),highlightColor:g.toEsriColor(a.highlightColor),highlightOutlineSymbol:g.toEsriSymbol(a.highlightOutlineSymbol),_isRestoringState:!0};d=d||c.prototype;var m=Object.create(d);m.constructor.call(m,f,b);m.initializeHighlightDimensions();m.highlightGraphic=e.highlightGraphic;m.highlightSymbol=g.toEsriSymbol(a.highlightSymbol);m.textGraphics=e.textGraphics;m.textSymbols=
a.textSymbols.map(function(a){return g.toEsriSymbol(a)});return m})})};c.prototype._executeSetupRoutine=function(){this.initializeHighlightDimensions();this.initializeHighlightGraphic();this.initializeHighlighteIdTagGraphic();this.initializeTextGraphicsAndSymbols()};c.prototype.setHighlightAnchor=function(){switch(this._config.anchor){case e.BOTTOM_LEFT:this.highlightSymbol.setOffset(this.getTotalWidth()/2,this.getTotalHeight()/2);break;case e.CALLOUT:this.highlightSymbol.setOffset(0,this.getTotalHeight()/
2+this._config.calloutPixelSize/4);break;default:this.highlightSymbol.setOffset(0,0)}this.highlightSymbol.setOffset(this.highlightSymbol.xoffset+this._config.labelXoffset,this.highlightSymbol.yoffset+this._config.labelYoffset)};c.prototype.setTextAnchor=function(a,b){switch(this._config.anchor){case e.MIDDLE:this.textSymbols[a].setOffset(0,b);break;case e.BOTTOM_LEFT:this.textSymbols[a].setOffset(this.getTotalWidth()/2,b+this.getTotalHeight()/2);break;case e.CALLOUT:this.textSymbols[a].setOffset(0,
b+this.getTotalHeight()/2+this._config.calloutPixelSize/2)}};c.prototype.initializeHighlightDimensions=function(){var a=l.getLabelSize(this._config.text,this._config.fontFamily,this._config.fontSize,this._config.layerId),b=0.5*a.height,d=this._config.calloutWithIdTag?a.height+b:0;this._height=a.height;this._width=a.width+d;this._padding=b;this._config.calloutPixelSize=this._config.calloutPixelSize||Math.floor(this._width/this._calloutSizeWidthFraction)};c.prototype.initializeHighlightGraphic=function(){this.highlightGraphic=
new esri.Graphic;this.highlightGraphic.highlightedTextLabel=!0;this.highlightSymbol=new esri.symbol.SimpleMarkerSymbol;this.highlightGraphic.setGeometry(this._config.mapPoint);this.configureHighlightSymbol(this._config.highlightColor,this._config.highlightOutlineSymbol,this._config.fontSize)};c.prototype.initializeHighlighteIdTagGraphic=function(){this._config.calloutWithIdTag&&(this.highlightIdTagGraphic=new esri.Graphic,this.highlightIdTagSymbol=new esri.symbol.SimpleMarkerSymbol,this.highlightIdTagGraphic.setGeometry(this._config.mapPoint),
this.configureHighlightIdTagSymbol(this._config.textColor,this._config.fontSize))};c.prototype.configureHighlightSymbol=function(a,b,d){this.setHighlightAnchor();this.highlightSymbol.setStyle("STYLE_PATH");var c=l.generateSvgHighlightLabelPath(this.getTotalWidth(),this.getTotalHeight(),this._config.cornerRadius,this._config.calloutWithIdTag,this._config.calloutPixelSize);this.highlightSymbol.setPath(c);this.highlightSymbol.setColor(a);this.highlightSymbol.setOutline(b);this.highlightSymbol.setAngle(this._config.angle);
this.highlightSymbol.setSize(d);this.highlightGraphic.setSymbol(this.highlightSymbol)};c.prototype.configureHighlightIdTagSymbol=function(a,b){var d=-(this.getTotalWidth()/2-this.getTotalHeight()/2),c=this.getTotalHeight()/2+this._config.calloutPixelSize/2;this.highlightIdTagSymbol.setStyle("STYLE_PATH");this.highlightIdTagSymbol.setPath(l.generateSvgCirclePath(this.getTotalHeight()*this._tagHeightPercentage/2));this.highlightIdTagSymbol.setColor(a);this.highlightIdTagSymbol.outline&&this.highlightIdTagSymbol.outline.setColor(a);
this.highlightIdTagSymbol.setOffset(d+this._config.labelXoffset,c+this._config.labelYoffset);this.highlightIdTagSymbol.setSize(this.getTotalHeight()*this._tagHeightPercentage);this.highlightIdTagGraphic.setSymbol(this.highlightIdTagSymbol)};c.prototype.initializeTextGraphicsAndSymbols=function(){if(this._config.text){var a=l.getTextLines(this._config.text);if(a&&a.length&&0!==a.length){var b=a.length,d=new esri.symbol.Font;d.setSize(this._config.fontSize);d.setFamily(this._config.fontFamily);var c=
this.getHeight()/b,e=Math.abs(d.size-c),f=this.getHeight()/2/c;this.textGraphics=[];this.textSymbols=[];for(var n=0;a&&0<a.length&&n<a.length;n++){this.textGraphics[n]||(this.textGraphics[n]=new esri.Graphic);this.textSymbols[n]||(this.textSymbols[n]=new esri.symbol.TextSymbol(""));this.textGraphics[n].geometry!==this._config.mapPoint&&this.textGraphics[n].setGeometry(this._config.mapPoint);this.configureTextSymbol(n,a[n],this._config.textColor,d,this._config.angle,(f-(n+1))*c+e);if(1===b){this.textSymbols[n].setHorizontalAlignment(esri.symbol.TextSymbol.ALIGN_MIDDLE);
var h=Math.PI/180*this._config.angle;this.textSymbols[n].setOffset(-(c/2/2*Math.sin(h)),-Math.abs(c/2/2*Math.cos(h)));h={customVerticalAlignment:"middle",numberOfLines:1}}else this.textSymbols[n].setHorizontalAlignment(esri.symbol.TextSymbol.ALIGN_START),this.textSymbols[n].setVerticalAlignment(esri.symbol.TextSymbol.ALIGN_START),h={customVerticalAlignment:"middle",numberOfLines:b};this.textGraphics[n].setAttributes(h);h=this._config.calloutWithIdTag?this.getTotalHeight()/2:0;this.textSymbols[n].setOffset(this.textSymbols[n].xoffset+
this._config.labelXoffset+h,this.textSymbols[n].yoffset+this._config.labelYoffset);this.textGraphics[n].setSymbol(this.textSymbols[n])}this._config.calloutWithIdTag&&(a=new esri.symbol.Font,a.setSize(this._config.fontSize),a.setSize(Math.floor(1.25*a.size)),a.setFamily(this._config.fontFamily),a.setWeight(esri.symbol.Font.WEIGHT_BOLD),d=new esri.Graphic,d.setGeometry(this._config.mapPoint),this.textGraphics.push(d),c=new esri.symbol.TextSymbol(this._config.idTagText),this.textSymbols.push(c),this.configureTextSymbol(b,
this._config.idTagText,this._config.highlightColor,a,0,0),b=-(this.getTotalWidth()/2-this.getTotalHeight()/2),c.setOffset(c.xoffset+b,c.yoffset+-(a.size/3)),d.setSymbol(c))}}};c.prototype.configureTextSymbol=function(a,b,d,c,e,f){this.textSymbols&&a<this.textSymbols.length&&(this.textSymbols[a].setText(b),this.textSymbols[a].setFont(c),this.textSymbols[a].setColor(d),this.textSymbols[a].setAngle(e),this.setTextAnchor(a,f))};c.prototype._processConfig=function(a){if(!a||!a.layerId||!a.mapPoint)return!1;
a.calloutWithIdTag=void 0==a.calloutWithIdTag?!1:!!a.calloutWithIdTag;a.idTagText=a.idTagText||"";a.calloutPixelSize=a.calloutPixelSize||0;a.labelXoffset=a.calloutWithIdTag?0:a.labelXoffset||0;a.labelYoffset=a.calloutWithIdTag?0:a.labelYoffset||0;a.layerId=a.layerId;a.mapPoint=a.mapPoint;a.text=a.text||"";a.fontFamily=a.fontFamily||"Arial";a.fontSize=a.fontSize||"12px";a.cornerRadius=void 0==a.cornerRadius?5:a.cornerRadius;a.angle=a.calloutWithIdTag?0:a.angle||0;a.anchor=a.calloutWithIdTag?e.CALLOUT:
void 0!=a.anchor?a.anchor:e.MIDDLE;a.textColor=a.textColor&&a.textColor instanceof esri.Color?a.textColor:new esri.Color("white");a.highlightColor=a.highlightColor&&a.highlightColor instanceof esri.Color?a.highlightColor:new esri.Color("black");a.highlightOutlineSymbol=a.highlightOutlineSymbol&&a.highlightOutlineSymbol instanceof esri.symbol.SimpleLineSymbol?a.highlightOutlineSymbol:new esri.symbol.SimpleLineSymbol;this._config=a;return!0};return c}();f.HighlightedLabelGraphic=h});
define("infrastructure/highlightedLabel/HighlightedLabelConfig",["require","exports"],function(h,f){});
define("infrastructure/identify/IdentifyProviderBase",["require","exports","infrastructure/GeometryUtils"],function(h,f,k){h=function(){function f(e,c){this.pixelTolerance=5;this.polygonPixelTolerance=2;this.app=e;this.libraryId=c}f.prototype.getResource=function(e,c){return this.app.getResource(this.libraryId,e,c)};f.prototype.applyTolerance=function(e,c){return e&&"point"===e.type?k.createToleranceEnvelope(this.app.map,e,c):e};return f}();f.IdentifyProviderBase=h});
define("infrastructure/identify/GraphicsLayerIdentifyProvider","require exports infrastructure/identify/IdentifyProviderBase infrastructure/FeatureSet infrastructure/FeatureAttribute geocortex/essentials/Field geocortex/framework/utils/ArrayUtils infrastructure/GraphicUtils infrastructure/NumberFormat infrastructure/PresentableDelegateFactory infrastructure/GraphicsLayerIds".split(" "),function(h,f,k,l,e,c,a,b,d,g,m){h=function(f){function h(){var a=null!==f&&f.apply(this,arguments)||this;a._cancelled=
!1;a._searching=!1;a._delayedFscOpen=null;a._numFractionalDigits=null;a._fscCollectionOpen=!1;return a}__extends(h,f);h.prototype.initialize=function(a){this._numFractionalDigits=(a=this.app.configModel.moduleConfigs.filter(function(a){return"Measurement"===a.moduleName}))&&a[0]&&a[0].configuration?a[0].configuration.measurementFractionalDigits:null};h.prototype.cancelSearch=function(){this._searching&&(this._cancelled=!0);this._searching=!1};h.prototype.search=function(a,b){var d=this;return new Promise(function(c,
g){d._fscCollectionOpen=!1;d._delayedFscOpen=null;if(b.delayFSCOpen){var e=a.id,f=!1;d._delayedFscOpen=function(){f||(f=!0,d.app.featureSetManager.openCollection(e),d._fscCollectionOpen=!0)}}else d.app.featureSetManager.openCollection(a.id),d._fscCollectionOpen=!0;d._searching=!0;Promise.resolve({featureSetCollection:a,identifyArgs:b,layerInfos:void 0,graphicsLayers:void 0,featureSets:void 0}).then(function(a){return d._getClickableLayers(a)}).then(function(a){return d._processLayerInfos(a)}).then(function(a){return d._performSearch(a)})["catch"](function(a){d.app.trace.warning("Unable to search within clickable layers: "+
a.message)})["finally"](function(){d._searching=!1;d._clear();d._fscCollectionOpen&&(d.app.featureSetManager.tryCloseCollection(a.id),d._fscCollectionOpen=!1);c()})})};h.prototype._getClickableLayers=function(a){this._verifyNotCancelled();a.layerInfos=this.app.clickableGraphics.getLayerInfos();this._delayedFscOpen&&0<a.layerInfos.length&&this._delayedFscOpen();return a};h.prototype._processLayerInfos=function(a){var b=this;this._verifyNotCancelled();var d=(a.layerInfos||[]).map(function(a){return b.app.map.getLayer(a.graphicsLayerId)}).filter(function(a){return null!=
a&&a instanceof esri.layers.GraphicsLayer&&a.visible&&a.visibleAtMapScale});a.graphicsLayers=d;return a};h.prototype._performSearch=function(a){var b=this;return Promise.reduce(a.graphicsLayers,function(d,c,g){b._verifyNotCancelled();var e=a.featureSetCollection;return b._searchGraphicsLayer(c,a).then(function(a){return b._addToResultsCollection(a,e)})},null)["return"](a)};h.prototype._searchGraphicsLayer=function(a,b){var d=this,c=a.graphics.slice(0).reverse();return Promise.resolve(c).then(function(a){return d._findIntersectedGraphics(a,
b)}).then(function(b){return d._createFeatureSet(b,a)}).then(function(c){return d._processFeatureSet(c,a,b)})};h.prototype._findIntersectedGraphics=function(a,b){var d=this,c=b.identifyArgs;return Promise.filter(a,function(a){return d._intersects(a,c)})};h.prototype._intersects=function(a,d){var c=this.applyTolerance(d.geometry,"polygon"===a.geometry.type?d.polygonPixelTolerance:d.pixelTolerance);return b.geometryIntersectsGraphic(c,a,this.app)["catch"](function(){return!1})};h.prototype._createFeatureSet=
function(a,b){if(a&&0<a.length){var c=new esri.tasks.FeatureSet;c.features=a;var g=null;if(b.id!==m.MARKUP_LAYER_ID&&this.app.site&&this.app.site.essentialsMap){var e=this.app.site.essentialsMap.mapServices.filter(function(a){return a.serviceLayer===b});1===e.length&&1===e[0].layers.length&&(g=e[0].layers[0])}var f,h;g||(f=b.id,h=d.NumberFormat.NUMBER+this._numFractionalDigits);return new l.FeatureSet({esriFeatureSet:c,app:this.app,defaultNumberFormat:h,id:f,layer:g})}return null};h.prototype._processFeatureSet=
function(a,b,d){if(!a)return null;if(!a.layer){d=(b=this._getLayerInfoFromContext(b,d))?b.displayName:"";var c=this._createAttributes();a.displayName.set(d);a.attributes.set(c);this._addFeatureSetAttributes(c);a.attributes.set(c);for(d=0;d<a.features.length();d++)c=a.features.getAt(d),this._processFeature(c,b)}return a};h.prototype._createAttributes=function(){var a=[];a.push(new e.FeatureAttribute("","Name","Name",null,!0,null,c.EssentialsFieldTypes.essentialsFieldTypeString));return a};h.prototype._processFeature=
function(a,b){if(!a||!b)return a;var d=this._getDisplayNameForGraphic(a.esriFeature.get(),b),c=this._createAttributes();a.labelFormat.set(d);a.descriptionFormat.set("");a.attributes.set(c);for(c=0;c<a.attributes.length();c++){var g=a.attributes.getAt(c),e=g.name.get();g.value.get();switch(e){case "Name":g.value.set(d),g.presentableValue.set(d)}}this._isMeasurement(a.esriFeature.get())?this._populateAttributesForMeasurementMarkup(a):this._populateFeatureAttributes(a,b);return a};h.prototype._addFeatureSetAttributes=
function(a){var b=new e.FeatureAttribute("","Length","Length",this.getResource("language-common-measurement-results-field-length"),!0,null,c.EssentialsFieldTypes.essentialsFieldTypeString);a.push(b);b=new e.FeatureAttribute("","Units","Units",this.getResource("language-common-measurement-results-field-units"),!0,null,c.EssentialsFieldTypes.essentialsFieldTypeString);a.push(b);b=new e.FeatureAttribute("","Area","Area",this.getResource("language-common-measurement-results-field-area"),!0,null,c.EssentialsFieldTypes.essentialsFieldTypeString);
a.push(b);b=new e.FeatureAttribute("","Area Units","Area Units",this.getResource("language-common-measurement-results-field-area-units"),!0,null,c.EssentialsFieldTypes.essentialsFieldTypeString);a.push(b)};h.prototype._populateFeatureAttributes=function(a,b){var d=a.esriFeature.get().attributes,g="",f;for(f in d)b&&b.aliases&&b.aliases[f]?(d=new e.FeatureAttribute(a.esriFeature.get().attributes[f],f,b.aliases[f],b.aliases[f],!0,null,c.EssentialsFieldTypes.essentialsFieldTypeString),a.attributes.addItem(d),
g=g+b.aliases[f]+": {"+f+"}\n"):f.startsWith("_")||(d=new e.FeatureAttribute(a.esriFeature.get().attributes[f],f,f,f,!0,null,c.EssentialsFieldTypes.essentialsFieldTypeString),a.attributes.addItem(d),g=g+f+": {"+f+"}\n");a.descriptionFormat.set(g)};h.prototype._populateAttributesForMeasurementMarkup=function(a){var b=a.attributes.get();switch(a.esriFeature.get().geometry.type){case "polyline":a.descriptionFormat.set(this.getResource("language-clickable-graphics-measurement-description-polyline"));
var d=new e.FeatureAttribute(a.esriFeature.get().attributes.Length,"Length","Length",this.getResource("language-common-measurement-results-field-length"),!0,g.PresentableDelegateFactory.valuePresenterDelegate(null,a),c.EssentialsFieldTypes.essentialsFieldTypeString);b.push(d);d=new e.FeatureAttribute(a.esriFeature.get().attributes.Units,"Units","Units",this.getResource("language-common-measurement-results-field-units"),!0,null,c.EssentialsFieldTypes.essentialsFieldTypeString);b.push(d);break;case "polygon":a.descriptionFormat.set(this.getResource("language-clickable-graphics-measurement-description-polygon")),
d=new e.FeatureAttribute(a.esriFeature.get().attributes.Length,"Length","Length",this.getResource("language-common-measurement-results-field-length"),!0,g.PresentableDelegateFactory.valuePresenterDelegate(null,a),c.EssentialsFieldTypes.essentialsFieldTypeString),b.push(d),d=new e.FeatureAttribute(a.esriFeature.get().attributes.Units,"Units","Units",this.getResource("language-common-measurement-results-field-units"),!0,null,c.EssentialsFieldTypes.essentialsFieldTypeString),b.push(d),d=new e.FeatureAttribute(a.esriFeature.get().attributes.Area,
"Area","Area",this.getResource("language-common-measurement-results-field-area"),!0,g.PresentableDelegateFactory.valuePresenterDelegate(null,a),c.EssentialsFieldTypes.essentialsFieldTypeString),b.push(d),d=new e.FeatureAttribute(a.esriFeature.get().attributes["Area Units"],"Area Units","Area Units",this.getResource("language-common-measurement-results-field-area-units"),!0,null,c.EssentialsFieldTypes.essentialsFieldTypeString),b.push(d)}};h.prototype._addToResultsCollection=function(a,b){a&&b.featureSets.addItem(a)};
h.prototype._getLayerInfoFromContext=function(b,d){var c=null;b&&d&&(c=a.firstOrDefault(d.layerInfos||[],function(a){return a.graphicsLayerId&&a.graphicsLayerId===b.id}));return c};h.prototype._getDisplayNameForGraphic=function(a,b){if(!a)return null;var d=this.getResource("language-clickable-graphics-label-format"),c;b&&(c=b.displayName);this._isMeasurement(a)&&(c=this.getResource("language-clickable-graphics-label-measurement"));c||(c=this.getResource("language-clickable-graphics-label-default"));
var g=a.getLayer(),g=g&&g.graphics?g.graphics.indexOf(a)+1:-1;return d.format(c,0<g?g.toString():"")};h.prototype._isMeasurement=function(a){a=a.measurementId;return null!==a&&void 0!==a};h.prototype._clear=function(){this._cancelled=this._searching=!1};h.prototype._verifyNotCancelled=function(){if(this._cancelled)throw Error("GraphicsLayerIdentifyProvider: Operation cancelled");};return h}(k.IdentifyProviderBase);f.GraphicsLayerIdentifyProvider=h});
define("infrastructure/identify/IdentifiableLayersInMapService",["require","exports"],function(h,f){});
define("infrastructure/identify/IdentifyUtils","require exports geocortex/essentials/LayerType infrastructure/FeatureSetCollection geocortex/essentials/Field infrastructure/FeatureSet infrastructure/GraphicUtils geocortex/essentials/MapServiceConstants infrastructure/Feature infrastructure/KmlFeature infrastructure/NumberFormat infrastructure/DateFormat".split(" "),function(h,f,k,l,e,c,a,b,d,g,m,q){f.getIdentifyLayerIds=function(a,b,d,c,g,e,f,m){var l=[];if(!1===g||a.isVisible()){g=a.essentialsMap.site.essentialsMap.calculateScale();
for(var h=0;h<a.layers.length;h++){var q=a.layers[h];if(!m||q.type!==k.LayerType.RASTER_LAYER){var z=q.identifiableAtAllScales||!1===e||q.withinScaleRange(g),B=q.isVisible()&&q.areAllAncestorsVisible();null!=f&&-1===$.inArray(q.id,f)||!B&&!1!==c||!z||!b(q)||(null==d||0==d.length||0<=dojo.indexOf(d,q.featureType))&&l.push(q.id)}}}return l};f.getLayerDefinitions=function(a,b){var d=[];if(a.serviceLayer.layerDefinitions)for(var c=a.serviceLayer.layerDefinitions,g=0;g<c.length;g++)if(c[g])for(var e=0;e<
b.length;e++)if(b[e]==g.toString()){d[g]=c[g];break}return d};f.getDynamicLayerInfos=function(a,b){for(var d=[],c=0;c<b.length;c++){var g=a.getDynamicLayerInfoById(b[c]);g&&d.push(g)}return d};f.appendToFeatureSetCollection=function(f,h,s,r){null==h&&(h=new l.FeatureSetCollection);for(var t={},u=0;u<f.length;u++){var v=f[u],y=t[v.layerId];if(null==y){var x=s.findLayerById(v.layerId.toString());if(x&&x.type===k.LayerType.RASTER_LAYER){if(v.feature&&v.feature.attributes&&$.isEmptyObject(v.feature.attributes))return;
var w=y=0,A;for(A in v.feature.attributes)if(v.feature.attributes.hasOwnProperty(A)){w++;var z=v.feature.attributes[A];"NoValue"!==z&&"NoData"!==z||y++}if(y===w)continue}y={};if(x)for(z=0;z<x.fields.length;z++)w=x.fields[z],y[w.alias]=w;if(x&&x.type===k.LayerType.RASTER_LAYER&&x.fields)if(0===x.fields.length){if(v.feature.attributes)for(A in v.feature.attributes)z=v.feature.attributes[A],x.fields.push(new e.Field({layer:x,displayName:A,dataType:e.EssentialsFieldTypes.essentialsFieldTypeString,alias:A,
hyperlinkLabel:"",name:A,searchable:!0,visible:!0}))}else for(var B in v.feature.attributes)if("Pixel value"===B)for(u=0;u<x.fields.length;u++)if("VALUE"===x.fields[u].name){x.fields[u].name="Pixel value";break}z=null;v.displayFieldName&&(y=y[v.displayFieldName])&&y.name&&(z=y.name);z||(z=x&&x.displayField?x.displayField.name:x&&x.primaryKeyField&&x.primaryKeyField.name?x.primaryKeyField.name:v.displayFieldName);y=new esri.tasks.FeatureSet({displayFieldName:z,features:[]});v.feature.geometry&&(y.geometryType=
v.feature.geometry.type,y.spatialReference=v.feature.geometry.spatialReference);y=new c.FeatureSet({esriFeatureSet:y,layer:x,app:this.app});x?y.displayName.set(x.displayName):y.displayName.set(v.layerName);t[v.layerId]=y}y.layer&&a.sanitizeAttributeNames(v.feature,y.layer);y.esriFeatureSet.features.push(v.feature);x={graphic:v.feature,layer:y.layer,resolveLayerFields:!0,allowUnsafeContent:!1};s.drawingBehavior===b.DrawingBehavior.KML_SERVICE&&(x.allowUnsafeContent=r.configuration.allowUnsafeContent);
v.feature._graphicsLayer&&(x.featureLayer=v.feature._graphicsLayer);s.drawingBehavior===b.DrawingBehavior.KML_SERVICE?(v=new g.KmlFeature(x),v.defaultNumberFormat=s.defaultNumberFormat?s.defaultNumberFormat:m.NumberFormat.DEFAULT,v.defaultDateFormat=s.defaultDateFormat?s.defaultDateFormat:q.DateFormat.DEFAULT):v=new d.Feature(x);y.features.addItem(v)}for(var C in t)t.hasOwnProperty(C)&&(y=t[C],h.featureSets.addItem(y),y.resolveDataLinks(function(a){r.event("FeatureChangedEvent").publish(a)}));return h}});
define("infrastructure/identify/LayerDescriptor",["require","exports"],function(h,f){});
define("infrastructure/identify/MapIdentifyTask","require exports geocortex/essentials/GeometryUtilities infrastructure/GeometryUtils infrastructure/identify/IdentifyUtils infrastructure/TaskUtils geocortex/essentials/LayerType geocortex/essentials/MapServiceConstants".split(" "),function(h,f,k,l,e,c,a,b){h=function(){function d(a,b){this._identifyTaskErrorCount=this._identifyTaskCompletedCount=this._identifyTaskExecutedCount=0;this._isCancelled=this._taskExecutionComplete=!1;this.height=this.width=
this.extent=this.tag=this.map=this.app=null;this.returnGeometry=this.topMostLayerOnly=!1;this.layersInVisibleScaleRangeOnly=this.visibleMapServicesOnly=this.visibleLayersOnly=!0;this.pixelTolerance=5;this.polygonPixelTolerance=2;this.allServicesInError=!1;this.mapServicesAndLayersToIdentify=null;this.restrictRasterIdentifyToPoint=!0;this.layerRestriction=this.delayedFSCOpen=null;this.app=b||null;this.map=a}d.prototype._checkAndReturnLayerRestriction=function(){var a=this.layerRestriction;a||(a=function(a){return a.identifiable&&
a.supportsIdentify});return a};d.prototype.execute=function(a,b,d,c,e){var f=this,h=this._checkAndReturnLayerRestriction();if(this.app&&a&&"polygon"==a.type&&k.isSelfIntersectingPolygon(a)&&!e)l.simplifyPolygon(a,function(a){f.execute(a,b,d,c,!0)},function(a){f.app.trace.warning("An error occurred while attempting to simplify the identify geometry. Make sure that your proxy is configured correctly.");c(f,a,null)},this.app);else{this._identifyTaskErrorCount=this._identifyTaskCompletedCount=this._identifyTaskExecutedCount=
0;this.allServicesInError=this._taskExecutionComplete=!1;e=new esri.tasks.IdentifyParameters;e.tolerance=this.pixelTolerance;e.returnGeometry=this.returnGeometry;e.layerOption=this.topMostLayerOnly?esri.tasks.IdentifyParameters.LAYER_OPTION_TOP:esri.tasks.IdentifyParameters.LAYER_OPTION_ALL;e.width=this.width||this.map.width;e.height=this.height||this.map.height;e.mapExtent=this.extent||this.map.extent;e.geometry=a;this.app.map.timeExtent&&(this.app.map.timeExtent.startTime||this.app.map.timeExtent.endTime)&&
(e.timeExtent=new esri.TimeExtent(this.app.map.timeExtent.startTime,this.app.map.timeExtent.endTime));for(var t=0;t<this.app.site.essentialsMap.mapServices.length;t++){var u=this.app.site.essentialsMap.mapServices[t];if(!(u.serviceLayer&&u.serviceLayer instanceof esri.layers.StreamLayer))if(u.serviceLayer&&u.serviceLayer instanceof esri.layers.FeatureLayer)this._handleFeatureLayer(a,u,u.serviceLayer,e,h,b,d,c);else if(u.serviceLayer instanceof esri.layers.KMLLayer)for(var v=u.serviceLayer.getLayers(),
y=0;y<v.length;y++)v[y]instanceof esri.layers.FeatureLayer&&this._handleFeatureLayer(a,u,v[y],e,h,b,d,c);else u.serviceLayer instanceof esri.layers.WMSLayer||u.serviceLayer instanceof esri.layers.WFSLayer?this._handleWMSLayer(u,e,h,b,d,c):u.serviceLayer instanceof esri.layers.ArcGISImageServiceLayer||this._handleLayer(u,e,h,b,d,c)}this._taskExecutionComplete=!0;this._conditionallyInvokeCompleteCallback(this,d)}};d.prototype._handleWMSLayer=function(a,b,d,c,e,f){for(var l=this._getLayersToIdentifyForMapService(a,
null,d,!0),h=0<l.length?!0:!1,k=0;k<l.length;k++)if(!a.findLayerById(l[k].toString()).supportsQuery){h=!1;break}h?this._handleLayer(a,b,d,c,e,f):this._handleLayerLegacy(a,b,d,c,e,f)};d.prototype._handleLayerLegacy=function(a,b,d,f,l,h){var k=this,t=dojo.clone(b);t.layerIds=e.getIdentifyLayerIds(a,d,["Polygon"],this.visibleLayersOnly,this.visibleMapServicesOnly);t.tolerance=this.polygonPixelTolerance;b=dojo.clone(b);b.layerIds=e.getIdentifyLayerIds(a,d,["None","Point","Multipoint","Line"],this.visibleLayersOnly,
this.visibleMapServicesOnly);d=[t,b];this.delayedFSCOpen&&(0<t.layerIds.length||0<b.layerIds.length)&&this.delayedFSCOpen();t=[];for(b=0;b<d.length;b++){var u=d[b];if(0<u.layerIds.length){this._identifyTaskExecutedCount++;var v=u.layerIds.map(function(a){return a.toString()});u.layerDefinitions=e.getLayerDefinitions(a,v);u.dynamicLayerInfos=e.getDynamicLayerInfos(a,v);u.spatialReference=this.app.map.extent.spatialReference;v=c.getIdentifyTask(a);t.push(v.execute(u).then(function(b){k._isCancelled||
f(k,b,a)}))}}Promise.all(t).then(function(){k._identifyTaskCompletedCount++;k._conditionallyInvokeCompleteCallback(k,l)})["catch"](function(b){k._isCancelled||(k._identifyTaskCompletedCount++,k._identifyTaskErrorCount++,h(k,b,a))})};d.prototype._handleLayer=function(b,d,f,h,k,s){var r=this,t=this._getLayersToIdentifyForMapService(b,null,f,!0);this._identifyTaskExecutedCount++;this.delayedFSCOpen&&this.delayedFSCOpen();for(var u=[],v=[],y=Promise.defer(),x=t.map(function(a){return a.toString()}),w=
e.getLayerDefinitions(b,x),A=function(a,d,c){r._isCancelled||(a=r._queryResultToIdentifyResults(a,d,c,a.displayFieldName),h(r,a,b))},x=function(a){B=b.findLayerById(a.toString());C=c.getQueryTask(B);D=new esri.tasks.Query;if(!B.supportsQuery)return"continue";D.outFields=["*"];D.outSpatialReference=z.app.map.spatialReference;D.returnGeometry=d.returnGeometry;D.where=w[a];z.app.map.timeExtent&&(z.app.map.timeExtent.startTime||z.app.map.timeExtent.endTime)&&(D.timeExtent=new esri.TimeExtent(z.app.map.timeExtent.startTime,
z.app.map.timeExtent.endTime));"Polygon"===B.featureType?(D.geometry=l.createToleranceEnvelope(z.map,d.geometry,z.polygonPixelTolerance),v.push(C.execute(D).then(function(b){return y.promise.then(function(){return A(b,a,B.name)})}))):(D.geometry=l.createToleranceEnvelope(z.map,d.geometry,z.pixelTolerance),u.push(C.execute(D).then(function(b){return A(b,a,B.name)})))},z=this,B,C,D,F=0;F<t.length;F++)x(t[F]);"point"!==d.geometry.type&&this.restrictRasterIdentifyToPoint||(t=dojo.clone(d),t.layerIds=
this._getLayersToIdentifyForMapService(b,null,f,!1),t.layerIds=t.layerIds.filter(function(d){return b.findLayerById(d.toString()).type===a.LayerType.RASTER_LAYER}),0<t.layerIds.length&&(t.spatialReference=this.app.map.extent.spatialReference,f=c.getIdentifyTask(b),u.push(f.execute(t).then(function(a){r._isCancelled||(r._assignSpatialReferences(a),h(r,a,b))}))));Promise.all(u).then(function(){y.resolve();return Promise.all(v).then(function(){r._identifyTaskCompletedCount++;r._conditionallyInvokeCompleteCallback(r,
k)})})["catch"](function(a){r._isCancelled||(r._identifyTaskCompletedCount++,r._identifyTaskErrorCount++,s(r,a,b))})};d.prototype._assignSpatialReferences=function(a){for(var b=0;b<a.length;++b){var d=a[b];d.feature.geometry&&(d.feature.geometry.spatialReference=this.app.map.extent.spatialReference)}};d.prototype._getLayersToIdentifyForMapService=function(a,b,d,c){if(this.mapServicesAndLayersToIdentify)for(var f=0;f<this.mapServicesAndLayersToIdentify.length;f++){if(this.mapServicesAndLayersToIdentify[f].mapServiceId===
a.id)return e.getIdentifyLayerIds(a,d,b,this.visibleLayersOnly,this.visibleMapServicesOnly,this.layersInVisibleScaleRangeOnly,this.mapServicesAndLayersToIdentify[f].layerIds,c)}else return e.getIdentifyLayerIds(a,d,b,this.visibleLayersOnly,this.visibleMapServicesOnly,this.layersInVisibleScaleRangeOnly,null,c)};d.prototype._handleFeatureLayer=function(a,d,e,f,h,k,r,t){var u=this;f.layerIds=this._getLayersToIdentifyForMapService(d,null,h,!1);if(0<f.layerIds.length||d.drawingBehavior==b.DrawingBehavior.KML_SERVICE){this.delayedFSCOpen&&
this.delayedFSCOpen();var v=new esri.tasks.Query;v.geometry=a;"point"===a.type?v.geometry=d.heatMap&&d.heatMap.enabled?l.createToleranceEnvelope(this.map,a,d.heatMap.intensity):l.createToleranceEnvelope(this.map,a,this.pixelTolerance):d.drawingBehavior===b.DrawingBehavior.KML_SERVICE&&(v.geometry=a.getExtent());v.outFields=["*"];v.outSpatialReference=this.app.map.spatialReference;v.returnGeometry=!0;this.app.map.timeExtent&&(this.app.map.timeExtent.startTime||this.app.map.timeExtent.endTime)&&(v.timeExtent=
new esri.TimeExtent(this.app.map.timeExtent.startTime,this.app.map.timeExtent.endTime));this._identifyTaskExecutedCount++;var y=function(a,b){(b.essentialsMap&&b.essentialsMap.getMap&&a.isVisibleAtScale(b.essentialsMap.getMap().getScale())?a.queryFeatures(v):c.getQueryTask(a,b).execute(v)).then(dojo.hitch(b,function(a){u._isCancelled||(a=u._queryResultToIdentifyResults(a,e.layerId,e.name,e.displayField),a.forEach(function(a){a.feature._graphicsLayer=e}),u._identifyTaskCompletedCount++,k(u,a,this),
u._conditionallyInvokeCompleteCallback(u,r))}),dojo.hitch(b,function(a){u._isCancelled||(u._identifyTaskCompletedCount++,u._identifyTaskErrorCount++,t(u,a,this),u._conditionallyInvokeCompleteCallback(u,r))}))};if(e.updating)var x=dojo.connect(e,"onUpdateEnd",function(){y(e,d);dojo.disconnect(x)});else y(e,d)}};d.prototype._queryResultToIdentifyResults=function(a,b,d,c){var e=[];if(a&&a.features&&0<a.features.length)for(var f=0;f<a.features.length;f++)e.push({feature:a.features[f],displayFieldName:c,
layerId:b,layerName:d});return e};d.prototype._conditionallyInvokeCompleteCallback=function(a,b){a._taskExecutionComplete&&a._identifyTaskExecutedCount==a._identifyTaskCompletedCount&&(a.allServicesInError=a._identifyTaskExecutedCount==a._identifyTaskErrorCount,b(a))};d.prototype.cancel=function(){this._isCancelled=!0};return d}();f.MapIdentifyTask=h});
define("infrastructure/identify/MapIdentifyTaskIdentifyProvider",["require","exports","infrastructure/identify/IdentifyProviderBase","infrastructure/identify/MapIdentifyTask","infrastructure/identify/IdentifyUtils"],function(h,f,k,l,e){h=function(c){function a(){var a=null!==c&&c.apply(this,arguments)||this;a._identifyTask=null;a.defaultPixelTolerance=5;a.defaultPolygonPixelTolerance=2;a._pixelTolerance=null;a._polygonPixelTolerance=null;a._topMostLayerOnly=null;a._returnGeometry=null;a._visibleLayersOnly=
null;a._layersInVisibleScaleRangeOnly=null;return a}__extends(a,c);a.prototype.initialize=function(a){null!=a.pixelTolerance&&(this._pixelTolerance=a.pixelTolerance);null!=a.polygonPixelTolerance&&(this._polygonPixelTolerance=a.polygonPixelTolerance);null!=a.visibleLayersOnly&&(this._visibleLayersOnly=!!a.visibleLayersOnly);null!=a.layersInVisibleScaleRangeOnly&&(this._layersInVisibleScaleRangeOnly=!!a.layersInVisibleScaleRangeOnly);null!=a.topMostLayerOnly&&(this._topMostLayerOnly=!!a.topMostLayerOnly);
null!=a.returnGeometry&&(this._returnGeometry=!!a.returnGeometry)};a.prototype.search=function(a,d){var c=this;return new Promise(function(e,f){var h=null;if(d.delayFSCOpen)var k=a.id,s=!1,h=function(){s||(s=!0,c.app.featureSetManager.openCollection(k))};else c.app.featureSetManager.openCollection(a.id);c._identifyTask=new l.MapIdentifyTask(c.app.map,c.app);c._identifyTask.tag=a;c._identifyTask.pixelTolerance=null!=c._pixelTolerance?c._pixelTolerance:d.pixelTolerance;c._identifyTask.polygonPixelTolerance=
null!=c._polygonPixelTolerance?c._polygonPixelTolerance:d.polygonPixelTolerance;c._identifyTask.topMostLayerOnly=null!=c._topMostLayerOnly?c._topMostLayerOnly:!!d.topMostLayerOnly;c._identifyTask.returnGeometry=null!=c._returnGeometry?c._returnGeometry:!!d.returnGeometry;c._identifyTask.layersInVisibleScaleRangeOnly=null!=c._layersInVisibleScaleRangeOnly?c._layersInVisibleScaleRangeOnly:!!d.layersInVisibleScaleRangeOnly;c._identifyTask.restrictRasterIdentifyToPoint=!!d.restrictRasterIdentifyToPoint;
d.identifiableLayerInfo&&(c._identifyTask.mapServicesAndLayersToIdentify=d.identifiableLayerInfo);isNaN(c._identifyTask.pixelTolerance)&&(c._identifyTask.pixelTolerance=c.defaultPixelTolerance);isNaN(c._identifyTask.polygonPixelTolerance)&&(c._identifyTask.polygonPixelTolerance=c.defaultPolygonPixelTolerance);d.extent&&(c._identifyTask.extent=d.extent);d.width&&(c._identifyTask.width=d.width);d.height&&(c._identifyTask.height=d.height);null!==d.visibleLayersOnly&&(c._identifyTask.visibleLayersOnly=
d.visibleLayersOnly);null!==d.visibleMapServicesOnly&&(c._identifyTask.visibleMapServicesOnly=d.visibleMapServicesOnly);d.layerRestriction&&(c._identifyTask.layerRestriction=d.layerRestriction);h&&(c._identifyTask.delayedFSCOpen=h);c._identifyTask.execute(d.geometry,function(a,b,d){c.identifyTaskProgress(a,b,d)},function(a){c.identifyTaskComplete(a);e()},function(a,b,d){c.identifyTaskError(a,b,d)})})};a.prototype.identifyTaskProgress=function(a,d,c){e.appendToFeatureSetCollection(d,a.tag,c,this.app)};
a.prototype.identifyTaskComplete=function(a){this.app.featureSetManager.tryCloseCollection(a.tag.id)};a.prototype.identifyTaskError=function(a,d,c){this.app.featureSetManager.tryCloseCollection(a.tag.id);a=this.getResource("language-identify-error-message",null).format(d.message,d.details);this.app.command("Alert").execute(a);c&&this.app.trace.error("Error performing identify operation on service {0}. Message: {1}. Error details: {2}.".format(c.serviceLayer.url,d.message,d.details))};a.prototype.cancelSearch=
function(){this._identifyTask&&this._identifyTask.cancel()};return a}(k.IdentifyProviderBase);f.MapIdentifyTaskIdentifyProvider=h});
define("infrastructure/identify/RasterIdentifyTask",["require","exports","geocortex/essentials/MapServiceConstants","infrastructure/TaskUtils","infrastructure/GeometryUtils"],function(h,f,k,l,e){h=function(){function c(a,b){this._identifyTaskErrorCount=this._identifyTaskCompletedCount=this._identifyTaskExecutedCount=0;this._isCancelled=this._taskExecutionComplete=!1;this._featureLayers={};this.mapServicesAndLayersToIdentify=this.delayedFSCOpen=this.tag=this.map=this.app=null;this.app=b||null;this.map=
a}c.prototype.getFeatureLayer=function(a){return a?this._featureLayers[a.id]:null};c.prototype.execute=function(a,b,d,c,e){var f=this;e=this.app.site.essentialsMap.mapServices.filter(function(a){if(a.mapServiceType===k.MapServiceType.IMAGE&&a.isVisible()){var b=a.identifiable;if(f.mapServicesAndLayersToIdentify)for(var d in f.mapServicesAndLayersToIdentify)f.mapServicesAndLayersToIdentify.hasOwnProperty(d)&&f.mapServicesAndLayersToIdentify[d].mapServiceId===a.id&&(b=f.mapServicesAndLayersToIdentify[d].mapServiceIdentifiable);
return b}return!1});this.delayedFSCOpen&&e&&0<e.length&&this.delayedFSCOpen();this._identifyTaskErrorCount=this._identifyTaskCompletedCount=this._identifyTaskExecutedCount=0;this._taskExecutionComplete=!1;var h=new esri.tasks.ImageServiceIdentifyParameters,p=this._getIdentifyGeometry(a);h.geometry=p;h.returnGeometry=!0;for(a=0;a<e.length;a++){var s=e[a],r=s.serviceLayer;h.returnCatalogItems=s.includeCatalogItems||s.includeMosaicDatasetValues;r.mosaicRule&&(h.mosaicRule=r.mosaicRule);r.renderingRule&&
(h.renderingRule=r.renderingRule);this._identifyTaskExecutedCount++;var t=this,u=new esri.tasks.ImageServiceIdentifyTask(l.getTokenizedUrl(s.serviceUrl,s));this._fetchFieldMetadata(s)["catch"](function(a){}).then(function(){u.execute(h,dojo.hitch(s,function(a){t._isCancelled||(a.location=p,t._identifyTaskCompletedCount++,b(t,a,this),t._conditionallyInvokeCompleteCallback(t,d))}),dojo.hitch(s,function(a){t._isCancelled||(t._identifyTaskCompletedCount++,t._identifyTaskErrorCount++,c(t,a,this),t._conditionallyInvokeCompleteCallback(t,
d))}))})}this._taskExecutionComplete=!0;this._conditionallyInvokeCompleteCallback(this,d)};c.prototype._getIdentifyGeometry=function(a){if(a instanceof esri.geometry.Point)return a;if(a instanceof esri.geometry.Polygon)return a.getCentroid();if(a instanceof esri.geometry.Polyline)return e.getMiddle(a)};c.prototype._conditionallyInvokeCompleteCallback=function(a,b){a._taskExecutionComplete&&a._identifyTaskExecutedCount==a._identifyTaskCompletedCount&&b(a)};c.prototype.cancel=function(){this._isCancelled=
!0};c.prototype._fetchFieldMetadata=function(a){var b=this;return this._featureLayers[a.id]?Promise.resolve():a.getFeatureLayer().then(function(d){b._featureLayers[a.id]=d})};return c}();f.RasterIdentifyTask=h});
define("infrastructure/identify/RasterIdentifyUtils","require exports infrastructure/FeatureSetCollection geocortex/essentials/Field infrastructure/FeatureSet infrastructure/Feature infrastructure/TimeZoneUtils infrastructure/GeometryUtils".split(" "),function(h,f,k,l,e,c,a,b){h=function(){function d(a,b,d){this.includeMosaicDatasetValues=this.includeCatalogItems=!1;this._libraryId=d;this._mapService=a;this._app=b}d.prototype.appendToFeatureSetCollection=function(a,b){if(a){null==b&&(b=new k.FeatureSetCollection);
if("NoData"!==a.value){var d=this._mapService.serviceLayer.fields;if(a.location){var c=[],e=[],f=this._mapService.serviceLayer.bandCount;if((f&&0<f||!f)&&a.value){var h=[a.value];this.includeMosaicDatasetValues&&a.properties&&0<a.properties.Values.length&&(h=h.concat(a.properties.Values));if(h&&0<h.length)for(var t=0;t<h.length;t++){var u=new esri.Graphic(a.location);u.attributes=[];var v;v=-1!==h[t].indexOf(",")?h[t].replace(/ /g,""):h[t].replace(/ /g,",");var y={};if(!f||1<f)y.value=v,0===t&&e.push({name:"value",
alias:"value",type:l.EsriFieldTypes.esriFieldTypeString});for(var x=function(){var a=v.indexOf(","),a=-1!==a?a:0,b=0!=a?v.substring(0,a):v,d=1<f?"value"+(A+1).toString():"value";v=v.substring(0!==a?a+1:a,v.length);a=null;0===t?(a=w._getFieldTypeInformation(b),e.push({name:d,alias:d,type:a})):a=e.filter(function(a){return a.name===d})[0].type;y[d]=w._parseAttributeValue(b,a)},w=this,A=0;A<f;A++)x();u.setAttributes(y);c.push(u)}}this._createAndAddGcxFeatureSet("value",b,c,a.location.type,a.location.spatialReference,
this._mapService.displayName+", {value}",e)}this.includeCatalogItems&&a.catalogItems&&a.catalogItems.features&&(c=a.catalogItems,c.displayFieldName=c.displayFieldName?0<d.length?d[0].name:c.displayFieldName:c.objectIdFieldName,c.features=c.features.filter(function(b,d){return a.catalogItems&&1===a.catalogItemVisibilities[d]?!0:!1}),d=this._app.getResource(this._libraryId,"language-rasterIdentify-catalogItem-labelFormat").format(this._mapService.displayName,"{"+c.displayFieldName+"}"),this._createAndAddGcxFeatureSetFromEsriFeatureSet(c,
d,b,null))}return b}};d.prototype._parseAttributeValue=function(a,b){switch(b){case l.EsriFieldTypes.esriFieldTypeSingle:case l.EsriFieldTypes.esriFieldTypeDouble:return parseFloat(a);case l.EsriFieldTypes.esriFieldTypeSmallInteger:case l.EsriFieldTypes.esriFieldTypeInteger:return parseInt(a);default:return null}};d.prototype._getFieldTypeInformation=function(a){if($.isNumeric(a))if(a=Number(a),0!==Math.abs(a%1)){if(-3.4E38<=a&&1.2E38>=a)return l.EsriFieldTypes.esriFieldTypeSingle;if(-Infinity<=a&&
Infinity>=a)return l.EsriFieldTypes.esriFieldTypeDouble}else{if(-32768<=a&&32767>=a)return l.EsriFieldTypes.esriFieldTypeSmallInteger;if(-2147483648<=a&&2147483647>=a)return l.EsriFieldTypes.esriFieldTypeInteger}return l.EsriFieldTypes.esriFieldTypeString};d.prototype._createAndAddGcxFeatureSet=function(a,b,d,c,e,f,h){a=new esri.tasks.FeatureSet({displayFieldName:a});a.geometryType=c;a.spatialReference=e;a.features=d;this._createAndAddGcxFeatureSetFromEsriFeatureSet(a,f,b,h)};d.prototype._createAndAddGcxFeatureSetFromEsriFeatureSet=
function(d,c,f,h){var l=this,k,r=this.featureLayer.fields;try{h&&(this.featureLayer.fields=h),k=new e.FeatureSet({esriFeatureSet:d,featureLayer:this.featureLayer,defaultDateFormat:this._mapService.defaultDateFormat,defaultNumberFormat:this._mapService.defaultNumberFormat})}finally{h&&(this.featureLayer.fields=r)}k.displayName.set(this._mapService.displayName);k.iconUri.set(this._mapService.iconUri);k.features.get().forEach(function(b){b.labelFormat.set(c);b.timeZoneId=a.getTimeZoneFromMapService(l._mapService);
b.displayTimeZoneId=a.getDisplayTimeZoneFromMapService(l._mapService)});0<k.features.get().filter(function(a){return b.needsProjection(a.esriFeature.get().geometry,l._app)}).length&&f?(d=k.features.get().map(function(a){return a.esriFeature.get().geometry}),h=new esri.tasks.ProjectParameters,h.geometries=d,h.outSR=this._app.map.extent.spatialReference,b.project(h,function(a){k.features.get().forEach(function(b,d){b.esriFeature.get().setGeometry(a[d])});f.featureSets.addItem(k)},function(a){f.featureSets.addItem(k)},
this._app)):f.featureSets.addItem(k)};d.prototype._convertEsriFeatureToGcxFeature=function(a,b,d,e,f){b=new c.Feature({graphic:b,layer:d,resolveLayerFields:!!e,allowUnsafeContent:!!f});b.labelFormat.set(a);return b};return d}();f.RasterIdentifyUtils=h});
define("infrastructure/identify/RasterIdentifyTaskIdentifyProvider",["require","exports","infrastructure/identify/IdentifyProviderBase","infrastructure/identify/RasterIdentifyTask","infrastructure/identify/RasterIdentifyUtils"],function(h,f,k,l,e){h=function(c){function a(){var a=null!==c&&c.apply(this,arguments)||this;a._identifyTask=null;return a}__extends(a,c);a.prototype.initialize=function(a){};a.prototype.search=function(a,d){var c=this;return new Promise(function(e,f){var h=null;if(d.restrictRasterIdentifyToPoint&&
"point"!==d.geometry.type)return e();if(d.delayFSCOpen)var k=a.id,s=!1,h=function(){s||(s=!0,c.app.featureSetManager.openCollection(k))};else c.app.featureSetManager.openCollection(a.id);c._identifyTask=new l.RasterIdentifyTask(c.app.map,c.app);c._identifyTask.tag=a;d.identifiableLayerInfo&&(c._identifyTask.mapServicesAndLayersToIdentify=d.identifiableLayerInfo);h&&(c._identifyTask.delayedFSCOpen=h);c._identifyTask.execute(d.geometry,function(a,b,d){c.identifyTaskProgress(a,b,d)},function(a){c.identifyTaskComplete(a);
e()},function(a,b,d){c.identifyTaskError(a,b,d)})})};a.prototype.identifyTaskProgress=function(a,d,c){a=a.tag;var f=new e.RasterIdentifyUtils(c,this.app,this.libraryId);f.featureLayer=this._identifyTask.getFeatureLayer(c);f.includeCatalogItems=c.includeCatalogItems;f.includeMosaicDatasetValues=c.includeMosaicDatasetValues;f.appendToFeatureSetCollection(d,a)};a.prototype.identifyTaskComplete=function(a){this.app.featureSetManager.tryCloseCollection(a.tag.id)};a.prototype.identifyTaskError=function(a,
d,c){this.app.featureSetManager.tryCloseCollection(a.tag.id);a=this.getResource("language-identify-error-message",null).format(d.message,d.details);this.app.command("Alert").execute(a);c&&this.app.trace.error("Error performing identify operation on service {0}. Message: {1}. Error details: {2}.".format(c.serviceLayer.url,d.message,d.details))};a.prototype.cancelSearch=function(){this._identifyTask&&this._identifyTask.cancel()};return a}(k.IdentifyProviderBase);f.RasterIdentifyTaskIdentifyProvider=
h});define("infrastructure/integration/ComponentFrameInfo",["require","exports"],function(h,f){});define("infrastructure/integration/MapPosition",["require","exports"],function(h,f){});define("infrastructure/integration/MapViewpointMessage",["require","exports"],function(h,f){});define("infrastructure/integration/ComponentInitializationMessage",["require","exports"],function(h,f){});define("infrastructure/integration/ComponentViewpointMessage",["require","exports"],function(h,f){});
define("infrastructure/integration/ComponentStateMessage",["require","exports"],function(h,f){});define("infrastructure/layerCatalog/LayerCatalogFilterProviderBase",["require","exports"],function(h,f){var k=function(){function f(e,c){this.app=e;this.libraryId=c}f.prototype.initialize=function(e){};f.prototype.filter=function(e,c){return Promise.resolve()};return f}();f.LayerCatalogFilterProviderBase=k});
define("infrastructure/legend/LegendItem",["require","exports","geocortex/framework/observables"],function(h,f,k){h=function(){return function(f,e){var c=this;this.esriLayer=f;this.templateType="single-item";this.swatchElement=null;this.label=new k.Observable("");this.description=new k.Observable("");this.isVisible=new k.Observable(!0);this.isVisibleInLayerListLegend=new k.Observable(!0);this.isCluster=!1;this.expanded=new k.Observable(!0);this.expanderClass=new k.Observable;this.children=new k.ObservableCollection;
this.children.useThrottling=!!e;this.expanderClass.syncTransform(this.expanded,function(a){return a?"tree-expander expanded":"tree-expander collapsed"});this.expanded.pulse();this.isVisibleInLayerListLegend.syncTransform(this.isVisible,function(a){return c.isCluster?a:!0})}}();f.LegendItem=h});
define("infrastructure/layerList/LayerListFolderItem",["require","exports","infrastructure/layerList/LayerListItem","geocortex/framework/observables"],function(h,f,k,l){h=function(e){function c(a,b,d){a=e.call(this,a,k.LayerListItemType.FOLDER,d)||this;a.layerThemeSettings=[];a.containedMapServices=[];a.configuredVisible=!1;a.isUserCreated=!1;a._layerVisibilityHandle=null;a._themeChangingHandle=null;a._themeChangedHandle=null;a.name.set(b||a.layerList.appInfo.gcxApp.getResource(a.layerList._libraryId,
"language-layerlist-default-folder-title"));a._setTooltips();a.layerList&&a.layerList.mapInfo&&a.layerList.mapInfo.gcxMap&&a.layerList.mapInfo.gcxMap.layerThemesInfo&&(a._themeChangingHandle=dojo.connect(a.layerList.mapInfo.gcxMap.layerThemesInfo,"layerThemeChangingEvent",dojo.hitch(a,a._handleLayerThemeChangingEvent)),a._themeChangedHandle=dojo.connect(a.layerList.mapInfo.gcxMap.layerThemesInfo,"layerThemeChangedEvent",dojo.hitch(a,a._handleLayerThemeChangedEvent)));d._addedFolderReferences.push(a);
return a}__extends(c,e);c.prototype.setVisibility=function(a){e.prototype.setVisibility.call(this,a);void 0==this._deferredVisibilitySetting&&(this.currentUserClickOriginator=!1,this.mapService&&this.mapService.setVisibility(a&&this.allAncestorsVisible&&(this.inActiveTheme.get()||this.mapService.isUserCreated)))};c.prototype.refreshOnDemandItemCollection=function(a){e.prototype.refreshOnDemandItemCollection.call(this,a);this.displayItem.set(this.displayInLayerList()&&this.layerList.filterControlComponent.queryMatched(this))};
c.prototype.linkWithMapService=function(a){var b=this;a&&(this.mapService=a,this.layerList._handledMapServiceReferences.push(this.mapService),-1===this.layerList._allMapServiceReferences.indexOf(this.mapService)&&this.layerList._allMapServiceReferences.push(this.mapService),this._setupOpacityBindings(),this._layerVisibilityHandle=this.mapService.serviceLayer.on("visibility-change",function(a){if(void 0!=b._deferredVisibilitySetting||b.isEffectivelyVisible.get()!==a.visible||b.isEffectivelyVisible.get()&&
!b.inActiveTheme.get()&&!b.mapService.isUserCreated)a=a.visible&&(b.inActiveTheme.get()||b.mapService.isUserCreated),b.isVisible.set(a)}))};c.prototype._setupOpacityBindings=function(){var a=this;1===this.containedMapServices.length?e.prototype._setupOpacityBindings.call(this):1<this.containedMapServices.length&&(this.canAdjustOpacity.set(!0),this.opacity=new l.Observable(1),this.opacity.bind(this,function(b){for(var d=0;d<a.containedMapServices.length;d++)a.containedMapServices[d].gcxMapService&&
a.containedMapServices[d].gcxMapService.setOpacityFilter(b)}))};c.prototype.cleanUp=function(){e.prototype.cleanUp.call(this);this._layerVisibilityHandle&&(this._layerVisibilityHandle.remove(),this._layerVisibilityHandle=null);this._themeChangingHandle&&(dojo.unsubscribe(this._themeChangingHandle),this._themeChangingHandle=null);this._themeChangedHandle&&(dojo.unsubscribe(this._themeChangedHandle),this._themeChangedHandle=null)};c.prototype._handleLayerThemeChangingEvent=function(a){a.currTheme&&
(this.isUserCreated||this.isVisible.get()||this.isVisible.set(!0))};c.prototype._handleLayerThemeChangedEvent=function(a){if(a.currTheme){a=a.currTheme;if(this.isUserCreated)this._setInActiveThemeIfChildrenPresent();else if(a.isDefaultTheme)this.isVisible.get()!==this.configuredVisible&&this.isVisible.set(this.configuredVisible),this._setInActiveThemeIfChildrenPresent();else{if(this.layerThemeSettings.length)for(var b=0;b<this.layerThemeSettings.length;b++){var d=this.layerThemeSettings[b];if(a.id===
d.theme.id){a=void 0==d.visible?this.configuredVisible:d.visible;this.isVisible.get()!==a&&this.isVisible.set(a);this._setInActiveThemeIfChildrenPresent();this._refreshMutuallyExclusiveItemVisibilities();this.refreshOnDemandItemCollection();this._updateDisplayItem();return}}this.isVisible.set(!1);this.inActiveTheme.set(!1)}this._refreshMutuallyExclusiveItemVisibilities();this.refreshOnDemandItemCollection();this._updateDisplayItem()}};c.prototype._refreshMutuallyExclusiveItemVisibilities=function(){this.children.get().forEach(function(a){a.isMutuallyExclusive.get()&&
a.isVisible.get()&&a.isVisible.pulse()})};c.prototype._setInActiveThemeIfChildrenPresent=function(){var a=this._recursivelyConfirmChildrenInActiveTheme(this.children.get());!a&&this.inActiveTheme.get()&&this.inActiveTheme.set(!1);a&&!this.inActiveTheme.get()&&this.inActiveTheme.set(!0)};c.prototype._recursivelyConfirmChildrenInActiveTheme=function(a){for(var b=0;b<a.length;b++){var d;d=a[b];d=d.type===k.LayerListItemType.FOLDER?d.children&&d.children.length()?this._recursivelyConfirmChildrenInActiveTheme(d.children.get()):
!1:d.inActiveTheme.get();if(d)return!0}return!1};return c}(k.LayerListItem);f.LayerListFolderItem=h});
define("infrastructure/layerList/LayerListItem","require exports infrastructure/layerList/LayerListNode geocortex/framework/observables infrastructure/layerList/LayerListItemCollection geocortex/essentials/MapServiceConstants".split(" "),function(h,f,k,l,e,c){var a;(function(a){a[a.FOLDER=0]="FOLDER";a[a.MAPSERVICE=1]="MAPSERVICE";a[a.LAYER=2]="LAYER";a[a.GRAPHICSLAYER=3]="GRAPHICSLAYER";a[a.KMLFOLDER=4]="KMLFOLDER"})(a=f.LayerListItemType||(f.LayerListItemType={}));h=function(b){function d(a,d,c){var f=
b.call(this,a)||this;f.mapService=null;f.opacity=null;f._opacityChangeHandle=null;f._parentExpandedStateBeforeFilter=null;if(!a)throw Error("LayerListItem: Initialization failed. Layer list item id cannot be null");if(!c)throw Error("LayerListItem: Initialization failed. LayerList cannot be null");f.type=d;f.layerList=c;f.allAncestorsVisible=!0;f.isVisible=new l.Observable(!1);f.isEffectivelyVisible=new l.Observable(!1);f.parentEffectivelyVisible=new l.Observable(!0);f.inVisibleScaleRange=new l.Observable(!0);
f.isEffectivelyVisible.syncTransform(f.isVisible,function(a){return a&&!!f.allAncestorsVisible});f.name=new l.Observable("");f.isExpanded=new l.Observable(!1);f.expandLegend=new l.Observable(!1);f.canNotAssignVisibility=new l.Observable(!1);f.canAdjustOpacity=new l.Observable(!1);f.inActiveTheme=new l.Observable(!0);f.canDisplayItem=new l.Observable(!0);f.displayItem=new l.Observable(!0);f.hasDisplayedChildren=new l.Observable(!1);f.children=new e.LayerListItemCollection(f);f.onDemandItemCollection=
new l.ObservableCollection([]);f.legendItems=new l.ObservableCollection([]);f.legendSwatch=new l.Observable("");f.legendHasMultipleItems=new l.Observable(!1);f.enableLayerActions=!1;f.enableMapServiceActions=!1;f.iconUri=new l.Observable("");f.iconTooltip=new l.Observable("");f.legendTooltip=new l.Observable("");f.layerFolderToggleTooltip=new l.Observable("");f.layerActionsTooltip=new l.Observable("");f.layerToggleTooltip=new l.Observable("");f.mapServiceActionsTooltip=new l.Observable("");f.isMutuallyExclusive=
new l.Observable(!1);f.hasRadioToggle=new l.Observable(!1);f.radioGroup=new l.Observable("");f.isVisible.bind(f,f.setVisibility);f.isExpanded.bind(f,f.refreshOnDemandItemCollection);f.inActiveTheme.bind(f,f._onActiveThemeChanged);f.canDisplayItem.bind(f,f._updateDisplayItem);f.currentUserClickOriginator=!1;f.legendIsVisible=new l.Observable(!1);f.layerList.onlyShowSwatchesOnVisibleLayers&&(f.isEffectivelyVisible.bind(f,f._processLegendVisibility),f.inVisibleScaleRange.bind(f,f._processLegendVisibility),
f.legendItems.bind(f,f._processLegendVisibility));f.displayItem.bind(f,f._processLegendVisibility);f.legendSwatch.bind(f,function(a){f.layerList.enableLegendIntegration&&f._processLegendVisibility()});f.name.bind(f,f._updateFilterControlComponent);f.canDisplayItem.bind(f,f._updateFilterControlComponent);return f}__extends(d,b);d.prototype.bindToActiveTheme=function(){};d.prototype.unbindFromActiveTheme=function(){};d.prototype.cleanUp=function(){this._opacityChangeHandle&&(this._opacityChangeHandle.remove(),
this._opacityChangeHandle=null);this.unbindFromActiveTheme();this.layerList.filterControlComponent.removeRegisteredItem(this)};d.prototype.notifyActiveThemeChanged=function(b){b&&!this.inActiveTheme.get()&&this.inActiveTheme.set(!0);this.type===a.FOLDER&&!b&&this.inActiveTheme.get()&&this.children&&dojo.every(this.children.get(),function(a){return!a.inActiveTheme.get()})&&this.inActiveTheme.set(!1)};d.prototype.setItemVisibility=function(a){this.currentUserClickOriginator=!0;this.isVisible.set(a)};
d.prototype.setVisibility=function(a){if(void 0!==this.allAncestorsVisible)if(void 0!=this._deferredVisibilitySetting)this._deferredVisibilitySetting=a;else if(a&&this.isMutuallyExclusive.get()&&this.parent&&!this.layerList.mapInfo.gcxMap.layerThemesInfo.themeChangeInProgress)for(a=0;a<this.parent.children.length();a++){var b=this.parent.children.getAt(a);b!==this&&b.isVisible.get()&&b.isVisible.set(!1)}};d.prototype.setAncestorVisibility=function(a){this.allAncestorsVisible=a;this.isVisible.pulse()};
d.prototype.refreshOnDemandItemCollection=function(a){a=void 0==a?this.isExpanded.get():a;this.onDemandItemCollection.clear();if(this.children&&this.children.length()&&a){a=0;for(var b=this.children.length();a<b;a++){var d=this.children.getAt(a);this.displayInLayerList(d)&&this.onDemandItemCollection.addItem(d)}}};d.prototype.populateMapServicesInParentFolders=function(){var b=this;if(this.type!==a.FOLDER&&this.mapService){for(var d=[],c=this.parent,e=!0;c;){if(c.type===a.MAPSERVICE&&c.mapService===
this.mapService)return;c.type===a.FOLDER&&(e=!1,-1===c.containedMapServices.indexOf(this.mapService)&&-1===c.id.get().indexOf(this.layerList.id.get())&&d.push(c));c=c.parent}e?this.layerList._outOfFolderMapServiceReferences.push(this.mapService):dojo.forEach(d,function(a){a.containedMapServices.push(b.mapService)})}};d.prototype.updateDisplayItem=function(){this._updateDisplayItem()};d.prototype.displayInLayerList=function(b){void 0===b&&(b=this);if(!b.inActiveTheme.get())return!1;if(b.type!==a.FOLDER)return b.canDisplayItem.get();
var d=!1;if(b.children&&b.children.length())for(var c=0,e=b.children.length();c<e;c++){var f=b.children.getAt(c);if(this.displayInLayerList(f))return!0;if(f.inActiveTheme.get()&&!f.canDisplayItem.get()){d=!0;break}}return d&&b.canDisplayItem.get()};d.prototype._applyDeferredInitialVisibility=function(){if(void 0!=this._deferredVisibilitySetting&&!this.layerList.suspendMapUpdates){var a=this._deferredVisibilitySetting;delete this._deferredVisibilitySetting;this.setVisibility(a)}};d.prototype._setupOpacityBindings=
function(){var b=this;this.type!==a.LAYER&&this.type!==a.GRAPHICSLAYER&&this.mapService&&this.mapService.serviceLayer&&void 0!=this.mapService.serviceLayer.opacity&&void 0!=this.mapService.serviceLayer.setOpacity&&this.mapService.serviceType!==c.MapServiceType.FEATURE&&(this.canAdjustOpacity.set(!0),this.opacity=new l.Observable(this.mapService.serviceLayer.opacity),this.opacity.bind(this,function(a){b.mapService.setOpacity(a)}),this._opacityChangeHandle=this.mapService.serviceLayer.on("opacity-change",
function(a){var d=!!b.layerList.appInfo.gcxApp.project.isLoading,c=d&&b.mapService.gcxMapService?b.mapService.gcxMapService.opacity:a.opacity;!d&&b.mapService.gcxMapService&&a.opacity===b.mapService.gcxMapService.opacity*b.mapService.gcxMapService.opacityFilter||b.opacity.set(c)}))};d.prototype._updateDisplayItem=function(){var a=this.displayInLayerList(),a=a&&this.layerList.filterControlComponent.queryMatched(this);this.displayItem.set(a);if((a=this.getSiblings(!0))&&a.length){for(var b=0,d=0;d<
a.length;d++){var c=a[d];c.displayItem.get()&&b++}for(d=0;d<a.length;d++)c=a[d],c.hasRadioToggle.set(c.isMutuallyExclusive.get()&&1!==b)}};d.prototype._onActiveThemeChanged=function(a){this._updateDisplayItem();var b=this.parent;b&&b.id!==this.layerList.id&&b.notifyActiveThemeChanged(a)};d.prototype._processLegendVisibility=function(){this.layerList.onlyShowSwatchesOnVisibleLayers?this.legendIsVisible.set(this.isEffectivelyVisible.get()&&this.inVisibleScaleRange.get()&&!!this.legendItems.length()&&
!!this.legendSwatch.get()&&this.displayItem.get()):this.legendIsVisible.set(!!this.legendItems.length()&&!!this.legendSwatch.get()&&this.displayItem.get());1==this.legendItems.length()&&this.expandLegend.set(!1)};d.prototype._setTooltips=function(){var a=this,b=this.layerList.appInfo.gcxApp.getResource(this.layerList._libraryId,"language-layerlist-toggle").format(this.name.get()),d=this.layerList.appInfo.gcxApp.getResource(this.layerList._libraryId,"language-layer-actions-tooltip").format(this.name.get()),
c=this.layerList.appInfo.gcxApp.getResource(this.layerList._libraryId,"language-layerlist-visible-at-extent"),e=this.layerList.appInfo.gcxApp.getResource(this.layerList._libraryId,"language-layerlist-not-visible-at-extent"),f=this.layerList.appInfo.gcxApp.getResource(this.layerList._libraryId,"language-layerlist-expand").format(this.name.get());this.layerActionsTooltip.set(d);this.layerFolderToggleTooltip.set(f);this.inVisibleScaleRange.get()?this.layerToggleTooltip.set(b+" "+c):this.layerToggleTooltip.set(b+
" "+e);this.inVisibleScaleRange.bind(this,function(d){d?a.layerToggleTooltip.set(b+" "+c):a.layerToggleTooltip.set(b+" "+e)})};d.prototype._updateFilterControlComponent=function(){var a=this.canDisplayItem.get()&&!!this.name.get(),b=null!==this.layerList.filterControlComponent.getFilterableItem(this);a?(!b&&this.layerList.filterControlComponent.registerFilterableItem(this),this.layerList.filterControlComponent.setFilterData(this,[this.name.get()])):b&&this.layerList.filterControlComponent.removeRegisteredItem(this)};
return d}(k.LayerListNode);f.LayerListItem=h});
define("infrastructure/legend/LegendItemProviderResponse",["require","exports","geocortex/framework/observables"],function(h,f,k){(function(f){f[f.NotFound=0]="NotFound";f[f.Rendered=1]="Rendered";f[f.Show=2]="Show";f[f.Hide=3]="Hide";f[f.Pending=4]="Pending";f[f.Error=5]="Error"})(f.LegendItemProviderResponseCode||(f.LegendItemProviderResponseCode={}));h=function(){return function(f,e){this.code=new k.Observable(f);this.item=e}}();f.LegendItemProviderResponse=h});
define("infrastructure/legend/LegendItemProvider",["require","exports"],function(h,f){});
define("infrastructure/legend/LegendItemProviderFactory",["require","exports","infrastructure/legend/LegendItemProviderResponse"],function(h,f,k){h=function(){function f(){}f.registerLegendItemProvider=function(e){var c=this,a=function(a,b){c._legendItemInfos.push({uniqueId:a,legendItem:b});for(var d=0;d<c._legendItemCallbacks.length;d++)if(a===c._legendItemCallbacks[d].uniqueId){c._legendItemCallbacks[d].callback(b);c._legendItemCallbacks.splice(d,1);break}},b=function(a){var b=a.essLayer&&a.essLayer.mapService&&
a.essLayer.mapService.id||a.children&&a.children.length()&&a.children.getAt(0).essLayer&&a.children.getAt(0).essLayer.mapService&&a.children.getAt(0).essLayer.mapService.id||a.esriLayer.id;a=a.essLayer&&a.essLayer.id||a.sublayerId||null;return b+(null!=a?"."+a:"")},d=function(c){if(c){if("group"===c.templateType){var e;if(e=c.children.length())a:{e=c.children.get();if(e.length)for(var f,h=0;h<e.length;h++){var l=e[h].sublayerId||e[h].essLayer&&e[h].essLayer.id;0===h&&(f=l);if(l!==f||"single-item"!==
e[h].templateType){e=!1;break a}}e=!0}if(e){f=c.children.getAt(0);a(b(f),c);return}if(c.children&&c.children.length())for(f=0,e=c.children.length();f<e;f++)h=c.children.getAt(f),d(h)}"single-item"===c.templateType&&a(b(c),c)}};dojo.aspect.after(e,"provide",function(a){var b=a.code.get();if(b===k.LegendItemProviderResponseCode.Pending||b===k.LegendItemProviderResponseCode.Show)if(b===k.LegendItemProviderResponseCode.Show)a.item&&d(a.item);else var e=a.code.bind(c,function(b){a.code.unbind(e);b===k.LegendItemProviderResponseCode.Show&&
a.item&&d(a.item)});return a});this._providers.push(e)};f.getProviders=function(){return this._providers};f.getLegendItemWhenAvailable=function(e,c){this.getLegendItemByIdWhenAvailable(e.uniqueId,c)};f.getLegendItemByIdWhenAvailable=function(e,c){if(e&&c){for(var a=null,b=0,d=this._legendItemInfos.length;b<d;b++){var g=this._legendItemInfos[b];g.uniqueId===e&&(a=g.legendItem)}a?c(a):this._legendItemCallbacks.push({uniqueId:e,callback:c})}};return f}();h._providers=[];h._legendItemInfos=[];h._legendItemCallbacks=
[];f.LegendItemProviderFactory=h});
define("infrastructure/layerList/LayerListLayerItem",["require","exports","infrastructure/layerList/LayerListItem","infrastructure/legend/LegendItemProviderFactory"],function(h,f,k,l){h=function(e){function c(a,b,d,c){a=e.call(this,a,c||k.LayerListItemType.LAYER,d)||this;a._themeSyncHandle=null;a._layerVisibilityHandle=null;a._zoomEndHandle=null;a._deferRefreshTimeoutMs=200;a._forceSetAncestorVisibilityOperationActive=!1;if(!b)throw Error("LayerListLayerItem Initialization failed. Layer cannot be null");a.isUserCreated=
b.isUserCreated;a.layer=b;a._updateVisibilityAtCurrentScale();a._zoomEndHandle=a.layerList.appInfo.mapInfo.map.on("zoom-end",dojo.hitch(a,a._updateVisibilityAtCurrentScale));a.type===k.LayerListItemType.LAYER&&(c=b.gcxLayer?b.gcxLayer.isVisible()||b.gcxLayer.configuredVisible:!0,a.canNotAssignVisibility.set(!a.layer.serviceLayerInfo.supportsLayerVisibility()),a._deferredVisibilitySetting=c,a.isVisible.set(c));a.name.set(b.displayName||b.name);a._setTooltips();a.mapService=b.serviceLayerInfo;-1===
d._allMapServiceReferences.indexOf(a.mapService)&&d._allMapServiceReferences.push(a.mapService);a.enableLayerActions=!0;a._subscribeEvents();a._setupGcxBindingsIfAvailable();return a}__extends(c,e);c.prototype.setVisibility=function(a,b){e.prototype.setVisibility.call(this,a);this._forceSetAncestorVisibilityOperationActive=this._forceSetAncestorVisibilityOperationActive||b;if(!(this.canNotAssignVisibility&&this.canNotAssignVisibility.get()||void 0===this.allAncestorsVisible||void 0!=this._deferredVisibilitySetting)){if((this._forceSetAncestorVisibilityOperationActive||
this.layerList.autoActivateAncestorVisibilities&&this.currentUserClickOriginator)&&!0===a&&!this.allAncestorsVisible){this.isVisible.get()!==a&&this.isVisible.set(a);for(var d=this.parent;d&&d.id!==this.layerList.id&&d.isVisible.get();)d=d.parent;if(d&&d.id!==this.layerList.id){d.isVisible.set(!0);return}}d=!this.currentUserClickOriginator&&this.mapService.supportsLayerVisibility();this._forceSetAncestorVisibilityOperationActive=this.currentUserClickOriginator=!1;var c=a&&this.allAncestorsVisible&&
(this.inActiveTheme.get()||this.layer.isUserCreated);this.layer.isVisible()!==c&&this.layer.setVisibility(c,!1,d,this._deferRefreshTimeoutMs)}};c.prototype.updateLegendItems=function(){var a=this;l.LegendItemProviderFactory.getLegendItemWhenAvailable(this.layer,dojo.hitch(this,function(b){a.legendItems.clear();a._populateLegendItem(b)}))};c.prototype.bindToActiveTheme=function(){var a=this;e.prototype.bindToActiveTheme.call(this);this._themeSyncHandle=dojo.subscribe("LayerInActiveThemeChangedEvent",
function(b){b&&b===a.layer.gcxLayer&&a.inActiveTheme.set(b.inActiveTheme)})};c.prototype.unbindFromActiveTheme=function(){e.prototype.unbindFromActiveTheme.call(this);this._themeSyncHandle&&dojo.unsubscribe(this._themeSyncHandle);this._themeSyncHandle=null};c.prototype.cleanUp=function(){e.prototype.cleanUp.call(this);this._layerVisibilityHandle&&(dojo.unsubscribe(this._layerVisibilityHandle),this._layerVisibilityHandle=null);this._zoomEndHandle&&(this._zoomEndHandle.remove(),this._zoomEndHandle=
null)};c.prototype._subscribeEvents=function(){this._layerVisibilityHandle=dojo.subscribe("LayerVisibilityChange",dojo.hitch(this,this._handleLayerVisibilityChange))};c.prototype._onServiceLayerProcessed=function(){this._setupIconUri();this.layerList.enableLegendIntegration&&!this.layer.serviceLayerInfo.serviceLayer.loadError&&l.LegendItemProviderFactory.getLegendItemWhenAvailable(this.layer,dojo.hitch(this,this._populateLegendItem))};c.prototype._handleLayerVisibilityChange=function(a){if(a&&a.length&&
a[0].mapServiceId===this.layer.serviceLayerInfo.id)for(var b=0;b<a.length;b++)if(a[b].layerId===this.layer.id){if(void 0==this._deferredVisibilitySetting&&this.isEffectivelyVisible.get()===a[b].visibility&&(!this.isEffectivelyVisible.get()||this.inActiveTheme.get()||this.layer.isUserCreated))break;a=a[b].visibility&&(this.inActiveTheme.get()||this.layer.isUserCreated);this.isVisible.set(a);break}};c.prototype._populateLegendItem=function(a){"single-item"===a.templateType?(this.expandLegend.set(!1),
this.legendItems.addItem(a),this.legendSwatch.set(a.swatchElement)):(this.legendItems.addItems(a.children.get()),1===this.legendItems.length()?this.legendSwatch.set(this.legendItems.getAt(0).swatchElement):this.legendItems.length()&&this.legendSwatch.set(this.layerList.multiLegendSwatchElement||this.legendItems.getAt(0).swatchElement));1<this.legendItems.length()?this.legendHasMultipleItems.set(!0):this.legendHasMultipleItems.set(!1);this.legendItems.length()&&(this.iconUri.set(""),this.legendTooltip.set(1===
this.legendItems.length()?this.layerList.singleLegendIconTooltip.format(this.name.get()):this.layerList.multiLegendIconTooltip),this.legendTooltip.set(this.legendTooltip.get().format(this.name.get())))};c.prototype._setupIconUri=function(){var a=this.layer.gcxLayer,b=a?a.mapService:null;this.layer.serviceLayerInfo.serviceLayer.loadError&&this.layerList.serviceLoadFailureIconUri?(this.iconUri.set(this.layerList.serviceLoadFailureIconUri),this.iconTooltip.set(this.layerList.serviceLoadFailureIconTooltip?
this.layerList.serviceLoadFailureIconTooltip:"")):this.layerList&&this.layerList.enableLayerIcons&&(a&&a.iconUri||b&&this.type===k.LayerListItemType.GRAPHICSLAYER&&b.iconUri)&&(this.iconUri.set(a.iconUri||b.iconUri),this.iconTooltip.set(this.name.get()))};c.prototype._setupGcxBindingsIfAvailable=function(){var a=this;if(this.layer.gcxLayer)if(this.bindToActiveTheme(),this.layer.serviceLayerInfo.serviceLayer.loaded||this.layer.serviceLayerInfo.serviceLayer.loadError)this._onServiceLayerProcessed();
else var b=null,d=null,c=function(){b&&dojo.disconnect(b);d&&dojo.disconnect(d);b=d=null},b=dojo.connect(this.mapService.serviceLayer,"onLoad",function(){c();a._onServiceLayerProcessed()}),d=dojo.connect(this.mapService.serviceLayer,"onError",function(){c();a._onServiceLayerProcessed()})};c.prototype._updateVisibilityAtCurrentScale=function(){var a=!1,b=esri.geometry.getScale(this.layerList.appInfo.mapInfo.map);if(0==this.layer.getMaxScale()&&Infinity==this.layer.getMinScale()||isNaN(this.layer.getMaxScale())&&
isNaN(this.layer.getMinScale()))a=!0;this.inVisibleScaleRange.set(a||this.layer.getMaxScale()<b&&b<this.layer.getMinScale())};return c}(k.LayerListItem);f.LayerListLayerItem=h});
define("infrastructure/layerList/LayerListItemCollection",["require","exports","geocortex/framework/observables","infrastructure/layerList/LayerListItem"],function(h,f,k,l){h=function(e){function c(a,b){void 0===b&&(b=[]);var d=e.call(this,b||[])||this;d._parent=a;return d}__extends(c,e);c.prototype.addItem=function(a){if(a)this._prepItemForAddition(a),e.prototype.addItem.call(this,a),this._processItemPostAddition(a);else throw Error("Layer list item not defined. Cannot insert in collection.");};
c.prototype.validateAndAddItem=function(a){if(!a)return!1;if(this._validateCanAdd(a))return this.addItem(a),!0;console.error("LayerListItemCollection: Cannot add item with id: {0} in collection. Validation failed.".format(a.id.get()));return!1};c.prototype.addItems=function(a){if(a)this._prepItemsForAddition(a),e.prototype.addItems.call(this,a),this._processItemsPostAddition(a);else throw Error("Layer list items are not defined. Cannot insert in collection.");};c.prototype.validateAndAddItems=function(a){if(!a||
!a.length)return!1;for(var b=0;b<a.length;b++)if(!this._validateCanAdd(a[b]))return console.error("LayerListItemCollection: Cannot add items in collection. Validation failed."),!1;this.addItems(a);return!0};c.prototype.insertItem=function(a,b){if(b)this._prepItemForAddition(b),e.prototype.insertItem.call(this,a,b),this._processItemPostAddition(b);else throw Error("Layer list item not defined. Cannot insert at index "+a+" in collection.");};c.prototype.insertItems=function(a,b){if(b)this._prepItemsForAddition(b),
e.prototype.insertItems.call(this,a,b),this._processItemsPostAddition(b);else throw Error("Layer list items are not defined. Cannot insert at index "+a+" in collection.");};c.prototype.validateAndInsertItem=function(a,b){if(this._validateCanAdd(b))return this.insertItem(a,b),!0;console.error("LayerListItemCollection: Could not insert item with id: {0} in collection. Validation failed.".format(b.id.get()));return!1};c.prototype.validateAndInsertItems=function(a,b){if(!b||!b.length)return!1;for(var d=
0;d<b.length;d++)if(!this._validateCanAdd(b[d]))return console.error("Could not insert items in collection. Validation failed."),!1;this.insertItems(a,b);return!0};c.prototype.removeItem=function(a){if(a)this._prepItemForRemoval(a),e.prototype.removeItem.call(this,a);else throw Error("LayerListItemCollection: Cannot remove item at index from collection.");};c.prototype.removeAt=function(a){var b=this.getAt(a);if(b)this._prepItemForRemoval(b),e.prototype.removeAt.call(this,a);else throw Error("LayerListItemCollection: Cannot remove item at index "+
a+" from collection.");};c.prototype.removeRange=function(a,b){a=void 0!=a?Math.max(0,a):0;b=void 0!=b?Math.min(b,this.getLength()-1):this.getLength()-1;this._prepItemsForRemoval(this.get().slice(a,b+1));e.prototype.removeRange.call(this,a,b)};c.prototype.clear=function(){this._prepItemsForRemoval(this.get());e.prototype.clear.call(this)};c.prototype._prepItemForAddition=function(a){var b=this;this._parent&&(a.parent=this._parent,a.parentEffectivelyVisible.sync(a.parent.isEffectivelyVisible),a.setAncestorVisibility(this._parent.isVisible.get()),
a._visibilityBindingToken=this._parent.isVisible.bind(a,function(d){a.setAncestorVisibility(d&&b._parent.allAncestorsVisible)}),this.length()&&this.getAt(0).isMutuallyExclusive.get()&&(a.isMutuallyExclusive.set(!0),a.hasRadioToggle.set(!0),a.radioGroup.set(this.getAt(0).radioGroup.get())),a._displayItemBindingToken=a.displayItem.bind(a,function(a){if(a)b._parent.hasDisplayedChildren.set(!0);else{a=!1;for(var c=0;c<b.length();c++)if(b.getAt(c).displayItem.get()){a=!0;break}b._parent.hasDisplayedChildren.set(a)}}),
a.displayItem.pulse())};c.prototype._processItemPostAddition=function(a){a.type!==l.LayerListItemType.MAPSERVICE&&a.type!==l.LayerListItemType.LAYER&&a.type!==l.LayerListItemType.GRAPHICSLAYER||a.populateMapServicesInParentFolders()};c.prototype._prepItemForRemoval=function(a){a.parentEffectivelyVisible.removeSync();a.parent=null;a._visibilityBindingToken&&this._parent&&(this._parent.isVisible.unbind(a._visibilityBindingToken),a._visibilityBindingToken=null);if(a._displayItemBindingToken&&this._parent&&
(a.displayItem.unbind(a._displayItemBindingToken),a._displayItemBindingToken=null,a.displayItem)){for(var b=!1,d=0;d<this.length();d++)if(this.getAt(d)!==a&&this.getAt(d).displayItem.get()){b=!0;break}this._parent.hasDisplayedChildren.set(b)}a.cleanUp()};c.prototype._prepItemsForAddition=function(a){var b=this;dojo.forEach(a,function(a){b._prepItemForAddition(a)})};c.prototype._processItemsPostAddition=function(a){var b=this;dojo.forEach(a,function(a){b._processItemPostAddition(a)})};c.prototype._prepItemsForRemoval=
function(a){var b=this;dojo.forEach(a,function(a){b._prepItemForRemoval(a)})};c.prototype._validateCanAdd=function(a){var b=this,d=(this.layerList||this._parent.layerList).getDescendants();return d.filter(function(b){return b===a}).length?!1:a.type===l.LayerListItemType.FOLDER?a.children.getItems().every(function(a){return b._validateCanAdd(a)}):a.type===l.LayerListItemType.MAPSERVICE?a.mapService?!d.some(function(b){return b.mapService&&(b.mapService===a.mapService||b.mapService.serviceLayer===a.mapService.serviceLayer)}):
!1:a.type===l.LayerListItemType.LAYER?a.layer?!d.some(function(b){return b.layer&&b.layer===a.layer}):!1:!0};return c}(k.ObservableCollection);f.LayerListItemCollection=h});
define("infrastructure/layerList/LayerListNode",["require","exports","geocortex/framework/observables"],function(h,f,k){h=function(){function f(e,c){this.id=new k.Observable("");this.parent=this.children=null;e&&this.id.set(e);c&&(this.parent=c)}f.prototype.getRoot=function(){for(var e=this;null!=e.parent;)e=e.parent;return e};f.prototype.getAncestors=function(){var e=null;if(this.parent)for(var e=[],c=this.parent;null!=c;)e.push(c),c=c.parent;return e};f.prototype.getSelfAndAncestors=function(){var e=
this.getAncestors(),e=e&&e.length?e:[];e.unshift(this);return e};f.prototype.getSiblings=function(e){void 0===e&&(e=!1);var c=null;if(this.parent&&this.parent.children&&(c=this.parent.children.get(),!e))for(c=c.slice(0),e=0;e<c.length;e++)if(c[e]===this){c.splice(e,1);break}return c};f.prototype.getDescendants=function(){if(this.children){for(var e=[],c=this.children.get(),a=0;a<c.length;a++){var b=c[a];e.push(b);for(var b=b.getDescendants(),d=0;d<b.length;d++)e.push(b[d])}return e}};f.prototype.getSelfAndDescendants=
function(){var e=this.getDescendants(),e=e&&e.length?e:[];e.unshift(this);return e};return f}();f.LayerListNode=h});define("infrastructure/layerList/LayerListConfigurationParams",["require","exports"],function(h,f){});
define("infrastructure/layerList/LayerListKmlFolderItem",["require","exports","infrastructure/layerList/LayerListItem"],function(h,f,k){h=function(f){function e(c,a,b,d){c=f.call(this,c,k.LayerListItemType.KMLFOLDER,a)||this;if(!b)throw Error("LayerListKmlFolderItem: Initialization failed. KML layer object cannot be null.");if(!d)throw Error("LayerListKmlFolderItem: Initialization failed. KML folder object cannot be null.");c._kmlLayer=b;c._kmlFolder=d;c.name.set(d.name);c._setTooltips();c.isVisible.set(!!d.visibility);
return c}__extends(e,f);e.prototype.setItemVisibility=function(c){f.prototype.setItemVisibility.call(this,c);this._kmlLayer.setFolderVisibility(this._kmlFolder,c)};return e}(k.LayerListItem);f.LayerListKmlFolderItem=h});
define("infrastructure/layerList/LayerListMapServiceItem",["require","exports","infrastructure/layerList/LayerListItem","geocortex/essentials/MapServiceConstants","infrastructure/layerList/LayerListKmlFolderItem"],function(h,f,k,l,e){h=function(c){function a(a,d,e){var f=c.call(this,a,k.LayerListItemType.MAPSERVICE,e)||this;f._themeSyncHandle=null;f._layerVisibilityHandle=null;f._forceSetAncestorVisibilityOperationActive=!1;if(!d)throw Error("LayerListMapServiceItem Initialization failed. MapService cannot be null");
a=f.layerList&&f.layerList.mapInfo&&f.layerList.mapInfo.gcxMap&&f.layerList.mapInfo.gcxMap.layerThemesInfo&&f.layerList.mapInfo.gcxMap.layerThemesInfo.layerThemesConfigured?d.gcxMapService&&d.gcxMapService.serviceLayer?d.gcxMapService.serviceLayer.visible:!0:d.gcxMapService?d.gcxMapService.configuredVisible:!0;f.name.set(d.displayName?d.displayName:"");f._setTooltips();f.mapService=d;e._handledMapServiceReferences.push(d);-1===e._allMapServiceReferences.indexOf(d)&&e._allMapServiceReferences.push(d);
f._deferredVisibilitySetting=a;f.isVisible.set(a);f.isUserCreated=d.isUserCreated;f.enableMapServiceActions=d.isUserCreated;f._setupOpacityBindings();f._subscribeEvents();f._setupBindings();if(d.serviceLayer instanceof esri.layers.KMLLayer)if(d=d.serviceLayer,d.loaded)f._kmlLayerLoadHandler(d);else d.on("load",function(a){return f._kmlLayerLoadHandler(a.layer)});return f}__extends(a,c);a.prototype.setVisibility=function(a,d){c.prototype.setVisibility.call(this,a);this._forceSetAncestorVisibilityOperationActive=
this._forceSetAncestorVisibilityOperationActive||d;this._syncChildVisibilitiesIfApplicable(a);if(void 0!==this.allAncestorsVisible&&void 0==this._deferredVisibilitySetting){if((this._forceSetAncestorVisibilityOperationActive||this.layerList.autoActivateAncestorVisibilities&&this.currentUserClickOriginator)&&!0===a&&!this.allAncestorsVisible){this.isVisible.get()!==a&&this.isVisible.set(a);for(var e=this.parent;e&&e.id!==this.layerList.id&&e.isVisible.get();)e=e.parent;if(e&&e.id!==this.layerList.id){e.isVisible.set(!0);
return}}this._forceSetAncestorVisibilityOperationActive=this.currentUserClickOriginator=!1;this.mapService.setVisibility(a&&this.allAncestorsVisible&&(this.inActiveTheme.get()||this.mapService.isUserCreated))}};a.prototype.bindToActiveTheme=function(){var a=this;c.prototype.bindToActiveTheme.call(this);this._themeSyncHandle=dojo.subscribe("MapServiceInActiveThemeChangedEvent",function(d){d&&d===a.mapService.gcxMapService&&a.inActiveTheme.set(d.inActiveTheme)})};a.prototype.unbindFromActiveTheme=function(){c.prototype.unbindFromActiveTheme.call(this);
this._themeSyncHandle&&dojo.unsubscribe(this._themeSyncHandle);this._themeSyncHandle=null};a.prototype.cleanUp=function(){c.prototype.cleanUp.call(this);this._layerVisibilityHandle&&(this._layerVisibilityHandle.remove(),this._layerVisibilityHandle=null)};a.prototype._subscribeEvents=function(){var a=this;this._layerVisibilityHandle=this.mapService.serviceLayer.on("visibility-change",function(d){if(void 0!=a._deferredVisibilitySetting||a.isEffectivelyVisible.get()!==d.visible||a.isEffectivelyVisible.get()&&
!a.inActiveTheme.get()&&!a.mapService.isUserCreated)d=d.visible&&(a.inActiveTheme.get()||a.mapService.isUserCreated),a.isVisible.set(d)})};a.prototype._setupIconUri=function(){this.mapService.serviceLayer.loadError&&this.layerList.serviceLoadFailureIconUri?(this.iconUri.set(this.layerList.serviceLoadFailureIconUri),this.iconTooltip.set(this.layerList.serviceLoadFailureIconTooltip?this.layerList.serviceLoadFailureIconTooltip:"")):this.mapService.gcxMapService&&this.mapService.gcxMapService.iconUri&&
(this.iconUri.set(this.mapService.gcxMapService.iconUri),this.iconTooltip.set(this.name.get()))};a.prototype._syncChildVisibilitiesIfApplicable=function(a){var d=this;switch(this.mapService.serviceType){case l.MapServiceType.BING:case l.MapServiceType.TILED:case l.MapServiceType.WMTS:case l.MapServiceType.IMAGE:case l.MapServiceType.WEBTILED:0<this.children.length()&&this.getDescendants().forEach(function(c){c.type===k.LayerListItemType.LAYER&&c.mapService.id===d.mapService.id&&c.isVisible.get()!==
a&&c.isVisible.set(a)})}};a.prototype._setupBindings=function(){var a=this;this.mapService.gcxMapService&&this.bindToActiveTheme();if(this.mapService.serviceLayer.loaded||this.mapService.serviceLayer.loadError)this._setupIconUri();else var d=null,c=null,e=function(){d&&dojo.disconnect(d);c&&dojo.disconnect(c);d=c=null},d=dojo.connect(this.mapService.serviceLayer,"onLoad",function(){e();a._setupIconUri()}),c=dojo.connect(this.mapService.serviceLayer,"onError",function(){e();a._setupIconUri()});if(!this.mapService.serviceLayer.loaded&&
!this.mapService.serviceLayer.loadError)var f=this.mapService.serviceLayer.on("load",function(){a._updateVisibilityAtCurrentScale();f.remove()});if(!this.mapService.serviceLayer.getMap())var h=this.layerList.appInfo.map.on("layer-add",function(d){d.layer===a.mapService.serviceLayer&&(a._updateVisibilityAtCurrentScale(),h.remove())});this._updateVisibilityAtCurrentScale();this.mapService.serviceLayer.on("scale-visibility-change",function(){return a._updateVisibilityAtCurrentScale()})};a.prototype._kmlLayerLoadHandler=
function(a){a.folders&&1<a.folders.length&&(this._createKmlFolders(this,a.folders[1],a),this.refreshOnDemandItemCollection())};a.prototype._createKmlFolders=function(a,d,c){for(var f=c.folders,h=0;h<d.subFolderIds.length;h++){for(var l=d.subFolderIds[h],k=null,s=0;s<f.length;s++)if(f[s].id===l){k=f[s];break}if(!k)throw Error("Could not find KML folder with ID '{0}'.".format(l));l=new e.LayerListKmlFolderItem(this.mapService.id+l,this.layerList,c,k);this._createKmlFolders(l,k,c);a.children.addItem(l)}};
a.prototype._updateVisibilityAtCurrentScale=function(){this.mapService.serviceLayer.loaded&&this.mapService.serviceLayer.getMap()&&this.inVisibleScaleRange.set(this.mapService.serviceLayer.visibleAtMapScale)};a.prototype._setTooltips=function(){c.prototype._setTooltips.call(this);var a=this.layerList.appInfo.gcxApp;a&&(a=a.getResource(this.layerList._libraryId,"language-mapservice-actions-tooltip").format(this.name.get()),this.mapServiceActionsTooltip.set(a))};return a}(k.LayerListItem);f.LayerListMapServiceItem=
h});
define("infrastructure/layerList/LayerListGraphicsLayerItem",["require","exports","infrastructure/layerList/LayerListLayerItem","infrastructure/layerList/LayerListItem"],function(h,f,k,l){h=function(e){function c(a,b,d){a=e.call(this,a,b,d,l.LayerListItemType.GRAPHICSLAYER)||this;if(!b)throw Error("LayerListGraphicsLayerItem Initialization failed. Layer cannot be null.");b=b.gcxLayer?b.gcxLayer.isVisible()||b.gcxLayer.configuredVisible:b.serviceLayerInfo.serviceLayer.defaultVisibility||b.isVisible();a.canNotAssignVisibility.set(!1);
a._deferredVisibilitySetting=b;a.isVisible.set(b);return a}__extends(c,e);return c}(k.LayerListLayerItem);f.LayerListGraphicsLayerItem=h});define("infrastructure/layerList/LayerVisibilityType",["require","exports"],function(h,f){var k=function(){return function(){}}();k.Default="default";k.MutuallyExclusive="mutuallyExclusive";f.LayerVisibilityType=k});
define("infrastructure/ui/components/FilterControl/FilterControlViewModelBase",["require","exports","geocortex/framework/ui/ViewModelBase","geocortex/framework/observables"],function(h,f,k,l){h=function(e){function c(a,b,d){a=e.call(this,a,b)||this;a.filterText=new l.Observable("");a.showBusyIcon=new l.Observable(!1);a.filterInputPlaceholder=new l.Observable("");a.filterButtonText=new l.Observable("");a._filterTextSettleDelayMs=600;a._filterTextTimeoutToken=null;a.filterText.bind(a,a._processFilterTextChanged);
d&&(a._filterControlComponent=d);return a}__extends(c,e);c.prototype.setFilterControlComponent=function(a){if(!a)return!1;this._filterControlComponent=a;this.app.event("FilterControlQueryChangedEvent").subscribe(this,this._handleFilterQueryChangedEvent);return!0};c.prototype.getFilterControlComponent=function(){return this._filterControlComponent};c.prototype.handleFilterTextInput=function(a){if(!this._filterControlComponent)return!1;this._filterControlComponent.applyQuery(a);return!0};c.prototype._processFilterTextChanged=
function(a){var b=this;this.showBusyIcon.set(!0);this._filterTextTimeoutToken&&clearTimeout(this._filterTextTimeoutToken);this._filterTextTimeoutToken=setTimeout(function(){b.handleFilterTextInput(a);b.showBusyIcon.set(!1)},this._filterTextSettleDelayMs)};c.prototype._handleFilterQueryChangedEvent=function(a){var b=this._filterControlComponent;b&&a.filterControlId===b.filterControlId&&this.filterText.get()!==a.query&&this.filterText.set(a.query)};return c}(k.ViewModelBase);f.FilterControlViewModelBase=
h});
define("infrastructure/ui/components/FilterControl/FilterControlComponent",["require","exports"],function(h,f){var k=function(){function f(e,c){this._filterableItems=[];this._currentQuery="";c?(this.app=e,this.filterControlId=c,this.app.command("ApplyFilterControlQuery").register(this,this._applyFilterControlQueryImpl)):this.app.trace.error("FilterControlViewModel: Failed to initialize. Filter Control Id must be specified.")}f.prototype.registerFilterableItem=function(e,c){if(e){var a={};a.filterData=c&&
c.length?c:null;a.filterQuery=null;a.item=e;a.queryMatched=!0;this._filterableItems.push(a)}else this.app.trace.error("FilterControlViewModel: No item to register. Could not add to {0} filter.".format(this.filterControlId))};f.prototype.removeRegisteredItem=function(e){var c=this._filterableItems.filter(function(a){return a.item===e})[0],a=this._filterableItems.indexOf(c);if(!c||0>a)return!1;this._filterableItems.splice(a,1);return!0};f.prototype.clear=function(){this._filterableItems.length=0};f.prototype.getFilterableItem=
function(e){var c=this._filterableItems.filter(function(a){return a.item===e})[0];return c?c:null};f.prototype.setFilterData=function(e,c){var a=this.getFilterableItem(e);a?a.filterData=c:this.app.trace.error("FilterControlViewModel: Could not update filter data for {0} filter.".format(this.filterControlId))};f.prototype.queryMatched=function(e){var c=this._filterableItems.filter(function(a){return a.item===e})[0];return!(!c||!c.queryMatched)};f.prototype.filter=function(e,c){if(e){var a=!0;c&&e.filterData&&
e.filterData.length&&(a=e.filterData.some(function(a){return!!a&&-1!==a.toLowerCase().indexOf(c.toLowerCase())}));return a}this.app.trace.error("FilterControlViewModel: Filterable Item Info not provided.")};f.prototype.applyQuery=function(e){var c=this,a=!1;if(this._currentQuery!==e){this._currentQuery=e;var b={filterControlId:this.filterControlId,query:this._currentQuery};this.app.event("FilterControlQueryChangedEvent").publish(b)}this._filterableItems.forEach(function(b){var g=c.filter(b,e);a=!1===
a?b.queryMatched!==g:a;b.filterQuery=e;b.queryMatched=g});a&&(b={filterControlId:this.filterControlId,filterableItems:this._filterableItems},this.app.event("FilterControlResultChangedEvent").publish(b))};f.prototype._applyFilterControlQueryImpl=function(e){e.filterControlId===this.filterControlId&&e.query!==this._currentQuery&&this.applyQuery(e.query)};return f}();f.FilterControlComponent=k});
define("infrastructure/layerList/LayerList","require exports infrastructure/layerList/LayerListNode infrastructure/layerList/LayerListFolderItem infrastructure/gis/ServiceLayerInfo geocortex/framework/utils/utils infrastructure/layerList/LayerListItemCollection geocortex/geocortex geocortex/essentials/MapService infrastructure/layerList/LayerListItem infrastructure/layerList/LayerListLayerItem infrastructure/gis/LayerInfo infrastructure/layerList/LayerListMapServiceItem infrastructure/layerList/LayerListGraphicsLayerItem geocortex/essentials/LayerThemeSetting geocortex/essentials/RestHelper infrastructure/layerList/LayerVisibilityType geocortex/essentials/MapServiceConstants infrastructure/ui/components/FilterControl/FilterControlComponent".split(" "),function(h,
f,k,l,e,c,a,b,d,g,m,q,n,p,s,r,t,u,v){h=function(f){function h(a,b,d,e){var g=f.call(this,"GCXLayerListRootNode-".concat(c.alphaNumericToken()))||this;g.layerListInitialized=!1;g.layerListInitializationFailure=null;g.onLayerListInitializationFailed=function(a){};g.onLayerListInitialized=function(a){};g.enableLegendIntegration=!1;g.onlyShowSwatchesOnVisibleLayers=!1;g.autoActivateAncestorVisibilities=!1;g._addedFolderReferences=[];g._handledMapServiceReferences=[];g._allMapServiceReferences=[];g._outOfFolderMapServiceReferences=
[];g._initializing=!1;g._groupByOperationalAndBase=!0;g._layerListRestEndpoint=null;g._suspendMapUpdates=!1;g._itemsExpandedByFilter=[];g._filterControlId="LayerListFilterControl";if(!a||!a.mapInfo)throw Error("LayerList: Initialization failed. AppInfo/MapInfo cannot be null");g.appInfo=a;g.mapInfo=a.mapInfo;g.url=b||"";g._libraryId="Mapping.Infrastructure";g._layerListRestEndpoint=d||null;g.enableLegendIntegration=e&&void 0!=e.enableLegendIntegration?e.enableLegendIntegration:!1;g.onlyShowSwatchesOnVisibleLayers=
e&&void 0!=e.onlyShowSwatchesOnVisibleLayers?e.onlyShowSwatchesOnVisibleLayers:!1;g.autoActivateAncestorVisibilities=e&&void 0!=e.autoActivateAncestorVisibilities?e.autoActivateAncestorVisibilities:!1;g._groupByOperationalAndBase=e&&void 0!=e.groupByOperationalAndBase?e.groupByOperationalAndBase:!0;g.enableLayerIcons=e&&void 0!=e.enableLayerIcons?e.enableLayerIcons:!1;g.serviceLoadFailureIconUri=e?e.serviceLoadFailureIconUri||"":"";g.serviceLoadFailureIconTooltip=e?e.serviceLoadFailureIconTooltip||
"":"";g.multiLegendSwatchElement=e?e.multiLegendSwatchElement||"":"";g.singleLegendIconTooltip=e?e.singleLegendIconTooltip||"":"";g.multiLegendIconTooltip=e?e.multiLegendIconTooltip||"":"";g.filterControlComponent=new v.FilterControlComponent(g.appInfo.gcxApp,g._filterControlId);g.appInfo.gcxApp.event("FilterControlResultChangedEvent").subscribe(g,g._handleFilterChanged);dojo.connect(g.mapInfo.gcxMap.layerThemesInfo,"layerThemeChangingEvent",dojo.hitch(g,function(){return g.suspendMapUpdates=!0}));
dojo.connect(g.mapInfo.gcxMap.layerThemesInfo,"layerThemeChangedEvent",dojo.hitch(g,function(){return g.suspendMapUpdates=!1}));return g}__extends(h,f);Object.defineProperty(h.prototype,"suspendMapUpdates",{get:function(){return this._suspendMapUpdates},set:function(a){a!==this._suspendMapUpdates&&((this._suspendMapUpdates=a)?this._enableDeferredItemVisibilities(this.children.get()):this._applyDeferredItemVisibilities(this.children.get()))},enumerable:!0,configurable:!0});h.prototype.initialize=function(){this.layerListInitialized||
this._initializing||(this._initializing=!0,this.children=new a.LayerListItemCollection(null),this.children.layerList=this,this._layerListRestEndpoint?this._layerListInitializationHandler(this._layerListRestEndpoint):this.url&&this.appInfo.essentialsVersion&&4.02<=this.appInfo.essentialsVersion?b.request({url:this.url,content:{f:"json"},load:dojo.hitch(this,this._layerListInitializationHandler),error:dojo.hitch(this,this._layerListInitializationErrorHandler),callbackParamName:"CallBack"}):this._layerListInitializationHandler(null))};
h.prototype.addUserAddedServiceLayer=function(a,b){var c=a;if(!this.layerListInitialized)return!1;if(!(c instanceof e.ServiceLayerInfo))if(c instanceof d.MapService)c=e.ServiceLayerInfo.fromGcxMapService(c);else if(c instanceof esri.layers.Layer)c=e.ServiceLayerInfo.fromEsriLayer(c);else return this.appInfo.gcxApp.trace.error("addUserAddedServiceLayer: Could not add layer. Invalid layer type."),!1;c.isUserCreated=!0;return(c=this._generateLayerListItemsFromServiceLayer(c,this,!0))&&c.length?null!==
b&&void 0!==b?this._addItemsToUserAddedFolder(c,b):this._addItemsToUserAddedFolder(c):!1};h.prototype.removeServiceLayer=function(a){if(!this.layerListInitialized)return!1;if(!(a instanceof esri.layers.Layer))if(a instanceof d.MapService||a instanceof e.ServiceLayerInfo)a=a.serviceLayer;else return this.appInfo.gcxApp.trace.error("removeServiceLayer: Could not remove layer. Invalid layer type."),!1;var b=this.getDescendants();if(b.length){for(var c=0;c<b.length;c++){var f=b[c];if(f.mapService&&f.mapService.serviceLayer===
a&&this._isItemSafeToBeRemoved(f,a)){var m=f.parent;m?(m.children.removeItem(f),m instanceof g.LayerListItem&&m.refreshOnDemandItemCollection()):this.children.removeItem(f)}}return!0}return!1};h.prototype._isItemSafeToBeRemoved=function(a,b){if(a.type===g.LayerListItemType.MAPSERVICE||a.type===g.LayerListItemType.LAYER||a.type===g.LayerListItemType.GRAPHICSLAYER)return!0;if(a.children&&0!=a.children.length()){var d=a.getDescendants();if(d&&0<d.length)for(var c=0;c<d.length;c++)if((d[c].type===g.LayerListItemType.LAYER||
d[c].type===g.LayerListItemType.GRAPHICSLAYER||d[c].type===g.LayerListItemType.MAPSERVICE)&&d[c].mapService&&d[c].mapService.serviceLayer!=b)return!1}return!0};h.prototype.updateServiceLayer=function(a,b,c){if(!this.layerListInitialized||!a)return!1;b=b||[];c=c||[];var f;if(a instanceof d.MapService)f=e.ServiceLayerInfo.fromGcxMapService(a);else if(a instanceof e.ServiceLayerInfo)f=a;else return this.appInfo.gcxApp.trace.error("updateServiceLayer: Could not update layer. Invalid layer type."),!1;
a=this.getDescendants();if(!a.filter(function(a){return a.mapService&&a.mapService&&a.mapService.gcxMapService===f.gcxMapService}).length)return this.addUserAddedServiceLayer(f);if(c&&c.length){a=this.getDescendants();for(var h=0;h<a.length;h++){var l=a[h];if(l.type===g.LayerListItemType.LAYER){var k=l.layer&&l.layer.gcxLayer?l.layer.gcxLayer:null;k&&k.isUserCreated&&0<=c.indexOf(k)&&((k=l.parent)?(k.children.removeItem(l),k instanceof g.LayerListItem&&k.refreshOnDemandItemCollection()):(this.children.removeItem(l),
this.children.pulse()))}}}if(b&&b.length){a=this.getDescendants();c=[];for(h=0;h<b.length;h++){var l=b[h],n=f.findLayerById(l.id);n||(n=q.LayerInfo.fromGcxLayer(l),n.serviceLayerInfo=f,f.layers.push(n));a.filter(function(a){return a.layer&&a.layer.gcxLayer===n.gcxLayer}).length||(l=new m.LayerListLayerItem(n.id,n,this,g.LayerListItemType.LAYER),c.push(l))}if(c.length)return this._addItemsToUserAddedFolder(c)}return!1};h.prototype.updateServiceLayerLegendSwatch=function(a){if(!this.layerListInitialized)return!1;
var b=a.serviceLayer;if(!b)return this.appInfo.gcxApp.trace.error("updateServiceLayerLegendSwatch: Could not update layer swatch. Invalid layer type."),!1;a=this.getDescendants().filter(function(a){return a.mapService&&a.mapService.serviceLayer.id===b.id});if(0<a.length){for(var d=0;d<a.length;d++){var c=a[d];c&&c instanceof m.LayerListLayerItem&&c.updateLegendItems()}return!0}return!1};h.prototype.getUserAddedLayersFolderIndex=function(a){if(!this.layerListInitialized)return null;if(!(a instanceof
esri.layers.Layer))if(a instanceof d.MapService||a instanceof e.ServiceLayerInfo)a=a.serviceLayer;else return this.appInfo.gcxApp.trace.error("removeServiceLayer: Could not remove layer. Invalid layer type."),null;var b=this._userAddedLayersFolder||this;if(b.children&&b.children.length)for(var b=b.children.get(),c=0;c<b.length;c++){var g=b[c];if(g.mapService&&g.mapService.serviceLayer===a)return c}return null};h.prototype._applyDeferredItemVisibilities=function(a){var b=this;dojo.forEach(a,function(a){a._applyDeferredInitialVisibility();
a.children&&a.children.length()&&b._applyDeferredItemVisibilities(a.children.get())})};h.prototype._enableDeferredItemVisibilities=function(a){var b=this;a.forEach(function(a){c.isNullOrUndefined(a._deferredVisibilitySetting)&&(a._deferredVisibilitySetting=a.isVisible.get());b._enableDeferredItemVisibilities(a.children.get())})};h.prototype._layerListInitializationErrorHandler=function(a){this.layerListInitializationFailure=a;if(this.onLayerListInitializationFailed)this.onLayerListInitializationFailed(a);
this._initializing=!1};h.prototype._layerListInitializationHandler=function(a){var b=this,d=function(){b.layerListInitialized=!0;b._initializing=!1;b._processEligibleSingleMapServiceFolders();b._processUnhandledMapServices();b._setupOpacityBindingsForParentsOfHiddenItemsWithOpacityBindings();b._applyInitialLayerTheme();b._applyDeferredItemVisibilities(b.children.get());if(b.onLayerListInitialized)b.onLayerListInitialized(b)};a?this._configureLayerListFromRestResponse(a,d,this._layerListInitializationErrorHandler):
this._configureLayerListFromMapInfo(this.mapInfo,d,this._layerListInitializationErrorHandler)};h.prototype._configureLayerListFromMapInfo=function(a,b,d){if(a){if(a.gcxMap&&a.serviceLayers.length&&void 0!=a.serviceLayers[0].serviceLayerFunction&&this._groupByOperationalAndBase)var c=new l.LayerListFolderItem(this.id.get()+":Operational",this.appInfo.gcxApp.getResource(this._libraryId,"language-layerlist-operational-maps-folder-title"),this),e=new l.LayerListFolderItem(this.id.get()+":Base",this.appInfo.gcxApp.getResource(this._libraryId,
"language-layerlist-base-maps-folder-title"),this);try{for(var g=0;g<a.serviceLayers.length;g++){var f=a.serviceLayers[g],m=this._generateLayerListItemsFromServiceLayer(f,this);if(m&&m.length)if(this._groupByOperationalAndBase)switch(f.serviceLayerFunction){case "Operational":c.children.addItems(m);break;case "Base":e.children.addItems(m);break;default:throw Error("ServiceLayerFunction undefined or not recognized: {0}".format(f.serviceLayerFunction));}else this.children.addItems(m)}this._groupByOperationalAndBase&&
(c.children.length()&&(this._generateThemeSettingsForCoreFolder(c),this.children.addItem(c),c.isExpanded.set(!0),c.isVisible.set(!0),c.configuredVisible=!0),e.children.length()&&(this._generateThemeSettingsForCoreFolder(e),this.children.addItem(e),e.isExpanded.set(!0),e.isVisible.set(!0),e.configuredVisible=!0))}catch(h){console.error("Layer List Configuration Error: {0}".format(h&&h.message||"Unknown Error"));d(h);return}b()}else this._layerListInitializationErrorHandler(Error("Error initializing layer list from MapInfo."))};
h.prototype._configureLayerListFromRestResponse=function(a,b,d){try{if(!a||!a.items)throw Error("Layer list failed to load (general data failure).");this._userAddedLayersDestinationId=a.userAddedLayersDestinationId;for(var c=0,e=a.items;c<e.length;c++){var g=this._createLayerListItemFromRestResult(e[c],this);g&&this.children.addItem(g)}}catch(f){f.name="LayerListConfigurationError/"+f.name;this._layerListInitializationErrorHandler(f);d(f);return}b()};h.prototype._generateLayerListItemsFromServiceLayer=
function(a,b,d){var c=this;void 0===d&&(d=!1);var e=[],g=null,f=function(b,d){var e=b.subLayerIds||[];if(0<e.length)for(var g=0;g<e.length;g++){var l=a.findLayerById(e[g]);if(l&&(l.processed=!0,l.includeInLayerList)){var k=new m.LayerListLayerItem(l.id,l,c);h(k);d.children.addItem(k);f(l,k)}}d.isExpanded.set(b.isExpanded&&!(!b.subLayerIds||!b.subLayerIds.length))},h=function(a){a&&d&&(a.unbindFromActiveTheme(),a.inActiveTheme.set(!0))};a.includeInLayerList&&(g=new n.LayerListMapServiceItem(a.id,a,
this),h(g));a.serviceLayer instanceof esri.layers.GraphicsLayer&&1===a.layers.length?(g=this._handleGraphicsLayerItem(a,g),h(g&&g.children.length()?g.children.getAt(0):g)):a.layers.length&&(dojo.forEach(a.layers,function(a){if((a.includeInLayerList||a.isUserCreated)&&!a.processed){var b=new m.LayerListLayerItem(a.id,a,c);h(b);g?g.children.addItem(b):e.push(b);f(a,b)}}),g&&g.isExpanded.set(a.isExpanded&&!!a.layers.length));g&&(e.push(g),b&&(g.parent=b));return e};h.prototype._handleGraphicsLayerItem=
function(a,b){var d=b;if(a.layers[0].includeInLayerList||a.layers[0].isUserCreated){var c=a.layers[0],e=new p.LayerListGraphicsLayerItem(c.id,a.layers[0],this);e.isExpanded.set(c.isExpanded&&!(!c.subLayerIds||!c.subLayerIds.length));d?(d.isVisible.set(e.isVisible.get()),e.isVisible.set(!0),e.canNotAssignVisibility.set(!0),d.children.addItem(e),d.isExpanded.set(a.isExpanded&&!!a.layers.length)):d=e}return d};h.prototype._createLayerListItemFromRestResult=function(a,b){var d=this,c=null,e=function(b){console.error("Layer List Error: {0} with ID: {1} not available. Excluding from layer list. Please check your security settings.".format(b===
g.LayerListItemType.MAPSERVICE?"MapService":b===g.LayerListItemType.LAYER?"Map Layer":"Object",a.mapServiceID))};switch(a.type){case "folder":c=new l.LayerListFolderItem(a.id,a.name,this);a.items&&a.items.length&&this._subItemIncludedInLayerList(a.items)||(c.displayItem.set(!1),c.isExpanded.set(!1));this._userAddedLayersDestinationId&&a.id===this._userAddedLayersDestinationId&&(this._userAddedLayersFolder=c);break;case "mapService":var f=this.mapInfo.findMapServiceById(a.mapServiceID);f||e(g.LayerListItemType.MAPSERVICE);
f&&f.includeInLayerList&&(c=new n.LayerListMapServiceItem(a.id,f,this));break;case "layer":(f=this.mapInfo.findMapServiceById(a.mapServiceID))||e(g.LayerListItemType.MAPSERVICE);if(f){var h=f.findLayerById(a.layerID);h||e(g.LayerListItemType.LAYER);h&&h.includeInLayerList&&(c=f.serviceLayer instanceof esri.layers.GraphicsLayer?new p.LayerListGraphicsLayerItem(a.id,h,this):new m.LayerListLayerItem(a.id,h,this))}break;default:throw Error("Unknown layer list item type. Reported type: {0}".format(a.type));
}c&&(b&&(c.parent=b),null!=a.items&&a.items.length&&dojo.forEach(a.items,function(a){(a=d._createLayerListItemFromRestResult(a,c))&&c.children.addItem(a)}),this._processItem(c,a));return c};h.prototype._subItemIncludedInLayerList=function(a){for(var b=0;b<a.length;b++){var d;d=a[b];if("folder"===d.type)d=d.items&&d.items.length?this._subItemIncludedInLayerList(d.items):!1;else if("mapService"===d.type){var c=this.mapInfo.findMapServiceById(d.mapServiceID);d=c?!!c.includeInLayerList:!1}else"layer"===
d.type?(c=this.mapInfo.findMapServiceById(d.mapServiceID),d=(d=c.findLayerById(d.layerID))?!!d.includeInLayerList:!1):d=void 0;if(d)return!0}return!1};h.prototype._processItem=function(a,b){if(a.type===g.LayerListItemType.FOLDER){if(this.mapInfo.gcxMap&&b.themeSettings&&b.themeSettings.length)for(var d=0;d<b.themeSettings.length;d++){var e=b.themeSettings[d],f=this.mapInfo.gcxMap.layerThemesInfo.getTheme(e.themeID);f&&a.layerThemeSettings.push(new s.LayerThemeSetting(f,void 0!=e.visible?e.visible:
b.isVisible))}if(a.id.get()===this._userAddedLayersDestinationId)for(d=0;d<this.mapInfo.gcxMap.layerThemesInfo.themes.length;d++)a.layerThemeSettings.push(new s.LayerThemeSetting(this.mapInfo.gcxMap.layerThemesInfo.themes[d],!0));a._deferredVisibilitySetting=b.isVisible;a.isVisible.set(b.isVisible);a.configuredVisible=b.isVisible;a.isExpanded.set(b.isExpanded&&!(!b.items||!b.items.length));this._disableFolderIfParentTiled(a)}a.type===g.LayerListItemType.MAPSERVICE&&a.isExpanded.set(a.mapService.isExpanded);
a.type===g.LayerListItemType.LAYER&&a.isExpanded.set(a.layer.isExpanded&&!(!a.layer.subLayerIds||!a.layer.subLayerIds.length));a.type===g.LayerListItemType.FOLDER&&(d=b.iconUri)&&(this.mapInfo.gcxMap&&this.mapInfo.gcxMap.site&&(d=r.RestHelper.processClientSideTokens(this.mapInfo.gcxMap.site,d)),a.iconUri.set(d),a.iconTooltip.set(a.name.get()));a.canDisplayItem.set(!1!==b.isVisibleInLayerList);if(b.layerVisibilityType===t.LayerVisibilityType.MutuallyExclusive&&b.items&&1<b.items.length)for(d=c.alphaNumericToken(32),
e=0;e<a.children.length();e++)a.children.getAt(e).isMutuallyExclusive.set(!0),a.children.getAt(e).hasRadioToggle.set(!0),a.children.getAt(e).radioGroup.set(d)};h.prototype._disableFolderIfParentTiled=function(a){for(var b=a.parent;b&&b.id!==this.id&&(b.type===g.LayerListItemType.MAPSERVICE||b.type===g.LayerListItemType.FOLDER);){if(b.type===g.LayerListItemType.FOLDER&&b.canNotAssignVisibility.get()||b.type===g.LayerListItemType.MAPSERVICE&&b.mapService.serviceType===u.MapServiceType.TILED){a.canNotAssignVisibility.set(!0);
break}b=b.parent}};h.prototype._generateThemeSettingsForCoreFolder=function(a,b){void 0===b&&(b=!1);if(b){if(this.mapInfo.gcxMap&&this.mapInfo.gcxMap.layerThemesInfo.layerThemesConfigured)for(var d=this.mapInfo.gcxMap.layerThemesInfo.themes,c=0;c<d.length;c++)a.layerThemeSettings.push(new s.LayerThemeSetting(d[c],!0));a.inActiveTheme.set(!0)}else for(var d={},c=0,e=a.children.length();c<e;c++){var f=a.children.getAt(c),m=null;switch(f.type){case g.LayerListItemType.FOLDER:m=f.layerThemeSettings;break;
case g.LayerListItemType.MAPSERVICE:m=f.mapService.gcxMapService?f.mapService.gcxMapService.layerThemeSettings:null;break;case g.LayerListItemType.LAYER:case g.LayerListItemType.GRAPHICSLAYER:m=f.layer.gcxLayer?f.layer.gcxLayer.layerThemeSettings:null}if(m&&m.length)for(f=0;f<m.length;f++){var h=m[f].theme.id;void 0==d[h]&&(a.layerThemeSettings.push(new s.LayerThemeSetting(m[f].theme,!0)),d[h]=!0)}}};h.prototype._applyInitialLayerTheme=function(){this.mapInfo.gcxMap&&this.mapInfo.gcxMap.layerThemesInfo.layerThemesConfigured&&
this.mapInfo.gcxMap.applyStartupTheme()};h.prototype._processEligibleSingleMapServiceFolders=function(){for(var a=this._handledMapServiceReferences.slice(0),b=this._getFoldersContainingSingleMapService(),b=this._filterEligibleSingleMsFolders(b),b=this._selectDeepestLevelSingleMapServiceFolders(b),d=0;d<b.length;d++){var c=b[d];c.containedMapServices[0].serviceLayer instanceof esri.layers.GraphicsLayer||-1!==a.indexOf(c.containedMapServices[0])||-1!==this._outOfFolderMapServiceReferences.indexOf(c.containedMapServices[0])||
(c.linkWithMapService(c.containedMapServices[0]),a.push(c.containedMapServices[0]))}};h.prototype._setupOpacityBindingsForParentsOfHiddenItemsWithOpacityBindings=function(){for(var a=this.getDescendants(),a=dojo.filter(a,function(a){return a.canAdjustOpacity.get()}),b=0;b<a.length;b++){var d=a[b];if(!this.isEffectivelyDisplayed(d)){for(d=d.parent;d instanceof g.LayerListItem&&!this.isEffectivelyDisplayed(d);)d=d.parent;d instanceof g.LayerListItem&&d._setupOpacityBindings()}}};h.prototype.isEffectivelyDisplayed=
function(a){return a.displayItem.get()?a.parent instanceof g.LayerListItem?this.isEffectivelyDisplayed(a.parent):!0:!1};h.prototype._getFoldersContainingSingleMapService=function(){for(var a=[],b=0;b<this._addedFolderReferences.length;b++)1===this._addedFolderReferences[b].containedMapServices.length&&a.push(this._addedFolderReferences[b]);return a};h.prototype._filterEligibleSingleMsFolders=function(a){var b=this;if(a){for(var d=[],c=this._filterTopLevelFolders(a),e=0;e<a.length;e++){var g=a[e],
f=dojo.filter(this._addedFolderReferences,function(a){return a.id!==g.id&&0<a.containedMapServices.length&&-1!==a.containedMapServices.indexOf(g.containedMapServices[0])})||[],m=f.filter(function(a){return 1<a.containedMapServices.length})||[];this._noChildItemsWithMapService(g.containedMapServices[0],m)&&this._allFoldersAncestorsOrDescendantsOf(g,f)&&(c.some(function(a){return a.containedMapServices[0]===g.containedMapServices[0]&&!b._allFoldersAncestorsOf(g,[a])&&g.id!==a.id})||d.push(g))}return d}};
h.prototype._filterTopLevelFolders=function(a){return this.children.get().filter(function(b){return b.type===g.LayerListItemType.FOLDER&&-1!==a.indexOf(b)})};h.prototype._selectDeepestLevelSingleMapServiceFolders=function(a){if(a){for(var b=[],d=[],c=0;c<a.length;c++){var e=a[c];if(-1===d.indexOf(e.containedMapServices[0])){var g=dojo.filter(a,function(a){return a.id!==e.id&&-1!==a.containedMapServices.indexOf(e.containedMapServices[0])})||[];if(g.length){var f=e,m;for(m=0;m<g.length;m++)if(this._onlyFolderItems(f.children.get())&&
this._allFoldersDescendantsOf(f,g.slice(m))){if(1<f.children.length())break;f=g[m]}else{f=1<=m?g[m-1]:f;break}this._allFoldersDescendantsOf(f,g.slice(m))&&(b.push(f),d.push(f.containedMapServices[0]))}else b.push(e),d.push(e.containedMapServices[0])}}return b}};h.prototype._allFoldersDescendantsOf=function(a,b){for(var d=0;d<b.length;d++){var c=b[d].getAncestors();if(!c||-1===c.indexOf(a))return!1}return!0};h.prototype._allFoldersAncestorsOf=function(a,b){var d=a.getAncestors();if(d){for(var c=0;c<
b.length;c++)if(-1===d.indexOf(b[c]))return!1;return!0}return!1};h.prototype._allFoldersAncestorsOrDescendantsOf=function(a,b){var d=Array.prototype.concat(a.getAncestors()||[],a.getDescendants()||[]);if(d){for(var c=0;c<b.length;c++)if(-1===d.indexOf(b[c]))return!1;return!0}return!1};h.prototype._noChildItemsWithMapService=function(a,b){for(var d=0;d<b.length;d++)for(var c=b[d].children.get(),e=0;e<c.length;e++)if(c[e].mapService&&c[e].mapService===a)return!1;return!0};h.prototype._onlyFolderItems=
function(a){for(var b=0;b<a.length;b++)if(a[b].type!==g.LayerListItemType.FOLDER)return!1;return!0};h.prototype._processUnhandledMapServices=function(){var a=this;dojo.filter(this._allMapServiceReferences,function(b){return-1===a._handledMapServiceReferences.indexOf(b)}).forEach(function(a){if(a.serviceLayer instanceof esri.layers.ArcGISDynamicMapServiceLayer||a.serviceLayer instanceof esri.layers.WMSLayer)a.serviceLayer.on("visibility-change",function(b){b.visible?a._esriLayerStateBackup&&(a.serviceLayer.setVisibleLayers(a._esriLayerStateBackup),
a._esriLayerStateBackup=null):a.serviceLayer instanceof esri.layers.ArcGISDynamicMapServiceLayer?(a._esriLayerStateBackup=a.serviceLayer.visibleLayers?a.serviceLayer.visibleLayers.slice(0):[-1],a.serviceLayer.setVisibleLayers(["-1"])):(a._esriLayerStateBackup=a.serviceLayer.visibleLayers?a.serviceLayer.visibleLayers.slice(0):[],a.serviceLayer.setVisibleLayers([]))})})};h.prototype._addItemsToUserAddedFolder=function(a,b){var d=this._userAddedLayersFolder||this;if(a[0].type===g.LayerListItemType.LAYER&&
this.children.getLength()){var c=a[0].layer.gcxLayer;if(c&&c.catalogId)for(var e=this._addedFolderReferences,f=0;f<e.length;f++){var m=e[f];if(m.canAdjustOpacity&&m.mapService&&m.mapService.gcxMapService===c.mapService){d=m;break}}}var h=b||0,c=a.reduceRight(function(a,b,c){return d.children.validateAndInsertItem(h,b)&&a},!0);d===this._userAddedLayersFolder?(this._userAddedLayersFolder.displayItem.set(!0),this._userAddedLayersFolder.isExpanded.set(!0),this._userAddedLayersFolder.isVisible.set(!0),
this._userAddedLayersFolder.parent instanceof l.LayerListFolderItem&&this._userAddedLayersFolder.parent.refreshOnDemandItemCollection()):d instanceof l.LayerListFolderItem&&d.refreshOnDemandItemCollection();this._applyDeferredItemVisibilities(d.children.get());return c};h.prototype._handleFilterChanged=function(a){var b=this;a.filterControlId===this._filterControlId&&(this._itemsExpandedByFilter&&this._itemsExpandedByFilter.length&&(this._itemsExpandedByFilter.forEach(function(a){return a.isExpanded.set(!1)}),
this._itemsExpandedByFilter.length=0),a.filterableItems.forEach(function(a){var d=a.item;d.updateDisplayItem();if(a.filterQuery&&a.queryMatched)for(a=d.parent;a;){var c=b.filterControlComponent.getFilterableItem(a);!a.isExpanded||a.isExpanded.get()&&c.queryMatched||(c.queryMatched=!0,a.updateDisplayItem(),a.isExpanded.get()||(a.isExpanded.set(!0),b._itemsExpandedByFilter.push(a)));a=a.parent}d.refreshOnDemandItemCollection()}))};return h}(k.LayerListNode);f.LayerList=h});
define("infrastructure/layerselector/LayerSelectorItem",["require","exports"],function(h,f){});define("infrastructure/layerselector/LayerSelectorLayerItem",["require","exports"],function(h,f){});define("infrastructure/layerselector/LayerSelectorServiceLayerItem",["require","exports"],function(h,f){});define("infrastructure/layerselector/LayerSelectorFolderItem",["require","exports"],function(h,f){});
define("infrastructure/layerselector/LayerSelectorConfiguration",["require","exports"],function(h,f){});
define("infrastructure/layerselector/LayerSelector","require exports geocortex/framework/observables infrastructure/gis/ServiceLayerInfo infrastructure/gis/LayerInfo geocortex/framework/utils/utils".split(" "),function(h,f,k,l,e,c){h=function(){function a(a,d){this.filteredLayerSelectorLayerItems=[];this.unfilteredLayerSelectorLayerItems=[];this.itemTypes={FOLDER:"folder",LAYER:"layer",SERVICELAYER:"serviceLayer"};this._infrastructureLibraryId="Mapping.Infrastructure";this._unfilteredItems=[];this._userAddedLayersFolder=
null;this.appInfo=a;d&&(d.layerFilter&&dojo.isFunction(d.layerFilter)&&(this.layerFilter=d.layerFilter),d.layerStateChangeHandler&&dojo.isFunction(d.layerStateChangeHandler)&&(this.layerStateChangeHandler=d.layerStateChangeHandler),d.enableAllLayersHandler&&dojo.isFunction(d.enableAllLayersHandler)&&(this.enableAllLayersHandler=d.enableAllLayersHandler),d.disableAllLayersHandler&&dojo.isFunction(d.disableAllLayersHandler)&&(this.disableAllLayersHandler=d.disableAllLayersHandler),d.onInitializedHandler&&
dojo.isFunction(d.onInitializedHandler)&&(this.onInitializedHandler=d.onInitializedHandler),d.onLayerSelectorFolderItemCreated&&dojo.isFunction(d.onLayerSelectorFolderItemCreated)&&(this.onLayerSelectorFolderItemCreated=d.onLayerSelectorFolderItemCreated),d.onLayerSelectorLayerItemCreated&&dojo.isFunction(d.onLayerSelectorLayerItemCreated)&&(this.onLayerSelectorLayerItemCreated=d.onLayerSelectorLayerItemCreated),d.onLayerSelectorServiceLayerItemCreated&&dojo.isFunction(d.onLayerSelectorServiceLayerItemCreated)&&
(this.onLayerSelectorServiceLayerItemCreated=d.onLayerSelectorServiceLayerItemCreated));this.items=new k.ObservableCollection;this._suspendLayerStateChangeHandler=this.initialized=!1;this.initialize()}a.prototype.initialize=function(){this._loadLayerSelectorItems();this.applyFilter(this.layerFilter);this.setLayerStateChangeHandler(this.layerStateChangeHandler);this.setEnableAllLayersHandler(this.enableAllLayersHandler);this.setDisableAllLayersHandler(this.disableAllLayersHandler);if(this.onInitializedHandler&&
!this.initialized)this.onInitializedHandler(this);this.initialized=!0};a.prototype.applyFilter=function(a){var d=this;this.layerFilter=a&&dojo.isFunction(a)?a:null;this.items.clear();this.filteredLayerSelectorLayerItems=[];if(this.layerFilter){var c=function(a){var b=null;a.itemType===d.itemTypes.FOLDER?(b=d._generateItemCloneForFilter(a),a.items.get().forEach(function(a){(a=c(a))&&(!a.isFolder||a.isFolder&&a.items.length())&&b.items.addItem(a)})):a.itemType===d.itemTypes.SERVICELAYER&&0<a.items.getLength()?
(d.layerFilter(a)?(b=d._generateItemCloneForFilter(a),d.filteredLayerSelectorLayerItems.push(b)):b=d._creatFolderItemFromServiceLayer(a,!0,!0),a.items.get().forEach(function(a){(a=c(a))&&(!a.isFolder||a.isFolder&&a.items.length())&&b.items.addItem(a)})):d.layerFilter(a)&&(b=a,d.filteredLayerSelectorLayerItems.push(b));return b};this._unfilteredItems.forEach(function(a){(a=c(a))&&(!a.isFolder||a.isFolder&&a.items.length())&&d.items.addItem(a)})}else this.items.set(this._unfilteredItems),this.filteredLayerSelectorLayerItems=
this.unfilteredLayerSelectorLayerItems.slice(0)};a.prototype.reapplyFilter=function(){this.applyFilter(this.layerFilter)};a.prototype.setLayerStateChangeHandler=function(a){var d=this;(function(){d.unfilteredLayerSelectorLayerItems.forEach(function(a){a._isEnabledBindingToken&&(a.isEnabled.unbind(a._isEnabledBindingToken),delete a._isEnabledBindingToken)})})();(this.layerStateChangeHandler=a&&dojo.isFunction(a)?a:null)&&this.unfilteredLayerSelectorLayerItems.forEach(function(a){a._isEnabledBindingToken=
a.isEnabled.bind(d,function(){d._suspendLayerStateChangeHandler||d.layerStateChangeHandler(a)})})};a.prototype.setEnableAllLayersHandler=function(a){this.enableAllLayersHandler=a&&dojo.isFunction(a)?a:null};a.prototype.setDisableAllLayersHandler=function(a){this.disableAllLayersHandler=a&&dojo.isFunction(a)?a:null};a.prototype.enableAllLayers=function(){this._suspendLayerStateChangeHandler=!0;this.filteredLayerSelectorLayerItems.forEach(function(a){return a.isEnabled.set(!0)});this._suspendLayerStateChangeHandler=
!1;this.enableAllLayersHandler&&this.enableAllLayersHandler()};a.prototype.disableAllLayers=function(){this._suspendLayerStateChangeHandler=!0;this.filteredLayerSelectorLayerItems.forEach(function(a){return a.isEnabled.set(!1)});this._suspendLayerStateChangeHandler=!1;this.disableAllLayersHandler&&this.disableAllLayersHandler()};a.prototype.addUserAddedServiceLayer=function(a){var d=this;a instanceof l.ServiceLayerInfo&&(a=a.gcxMapService);if(!a||this.unfilteredLayerSelectorLayerItems.filter(function(d){return d.serviceLayer&&
d.serviceLayer.gcxMapService===a}).length)return!1;var c=l.ServiceLayerInfo.fromGcxMapService(a),f=this._createServiceLayerItemFromServiceLayer(c,!0,!0);this.unfilteredLayerSelectorLayerItems.push(f);a.layers.forEach(function(a){if(d.unfilteredLayerSelectorLayerItems.filter(function(b){return b.layer&&b.layer.gcxLayer===a}).length)return!1;var b=c.findLayerById(a.id);b||(b=e.LayerInfo.fromGcxLayer(a),b.serviceLayerInfo=c,c.layers.push(b));if(b=d._createLayerItemFromLayer(b,!0,!0))f.items.addItem(b),
d.unfilteredLayerSelectorLayerItems.push(b)});this._unfilteredItems.push(f);this.applyFilter(this.layerFilter);this.setLayerStateChangeHandler(this.layerStateChangeHandler);return!0};a.prototype.removeServiceLayer=function(a){var d=this;a instanceof l.ServiceLayerInfo&&(a=a.gcxMapService);if(!a)return!1;var c=this.unfilteredLayerSelectorLayerItems.filter(function(d){return d.serviceLayer&&d.serviceLayer.gcxMapService===a});c.length&&c.forEach(function(a){return d._removeItemFromUnfilteredCollections(a)});
a.layers.forEach(function(a){var b=d.unfilteredLayerSelectorLayerItems.filter(function(b){return b.layer&&b.layer.gcxLayer===a});if(!b.length)return!1;b.forEach(function(a){return d._removeItemFromUnfilteredCollections(a)})});this.applyFilter(this.layerFilter);this.setLayerStateChangeHandler(this.layerStateChangeHandler);return!0};a.prototype.updateServiceLayer=function(a,d,g){var f=this;d=d||[];g=g||[];a instanceof l.ServiceLayerInfo&&(a=a.gcxMapService);if(!a)return!1;a=l.ServiceLayerInfo.fromGcxMapService(a);
for(var h=0;g&&h<g.length;h++){var k=g[h],p=this.unfilteredLayerSelectorLayerItems.filter(function(a){return a.layer&&a.layer.gcxLayer===k});p.length&&p.forEach(function(a){return f._removeItemFromUnfilteredCollections(a)})}this._userAddedLayersFolder||(g={id:c.alphaNumericToken()+":UserAdded",name:this.appInfo.gcxApp.getResource(this._infrastructureLibraryId,"language-layerlist-user-added-layers-folder-title"),isExpanded:!0,isVisible:!0,items:[],canToggleVisibility:null,iconUri:null,isVisibleInLayerList:null,
layerID:null,mapServiceID:null,layerVisibilityType:null,themeSettings:null,type:null},this._userAddedLayersFolder=this._createFolderItemFromRestItem(g,!0,!0));for(g=0;d&&g<d.length;g++)if(k=d[g],p=this.unfilteredLayerSelectorLayerItems.filter(function(a){return a.layer&&a.layer.gcxLayer===k}),!p.length&&(p=a.findLayerById(k.id),p||(p=e.LayerInfo.fromGcxLayer(k),p.serviceLayerInfo=a,a.layers.push(p)),p=this._createLayerItemFromLayer(p,!0,!0)))this._userAddedLayersFolder.items.addItem(p),this.unfilteredLayerSelectorLayerItems.push(p);
this._userAddedLayersFolder&&0<this._userAddedLayersFolder.items.length()&&0>this._unfilteredItems.indexOf(this._userAddedLayersFolder)&&this._unfilteredItems.unshift(this._userAddedLayersFolder);this.applyFilter(this.layerFilter);this.setLayerStateChangeHandler(this.layerStateChangeHandler);return!0};a.prototype._removeItemFromUnfilteredCollections=function(a){var d=this;if(a){var c=[],e=function(a,b){var d=a.indexOf(b);-1<d&&a.splice(d,1)},f=function(a,b){for(var d=a.length-1;0<=d;d--){var h=a[d];
h===b?a.splice(d,1):h.isFolder&&h.items.length()&&(e(h.items.get(),b),h.items.pulse(),f(h.items.get(),b),0===h.items.length()&&c.push(h))}};a.isFolder||e(this.unfilteredLayerSelectorLayerItems,a);f(this._unfilteredItems,a);c.length&&c.forEach(function(a){return d._removeItemFromUnfilteredCollections(a)})}};a.prototype._loadLayerSelectorItems=function(){var a=this,d=this.appInfo.gcxApp.site.layerListRestEndpoint,c=this.appInfo.mapInfo;this._unfilteredItems=[];this.unfilteredLayerSelectorLayerItems=
[];var e=function(d){var f,h=void 0!=d.isExpanded?d.isExpanded:!0;switch(d.type){case "folder":f=a._createFolderItemFromRestItem(d,!0,h);break;case "mapService":f=c.findMapServiceById(d.mapServiceID);f=a._createServiceLayerItemFromServiceLayer(f,!0,h);a.unfilteredLayerSelectorLayerItems.push(f);break;case "layer":f=(f=c.findMapServiceById(d.mapServiceID))&&f.findLayerById(d.layerID),f=a._createLayerItemFromLayer(f,!0,h),a.unfilteredLayerSelectorLayerItems.push(f)}if(f&&d.items)for(h=0;h<d.items.length;h++){var l=
e(d.items[h]);l&&f.items.addItem(l)}return"folder"===d.type&&f&&0===f.items.getLength()?null:f};d.items&&d.items.length&&d.items.forEach(function(d){(d=e(d))&&a._unfilteredItems.push(d)});this._loadSelectorItemsNotInLayerList()};a.prototype._loadSelectorItemsNotInLayerList=function(){for(var a=0;a<this.appInfo.mapInfo.serviceLayers.length;a++){var d=null,c=this.appInfo.mapInfo.serviceLayers[a];c&&!c.includeInLayerList&&(d=this._createServiceLayerItemFromServiceLayer(c,!0,!0),this._unfilteredItems.push(d),
this.unfilteredLayerSelectorLayerItems.push(d));for(var e=0;e<c.layers.length;e++){var f=c.layers[e];!f||f&&f.includeInLayerList||(f=this._createLayerItemFromLayer(f,!0,!0),d&&f?(d.items.addItem(f),this.unfilteredLayerSelectorLayerItems.push(f)):null==d&&f&&(this._unfilteredItems.push(f),this.unfilteredLayerSelectorLayerItems.push(f)))}}};a.prototype._createFolderItemFromRestItem=function(a,d,c){if(!a)return null;var e={};e.itemType=this.itemTypes.FOLDER;e.name=new k.Observable(a.name||"Layers");
e.isFolder=!0;e.isEnabled=new k.Observable(!!d);e.isExpanded=new k.Observable(!!c);e.iconUri=new k.Observable("");e.items=new k.ObservableCollection;this._setTooltips(e);if(this.onLayerSelectorFolderItemCreated)this.onLayerSelectorFolderItemCreated(e);return e};a.prototype._creatFolderItemFromServiceLayer=function(a,d,c){var e={};e.itemType=this.itemTypes.FOLDER;e.name=new k.Observable(a.name.get()||"Layers");e.isFolder=!0;e.isEnabled=new k.Observable(!!d);e.isExpanded=new k.Observable(!!c);e.iconUri=
new k.Observable(a.iconUri.get()||"");e.items=new k.ObservableCollection;this._setTooltips(e);if(this.onLayerSelectorFolderItemCreated)this.onLayerSelectorFolderItemCreated(e);return e};a.prototype._createLayerItemFromLayer=function(a,d,c){if(!a)return null;var e={};e.itemType=this.itemTypes.LAYER;e.isEnabled=new k.Observable(!!d);e.isExpanded=new k.Observable(!!c);e.name=new k.Observable(a.gcxLayer.displayName);e.isFolder=!1;e.iconUri=new k.Observable(a.gcxLayer.iconUri);e.layer=a;e.items=new k.ObservableCollection([]);
this._setTooltips(e);if(this.onLayerSelectorLayerItemCreated)this.onLayerSelectorLayerItemCreated(e);return e};a.prototype._createServiceLayerItemFromServiceLayer=function(a,d,c){if(!a)return null;var e={};e.itemType=this.itemTypes.SERVICELAYER;e.isEnabled=new k.Observable(!!d);e.isExpanded=new k.Observable(!!c);e.name=new k.Observable(a.gcxMapService.displayName);e.isFolder=!1;e.iconUri=new k.Observable(a.gcxMapService.iconUri);e.serviceLayer=a;e.items=new k.ObservableCollection([]);this._setTooltips(e);
if(this.onLayerSelectorServiceLayerItemCreated)this.onLayerSelectorServiceLayerItemCreated(e);return e};a.prototype._generateItemCloneForFilter=function(a){var d=dojo.mixin({},a);d.isEnabled=new k.Observable(!0);d.items=new k.ObservableCollection;void 0!=a.serviceLayer&&(d.serviceLayer=a.serviceLayer);return d};a.prototype._setTooltips=function(a){var d=this.appInfo.gcxApp.getResource(this._infrastructureLibraryId,"language-layerselector-item-expand").format(a.name.get()),c=this.appInfo.gcxApp.getResource(this._infrastructureLibraryId,
"language-layerselector-state-toggle").format(a.name.get()),e=this.appInfo.gcxApp.getResource(this._infrastructureLibraryId,"language-layerselector-icon-tooltip").format(a.name.get());a.expanderTooltip=new k.Observable(d);a.stateToggleTooltip=new k.Observable(c);a.iconTooltip=new k.Observable(e)};return a}();f.LayerSelector=h});
define("infrastructure/layerselector/LayerSelectorViewModelBase","require exports geocortex/framework/ui/ViewModelBase infrastructure/gis/AppInfo infrastructure/layerselector/LayerSelector geocortex/framework/observables".split(" "),function(h,f,k,l,e,c){h=function(a){function b(b,e){var f=a.call(this,b,e)||this;f._layerSelectorInitialized=new c.Observable(!1);f.selectAllButtonText=new c.Observable(f.app.getResource(e,"language-layer-selector-default-select-all-text"));f.clearAllButtonText=new c.Observable(f.app.getResource(e,
"language-layer-selector-default-clear-all-text"));f.selectAllButtonTitle=new c.Observable(f.app.getResource(e,"language-layer-selector-default-select-all-tooltip"));f.clearAllButtonTitle=new c.Observable(f.app.getResource(e,"language-layer-selector-default-clear-all-tooltip"));f.items=new c.ObservableCollection([]);return f}__extends(b,a);b.prototype.initialize=function(b){a.prototype.initialize.call(this,b);this._subscribeEvents();if(this.app.site&&this.app.site.isInitialized)this._setupLayerSelector();
else this.app.event("SiteInitializedEvent").once(this,this._setupLayerSelector)};b.prototype.onInitialized=function(a){};b.prototype.onLayerSelectorFolderItemCreated=function(a){};b.prototype.onLayerSelectorLayerItemCreated=function(a){};b.prototype.onLayerSelectorServiceLayerItemCreated=function(a){};b.prototype.filter=function(a){return!0};b.prototype.handleLayerStateChange=function(a){};b.prototype.handleAllLayersEnabled=function(){};b.prototype.handleAllLayersDisabled=function(){};b.prototype.getAllItems=
function(){return b._expandItems(this.items.get())};b._expandItems=function(a){return a.concat.apply(a,a.map(function(a){return b._expandItems(a.items.get())}))};b.prototype._setupLayerSelector=function(){var a=this;this.appInfo=l.AppInfo.fromGeocortexApp(this.app);this.layerSelector=new e.LayerSelector(this.appInfo,{onInitializedHandler:function(b){return a.onInitialized(b)},layerFilter:function(b){return a.filter(b)},layerStateChangeHandler:function(b){return a.handleLayerStateChange(b)},enableAllLayersHandler:function(){return a.handleAllLayersEnabled()},
disableAllLayersHandler:function(){return a.handleAllLayersDisabled()},onLayerSelectorFolderItemCreated:function(b){return a.onLayerSelectorFolderItemCreated(b)},onLayerSelectorLayerItemCreated:function(b){return a.onLayerSelectorLayerItemCreated(b)},onLayerSelectorServiceLayerItemCreated:function(b){return a.onLayerSelectorServiceLayerItemCreated(b)}});this._layerSelectorInitialized.set(!0);this.items.sync(this.layerSelector.items);this.items.pulse()};b.prototype._subscribeEvents=function(){this.app.event("MapServiceAddedEvent").subscribe(this,
this._handleMapServicesAdded);this.app.event("MapServiceRemovedEvent").subscribe(this,this._handleMapServiceRemoved);this.app.event("MapServiceLayersChangedWithResultEvent").subscribe(this,this._handleMapServiceLayersChanged)};b.prototype._handleMapServicesAdded=function(a){var b=this;this._waitUntilLayerSelectorInitialized().then(function(){b.layerSelector.addUserAddedServiceLayer(a)})};b.prototype._handleMapServiceRemoved=function(a){var b=this;this._waitUntilLayerSelectorInitialized().then(function(){b.layerSelector.removeServiceLayer(a)})};
b.prototype._handleMapServiceLayersChanged=function(a){var b=this;this._waitUntilLayerSelectorInitialized().then(function(){a&&b.layerSelector.updateServiceLayer(a.mapService,a.newItems,a.oldItems)})};b.prototype._waitUntilLayerSelectorInitialized=function(){var a=this;return new Promise(function(b,c){if(a._layerSelectorInitialized.get())b();else a._layerSelectorInitialized.once(a,function(){return b()})})};return b}(k.ViewModelBase);f.LayerSelectorViewModelBase=h});
define("infrastructure/layerselector/LayerSelectorViewBase",["require","exports","geocortex/framework/ui/ViewBase"],function(h,f,k){h=function(f){function e(){return null!==f&&f.apply(this,arguments)||this}__extends(e,f);e.prototype.selectAllLayers=function(c,a,b){this.viewModel.layerSelector.enableAllLayers()};e.prototype.clearAllLayers=function(c,a,b){this.viewModel.layerSelector.disableAllLayers()};e.prototype.handleExpanderClick=function(c,a,b){b.isExpanded.set(!b.isExpanded.get())};return e}(k.ViewBase);
f.LayerSelectorViewBase=h});define("infrastructure/project/CoordinateSystem",["require","exports"],function(h,f){});define("infrastructure/results/ResultsState",["require","exports"],function(h,f){});
define("infrastructure/results/ResultsModule","require exports geocortex/framework/application/ModuleBase infrastructure/FeatureSetCollection infrastructure/validation/NumberValidator infrastructure/PromiseUtils infrastructure/commandArgs/AddStatusArgs geocortex/geocortex infrastructure/FeatureSet geocortex/essentials/Field infrastructure/FormatUtils".split(" "),function(h,f,k,l,e,c,a,b,d,g,m){var q=function(){function a(){}a.prototype.toJSONString=function(){return JSON.stringify({name:this.name,
featureSet:this.featureSet.toJson()})};return a}();h=function(f){function h(){var a=null!==f&&f.apply(this,arguments)||this;a._supportedFormats=["csv","xlsx","shp"];a._showInvisibleAttributes=!1;a._enableDataLinkObjectIdFieldOnExport=!0;a._featureIndexName="GCX_OID";a._featureIndexRoundUpPerFeatureSet=1E3;a._includeDataLinksOnExport=!0;return a}__extends(h,f);h.prototype.initialize=function(a){var b=this;f.prototype.initialize.call(this,a);a&&(this.resultMappings=a.resultMappings,a.customSearchSuggestions&&
this.app.featureSetManager.addSearchSuggestions(a.customSearchSuggestions),a.showInvisibleAttributesOnExport&&(this._showInvisibleAttributes=a.showInvisibleAttributesOnExport),void 0!==a.includeDataLinksOnExport&&null!==a.includeDataLinksOnExport&&(this._includeDataLinksOnExport=!!a.includeDataLinksOnExport),void 0!==a.enableDataLinkObjectIdFieldOnExport&&null!==a.enableDataLinkObjectIdFieldOnExport&&(this._enableDataLinkObjectIdFieldOnExport=!!a.enableDataLinkObjectIdFieldOnExport),"string"===typeof a.gcxObjectIdFieldNameOnExport&&
""!==a.gcxObjectIdFieldNameOnExport&&(this._featureIndexName=a.gcxObjectIdFieldNameOnExport.trim()));this.wireUpResultMapping();this.app.command("ExportResultsTo").register(this,function(a){var c="csv";if(a.fsc instanceof d.FeatureSet){var e=new l.FeatureSetCollection;e.featureSets.addItem(a.fsc);a.fsc=e}a.fsc?(a.format?-1===b._supportedFormats.indexOf(a.format)?b.app.trace.warning("ExportResultsTo: {0} file format not recognized. Defaulting to csv.".format(a.format)):c=a.format:b.app.trace.warning("ExportResultsTo: file format not specified. Defaulting to csv."),
b.exportTo({fsc:a.fsc,format:c})):b.app.trace.error("ExportResultsTo: Cannot export, no feature set collection specified.")},this.exportToCanExecute)};h.prototype.getStateFilter=function(){var a=this,b=new e.NumberValidator;return function(d){var c={serialVersion:!0};c.featureSetCollections={item:a.app.project.filter.featureSetCollection};c.results=a.app.project.filter.featureSetCollection;c.viewMode=!0;c.page=b;c.tableOptions={sortColumn:b,sortDirection:!0};2==d.serialVersion?c.openedFeatureSet=
a.app.project.filter.featureSet:c.tableOptions.selectedFeatureSet=a.app.project.filter.featureSet;return c}};h.prototype.exportState=function(){var a=this,b={featureSetCollections:this.app.featureSetManager.featureSetCollections.get().map(function(b){return a.app.project.convert.fromGcxFeatureSetCollection(b)})};return Promise["try"](function(){a.app.command("_ExportResultsViewState").execute(b);b.serialVersion=2;return b})};h.prototype.applyState=function(a){var b=this;return c.PromiseUtils.mapSkipRejected(a.featureSetCollections,
function(a){return b.app.project.convert.toGcxFeatureSetCollection(a)}).then(function(){return b.app.waitUntilAllLibrariesLoaded()}).then(function(){var d={state:a,promises:[]};b.app.command("_ClearIsSelected").execute();b.app.command("_ApplyResultsViewState").execute(d);return Promise.all(d.promises)["return"]()})};h.prototype.wireUpResultMapping=function(){this.app.event("FSMCollectionOpenedEvent").subscribe(this,this.fsmCollectionOpenedHandler);this.app.command("_setResultMappingCommand").register(this,
this.fsmCollectionSetCommand);this.app.command("FSMCollectionSetCommand").register(this,this.fsmCollectionSetCommand)};h.prototype.fsmCollectionOpenedHandler=function(a){a=a.featureSetCollection;if(this.resultMappings){var b=this.resultMappings[a.sourceName];if(b)for(var d=0;d<b.length;d++){var c=b[d];this.app.command(c).execute(a.id);this._lastCommand=c}}};h.prototype.fsmCollectionSetCommand=function(a,b){if(b){var d=null;"ShowResultsList"===b?d="ShowResultsTable":"ShowResultsTable"===b&&(d="ShowResultsList");
if(d&&this.resultMappings&&this.resultMappings[a]){var c=this.resultMappings[a],d=c.indexOf(d);-1<d?c[d]=b:-1===c.indexOf(b)&&c.push(b)}}};h.prototype.exportTo=function(d){var c=this,e=new a.AddStatusArgs(this.app.getResource(this.libraryId,"language-results-export-to-status-message").format(d.format)),g="exportTo "+d.format+"StatusMessage";e.id=g;e.showBusyIcon=!0;this.app.command("AddStatus").execute(e);var e=this.app.site.url,f=e.substring(0,e.toLowerCase().lastIndexOf("/sites/"))+"/Utilities/Extract";
this.fscToJson(d.fsc,this._includeDataLinksOnExport).then(function(a){b.request({url:f,content:{format:d.format,featureSets:a,f:"json"},load:dojo.hitch(c,function(a){return c.exportToSuccess(a,d.format)}),error:dojo.hitch(c,function(a){return c.exportToError(a,g,d.format)})})},function(a){c.exportToError(a,g,d.format)})};h.prototype.exportToSuccess=function(a,b){var d=this;if(a&&a.hasOwnProperty("href")){var c=a.href,e=this.app.getResource(this.libraryId,"language-results-export-to-confirm-content").format(b),
g=this.app.getResource(this.libraryId,"language-results-export-to-confirm-title").format(b),f="exportTo "+b+"StatusMessage";this.app.command("RemoveStatus").execute(f);this.app.commandRegistry.command("Confirm").execute(e,g,function(a){a&&(d.app.isNative.get()?window.open(c,"_blank"):window.location.assign(c))})}};h.prototype.exportToError=function(a,b,d){this.app.command("RemoveStatus").execute(b);this.app.commandRegistry.command("Alert").execute(a.message,this.app.getResource(this.libraryId,"language-results-export-to-alert-error-message").format(d))};
h.prototype.exportToCanExecute=function(a){var b=null;a&&(a instanceof l.FeatureSetCollection?b=a:a.fsc&&a.fsc instanceof l.FeatureSetCollection?b=a.fsc:a instanceof d.FeatureSet?(b=new l.FeatureSetCollection,b.featureSets.addItem(a)):a.fsc instanceof d.FeatureSet&&(b=new l.FeatureSetCollection,b.featureSets.addItem(a.fsc)));return b&&b.featureSets.get()&&0<b.featureSets.get().length};h.prototype.getFields=function(a){var b=[];a.esriFeatureSet&&a.esriFeatureSet.features&&0<a.esriFeatureSet.features.length&&
(b=this.getFieldsFromEsriLayer(a.esriFeatureSet.features[0].getLayer(),a));0===b.length&&(a.layer&&a.layer.fields&&0<a.layer.fields.length?b=this.getFieldsFromEssentialsLayer(a.layer):a.attributes.get()&&0<a.attributes.get().length?b=this.getFieldsFromGcxFeatureSetAttributes(a.attributes.get(),a):a.features.get()&&0<a.features.get().length&&a.features.getAt(0).attributes.get()&&0<a.features.getAt(0).attributes.get().length?b=this.getFieldsFromGcxFeatureAttributes(a.features.getAt(0).attributes.get(),
a):a.esriFeatureSet&&a.esriFeatureSet.features&&0<a.esriFeatureSet.features.length&&a.esriFeatureSet.features[0].attributes&&0<a.esriFeatureSet.features[0].attributes.length?b=this.getFieldsFromEsriFeatureAttributeValues(a.esriFeatureSet.features):a.features.get()&&0<a.features.get().length&&a.features.getAt(0).attributes.get()&&0<a.features.getAt(0).attributes.get().length&&(b=this.getFieldsFromGcxFeatureAttributeValues(a.features.get())));return b};h.prototype.getFieldsFromEsriLayer=function(a,
b){var d=[];if(a&&a.fields&&(d=a.fields.slice(0),b&&b.features.get()&&b.features.getAt(0).attributes.get())){var c=b.features.getAt(0).attributes.get();c.length===d.length&&c.forEach(function(a,b){d[b].alias=a.displayName.get()?a.displayName.get():d[b].alias})}return d};h.prototype.getFieldsFromEssentialsLayer=function(a){var b=[],d=new esri.layers.Field;a.fields.forEach(function(a){d=new esri.layers.Field;d.name=a.name;d.alias=a.displayName;d.type=g.Field.convertToEsriFieldType(a.dataType);b.push(d)});
return b};h.prototype.getFieldsFromGcxFeatureSetAttributes=function(a,b){var d=this,c=[],e=new esri.layers.Field;a.forEach(function(a,f){e=new esri.layers.Field;e.name=a.name.get();e.alias=a.displayName.get();a.type.get()?e.type=g.Field.convertToEsriFieldType(a.type.get()):0<b.features.get().length&&b.features.getAt(0).attributes.get()&&0<b.features.getAt(0).attributes.get().length?e.type=d.getTypeFromGcxFeatures(b.features.get(),f):e.type=d.getEsriTypeFromValue(null);c.push(e)});return c};h.prototype.getFieldsFromGcxFeatureAttributes=
function(a,b){var d=this,c=[],e=new esri.layers.Field;a.forEach(function(a,f){e=new esri.layers.Field;e.name=a.name.get();e.alias=a.displayName.get();a.type.get()?e.type=g.Field.convertToEsriFieldType(a.type.get()):e.type=d.getTypeFromGcxFeatures(b.features.get(),f);c.push(e)});return c};h.prototype.getFieldsFromEsriFeatureAttributeValues=function(a){var b=0,d=[],c=new esri.layers.Field,e=a[0].attributes,g;for(g in e)e.hasOwnProperty(g)&&(c=new esri.layers.Field,c.name=g,c.alias=g,c.type=this.getTypeFromEsriFeatures(a,
b),d.push(c),b++);return d};h.prototype.getFieldsFromGcxFeatureAttributeValues=function(a){var b=0,d=[],c=new esri.layers.Field,e=a[0].attributes.get(),g;for(g in e)e.hasOwnProperty(g)&&(c=new esri.layers.Field,c.name=g,c.alias=g,c.type=this.getTypeFromGcxFeatures(a,b),d.push(c),b++);return d};h.prototype.getTypeFromEsriFeatures=function(a,b){var d=this,c=this.getEsriTypeFromValue(null);a.forEach(function(a){(a=a.attributes[b])&&(c=d.getEsriTypeFromValue(a))});return c};h.prototype.getTypeFromGcxFeatures=
function(a,b){var d=this,c=this.getEsriTypeFromValue(null);a.forEach(function(a){(a=a.attributes.getAt(b).value.get())&&(c=d.getEsriTypeFromValue(a))});return c};h.prototype.getEsriTypeFromValue=function(a){var b="esriFieldTypeString";"number"===typeof a?b="esriFieldTypeDouble":a instanceof Date&&(b="esriFieldTypeDate");return b};h.prototype._getDataLinksAsFscItems=function(a){var b=this;return new Promise(function(c,e){if(a.layer&&a.layer.hasDataLinks&&a.layer.dataLinks.some(function(a){return!a.isOneToOne})){var f=
[],h=function(a){if(!a||!a.dataLink||!a.dataLink.get()||a.dataLink.get().isOneToOne)return null;var d=f.filter(function(b){return b.name===a.dataLink.get().displayName})[0];if(d)return d;d=b._enableDataLinkObjectIdFieldOnExport?b._featureIndexName:null;return b._generateFscCollItem(a.dataLink.get().displayName,a.table.get(),f,d)},l=function(a){a.features.get().forEach(function(a,d){for(var c=a.dataLinkingResults.get(),e=function(){var d=c[l],e=h(d);if(e&&d.dataLink&&d.dataLink.get()&&!d.dataLink.get().isOneToOne){var k=
d.table.get();k.rows.forEach(function(d){var c={},h=0;void 0!==a[b._featureIndexName]&&null!==a[b._featureIndexName]&&(c[b._getFieldName(b._featureIndexName)]=a[b._featureIndexName],h=1);var n=d.row;k.columns.forEach(function(a,d){var e=b._getFieldName(a),k=m.format(n[d]),q=f[l].featureSet.fields;q&&q[d+h]&&(q=q[d+h].type,c[e]=q===g.EsriFieldTypes.esriFieldTypeDouble?m.parseNumber(k):q===g.EsriFieldTypes.esriFieldTypeDate?m.parseUtcDate(k):k)});d=new esri.Graphic(null,null,c,null);e.featureSet.features.push(d)})}},
l=0;l<c.length;l++)e()});c(f)};!0===a.dataLinksResolved.get()?l(a):(b.app.trace.info("Waiting for feature set {0} datalinks to resolve before processing export command.".format(a.displayName.get()?"("+a.displayName.get()+")":"")),a.doWhenDataLinkingCompleted(l),a.dataLinksState===d.DataLinksState.Unresolved&&a.resolveDataLinks(null,!0,null,null,function(a,b){e(Error("Error resolving datalinks for feature set {0} while processing export command.".format(a&&a.displayName.get()?"("+a.displayName.get()+
")":"")))}))}else e(Error("This feature set either does not contain data links or only contains one-to-one datalinks."))})};h.prototype._generateFscCollItem=function(a,b,d,c){var e=this,g=b.columns,f=b.rows[0].row,m=new q;m.name=a;m.featureSet=new esri.tasks.FeatureSet;var h=[];c&&(a=new esri.layers.Field,a.name=this._getFieldName(c),a.alias=c,a.type="esriFieldTypeDouble",h.push(a));g.forEach(function(a,b){var d=new esri.layers.Field;d.name=e._getFieldName(a);d.alias=a;d.type=e.getEsriTypeFromValue(f[b]);
h.push(d)});m.featureSet.fields=h;m.featureSet.displayFieldName=this._getFieldName(g[0]);var l=0;d.forEach(function(a){m.name===a.name&&(l+=1)});0<l&&(m.name+=l);d.push(m);return m};h.prototype._getFieldName=function(a){return a.toUpperCase().replace(/ /g,"_").trim()};h.prototype.getFeatureSets=function(a,b){var d=this;void 0===b&&(b=!1);return new Promise(function(c,e){if(a&&a instanceof l.FeatureSetCollection){var f=new esri.tasks.FeatureSet,h=new esri.Graphic,k=[],n=a.featureSets.get().filter(function(a){return!!a.layer&&
a.layer.hasDataLinks&&a.layer.dataLinks.some(function(a){return!a.isOneToOne})}).length,p=0,B=0,C=function(){b&&p!==n||c(k)};a.featureSets.get().forEach(function(c,e){var l=d.getFields(c);f=new esri.tasks.FeatureSet;var n=!1,u=!!c.layer&&c.layer.hasDataLinks&&c.layer.dataLinks.some(function(a){return!a.isOneToOne});if(c&&c.features.get()&&0<c.features.get().length){var v=[],A=[];c.features.getAt(0).attributes.get().forEach(function(a){a.visible.get()||d._showInvisibleAttributes?v.push(a.name.get()):
A.push(a.name.get())});n=v.some(function(a){return a===d._featureIndexName});c.features.get().forEach(function(a,e){var k={},q=a.esriFeature.get().attributes;a.getAttributes().forEach(function(a){if(a.visible.get()||d._showInvisibleAttributes){var b=a.name.get(),c=a.presentableValue.get(),e,f;for(f in l){var h=l[f];if(h.name===a.name.get()){e=h.type;if((f=l.filter(function(a){return-1!==a.name.indexOf(".Name()",a.name.length-7)&&a.name.substr(0,a.name.length-7)===h.name}))&&0<f.length&&(f=f[0].name)&&
q&&q.hasOwnProperty(f)){var n=q[h.name],p=n,n=c,c=p;k[f]=n}break}}c&&b&&(h&&h.domain&&"codedValue"==h.domain.type?(h.type=g.EsriFieldTypes.esriFieldTypeString,k[b]=a.presentableValue.get()):k[b]=!h||h.type!==g.EsriFieldTypes.esriFieldTypeDouble&&h.type!==g.EsriFieldTypes.esriFieldTypeSingle?e===g.EsriFieldTypes.esriFieldTypeInteger||h&&h.type===g.EsriFieldTypes.esriFieldTypeSmallInteger?Math.floor(m.parseNumber(a.value.get())):e===g.EsriFieldTypes.esriFieldTypeDate?m.parseDate(a.value.get()):c:m.parseNumber(a.value.get()))}});
f.displayFieldName=c.esriFeatureSet.displayFieldName;h=new esri.Graphic(a.esriFeature.get().geometry,null,k,null);f.features.push(h);b&&u&&!n&&d._enableDataLinkObjectIdFieldOnExport&&(0===e&&(B=Math.ceil(B/d._featureIndexRoundUpPerFeatureSet)*d._featureIndexRoundUpPerFeatureSet),a[d._featureIndexName]=B,h.attributes[d._featureIndexName]=B,B++)})}if(0<f.features.length){if(l&&0<l.length){var K=[];l.forEach(function(a){-1==$.inArray(a.name,A)&&K.push(a)});f.fields=K}var E=new q;E.name=a.featureSets.getAt(e).displayName.get();
E.featureSet=f;var G=0;k.forEach(function(a){E.name===a.name&&(G+=1)});0<G&&(E.name+=G);k.push(E);b&&u&&(!n&&d._enableDataLinkObjectIdFieldOnExport&&E.featureSet.fields.unshift({name:d._getFieldName(d._featureIndexName),alias:d._featureIndexName,type:"esriFieldTypeDouble"}),d._getDataLinksAsFscItems(c).then(function(a){a&&a.length&&k.push.apply(k,a);p++;C()},function(a){d.app.trace.error(a.message);p++;C()}))}});(!b||b&&0===n)&&C()}else e(Error("ResultsModule: getFeatureSets error. Invalid input arguments."))})};
h.prototype.fscToJson=function(a,b){var d=this;void 0===b&&(b=!0);return new Promise(function(c,e){d.getFeatureSets(a,b).then(function(a){var b="[";a.forEach(function(a,d,c){var e=new q;e.featureSet=a.featureSet;e.name=a.name;b+=e.toJSONString();d!==c.length-1&&(b+=",")});b+="]";c(b)},function(a){e(a)})})};return h}(k.ModuleBase);f.ResultsModule=h});
define("infrastructure/results/FeatureSetCollectionResultsLabelViewModel",["require","exports","geocortex/framework/ui/ViewModelBase","geocortex/framework/observables"],function(h,f,k,l){h=function(e){function c(a,b){var d=e.call(this,a,b)||this;d.featureSet=new l.Observable;d.featuresCount=new l.Observable;d.featureSetLabel=new l.Observable;d.iconUri=new l.Observable;d.featureSet.bind(d,function(a){d.featuresCount.set("("+a.features.getLength()+")");var b=""!==a.displayName.get()?a.displayName.get():
a.id;d.featureSetLabel.set(b);d.iconUri.set(a.iconUri.get())});return d}__extends(c,e);return c}(k.ViewModelBase);f.FeatureSetCollectionResultsLabelViewModel=h});
define("infrastructure/results/FeatureSetCollectionResultsLabelView",["require","exports","geocortex/framework/ui/ViewBase","infrastructure/results/FeatureSetCollectionResultsLabelViewModel"],function(h,f,k,l){h=function(e){function c(a,b){return e.call(this,a,b)||this}__extends(c,e);c.prototype.attach=function(a){this.viewModel=new l.FeatureSetCollectionResultsLabelViewModel(this.app,this.libraryId);this.viewModel.featureSet.set(a);e.prototype.attach.call(this,this.viewModel);return Promise.resolve()};
c.prototype.handleClick=function(a,b,d){a=a.target;b=!("IMG"!==a.tagName||!a.parentElement||"A"!==a.parentElement.tagName||!a.parentElement.href);if("A"===a.tagName||b)return!0;this.app.event("FeatureSetClickedEvent").publish(d.featureSet.get());return!1};return c}(k.ViewBase);f.FeatureSetCollectionResultsLabelView=h});
define("infrastructure/results/ResultsViewBase",["require","exports","geocortex/framework/ui/ViewBase","geocortex/framework-ui/ViewContainer/ViewContainerView","infrastructure/ShellUtils"],function(h,f,k,l,e){h=function(c){function a(a,d){var e=c.call(this,a,d)||this;e.isCollapsed=!0;e.isContainerCollapsed=!0;e._longPressTimer=null;e._pressStartTime=null;e._pressLengthMs=1500;e._hoverTimerToken=null;e._hoverDelayMs=0;e._hoveredFeature=null;e._firedTouchOrPress=!1;e._pressYStart=null;e._lastTouchY=
null;e._scrollYDeltaThreshold=35;e._firstEvent=null;e.app.event("ViewContainerActivatedEvent").subscribe(e,function(a){!e.isCollapsed&&e._isViewHostedInContainer(a)&&(e.app.event("ResultsViewOpenedEvent").publish(e),e.viewModel.resultsPage&&e.app.behavior("ResultsPageChangedBehavior").run(e.viewModel.resultsPage.get()),e.isContainerCollapsed=!1)});e.app.event("ViewContainerDeactivatedEvent").subscribe(e,function(a){!e.isCollapsed&&e._isViewHostedInContainer(a)&&(e.app.event("ResultsViewCollapsedEvent").publish(e),
e.isContainerCollapsed=!0)});e.app.event("ViewContainerViewClosedEvent").subscribe(e,function(a){a.viewId===e.id&&(e.app.event("ResultsViewClosedEvent").publish(e),e.isContainerCollapsed=!0)});return e}__extends(a,c);a.prototype.activated=function(){c.prototype.activated.call(this);this.isCollapsed=!1;this.app.event("ResultsViewOpenedEvent").publish(this)};a.prototype.deactivated=function(){c.prototype.deactivated.call(this);this.isCollapsed=!0;this.app.event("ResultsViewCollapsedEvent").publish(this)};
a.prototype.handleTouchStart=function(a,d,c){this._firstEvent||(this._firstEvent="touch start",this._beginLongPress(c));return!0};a.prototype.handleTouchMove=function(a,d,c){"touch start"===this._firstEvent&&(this._firstEvent=null,this._cancelLongPress());return!0};a.prototype.handleTouchEnd=function(a,d,c){"touch start"===this._firstEvent&&(this._firstEvent=null,this._cancelLongPress());return!0};a.prototype.handleTouchCancel=function(a,d,c){"touch start"===this._firstEvent&&(this._firstEvent=null,
this._cancelLongPress());return!0};a.prototype.handleMouseDown=function(a,d,c){this._firstEvent||(this._firstEvent="mouse down",this._beginLongPress(c));return!0};a.prototype.handleClick=function(a,d,c){this._cancelHover();this._hoveredFeature=null;this._firstEvent&&(this._firstEvent=null,this._cancelLongPress());a=a.target;d=!("IMG"!==a.tagName||!a.parentElement||"A"!==a.parentElement.tagName||!a.parentElement.href);if("A"===a.tagName||d)return!0;this.app.command("ClearFeatureInformation").execute();
this.app.event(this.featureClickedEventName).publish(c);return!1};a.prototype.handleMouseUp=function(a,d,c){this._cancelHover();"mouse down"===this._firstEvent&&(this._firstEvent=null,this._cancelLongPress());return!0};a.prototype.handleMouseOver=function(a,d,c){(e.hasClass(a.currentTarget,this.itemClass)||a instanceof FocusEvent)&&this._beginHover(c)};a.prototype.handleMouseOut=function(a,d,c){if(e.hasClass(a.currentTarget,this.itemClass)||a instanceof FocusEvent)this._cancelHover(),this._tryFireHoverStop(c),
"mouse down"===this._firstEvent&&(this._firstEvent=null,this._cancelLongPress())};a.prototype._beginHover=function(a){var d=this;this._hoverTimerToken&&clearTimeout(this._hoverTimerToken);this._hoverTimerToken=setTimeout(function(){d._hoveredFeature!==a&&(d._hoveredFeature=a);d.app.event(d.featureHoveredEventName).publish(a)},this._hoverDelayMs)};a.prototype._cancelHover=function(){this._hoverTimerToken&&(clearTimeout(this._hoverTimerToken),this._hoverTimerToken=null)};a.prototype._tryFireHoverStop=
function(a){this._hoveredFeature===a&&(this._hoveredFeature=null,this.app.event(this.featureHoverEndEventName).publish(a))};a.prototype._beginLongPress=function(a){var d=this;this._longPressTimer&&clearTimeout(this._longPressTimer);this._longPressTimer=setTimeout(function(){d.app.event(d.featurePressedEventName).publish(a)},this._pressLengthMs)};a.prototype._cancelLongPress=function(){this._longPressTimer&&(clearTimeout(this._longPressTimer),this._longPressTimer=null)};a.prototype._isViewHostedInContainer=
function(a){if(a instanceof l.ViewContainerView){a=a.viewModel.regionName.get();var d=this.app.viewManager.getRegionForViewId(this.id);if(d&&d.name===a)return!0}return!1};a.prototype.scrollView=function(a){this.scrollContainerElement&&(this.scrollContainerElement.scrollTop=a||0)};return a}(k.ViewBase);f.ResultsViewBase=h;h.prototype.featureClickedEventName="ResultsListFeatureClickedEvent";h.prototype.featurePressedEventName="ResultsListFeaturePressedEvent"});
define("infrastructure/results/ResultsViewModel","require exports geocortex/framework/ui/ViewModelBase infrastructure/FeatureSetCollection infrastructure/Dictionary geocortex/framework/observables".split(" "),function(h,f,k,l,e,c){h=function(a){function b(b,g){var f=a.call(this,b,g)||this;f._emptyFeatureSetCollection=null;f._watchHandles=new e.Dictionary;f.featureSetCollection=new c.Observable;f.featureActions=new c.ObservableCollection;f.currentFeature=new c.Observable;f.hasFeatureSets=new c.Observable(!1);
f.isBusy=new c.Observable(!1);f.isModified=new c.Observable(!1);f.defaultIsPaged=!0;f.defaultPageSize=50;f.headerText=new c.Observable(f.app.getResource(f.libraryId,"language-common-results"));f.searchSuggestion=new c.Observable(f.app.getResource(f.libraryId,"language-common-no-results-desc"));f.featureSetCollection.bind(f,f.handleCollectionChanged);f.registerCommands();f.subscribeEvents();return f}__extends(b,a);b.prototype.subscribeEvents=function(){this.app.event("FSMCollectionOpenedEvent").subscribe(this,
this._openFSC);this.app.event("FSMCollectionClosedEvent").subscribe(this,this._closeFSC);this.app.event("FSMCollectionRemovedEvent").subscribe(this,this._removeFSC);this.app.event("FSMCollectionChangedEvent").subscribe(this,this._changeFSC);this.app.event("FeatureEditedEvent").subscribe(this,this._pulseFeatureSetsInCollection);this.app.event("FeatureDeletedEvent").subscribe(this,this._pulseFeatureSetsInCollection);this.app.event("RelatedRecordEditedEvent").subscribe(this,this._pulseFeatureSetsInCollection);
this.app.event("GraphicRemovedEvent").subscribe(this,this._pulseFeatureSetsInCollection)};b.prototype.handleCollectionChanged=function(a){var b=a&&this.app.featureSetManager.getCollectionById(a.id);!b&&a&&a.featureSets&&(b=a);b?(b===this._emptyFeatureSetCollection?this.isBusy.set(!1):this.isBusy.set(this.app.featureSetManager.isCollectionOpen(b.id)),this.updateHeaderText(b.countFeatures()),this.hasFeatureSets.set(this._featureSetsHaveFeatures(b.featureSets)),this._watchDisplayNameChanges(),this._watchIsModifiedChanges()):
(this.isBusy.set(!1),this._unwatchDisplayNameChanges(),this._unwatchIsModifiedChanges());null!=this.presentableResults&&this.presentableResults.numberOfItems.bind(this,this.updateHeaderText)};b.prototype.handleFeatureSetsChanged=function(a){a=this._featureSetsHaveFeatures(a.sender);this.hasFeatureSets.get()!==a&&this.hasFeatureSets.set(a)};b.prototype.updateHeaderText=function(a){var b=null,c="",e=!1;a&&(c=" ("+a+")");this.featureSetCollection.get()&&(b=this.featureSetCollection.get().displayName.get(),
e=this.featureSetCollection.get().isModified.get());this._count=a;a="{0}{1}{2}".format(b?b:this.app.getResource(this.libraryId,"language-common-results"),c,e?"*":"");this.headerText.set(a)};b.prototype._featureSetsHaveFeatures=function(a){if(a)for(var b=0;b<a.length();b++)if(a.getAt(b).features&&0<a.getAt(b).features.length()||a.getAt(b).esriFeatureSet&&a.getAt(b).esriFeatureSet.features&&0<a.getAt(b).esriFeatureSet.features.length)return!0;return!1};b.prototype._openFSC=function(a){this.featureSetCollection.get()&&
a&&a.featureSetCollectionId&&a.featureSetCollectionId==this.featureSetCollection.get().id&&(this.isBusy.set(!0),this.hasFeatureSets.set(!1),a=this.app.featureSetManager.getSearchSuggestion(this.featureSetCollection.get().sourceName),this.searchSuggestion.set(a?a:this.app.getResource(this.libraryId,"language-common-no-results-desc")))};b.prototype._closeFSC=function(a){this.featureSetCollection.get()&&a&&a.featureSetCollectionId&&a.featureSetCollectionId==this.featureSetCollection.get().id&&(this.isBusy.set(!1),
this.featureSetCollection.pulse())};b.prototype._removeFSC=function(a){this.featureSetCollection.get()&&a&&a.featureSetCollectionId&&a.featureSetCollectionId==this.featureSetCollection.get().id&&this.featureSetCollection.set(this._getEmptyFeatureSetCollection())};b.prototype._changeFSC=function(a){this.featureSetCollection.get()&&a&&a.featureSetCollectionId&&a.featureSetCollectionId==this.featureSetCollection.get().id&&this.featureSetCollection.pulse()};b.prototype._getEmptyFeatureSetCollection=function(){null==
this._emptyFeatureSetCollection?this._emptyFeatureSetCollection=new l.FeatureSetCollection:this._emptyFeatureSetCollection.clear();return this._emptyFeatureSetCollection};b.prototype.registerCommands=function(){var a=this;this.app.command("ShowResultsListFeatureAction").register(this,function(b){a.currentFeature.set(b);a.getResultsFeatureActions();a.app.command("ActivateView").execute("ResultsFeatureActionsView")});this.app.command("RemoveUserAddedLayer").register(this,function(b){if(a.featureSetCollection.get()){for(var c=
a.featureSetCollection.get().featureSets.get(),e=a.featureSetCollection.get(),f=0;f<c.length;f++)if(c[f].layer===b){e.featureSets.removeItem(c[f]);break}a.featureSetCollection.set(e)}});this.app.command("ClearSelection").register(this,function(){a.app.command("RemoveFeatureSetCollection").execute(a.featureSetCollection.get())})};b.prototype.getResultsFeatureActions=function(){this.featureActions.clear();var a=this.app.menuRegistry.getMenu("ResultsListFeatureAction");this.app.menuRegistry.getDefaultIconUri("ResultsListFeatureAction");
if(a)this.featureActions.addItems(a.items);else throw Error("Results Feature Actions not found");};b.prototype._pulseFeatureSetsInCollection=function(){this.featureSetCollection&&this.featureSetCollection.get()&&this.featureSetCollection.get().featureSets&&0<this.featureSetCollection.get().featureSets.length()&&this.featureSetCollection.get().featureSets.pulse()};b.prototype._watchDisplayNameChanges=function(){var a=this;this._unwatchDisplayNameChanges();var b=this.featureSetCollection.get()?this.featureSetCollection.get().displayName:
null;if(!b)return null;var c=b.bind(this,function(){return a.updateHeaderText(a._count)}),e={remove:function(){return b.unbind(c)}};this._watchHandles.set("displayName",e);return e};b.prototype._unwatchDisplayNameChanges=function(){var a=this._watchHandles.get("displayName");a&&a.remove();this._watchHandles.remove("displayName")};b.prototype._watchIsModifiedChanges=function(){var a=this;this._unwatchIsModifiedChanges();var b=this.featureSetCollection.get()?this.featureSetCollection.get().isModified:
null;if(!b)return null;var c=b.bind(this,function(){return a.updateHeaderText(a._count)}),e={remove:function(){return b.unbind(c)}};this._watchHandles.set("isModified",e);return e};b.prototype._unwatchIsModifiedChanges=function(){var a=this._watchHandles.get("isModified");a&&a.remove();this._watchHandles.remove("isModified")};return b}(k.ViewModelBase);f.ResultsViewModel=h});
define("infrastructure/results/ResultsUtils",["require","exports"],function(h,f){function k(b,d){var g=b?b.firstElementChild:null;g&&g.classList.contains(c)&&(d.app.event("FlyoutDeactivated").publish(d),g.classList.remove(a),g.classList.remove(c),g.classList.add(e))}function l(b,d,g,f){if((b=b?b.firstElementChild:null)&&b.classList.contains(e)){b.classList.remove(e);b.classList.add(c);var h;d&&b?(h=d.getBoundingClientRect(),h=b.getBoundingClientRect().bottom<=h.bottom):h=!0;if(h=!h)d&&b?(d=d.getBoundingClientRect(),
h=b.getBoundingClientRect(),h=d.top<=h.top-h.height-g.clientHeight):h=!0;h&&b.classList.add(a);f.app.event("FlyoutActivated").publish(f)}}var e="bound-invisible",c="bound-visible",a="inline-menu-open-up";f.showResultsStatusMessage=function(a,d){d&&0<d?a.command("AddResultsStatus").execute(d+" "+a.getResource("Mapping.Infrastructure","language-common-results-found")):a.command("AddResultsStatus").execute(a.getResource("Mapping.Infrastructure","language-common-no-results"))};f.handleInlineMenuActionClick=
function(a,d,c,f,h){a=d.parentElement;c&&c!==a&&k(c,h);(c=a)&&c.firstElementChild&&(c?c.firstElementChild:null).classList.contains(e)?(a={view:h,onOtherInteracted:function(a){k(c,h)},onElementInteracted:function(a){($(a.srcElement||a.target).hasClass("gcx-list-menu")||$(a.srcElement||a.target).hasClass("paging-buttons"))&&k(c,h)}},h.app.command("TapToDismiss").execute(a),l(c,f,d,h)):k(c,h)}});
define("infrastructure/results/FeatureSetCollectionResultsViewModel","require exports infrastructure/results/ResultsViewModel geocortex/framework/observables infrastructure/FeatureSetCollection infrastructure/eventArgs/FeatureSetManagerEventArgs infrastructure/commandArgs/AddStatusArgs infrastructure/results/ResultsUtils".split(" "),function(h,f,k,l,e,c,a,b){h=function(d){function g(a,c){var e=d.call(this,a,c)||this;e.isViewActive=new l.Observable(!1);e._automaticDrillIn=!0;e._featureSetsBindingToken=
null;e._boundFeatureSetCollection=null;e._featureViewMap={};e._featureSetsLoadTimer=0;e._performAutomaticDrillInDelay=300;e._loadingMessageDismissed=!1;e.detectAutomaticDrillInDelay=null;e.featureSets=new l.ObservableCollection;e.searchSuggestion=new l.Observable(e.app.getResource(e.libraryId,"language-common-no-results-desc"));e.app.command("ShowResultsList").register(e,e._showResultsList);e.app.command("SwitchToTabularResultsView").register(e,e._switchToTabularResultsViewImpl,e._canExecuteSwitchToTabularResultsView);
e.app.command("RemoveFeatureSetFromResults").register(e,e._executeRemoveFeatureSetFromResults,e._canRemoveFeatureSetFromResults);e.isViewActive.bind(e,function(a){e._featuresInCollectionCount&&e.updateHeaderText(e._featuresInCollectionCount)});e.featureSets.bind(e,function(a){e.app.event("_underlyingFeatureSetsChanged").publish(a)});e.isBusy.bind(e,function(a){a?e.isViewActive.get()&&(e.detectAutomaticDrillInDelay&&e._startAutomaticDrillInTimer(),e._showLoadingMessage()):(e._loadingMessageDismissed=
!1,e.isViewActive.get()&&(b.showResultsStatusMessage(e.app,e.featureSetCollection.get().countFeatures()),e.detectAutomaticDrillInDelay&&(e._clearAutomaticDrillInTimer(),e._tryAutomaticDrillIn())))});return e}__extends(g,d);g.prototype.handleCollectionChanged=function(a){d.prototype.handleCollectionChanged.call(this,a);this._clearResetUnderlyingCollection(!0);if(a&&a.featureSets){this._featureSetsBindingToken=a.featureSets.bind(this,this.handleFeatureSetsChanged);this._boundFeatureSetCollection=a;
for(var b=0,c=a.featureSets.length();b<c;b++)0>=a.featureSets.getAt(b).features.length()||this.featureSets.addItem(a.featureSets.getAt(b))}};g.prototype._showLoadingMessage=function(){this._loadingMessageDismissed||this.app.command("AddResultsStatus").execute(new a.AddStatusArgs(this.app.getResource(this.libraryId,"language-common-loading-results"),null,this._onLoadingMessageDismissed))};g.prototype._onLoadingMessageDismissed=function(){this._loadingMessageDismissed=!0};g.prototype._startAutomaticDrillInTimer=
function(){var a=this;this._automaticDrillIn=!0;this._featureSetsLoadTimer||(this._featureSetsLoadTimer=setTimeout(function(){a._automaticDrillIn=!1},this.detectAutomaticDrillInDelay))};g.prototype._clearAutomaticDrillInTimer=function(){this._featureSetsLoadTimer&&(clearTimeout(this._featureSetsLoadTimer),this._featureSetsLoadTimer=0)};g.prototype._tryAutomaticDrillIn=function(){var a=this;this._automaticDrillIn&&1===this.featureSets.length()&&setTimeout(function(){a._performAutomaticDrillIn()},this._performAutomaticDrillInDelay)};
g.prototype._performAutomaticDrillIn=function(){1===this.featureSets.length()&&(this.app.command("RemoveResultsStatus").execute(),this.app.event("FeatureSetClickedEvent").publish(this.featureSets.getAt(0)))};g.prototype.updateHeaderText=function(a){this.isViewActive.get()?(d.prototype.updateHeaderText.call(this,a),this._featuresInCollectionCount=null):(this._featuresInCollectionCount=a,d.prototype.updateHeaderText.call(this,0))};g.prototype._destroyViewForToken=function(a){if(a&&this._featureViewMap.hasOwnProperty(a)){var b=
this._featureViewMap[a];b&&(this.app.viewManager.destroyView(b),delete this._featureViewMap[a])}};g.prototype._showResultsList=function(a){(a=this._loadFeatureSetCollection(a))&&this.app.command("_setResultMappingCommand").execute(a.sourceName,"ShowResultsList")};g.prototype._loadFeatureSetCollection=function(a){if("string"===typeof a)a=this.app.featureSetManager.getCollectionById(a);else if(!(a instanceof e.FeatureSetCollection))return;a&&a!==this.featureSetCollection.get()&&(this._clearResetUnderlyingCollection(!0),
this.featureSetCollection.set(a));return a};g.prototype._switchToTabularResultsViewImpl=function(){this.app.command("ShowResultsTable").execute(this.featureSetCollection.get())};g.prototype._canExecuteSwitchToTabularResultsView=function(){return!!this.featureSetCollection.get()};g.prototype._executeRemoveFeatureSetFromResults=function(a){if(this._canRemoveFeatureSetFromResults(a))return this._removeFeatureSetFromResults(a)};g.prototype._canRemoveFeatureSetFromResults=function(a){var b=this._boundFeatureSetCollection;
return b&&a?this._existsInCollection(a,b):!1};g.prototype._removeFeatureSetFromResults=function(a){var b=null;if(a&&this._boundFeatureSetCollection){for(var d=0;d<this._boundFeatureSetCollection.featureSets.getLength();d++)a.id===this._boundFeatureSetCollection.featureSets.getAt(d).id&&(b=d,this._boundFeatureSetCollection.featureSets.removeAt(d));null!=b&&this._notifyFeatureSetCollectionChanged(b);a=this.getResource("language-common-results-removed-confirmation").format(a.features.length(),this._boundFeatureSetCollection.displayName.get());
this.app.command("AddResultsStatus").execute(a)}};g.prototype._existsInCollection=function(a,b){if(!a)return!1;if(!b)throw Error("FeatureSetCollection is required");for(var d=0;d<b.featureSets.getLength();d++)if(a.id===b.featureSets.getAt(d).id)return!0;return!1};g.prototype._notifyFeatureSetCollectionChanged=function(a){a=new c.FeatureSetManagerEventArgs({sender:this,featureSetCollection:this._boundFeatureSetCollection,featureSetCollectionId:this._boundFeatureSetCollection.id,collectionChangedEventArgs:{sender:this._boundFeatureSetCollection.featureSets,
type:"remove",rangeStart:a,rangeEnd:a}});this.app.event("FSMCollectionChangedEvent").publish(a)};g.prototype.getFeatureView=function(a){return this._featureViewMap[a]};g.prototype.setFeatureView=function(a,b){this._featureViewMap[a]=b};g.prototype.unbindFeatureSet=function(){this._featureSetsBindingToken&&this._boundFeatureSetCollection&&(this._boundFeatureSetCollection.featureSets.unbind(this._featureSetsBindingToken),this._boundFeatureSetCollection=this._featureSetsBindingToken=null)};g.prototype.exportState=
function(a){var b=this.featureSetCollection.get();a.results=this.app.project.convert.fromGcxFeatureSetCollection(b);a.viewMode="grouplist"};g.prototype.applyState=function(a){var b=this;a.promises.push(this.app.project.convert.toGcxFeatureSetCollection(a.state.results).then(function(d){d&&(b._loadFeatureSetCollection(d),"grouplist"!==a.state.viewMode&&"list"!==a.state.viewMode||b.app.command("_setResultMappingCommand").execute(d.sourceName,"ShowResultsList"))}))};g.prototype._pulseFeatureSetsInCollection=
function(){d.prototype._pulseFeatureSetsInCollection.call(this)};g.prototype._clearResetUnderlyingCollection=function(a){this.featureSets.clear();a&&(this.unbindFeatureSet(),this._featureViewMap={})};return g}(k.ResultsViewModel);f.FeatureSetCollectionResultsViewModel=h});
define("infrastructure/results/FeatureSetCollectionResultsView",["require","exports","infrastructure/results/ResultsViewBase","infrastructure/results/ResultsUtils"],function(h,f,k,l){h=function(e){function c(a,b){var d=e.call(this,a,b)||this;d._invisibleClassName="bound-invisible";d._visibleClassName="bound-visible";d._openUpActionsMenuClassName="inline-menu-open-up";d._defaultDetectAutomaticDrillInDelay=300;d._subscriptions=null;d.app.command("ShowResultsList").register(d,d.showResultsList);d.app.command("ShowResultsTable").register(d,
d._handleShowResultsTable,function(){return!d.app.configuration.mobileMode});d.app.command("SwitchToTabularResultsView").register(d,d._switchToTabularResultsViewImpl,d._canExecuteSwitchToTabularResultsView);d.app.command("_ExportResultsViewState").register(d,d._exportState);d.app.command("_ClearIsSelected").register(d,d._clearIsSelected);d.app.command("_ApplyResultsViewState").register(d,d._applyState);d.app.event("ViewContainerViewClosedEvent").subscribe(d,function(a){a.viewId===d.id&&!1!==d.configuration.clearCollectionOnClose&&
d.viewModel.featureSetCollection.get().clear()});return d}__extends(c,e);c.prototype.activated=function(){this.app.command("HideFeatureSetResultsView").execute();e.prototype.activated.call(this);this._unsubscribeFromEvents();if("DataFrameResultsContainerRegion"===this.regionName||"DataRegion"===this.regionName){var a=this.app.event("DataFrameOpenedEvent").subscribe(this,this._dataFrameOpenedEventHandler),b=this.app.event("DataFrameClosedEvent").subscribe(this,this._dataFrameClosedEventHandler);this._subscriptions=
[{eventName:"DataFrameOpenedEvent",token:a},{eventName:"DataFrameClosedEvent",token:b}]}if(this.resultsList){var d=this.resultsList;setTimeout(function(){dojo.style(d,{display:"block"})},1)}this.app.project.isLoading||this.viewModel.featureSetCollection.get().featureSets.get().forEach(function(a){a.isSelectedInCollection.set(!1)});this.viewModel.isViewActive.set(!0)};c.prototype.deactivated=function(){e.prototype.deactivated.call(this);this.viewModel.isViewActive.set(!1);this.app.command("RemoveResultsStatus").execute();
this._unsubscribeFromEvents()};c.prototype.attach=function(a){if(this.configuration.automaticDrillInDelay){var b=this.configuration.automaticDrillInDelay;0>b&&(b=this._defaultDetectAutomaticDrillInDelay);a.detectAutomaticDrillInDelay=b}this.title.sync(a.headerText);this.isBusy.sync(a.isBusy);e.prototype.attach.call(this,a)};c.prototype.showResultsList=function(a){this.app.viewManager.activateView(this)};c.prototype.getDescription=function(a,b,d){b.title=d.description.get()};c.prototype.scrollViewTop=
function(a){this.scrollContainerElement&&(this.scrollContainerElement.scrollTop=a||0)};c.prototype.handleFeatureSetCollectionFeatureSetActionsClick=function(a,b,d){l.handleInlineMenuActionClick(a,b,this.currentActiveFeatureSetElement,this.scrollContainerElement,this);this.currentActiveFeatureSetElement=b.parentElement};c.prototype.resolveWidget=function(a,b,d){e.prototype.resolveWidget.call(this,a,b);switch(a){case "FeatureSetCollectionActionsWidget":case "FeatureSetActionsWidget":if(b=this.app.menuRegistry.createMenuWidget(this,
b,d))return b;break;case "GetFeatureSetLabel":return a=this.app.viewManager.createView({markupResource:"Mapping/infrastructure/results/FeatureSetCollectionResultsLabelView.html",typeName:"geocortex.essentialsHtmlViewer.mapping.infrastructure.results.FeatureSetCollectionResultsLabelView"}),a.attach(b),a}};c.prototype._handleShowResultsTable=function(){this.app.viewManager.deactivateView(this)};c.prototype._switchToTabularResultsViewImpl=function(){this.app.command("CloseDataFrame").execute()};c.prototype._canExecuteSwitchToTabularResultsView=
function(){return this.isActive&&!this.app.configuration.mobileMode};c.prototype._dataFrameOpenedEventHandler=function(){this.isContainerCollapsed||this.app.event("ResultsViewOpenedEvent").publish(this)};c.prototype._dataFrameClosedEventHandler=function(){this.isContainerCollapsed||this.app.event("ResultsViewCollapsedEvent").publish(this)};c.prototype._unsubscribeFromEvents=function(){if(this._subscriptions)for(var a=0;a<this._subscriptions.length;a++){var b=this._subscriptions[a];this.app.event(b.eventName).unsubscribe(b.token)}this._subscriptions=
null};c.prototype._exportState=function(a){this.isActive&&this.viewModel.exportState(a)};c.prototype._clearIsSelected=function(){this.viewModel&&this.viewModel.featureSetCollection.get()&&this.viewModel.featureSetCollection.get().featureSets.get()&&0<this.viewModel.featureSetCollection.get().featureSets.get().length&&this.viewModel.featureSetCollection.get().featureSets.get().forEach(function(a){a.isSelectedInCollection.set(!1)})};c.prototype._applyState=function(a){this.viewModel.applyState(a)};
return c}(k.ResultsViewBase);f.FeatureSetCollectionResultsView=h});
define("infrastructure/results/FeatureSetResultsViewModel","require exports infrastructure/results/ResultsViewModel geocortex/framework-ui/ObservableCollectionAggregator geocortex/framework/observables geocortex/framework-ui/PresentableCollection infrastructure/eventArgs/ResultsPageChangedEventArgs geocortex/framework/utils/utils infrastructure/FeatureSet".split(" "),function(h,f,k,l,e,c,a,b,d){h=function(g){function f(a,b){var m=g.call(this,a,b)||this;m.pageControlsEnabled=new e.Observable(!1);m.resultsList=
new e.Observable("results-list");m.pagingControlClassName=new e.Observable("paging-control no-pages");m.contentField=new e.Observable("description");m._featureViewMap={};m.featureSet=new e.Observable(new d.FeatureSet);m.results=new l.ObservableCollectionAggregator(new e.ObservableCollection);m.presentableResults=new c.PresentableCollection(m.results);m.presentableResults.items.useThrottling=!0;m.resultsPage=m.presentableResults.items;m.presentableResults.pageSize.set(m.defaultPageSize);m.defaultIsPaged!=
m.presentableResults.isPaginated.get()&&m.presentableResults.isPaginated.set(m.defaultIsPaged);m.app.command("ShowFeatureSetResultsView").register(m,m.showFeaturesList,function(a){return!!m.app.featureSetManager.findFeatureSetByUniqueId(a.uniqueId)});return m}__extends(f,g);f.prototype._updateHeaderText=function(a){var b=null,d="";a&&(d=" ("+a+")");this.featureSet.get()&&(b=this.featureSet.get().displayName.get());a="{0}{1}".format(b?b:this.app.getResource(this.libraryId,"language-common-results"),
d);this.headerText.set(a)};f.prototype.subscribeEvents=function(){};f.prototype.handlePageResultsChange=function(b){var d=this;b=b?b:{type:null};if("clear"===b.type)Object.keys(this._featureViewMap).map(function(a){return d._featureViewMap[a]}).forEach(function(a){return d.app.viewManager.destroyView(a)}),this._featureViewMap={};else if("remove"===b.type&&b.sender.value.length>b.rangeStart){var c=b.sender.getAt(b.rangeStart);this._destroyViewForToken(c.token);this._destroyViewForToken(c.token+"-label")}b=
"clear"===b.type||"remove"===b.type&&1>=b.sender.value.length;c=new a.ResultsPageChangedEventArgs;c.featureSetCollection=this.app.featureSetManager.findOpenFeatureSetCollectionByFeatureSetUniqueId(this.featureSet.get().uniqueId);c.newValue=b?new e.ObservableCollection:this.resultsPage;this.app.event("ResultsPageChangedEvent").publish(c);this.app.behavior("ResultsPageChangedBehavior").run(c.newValue.get())};f.prototype.handleFeatureChanged=function(a){if(a&&this._featureViewMap.hasOwnProperty(a.token)){var b=
this._featureViewMap[a.token],d=this._featureViewMap[a.token+"-label"];d.destroyBindings();b.destroyBindings();d.attach(a);b.attach(a)}};f.prototype._destroyViewForToken=function(a){if(a&&this._featureViewMap.hasOwnProperty(a)){var b=this._featureViewMap[a];b&&(this.app.viewManager.destroyView(b),delete this._featureViewMap[a])}};f.prototype.showFeaturesList=function(a){this._clearResetUnderlyingCollection();this.results.getCollectionSource().addItem(a.features);a&&a!==this.featureSet.get()?(this.featureSet.set(a),
this._updateHeaderText(a.features.length())):this.handlePageResultsChange();this._presentableResultsNumberOfItemsBindingToken||(this._presentableResultsNumberOfItemsBindingToken=this.presentableResults.numberOfItems.bind(this,this._updateHeaderText))};f.prototype.clearCurrentHighlights=function(){var a=this.featureSet.get();a&&a.esriFeatureSet&&this.app.command("ClearFeatureHighlight").execute(a.esriFeatureSet.features)};f.prototype._clearSpecificHighlight=function(a){this.app.command("ClearFeatureHighlight").execute(a)};
f.prototype.getFeatureView=function(a){return this._featureViewMap[a]};f.prototype.setFeatureView=function(a,b){this._featureViewMap[a]=b};f.prototype.exportState=function(a){var b=this.app.project.convert.fromGcxFeatureSet(this.featureSet.get());a.openedFeatureSet=b;a.page=this.presentableResults.currPageNumber.get()};f.prototype.applyState=function(a){var d=this;"list"!==a.state.viewMode&&a.promises.push(this.app.project.convert.toGcxFeatureSet(a.state.openedFeatureSet).then(function(c){c&&(d.showFeaturesList(c),
b.isNullOrUndefined(a.state.page)||d.presentableResults.currPageNumber.set(a.state.page))}))};f.prototype._hideIfNoFeaturesLeft=function(a){if(this.featureSet.get()&&this.featureSet.get().features.get()){var b=this.featureSet.get().features.get();if(0===b.length)this._clearSpecificHighlight(a);else if(1===b.length&&a.featureSet&&a.featureSet.id===this.featureSet.get().id)this.clearCurrentHighlights();else return;this.app.command("HideFeatureSetResultsView").execute();this.featureSet.set(null)}};f.prototype._pulseUnderlyingCollection=
function(){var a=this.presentableResults.currPageNumber.get();this.results.getCollectionSource().pulse();this.presentableResults.currPageNumber.set(a)};f.prototype._clearResetUnderlyingCollection=function(){this.results.getCollectionSource().clear();this.presentableResults.currPageNumber.set(1);this._featureViewMap={}};f.prototype.updateHeaderText=function(a){};f.prototype.bindUnderlyingCollection=function(){this._bindObservables();this._pulseUnderlyingCollection()};f.prototype.unbindUndelryingCollection=
function(){this._unbindObservables()};f.prototype._bindObservables=function(){var a=this;this._resultsPageBindingToken||(this._resultsPageBindingToken=this.resultsPage.bind(this,this.handlePageResultsChange));this._presentableResultsBindingToken||(this._presentableResultsBindingToken=this.presentableResults.numberOfItems.bind(this,function(b){0<b?a.pagingControlClassName.set("paging-control has-pages"):a.pagingControlClassName.set("paging-control no-pages");a._updateHeaderText(b)}))};f.prototype._unbindObservables=
function(){this._resultsPageBindingToken&&(this.resultsPage.unbind(this._resultsPageBindingToken),this._resultsPageBindingToken=null);this._presentableResultsBindingToken&&(this.presentableResults.numberOfItems.unbind(this._presentableResultsBindingToken),this._presentableResultsBindingToken=null)};f.prototype.subscribeToEvents=function(){this._featureChangedEventSubscriptionToken||(this._featureChangedEventSubscriptionToken=this.app.event("FeatureChangedEvent").subscribe(this,this.handleFeatureChanged));
this._underlyingFeatureSetsChangedSubscriptionToken||(this._underlyingFeatureSetsChangedSubscriptionToken=this.app.event("_underlyingFeatureSetsChanged").subscribe(this,this._pulseUnderlyingCollection));this._featureRemovedFromResultsSubscriptionToken||(this._featureRemovedFromResultsSubscriptionToken=this.app.event("_featureRemovedFromResults").subscribe(this,this._hideIfNoFeaturesLeft));this._featureDeletedEventSubscriptionToken||(this._featureDeletedEventSubscriptionToken=this.app.event("FeatureDeletedEvent").subscribe(this,
this._hideIfNoFeaturesLeft))};f.prototype.unsubscribeFromEvents=function(){this._featureChangedEventSubscriptionToken&&(this.app.event("FeatureChangedEvent").unsubscribe(this._featureChangedEventSubscriptionToken),this._featureChangedEventSubscriptionToken=null);this._underlyingFeatureSetsChangedSubscriptionToken&&(this.app.event("_underlyingFeatureSetsChanged").unsubscribe(this._underlyingFeatureSetsChangedSubscriptionToken),this._underlyingFeatureSetsChangedSubscriptionToken=null);this._featureRemovedFromResultsSubscriptionToken&&
(this.app.event("_featureRemovedFromResults").unsubscribe(this._featureRemovedFromResultsSubscriptionToken),this._featureRemovedFromResultsSubscriptionToken=null);this._featureDeletedEventSubscriptionToken&&(this.app.event("FeatureDeletedEvent").unsubscribe(this._featureDeletedEventSubscriptionToken),this._featureDeletedEventSubscriptionToken=null)};return f}(k.ResultsViewModel);f.FeatureSetResultsViewModel=h});
define("infrastructure/results/FeatureSetResultsView",["require","exports","infrastructure/results/ResultsViewBase","infrastructure/FeatureDescriptionPresenterView","infrastructure/results/ResultsUtils"],function(h,f,k,l,e){h=function(c){function a(a,d){var e=c.call(this,a,d)||this;e._invisibleClassName="bound-invisible";e._visibleClassName="bound-visible";e._openUpActionsMenuClassName="inline-menu-open-up";e.featureClickedEventName="ResultsListFeatureClickedEvent";e.featurePressedEventName="ResultsListFeaturePressedEvent";
e.featureHoveredEventName="ResultsListFeatureHoveredEvent";e.featureHoverEndEventName="ResultsListFeatureHoverEndedEvent";e.itemClass="gcx-list-item";e._subscriptions=null;e._scrollTop=0;e.app.command("ShowFeatureSetResultsView").register(e,e._showFeaturesList,function(a){return!!e.app.featureSetManager.findFeatureSetByUniqueId(a.uniqueId)});e.app.command("HideFeatureSetResultsView").register(e,e._hideFeatureSetResults);e.app.command("ShowResultsTable").register(e,e._handleShowResultsTable,function(){return!e.app.configuration.mobileMode});
e.app.command("_ExportResultsViewState").register(e,e._exportState);e.app.command("_ApplyResultsViewState").register(e,e._applyState);return e}__extends(a,c);a.prototype.activated=function(){var a=this;if(this.viewModel.featureSet.get()&&this.viewModel.featureSet.get().features.get()&&0===this.viewModel.featureSet.get().features.get().length)var d=this.app.event("ViewActivatedEvent").subscribe(this,function(c){c.id===a.id&&(a.app.viewManager.deactivateView(a),a.app.event("ViewActivatedEvent").unsubscribe(d),
d=null)});else if(!this.isActive){c.prototype.activated.call(this);this.viewModel.clearCurrentHighlights();"all"!==this._highlightMode?this.app.behavior("ResultsPageChangedBehavior").run(this.viewModel.resultsPage.get()):this.app.behavior("AllResultsPageChangedBehavior").run(this.viewModel.featureSet.get());this._unsubscribeFromEvents();if("DataFrameResultsContainerRegion"===this.regionName||"DataRegion"===this.regionName){var e=this.app.event("DataFrameOpenedEvent").subscribe(this,this._dataFrameOpenedEventHandler),
f=this.app.event("DataFrameClosedEvent").subscribe(this,this._dataFrameClosedEventHandler);this._subscriptions=[{eventName:"DataFrameOpenedEvent",token:e},{eventName:"DataFrameClosedEvent",token:f}]}if(this.resultsList){var h=this.resultsList;setTimeout(function(){dojo.style(h,{display:"block"})},1)}this._viewModelFSCBindingToken||(this._viewModelFSCBindingToken=this.viewModel.featureSetCollection.bind(this,function(d){a.app.trace.debug("View focused in results list: "+a.id);a.app.command("FocusOnFirstInputInView").execute(a)}));
this.app.command("RemoveResultsStatus").execute();this.viewModel.subscribeToEvents();this.viewModel.bindUnderlyingCollection()}};a.prototype.deactivated=function(){c.prototype.deactivated.call(this);this.isActive=!1;this.viewModel.clearCurrentHighlights();this.viewModel.unbindUndelryingCollection();this._viewModelFSCBindingToken&&(this.viewModel.featureSetCollection.unbind(this._viewModelFSCBindingToken),this._viewModelFSCBindingToken=null);this.viewModel.unsubscribeFromEvents();this._unsubscribeFromEvents()};
a.prototype.attach=function(a){var d=this;this.title.sync(a.headerText);void 0!=this.configuration.highlightMode&&(this._highlightMode=this.configuration.highlightMode);void 0!=this.configuration.isPaged&&a.presentableResults.isPaginated.set(this.configuration.isPaged);this.configuration.pageSize&&a.presentableResults.pageSize.set(this.configuration.pageSize);this.configuration.contentField&&a.contentField.set(this.configuration.contentField);a.presentableResults.currPageNumber.bindingEvent.subscribe(this,
function(){d.scrollViewTop()});this.scrollViewTop(this._scrollTop);c.prototype.attach.call(this,a)};a.prototype._showFeaturesList=function(a){this.viewModel.featureSet.get()&&this.viewModel.featureSet.get().isSelectedInCollection.set(!0);this.app.viewManager.activateView(this)};a.prototype.handlePageFirst=function(a,d,c){1<this.viewModel.presentableResults.currPageNumber.get()&&("all"!==this._highlightMode&&this.viewModel.clearCurrentHighlights(),this.viewModel.presentableResults.currPageNumber.set(1))};
a.prototype.handlePagePrev=function(a,d,c){1<this.viewModel.presentableResults.currPageNumber.get()&&("all"!==this._highlightMode&&this.viewModel.clearCurrentHighlights(),this.viewModel.presentableResults.currPageNumber.set(this.viewModel.presentableResults.currPageNumber.get()-1))};a.prototype.handlePageNext=function(a,d,c){this.viewModel.presentableResults.lastPageNumber.get()>this.viewModel.presentableResults.currPageNumber.get()&&("all"!==this._highlightMode&&this.viewModel.clearCurrentHighlights(),
this.viewModel.presentableResults.currPageNumber.set(this.viewModel.presentableResults.currPageNumber.get()+1))};a.prototype.handlePageLast=function(a,d,c){this.viewModel.presentableResults.currPageNumber.get()<this.viewModel.presentableResults.lastPageNumber.get()&&("all"!==this._highlightMode&&this.viewModel.clearCurrentHighlights(),this.viewModel.presentableResults.currPageNumber.set(this.viewModel.presentableResults.lastPageNumber.get()))};a.prototype.handleScrollChange=function(a,d,c){c&&(this._scrollTop=
d.scrollTop)};a.prototype.getDescription=function(a,d,c){d.title=c.description.get()};a.prototype.scrollViewTop=function(a){this.scrollContainerElement&&(this.scrollContainerElement.scrollTop=a||0)};a.prototype.resolveWidget=function(a,d,e){c.prototype.resolveWidget.call(this,a,d);switch(a){case "GetLabel":return a=new l.FeatureDescriptionPresenterView(this.app,this.libraryId),a.contentField="label",a.root=dojo.create("div"),a.root.className="feature-label",a.attach(d),this.viewModel.setFeatureView(d.token+
"-label",a),a;case "GetDescription":return a=new l.FeatureDescriptionPresenterView(this.app,this.libraryId),a.contentField=this.viewModel.contentField.get(),a.root=dojo.create("div"),a.root.className="feature-description",a.attach(d),this.viewModel.setFeatureView(d.token,a),a;case "FeatureSetActionsWidget":case "FeatureActionsWidget":if(d=this.app.menuRegistry.createMenuWidget(this,d,e))return d}};a.prototype._handleShowResultsTable=function(){this._hideFeatureSetResults()};a.prototype._dataFrameOpenedEventHandler=
function(){this.isContainerCollapsed||this.app.event("ResultsViewOpenedEvent").publish(this)};a.prototype._dataFrameClosedEventHandler=function(){this.isContainerCollapsed||this.app.event("ResultsViewCollapsedEvent").publish(this)};a.prototype._unsubscribeFromEvents=function(){if(this._subscriptions)for(var a=0;a<this._subscriptions.length;a++){var d=this._subscriptions[a];this.app.event(d.eventName).unsubscribe(d.token)}this._subscriptions=null};a.prototype._exportState=function(a){this.isActive&&
this.viewModel.exportState(a)};a.prototype._applyState=function(a){this.viewModel.applyState(a)};a.prototype._hideFeatureSetResults=function(){this.isActive&&this.app.viewManager.deactivateView(this)};a.prototype.handleFeatureSetFeatureActionClick=function(a,d,c){e.handleInlineMenuActionClick(a,d,this.currentActiveFeatureElement,this.scrollContainerElement,this);this.currentActiveFeatureElement=d.parentElement};return a}(k.ResultsViewBase);f.FeatureSetResultsView=h});
define("infrastructure/results/FlatResultsViewModel","require exports infrastructure/results/ResultsViewModel geocortex/framework-ui/ObservableCollectionAggregator geocortex/framework/observables geocortex/framework-ui/PresentableCollection infrastructure/eventArgs/ResultsPageChangedEventArgs geocortex/framework/utils/utils".split(" "),function(h,f,k,l,e,c,a,b){h=function(d){function g(a,b){var g=d.call(this,a,b)||this;g.pageControlsEnabled=new e.Observable(!1);g.resultsList=new e.Observable("results-list");
g.pagingControlClassName=new e.Observable("paging-control no-pages");g.contentField=new e.Observable("description");g._featureSetsBindingToken=null;g._boundFeatureSetCollection=null;g._featureViewMap={};g.results=new l.ObservableCollectionAggregator(new e.ObservableCollection);g.presentableResults=new c.PresentableCollection(g.results);g.presentableResults.items.useThrottling=!0;g.resultsPage=g.presentableResults.items;g.presentableResults.pageSize.set(g.defaultPageSize);g.defaultIsPaged!=g.presentableResults.isPaginated.get()&&
g.presentableResults.isPaginated.set(g.defaultIsPaged);g.app.command("ShowResultsList").register(g,g.showResultsList);g.app.command("SwitchToTabularResultsView").register(g,g._switchToTabularResultsViewImpl,g._canExecuteSwitchToTabularResultsView);return g}__extends(g,d);g.prototype.subscribeEvents=function(){d.prototype.subscribeEvents.call(this);this.app.event("FeatureChangedEvent").subscribe(this,this.handleFeatureChanged)};g.prototype.handleCollectionChanged=function(a){d.prototype.handleCollectionChanged.call(this,
a);this._clearResetUnderlyingCollection(!0);if(a&&a.featureSets){this._featureSetsBindingToken=a.featureSets.bind(this,this.handleFeatureSetsChanged);this._boundFeatureSetCollection=a;for(var b=this.results.getCollectionSource(),c=0,e=a.featureSets.length();c<e;c++)b.addItem(a.featureSets.getAt(c).features)}};g.prototype.handleFeatureSetsChanged=function(a){d.prototype.handleFeatureSetsChanged.call(this,a);var b=this.results.getCollectionSource();if("append"===a.type){var c=a.sender.getRange(a.rangeStart,
a.rangeEnd);for(a=0;a<c.length;a++)b.addItem(c[a].features)}else if("remove"===a.type)for(c=a.sender.getRange(a.rangeStart,a.rangeEnd),a=0;a<c.length;a++)b.removeItem(c[a].features);else"clear"===a.type&&(this._clearResetUnderlyingCollection(!1),this.results.bindingEvent.publish(a))};g.prototype.handlePageResultsChange=function(b){var d=this;b=b?b:{type:null};if("clear"===b.type)Object.keys(this._featureViewMap).map(function(a){return d._featureViewMap[a]}).forEach(function(a){return d.app.viewManager.destroyView(a)}),
this._featureViewMap={};else if("remove"===b.type&&b.sender.value.length>b.rangeStart){var c=b.sender.getAt(b.rangeStart);this._destroyViewForToken(c.token);this._destroyViewForToken(c.token+"-label")}b="clear"===b.type||"remove"===b.type&&1>=b.sender.value.length;c=new a.ResultsPageChangedEventArgs;c.featureSetCollection=this.featureSetCollection.get();c.newValue=b?new e.ObservableCollection:this.resultsPage;this.app.event("ResultsPageChangedEvent").publish(c);this.app.behavior("ResultsPageChangedBehavior").run(c.newValue.get())};
g.prototype.handleFeatureChanged=function(a){if(a&&this._featureViewMap.hasOwnProperty(a.token)){var b=this._featureViewMap[a.token],d=this._featureViewMap[a.token+"-label"];d.destroyBindings();b.destroyBindings();d.attach(a);b.attach(a)}};g.prototype._destroyViewForToken=function(a){if(a&&this._featureViewMap.hasOwnProperty(a)){var b=this._featureViewMap[a];b&&(this.app.viewManager.destroyView(b),delete this._featureViewMap[a])}};g.prototype.showResultsList=function(a){(a="string"===typeof a?this.app.featureSetManager.getCollectionById(a):
a)&&a!==this.featureSetCollection.get()?(this.unbindFeatureSet(),this.featureSetCollection.set(a)):this.handlePageResultsChange();this.app.command("_setResultMappingCommand").execute(a.sourceName,"ShowResultsList");this.presentableResults.numberOfItems.bind(this,this.updateHeaderText)};g.prototype.clearCurrentHighlights=function(){if(this.featureSetCollection.get()){var a=this.presentableResults.items.get();this.app.command("ClearFeatureHighlight").execute(a)}};g.prototype._switchToTabularResultsViewImpl=
function(){this.app.command("ShowResultsTable").execute(this.featureSetCollection.get())};g.prototype._canExecuteSwitchToTabularResultsView=function(){return!!this.featureSetCollection.get()};g.prototype.getFeatureView=function(a){return this._featureViewMap[a]};g.prototype.setFeatureView=function(a,b){this._featureViewMap[a]=b};g.prototype.unbindFeatureSet=function(){this._featureSetsBindingToken&&this._boundFeatureSetCollection&&(this._boundFeatureSetCollection.featureSets.unbind(this._featureSetsBindingToken),
this._boundFeatureSetCollection=this._featureSetsBindingToken=null)};g.prototype.exportState=function(a){var b=this.featureSetCollection.get();a.results=this.app.project.convert.fromGcxFeatureSetCollection(b);a.page=this.presentableResults.currPageNumber.get();a.viewMode="list"};g.prototype.applyState=function(a){var d=this;a.promises.push(this.app.project.convert.toGcxFeatureSetCollection(a.state.results).then(function(c){c&&(c!==d.featureSetCollection.get()&&(d.unbindFeatureSet(),d.featureSetCollection.set(c)),
b.isNullOrUndefined(a.state.page)||("grouplist"===a.state.viewMode&&(a.state.page=1),d.presentableResults.currPageNumber.set(a.state.page)),"list"!==a.state.viewMode&&"grouplist"!==a.state.viewMode||d.app.command("_setResultMappingCommand").execute(c.sourceName,"ShowResultsList"))}))};g.prototype._pulseFeatureSetsInCollection=function(){var a=this.presentableResults.currPageNumber.get();d.prototype._pulseFeatureSetsInCollection.call(this);this.presentableResults.currPageNumber.set(a)};g.prototype._clearResetUnderlyingCollection=
function(a){this.results.getCollectionSource().clear();this.presentableResults.currPageNumber.set(1);a&&(this.unbindFeatureSet(),this._featureViewMap={})};g.prototype.bindUnderlyingCollection=function(){this._bindObservables();this._pulseFeatureSetsInCollection()};g.prototype.unbindUndelryingCollection=function(){this._unbindObservables()};g.prototype._bindObservables=function(){var a=this;this._resultsPageBindingToken=this.resultsPage.bind(this,this.handlePageResultsChange);this._presentableResultsBindingToken=
this.presentableResults.numberOfItems.bind(this,function(b){0<b?a.pagingControlClassName.set("paging-control has-pages"):a.pagingControlClassName.set("paging-control no-pages");a.updateHeaderText(b)})};g.prototype._unbindObservables=function(){this._resultsPageBindingToken&&this.resultsPage.unbind(this._resultsPageBindingToken);this._presentableResultsBindingToken&&this.presentableResults.numberOfItems.unbind(this._presentableResultsBindingToken)};return g}(k.ResultsViewModel);f.FlatResultsViewModel=
h});
define("infrastructure/results/ResultsAttributeHeaderViewModel",["require","exports","geocortex/framework/observables"],function(h,f,k){h=function(){function h(e,c,a,b){this.sortState=new k.Observable(0);this.sortClass=new k.Observable("");this._reverseSortingPredicate=this._sortingPredicate=null;this.displayName=c.displayName;this._sharedState=e;"DateTime"===a?(this._sortingPredicate=this.buildDateSortingFunction(b),this._reverseSortingPredicate=this.buildReverseDateSortingFunction(b)):(this._sortingPredicate=this.buildSortingFunction(b),
this._reverseSortingPredicate=this.buildReverseSortingFunction(b));this.sortClass.syncTransform(this.sortState,function(a){switch(a){case 1:return e.sortedClass;case 2:return e.reverseSortedClass}return e.unsortedClass});this.sortState.bind(this,this.onSortStateChange)}h.prototype.buildSortingFunction=function(e){return function(c,a){return f.collator(c.attributes.getAt(e).presentableValue.get(),a.attributes.getAt(e).presentableValue.get())}};h.prototype.buildReverseSortingFunction=function(e){return function(c,
a){return f.collator(a.attributes.getAt(e).presentableValue.get(),c.attributes.getAt(e).presentableValue.get())}};h.prototype.buildDateSortingFunction=function(e){return function(c,a){var b=c.attributes.getAt(e).value.get(),d=a.attributes.getAt(e).value.get(),g=new Date(b),h=new Date(d),l="Invalid Date"!=g;return l!==("Invalid Date"!=h)?l?-1:1:l?g.getTime()-h.getTime():f.collator(b,d)}};h.prototype.buildReverseDateSortingFunction=function(e){return function(c,a){var b=a.attributes.getAt(e).value.get(),
d=c.attributes.getAt(e).value.get(),g=new Date(b),h=new Date(d),l="Invalid Date"!=g;return l!==("Invalid Date"!=h)?l?-1:1:l?g.getTime()-h.getTime():f.collator(b,d)}};h.prototype.onSortStateChange=function(e){if(!this._sharedState.ignoreStateChange){if(0>e||2<e)throw Error("Illegal column sort state: "+e);if(0==e){if(this._sharedState.lastSortedColumn!=this)throw Error("Column sort state out of sync");this._sharedState.lastSortedColumn=null;this._sharedState.presentableResults.sortingPredicate=null;
this._sharedState.presentableResults.unsortCollection()}else{null!=this._sharedState.lastSortedColumn&&this._sharedState.lastSortedColumn!=this&&(this._sharedState.ignoreStateChange=!0,this._sharedState.lastSortedColumn.sortState.set(0),this._sharedState.ignoreStateChange=!1);this._sharedState.lastSortedColumn=this;if(1==e)this._sharedState.presentableResults.sortingPredicate=this._sortingPredicate;else if(2==e)this._sharedState.presentableResults.sortingPredicate=this._reverseSortingPredicate;else throw Error("Invalid column sort state.");
this._sharedState.presentableResults.sortCollection()}}};return h}();f.ResultsAttributeHeaderViewModel=h;f.manualCollator=function(f,e){return isNaN(f)||isNaN(e)?f<e?-1:f>e?1:0:+f-e};f.collator="object"==typeof Intl&&"function"==typeof Intl.Collator?(new Intl.Collator(void 0,{numeric:!0})).compare:f.manualCollator;h=function(){function f(e,c,a,b){this.lastSortedColumn=null;this.presentableResults=e;this.unsortedClass=c;this.sortedClass=a;this.reverseSortedClass=b;this.reset()}f.prototype.reset=function(){this.ignoreStateChange=
!1;this.lastSortedColumn=null};return f}();f.SharedState=h});
define("infrastructure/results/ResultsFeatureActionsView",["require","exports","geocortex/framework/ui/ViewBase"],function(h,f,k){h=function(f){function e(){return null!==f&&f.apply(this,arguments)||this}__extends(e,f);e.prototype.handleMenuItemClick=function(c,a,b){b.execute(this.viewModel.currentFeature.get())};e.prototype.handleGetDescription=function(c,a,b){a.title=b.description.get()};return e}(k.ViewBase);f.ResultsFeatureActionsView=h});
define("infrastructure/results/ResultsListView",["require","exports","infrastructure/results/ResultsViewBase","infrastructure/FeatureDescriptionPresenterView"],function(h,f,k,l){h=function(e){function c(a,b){var d=e.call(this,a,b)||this;d.featureClickedEventName="ResultsListFeatureClickedEvent";d.featurePressedEventName="ResultsListFeaturePressedEvent";d.featureHoveredEventName="ResultsListFeatureHoveredEvent";d.featureHoverEndEventName="ResultsListFeatureHoverEndedEvent";d.itemClass="list-menu-item";
d._subscriptions=null;d._scrollTop=0;d.app.command("ShowResultsList").register(d,d.showResultsList);d.app.command("ShowResultsTable").register(d,d._handleShowResultsTable,function(){return!d.app.configuration.mobileMode});d.app.command("SwitchToTabularResultsView").register(d,d._switchToTabularResultsViewImpl,d._canExecuteSwitchToTabularResultsView);d.app.command("_ExportResultsViewState").register(d,d._exportState);d.app.command("_ApplyResultsViewState").register(d,d._applyState);d.app.event("ViewContainerViewClosedEvent").subscribe(d,
function(a){a.viewId===d.id&&d.configuration.clearCollectionOnClose&&d.viewModel.featureSetCollection.get().clear()});return d}__extends(c,e);c.prototype.activated=function(){var a=this;e.prototype.activated.call(this);this._unsubscribeFromEvents();if("DataFrameResultsContainerRegion"===this.regionName||"DataRegion"===this.regionName){var b=this.app.event("DataFrameOpenedEvent").subscribe(this,this._dataFrameOpenedEventHandler),d=this.app.event("DataFrameClosedEvent").subscribe(this,this._dataFrameClosedEventHandler);
this._subscriptions=[{eventName:"DataFrameOpenedEvent",token:b},{eventName:"DataFrameClosedEvent",token:d}]}if(this.resultsList){var c=this.resultsList;setTimeout(function(){dojo.style(c,{display:"block"})},1)}this.viewModel.featureSetCollection.bind(this,function(b){a.app.trace.debug("View focused in results list: "+a.id);a.app.command("FocusOnFirstInputInView").execute(a)});this.viewModel.bindUnderlyingCollection()};c.prototype.deactivated=function(){e.prototype.deactivated.call(this);this.viewModel.clearCurrentHighlights();
this.viewModel.unbindUndelryingCollection();this._unsubscribeFromEvents()};c.prototype.attach=function(a){var b=this;this.title.sync(a.headerText);this.isBusy.sync(a.isBusy);void 0!=this.configuration.isPaged&&a.presentableResults.isPaginated.set(this.configuration.isPaged);this.configuration.pageSize&&a.presentableResults.pageSize.set(this.configuration.pageSize);this.configuration.contentField&&a.contentField.set(this.configuration.contentField);a.presentableResults.currPageNumber.bindingEvent.subscribe(this,
function(){b.scrollViewTop()});this.scrollViewTop(this._scrollTop);e.prototype.attach.call(this,a)};c.prototype.showResultsList=function(a){this.app.viewManager.activateView(this)};c.prototype.handlePageFirst=function(a,b,d){1<this.viewModel.presentableResults.currPageNumber.get()&&this.viewModel.presentableResults.currPageNumber.set(1)};c.prototype.handlePagePrev=function(a,b,d){1<this.viewModel.presentableResults.currPageNumber.get()&&this.viewModel.presentableResults.currPageNumber.set(this.viewModel.presentableResults.currPageNumber.get()-
1)};c.prototype.handlePageNext=function(a,b,d){this.viewModel.presentableResults.lastPageNumber.get()>this.viewModel.presentableResults.currPageNumber.get()&&this.viewModel.presentableResults.currPageNumber.set(this.viewModel.presentableResults.currPageNumber.get()+1)};c.prototype.handlePageLast=function(a,b,d){this.viewModel.presentableResults.currPageNumber.get()<this.viewModel.presentableResults.lastPageNumber.get()&&this.viewModel.presentableResults.currPageNumber.set(this.viewModel.presentableResults.lastPageNumber.get())};
c.prototype.handleScrollChange=function(a,b,d){d&&(this._scrollTop=b.scrollTop)};c.prototype.getDescription=function(a,b,d){b.title=d.description.get()};c.prototype.scrollViewTop=function(a){this.scrollContainerElement&&(this.scrollContainerElement.scrollTop=a||0)};c.prototype.resolveWidget=function(a,b,d){e.prototype.resolveWidget.call(this,a,b);switch(a){case "GetLabel":return a=new l.FeatureDescriptionPresenterView(this.app,this.libraryId),a.contentField="label",a.root=dojo.create("div"),a.root.className=
"feature-label",a.attach(b),this.viewModel.setFeatureView(b.token+"-label",a),a;case "GetDescription":return a=new l.FeatureDescriptionPresenterView(this.app,this.libraryId),a.contentField=this.viewModel.contentField.get(),a.root=dojo.create("div"),a.root.className="feature-description",a.attach(b),this.viewModel.setFeatureView(b.token,a),a;case "ResultsListActionsWidget":if(b=this.app.menuRegistry.createMenuWidget(this,b,d))return b}};c.prototype._handleShowResultsTable=function(){this.app.viewManager.deactivateView(this)};
c.prototype._switchToTabularResultsViewImpl=function(){this.app.command("CloseDataFrame").execute()};c.prototype._canExecuteSwitchToTabularResultsView=function(){return this.isActive&&!this.app.configuration.mobileMode};c.prototype._dataFrameOpenedEventHandler=function(){this.isContainerCollapsed||this.app.event("ResultsViewOpenedEvent").publish(this)};c.prototype._dataFrameClosedEventHandler=function(){this.isContainerCollapsed||this.app.event("ResultsViewCollapsedEvent").publish(this)};c.prototype._unsubscribeFromEvents=
function(){if(this._subscriptions)for(var a=0;a<this._subscriptions.length;a++){var b=this._subscriptions[a];this.app.event(b.eventName).unsubscribe(b.token)}this._subscriptions=null};c.prototype._exportState=function(a){this.isActive&&this.viewModel.exportState(a)};c.prototype._applyState=function(a){this.viewModel.applyState(a)};return c}(k.ResultsViewBase);f.ResultsListView=h});
define("infrastructure/ui/components/Table/TableColumnHeaderViewModelInterface",["require","exports","infrastructure/ui/components/Table/TableColumnViewModelInterface"],function(h,f,k){h=function(f){function e(){return null!==f&&f.apply(this,arguments)||this}__extends(e,f);return e}(k.TableColumnViewModelInterface);f.TableColumnHeaderViewModelInterface=h});
define("infrastructure/ui/components/Table/SortState",["require","exports"],function(h,f){var k=f.SortState||(f.SortState={});k[k.UNSORTED=0]="UNSORTED";k[k.ASCENDING=1]="ASCENDING";k[k.DESCENDING=2]="DESCENDING"});
define("infrastructure/ui/components/Table/TableColumnHeaderViewModel",["require","exports","geocortex/framework/observables","infrastructure/ui/components/Table/SortState","infrastructure/FormatUtils"],function(h,f,k,l,e){h=function(){function c(a,b,d,c,e,f){this.visible=new k.Observable(!0);this.value=new k.Observable("");this.presentableValue=new k.Observable("");this.columnDescriptor=new k.Observable("");this.sortState=new k.Observable(l.SortState.UNSORTED);this.sortClass=new k.Observable("");
this._reverseSortingPredicate=this._sortingPredicate=null;this.app=a;this.libraryId=b;this.value.set(c);this.presentableValue.set(c);this.columnDescriptor.set(this.app.getResource(this.libraryId,"language-ui-table-unsorted").format(this.presentableValue.get()));this._sharedState=d;"DateTime"===e?(this._sortingPredicate=this.buildDateSortingFunction(f),this._reverseSortingPredicate=this.buildReverseDateSortingFunction(f)):(this._sortingPredicate=this.buildSortingFunction(f),this._reverseSortingPredicate=
this.buildReverseSortingFunction(f));this.sortClass.syncTransform(this.sortState,function(a){switch(a){case 1:return d.sortedClass;case 2:return d.reverseSortedClass}return d.unsortedClass});this.sortState.bind(this,this.onSortStateChange)}c.prototype.buildSortingFunction=function(a){return function(b,d){return f.collator(b.attributes.getAt(a).presentableValue.get(),d.attributes.getAt(a).presentableValue.get())}};c.prototype.buildReverseSortingFunction=function(a){return function(b,d){return f.collator(d.attributes.getAt(a).presentableValue.get(),
b.attributes.getAt(a).presentableValue.get())}};c.prototype.buildDateSortingFunction=function(a){return function(b,d){var c=b.attributes.getAt(a).value.get(),h=d.attributes.getAt(a).value.get(),l=e.parseDate(c),k=e.parseDate(h),p="Invalid Date"!=l;return p!==("Invalid Date"!=k)?p?-1:1:p?l.getTime()-k.getTime():f.collator(c,h)}};c.prototype.buildReverseDateSortingFunction=function(a){return function(b,d){var c=d.attributes.getAt(a).value.get(),h=b.attributes.getAt(a).value.get(),l=e.parseDate(c),k=
e.parseDate(h),p="Invalid Date"!=l;return p!==("Invalid Date"!=k)?p?-1:1:p?l.getTime()-k.getTime():f.collator(c,h)}};c.prototype.onSortStateChange=function(a){if(!this._sharedState.ignoreStateChange){if(a<l.SortState.UNSORTED||a>l.SortState.DESCENDING)throw Error("Illegal column sort state: "+a);if(0==a){if(this._sharedState.lastSortedColumn!=this)throw Error("Column sort state out of sync");this._sharedState.lastSortedColumn=null;this._sharedState.presentableResults.sortingPredicate=null;this._sharedState.presentableResults.unsortCollection();
this.columnDescriptor.set(this.app.getResource(this.libraryId,"language-ui-table-unsorted").format(this.presentableValue.get()))}else{null!=this._sharedState.lastSortedColumn&&this._sharedState.lastSortedColumn!=this&&(this._sharedState.ignoreStateChange=!0,this._sharedState.lastSortedColumn.sortState.set(l.SortState.UNSORTED),this._sharedState.ignoreStateChange=!1);this._sharedState.lastSortedColumn=this;if(a==l.SortState.ASCENDING)this._sharedState.presentableResults.sortingPredicate=this._sortingPredicate,
this.columnDescriptor.set(this.app.getResource(this.libraryId,"language-ui-table-sorted-ascending").format(this.presentableValue.get()));else if(a==l.SortState.DESCENDING)this._sharedState.presentableResults.sortingPredicate=this._reverseSortingPredicate,this.columnDescriptor.set(this.app.getResource(this.libraryId,"language-ui-table-sorted-descending").format(this.presentableValue.get()));else throw Error("Invalid column sort state.");this._sharedState.presentableResults.sortCollection()}}};return c}();
f.TableColumnHeaderViewModel=h;f.manualCollator=function(c,a){return isNaN(c)||isNaN(a)?c<a?-1:c>a?1:0:+c-a};f.collator="object"==typeof Intl&&"function"==typeof Intl.Collator?(new Intl.Collator(void 0,{numeric:!0})).compare:f.manualCollator;h=function(){function c(a,b,d,c){this.lastSortedColumn=null;this.presentableResults=a;this.unsortedClass=b;this.sortedClass=d;this.reverseSortedClass=c;this.reset()}c.prototype.reset=function(){this.ignoreStateChange=!1;this.lastSortedColumn=null};return c}();
f.SharedState=h});
define("infrastructure/results/TabbedResultsViewModel","require exports infrastructure/results/ResultsViewModel geocortex/framework/observables infrastructure/FeatureSet geocortex/framework-ui/PresentableCollection infrastructure/ui/components/Table/TableColumnHeaderViewModel infrastructure/FeatureSetCollection geocortex/framework/utils/ArrayUtils infrastructure/ui/components/Table/SortState geocortex/framework/utils/utils infrastructure/eventArgs/ResultsPageChangedEventArgs infrastructure/results/ResultsUtils".split(" "),function(h,
f,k,l,e,c,a,b,d,g,m,q,n){h=function(f){function h(a,b){var d=f.call(this,a,b)||this;d.curFeatureSet=new l.Observable(null);d.currPageWithinTab={};d.currScrollPosWithinTab={};d.presentableResults=new c.PresentableCollection;d.pageControlsEnabled=new l.Observable(!1);d.tabControlsEnabled=new l.Observable(!1);d.resultsTable=new l.Observable("results-table");d.columnSharedState=null;d.columnHeaders=new l.ObservableCollection([]);d.leftScrollTabDisabled=new l.Observable(!1);d.rightScrollTabDisabled=new l.Observable(!1);
d._firstVisibleTab=0;d._emptyFeatureSet=new e.FeatureSet({app:d.app});d._boundFeatureSets=null;d._featureSetsBindingToken=null;d._curFeatureSetBindingToken=null;d._presentableResultsBindingToken=null;d._resultsPageBindingToken=null;d.presentableResults.items.useThrottling=!0;d.resultsPage=d.presentableResults.items;d.presentableResults.pageSize.set(d.defaultPageSize);d.defaultIsPaged!=d.presentableResults.isPaginated.get()&&d.presentableResults.isPaginated.set(d.defaultIsPaged);d.app.command("ShowResultsTable").register(d,
d.showResultsTable,function(){return!d.app.configuration.mobileMode});d.app.command("SwitchToListResultsView").register(d,d._switchToListResultsViewImpl,d._canExecuteSwitchToListResultsView);return d}__extends(h,f);h.prototype.handleCollectionChanged=function(a){f.prototype.handleCollectionChanged.call(this,a);this.unbindFeatureSets();if(a&&a.featureSets){this._featureSetsBindingToken=a.featureSets.bind(this,this.handleFeatureSetsChanged);this._boundFeatureSets=a.featureSets;this._firstVisibleTab=
0;for(var b=null,d=0;d<a.featureSets.length();d++)if(a.featureSets.getAt(d).isSelectedInCollection.get()){b=a.featureSets.getAt(d);break}!b&&0<a.featureSets.length()&&(b=a.featureSets.getAt(0));b!==this.curFeatureSet.get()&&(this.setCurrentSelectedFeatureSet(b),this.currPageWithinTab={},this.currScrollPosWithinTab={});f.prototype.updateHeaderText.call(this,b?b.features.length():this.featureSetCollection.get().countFeatures())}};h.prototype.handleCurrentFeatureSetChanged=function(a){this.presentableResults.sortingPredicate=
null;a&&this.presentableResults.items!==a.features&&(this.presentableResults.attachToCollection(a.features),this.buildColumnHeaders(a))};h.prototype.handleFeatureSetsChanged=function(a){f.prototype.handleFeatureSetsChanged.call(this,a);var b=a.sender;if("append"===a.type){0===a.rangeStart&&this.setCurrentSelectedFeatureSet(b.getAt(0));for(var d=a.rangeStart;d<=a.rangeEnd;d++)b.getAt(d).isSelectedInCollection.get()&&this.setCurrentSelectedFeatureSet(b.getAt(d))}else"remove"===a.type&&(d=this.curFeatureSet.get())&&
(d=b.indexOf(d),d>=a.rangeStart&&d<=a.rangeEnd&&(a.rangeEnd+1<b.length()?this.setCurrentSelectedFeatureSet(b.getAt(a.rangeEnd+1)):0<a.rangeStart?this.setCurrentSelectedFeatureSet(b.getAt(a.rangeStart-1)):this.setCurrentSelectedFeatureSet(null)))};h.prototype.showResultsTable=function(a){if(!(a instanceof b.FeatureSetCollection))if("string"===typeof a)a=this.app.featureSetManager.getCollectionById(a);else return;if(a){if(a!==this.featureSetCollection.get())this.unbindFeatureSets(),this.featureSetCollection.set(a);
else{var d=this.featureSetCollection.get().featureSets.get().filter(function(a){return a.isSelectedInCollection.get()})[0];d?this.setCurrentSelectedFeatureSet(d):0<this.featureSetCollection.get().featureSets.length()&&this.setCurrentSelectedFeatureSet(this.featureSetCollection.get().featureSets.getAt(0));this._handlePageResultsChange()}this.app.command("_setResultMappingCommand").execute(a.sourceName,"ShowResultsTable")}this.currPageWithinTab={};this.currScrollPosWithinTab={}};h.prototype.clearCurrentHighlights=
function(){if(this.curFeatureSet.get()){var a=this.curFeatureSet.get().features.getItems();this.app.command("ClearFeatureHighlight").execute(a)}};h.prototype._switchToListResultsViewImpl=function(){this.curFeatureSet.get()?this.curFeatureSet.get().isSelectedInCollection.get()?(this.app.command("ShowResultsList").execute(this.featureSetCollection.get()),this.app.command("ShowFeatureSetResultsView").execute(this.curFeatureSet.get())):(this.app.command("ShowResultsList").execute(this.featureSetCollection.get()),
0===this.featureSetCollection.get().countFeatures()&&n.showResultsStatusMessage(this.app,0)):(this.app.command("ShowResultsList").execute(this.featureSetCollection.get()),n.showResultsStatusMessage(this.app,this.featureSetCollection.get().countFeatures()))};h.prototype._canExecuteSwitchToListResultsView=function(){return!!this.featureSetCollection.get()};h.prototype.setCurrentSelectedFeatureSet=function(a){for(var b=this.featureSetCollection.get().featureSets,d=0;d<b.length();d++)b.getAt(d).isSelectedInCollection.set(b.getAt(d)===
a);a&&this.curFeatureSet.get()!==a&&this.curFeatureSet.set(a)};h.prototype.unbindFeatureSets=function(){this._featureSetsBindingToken&&this._boundFeatureSets&&this._boundFeatureSets.unbind(this._featureSetsBindingToken);this._featureSetsBindingToken=this._boundFeatureSets=null};h.prototype.buildColumnHeaders=function(b){this.columnHeaders.clear();this.columnSharedState?this.columnSharedState.reset():this.columnSharedState=new a.SharedState(this.presentableResults,"sort","sort-up","sort-down");var d,
c={};if(b.layer&&b.layer.fields)for(d=0;d<b.layer.fields.length;d++){var e=b.layer.fields[d];c[e.name]=e.dataType}e=b.attributes.length();e||(b.loadAttributes(),e=b.attributes.length());for(d=0;d<e;d++){var g=b.attributes.getAt(d);g.visible&&!g.visible.get()||this.columnHeaders.addItem(new a.TableColumnHeaderViewModel(this.app,this.libraryId,this.columnSharedState,g.displayName.get(),c[g.name.get()],d))}};h.prototype.setCurrentPageWithinTab=function(a){this.currPageWithinTab[a]?this.currPageWithinTab[a]!==
this.presentableResults.currPageNumber.get()&&this.presentableResults.currPageNumber.set(this.currPageWithinTab[a]):this.currPageWithinTab[a]=this.presentableResults.currPageNumber.get()};h.prototype.updateCurrentPageAndScrollPosWithinTab=function(a,b){this.currScrollPosWithinTab[this.curFeatureSet.get().uniqueId]=b;this.currPageWithinTab[this.curFeatureSet.get().uniqueId]=a};h.prototype.exportState=function(a){var b=this.featureSetCollection.get();a.results=this.app.project.convert.fromGcxFeatureSetCollection(b);
a.viewMode="table";a.page=this.presentableResults.currPageNumber.get();if(b=d.firstOrDefault(b.featureSets.get(),function(a){return a.isSelectedInCollection.get()}))if(a.openedFeatureSet=this.app.project.convert.fromGcxFeatureSet(b),b=d.firstOrDefault(this.columnHeaders.get(),function(a){return a.sortState.get()!==g.SortState.UNSORTED}))a.tableOptions={},a.tableOptions.sortColumn=this.columnHeaders.get().indexOf(b),a.tableOptions.sortDirection=b.sortState.get()===g.SortState.ASCENDING?"asc":"desc"};
h.prototype.applyState=function(a){var b=this,c=2==a.state.serialVersion?{results:this.app.project.convert.toGcxFeatureSetCollection(a.state.results),selectedFeatureSet:a.state.openedFeatureSet?this.app.project.convert.toGcxFeatureSet(a.state.openedFeatureSet)["catch"](function(a){}):null}:{results:this.app.project.convert.toGcxFeatureSetCollection(a.state.results),selectedFeatureSet:a.state.tableOptions?this.app.project.convert.toGcxFeatureSet(a.state.tableOptions.selectedFeatureSet)["catch"](function(a){}):
null};a.promises.push(Promise.props(c).then(function(c){if(c.results){c.results!==b.featureSetCollection.get()&&(b.unbindFeatureSets(),b.featureSetCollection.set(c.results));"table"===a.state.viewMode&&b.app.command("_setResultMappingCommand").execute(c.results.sourceName,"ShowResultsTable");var e=d.firstOrDefault(c.results.featureSets.get(),function(a){return a===c.selectedFeatureSet});e&&(b.setCurrentSelectedFeatureSet(e),m.isNullOrUndefined(a.state.page)||(b.updateCurrentPageAndScrollPosWithinTab(b.presentableResults.currPageNumber.get(),
0),b.presentableResults.currPageNumber.set(a.state.page)),a.state.tableOptions&&!m.isNullOrUndefined(a.state.tableOptions.sortColumn)&&(e=b.columnHeaders.getAt(a.state.tableOptions.sortColumn))&&e.sortState.set("desc"===a.state.tableOptions.sortDirection?g.SortState.DESCENDING:g.SortState.ASCENDING))}}))};h.prototype._handlePageResultsChange=function(a){a=a?a:{type:null};a="clear"===a.type||"remove"===a.type&&1>=a.sender.value.length;var b=new q.ResultsPageChangedEventArgs;b.featureSetCollection=
this.featureSetCollection.get();b.newValue=a?new l.ObservableCollection:this.resultsPage;this.app.event("ResultsPageChangedEvent").publish(b);this.app.behavior("ResultsPageChangedBehavior").run(b.newValue.get())};h.prototype._pulseUnderlyingCollection=function(){if(this.curFeatureSet.get()){var a=this.presentableResults.currPageNumber.get();this.curFeatureSet.pulse();this.presentableResults.currPageNumber.set(a)}};h.prototype.bindUnderlyingCollections=function(){this._bindObservables();this._pulseUnderlyingCollection()};
h.prototype.unbindUnderlyingCollections=function(){this._unbindObservables()};h.prototype._bindObservables=function(){this._curFeatureSetBindingToken||(this._curFeatureSetBindingToken=this.curFeatureSet.bind(this,this.handleCurrentFeatureSetChanged));this._presentableResultsBindingToken||(this._presentableResultsBindingToken=this.presentableResults.numberOfItems.bind(this,this.updateHeaderText));this._resultsPageBindingToken||(this._resultsPageBindingToken=this.resultsPage.bind(this,this._handlePageResultsChange))};
h.prototype._unbindObservables=function(){this._curFeatureSetBindingToken&&(this.curFeatureSet.unbind(this._curFeatureSetBindingToken),this._curFeatureSetBindingToken=null);this._presentableResultsBindingToken&&(this.presentableResults.numberOfItems.unbind(this._presentableResultsBindingToken),this._presentableResultsBindingToken=null);this._resultsPageBindingToken&&(this.resultsPage.unbind(this._resultsPageBindingToken),this._resultsPageBindingToken=null)};return h}(k.ResultsViewModel);f.TabbedResultsViewModel=
h});
define("infrastructure/ui/components/Table/TableViewModel",["require","exports","geocortex/framework/ui/ViewModelBase","geocortex/framework/observables","geocortex/framework-ui/PresentableCollection"],function(h,f,k,l,e){h=function(c){function a(a,d){var e=c.call(this,a,d)||this;e.columnHeaders=new l.ObservableCollection([]);e.records=new l.ObservableCollection([]);e.presentableRecordCollection=null;e.recordClickEvents=[];e.recordLongPressEvents=[];e.recordHoverEvents=[];e.recordHoverEndEvents=[];
e.recordLongPressDuration=1E3;e.recordHoverDuration=0;return e}__extends(a,c);a.prototype.attachToPresentableCollection=function(a){a&&a instanceof e.PresentableCollection&&(this.presentableRecordCollection=a,this.records=this.presentableRecordCollection.items)};a.prototype.addRecordClickEvents=function(a){this._executeAddEvents(a,0)};a.prototype.addRecordLongPressEvents=function(a){this._executeAddEvents(a,1)};a.prototype.addRecordHoverEvents=function(a){this._executeAddEvents(a,2)};a.prototype.addRecordHoverEndEvents=
function(a){this._executeAddEvents(a,3)};a.prototype._executeAddEvents=function(a,d){var c=this,e=function(a){a&&"string"===typeof a&&(0===d?(c.recordClickEvents=c.recordClickEvents.filter(function(b){return b!==a}),c.recordClickEvents.push(a)):1===d?(c.recordLongPressEvents=c.recordLongPressEvents.filter(function(b){return b!==a}),c.recordLongPressEvents.push(a)):2===d?(c.recordHoverEvents=c.recordHoverEvents.filter(function(b){return b!==a}),c.recordHoverEvents.push(a)):3===d&&(c.recordHoverEndEvents=
c.recordHoverEndEvents.filter(function(b){return b!==a}),c.recordHoverEndEvents.push(a)))};a&&dojo.isArray(a)?a.forEach(function(a){return e(a)}):e(a)};return a}(k.ViewModelBase);f.TableViewModel=h});
define("infrastructure/ui/components/Table/TableView",["require","exports","geocortex/framework/ui/ViewBase","infrastructure/ShellUtils"],function(h,f,k,l){h=function(e){function c(){var a=null!==e&&e.apply(this,arguments)||this;a.tableContainerElement=null;a._itemClass="results-table-row-item";a._longPressTimer=null;a._pressStartTime=null;a._firedTouchOrPress=!1;a._hoverTimerToken=null;a._hoveredFeature=null;a._pressYStart=null;a._lastTouchY=null;a._scrollYDeltaThreshold=35;a._firstEvent=null;return a}
__extends(c,e);c.prototype.handleColumnHeadClick=function(a,b,d){d.sortState.set((d.sortState.get()+1)%3)};c.prototype.handleMouseDown=function(a,b,d){this._beginLongPressIfNoEventsInProgress(d,"mouse-down");return!0};c.prototype.handleMouseUp=function(a,b,d){this._cancelLongPressIfEventInProgress("mouse-down");return!0};c.prototype.handleMouseOver=function(a,b,d){l.hasClass(a.currentTarget,this._itemClass)&&this._beginHover(d)};c.prototype.handleMouseOut=function(a,b,d){l.hasClass(a.currentTarget,
this._itemClass)&&(this._cancelHover(),this._tryFireHoverStop(d),this._cancelLongPressIfEventInProgress("mouse-down"))};c.prototype.handleTouchStart=function(a,b,d){this._beginLongPressIfNoEventsInProgress(d,"touch-start");return!0};c.prototype.handleTouchMove=function(a,b,d){return this.handleTouchEnd(a,b,d)};c.prototype.handleTouchEnd=function(a,b,d){this._cancelLongPressIfEventInProgress("touch-start");return!0};c.prototype.handleClick=function(a,b,d){var c=this;this.viewModel&&this.viewModel.recordClickEvents.length&&
this.viewModel.recordClickEvents.forEach(function(a){return c.app.event(a).publish(d)});return!0};c.prototype.handleClickAttributelink=function(a,b,d){return this.app.followNavigationLink({url:d.value.get(),element:b})};c.prototype._beginLongPressIfNoEventsInProgress=function(a,b){this._firstEvent||(this._firstEvent=b,this._beginLongPress(a))};c.prototype._cancelLongPressIfEventInProgress=function(a){this._firstEvent===a&&(this._firstEvent=null,this._cancelLongPress())};c.prototype._beginLongPress=
function(a){var b=this;this._cancelLongPress();this.viewModel&&this.viewModel.recordLongPressEvents.length&&(this._longPressTimer=setTimeout(function(){b.viewModel.recordLongPressEvents.forEach(function(d){b.app.event(d).publish(a)},b.viewModel.recordLongPressDuration||1E3)}))};c.prototype._cancelLongPress=function(){this._longPressTimer&&(clearTimeout(this._longPressTimer),this._longPressTimer=null)};c.prototype._beginHover=function(a){var b=this;this._hoverTimerToken&&clearTimeout(this._hoverTimerToken);
this._hoverTimerToken=setTimeout(function(){b._hoveredFeature!==a&&(b._hoveredFeature=a);b.viewModel.recordHoverEvents.forEach(function(d){b.app.event(d).publish(a)})},this.viewModel.recordHoverDuration||0)};c.prototype._cancelHover=function(){this._hoverTimerToken&&(clearTimeout(this._hoverTimerToken),this._hoverTimerToken=null)};c.prototype._tryFireHoverStop=function(a){var b=this;this._hoveredFeature===a&&(this._hoveredFeature=null,this.viewModel.recordHoverEndEvents.forEach(function(d){b.app.event(d).publish(a)}))};
return c}(k.ViewBase);f.TableView=h});
define("infrastructure/results/ResultsTableView",["require","exports","infrastructure/results/ResultsViewBase","infrastructure/ui/components/Table/TableViewModel"],function(h,f,k,l){h=function(e){function c(a,b){var d=e.call(this,a,b)||this;d.featureClickedEventName="ResultsTableFeatureClickedEvent";d.featurePressedEventName="ResultsTableFeaturePressedEvent";d.featureHoveredEventName="ResultsTableFeatureHoveredEvent";d.featureHoverEndEventName="ResultsTableFeatureHoverEndedEvent";d.scrollContainerElement=
null;d.tabContainerElement=null;d.tabElements=null;d.scrollTabLeftElement=null;d.scrollTabRightElement=null;d._fsBindingToken=null;d._boundFs=null;d.app.command("ShowResultsTable").register(d,d.showResultsTable,function(){return!d.app.configuration.mobileMode});d.app.command("ShowResultsList").register(d,d._handleShowResultsList);d.app.command("_ExportResultsViewState").register(d,d._exportState);d.app.command("_ApplyResultsViewState").register(d,d._applyState);d.app.event("ViewContainerViewClosedEvent").subscribe(d,
function(a){a.viewId===d.id&&!1!==d.configuration.clearCollectionOnClose&&d.viewModel.featureSetCollection.get().clear()});return d}__extends(c,e);c.prototype.deactivated=function(){e.prototype.deactivated.call(this);this.viewModel.clearCurrentHighlights();this.viewModel.unbindUnderlyingCollections()};c.prototype.activated=function(){this.viewModel.bindUnderlyingCollections()};c.prototype.attach=function(a){var b=this;this.title.sync(a.headerText);this.isBusy.sync(a.isBusy);void 0!=this.configuration.isPaged&&
a.presentableResults.isPaginated.set(this.configuration.isPaged);this.configuration.pageSize&&a.presentableResults.pageSize.set(this.configuration.pageSize);a.presentableResults.currPageNumber.bindingEvent.subscribe(this,function(){var a=b.viewModel.curFeatureSet.get();b.scrollView(a?b.viewModel.currScrollPosWithinTab[a.uniqueId]||0:0)});e.prototype.attach.call(this,a)};c.prototype.resolveWidget=function(a,b,d){e.prototype.resolveWidget.call(this,a,b);switch(a){case "ResultsTableActionsWidget":return this.app.menuRegistry.createMenuWidget(this,
b,d);case "TableViewWidget":a=this.viewModel;if(b=this.app.viewManager.createView({typeName:"geocortex.essentialsHtmlViewer.mapping.infrastructure.ui.components.Table.TableView",markupResource:"Mapping/infrastructure/ui/components/Table/TableView.html",libraryId:this.libraryId,isVisible:!0}))d=new l.TableViewModel(this.app,this.libraryId),d.addRecordClickEvents(this.featureClickedEventName),d.addRecordLongPressEvents(this.featurePressedEventName),d.addRecordHoverEvents(this.featureHoveredEventName),
d.addRecordHoverEndEvents(this.featureHoverEndEventName),d.columnHeaders=this.viewModel.columnHeaders,d.attachToPresentableCollection(a.presentableResults),b.attach(d),this.scrollContainerElement=b.tableContainerElement;return b;default:this.app.trace.warning("ResultsTableView: Unknown Widget")}};c.prototype.showResultsTable=function(a){var b=this;this.app.viewManager.activateView(this);this.viewModel.featureSetCollection.get()&&(this._unbindFromPrevFeatureSet(),this._boundFs=this.viewModel.featureSetCollection.get().featureSets)&&
(this._fsBindingToken=this.viewModel.featureSetCollection.get().featureSets.bind(this,this._refreshTabControlVisibility));var d=null,c=this.app.event("ApplicationResizedEvent").subscribe(this,function(){b.isActive?(d&&(clearTimeout(d),d=null),d=setTimeout(function(){b._refreshTabControlVisibility()},200)):(b.app.event("ApplicationResizedEvent").unsubscribe(c),c=null)});this._refreshTabControlVisibility()};c.prototype._refreshTabControlVisibility=function(){var a=this;setTimeout(function(){a.tabContainerElement&&
a.tabElements&&(a.viewModel.tabControlsEnabled.set(a.tabElements.offsetWidth>a.tabContainerElement.offsetWidth),a._updateScrollTabDisabledStatus())},100)};c.prototype.handleTabClick=function(a,b,d){this.scrollContainerElement&&(this.viewModel.currScrollPosWithinTab[this.viewModel.curFeatureSet.get().uniqueId]=this.scrollContainerElement.scrollTop);(a=dojo.filter(this.viewModel.featureSetCollection.get().featureSets.get(),function(a){return a.uniqueId===d.uniqueId}))&&a[0]&&this.viewModel.curFeatureSet.get()!==
a[0]&&(this.viewModel.clearCurrentHighlights(),this.viewModel.setCurrentSelectedFeatureSet(a[0]),this.viewModel.setCurrentPageWithinTab(d.uniqueId));this.app.command("FocusOnFirstInputInView").execute(this)};c.prototype.handlePageFirst=function(a,b,d){1<this.viewModel.presentableResults.currPageNumber.get()&&(this.viewModel.updateCurrentPageAndScrollPosWithinTab(1,0),this.viewModel.presentableResults.currPageNumber.set(1))};c.prototype.handlePagePrev=function(a,b,d){1<this.viewModel.presentableResults.currPageNumber.get()&&
(a=this.viewModel.presentableResults.currPageNumber.get()-1,this.viewModel.updateCurrentPageAndScrollPosWithinTab(a,0),this.viewModel.presentableResults.currPageNumber.set(a))};c.prototype.handlePageNext=function(a,b,d){this.viewModel.presentableResults.lastPageNumber.get()>this.viewModel.presentableResults.currPageNumber.get()&&(a=this.viewModel.presentableResults.currPageNumber.get()+1,this.viewModel.updateCurrentPageAndScrollPosWithinTab(a,0),this.viewModel.presentableResults.currPageNumber.set(a))};
c.prototype.handlePageLast=function(a,b,d){this.viewModel.presentableResults.currPageNumber.get()<this.viewModel.presentableResults.lastPageNumber.get()&&(a=this.viewModel.presentableResults.lastPageNumber.get(),this.viewModel.updateCurrentPageAndScrollPosWithinTab(a,0),this.viewModel.presentableResults.currPageNumber.set(a))};c.prototype.handleTabScrollBack=function(a,b,d){a=$(this.tabContainerElement);b=a.scrollLeft()-2*this.scrollTabLeftElement.offsetWidth;a.scrollLeft(0>b?0:b);this._updateScrollTabDisabledStatus()};
c.prototype.handleTabScrollForward=function(a,b,d){a=$(this.tabContainerElement);b=this.tabContainerElement.scrollWidth-this.tabContainerElement.offsetWidth;d=a.scrollLeft()+2*this.scrollTabRightElement.offsetWidth;a.scrollLeft(d>b?b:d);this._updateScrollTabDisabledStatus()};c.prototype.handleClickFeature=function(a,b,d){this.app.event("ResultsTableFeatureClickedEvent").publish(d)};c.prototype.handleColumnHeadClick=function(a,b,d){d.sortState.set((d.sortState.get()+1)%3)};c.prototype._handleShowResultsList=
function(){this.app.viewManager.deactivateView(this)};c.prototype._canExecuteSwitchToListResultsView=function(){return this.isActive&&!this.app.configuration.mobileMode};c.prototype._updateScrollTabDisabledStatus=function(){if(this.tabContainerElement){var a=this.tabContainerElement.scrollWidth-this.tabContainerElement.offsetWidth;this.viewModel.leftScrollTabDisabled.set(0===this.tabContainerElement.scrollLeft);this.viewModel.rightScrollTabDisabled.set(this.tabContainerElement.scrollLeft>a-1)}};c.prototype._unbindFromPrevFeatureSet=
function(){this._fsBindingToken&&this._boundFs&&this._boundFs.unbind(this._fsBindingToken);this._fsBindingToken=this._boundFs=null};c.prototype._exportState=function(a){this.isActive&&this.viewModel.exportState(a)};c.prototype._applyState=function(a){this.viewModel.applyState(a)};return c}(k.ResultsViewBase);f.ResultsTableView=h});
define("infrastructure/selection/CombineMode",["require","exports"],function(h,f){var k=f.CombineMode||(f.CombineMode={});k.REPLACE="replace";k.UNION="union";k.SUBTRACT="subtract";k.INTERSECT="intersect"});define("infrastructure/selection/SelectionMetadataQuery",["require","exports"],function(h,f){});
define("infrastructure/selection/SelectionMetadataStore",["require","exports","infrastructure/Dictionary","geocortex/framework/utils/ArrayUtils","geocortex/framework/utils/utils"],function(h,f,k,l,e){h=function(){function c(a){this._store=new k.Dictionary;this.app=a}c.prototype.findByName=function(a){a=this.find({name:a});return l.firstOrDefault(a)};c.prototype.findByCollectionId=function(a){a=this.find({featureSetCollectionIds:[a]});return l.firstOrDefault(a)};c.prototype.findById=function(a){a=
this.find({ids:[a]});return l.firstOrDefault(a)};c.prototype.findAll=function(){return this.find()};c.prototype.find=function(a){a=a||{};var b=this._store.values();a.ids&&0<a.ids.length&&(b=b.filter(function(b){return-1<a.ids.indexOf(b.id)}));a.featureSetCollectionIds&&0<a.featureSetCollectionIds.length&&(b=b.filter(function(b){return-1<a.featureSetCollectionIds.indexOf(b.featureSetCollectionId)}));a.name&&(b=b.filter(function(b){return b.name&&b.name==a.name}));if(a.dateCreatedMin&&a.dateCreatedMin instanceof
Date)var d=a.dateCreatedMin.getTime(),b=b.filter(function(a){return"undefined"!=typeof a.timeCreated&&a.timeCreated>=d});if(a.dateCreatedMax&&a.dateCreatedMax instanceof Date)var c=a.dateCreatedMax.getTime(),b=b.filter(function(a){return"undefined"!=typeof a.timeCreated&&a.timeCreated<=c});if(a.dateModifiedMin&&a.dateModifiedMin instanceof Date)var e=a.dateModifiedMin.getTime(),b=b.filter(function(a){return"undefined"!=typeof a.timeModified&&a.timeModified>=e});if(a.dateModifiedMax&&a.dateModifiedMax instanceof
Date)var f=a.dateModifiedMax.getTime(),b=b.filter(function(a){return"undefined"!=typeof a.timeModified&&a.timeModified<=f});if(a.dateExpirationMin&&a.dateExpirationMin instanceof Date)var h=a.dateExpirationMin.getTime(),b=b.filter(function(a){return"undefined"!=typeof a.timeExpiration&&a.timeExpiration>=h});if(a.dateExpirationMax&&a.dateExpirationMax instanceof Date)var l=a.dateExpirationMax.getTime(),b=b.filter(function(a){return"undefined"!=typeof a.timeExpiration&&a.timeExpiration<=l});return b.map(function(a){return dojo.mixin({},
a)})};c.prototype.add=function(a){if(!a)throw Error("The selection metadata cannot be null.");a=dojo.mixin({},a);var b=a.id=this._generateId();this._store.set(b,a);return b};c.prototype.updateById=function(a,b){if(!a)throw Error("The metadata ID must be set.");if(!b)throw Error("The selection metadata cannot be null.");if(!this._store.containsKey(a))throw Error("Selection metadata with ID '{0}' not found.".format(a));var d=this._store.get(a);this._update(d,b)};c.prototype.removeById=function(a){if(!a)throw Error("The metadata ID must be set.");
this._store.remove(a)};c.prototype.clear=function(){this._store.clear()};c.prototype._update=function(a,b){a.name=b.name;a.count=b.count;a.timeCreated=b.timeCreated;a.timeModified=b.timeModified;a.timeExpiration=a.timeExpiration;a.featureSetCollectionId=b.featureSetCollectionId;a.modified=b.modified};c.prototype._generateId=function(){return e.alphaNumericToken()};return c}();f.SelectionMetadataStore=h});
define("infrastructure/sharing/SharingLinkProviderBase",["require","exports"],function(h,f){(function(f){f[f.SCALE=0]="SCALE";f[f.CENTER=1]="CENTER";f[f.EXTENT=2]="EXTENT"})(f.ExtentLinkPriority||(f.ExtentLinkPriority={}));(function(f){f[f.LAYERTHEME=0]="LAYERTHEME";f[f.LAYERS=1]="LAYERS"})(f.LayerListLinkPriority||(f.LayerListLinkPriority={}));var k=function(){function f(e,c){this.generateParameter=this.acceptParameter=!0;this.app=e;this.libraryId=c}f.prototype.initialize=function(e){};f.prototype.generate=
function(){return""};f.prototype.apply=function(e){};f.prototype.getResource=function(e,c){return this.app.getResource(this.libraryId,e,c)};return f}();f.SharingLinkProviderBase=k});define("infrastructure/snapping/SnappingLocations",["require","exports"],function(h,f){});define("infrastructure/snapping/SnappingProvider",["require","exports"],function(h,f){});define("infrastructure/ui/components/NumericInput/RangeConfiguration",["require","exports"],function(h,f){});
define("infrastructure/ui/components/ColorPicker/ColorPickerViewModel",["require","exports"],function(h,f){});define("infrastructure/ui/components/NumericInput/NumericInputViewModel",["require","exports"],function(h,f){});
define("infrastructure/symbology/widgets/SimpleSymbolWidgetViewModel","require exports geocortex/framework/ui/ViewModelBase geocortex/framework/observables infrastructure/symbology/SymbolColor infrastructure/ColorUtils infrastructure/SymbolUtils".split(" "),function(h,f,k,l,e,c,a){h=function(b){function d(){var a=null!==b&&b.apply(this,arguments)||this;a.configuring=!1;a.isPoint=new l.Observable(!1);a.isLine=new l.Observable(!1);a.isPolygon=new l.Observable(!1);a.showLineStyles=new l.Observable(!1);
a.showOutlineColor=new l.Observable(!1);a.noOutlineSymbol=new l.Observable(!1);a.markerSize=new l.Observable(10);a.markerSizeViewModel={range:{min:1,max:25,value:a.markerSize,step:1},showSlider:!0,updateOnDrag:!0};a.lineWidth=new l.Observable(2);a.lineWidthViewModel={range:{min:0,max:5,value:a.lineWidth,step:1},showSlider:!0,updateOnDrag:!0};a.fill={color:new l.Observable};a.outline={color:new l.Observable};a.initialized=!1;a.markerStyleIdLookup={circle:"esriSMSCircle",cross:"esriSMSCross",diamond:"esriSMSDiamond",
square:"esriSMSSquare",x:"esriSMSX"};a.lineStyleIdLookup={solid:"esriSLSSolid",dash:"esriSLSDash",dashdot:"esriSLSDashDot",longdashdotdot:"esriSLSDashDotDot",dot:"esriSLSDot",longdash:"esriSLSLongDash",longdashdot:"esriSLSLongDashDot",shortdash:"esriSLSShortDash",shortdashdot:"esriSLSShortDashDot",shortdashdotdot:"esriSLSShortDashDotDot",shortdot:"esriSLSShortDot"};a.fillStyleIdLookup={solid:"esriSFSSolid",horizontal:"esriSFSHorizontal",vertical:"esriSFSVertical",cross:"esriSFSCross",diagonalcross:"esriSFSDiagonalCross",
forwarddiagonal:"esriSFSForwardDiagonal",backwarddiagonal:"esriSFSBackwardDiagonal","null":"esriSFSNull"};a.markerStyles=new l.ObservableCollection([{style:esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,label:a.getResource("language-symbology-settings-marker-style-circle")},{style:esri.symbol.SimpleMarkerSymbol.STYLE_CROSS,label:a.getResource("language-symbology-settings-marker-style-cross")},{style:esri.symbol.SimpleMarkerSymbol.STYLE_DIAMOND,label:a.getResource("language-symbology-settings-marker-style-diamond")},
{style:esri.symbol.SimpleMarkerSymbol.STYLE_SQUARE,label:a.getResource("language-symbology-settings-marker-style-square")},{style:esri.symbol.SimpleMarkerSymbol.STYLE_X,label:a.getResource("language-symbology-settings-marker-style-x")}]);a.lineStyles=new l.ObservableCollection([{style:esri.symbol.SimpleLineSymbol.STYLE_SOLID,label:a.getResource("language-symbology-settings-line-style-solid"),styleId:"esriSLSSolid"},{style:esri.symbol.SimpleLineSymbol.STYLE_DASH,label:a.getResource("language-symbology-settings-line-style-dash"),
styleId:"esriSLSDash"},{style:esri.symbol.SimpleLineSymbol.STYLE_DASHDOT,label:a.getResource("language-symbology-settings-line-style-dashdot"),styleId:"esriSLSDashDot"},{style:esri.symbol.SimpleLineSymbol.STYLE_DASHDOTDOT,label:a.getResource("language-symbology-settings-line-style-dashdotdot"),styleId:"esriSLSDashDotDot"},{style:esri.symbol.SimpleLineSymbol.STYLE_DOT,label:a.getResource("language-symbology-settings-line-style-dot"),styleId:"esriSLSDot"},{style:esri.symbol.SimpleLineSymbol.STYLE_LONGDASH,
label:a.getResource("language-symbology-settings-line-style-longdash"),styleId:"esriSLSLongDash"},{style:esri.symbol.SimpleLineSymbol.STYLE_LONGDASHDOT,label:a.getResource("language-symbology-settings-line-style-longdashdot"),styleId:"esriSLSLongDashDot"},{style:esri.symbol.SimpleLineSymbol.STYLE_SHORTDASH,label:a.getResource("language-symbology-settings-line-style-shortdash"),styleId:"esriSLSShortDash"},{style:esri.symbol.SimpleLineSymbol.STYLE_SHORTDASHDOT,label:a.getResource("language-symbology-settings-line-style-shortdashdot"),
styleId:"esriSLSShortDashDot"},{style:esri.symbol.SimpleLineSymbol.STYLE_SHORTDASHDOTDOT,label:a.getResource("language-symbology-settings-line-style-shortdashdotdot"),styleId:"esriSLSShortDashDotDot"},{style:esri.symbol.SimpleLineSymbol.STYLE_SHORTDOT,label:a.getResource("language-symbology-settings-line-style-shortdot"),styleId:"esriSLSShortDot"}]);a.fillStyles=new l.ObservableCollection([{style:esri.symbol.SimpleFillSymbol.STYLE_SOLID,label:a.getResource("language-symbology-settings-fill-style-solid"),
styleId:"esriSFSSolid"},{style:esri.symbol.SimpleFillSymbol.STYLE_HORIZONTAL,label:a.getResource("language-symbology-settings-fill-style-horizontal"),styleId:"esriSFSHorizontal"},{style:esri.symbol.SimpleFillSymbol.STYLE_VERTICAL,label:a.getResource("language-symbology-settings-fill-style-vertical"),styleId:"esriSFSVertical"},{style:esri.symbol.SimpleFillSymbol.STYLE_CROSS,label:a.getResource("language-symbology-settings-fill-style-cross"),styleId:"esriSFSCross"},{style:esri.symbol.SimpleFillSymbol.STYLE_DIAGONAL_CROSS,
label:a.getResource("language-symbology-settings-fill-style-diagonal-cross"),styleId:"esriSFSDiagonalCross"},{style:esri.symbol.SimpleFillSymbol.STYLE_FORWARD_DIAGONAL,label:a.getResource("language-symbology-settings-fill-style-forward-diagonal"),styleId:"esriSFSForwardDiagonal"},{style:esri.symbol.SimpleFillSymbol.STYLE_BACKWARD_DIAGONAL,label:a.getResource("language-symbology-settings-fill-style-backward-diagonal"),styleId:"esriSFSBackwardDiagonal"}]);return a}__extends(d,b);d.prototype.initialize=
function(a){var b=this;void 0===a&&(a={});this.initialized&&(this.initialized=!1);var d=this.app.configModel.widgetConfigs.filter(function(a){return"SimpleSymbolWidget"===a.id})[0],e={};d?($.extend(e,d.configuration,a),this.config=e):this.config=a;null==this.config.showSliders&&(this.config.showSliders=!0);null==this.config.adaptOutlineToFill&&(this.config.adaptOutlineToFill=!0);this.isLine.bind(this,function(a){b.showLineStyles.set(a||b.isPolygon.get());b.config.userSelectedOutlineColor&&b.showOutlineColor.set(a||
b.isPolygon.get())});this.isPolygon.bind(this,function(a){b.showLineStyles.set(a||b.isLine.get());b.config.userSelectedOutlineColor&&b.showOutlineColor.set(a||b.isPoint.get())});this.isPoint.bind(this,function(a){b.showLineStyles.set(!a||b.isLine.get()||b.isPolygon.get());b.config.userSelectedOutlineColor&&b.showOutlineColor.set(!a||b.isPolygon.get()||b.isPoint.get())});this.config.markerSize=this.config.markerSize||{min:1,max:25,value:10,step:1};this.markerSize.set(this.config.markerSize.value);
this.markerSizeViewModel={range:{min:this.config.markerSize.min,max:this.config.markerSize.max,value:this.markerSize,step:this.config.markerSize.step},showSlider:this.config.showSliders,updateOnDrag:!0};this.config.lineWidth=this.config.lineWidth||{min:0,max:5,value:2,step:1};this.lineWidth.set(this.config.lineWidth.value);this.lineWidthViewModel={range:{min:this.config.lineWidth.min,max:this.config.lineWidth.max,value:this.lineWidth,step:this.config.lineWidth.step},showSlider:this.config.showSliders,
updateOnDrag:!0};void 0!==this.config.markerStyles&&(this.markerStyles.set(this.config.markerStyles),this.markerStyleIndex=0);void 0!==this.config.lineStyles&&(this.lineStyles.set(this.config.lineStyles),this.lineStyleIndex=0);void 0!==this.config.fillStyles&&(this.fillStyles.set(this.config.fillStyles),this.fillStyleIndex=0);void 0!==this.config.userSelectedOutlineColor&&this.showOutlineColor.set(this.config.userSelectedOutlineColor);this.fill.color.set(c.generateRandomColor());this.outline.color.set(0.7<=
this.fill.color.get().value?this.fill.color.get().darken(0.6):this.fill.color.get().lighten(0.8));this.initialized=!0};d.prototype._reset=function(){this.configuring=!0;this.markerSize.set(this.config.markerSize.value);this.lineWidth.set(this.config.lineWidth.value);this.fillStyleIndex=this.lineStyleIndex=this.markerStyleIndex=0;this.fill.color.set(c.generateRandomColor());this.outline.color.set(0.7<=this.fill.color.get().value?this.fill.color.get().darken(0.6):this.fill.color.get().lighten(0.8));
this.configuring=!1};d.prototype._setFeatureType=function(a){a=a.toLowerCase();-1<a.indexOf("point")?(this.isPoint.set(!0),this.isLine.set(!1),this.isPolygon.set(!1)):-1<a.indexOf("line")?(this.isLine.set(!0),this.isPoint.set(!1),this.isPolygon.set(!1)):(this.isPolygon.set(!0),this.isPoint.set(!1),this.isLine.set(!1))};d.prototype._getRenderer=function(){var a=null,a=this.isPoint.get()?new esri.renderer.SimpleRenderer(this.symbols.marker):this.isLine.get()?new esri.renderer.SimpleRenderer(this.symbols.line):
new esri.renderer.SimpleRenderer(this.symbols.fill);return JSON.stringify(a.toJson())};d.prototype._getSymbol=function(){var a=null,a=this.isPoint.get()?this.symbols.marker:this.isLine.get()?this.symbols.line:this.symbols.fill;return JSON.stringify(a.toJson())};d.prototype._setFromRenderer=function(a){a=a.toJson();"simple"===a.type&&a.symbol&&"esriPMS"!==a.symbol.type&&this._setFromSymbolObject(a.symbol)};d.prototype._setFromSymbol=function(a){!a||a instanceof esri.symbol.PictureMarkerSymbol||this._setFromSymbolObject(a.toJson())};
d.prototype._setFromSymbolObject=function(b){var d=this;this.configuring=!0;b.color&&this.fill.color.set(new e.SymbolColor({r:b.color[0]/255,g:b.color[1]/255,b:b.color[2]/255,a:b.color[3]/255}));var c,f;for(f in this.markerStyleIdLookup)if(this.markerStyleIdLookup.hasOwnProperty(f)&&b.style===this.markerStyleIdLookup[f]){c=f;break}b.outline&&(this.outline.color.set(new e.SymbolColor({r:b.outline.color[0]/255,g:b.outline.color[1]/255,b:b.outline.color[2]/255,a:b.outline.color[3]/255})),c!==esri.symbol.SimpleMarkerSymbol.STYLE_CROSS&&
c!==esri.symbol.SimpleMarkerSymbol.STYLE_X||this.fill.color.set(this.outline.color.get()));f=this.markerStyles.getItems().filter(function(a){return a.style===c})[0];this.markerSize.set($.isNumeric(b.size)?Math.floor(b.size*a.POINTS_TO_PIXELS):this.config.markerSize.value);this.markerStyleIndex=f?this.markerStyles.indexOf(f):0;var h=this.isLine.get()?b:b.outline;h?(this.lineWidth.set($.isNumeric(h.width)?Math.floor(h.width*a.POINTS_TO_PIXELS):this.config.lineWidth.value),this.lineStyleIndex=h.style?
this.lineStyles.indexOf(this.lineStyles.getItems().filter(function(a){return d.lineStyleIdLookup[a.style]===h.style})[0]):0):(this.lineWidth.set(0),this.lineStyleIndex=0);this.fillStyleIndex=(f=this.fillStyles.getItems().filter(function(a){return d.fillStyleIdLookup[a.style]===b.style})[0])?this.fillStyles.indexOf(f):0;this.configuring=!1};return d}(k.ViewModelBase);f.SimpleSymbolWidgetViewModel=h});define("infrastructure/symbology/widgets/SymbologyWidget",["require","exports"],function(h,f){});
define("infrastructure/symbology/widgets/SimpleSymbolWidget",["require","exports","geocortex/framework/ui/ViewBase","infrastructure/symbology/SymbologySettingsView"],function(h,f,k,l){h=function(e){function c(){var a=null!==e&&e.apply(this,arguments)||this;a.displayName=a.app.getResource(a.libraryId,"language-symbology-settings-symbol-displayname");return a}__extends(c,e);c.prototype.attach=function(a){var b=this;a.initialized||a.initialize(this.configuration);e.prototype.attach.call(this,a);this.viewModel.fill.color.bind(this,
function(){b.viewModel.configuring||b.applySettings()});this.viewModel.outline.color.bind(this,function(){b.viewModel.configuring||b.applySettings()});this.viewModel.lineWidth.bind(this,function(){b.viewModel.configuring||b.applySettings()});this.viewModel.markerSize.bind(this,function(){b.viewModel.configuring||b.applySettings()})};c.prototype.added=function(a){a&&(a.symbologyWidget=this,e.prototype.added.call(this,a))};c.prototype.activated=function(){var a=this;setTimeout(function(){a.viewModel.configuring=
!0;a.viewModel.fill.color.pulse();a.viewModel.outline.color.pulse();a.viewModel.lineWidth.pulse();a.viewModel.markerSize.pulse();a.viewModel.configuring=!1},0)};c.prototype.reset=function(){this.viewModel._reset()};c.prototype.getSymbol=function(){(!this.viewModel.symbols||this.viewModel.symbols.marker instanceof esri.symbol.PictureMarkerSymbol)&&this.applySettings();return this.viewModel._getSymbol()};c.prototype.setFromSymbol=function(a,b){void 0===b&&(b=!0);this.viewModel._setFromSymbol(a);b&&
this.applySettings()};c.prototype.getRenderer=function(){return this.viewModel._getRenderer()};c.prototype.setFromRenderer=function(a){this.viewModel._setFromRenderer(a)};c.prototype.setFeatureType=function(a){this.viewModel._setFeatureType(a)};c.prototype.handleMarkerStyle=function(){this.viewModel.markerStyleIndex=this.markerStyleInput.selectedIndex;this.applySettings()};c.prototype.handleLineStyle=function(){this.viewModel.lineStyleIndex=this.lineStyleInput.selectedIndex;this.applySettings()};
c.prototype.handleFillStyle=function(){this.viewModel.fillStyleIndex=this.fillStyleInput.selectedIndex;this.applySettings()};c.prototype.applySettings=function(){if(this.viewModel.initialized&&!this.viewModel.configuring){this.viewModel.configuring=!0;0>this.viewModel.markerStyleIndex&&(this.viewModel.markerStyleIndex=0);0>this.viewModel.lineStyleIndex&&(this.viewModel.lineStyleIndex=0);0>this.viewModel.fillStyleIndex&&(this.viewModel.fillStyleIndex=0);this.markerStyleInput&&(this.markerStyleInput.selectedIndex=
this.viewModel.markerStyleIndex||0);this.lineStyleInput&&(this.lineStyleInput.selectedIndex=this.viewModel.lineStyleIndex||0);this.fillStyleInput&&(this.fillStyleInput.selectedIndex=this.viewModel.fillStyleIndex||0);var a=this.viewModel.fill.color.get(),b=this.viewModel.outline.color.get(),d=this.viewModel.markerStyles.getAt(this.viewModel.markerStyleIndex||0).style,c=d===esri.symbol.SimpleMarkerSymbol.STYLE_CROSS||d===esri.symbol.SimpleMarkerSymbol.STYLE_X;c&&this.viewModel.isPoint.get()&&!this.viewModel.isLine.get()&&
!this.viewModel.isPolygon.get()?this.viewModel.noOutlineSymbol.set(!0):this.viewModel.noOutlineSymbol.set(!1);var e=this.viewModel.lineStyles.getAt(this.viewModel.lineStyleIndex||0).style,f=this.viewModel.fillStyles.getAt(this.viewModel.fillStyleIndex||0).style,h=this.viewModel.markerSize.get(),k=this.viewModel.lineWidth.get(),s=new esri.symbol.SimpleLineSymbol;c?s.setColor(a.toEsriColor()):s.setColor(this._getOutlineColor(a,b));s.setStyle(esri.symbol.SimpleLineSymbol.STYLE_SOLID);s.setWidth(c?k||
1:k);c=new esri.symbol.SimpleMarkerSymbol;c.setColor(a.toEsriColor());c.setStyle(d);c.setSize(h);c.setOutline(s);d=new esri.symbol.SimpleLineSymbol;d.setColor(a.toEsriColor());d.setStyle(e);d.setWidth(k||1);h=new esri.symbol.SimpleLineSymbol;h.setColor(this._getOutlineColor(a,b));h.setStyle(e);h.setWidth(k);b=new esri.symbol.SimpleFillSymbol;b.setColor(a.toEsriColor());b.setStyle(f);b.setOutline(h);this.viewModel.symbols={marker:c,line:d,fill:b};if(this.onChange&&this.isActive&&(!this.viewModel.parentSymbologyView||
this.viewModel.parentSymbologyView.isActive))if(this.viewModel.isLine.get())this.onChange(JSON.stringify(d.toJson()));else if(this.viewModel.isPolygon.get())this.onChange(JSON.stringify(b.toJson()));else if(this.viewModel.isPoint.get())this.onChange(JSON.stringify(c.toJson()));this.viewModel.parentSymbologyView instanceof l.SymbologySettingsView&&this.viewModel.parentSymbologyView.applySettings(!1);this.viewModel.configuring=!1}};c.prototype._getOutlineColor=function(a,b){return this.viewModel.showOutlineColor.get()?
b.toEsriColor():this.viewModel.config.adaptOutlineToFill?0.7<=a.value?a.darken(0.5).toEsriColor(!1):a.lighten(0.9).toEsriColor(!1):a.darken(0.5).toEsriColor(!1)};return c}(k.ViewBase);f.SimpleSymbolWidget=h});define("infrastructure/symbology/MarkupTemplates",["require","exports"],function(h,f){});define("infrastructure/symbology/widgets/PictureSymbolWidgetConfig",["require","exports"],function(h,f){});
define("infrastructure/symbology/widgets/PictureSymbolWidgetViewModel","require exports geocortex/framework/ui/ViewModelBase geocortex/framework/observables infrastructure/SymbolUtils geocortex/framework-ui/LazyObservable geocortex/essentials/utilities/UrlUtilities".split(" "),function(h,f,k,l,e,c,a){h=function(b){function d(a,d){var c=b.call(this,a,d)||this;c.initialized=!1;c.imageLibraries=new l.ObservableCollection(["Shapes"]);c.currentLibrary=new l.Observable("");c.noLibraries=new l.Observable(!1);
c.imageTemplates={};c.currentImages=new l.ObservableCollection([]);c.showLibrarySwitcher=new l.Observable(!1);c.loading=!1;c.imageSize=new l.Observable(32);c.imageSizeViewModel={range:{min:16,max:64,value:c.imageSize,step:1},showSlider:!0,updateOnDrag:!0};c.imageRotation=new l.Observable(0);c.imageRotationViewModel={range:{min:0,max:360,value:c.imageRotation,step:1},showSlider:!0,updateOnDrag:!0};c.imageHeight=new l.Observable(32);c.imageWidth=new l.Observable(32);c.imageSwatchIdBase="__IMAGESWATCH__";
c.currentImage=new l.Observable(null);return c}__extends(d,b);d.prototype.initialize=function(a){var b=this;void 0===a&&(a={});if(!this.initialized){var d=this.app.configModel.widgetConfigs.filter(function(a){return"PictureSymbolWidget"===a.id})[0],c={};d?($.extend(c,d.configuration,a),this.config=c):this.config=a;void 0!==this.config.imageLibraries&&$.isArray(this.config.imageLibraries)&&this.imageLibraries.set(this.config.imageLibraries);1<this.imageLibraries.getLength()&&this.showLibrarySwitcher.set(!0);
this.currentLibrary.set(this.imageLibraries.getAt(0));this.config.imageSize=this.config.imageSize||{min:16,max:64,value:32,step:1};this.imageSize.set(this.config.imageSize.value);this.imageSizeViewModel={range:{min:this.config.imageSize.min,max:this.config.imageSize.max,value:this.imageSize,step:this.config.imageSize.step},showSlider:null!=this.config.showSliders?this.config.showSliders:!0,updateOnDrag:!0};this.imageRotationViewModel.showSlider=null!=this.config.showSliders?this.config.showSliders:
!0;this.imageHeight.sync(this.imageSize);this.imageWidth.syncTransform(this.imageSize,function(a){return a*(b.currentImage.get()?b.currentImage.get().widthRatio:1)});this.currentLibrary.bind(this,function(a){var d=function(a){b.currentImage.set(null);for(var d=0;d<a.length;d++)if(a[d].selected.get()){b.currentImage.set(a[d]);break}b.currentImage.get()||(a[0].selected.set(!0),b.currentImage.set(a[0]));b.currentImages.set(a)},c=b.imageTemplates[a];c?d(c):b._loadImages(a).then(function(a){a&&0<a.length?
d(a):0<b.imageLibraries.getLength()&&b.currentLibrary.set(b.imageLibraries.getAt(0))})});this.initialized=!0}};d.prototype.loadAllLibraries=function(){var a=this;return new Promise(function(b,d){for(var c=[],e=0;e<a.imageLibraries.getLength();e++){var f=a.imageLibraries.getAt(e);a.imageTemplates[f]||c.push(a._loadImages(f))}0<c.length?Promise.all(c).then(function(){b()}):b()})};d.prototype._setFromSymbol=function(a){var b=this;return new Promise(function(d,c){b._checkForSymbol(a)?d():b._addNewTemplateFromSymbol(a).then(function(){return d()})})};
d.prototype._checkForSymbol=function(a){for(var b=this,d=null,c=this._getHashForSymbol(a),e=[],f,h=0;h<this.imageLibraries.getLength();h++)if(f=this.imageLibraries.getAt(h),e=this.imageTemplates[f])if(d=e.filter(function(a){return a.hash.get()===c})[0])break;if(d){this.currentLibrary.set(f);this.currentImage.set(d);for(f=0;f<e.length;f++)e[f].selected.set(!1);d.selected.set(!0);this.imageSize.set(a.height);this.imageRotation.set(a.angle);setTimeout(function(){var a=$("#"+d.id,b.viewRoot)[0];a&&a.scrollIntoView()},
200)}return d};d.prototype._addNewTemplateFromSymbol=function(a){var b=this;return new Promise(function(d,f){var h=new Image,k=b._getHashForSymbol(a);h.onload=function(){var f=b.imageSwatchIdBase+b.currentImages.getLength(),n=e.webMapAngleToJSAPIAngle(a.angle),u={type:"image",name:"",selected:new l.Observable(!0),url:a.url,size:h.height,widthRatio:h.width/h.height,xoffset:a.xoffset/a.width,yoffset:a.yoffset/a.height,angle:n,id:f,hash:new c.LazyObservable(k),toSymbol:function(){return b._imageTemplateToSymbol(u)},
toJsonString:function(){return JSON.stringify(u.toSymbol().toJson())}};b.imageTemplates[b.currentLibrary.get()].push(u);b.currentImages.addItem(u);b.currentImage.set(u);b.imageSize.set(a.height);(f=$("#"+f,b.viewRoot)[0])&&f.scrollIntoView();d()};h.src=a.url})};d.prototype._loadImages=function(b){var d=this;this.loading=!0;var f=[];return new Promise(function(h,k){if(4.07>d.app.site.getEssentialsVersion())d._handleInvalidLibrary(b),d.loading=!1,d.app.trace.debug("Could not load symbol library '{0}'. Essentials 4.7 or newer is required.".format(b)),
h(null);else{var s=/^(.*?)(\/*)$/.exec(d.app.site.originalUrl)[1],r=a.UrlUtilities.simplify(s+"/../../symbols/image/{0}".format(b));esri.request({url:r,content:{f:"json"},handleAs:"json"}).then(function(a){var k=a&&a.symbols;if(!$.isArray(k))throw Error(d.getResource("language-symbology-errors-malformed-library").format(b));a=function(a){var h=esri.symbol.fromJson(k[a]);if(h&&h instanceof esri.symbol.PictureMarkerSymbol){var n=e.webMapAngleToJSAPIAngle(h.angle);"Images"==b&&h.url&&(h.url=r+h.url);
var p={type:"image",name:k[a].name||"",selected:new l.Observable(a?!1:!0),url:h.url,size:h.height,widthRatio:h.width/h.height,xoffset:h.xoffset/h.width,yoffset:h.yoffset/h.height,angle:n,id:d.imageSwatchIdBase+a,hash:new c.LazyObservable(null,function(){return d._getHashForSymbol(p.toSymbol())},!0),toSymbol:function(){return d._imageTemplateToSymbol(p)},toJsonString:function(){return JSON.stringify(p.toSymbol().toJson())}};f.push(p)}};for(var p=0;p<k.length;p++)a(p);0===f.length?d._handleInvalidLibrary(b):
d.imageTemplates[b]=f;d.loading=!1;h(f)},function(a){d._handleInvalidLibrary(b);d.loading=!1;k(a)})}})};d.prototype._handleInvalidLibrary=function(a){this.imageLibraries.removeItem(a);1===this.imageLibraries.getLength()&&this.showLibrarySwitcher.set(!1);0===this.imageLibraries.getLength()&&(this.showLibrarySwitcher.set(!1),this.currentImages.set([]),this.currentImage.set(null),this.noLibraries.set(!0))};d.prototype._getRenderer=function(){var a=null,a=new esri.renderer.SimpleRenderer(this.currentImage.get().toSymbol());
return JSON.stringify(a.toJson())};d.prototype._reset=function(){this.currentLibrary.set(this.imageLibraries.getAt(0));var a=this.imageTemplates[this.currentLibrary.get()];if(a&&0<a.length){for(var b=0;b<a.length;b++)a[b].selected.set(!1);a[0].selected.set(!0);this.currentImage.set(a[0])}};d.prototype._getHashForSymbol=function(a){var b="",b=0===a.url.indexOf("data")?a.url.substring(a.url.indexOf(",")+1):a.url;return e.stringToHash(b)};d.prototype._imageTemplateToSymbol=function(a){var b=new esri.symbol.PictureMarkerSymbol(a.url,
this.imageWidth.get(),this.imageHeight.get());b.setAngle(this.imageRotation.get());a=e.rotate(0,0,a.xoffset*b.width,a.yoffset*b.height,b.angle);b.setOffset(a.x,a.y);return b};return d}(k.ViewModelBase);f.PictureSymbolWidgetViewModel=h});
define("infrastructure/symbology/SymbologySettingsView",["require","exports","geocortex/framework/ui/ViewBase","infrastructure/symbology/widgets/PictureSymbolWidgetViewModel","geocortex/framework/utils/utils"],function(h,f,k,l,e){h=function(c){function a(a,d){var e=c.call(this,a,d)||this;e.displayName=e.app.getResource(e.libraryId,"language-symbology-settings-symbol-displayname");return e}__extends(a,c);a.prototype.attach=function(a){c.prototype.attach.call(this,a);this.viewModel=a;this.pictureSymbologyWidget&&
(this.pictureSymbologyWidget.viewModel.parentSymbologyView=this);this.symbologyWidget.viewModel.parentSymbologyView=this;this.viewModel.imageSelector=this.pictureSymbologyWidget;this.viewModel.symbolSelector=this.symbologyWidget;this.viewModel.initialize(this.configuration)};a.prototype.added=function(a){a&&(a.symbologySettingsWidget=this,c.prototype.added.call(this,a))};a.prototype.resolveWidget=function(a,d,f){c.prototype.resolveWidget.call(this,a,d);if("CustomizedPictureSymbolWidget"===a&&this.configuration.enableImageSelector)return a=
"PictureSymbolWidget-"+e.alphaNumericToken(),this.pictureSymbologyWidget=this.app.viewManager.createView({viewId:a,markupResource:"Mapping/infrastructure/symbology/widgets/PictureSymbolWidget.html",typeName:"geocortex.essentialsHtmlViewer.mapping.infrastructure.symbology.PictureSymbolWidget",isVisible:!0,libraryId:"Mapping.Infrastructure"}),this.pictureSymbologyWidget.configuration=this.configuration.pictureSymbologyConfig,a=new l.PictureSymbolWidgetViewModel(this.app,"Mapping.Infrastructure"),this.pictureSymbologyWidget.attach(a),
this.pictureSymbologyWidget;this.pictureSymbologyWidget=null;return"<div/>"};a.prototype.applySettings=function(a){void 0===a&&(a=!0);a&&(this.viewModel.symbolSelector.applySettings(),this.viewModel.imageSelector&&this.viewModel.imageSelector.applySettings());this.viewModel.symbols=this.viewModel.symbolSelector.viewModel.symbols;a=this._getCurrentWidget();this.viewModel.imageSelector&&a&&"Image"===a.displayName&&(a=this.viewModel.imageSelector.getSymbol())&&(this.viewModel.symbols.marker=new esri.symbol.PictureMarkerSymbol(JSON.parse(a)))};
a.prototype.setFeatureType=function(a){this.viewModel._setFeatureType(a)};a.prototype.getSymbol=function(){return this.viewModel._getSymbol()};a.prototype.setFromSymbol=function(a){this.viewModel._setFromSymbol(a)};a.prototype.setFromRenderer=function(a){this.viewModel._setFromRenderer(a)};a.prototype.reset=function(){this.viewModel._reset()};a.prototype._getCurrentWidget=function(){var a=this.viewModel.currentWidget.get(),d=a?a.id:this.symbologyWidget.id;return this.viewModel.symbologyWidgets.getItems().filter(function(a){return a.id===
d})[0]};return a}(k.ViewBase);f.SymbologySettingsView=h});define("infrastructure/symbology/widgets/MarkupStyleWidget",["require","exports"],function(h,f){});
define("infrastructure/symbology/widgets/PictureSymbolWidget",["require","exports","geocortex/framework/ui/ViewBase","infrastructure/symbology/SymbologySettingsView"],function(h,f,k,l){h=function(e){function c(){var a=null!==e&&e.apply(this,arguments)||this;a.displayName=a.app.getResource(a.libraryId,"language-symbology-settings-image-displayname");a.isMarkupView=!1;return a}__extends(c,e);c.prototype.attach=function(a){var b=this;a.initialize(this.configuration);e.prototype.attach.call(this,a);a.viewRoot=
this.root;this.viewModel.currentImage.bind(this,function(a){b.viewModel.imageSize.unbind(b._imageSizeToken);b.viewModel.imageRotation.unbind(b._imageRotationToken);a&&a!==b.viewModel.currentImage.get()?(b.viewModel.imageSize.set(a.size),b.viewModel.imageRotation.set(a.angle||0)):(b.viewModel.imageSize.pulse(),b.viewModel.imageRotation.pulse());b.applySettings();b.bindSymbolSettings()});this.app.event("MarkupSymbolChangedEvent").subscribe(this,function(a){b.viewModel.markupSymbol=a});this.bindSymbolSettings()};
c.prototype.bindSymbolSettings=function(){var a=this;this._imageSizeToken=this.viewModel.imageSize.bind(this,function(b){b&&a.applySettings()});this._imageRotationToken=this.viewModel.imageRotation.bind(this,function(b){$.isNumeric(b)&&a.applySettings()})};c.prototype.added=function(a){a&&(a.pictureSymbologyWidget=this,e.prototype.added.call(this,a))};c.prototype.activated=function(){var a=this;if(!this.viewModel.loading){var b=function(){0===a.viewModel.currentImages.getLength()&&a.viewModel.currentLibrary.pulse();
setTimeout(function(){a.viewModel.currentImage.pulse()},100);var b=a.viewModel.currentImage.get();b&&(b=$("#"+b.id,a.root)[0])&&!a._isSwatchVisible(b)&&b.scrollIntoView()},d=this.app.site;if(d&&d.isInitialized)b();else this.app.event("SiteInitializedEvent").once(this,b)}};c.prototype.updateSymbol=function(a){if(a instanceof esri.symbol.PictureMarkerSymbol)return this.setFromSymbol(a),Promise.resolve(!0);this.applySettings();return Promise.resolve(!1)};c.prototype.reset=function(){this.viewModel._reset()};
c.prototype.getSymbol=function(){return this.viewModel.currentImage.get()?this.viewModel.currentImage.get().toJsonString():""};c.prototype.setFromSymbol=function(a){var b=this;a instanceof esri.symbol.PictureMarkerSymbol&&(this.viewModel._checkForSymbol(a)||this.viewModel.loadAllLibraries().then(function(){b.viewModel._setFromSymbol(a).then(function(){b.viewModel.imageSize.pulse()})}))};c.prototype.getRenderer=function(){return this.viewModel._getRenderer()};c.prototype.setFromRenderer=function(a){a=
a.toJson();"simple"===a.type&&a.symbol&&"esriPMS"===a.symbol.type&&this.setFromSymbol(new esri.symbol.PictureMarkerSymbol(a.symbol))};c.prototype.applySettings=function(){var a=this.viewModel.currentImage.get();if(0!==this.viewModel.imageLibraries.getLength()&&a){var b=$("#"+a.id,this.root)[0];b&&!this._isSwatchVisible(b)&&b.scrollIntoView();if(this.onChange&&this.isActive&&(!this.viewModel.parentSymbologyView||this.viewModel.parentSymbologyView.isActive))this.onChange(a.toJsonString());this.viewModel.parentSymbologyView instanceof
l.SymbologySettingsView&&this.viewModel.parentSymbologyView.applySettings(!1)}};c.prototype.handleClickSwatch=function(a){var b=a.target;if(a=this.viewModel.currentImages.getItems().filter(function(a){return(b.id||b.parentElement.id)===a.id})[0]){for(var d=0,c=this.viewModel.currentImages.getItems();d<c.length;d++)c[d].selected.set(!1);a.selected.set(!0);this.viewModel.currentImage.set(a)}};c.prototype._isSwatchVisible=function(a){var b=a.getBoundingClientRect();return a.contains(document.elementFromPoint(b.left,
b.top))||a.contains(document.elementFromPoint(b.right,b.top))||a.contains(document.elementFromPoint(b.right,b.bottom))||a.contains(document.elementFromPoint(b.left,b.bottom))};return c}(k.ViewBase);f.PictureSymbolWidget=h});
define("infrastructure/symbology/SymbologySettingsViewModel",["require","exports","geocortex/framework/ui/ViewModelBase","geocortex/framework/observables"],function(h,f,k,l){h=function(e){function c(){var a=null!==e&&e.apply(this,arguments)||this;a.noMarker=new l.Observable(!1);a.noFill=new l.Observable(!1);a.isPoint=new l.Observable(!1);a.isLine=new l.Observable(!1);a.isPolygon=new l.Observable(!1);a.showSymbologySelectorMenu=new l.Observable(!1);a.symbolizeWithImagery=new l.Observable(!1);a.symbologyWidgets=
new l.ObservableCollection([]);a.currentWidget=new l.Observable(null);return a}__extends(c,e);c.prototype.initialize=function(a){var b=this;void 0===a&&(a={});var d=this.app.configModel.widgetConfigs.filter(function(a){return"SymbologySettings"===a.id})[0],c={};d?($.extend(c,d.configuration,a),this.config=c):this.config=a;if(null==this.config.enableImageSelector||this.config.enableImageSelector)this.imageSelector.viewModel.initialize(this.config.pictureSymbologyConfig||{}),this.symbologyWidgets.addItem(this.imageSelector),
this.isPoint.bind(this,function(a){a?b.showSymbologySelectorMenu.set(!0):(b.showSymbologySelectorMenu.set(!1),b.currentWidget.set(b.symbolSelector))});this.symbolSelector.viewModel.initialize(this.config.symbologyConfig);this.symbologyWidgets.addItem(this.symbolSelector);this.currentWidget.set(this.symbolSelector);this.isPoint.bind(this,function(a){b.symbolSelector.viewModel.isPoint.set(a)});this.isLine.bind(this,function(a){b.symbolSelector.viewModel.isLine.set(a)});this.isPolygon.bind(this,function(a){b.symbolSelector.viewModel.isPolygon.set(a)});
this.noFill.bind(this,function(a){b.isLine.set(a);b.isPoint.set(!b.noMarker.get()&&!a);b.isPolygon.set(!a)});this.noMarker.bind(this,function(a){b.isPoint.set(!a);b.isLine.set(b.noFill.get()&&a);b.isPolygon.set(a)});this.symbolizeWithImagery.syncTransform(this.currentWidget,function(a){return a&&b.imageSelector&&a.id===b.imageSelector.id?(setTimeout(function(){b.imageSelector.activated()},100),!0):!1})};c.prototype._reset=function(){for(var a=0,b=this.symbologyWidgets.getItems();a<b.length;a++)b[a].reset();
this.currentWidget.set(this.symbolSelector)};c.prototype._setFeatureType=function(a){a=a.toLowerCase();-1<a.indexOf("point")?(this.isPoint.set(!0),this.isLine.set(!1),this.isPolygon.set(!1)):-1<a.indexOf("line")?(this.isLine.set(!0),this.isPoint.set(!1),this.isPolygon.set(!1)):(this.isPolygon.set(!0),this.isPoint.set(!1),this.isLine.set(!1))};c.prototype._getRenderer=function(){var a=null,a=new esri.renderer.SimpleRenderer(esri.symbol.fromJson(JSON.parse(this._getSymbol())));return JSON.stringify(a.toJson())};
c.prototype._getSymbol=function(){if(this.currentWidget.get())return this.currentWidget.get().getSymbol()};c.prototype._setFromRenderer=function(a){a=a.toJson();"simple"===a.type&&a.symbol&&this._setFromSymbol(esri.symbol.fromJson(a.symbol))};c.prototype._setFromSymbol=function(a){a instanceof esri.symbol.PictureMarkerSymbol&&this.imageSelector&&this.currentWidget.set(this.imageSelector);this.currentWidget&&this.currentWidget.get().setFromSymbol(a)};return c}(k.ViewModelBase);f.SymbologySettingsViewModel=
h});define("infrastructure/symbology/widgets/SimpleSymbolWidgetConfig",["require","exports"],function(h,f){});define("infrastructure/symbology/SymbologySettingsConfig",["require","exports"],function(h,f){});define("infrastructure/symbology/AttributeSymbologySettingsConfig",["require","exports"],function(h,f){});
define("infrastructure/symbology/DataClassificationUtils",["require","exports"],function(h,f){function k(c,a){for(var b=[],d=0;d<c;d++){for(var e=[],f=0;f<a;f++)e.push(0);b.push(e)}return b}function l(c){for(var a=0,b,d=0;d<c.length;d++)if(0===d||c[d]!=b)b=c[d],a++;return a}function e(){return(1.1).toLocaleString().substring(1,2)}f.ckmeans=function(c,a){if(a>c.length)return[];var b=c.slice().sort(function(a,b){return a-b});l(b);for(var d=k(a,b.length),e=k(a,b.length),f=0;f<a;f++)for(var h=b[0],n=
Math.max(f,1);n<b.length;n++)if(0===f){var p=Math.pow(b[n]-h,2);d[f][n]=d[f][n-1]+n/(n+1)*p;h=(n*h+b[n])/(n+1)}else for(var s=p=0,r=n;r>=f;r--)p+=(n-r)/(n-r+1)*Math.pow(b[r]-s,2),s=(b[r]+(n-r)*s)/(n-r+1),r===n?(d[f][n]=p,e[f][n]=r,0<r&&(d[f][n]+=d[f-1][r-1])):p+d[f-1][r-1]<d[f][n]&&(d[f][n]=p+d[f-1][r-1],e[f][n]=r);d=[];h=e[0].length-1;for(f=e.length-1;0<=f;f--)n=e[f][h],d[f]=b.slice(n,h+1),0<f&&(h=n-1);return d};f.createMatrix=k;f.uniqueCountSorted=l;f.findSignificanceFactor=function(c){var a=e(),
b=c.filter(function(a){return null!==a}).map(function(b){return(b=b.toString().split(a)[1])?parseFloat(b)/Math.pow(10,b.length):0}),d=c.filter(function(a){return null!==a}).map(function(a){return Math.floor(a)});c=Math.min.apply(Math,d.filter(function(a){return 0!==a}));var f;f=0===c||Infinity===c?0:Math.floor(Math.log(Math.abs(c))/Math.LN10);var d=Math.max.apply(Math,d),h;0===d?f=0:h=Math.floor(Math.log(Math.abs(d))/Math.LN10);h-=f;f=Math.max.apply(Math,b.filter(function(a){return 0!==a}));if(0===
f||Infinity===Math.abs(f))return b=Math.floor(Math.log(Math.abs(d-c))/Math.LN10),Math.pow(10,0>h-b?0:h-b);c=Math.floor(Math.log(Math.abs(f))/Math.LN10);d=Math.min.apply(Math,b.filter(function(a){return 0!==a}));d=0===d||Infinity===Math.abs(d)?0:Math.floor(Math.log(Math.abs(d))/Math.LN10);return 1>=c-d?(b=b.map(function(b){return(b=b.toString().split(a)[1])?b.length:0}),b=Math.max.apply(Math,b),Math.pow(10,-b)):Math.pow(10,d+h)};f.getDecimalSeparator=e});
define("infrastructure/symbology/AttributeSymbologySettingsViewModel","require exports geocortex/essentials/Field infrastructure/gis/FieldInfo infrastructure/symbology/SymbologySettingsViewModel geocortex/framework/ui/ViewModelBase geocortex/framework/observables infrastructure/symbology/SymbolColor infrastructure/ColorUtils infrastructure/symbology/DataClassificationUtils infrastructure/symbology/AttributeSymbologySettingsView infrastructure/LayerIntegrationUtils infrastructure/TaskUtils infrastructure/commandArgs/AddStatusArgs infrastructure/SymbolUtils".split(" "),
function(h,f,k,l,e,c,a,b,d,g,m,q,n,p,s){h=function(c){function f(){var b=null!==c&&c.apply(this,arguments)||this;b.attributes=new a.ObservableCollection;b.currentAttribute=new a.Observable("");b.classBreaksMode=new a.Observable(!1);b.isNumericAttribute=new a.Observable(!1);b.symbologyClasses=new a.ObservableCollection([]);b.classSymbolWidgets=[];b.startColor={color:new a.Observable};b.endColor={color:new a.Observable};b.numBreaks=new a.Observable(5);b.markerSize=new a.Observable(10);b.lineWidth=new a.Observable(2);
b.transparency=new a.Observable(10);b.noMarker=new a.Observable(!1);b.markerStyles=new a.ObservableCollection([{style:esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,label:b.getResource("language-symbology-settings-marker-style-circle")},{style:esri.symbol.SimpleMarkerSymbol.STYLE_CROSS,label:b.getResource("language-symbology-settings-marker-style-cross")},{style:esri.symbol.SimpleMarkerSymbol.STYLE_DIAMOND,label:b.getResource("language-symbology-settings-marker-style-diamond")},{style:esri.symbol.SimpleMarkerSymbol.STYLE_SQUARE,
label:b.getResource("language-symbology-settings-marker-style-square")},{style:esri.symbol.SimpleMarkerSymbol.STYLE_X,label:b.getResource("language-symbology-settings-marker-style-x")}]);b.markerStyleIdLookup={circle:"esriSMSCircle",cross:"esriSMSCross",diamond:"esriSMSDiamond",square:"esriSMSSquare",x:"esriSMSX"};b.configuring=!1;b.creatingClasses=!1;b.numericAttributeIsUniqueValue=!1;b.queryResults=[];return b}__extends(f,c);f.prototype.initialize=function(a){void 0===a&&(a={});this.config=a;var b=
this.app.configModel.widgetConfigs.filter(function(a){return"AttributeSymbologySettings"===a.id})[0],c={};b?($.extend(c,b.configuration,a),this.config=c):this.config=a;a=this.config.classSymbolizationConfig||{};a.symbologyConfig||(a.symbologyConfig={});a.pictureSymbologyConfig||(a.pictureSymbologyConfig={});this.maxRenderClasses=1<this.config.maxRenderClasses?this.config.maxRenderClasses:12;this.maxSamples=this.config.maxSamples||1E3;this.classBreaksInput={range:{min:2,max:this.maxRenderClasses,value:this.numBreaks,
step:1},showSlider:this.config.showSliders,updateOnDrag:!1};this.config.transparency=this.config.transparency||{min:0,max:100,value:10,step:5};this.transparency.set(this.config.transparency.value);this.transparencyInput={range:{min:this.config.transparency.min,max:this.config.transparency.max,value:this.transparency,step:this.config.transparency.step},showSlider:this.config.showSliders,updateOnDrag:!0};this.config.classSymbolizationConfig.symbologyConfig.markerSize=this.config.classSymbolizationConfig.symbologyConfig.markerSize||
{min:0,max:50,value:16,step:1};this.markerSize.set(this.config.classSymbolizationConfig.symbologyConfig.markerSize.value);this.markerSizeInput={range:{min:this.config.classSymbolizationConfig.symbologyConfig.markerSize.min,max:this.config.classSymbolizationConfig.symbologyConfig.markerSize.max,value:this.markerSize,step:this.config.classSymbolizationConfig.symbologyConfig.markerSize.step},showSlider:this.config.showSliders,updateOnDrag:!0};this.config.classSymbolizationConfig.symbologyConfig.lineWidth=
this.config.classSymbolizationConfig.symbologyConfig.lineWidth||{min:0,max:10,value:2,step:1};this.lineWidth.set(this.config.classSymbolizationConfig.symbologyConfig.lineWidth.value);this.lineWidthInput={range:{min:this.config.classSymbolizationConfig.symbologyConfig.lineWidth.min,max:this.config.classSymbolizationConfig.symbologyConfig.lineWidth.max,value:this.lineWidth,step:this.config.classSymbolizationConfig.symbologyConfig.lineWidth.step},showSlider:this.config.showSliders,updateOnDrag:!0};for(a=
0;a<this.maxRenderClasses;a++)b=void 0,b=this.app.viewManager.createView({markupResource:"Mapping/infrastructure/symbology/SymbologySettingsView.html",typeName:"geocortex.essentialsHtmlViewer.mapping.infrastructure.symbology.SymbologySettingsView",isVisible:!0,libraryId:"Mapping.Infrastructure"}),c=new e.SymbologySettingsViewModel(this.app,"Mapping.Infrastructure"),b.configuration=this.config.classSymbolizationConfig,b.attach(c),b.applySettings(),this.classSymbolWidgets.push(b);this.markerStyles.set(this.classSymbolWidgets[0].symbologyWidget.viewModel.markerStyles.getItems());
this.markerStyleIndex=0;a=d.generateRandomColor();this.startColor.color.set(a.lighten(0.9));this.endColor.color.set(a.darken(0.6));this.defaultLineSymbol=new esri.symbol.SimpleLineSymbol;this.defaultLineSymbol.setColor(new esri.Color(this.config.defaultLineColor||[75,75,75,1]));this.defaultLineSymbol.setWidth(this.config.defaultLineWidth||2);this.defaultPointSymbol=new esri.symbol.SimpleMarkerSymbol;this.defaultPointSymbol.setColor(new esri.Color(this.config.defaultPointColor||[150,150,150,0.8]));
this.defaultPointSymbol.setSize(this.config.defaultPointSize||12);this.defaultPointSymbol.setOutline(this.defaultLineSymbol);this.defaultPolygonSymbol=new esri.symbol.SimpleFillSymbol;this.defaultPolygonSymbol.setColor(new esri.Color(this.config.defaultFillColor||[150,150,150,0.3]));this.defaultPolygonSymbol.setOutline(this.defaultLineSymbol)};f.prototype._reset=function(){this.attributes.set([]);this.currentAttribute.set("");this.classBreaksMode.set(!1);this.isNumericAttribute.set(!1);this.symbologyClasses.set([]);
this.selectedClass="";this.transparency.set(this.config.transparency.value);this.markerSize.set(this.config.classSymbolizationConfig.symbologyConfig.markerSize.value);this.lineWidth.set(this.config.classSymbolizationConfig.symbologyConfig.lineWidth.value);this.markerStyleIndex=0;var a=d.generateRandomColor();this.startColor.color.set(a.lighten(0.9));this.endColor.color.set(a.darken(0.6));for(var a=0,b=this.classSymbolWidgets;a<b.length;a++)b[a].reset();this.queryResults=[]};f.prototype._getRenderer=
function(){var a=this,b;if(0===this.symbologyClasses.getLength())return"";b="point"===this.featureType.toLowerCase().trim()?this.defaultPointSymbol:"polyline"===this.featureType.toLowerCase().trim()?this.defaultLineSymbol:this.defaultPolygonSymbol;var d=this.attributes.getItems().filter(function(b){return b.displayName===a.currentAttribute.get()})[0],c="";d&&(c=d.name,d.layer.mapService.serviceLayer instanceof esri.layers.WFSLayer&&(c=d.name.indexOf(":"),c=-1<c?d.name.substring(c+1).trim():d.name.trim()));
if(this.classBreaksMode.get())for(b=new esri.renderer.ClassBreaksRenderer(b,c),d=0;d<this.symbologyClasses.getLength();d++){var c=this.symbologyClasses.getAt(d),e=this.classSymbolWidgets[d];b.addBreak({minValue:c.min,maxValue:c.max,symbol:esri.symbol.fromJson(JSON.parse(e.getSymbol())),label:c.name})}else for(b=new esri.renderer.UniqueValueRenderer(b,c),d=0;d<this.symbologyClasses.getLength();d++)c=this.symbologyClasses.getAt(d),e=this.classSymbolWidgets[d],b.addValue({value:c.value,symbol:esri.symbol.fromJson(JSON.parse(e.getSymbol())),
label:c.name});return JSON.stringify(b.toJson())};f.prototype._setFromRenderer=function(a){var b=this,d=a.toJson();this.creatingClasses=!0;var c=this.attributes.getItems().filter(function(a){return a.name===d.field||a.name===d.field1})[0];this._getFieldInfo(c).then(function(a){b.configuring=!0;b.isNumericAttribute.set(c.dataType!==k.EssentialsFieldTypes.essentialsFieldTypeString&&!b._hasCodedDomain(a));"classBreaks"===d.type?b._setFromClassBreaksRenderer(d,a):"uniqueValue"===d.type&&b._setFromUniqueValueRenderer(d,
a);b.configuring=!1;b.symbologyClasses.pulse();b.creatingClasses=!1})};f.prototype._setFromClassBreaksRenderer=function(d,c){this.classBreaksMode.set(!0);var e=d.minValue;this.numBreaks.set(d.classBreakInfos.length);for(var f=0;f<d.classBreakInfos.length;f++){var g=d.classBreakInfos[f],h=new esri.Color(g.symbol.color||"#FFFFFF"),l=this.classSymbolWidgets[f],k=esri.symbol.fromJson(g.symbol);this._configureSymbolWidget(l,k);g.classMinValue&&(e=g.classMinValue);k instanceof esri.symbol.PictureMarkerSymbol?
this.symbologyClasses.addItem({name:c.formatValue(e)+" - "+c.formatValue(g.classMaxValue),min:e,max:g.classMaxValue,displayColor:h.toHex(),selected:!1,isImage:new a.Observable(!0),imageSrc:k.url,widgetId:m.WIDGET_ID_BASE+f.toString()}):this.symbologyClasses.addItem({name:c.formatValue(e)+" - "+c.formatValue(g.classMaxValue),min:e,max:g.classMaxValue,displayColor:h.toHex(),selected:!1,isImage:new a.Observable(!1),imageSrc:"",widgetId:m.WIDGET_ID_BASE+f.toString()});e=g.classMaxValue;0===f&&(this.startColor.color.set(new b.SymbolColor(h)),
this._setFromSymbol(g.symbol));f===d.classBreakInfos.length-1&&this.endColor.color.set(new b.SymbolColor(h))}};f.prototype._setFromUniqueValueRenderer=function(d,c){this.classBreaksMode.set(!1);for(var e=0;e<d.uniqueValueInfos.length;e++){var f=d.uniqueValueInfos[e],g=new esri.Color(f.symbol.color||"#FFFFFF"),h=this.classSymbolWidgets[e],l=esri.symbol.fromJson(f.symbol);this._configureSymbolWidget(h,l);h=void 0;if(c.isCodedValueDomain()||c.hasSubtypeCodedValueDomains())h=c.esriField.domain.getName(f.value);
h||(h=c.formatValue(f.value));l instanceof esri.symbol.PictureMarkerSymbol?this.symbologyClasses.addItem({name:h,value:f.value,displayColor:g.toHex(),selected:!1,isImage:new a.Observable(!0),imageSrc:l.url,widgetId:m.WIDGET_ID_BASE+e.toString()}):this.symbologyClasses.addItem({name:h,value:f.value,displayColor:g.toHex(),selected:!1,isImage:new a.Observable(!1),imageSrc:"",widgetId:m.WIDGET_ID_BASE+e.toString()});0===e&&(this.startColor.color.set(new b.SymbolColor(g)),this._setFromSymbol(f.symbol));
e===d.uniqueValueInfos.length-1&&this.endColor.color.set(new b.SymbolColor(g))}};f.prototype._setFromSymbol=function(a){var b=this;if(this._isPictureMarkerSymbol(a))this._setFromPictureMarkerSymbol(a);else{this.transparency.set(Math.floor(Math.ceil((255-a.color[3])/255*100)/this.config.transparency.step)*this.config.transparency.step);this.markerSize.set($.isNumeric(a.size)?Math.floor(a.size*s.POINTS_TO_PIXELS):this.config.classSymbolizationConfig.symbologyConfig.markerSize.value);var d=this.markerStyles.getItems().filter(function(d){return b.markerStyleIdLookup[d.style]===
a.style})[0];this.markerStyleIndex=d?this.markerStyles.indexOf(d):0;d="Point"!==this.featureType&&"Polygon"!==this.featureType?a:a.outline;this.lineWidth.set($.isNumeric(d.width)?Math.floor(d.width*s.POINTS_TO_PIXELS):this.config.classSymbolizationConfig.symbologyConfig.lineWidth.value)}};f.prototype._setFromPictureMarkerSymbol=function(a){this.transparency.set(this.transparencyInput.range.min);this.markerSize.set(Math.max(a.width,a.height)*s.POINTS_TO_PIXELS);this.markerStyleIndex=0};f.prototype._createClassBreaks=
function(b){var d=this;this.symbologyClasses.set([]);this._executeExtentQuery(b.field,this.app.map.extent).then(function(c){d._executeQuery(b.field,c).then(function(c){if(d._findDistinctValues(c,b.field.name).length<=d.numBreaks.get())d.classBreaksMode.set(!1),d.numericAttributeIsUniqueValue=!0,d._createUniqueValues(b);else{d.numericAttributeIsUniqueValue=!1;c=c.features.map(function(a){return a.attributes[b.field.name]});var e=g.findSignificanceFactor(c);c=g.ckmeans(c,d.numBreaks.get());if(0!==e&&
1!==e)for(var f=0;f<c.length;f++)c[f]=c[f].map(function(a){return a/e});for(f=0;f<c.length;f++){var h=void 0,l=void 0;0===f?h=Math.floor(Math.min.apply(Math,c[f])):(h=Math.min.apply(Math,c[f]),h>Math.max.apply(Math,c[f-1])+1?(h=Math.floor(h-(h-Math.max.apply(Math,c[f-1]))/2),1===e&&h++):h=Math.floor(h));if(f===c.length-1)l=Math.ceil(Math.max.apply(Math,c[f]));else var l=Math.max.apply(Math,c[f]),k=Math.min.apply(Math,c[f+1]),l=l<k-1?Math.floor(l+(k-l)/2):1>=e?Math.floor(l):Math.floor(k);0!==e&&1!==
e&&(h*=e,l*=e);k=void 0;k=0===l-h?b.fieldInfo.formatValue(h):b.fieldInfo.formatValue(h)+" - "+b.fieldInfo.formatValue(l);d.symbologyClasses.addItem({name:k,min:h,max:l,count:c[f].length,displayColor:"#FFFFFF",selected:!1,isImage:new a.Observable(!1),imageSrc:"",widgetId:m.WIDGET_ID_BASE+d.symbologyClasses.getLength().toString()})}d._createRendererClasses()}},function(a){a=new p.AddStatusArgs(a.message);a.regionName="VisualisationStatusRegion";a.id="VisualizationStatusMessageView";d.app.command("AddStatus").execute(a)})})};
f.prototype._createUniqueValues=function(b){var d=this;this.symbologyClasses.set([]);this._executeExtentQuery(b.field,this.app.map.extent).then(function(c){d._executeQuery(b.field,c).then(function(c){var e=function(c){var e=null!=c.attributes[b.field.name]&&""!==c.attributes[b.field.name].toString().trim()?c.attributes[b.field.name].toString():null;if(e){var f=void 0;d._hasCodedDomain(b.fieldInfo)&&(f=b.fieldInfo.esriField.domain.getName(c.attributes[b.field.name]));f||(f=b.fieldInfo.formatValue(e));
(c=d.symbologyClasses.getItems().filter(function(a){return a.value===e})[0])?c.count++:d.symbologyClasses.addItem({name:f,value:e,count:1,displayColor:"#FFFFFF",selected:!1,isImage:new a.Observable(!1),imageSrc:"",widgetId:m.WIDGET_ID_BASE+d.symbologyClasses.getLength().toString()})}},f=0;for(c=c.features;f<c.length;f++)e(c[f]);0===d.symbologyClasses.getLength()?(e=new p.AddStatusArgs(d.app.getResource(d.libraryId,"language-symbology-settings-nodata")),e.regionName="VisualizationStatusRegion",e.id=
"VisualizationStatusMessageView",d.app.command("AddResultsStatus").execute(e),d.currentAttribute.set("")):d._constrainToMaxClasses(b.field).then(function(){d.isNumericAttribute.get()?d.symbologyClasses.getItems().sort(function(a,b){return Number(a.value)-Number(b.value)}):d.symbologyClasses.getItems().sort();d._createRendererClasses()})},function(a){a=new p.AddStatusArgs(a.message);a.regionName="VisualisationStatusRegion";a.id="VisualizationStatusMessageView";d.app.command("AddResultsStatus").execute(a)})})};
f.prototype._createRendererClasses=function(){var a=[],c,e=this.symbologyClasses.getLength();if(this.isNumericAttribute.get()){for(var f=0;f<e;f++)c=1<e?f/(e-1):0.5,a.push(this.startColor.color.get().blend(c,this.endColor.color.get()));c=0.7<=this.startColor.color.get().value?this.startColor.color.get().darken(0.6,!1):this.startColor.color.get().lighten(0.9,!1)}else a=d.generateRandomColors(e),c=new b.SymbolColor(this.defaultLineSymbol.color.toHex());for(f=0;f<e;f++){this.symbologyClasses.getAt(f).displayColor=
a[f].toHex();var g=this.classSymbolWidgets[f];g.symbologyWidget.viewModel.fill.color.set(a[f]);g.symbologyWidget.viewModel.outline.color.set(c);g.setFeatureType(this.featureType);g.applySettings()}this.symbologyClasses.pulse();this.numBreaks.set(this.symbologyClasses.getLength());this.creatingClasses=!1};f.prototype._executeQuery=function(a,b){var d=this;return new Promise(function(c,e){if(a.layer instanceof q.LocalLayer){var f=a.layer.mapService.serviceLayer.graphics,g=new esri.tasks.FeatureSet;
g.features=f;c(g)}else{f=new esri.tasks.Query;g=n.getQueryTask(a.layer);f.returnGeometry=!1;f.geometry=b;f.outFields=[a.name];var h=s.stringToHash(g.url+a.name+b.toJson()),l=d.queryResults[h];l?c(l):g.execute(f,function(a){d.queryResults[h]=a;c(a)},function(a){d.app.trace.error(a.message);e(a)})}})};f.prototype._executeExtentQuery=function(a,b){return a.layer instanceof q.LocalLayer?Promise.resolve(b):this.classBreaksMode.get()?this._executeClassBreaksExtentQuery(a,b):this._executeUniqueValueExtentQuery(a,
b)};f.prototype._executeUniqueValueExtentQuery=function(a,b){var d=this;return new Promise(function(c,e){var f=-1,g=function(e){var g=d._findDistinctValues(e,a.name).length,l=d.isNumericAttribute.get()?d.numBreaks.get():d.maxRenderClasses;g>=l||g===f||e.exceededTransferLimit?c(b):(f=g,b=b.expand(2),h())},h=function(){var e=new esri.tasks.Query,f=n.getQueryTask(a.layer);e.returnGeometry=!1;e.geometry=b;e.outFields=[a.name];var h=s.stringToHash(f.url+a.name+JSON.stringify(b.toJson())),l=d.queryResults[h];
l?g(l):f.execute(e).then(function(a){d.queryResults[h]=a;g(a)},function(a){c(b)})};h()})};f.prototype._executeClassBreaksExtentQuery=function(a,b){var d=this;return new Promise(function(c,e){var f=-1,g=function(){var e=new esri.tasks.Query,h=n.getQueryTask(a.layer);e.returnGeometry=!1;e.geometry=b;h.executeForCount(e).then(function(a){a>=d.maxSamples||a===f?c(b):(f=a,b=b.expand(2),g())},function(a){c(b)})};g()})};f.prototype._constrainToMaxClasses=function(a){var b=this;return new Promise(function(d,
c){if(b.symbologyClasses.getLength()>b.maxRenderClasses||b.symbologyClasses.getLength()>b.numBreaks.get()||b.isNumericAttribute.get()){if(b.symbologyClasses.getLength()>b.maxRenderClasses&&!b.isNumericAttribute.get()){var e=new p.AddStatusArgs(b.app.getResource(b.libraryId,"language-symbology-settings-exceeded-max-classes").format(b.maxRenderClasses));e.regionName="VisualizationStatusRegion";e.id="VisualizationStatusMessageView";b.app.command("AddResultsStatus").execute(e)}var f=b.isNumericAttribute.get()?
b.numBreaks.get():b.maxRenderClasses;if(a.layer instanceof q.LocalLayer)e=b.symbologyClasses.getItems().sort(function(a,b){return a.count<b.count?1:a.count>b.count?-1:0}),b.symbologyClasses.set(e.slice(0,f)),d();else{var e=b.app.map.extent,g=new esri.tasks.Query,h=n.getQueryTask(a.layer);g.returnGeometry=!1;g.geometry=e;g.outFields=[a.name];h.execute(g,function(c){var e=b._findDistinctValues(c,a.name);c=b.symbologyClasses.getItems().sort(function(a,b){return-1===e.indexOf(a.name)&&-1<e.indexOf(b.name)?
1:-1<e.indexOf(a.name)&&-1===e.indexOf(b.name)?-1:a.count<b.count?1:a.count>b.count?-1:0});b.symbologyClasses.set(c.slice(0,f));d()},function(a){d()})}}else d()})};f.prototype._configureSymbolWidget=function(a,b){a.reset();a.setFeatureType(this.featureType);a.setFromSymbol(b)};f.prototype._findDistinctValues=function(a,b){for(var d={},c=[],e=a.features.map(function(a){return a.attributes[b]}),f=0;f<e.length;f++)d[e[f]]||c.push(e[f]),d[e[f]]=!0;return c};f.prototype._getFieldInfo=function(a){var b;
return new Promise(function(d,c){if(a.layer.mapService.serviceLayer instanceof esri.layers.FeatureLayer){var e=a.layer.mapService.serviceLayer;b=e.getField(a.name);d(l.FieldInfo.fromEsriField(b,e,a))}else a.layer.getFeatureLayer().then(function(c){b=c.getField(a.name);d(l.FieldInfo.fromEsriField(b,c,a))})})};f.prototype._hasCodedDomain=function(a){return a.esriField&&a.esriField.domain?!0:!1};f.prototype._isPictureMarkerSymbol=function(a){return(a.url||a.imageData)&&a.width&&a.height?!0:!1};return f}(c.ViewModelBase);
f.AttributeSymbologySettingsViewModel=h});
define("infrastructure/symbology/AttributeSymbologySettingsView",["require","exports","geocortex/framework/ui/ViewBase","geocortex/essentials/Field"],function(h,f,k,l){f.WIDGET_ID_BASE="__CLASSWIDGET__";h=function(e){function c(){var a=null!==e&&e.apply(this,arguments)||this;a.displayName=a.app.getResource(a.libraryId,"language-symbology-settings-attribute-displayname");return a}__extends(c,e);c.prototype.attach=function(a){a.initialize(this.configuration);e.prototype.attach.call(this,a);this.viewModel.startColor.color.bind(this,
this.applySettings);this.viewModel.endColor.color.bind(this,this.applySettings);a=function(a){a.symbologyWidget.viewModel.markerSize.sync(b.viewModel.markerSize);a.symbologyWidget.viewModel.lineWidth.sync(b.viewModel.lineWidth);a.symbologyWidget.viewModel.fill.color.syncTransform(b.viewModel.transparency,function(b){return a.symbologyWidget.viewModel.fill.color.get().setAlpha((100-b)/100)});a.pictureSymbologyWidget&&a.pictureSymbologyWidget.viewModel.imageSize.sync(b.viewModel.markerSize)};for(var b=
this,d=0,c=this.viewModel.classSymbolWidgets;d<c.length;d++)a(c[d]);this.viewModel.classBreaksInput.range.value.bind(this,this.applySettings);this.viewModel.startColor.color.bind(this,this._updateColorGradient);this.viewModel.endColor.color.bind(this,this._updateColorGradient)};c.prototype.added=function(a){a.attributeSettingsView=this;e.prototype.added.call(this,a);this.viewModel.classBreaksInput.range.value.pulse()};c.prototype.getRenderer=function(){return this.viewModel._getRenderer()};c.prototype.setFromRenderer=
function(a){this.viewModel._setFromRenderer(a)};c.prototype.reset=function(){this.viewModel.configuring=!0;this.viewModel._reset();if(!this.viewModel.currentAttribute.get()){var a=document.createElement("option");a.disabled=!0;a.selected=!0;a.hidden=!0;a.value="";a.text=this.app.getResource(this.libraryId,"language-symbology-settings-attribute-select");this.attributeInput.add(a,0)}this.viewModel.configuring=!1};c.prototype.handleMarkerStyle=function(){this.viewModel.markerStyleIndex=this.markerStyleInput.selectedIndex;
for(var a=0,b=this.viewModel.classSymbolWidgets;a<b.length;a++)b[a].symbologyWidget.viewModel.markerStyleIndex=this.viewModel.markerStyleIndex;this.applySettings()};c.prototype.applySettings=function(){if(!this.viewModel.configuring){this.viewModel.configuring=!0;var a;a=this.viewModel.attributes.getLength()<this.attributeInput.length?this.viewModel.attributes.getAt(this.attributeInput.selectedIndex-1):this.viewModel.attributes.getAt(this.attributeInput.selectedIndex);!this.viewModel.creatingClasses&&
a&&(a.displayName!==this.viewModel.currentAttribute.get()?this._updateClasses(a):this.viewModel.isNumericAttribute.get()||0!==this.viewModel.symbologyClasses.getLength()?this.viewModel.numericAttributeIsUniqueValue||this.viewModel.symbologyClasses.getLength()===this.viewModel.numBreaks.get()?this.viewModel.symbologyClasses.getLength()>this.viewModel.numBreaks.get()&&this._updateClasses(a):this._updateClasses(a):this._updateClasses(a));this.markerStyleInput.selectedIndex=this.viewModel.markerStyleIndex;
a=0;for(var b=this.viewModel.classSymbolWidgets;a<b.length;a++)b[a].applySettings();this.viewModel.configuring=!1}};c.prototype._updateClasses=function(a){var b=this;setTimeout(function(){b.viewModel.configuring=!0;b.viewModel.lineWidth.pulse();b.viewModel.markerSize.pulse();b.viewModel.transparency.pulse();b.viewModel.startColor.color.pulse();b.viewModel.endColor.color.pulse();b.viewModel.configuring=!1},0);for(var d=0,c=this.viewModel.classSymbolWidgets;d<c.length;d++)c[d].reset();this.viewModel.creatingClasses=
!0;this.app.command("RemoveResultsStatus").execute();this.viewModel._getFieldInfo(a).then(function(d){d={field:a,fieldInfo:d};a.dataType===l.EssentialsFieldTypes.essentialsFieldTypeString||d.fieldInfo.isCodedValueDomain()||d.fieldInfo.hasSubtypeCodedValueDomains()?(b.viewModel.classBreaksMode.set(!1),b.viewModel.isNumericAttribute.set(!1),b.viewModel._createUniqueValues(d)):(b.viewModel.classBreaksMode.set(!0),b.viewModel.isNumericAttribute.set(!0),b.viewModel._createClassBreaks(d))});this.viewModel.currentAttribute.set(a.displayName)};
c.prototype._updateColorGradient=function(){this.viewModel.configuring||this.viewModel.creatingClasses||(this.viewModel.startColor.color.get(),this.viewModel.endColor.color.get(),this.viewModel._createRendererClasses())};c.prototype.handleSymbolClassSelected=function(a){var b=this;a=a.currentTarget.children[0];var d=a.textContent||a.innerText;a=this.viewModel.symbologyClasses.getItems().filter(function(a){return a.name===d})[0];var c=this.viewModel.symbologyClasses.indexOf(a),e=function(a,b){var d=
esri.symbol.fromJson(JSON.parse(b.getSymbol()));d instanceof esri.symbol.PictureMarkerSymbol?(a.isImage.set(!0),a.imageSrc=d.url):(a.isImage.set(!1),a.imageSrc="",a.displayColor=b.symbologyWidget.viewModel.fill.color.get().toHex())};if(d===this.viewModel.selectedClass)this.viewModel.selectedClass=null,a.selected=!1,e(a,this.viewModel.classSymbolWidgets[c]);else{var f=this.viewModel.symbologyClasses.getItems().filter(function(a){return a.name===b.viewModel.selectedClass})[0],h=this.viewModel.symbologyClasses.indexOf(f),
h=this.viewModel.classSymbolWidgets[h];f&&(f.selected=!1,e(f,h));this.viewModel.selectedClass=d;a.selected=!0}this.viewModel.symbologyClasses.pulse();$(this.viewModel.classSymbolWidgets[c].container).appendTo($("#"+a.widgetId,this.root));this.viewModel.classSymbolWidgets[c].symbologyWidget.activated();this.viewModel.classSymbolWidgets[c].pictureSymbologyWidget&&this.viewModel.classSymbolWidgets[c].pictureSymbologyWidget.activated()};return c}(k.ViewBase);f.AttributeSymbologySettingsView=h});
define("infrastructure/tools/DisablingMapTool",["require","exports","infrastructure/tools/MapTool","geocortex/framework/observables"],function(h,f,k,l){h=function(e){function c(a,b){var d=e.call(this,a,b)||this;d.enabled=new l.Observable(!0);if(b.command){var c=a.command(b.command);d.enabled.set(c.canExecute());c.canExecuteChanged.subscribe(d,function(){var a=c.canExecute();!a&&d.isActive&&d.setActive(!1);d.enabled.set(a)})}return d}__extends(c,e);return c}(k.MapTool);f.DisablingMapTool=h});
define("infrastructure/visualization/VisualizationProviderConfig",["require","exports"],function(h,f){});
define("infrastructure/visualization/VisualizationProviderBase",["require","exports","geocortex/framework/observables"],function(h,f,k){h=function(){function f(e,c){this.visualizations=[];this.enabledVisualization=null;this.currentLayer=new k.Observable(null);this.isEnabled=new k.Observable(!1);this.isSupported=new k.Observable(!1);this.app=e;this.libraryId=c;this.currentLayer.bind(this,this.handleCurrentLayerChanged)}f.prototype.initialize=function(e){e.viewId&&(this.viewId=e.viewId);e.displayName&&
(this.displayName=e.displayName)};f.prototype.canSupport=function(e){return!1};f.prototype.handleCurrentLayerChanged=function(e){throw Error("Not implemented");};f.prototype.handleActivate=function(e){throw Error("Not implemented");};f.prototype.handleApply=function(){throw Error("Not implemented");};return f}();f.VisualizationProviderBase=h});define("infrastructure/webMap/LocationInfo",["require","exports"],function(h,f){});
define("infrastructure/webMap/CsvLayer",["require","exports"],function(h,f){});define("infrastructure/webMap/WmsLayer",["require","exports"],function(h,f){});define("infrastructure/webSocket/Protocol",["require","exports"],function(h,f){});define("infrastructure/webSocket/SendMessageOptions",["require","exports"],function(h,f){});
define("infrastructure/webSocket/WebSocketConnection",["require","exports","infrastructure/webSocket/WebSocketCommand","geocortex/framework/observables"],function(h,f,k,l){h=function(){function e(c){this.app=c;this.reconnectionMin=250;this.reconnectionMax=3E4;this.reconnectionGrowthFactor=4;this.maxMessageQueueLength=8;this._commands={};this._connectionString="";this._queuedMessages=[];this._reconnectionWait=this.reconnectionMin;this._ws=null;this.isConnected=new l.Observable(!1)}e.hasBrowserSupport=
function(){return"WebSocket"in window};e.prototype.connect=function(c){var a=this;if(c)if(c.startsWith("ws://")||c.startsWith("wss://"))if(this._ws)this.app.trace.error("WebSocketServer already connected.");else if(this._connectionString=c,this.app.site&&this.app.site.isInitialized)this._connectWebSocket();else this.app.event("SiteInitializedEvent").once(this,function(){a._connectWebSocket()});else this.app.trace.error("WebSocketServer connection string must start with ws:// or wss://.");else this.app.trace.error("WebSocketServer connection string missing.")};
e.prototype.sendMessage=function(c,a){if(!c)throw Error("Message cannot be null.");if(!c.type)throw Error("Message missing type.  This is not a proper message.");if(this._ws&&this._ws.readyState==this._ws.OPEN){try{var b=JSON.stringify(c)}catch(d){this.app.trace.error("WebSocketServer can't serialize message: "+d.message);return}this._ws.send(b)}else if(!a||!1!==a.queue)for(this._queuedMessages.push({msg:c,expirationTime:a&&a.maxAgeQueuedMillis?new Date(Date.now()+a.maxAgeQueuedMillis):null});this._queuedMessages.length>
this.maxMessageQueueLength;)this._queuedMessages.shift()};e.prototype.command=function(c){this._commands.hasOwnProperty(c)||(this._commands[c]=new k.WebSocketCommand(c,this));return this._commands[c]};e.prototype._connectWebSocket=function(){var c=this;if(e.hasBrowserSupport())if(!this._ws||this._ws.readyState!=this._ws.CONNECTING&&this._ws.readyState!=this._ws.OPEN)if(this.app.isOffline.get())this.app.trace.debug("WebSocketServer connect attempt skipped because the application is in offline mode."),
this._reconnectWebSocket();else{try{this._ws=new WebSocket(this._connectionString)}catch(a){this.app.trace.error("WebSocketServer error opening socket: "+a.message)}this._ws.onopen=function(a){return c._onOpen(a)};this._ws.onclose=function(a){return c._onClose(a)};this._ws.onerror=function(a){return c._onError(a)};this._ws.onmessage=function(a){return c._onMessage(a)}}else this.app.trace.debug("WebSocketServer already connected, aborting reconnect.");else this.app.trace.warning("Web sockets are not supported on this browser.")};
e.prototype._reconnectWebSocket=function(){var c=this;this.app.trace.debug("WebSocketServer reconnecting in "+this._reconnectionWait+"...");setTimeout(function(){return c._connectWebSocket()},this._reconnectionWait);this._reconnectionWait=Math.ceil(Math.min(this._reconnectionWait*this.reconnectionGrowthFactor,this.reconnectionMax))};e.prototype._onOpen=function(c){this.isConnected.set(!0);this.app.trace.debug("WebSocketServer connected.");c=this._queuedMessages;this._queuedMessages=[];for(var a=Date.now();0<
c.length;){var b=c.shift();b.expirationTime&&b.expirationTime.getTime()>a||this.sendMessage(b.msg)}};e.prototype._onClose=function(c){this.isConnected.set(!1);this.app.trace.debug("WebSocketServer disconnected.");this._reconnectWebSocket()};e.prototype._onError=function(c){this.isConnected.set(!1);this.app.trace.error("WebSocketServer web socket error: "+c.message)};e.prototype._onMessage=function(c){try{var a=JSON.parse(c.data)}catch(b){this.app.trace.error("WebSocketServer error deserializing inbound message: "+
b.message);this.app.debugMode&&this.app.trace.error(c.data);return}if(a.type)switch(a.type){case "Event":this._onEventMessage(a);break;case "Error":this._onErrorMessage(a);break;default:this.app.trace.error("WebSocketServer unknown message type '"+a.type+"'."),this.app.debugMode&&this.app.trace.error(c.data)}else this.app.trace.error("WebSocketServer incoming message missing type."),this.app.debugMode&&this.app.trace.error(c.data)};e.prototype._onEventMessage=function(c){if(c.name&&"string"==typeof c.name){var a=
this.app.event(c.name);a.publish.apply(a,c.args||[])}else this.app.trace.error("WebSocketServer message missing name.")};e.prototype._onErrorMessage=function(c){c.message&&"string"==typeof c.message?this.app.trace.error("WebSocketServer remote error: "+c.message):this.app.trace.error("WebSocketServer error from server with missing message.")};return e}();f.WebSocketConnection=h});
define("infrastructure/webSocket/WebSocketCommand",["require","exports"],function(h,f){var k=function(){function f(e,c){this.name=e;this.ws=c;this.queue=void 0;this._syncedCommands=[]}f.prototype.execute=function(e){this.ws.sendMessage({type:"Command",name:this.name,args:e},{queue:this.queue,maxAgeQueuedMillis:this.maxAgeQueuedMillis})};f.prototype.sync=function(e){if(!this._syncedCommands.some(function(a){return a.command===e})){var c=e.register(this,this.execute);this._syncedCommands.push({command:e,
token:c})}};return f}();f.WebSocketCommand=k;k=function(){return function(f,e){this.impl=f;this.scope=e}}();f.CommandRegistrationEntry=k});define("infrastructure/legend/LegendItemProviderEntry",["require","exports"],function(h,f){var k=function(){return function(f,e){this.identifier=f;this._provider=e}}();f.LegendItemProviderEntry=k});define("infrastructure/symbology/widgets/TextSymbolWidgetConfig",["require","exports"],function(h,f){});
define("infrastructure/symbology/widgets/TextSymbolWidgetViewModel","require exports geocortex/framework/ui/ViewModelBase geocortex/framework/observables infrastructure/symbology/SymbolColor infrastructure/SymbolUtils infrastructure/ColorUtils infrastructure/SymbolUtils infrastructure/BrowserUtils".split(" "),function(h,f,k,l,e,c,a,b,d){h=function(f){function h(){var a=null!==f&&f.apply(this,arguments)||this;a.fontFamily=new l.Observable("sans-serif");a.symbolText=new l.Observable("");a.fontColor=
{color:new l.Observable};a.fontHalo={color:new l.Observable};a.fontFamilies=new l.ObservableCollection(["serif","sans-serif"]);a.fontIsBold=new l.Observable(!1);a.fontIsItalic=new l.Observable(!1);a.fontIsUnderline=new l.Observable(!1);a.isIE9or11=!1;a.showHaloSize=new l.Observable(!0);a.showHaloColor=new l.Observable(!0);a.showFontStyle=new l.Observable(!0);a.showFontSize=new l.Observable(!0);a.showFontColor=new l.Observable(!0);a.showFontFamilies=new l.Observable(!0);a.showTextAngle=new l.Observable(!0);
a.showText=new l.Observable(!0);a.initialized=!1;a.configuring=!1;return a}__extends(h,f);h.prototype.initialize=function(a){void 0===a&&(a={});var c=d.isIE();this.isIE9or11=9===c||11===c;this.showHaloSize.set(!this.isIE9or11);this.showHaloColor.set(!this.isIE9or11);if(c=this.app.configModel.widgetConfigs.filter(function(a){return"TextSymbolWidget"===a.id})[0]){var e={};$.extend(e,c.configuration,a);this.config=e}else this.config=a;null==this.config.showSliders&&(this.config.showSliders=!0);this.config.fontSize=
this.config.fontSize||{min:10,max:64,value:18,step:1};this.fontSize=new l.Observable(this.config.fontSize.value);this.fontSizeViewModel={range:{min:this.config.fontSize.min,max:this.config.fontSize.max,value:this.fontSize,step:this.config.fontSize.step},showSlider:this.config.showSliders,updateOnDrag:!0};this.config.haloSize=this.config.haloSize||{min:0,max:5,value:2,step:1};this.haloSize=new l.Observable(this.config.haloSize.value);this.haloSizeViewModel={range:{min:this.config.haloSize.min,max:this.config.haloSize.max,
value:this.haloSize,step:this.config.haloSize.step},showSlider:this.config.showSliders,updateOnDrag:!0};this.textAngle=new l.Observable(0);this.textAngleViewModel={range:{min:0,max:360,value:this.textAngle,step:1},showSlider:this.config.showSliders,updateOnDrag:!0};void 0!==this.config.fontFamilies&&(this.fontFamilies.set(this.config.fontFamilies),this.fontFamily.set(this.fontFamilies.getAt(0)));void 0!==this.config.haloSizeIsVisible&&this.showHaloSize.set(this.config.haloSizeIsVisible&&!this.isIE9or11);
void 0!==this.config.haloColorIsVisible&&this.showHaloColor.set(this.config.haloColorIsVisible&&!this.isIE9or11);void 0!==this.config.fontSizeIsVisible&&this.showFontSize.set(this.config.fontSizeIsVisible);void 0!==this.config.fontStyleIsVisible&&this.showFontStyle.set(this.config.fontStyleIsVisible);void 0!==this.config.fontColorIsVisible&&this.showFontColor.set(this.config.fontColorIsVisible);void 0!==this.config.fontFamiliesIsVisible&&this.showFontFamilies.set(this.config.fontFamiliesIsVisible);
void 0!==this.config.textAngleIsVisible&&this.showTextAngle.set(this.config.textAngleIsVisible);void 0!==this.config.textIsVisible&&this.showText.set(this.config.textIsVisible);this._setFromSymbol(b.defaultTextSymbol(this.isIE9or11));this.initialized=!0};h.prototype.reset=function(){this.symbolText.set("");this.fontSize.set(this.config.fontSize.value);this.haloSize.set(this.config.haloSize.value);this.textAngle.set(0);this.fontFamily.set(this.fontFamilies.getAt(0));this.fontColor.color.set(a.generateRandomColor());
this.fontHalo.color.set(0.7<=this.fontColor.color.get().value?this.fontColor.color.get().darken(0.6):this.fontColor.color.get().lighten(0.8))};h.prototype._getSymbol=function(){return this.symbol?JSON.stringify(this.symbol.toJson()):""};h.prototype._setFromSymbol=function(a){a instanceof esri.symbol.TextSymbol&&this._setFromSymbolObject(a.toJson())};h.prototype._setFromSymbolObject=function(a){this.configuring=!0;a.text&&this.symbolText.set(a.text);a.angle?this.textAngle.set(Math.ceil(c.webMapAngleToJSAPIAngle(a.angle)/
this.textAngleViewModel.range.step)*this.textAngleViewModel.range.step):this.textAngle.set(0);this.fontColor.color.set(new e.SymbolColor({r:a.color[0]/255,g:a.color[1]/255,b:a.color[2]/255,a:a.color[3]/255}));a.haloColor?this.fontHalo.color.set(new e.SymbolColor({r:a.haloColor[0]/255,g:a.haloColor[1]/255,b:a.haloColor[2]/255,a:a.haloColor[3]/255})):this.fontHalo.color.set(new e.SymbolColor("#FFFFFF"));a.haloSize?this.haloSize.set(a.haloSize*c.POINTS_TO_PIXELS):this.haloSize.set(0);var b=a.font.family.split(",")[0];
this.fontFamilies.contains(b)||this.fontFamilies.addItem(b);this.fontFamily.set(b);this.fontSize.set(Math.ceil(a.font.size/this.fontSizeViewModel.range.step)*this.fontSizeViewModel.range.step||16);this.fontIsBold.set("bold"===a.font.weight);this.fontIsItalic.set("italic"===a.font.style);this.fontIsUnderline.set("underline"===a.font.decoration);this.configuring=!1};return h}(k.ViewModelBase);f.TextSymbolWidgetViewModel=h});
define("infrastructure/symbology/widgets/TextSymbolWidget",["require","exports","geocortex/framework/ui/ViewBase"],function(h,f,k){h=function(f){function e(){var c=null!==f&&f.apply(this,arguments)||this;c.displayName=c.app.getResource(c.libraryId,"language-symbology-settings-text-displayname");c.editingMarkup=!1;return c}__extends(e,f);e.prototype.attach=function(c){var a=this;c.initialized||c.initialize(this.configuration);f.prototype.attach.call(this,c);this.viewModel.fontColor.color.bind(this,
function(){a.viewModel.configuring||a.applySettings()});this.viewModel.fontHalo.color.bind(this,function(){a.viewModel.configuring||a.applySettings()});this.viewModel.haloSize.bind(this,function(){a.viewModel.configuring||a.applySettings()});this.viewModel.fontSize.bind(this,function(){a.viewModel.configuring||a.applySettings()});this.viewModel.textAngle.bind(this,function(){a.viewModel.configuring||a.applySettings()});this.viewModel.symbolText.bind(this,function(){a.viewModel.configuring||a.applySettings()});
this.viewModel.fontFamily.bind(this,function(){a.viewModel.configuring||a.applySettings()});this.viewModel.fontIsBold.bind(this,function(){a.viewModel.configuring||a.applySettings()});this.viewModel.fontIsItalic.bind(this,function(){a.viewModel.configuring||a.applySettings()});this.viewModel.fontIsUnderline.bind(this,function(){a.viewModel.configuring||a.applySettings()})};e.prototype.added=function(c){c&&(c.textSymbologySettingsWidget=this,f.prototype.added.call(this,c))};e.prototype.activated=function(){var c=
this;setTimeout(function(){c.viewModel.configuring=!0;c.viewModel.fontColor.color.pulse();c.viewModel.fontHalo.color.pulse();c.viewModel.haloSize.pulse();c.viewModel.fontSize.pulse();c.viewModel.textAngle.pulse();c.viewModel.configuring=!1},0)};e.prototype.reset=function(){this.viewModel.reset()};e.prototype.getSymbol=function(c){void 0===c&&(c=!0);this.viewModel.symbol||this.applySettings(c);return this.viewModel._getSymbol()};e.prototype.setFromSymbol=function(c,a){void 0===a&&(a=!0);c instanceof
esri.symbol.TextSymbol&&(this.viewModel._setFromSymbol(c),!this.editingMarkup&&a&&this.applySettings())};e.prototype.applySettings=function(c){void 0===c&&(c=!0);if(this.viewModel.initialized){this.viewModel.configuring=!0;var a=this.viewModel.fontColor.color.get().toEsriColor(),b=this.viewModel.fontHalo.color.get().toEsriColor(),d=this.viewModel.fontSize.get(),e=this.viewModel.haloSize.get(),f=this.viewModel.fontIsBold.get(),h=this.viewModel.fontIsItalic.get(),l=this.viewModel.fontIsUnderline.get(),
k=new esri.symbol.TextSymbol(this.viewModel.symbolText.get());k.setFont(new esri.symbol.Font(d+"pt",h?esri.symbol.Font.STYLE_ITALIC:esri.symbol.Font.STYLE_NORMAL,esri.symbol.Font.VARIANT_NORMAL,f?esri.symbol.Font.WEIGHT_BOLD:esri.symbol.Font.WEIGHT_NORMAL,this.viewModel.fontFamily.get()));k.setColor(a);k.setHaloColor(b);k.setHaloSize(e);k.setDecoration(l?"underline":"none");k.setAngle(this.viewModel.textAngle.get());k.setAlign(esri.symbol.TextSymbol.ALIGN_START);this.viewModel.symbol=k;if(c&&this.onChange&&
this.isActive&&(!this.parentView||this.parentView.isActive))this.onChange(JSON.stringify(k.toJson()));this.viewModel.configuring=!1}};return e}(k.ViewBase);f.TextSymbolWidget=h});
define("infrastructure/toolbarGroup/types/ToolbarButton",["require","exports","infrastructure/toolbarGroup/ToolbarGroupItemBase","geocortex/framework/observables","infrastructure/toolbarGroup/ToolbarGroupBase"],function(h,f,k,l,e){var c=function(a){function b(b,c,e){var f=a.call(this,b,c,e)||this;b=e.command;c=e.commandParameter;var h=eval("geocortex.essentialsHtmlViewer.mapping.modules.command.CommandViewModel");f.command=new h(f.app,void 0,b,c);f.disabled.set(!f.command.canExecute.get());f.setHidden();
f.command.canExecute.bind(f,function(a){f.disabled.set(!a);f.setHidden()});f.iconUri=new l.Observable(e.iconUri);if(!f.app.site||!f.app.site.isInitialized)f.app.event("SiteInitializedEvent").once(f,f._raiseCommandCanExecuteChanged);return f}__extends(b,a);b.prototype.execute=function(){this.command&&this.command.commandName&&(this.command.commandParameter?this.app.commandRegistry.command(this.command.commandName).execute(this.command.commandParameter):this.app.commandRegistry.command(this.command.commandName).execute());
var a={commandName:this.command.commandName,commandParameter:this.command.commandParameter,id:this.id,name:this.name.get(),libraryId:this.libraryId};this.app.event("ToolbarButtonClickedEvent").publish(a)};b.prototype._raiseCommandCanExecuteChanged=function(){this.command.commandName&&this.app.command(this.command.commandName).raiseCanExecuteChanged()};return b}(k.ToolbarGroupItemBase);f.ToolbarButton=c;e.registerToolbarFactoryMethod("button",function(a,b,d){return new c(a,b,d)})});
define("infrastructure/toolbarGroup/types/ToolbarGroup",["require","exports","infrastructure/toolbarGroup/ToolbarGroupItemBase","geocortex/framework/observables","infrastructure/toolbarGroup/ToolbarGroupBase"],function(h,f,k,l,e){var c=function(a){function b(b,c,e){var f=a.call(this,b,c,e)||this;e.layout&&"small"===e.layout.toLowerCase()&&f.hasSmallLayout.set(!0);f.items=new l.ObservableCollection;for(b=0;b<e.items.length;b++)(c=f.getToolbarItemType(e.items[b]))&&f.items.addItem(c);f.disabled.set(f.areAllHidden(f.items));
f.setHidden();f.disabled.bind(f,function(a){f.setHidden()});return f}__extends(b,a);b.prototype.getToolbarItemType=function(a){return e.createToolbarItem(this.app,this.libraryId,a)};return b}(k.ToolbarGroupItemBase);f.ToolbarGroup=c;e.registerToolbarFactoryMethod("toolbarGroup",function(a,b,d){return new c(a,b,d)})});
define("infrastructure/toolbarGroup/types/ToolbarFlyout","require exports infrastructure/toolbarGroup/types/ToolbarGroup geocortex/framework/observables infrastructure/tools/MapTool infrastructure/toolbarGroup/ToolbarGroupBase".split(" "),function(h,f,k,l,e,c){var a=function(a){function d(d,c,e){var f=a.call(this,d,c,e)||this;f.flyoutButtonDescription=new l.Observable("");f.selectedTool.set(f.items.getAt(0));f.flyoutButtonDescription.set(f.app.getResource(f.libraryId,"language-toolbar-flyout-description").format(f.name.get()));
f.app.event("ActiveToolChangedEvent").subscribe(f,function(a){var b=f.items.get().filter(function(b){return f._seeIfActiveToolIsInFlyout(b,a)});0<b.length&&f.selectedTool.set(b[0])});return f}__extends(d,a);d.prototype._seeIfActiveToolIsInFlyout=function(a,b){if(!(a.tool instanceof e.MapTool))return!1;var d=a.tool;if(b.tool instanceof e.MapTool){var c=b.tool;return d.command===c.command&&d.drawMode===c.drawMode}return!1};d.prototype.toggleFlyout=function(){this.toolChangeActive.set(!this.toolChangeActive.get())};
d.prototype.switchActiveFlyoutTool=function(a){"tool"===a.type&&this.selectedTool.set(a);a.execute()};d.prototype.getToolbarItemType=function(a){return c.createToolbarItem(this.app,this.libraryId,a)};return d}(k.ToolbarGroup);f.ToolbarFlyout=a;c.registerToolbarFactoryMethod("flyout",function(b,d,c){return new a(b,d,c)})});
define("infrastructure/toolbarGroup/types/ToolbarRegion",["require","exports","infrastructure/toolbarGroup/ToolbarGroupItemBase","infrastructure/toolbarGroup/ToolbarGroupBase"],function(h,f,k,l){var e=function(c){function a(a,d,e){a=c.call(this,a,d,e)||this;a.regionName=e.regionName;return a}__extends(a,c);return a}(k.ToolbarGroupItemBase);f.ToolbarRegion=e;l.registerToolbarFactoryMethod("region",function(c,a,b){return new e(c,a,b)})});
define("infrastructure/toolbarGroup/types/ToolbarTool",["require","exports","infrastructure/toolbarGroup/ToolbarGroupItemBase","geocortex/framework/observables","infrastructure/toolbarGroup/ToolbarGroupBase"],function(h,f,k,l,e){var c=function(a){function b(b,c,e){var f=a.call(this,b,c,e)||this;if(!e)return f;b={};for(var h in e){if(!h)break;b[h]=e[h]}b.name=e.id;var k=[];k.push(b);f.app.allLibrariesLoaded?f._initializeTool(k):(f.disabled.set(!0),f.setHidden(),f.app.event("ViewerLibrariesDownloadedEvent").once(f,
function(){f.disabled.set(!1);f.setHidden();f._initializeTool(k)}));f.isActive.set(!1);f.iconUri=new l.Observable(e.iconUri);f.app.event("StateEnteredEvent").subscribe(f,function(a){f.isActive.get()&&"TransientActiveState"===a.stateDefinition.name&&f.activeTransient.set(!0)});f.app.event("StateExitedEvent").subscribe(f,function(a){"TransientActiveState"===a.stateDefinition.name&&f.activeTransient.set(!1)});return f}__extends(b,a);b.prototype.execute=function(){this.isActive.get()||this.tool.isActive?
this.app.commandRegistry.command("ClearActiveTool").execute():this.tool.enabled&&!this.tool.enabled.get()||this.app.commandRegistry.command("SetActiveTool").execute(this.tool.id)};b.prototype._initializeTool=function(a){var b=this;this.tool=this.app.toolRegistry.createTools(a,!0)[0];this.tool?this.tool.enabled&&(this.disabled.set(!this.tool.enabled.get()),this.setHidden(),this.tool.enabled.bind(this,function(a){b.disabled.set(!a);b.setHidden();a||!b.isActive.get()&&!b.tool.isActive||b.app.commandRegistry.command("ClearActiveTool").execute()})):
(this.disabled.set(!0),this.setHidden())};return b}(k.ToolbarGroupItemBase);f.ToolbarTool=c;e.registerToolbarFactoryMethod("tool",function(a,b,d){return new c(a,b,d)})});define("infrastructure/ui/components/ProviderConfiguration",["require","exports"],function(h,f){});
define("infrastructure/ui/components/ColorPicker/ColorPickerWidget",["require","exports","geocortex/framework/ui/ViewBase"],function(h,f,k){h=function(f){function e(c,a){return f.call(this,c,a)||this}__extends(e,f);e.prototype.added=function(){this.initialize(this.configuration)};e.prototype.initialize=function(c){var a;(a=dojo.getObject(c.provider))?(this.provider=new a(this.app,this.libraryId),this.provider.initialize(this),this.bindingToken=this.viewModel.color.bind(this.provider,this.provider.setColor)):
this.app.trace.error("{0} can't find color picker provider typed {1}".format(this.id,c.provider))};e.prototype.updateColor=function(c){this.viewModel.color.set(c)};return e}(k.ViewBase);f.ColorPickerWidget=h});
define("infrastructure/ui/components/ColorPicker/ColorPickerProviderBase",["require","exports","infrastructure/symbology/SymbolColor"],function(h,f,k){h=function(){function f(e,c){this.color=new k.SymbolColor("#000000");this.app=e;this.libraryId=c}f.prototype.initialize=function(e){throw Error("Not implemented");};f.prototype.setColor=function(e){throw Error("Not implemented");};return f}();f.ColorPickerProviderBase=h});
define("infrastructure/ui/components/ColorPicker/KendoColorPickerProvider",["require","exports","infrastructure/symbology/SymbolColor","infrastructure/ui/components/ColorPicker/ColorPickerProviderBase"],function(h,f,k,l){h=function(e){function c(a,b){return e.call(this,a,b)||this}__extends(c,e);c.prototype.initialize=function(a){this.widget=a};c.prototype.instantiate=function(){(this.colorpicker=$(this.widget.colorInput).kendoColorPicker({buttons:!1,opacity:!0,preview:!0,select:this.updateColor.bind(this)}).data("kendoColorPicker"))&&
this.colorpicker.value(this.color.toRGBAString())};c.prototype.setColor=function(a){this.color=a;this.colorpicker?this.colorpicker.value(a.toRGBAString()):this.instantiate()};c.prototype.updateColor=function(a){this.color=new k.SymbolColor(a.value);this.widget.updateColor(this.color)};return c}(l.ColorPickerProviderBase);f.KendoColorPickerProvider=h});
define("infrastructure/ui/components/FilterControl/FilterControlViewBase",["require","exports","geocortex/framework/ui/ViewBase"],function(h,f,k){h=function(f){function e(){return null!==f&&f.apply(this,arguments)||this}__extends(e,f);e.prototype.handleFilterTextClear=function(c,a,b){throw Error("Not Implemented. Please extend this class to implement.");};e.prototype.handleFilterButtonClick=function(c,a,b){throw Error("Not Implemented. Please extend this class to implement.");};return e}(k.ViewBase);
f.FilterControlViewBase=h});
define("infrastructure/ui/components/Forms/FormItemViewBase",["require","exports","geocortex/framework/ui/ViewBase"],function(h,f,k){h=function(f){function e(c,a){return f.call(this,c,a)||this}__extends(e,f);e.prototype.attach=function(c){if(!c)throw Error("{0}: A view model must be specified to attach to.".format(this.id));this.viewModel=c;this.addDisposableBinding(c.isValid,c.isValid.bind(this,function(a){this.calculateIndicatorDisplay()}));this.addDisposableBinding(c.isRequired,c.isRequired.bind(this,
function(a){this.calculateIndicatorDisplay()}));this.calculateIndicatorDisplay();f.prototype.attach.call(this,c)};e.prototype.calculateIndicatorDisplay=function(){this.viewModel.attached_showIndicator&&(this.viewModel.attached_showIndicator.set(!0===this.viewModel.isRequired.get()||!1===this.viewModel.isValid.get()),!1==this.viewModel.isValid.get()?this.viewModel.attached_indicatorClass.set("form-item invalid"):this.viewModel.attached_indicatorClass.set("form-item required"))};return e}(k.ViewBase);
f.FormItemViewBase=h});
define("infrastructure/ui/components/Forms/FormsUtils",["require","exports","geocortex/essentials/Field","infrastructure/FormatUtils"],function(h,f,k,l){h=function(){function e(){}e.convertToHTMLSyntax=function(c){if(null===c.get()||void 0===c.get())return null;for(var a in e.patterns){if(!a||void 0===a||null===a)break;var b=RegExp(a,"g");c.set(c.get().replace(b,e.patterns[a]))}};e.formatListItem=function(c,a){switch(a){case k.EsriFieldTypes.esriFieldTypeDate:return l.formatDate(l.parseDate(c));case k.EsriFieldTypes.esriFieldTypeOID:case k.EsriFieldTypes.esriFieldTypeSmallInteger:case k.EsriFieldTypes.esriFieldTypeInteger:case k.EsriFieldTypes.esriFieldTypeSingle:case k.EsriFieldTypes.esriFieldTypeDouble:return l.formatNumber(l.parseNumber(c));
default:return c}};return e}();h.patterns={"\\n":"<br />","\\t":"&nbsp; &nbsp; &nbsp; &nbsp;"};f.FormsUtils=h});
define("infrastructure/ui/components/Forms/AutoCompleteBoxFormItemView","require exports infrastructure/ui/components/Forms/FormItemViewBase geocortex/framework/observables geocortex/framework/utils/utils infrastructure/ui/components/Forms/FormsUtils".split(" "),function(h,f,k,l,e,c){h=function(a){function b(b,c){var e=a.call(this,b,c)||this;e.textElement=null;e.dropDownContainerElement=null;e.dropDownListElement=null;e.timer=null;e.positionIndex=null;e.lastKeyEvent=null;e.keyTraverseInterval=null;
e.closeTimer=null;e._queryCancelled=!1;e._searchFocus=!1;e.isBusy=new l.Observable(!1);e.positionIndex=0;e.keyTraverseInterval=25;return e}__extends(b,a);b.prototype.attach=function(b){if(!b)throw Error("{0}: A view model must be specified to attach to.".format(this.id));b.isDropDownOpen=new l.Observable(!1);b.attached_controlId=new l.Observable("textbox-{0}".format(e.alphaNumericToken()));b.queryTaskRunner&&(b.queryTaskRunner.formatCallback=c.FormsUtils.formatListItem);a.prototype.attach.call(this,
b);this.lastKeyEvent=(new Date).getTime();this.addDisposableBinding(this.viewModel.dataItems,this.viewModel.dataItems.bind(this,function(a){this.isBusy.set(!1);0<this.viewModel.dataItems.getLength()?(this.positionIndex=0,this._queryCancelled||this.openDropDown()):this.closeDropDown()}))};b.prototype.handleInputBlurEvent=function(a,b,c){var e=this;this.isBusy.set(!1);this._searchFocus=!1;this.closeTimer=setTimeout(function(){e._searchFocus||(e._queryCancelled=!0,e.viewModel.queryTaskRunner.triggerCascading(c.text.get()),
e.closeDropDown())},750)};b.prototype.handleInputClickEvent=function(a,b,c){b.focus()};b.prototype.handleInputFocusEvent=function(a,b,c){this._queryCancelled=!1;this._searchFocus=!0};b.prototype.handleDropdownFocusEvent=function(a,b,c){var e=this;setTimeout(function(){e._searchFocus=!0},100);null!=this.closeTimer&&(clearTimeout(this.closeTimer),this.closeTimer=null);return!0};b.prototype.handleDropdownBlurEvent=function(a,b,c){this.closeDropDown();return!0};b.prototype.handleClickItem=function(a,
b,c){this.viewModel.text.set(c.display);this.viewModel.queryTaskRunner.triggerCascading(c.display);this.closeDropDown()};b.prototype.openDropDown=function(){eval('geocortex.essentialsHtmlViewer["___userInAutoComplete"] = true');this.viewModel.isDropDownOpen.set(!0);this.positionIndex=-1;$(this.dropDownContainerElement).removeClass("inactive").addClass("active")};b.prototype.closeDropDown=function(){eval('geocortex.essentialsHtmlViewer["___userInAutoComplete"] = false');this.viewModel.isDropDownOpen.set(!1);
$(this.dropDownContainerElement).removeClass("active").addClass("inactive")};b.prototype.setDropDownPosition=function(a){a=Math.min(a,this.viewModel.dataItems.getLength()-1);dojo.removeClass(this.dropDownListElement,"autocomplete-highlight");this.positionIndex=Math.max(0,a);a=$("li",this.dropDownListElement).eq(this.positionIndex);$(a).addClass("autocomplete-highlight");var b=this.viewModel.dataItems.getAt(this.positionIndex);b&&this.viewModel.text.set(b.display);0<a.length&&$(this.dropDownContainerElement).scrollTop($(this.dropDownContainerElement).scrollTop()+
$(a).position().top-$(this.dropDownContainerElement).height()/2+$(a).height()/2)};b.prototype.handleDropdownKeyDown=function(a,b,c){return 13===a.which?this.handleKeyEvent(a,b,c):!0};b.prototype.handleKeyEvent=function(a,b,c){b=(new Date).getTime();if(b-this.lastKeyEvent>this.keyTraverseInterval)if(this.lastKeyEvent=b,38===a.which||40===a.which)this.viewModel.isDropDownOpen.get()&&(40===a.which?this.setDropDownPosition(this.positionIndex+1):38===a.which&&this.setDropDownPosition(this.positionIndex-
1));else{if(this.viewModel.isDropDownOpen.get()&&13===a.which){if(a=this.viewModel.dataItems.getAt(this.positionIndex))this.viewModel.text.set(a.display),this.viewModel.queryTaskRunner.triggerCascading(a.display);this.closeDropDown();null!=this.timer&&clearInterval(this.timer);return!1}if(this.viewModel.isDropDownOpen.get()&&8===a.which)return this.closeDropDown(),this.viewModel.queryTaskRunner.triggerCascading(null),8==a.which&&this.trigger(),!1;if(9!==a.which&&37!==a.which&&39!==a.which){if(13===
a.which)return this.viewModel.queryTaskRunner.triggerCascading(c.display),!1;this.trigger()}}return!0};b.prototype.trigger=function(){var a=this;null!=this.timer&&clearInterval(this.timer);this.textElement.value.length>=this.viewModel.minimumPrefixLength.get()&&(this.timer=setTimeout(function(){a.filter(!1)},this.viewModel.minimumPopulateDelay.get()))};b.prototype.filter=function(a){null!=this.timer&&(clearInterval(this.timer),this.timer=null);this.closeDropDown();this.viewModel.queryTaskRunner.performQuery(this.textElement.value,
a)};return b}(k.FormItemViewBase);f.AutoCompleteBoxFormItemView=h});
define("infrastructure/ui/components/Forms/CheckBoxFormItemView",["require","exports","infrastructure/ui/components/Forms/FormItemViewBase","geocortex/framework/observables","geocortex/framework/utils/utils"],function(h,f,k,l,e){h=function(c){function a(a,d){return c.call(this,a,d)||this}__extends(a,c);a.prototype.attach=function(a){if(!a)throw Error("{0}: A view model must be specified to attach to.".format(this.id));a.attached_textOnLeft=new l.Observable(!1);this.addDisposableBinding(a.textLocation,
a.textLocation.bind(this,function(c){a.attached_textOnLeft.set("left"===c.toLowerCase())}));a.textLocation.pulse();a.attached_controlId=new l.Observable("checkbox-{0}".format(e.alphaNumericToken()));a.attached_labelText=null!=a.text?new l.Observable(a.text.get()):"";c.prototype.attach.call(this,a)};return a}(k.FormItemViewBase);f.CheckBoxFormItemView=h});
define("infrastructure/ui/components/Forms/ContainerFormItemView","require exports infrastructure/ui/components/Forms/FormItemViewBase geocortex/framework/observables infrastructure/ui/components/Forms/FormsUtils infrastructure/FilterUtils geocortex/framework/events/ViewDimensionsChangedArgs".split(" "),function(h,f,k,l,e,c,a){h=function(b){function d(a,c){var d=b.call(this,a,c)||this;d.attached_style=new l.Observable("");d.attached_isHorizontal=new l.Observable(!1);return d}__extends(d,b);d.prototype.attach=
function(a){var d=this;if(!a)throw Error("{0}: A view model must be specified to attach to.".format(this.id));a.attached_style=this.attached_style;a.attached_isHorizontal=this.attached_isHorizontal;a.hasOwnProperty("description")&&(e.FormsUtils.convertToHTMLSyntax(a.description),a.description.set(c.sanitize(a.description.get(),{allowFrames:!0,uriTransformer:function(a){return a}})));var f=this.configuration&&void 0!==this.configuration.allowHorizontal;this.auto(a.orientation,this,function(b){b="Horizontal"===
a.orientation.get();d.attached_style.set(void 0);d.attached_isHorizontal.set(b&&f)});a.orientation.pulse();this._attachVisibilityControls(a);b.prototype.attach.call(this,a)};d.prototype._attachVisibilityControls=function(b){var c=this;if(!b)throw Error("A view model must be specified to attach to.");if(b.visibleControlID.get()){var d=b.formDefinition.getFormItemById(b.visibleControlID.get());d&&(b.applyVisibility(d),this.resultChangeSubscription||(this.resultChangeSubscription=dojo.subscribe("FormItemResultChangedEvent",
function(e){if(e===d&&(e=b.isVisible.get(),b.applyVisibility(d),e!==b.isVisible.get())){var f=c.app.viewManager.getRegionForViewId(c.id);c.app.event("ViewDimensionsChangedEvent").publish(new a.ViewDimensionsChangedArgs(c,f));f=b.getDisplayName();e="language-accessibility-form-{0}-container-{1}".format(f?"named":"unnamed",e?"hidden":"shown");e=c.app.getResource(c.libraryId,e).format(f);c.app.command("ScreenReaderNarrate").execute(e)}})))}};d.prototype.onDestroy=function(){b.prototype.onDestroy.call(this);
this.resultChangeSubscription&&dojo.unsubscribe(this.resultChangeSubscription)};return d}(k.FormItemViewBase);f.ContainerFormItemView=h});
define("infrastructure/ui/components/Forms/TimePickerFormItemView",["require","exports","infrastructure/ui/components/Forms/FormItemViewBase","geocortex/framework/observables","geocortex/framework/utils/utils"],function(h,f,k,l,e){h=function(c){function a(a,d){var e=c.call(this,a,d)||this;e.attached_seconds=null;e.attached_minutes=null;e.attached_hours=null;e.attached_second=null;e.attached_minute=null;e.attached_hour=null;e._lastClearedTime=null;return e}__extends(a,c);a.prototype.attach=function(a){var d=
this;if(!a)throw Error("{0}: A view model must be specified to attach to.".format(this.id));a.attached_controlId=new l.Observable("timepicker-{0}".format(e.alphaNumericToken()));a.attached_time=this.attached_time=new l.Observable;a.attached_timeIsNull=new l.Observable(!1);a.attached_timeIsNull.syncTransform(a.time,function(a){return null==a});this._buildComboBoxes(a);c.prototype.attach.call(this,a);setTimeout(function(){d.viewModel.date?d.setPickerDateTime(d.viewModel.date.get()):d.viewModel.time&&
d.setPickerDateTime(d.viewModel.time.get())},1)};a.prototype._buildComboBoxes=function(a){this.attached_seconds=new l.ObservableCollection([]);this.attached_minutes=new l.ObservableCollection([]);this.attached_hours=new l.ObservableCollection([]);this.attached_second=new l.Observable(0);this.attached_minute=new l.Observable(0);this.attached_hour=new l.Observable(0);for(var c=[],e=[],f=[],h=0;24>h;++h)c.push({val:h,desc:"{0}".format(h)});this.attached_hours.addItems(c);for(h=0;60>h;++h)e.push(h),f.push(h);
this.attached_minutes.addItems(e);this.attached_seconds.addItems(f);a.attached_seconds=this.attached_seconds;a.attached_minutes=this.attached_minutes;a.attached_hours=this.attached_hours;a.attached_second=this.attached_second;a.attached_minute=this.attached_minute;a.attached_hour=this.attached_hour};a.prototype.setPickerDateTime=function(a){null!=a?(this.attached_second.set(a.getSeconds()),this.attached_minute.set(a.getMinutes()),this.attached_hour.set(a.getHours())):(this.attached_second.set(null),
this.attached_minute.set(null),this.attached_hour.set(null),$(this.selectContainerElement).find("select").val([]))};a.prototype.handleChangeComboBoxTime=function(){var a;a=this.viewModel.time?this.viewModel.time.get():this.viewModel.date?this.viewModel.date.get():new Date;null!=this.attached_hour.get()||null!=this.attached_minute.get()||null!=this.attached_second.get()?(null==a&&(a=new Date,a.setMilliseconds(0)),null==this.attached_hour.get()&&this.attached_hour.set(a.getHours()),null==this.attached_minute.get()&&
this.attached_minute.set(a.getMinutes()),null==this.attached_second.get()&&this.attached_second.set(a.getSeconds()),a.setHours(this.attached_hour.get()),a.setMinutes(this.attached_minute.get()),a.setSeconds(this.attached_second.get())):a=null;this.viewModel.time?this.viewModel.time.set(a):this.viewModel.date&&this.viewModel.date.set(a)};a.prototype.handleClickSetNull=function(){this.viewModel.time.get()&&(this._lastClearedTime=this.viewModel.time.get());this.viewModel.time.set(null);this.setPickerDateTime(null)};
a.prototype.handleClickSetNotNull=function(){if(null!=this._lastClearedTime)this.viewModel.time.set(this._lastClearedTime),this.setPickerDateTime(this._lastClearedTime),this._lastClearedTime=null;else{var a=new Date;this.viewModel.time.set(a);this.setPickerDateTime(a)}};return a}(k.FormItemViewBase);f.TimePickerFormItemView=h});
define("infrastructure/ui/components/Forms/DatePickerFormItemView","require exports infrastructure/ui/components/Forms/TimePickerFormItemView geocortex/framework/observables infrastructure/DateFormat geocortex/framework/utils/utils infrastructure/FormatUtils".split(" "),function(h,f,k,l,e,c,a){h=function(b){function d(){var a=null!==b&&b.apply(this,arguments)||this;a.attached_pickerType=new l.Observable;a.attached_days=null;a.attached_months=null;a.attached_years=null;a.attached_day=null;a.attached_month=
null;a.attached_year=null;a.selectElementCount=11;a._jQueryPickerInitialized=!1;a._lastClearedDate=null;a._daysPerMonth={0:31,1:28,2:31,3:30,4:31,5:30,6:31,7:31,8:30,9:31,10:30,11:31};a._dateTimePickerType={comboPicker:"combos",comboDateTimePicker:"combos_datetime",nativePicker:"native",nativeDateTimePicker:"native_datetime",nativeDateComboTimePicker:"native_date_combo_time",jQueryPicker:"jQuery",nativeDateJQueryTimePicker:"native_date_jQuery_time"};a._dateFormat=e.DateFormat.DATE_TIME_SHORT;return a}
__extends(d,b);d.prototype.attach=function(a){var d=this;if(!a)throw Error("{0}: A view model must be specified to attach to.".format(this.id));a.attached_controlId=new l.Observable("datepicker-{0}".format(c.alphaNumericToken()));a.attached_isNull=new l.Observable(!1);a.attached_isNull.syncTransform(a.date,function(a){return null==a});var e=-1<navigator.userAgent.indexOf("Android")&&-1<navigator.userAgent.indexOf("Mobile Safari")&&!(-1<navigator.userAgent.indexOf("Chrome")),f=-1<navigator.userAgent.indexOf("Android")&&
-1<navigator.userAgent.indexOf("Firefox"),h=navigator.userAgent.match(/(iPad|iPhone|iPod)/gi)?!0:!1;!Modernizr||!Modernizr.inputtypes.date||-1<navigator.userAgent.indexOf("Chrome")||e||f?Modernizr.touch?!0===a.includeTimePicker.get()?this.attached_pickerType.set(this._dateTimePickerType.comboDateTimePicker):this.attached_pickerType.set(this._dateTimePickerType.comboPicker):this.attached_pickerType.set(this._dateTimePickerType.jQueryPicker):!0===a.includeTimePicker.get()?Modernizr.inputtypes.datetime&&
!h?this.attached_pickerType.set(this._dateTimePickerType.nativeDateTimePicker):this.attached_pickerType.set(this._dateTimePickerType.nativeDateComboTimePicker):this.attached_pickerType.set(this._dateTimePickerType.nativePicker);a.attached_pickerType=this.attached_pickerType;this.viewModel=a;this.attached_days=new l.ObservableCollection([]);this.attached_months=new l.ObservableCollection([]);this.attached_years=new l.ObservableCollection([]);this.attached_day=new l.Observable(1);this.attached_month=
new l.Observable(1);this.attached_year=new l.Observable(2E3);a.attached_days=this.attached_days;a.attached_months=this.attached_months;a.attached_years=this.attached_years;a.attached_day=this.attached_day;a.attached_month=this.attached_month;a.attached_year=this.attached_year;this._buildComboBoxes(a);setTimeout(function(){d.viewModel.date?d.setPickerDateTime(d.viewModel.date.get()):d.viewModel.time&&d.setPickerDateTime(d.viewModel.time.get())},1);a._dateTimePickerBindingToken&&a.date.unbind(a._dateTimePickerBindingToken);
a._dateTimePickerBindingToken=a.date.bind(this,function(a){if(d.attached_pickerType.get()===d._dateTimePickerType.jQueryPicker){var b=$(d.jQueryPicker,d.root).datepicker("getDate");if(null===a||void 0===a){d.app.trace.warning("Date parameter is null.");return}if(b&&a.getTime()===b.getTime())return}d.setPickerDateTime(a)});this._syncComboBoxes();b.prototype.attach.call(this,a)};d.prototype._syncComboBoxes=function(){for(var a=[this.attached_day,this.attached_month,this.attached_year],b=0;b<a.length;++b)a[b].bind(this,
dojo.hitch(this,this._calcTime))};d.prototype._isLeapYear=function(a){return 0===a%400?!0:0===a%100?!1:0===a%4?!0:!1};d.prototype._calcTime=function(){var a=this.attached_month.get();if(null!=a){var b=this._daysPerMonth[a];1===a&&(b=29);if(this.attached_days.getLength()<b)for(a=this.attached_days.getLength();a<b;++a)this.attached_days.addItem(a+1);else this.attached_days.removeRange(b)}};d.prototype.setPickerDateTime=function(a){b.prototype.setPickerDateTime.call(this,a);if(a)this.attached_day.set(a.getDate()),
this.attached_month.set(a.getMonth()),this.attached_year.set(a.getFullYear());else{this.attached_day.set(null);this.attached_month.set(null);this.attached_year.set(null);for(var c=0;c<=this.selectElementCount;c++)this["select"+c]&&(this["select"+c].selectedIndex=-1)}this.native_datetime_element&&(this.native_datetime_element.valueAsDate=a);this.native_date_element&&(this.native_datetime_element.valueAsDate=a);if(this.attached_pickerType.get()===this._dateTimePickerType.jQueryPicker||this.attached_pickerType.get()===
this._dateTimePickerType.nativeDateJQueryTimePicker)this._jQueryPickerInitialized&&$(this.jQueryPicker,this.root).datetimepicker("setDate",a),this._updatejQueryFormattedInput(a)};d.prototype.handleChangeComboBoxTime=function(){var a=this.viewModel.date.get();null!=this.attached_year.get()||null!=this.attached_month.get()||null!=this.attached_day.get()||this.viewModel.includeTimePicker.get()&&(null!=this.attached_hour.get()||null!=this.attached_minute.get()||null!=this.attached_second.get())?(a||(a=
new Date,this.viewModel.includeTimePicker.get()||(a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0))),null==this.attached_year.get()&&this.attached_year.set(a.getFullYear()),null==this.attached_month.get()&&this.attached_month.set(a.getMonth()),null==this.attached_day.get()&&this.attached_day.set(a.getDate()),a.setFullYear(this.attached_year.get()),a.setMonth(this.attached_month.get()),a.setDate(this.attached_day.get()),this.viewModel.includeTimePicker.get()&&(null==this.attached_hour.get()&&
this.attached_hour.set(a.getHours()),null==this.attached_minute.get()&&this.attached_minute.set(a.getMinutes()),null==this.attached_second.get()&&this.attached_second.set(a.getSeconds()),a.setHours(this.attached_hour.get()),a.setMinutes(this.attached_minute.get()),a.setSeconds(this.attached_second.get()))):a=null;this.viewModel.date.set(a)};d.prototype.handleChangeComboBoxTimeWithNativeDate=function(){var a=this.viewModel.date.get();a||(a=new Date);null==this.attached_hour.get()&&this.attached_hour.set(a.getHours());
null==this.attached_minute.get()&&this.attached_minute.set(a.getMinutes());null==this.attached_second.get()&&this.attached_second.set(a.getSeconds());a.setHours(this.attached_hour.get());a.setMinutes(this.attached_minute.get());a.setSeconds(this.attached_second.get());this.viewModel.date.set(a)};d.prototype._createjQueryPicker=function(){var a=this;d.localizedJqueryDatepicker||this._localizeJqueryDatepicker();$(this.jQueryPicker,this.root).blur();var b={dateFormat:"yy-mm-dd",showOn:"button",changeYear:!0,
yearRange:"c-50:c+50",onClose:function(b,c){a.disabled=!0;a.readOnly=!0},onChangeMonthYear:function(b,c,d){d=d.selectedDay;var e=null;a.viewModel.date.get()?e=new Date(b,c-1,d,a.viewModel.date.get().getHours(),a.viewModel.date.get().getMinutes(),a.viewModel.date.get().getSeconds()):(e=new Date,e=new Date(b,c-1,d,e.getHours(),e.getMinutes(),e.getSeconds()));a.viewModel.date.set(e)},beforeShow:function(b,c){a.disabled=!0;a.readOnly=!0;$(c.input).siblings(".ui-datepicker-trigger").attr("aria-label",
a.getResource("language-accessibility-datepicker-trigger-button-aria-label"));var d=$(window).width(),e=d-$(c.input).siblings(".ui-datepicker-trigger").offset().left,f=parseFloat($(c.dpDiv).css("width")),h=0,h=!isNaN(e)&&!isNaN(f)&&f>e?$(a.jQueryFormattedInput,a.root).offset().left-(d-f):$(a.jQueryFormattedInput,a.root).offset().left-$(c.input).siblings(".ui-datepicker-trigger").offset().left;$(c.dpDiv).css("marginLeft",h)}};this.attached_pickerType.get()===this._dateTimePickerType.jQueryPicker?(b.onSelect=
function(b,c){var d=$(a.jQueryPicker,a.root).datepicker("getDate");a.viewModel.date.set(d);a._updatejQueryFormattedInput(d)},this.viewModel.includeTimePicker.get()?("Long"===this.viewModel.dateFormat.get()?this._dateFormat=e.DateFormat.DATE_TIME_LONG:"Short"===this.viewModel.dateFormat.get()?this._dateFormat=e.DateFormat.DATE_TIME_SHORT:this.viewModel.dateFormat.get()?this._dateFormat=this.viewModel.dateFormat.get():this._dateFormat=e.DateFormat.DATE_TIME_SHORT,b.timeFormat="Short"===this.viewModel.timePickerItem.timeFormat.get()?
"HH:mm":"HH:mm:ss",b.gcxTimeFormat="Short"===this.viewModel.timePickerItem.timeFormat.get()?e.DateFormat.TIME_SHORT:e.DateFormat.TIME_LONG,b.showSecond="LongTime"===this.viewModel.timePickerItem.timeFormat.get(),b.gcxTimeStyle=this.viewModel.timePickerItem.jQueryPickerTimeAsInfoMsg.get()):("Long"===this.viewModel.dateFormat.get()?this._dateFormat=e.DateFormat.DATE_LONG:"Short"===this.viewModel.dateFormat.get()?this._dateFormat=e.DateFormat.DATE_SHORT:this.viewModel.dateFormat.get()?this._dateFormat=
this.viewModel.dateFormat.get():this._dateFormat=e.DateFormat.DATE_SHORT,b.hourMin=0,b.hourMax=0,b.minuteMin=0,b.minuteMax=0,b.showHour=!1,b.showMinute=!1,b.showTime=!1,b.timeFormat=""),$(this.jQueryPicker,this.root).datetimepicker(b),$(this.jQueryPicker,this.root).datetimepicker("setDate",this.viewModel.date.get()),this._jQueryPickerInitialized=!0):this.attached_pickerType.get()===this._dateTimePickerType.nativeDateJQueryTimePicker&&(this._dateFormat="Short"===this.viewModel.timePickerItem.timeFormat.get()?
e.DateFormat.TIME_SHORT:e.DateFormat.TIME_LONG,b.timeFormat="Short"===this.viewModel.timePickerItem.timeFormat.get()?"HH:mm":"HH:mm:ss",b.gcxTimeFormat="Short"===this.viewModel.timePickerItem.timeFormat.get()?e.DateFormat.TIME_SHORT:e.DateFormat.TIME_LONG,b.showSecond="LongTime"===this.viewModel.timePickerItem.timeFormat.get(),b.onSelect=function(b,c){var d=$(a.jQueryPicker,a.root).datepicker("getDate"),e=a.viewModel.date.get();e.setHours(d.getHours());e.setMinutes(d.getMinutes());e.setSeconds(d.getSeconds());
a.viewModel.date.set(e);a.setPickerDateTime(e)},$(this.jQueryPicker,this.root).timepicker(b),$(this.jQueryPicker,this.root).timepicker("setDate",this.viewModel.date.get()),this._jQueryPickerInitialized=!0);this._updatejQueryFormattedInput(this.viewModel.date.get());$.datepicker._doKeyDown&&(b=$(this.jQueryFormattedInput,this.root),b.data("datepicker",$(this.jQueryPicker,this.root).data("datepicker")),b.keydown($.datepicker._doKeyDown),b.keypress($.datepicker._doKeyPress),b.keyup($.datepicker._doKeyUp))};
d.prototype._updatejQueryFormattedInput=function(b){b?(b=a.formatDate(b,this._dateFormat),$(this.jQueryFormattedInput,this.root).val(b)):$(this.jQueryFormattedInput,this.root).val("")};d.prototype._localizeJqueryDatepicker=function(){var a=this.getResource("datepicker.regional"),b=this.getResource("timepicker.regional");a&&$.datepicker.setDefaults(a);b&&$.timepicker.setDefaults(b);d.localizedJqueryDatepicker=!0};d.prototype._buildComboBoxes=function(a){b.prototype._buildComboBoxes.call(this,a);a=
[];for(var c=1900;2100>=c;++c)a.push(c);this.attached_years.set(a);a=[];for(c=0;12>c;++c){var d="language-months-{0}".format(c);a.push({value:c,name:this.app.getResource(this.libraryId,d)})}this.attached_months.set(a);a=[];for(c=1;32>c;++c)a.push(c);this.attached_days.set(a)};d.prototype.handleClickSetNull=function(){this.viewModel.date.get()&&(this._lastClearedDate=this.viewModel.date.get());this.viewModel.date.set(null);this.setPickerDateTime(null)};d.prototype.handleClickSetNotNull=function(){if(null!=
this._lastClearedDate)this.viewModel.date.set(this._lastClearedDate),this.setPickerDateTime(this._lastClearedDate),this._lastClearedDate=null;else{var a=new Date;this.viewModel.date.set(a);this.setPickerDateTime(a)}};d.prototype.handleJqueryDatePickerTextChanged=function(b,c,d){c="";if(c=b.currentTarget?b.currentTarget.value:b.target.value)b=[this._dateFormat],this.viewModel.includeTimePicker.get()?b.concat([e.DateFormat.DATE_TIME_LONG,e.DateFormat.DATE_TIME_SHORT]):b.concat([e.DateFormat.DATE_LONG,
e.DateFormat.DATE_SHORT]),b=a.parseDate(c,b),isNaN(b.getTime())&&(b=new Date),this.viewModel.date.get()&&b.getTime()==this.viewModel.date.get().getTime()||(this.viewModel.date.set(b),this.setPickerDateTime(b),this.handleChangeComboBoxTime())};d.prototype.handleJqueryTimePickerTextChanged=function(b,c,d){c="";if(c=b.currentTarget?b.currentTarget.value:b.target.value)b=a.parseDate(c,[e.DateFormat.TIME_LONG,e.DateFormat.TIME_SHORT]),isNaN(b.getTime())&&(b=new Date),(c=this.viewModel.date.get())||(c=
new Date),c.setHours(b.getHours()),c.setMinutes(b.getMinutes()),c.setSeconds(b.getSeconds()),this.viewModel.date.set(c),this.setPickerDateTime(c)};d.prototype.handleJqueryDatePickerInitializeClick=function(a,b,c){$(b).remove();this._jQueryPickerInitialized||this._createjQueryPicker();this.attached_pickerType.get()===this._dateTimePickerType.jQueryPicker?$(this.jQueryPicker,this.root).datetimepicker("show"):this.attached_pickerType.get()===this._dateTimePickerType.nativeDateJQueryTimePicker&&$(this.jQueryPicker,
this.root).timepicker("show")};return d}(k.TimePickerFormItemView);h.localizedJqueryDatepicker=!1;f.DatePickerFormItemView=h});
define("infrastructure/ui/components/Forms/FilePickerFormItemView","require exports infrastructure/ui/components/Forms/FormItemViewBase geocortex/framework/observables geocortex/framework/utils/utils geocortex/forms/FileItem".split(" "),function(h,f,k,l,e,c){h=function(a){function b(b,c){return a.call(this,b,c)||this}__extends(b,a);b.prototype.attach=function(b){if(!b)throw Error("{0}: A view model must be specified to attach to.".format(this.id));b.attached_controlId=new l.Observable("filepicker-{0}".format(e.alphaNumericToken()));
a.prototype.attach.call(this,b)};b.prototype.handleChange=function(a,b,e){var f=this;this.viewModel.files.clear();b=function(a){var b=a.name,d=a.size,e=a.type,g=new FileReader;g.onload=function(a){var g=new c.FileItem;g.fileName=b;g.fileSize=d;g.fileType=e;g.fileDataBase64=decodeURIComponent(a.target.result.substring(a.target.result.indexOf("base64,")+7));f.viewModel.files.addItem(g)};g.readAsDataURL(a)};for(e=0;e<a.currentTarget.files.length;e++)b(a.currentTarget.files[e])};b.prototype.handleClearClick=
function(a,b,c){this.viewModel.clear()};return b}(k.FormItemViewBase);f.FilePickerFormItemView=h});
define("infrastructure/ui/components/Forms/GroupBoxFormItemView",["require","exports","infrastructure/ui/components/Forms/ContainerFormItemView"],function(h,f,k){h=function(f){function e(c,a){return f.call(this,c,a)||this}__extends(e,f);e.prototype.attach=function(c){if(!c)throw Error("{0}: A view model must be specified to attach to.".format(this.id));f.prototype.attach.call(this,c)};return e}(k.ContainerFormItemView);f.GroupBoxFormItemView=h});
define("infrastructure/ui/components/Forms/HyperlinkFormItemView",["require","exports","infrastructure/ui/components/Forms/FormItemViewBase"],function(h,f,k){h=function(f){function e(c,a){return f.call(this,c,a)||this}__extends(e,f);e.prototype.attach=function(c){if(!c)throw Error("{0}: A view model must be specified to attach to.".format(this.id));f.prototype.attach.call(this,c)};e.prototype.handleClick=function(c,a,b){this.viewModel.wasClicked.set(!0);return this.app.followNavigationLink({url:b.uri,
element:a})};return e}(k.FormItemViewBase);f.HyperlinkFormItemView=h});
define("infrastructure/ui/components/Forms/ListBoxFormItemView","require exports infrastructure/ui/components/Forms/FormItemViewBase geocortex/framework/observables geocortex/framework/utils/utils infrastructure/ui/components/Forms/FormsUtils".split(" "),function(h,f,k,l,e,c){h=function(a){function b(b,c){var e=a.call(this,b,c)||this;e.selectionChangedTimer=null;e.selectedBindingToken=null;e.selectionBindingToken=null;return e}__extends(b,a);b.prototype.attach=function(b){var f=this;if(!b)throw Error("{0}: A view model must be specified to attach to.".format(this.id));
b.attached_controlId=new l.Observable("formitem-{0}".format(e.alphaNumericToken()));if(b.selectionMode){var h=b.selectionMode.get().toLowerCase();b.attached_isMultiple=new l.Observable("multiple"===h.toLowerCase()||"extended"==h.toLowerCase())}b.selected&&!this.selectedBindingToken?this.selectedBindingToken=b.selected.bind(this,function(){0<=b.selected.get()&&this.handleSelectionChanged()}):b.selection&&!this.selectionBindingToken&&(this.selectionBindingToken=b.selection.bind(this,function(){0<b.selection.length()&&
this.handleSelectionChanged()}));b.queryTaskRunner&&(b.queryTaskRunner.formatCallback=c.FormsUtils.formatListItem);a.prototype.attach.call(this,b);$(this.selectElement).dblclick(function(){f.app.command("SubmitWorkflowForm").execute(f.viewModel.formDefinition)})};b.prototype.handleSelectionChanged=function(a,b,c){var e=this;null!=this.selectionChangedTimer&&(clearInterval(this.selectionChangedTimer),this.selectionChangedTimer=null);this.selectionChangedTimer=setTimeout(function(){!1===e.viewModel.queryTaskRunner.isBusy.get()&&
(e.viewModel.triggerCascading(null),e.selectionChangedTimer=null)},450);return!0};return b}(k.FormItemViewBase);f.ListBoxFormItemView=h});
define("infrastructure/ui/components/Forms/MarkdownFormItemView",["require","exports","infrastructure/ui/components/Forms/FormItemViewBase","infrastructure/FilterUtils"],function(h,f,k,l){h=function(e){function c(a,b){var c=e.call(this,a,b)||this;c.markdownElement=null;return c}__extends(c,e);c.prototype.attach=function(a){if(!a)throw Error("{0}: A view model must be specified to attach to.".format(this.id));e.prototype.attach.call(this,a);a=(new Remarkable({breaks:!0})).render(a.plainText.get());
a=l.sanitize(a,{uriTransformer:function(a){return a}});this.markdownElement.innerHTML=a};return c}(k.FormItemViewBase);f.MarkdownFormItemView=h});
define("infrastructure/ui/components/Forms/RadioButtonFormItemView",["require","exports","infrastructure/ui/components/Forms/FormItemViewBase","geocortex/framework/observables","geocortex/framework/utils/utils"],function(h,f,k,l,e){h=function(c){function a(a,d){return c.call(this,a,d)||this}__extends(a,c);a.prototype.attach=function(a){var d=this;if(!a)throw Error("{0}: A view model must be specified to attach to.".format(this.id));a.attached_textOnLeft=new l.Observable(!1);this.addDisposableBinding(a.textLocation,
a.textLocation.bind(this,function(c){a.attached_textOnLeft.set("left"===c.toLowerCase())}));a.textLocation.pulse();a.attached_controlId=new l.Observable("radio-{0}".format(e.alphaNumericToken()));a.attached_labelText=null!=a.text?new l.Observable(a.text.get()):"";c.prototype.attach.call(this,a);this.radioElement&&(this.radioElement.checked=a.checked.get(),$(this.radioElement).change(function(){a.checked.set(this.checked)}));this.viewModel.__getRadioValueClosure=function(){var a=d.radioElement;return a?
a.checked:!1};return!0};return a}(k.FormItemViewBase);f.RadioButtonFormItemView=h});
define("infrastructure/ui/components/Forms/TextEntryFormItemView",["require","exports","infrastructure/ui/components/Forms/FormItemViewBase","geocortex/framework/observables","geocortex/framework/utils/utils"],function(h,f,k,l,e){h=function(c){function a(){return null!==c&&c.apply(this,arguments)||this}__extends(a,c);a.prototype.attach=function(a){if(!a)throw Error("{0}: A view model must be specified to attach to.".format(this.id));a.attached_controlId=new l.Observable("formitem-{0}".format(e.alphaNumericToken()));
null!=a.inputScope&&("Password"===a.inputScope.get()?a.attached_type=new l.Observable("password"):a.attached_type=new l.Observable("text"));c.prototype.attach.call(this,a)};a.prototype.handleBlurControl=function(){this.app.event("WorkflowFormTextInputBlurredEvent").publish(this)};return a}(k.FormItemViewBase);f.TextEntryFormItemView=h});
define("infrastructure/ui/components/SmartPanel/SmartPanelViewModel",["require","exports","geocortex/framework-ui/ViewContainer/ViewContainerViewModel","infrastructure/menus/MenuViewModel","geocortex/framework/observables"],function(h,f,k,l,e){h=function(c){function a(b,d){var f=c.call(this,b,d)||this;f.hoistedMenuViewModel=new e.Observable(a.emptyMenuViewModel);f.hasHoistedMenu=new e.Observable(!1);f.hasExecutableMenuItems=new e.Observable(!1);f.inlineMenuIsOpen=new e.Observable(!1);f.panelMaximized=
new e.Observable(!1);f.showingMaximizeButton=new e.Observable(!1);f.resizeX=!1;f.resizeY=!1;a.emptyMenuViewModel||(a.emptyMenuViewModel=new l.MenuViewModel(b,d));return f}__extends(a,c);a.prototype.initialize=function(a){c.prototype.initialize.call(this,a);this.statusRegion=a.statusRegionName;this.statusRegionType=a.statusRegionType||"geocortex.framework.ui.DivRegionAdapter";a.resizeX&&(this.resizeX=a.resizeX);a.resizeY&&(this.resizeY=a.resizeY);this.menuRegion=a.menuRegion||null;void 0!=a.showMaximizeButton&&
this.showingMaximizeButton.set(a.showMaximizeButton)};return a}(k.ViewContainerViewModel);f.SmartPanelViewModel=h});
define("infrastructure/ui/components/SmartPanel/SmartPanelView",["require","exports","geocortex/framework-ui/ViewContainer/ViewContainerView","infrastructure/ui/components/SmartPanel/SmartPanelViewModel","infrastructure/menus/MenuViewModel"],function(h,f,k,l,e){h=function(c){function a(){var a=null!==c&&c.apply(this,arguments)||this;a.resizeY=!1;a.resizeX=!1;a._menuViews={};a._menuItemInvokedSubscriptionToken=null;return a}__extends(a,c);a.prototype.attach=function(a){var d=this;c.prototype.attach.call(this,
a);if(this.configuration.resizableParentRegion)if(this.app.site&&this.app.site.isInitialized)a=this.app.viewManager.getExistingRegionByName(this.configuration.resizableParentRegion),this.resizableRegion=a.domElement;else this.app.event("SiteInitializedEvent").once(this,function(){var a=d.app.viewManager.getExistingRegionByName(d.configuration.resizableParentRegion);d.resizableRegion=a.domElement});else if(this.app.site&&this.app.site.isInitialized)a=this.app.viewManager.getExistingRegionByName(this.regionName),
this.resizableRegion=a.domElement;else this.app.event("SiteInitializedEvent").once(this,function(){var a=d.app.viewManager.getExistingRegionByName(d.regionName);d.resizableRegion=a.domElement});this.viewModel.resizeX?this.resizeX=this.viewModel.resizeX:this.configuration.resizeX&&(this.resizeX=this.configuration.resizeX);this.viewModel.resizeY?this.resizeY=this.viewModel.resizeY:this.configuration.resizeY&&(this.resizeY=this.configuration.resizeY);$(this.app.getHostElement()).on("onclick.handle-resize-error",
function(a){$(d.app.getHostElement()).off("mousemove.header-resize touchmove.header-resize");null!=d.resizePreviewElement.parentNode&&d.resizableRegion.parentNode.removeChild(d.resizePreviewElement)});this.viewModel.panelMaximized.bind(this,function(a){a?$(d.resizableRegion).attr("data-maximized","true"):$(d.resizableRegion).attr("data-maximized","false")});this.viewModel.statusRegion?($(this.statusRegionElement).attr("data-region-name",this.viewModel.statusRegion),$(this.statusRegionElement).attr("data-region-adapter",
this.viewModel.statusRegionType)):this.statusRegionElement&&this.statusRegionElement.parentNode&&(this.statusRegionElement.parentNode.removeChild(this.statusRegionElement),this.statusRegionElement=null);this._initializeEvents();this.app.command("MaximizePanel").register(this,function(a){return d._togglePanelMaximized(a,"maximize")},this._canExecuteMaximizeRestoreOperations);this.app.command("RestorePanel").register(this,function(a){return d._togglePanelMaximized(a,"restore")},this._canExecuteMaximizeRestoreOperations)};
a.prototype._initializeEvents=function(){var a=this,c=this.app.event("PanelRegionRestoredEvent").subscribe(this,function(c){c===a.resizableRegion&&a.viewModel.panelMaximized.set(!1)}),e=this.app.event("PanelRegionMaximizedEvent").subscribe(this,function(c){c===a.resizableRegion&&a.viewModel.panelMaximized.set(!0)});this.trackSubscription(this.app.event("PanelRegionRestoredEvent"),c);this.trackSubscription(this.app.event("PanelRegionMaximizedEvent"),e);this.viewModel.statusRegion&&(c=this.app.event("RegionActivatedEvent").subscribe(this,
this._handleRegionActivatedOrDeactivated),e=this.app.event("RegionDeactivatedEvent").subscribe(this,this._handleRegionActivatedOrDeactivated),this.trackSubscription(this.app.event("RegionActivatedEvent"),c),this.trackSubscription(this.app.event("RegionDeactivatedEvent"),e))};a.prototype._handleRegionActivatedOrDeactivated=function(a){var c=this.viewModel?this.viewModel.statusRegion:null;a&&a.name===c&&this.delayedResize()};a.prototype._togglePanelMaximized=function(a,c){a===this.id&&"maximize"===
c&&this.maximizePanel();a===this.id&&"restore"===c&&this.minimizePanel()};a.prototype._canExecuteMaximizeRestoreOperations=function(){return this.viewModel.showingMaximizeButton.get()?!0:!1};a.prototype._handleViewActivatedInContainerEvent=function(b){c.prototype._handleViewActivatedInContainerEvent.call(this,b);if(this.viewModel&&this.viewModel.getDescriptorForActiveView(b))if(!0===b instanceof a)b.setParentPanel(this),(b=b.viewModel.currentView)&&b.viewModel&&b.isActive&&this.hoistMenuForView(b);
else{for(var d=this._parentPanel,e;d;)d.viewModel.headerIsVisible.get()&&(e=d),d=d._parentPanel;e?e.hoistMenuForView(b):this.hoistMenuForView(b)}};a.prototype.activated=function(){c.prototype.activated.call(this)};a.prototype.deactivated=function(){c.prototype.deactivated.call(this)};a.prototype.destroy=function(){c.prototype.destroy.call(this);this._unsubscribeMenuItemInvokedSubscription();for(var a in this._menuViews)this._menuViews.hasOwnProperty(a)&&this.app.viewManager.destroyView(this._menuViews[a]);
this._parentPanel=this._menuViews=null};a.prototype.openHoistedMenuInRegion=function(a){this._destroyHoistedMenuOwnerViewIfExists();this.hoistedMenuOwnerView=this.createMenuView(this.viewModel.hoistedMenuViewModel.get());this.hoistedMenuOwnerView.regionName=a;this.app.viewManager.activateView(this.hoistedMenuOwnerView)};a.prototype.resolveWidget=function(a,c,e){if("SmartPanelHoistedMenu"===a){if(!this.hoistedMenuId)return;this._destroyHoistedMenuOwnerViewIfExists();this.hoistedMenuOwnerView=this.createMenuView(c);
return this.viewModel.menuRegion?null:this.hoistedMenuOwnerView}return null};a.prototype.createMenuView=function(a){var c=this,e=this.app.viewManager.createView({markupResource:"Mapping/infrastructure/menus/MenuView.html",typeName:"geocortex.essentialsHtmlViewer.mapping.infrastructure.menus.MenuView",libraryId:"Mapping.Infrastructure"});e.libraryId=this.libraryId;e.configuration.menuId=this.hoistedMenuId;a&&(e.attach(a),this.auto(a.hasExecutableMenuItems,this,function(a){a||c.viewModel.menuRegion||
c.viewModel.inlineMenuIsOpen.set(!1)}));this._menuViews[e.id]=e;this._unsubscribeMenuItemInvokedSubscription();this._menuItemInvokedSubscriptionToken=this.app.event("MenuItemInvokedEvent").subscribe(this,function(a){a.menuView.id in c._menuViews&&(c.viewModel.menuRegion||c.viewModel.inlineMenuIsOpen.set(!1),c.app.viewManager.deactivateView(a.menuView))});var f=this.app.event("ViewDeactivatedEvent").subscribe(this,function(a){a===e&&(c.app.event("ViewDeactivatedEvent").unsubscribe(f),a.viewModel=null,
c.app.viewManager.destroyView(a),delete c._menuViews[e.id])});a.menuContext.pulse();return e};a.prototype.handleTapMenuButton=function(){var a=this;if(this.viewModel.menuRegion)if(this.hoistedMenuOwnerView&&this.hoistedMenuOwnerView.regionName===this.viewModel.menuRegion&&this.hoistedMenuOwnerView.isActive){var c=this.hoistedMenuOwnerView.viewModel&&this.hoistedMenuOwnerView.viewModel.menuSourceView;this._destroyHoistedMenuOwnerViewIfExists();c&&this.app.viewManager.activateView(c)}else this.openHoistedMenuInRegion(this.viewModel.menuRegion);
else this.viewModel.inlineMenuIsOpen.set(!this.viewModel.inlineMenuIsOpen.get()),this.viewModel.inlineMenuIsOpen.get()&&(this.app.event("FlyoutActivated").publish(this),c={view:this.hoistedMenuOwnerView,onOtherInteracted:function(c){$(c.srcElement||c.target).hasClass("menu-button")||(a.viewModel.inlineMenuIsOpen.set(!1),a.app.event("FlyoutDeactivated").publish(a))}},this.app.command("TapToDismiss").execute(c))};a.prototype.hoistMenuForView=function(b){var c=this;if(b!==this.hoistedMenuOwnerView){var f=
this.app.menuRegistry.getMenuWidgetsForView(b);f&&(f=f.filter(function(a){return a.hoistMenu}));if(f&&f.length){var f=f[0],h=new e.MenuViewModel(this.app,this.libraryId);h.menuSourceView=b;f.context&&f.context.isObservable?h.menuContext.sync(f.context):h.menuContext.sync(f.widgetViewModel.menuContext);this.hoistedMenuId=f.menuId;this.viewModel.hoistedMenuViewModel.set(h);this.viewModel.hasHoistedMenu.set(!0);this.viewModel.hasExecutableMenuItems.sync(h.hasExecutableMenuItems);var k=$(f.domElement);
k.addClass(a.HoistedClassName);var n=this.app.event("ViewUnhostedEvent").subscribe(this,function(a){a.view===b&&(c.app.event("ViewUnhostedEvent").unsubscribe(n),k.removeClass("hidden-hoisted-menu"))})}else this.viewModel.inlineMenuIsOpen.get()&&this.viewModel.inlineMenuIsOpen.set(!1),this.viewModel.hasHoistedMenu.set(!1),this.viewModel.hoistedMenuViewModel.set(l.SmartPanelViewModel.emptyMenuViewModel),this.viewModel.hasExecutableMenuItems.removeSync(),this.viewModel.hasExecutableMenuItems.set(!1)}};
a.prototype.setParentPanel=function(a){this._parentPanel=a};a.prototype.handleMaximizeToggleClick=function(a,c,e){this.viewModel.panelMaximized.get()?this.minimizePanel():this.maximizePanel()};a.prototype.maximizePanel=function(){this.viewModel.panelMaximized.set(!0);this.app.command("ResizeShell").execute();this.app.event("ApplicationResizedEvent").publish();this.app.event("PanelRegionMaximizedEvent").publish(this.resizableRegion)};a.prototype.minimizePanel=function(){this.viewModel.panelMaximized.set(!1);
this.app.command("ResizeShell").execute();this.app.event("ApplicationResizedEvent").publish();this.app.event("PanelRegionRestoredEvent").publish(this.resizableRegion)};a.prototype._unsubscribeMenuItemInvokedSubscription=function(){this._menuItemInvokedSubscriptionToken&&(this.app.event("MenuItemInvokedEvent").unsubscribe(this._menuItemInvokedSubscriptionToken),this._menuItemInvokedSubscriptionToken=null)};a.prototype.handleHeaderMouseDown=function(a,c,e){var f=this;if(this.viewModel.panelMaximized.get()||
a.target!==a.currentTarget)return!0;$(this.app.getHostElement()).off("mouseup.header-click touchend.header-click");var h=!0;$(this.app.getHostElement()).one("mouseup.header-click touchend.header-click",function(){h=!1});setTimeout(function(){h&&f.resizableRegion&&($(f.app.getHostElement()).off("mouseup.header-click touchend.header-click"),f.resizeSmartPanel(a.pageX,a.pageY),a.preventDefault())},250);a.preventDefault();a.stopImmediatePropagation();return!0};a.prototype.handleHeaderTouchStart=function(a,
c,e){var f=this;if(this.viewModel.panelMaximized.get())return!0;for(c=a.target||a.srcElement;c!=this.root;){if($(c).is("button")&&!$(c).hasClass("resize-handle"))return!0;c=c.parentElement}$(this.app.getHostElement()).off("touchend.header-click");var h=!0;$(this.app.getHostElement()).one("touchend.header-click",function(){h=!1});setTimeout(function(){h&&f.resizableRegion&&(a.preventDefault(),$(f.app.getHostElement()).off("touchend.header-click"),f.resizeSmartPanel(a.targetTouches[0].pageX,a.targetTouches[0].pageY))},
250);a.preventDefault();return!0};a.prototype.resize=function(){if(this.headerElement&&this.scrollRegionElement&&this.containerElement){var a=$(this.statusRegionElement),c=$(this.headerElement),e=$(this.footerElement),f=$(this.scrollRegionElement),a=a.length&&"none"!==a.css("display")?a.outerHeight():0,c=c.length&&"none"!==c.css("display")?c.outerHeight():0,e=e.length&&"none"!==e.css("display")?e.outerHeight():0,c=c+a;"relative"!==f.css("position")&&f.css("top",c+"px");f.css("bottom",e+"px")}};a.prototype.resizeSmartPanel=
function(a,c){var e=this;if(this.resizeX||this.resizeY){var f={};f.initialX=a;f.initialY=c;this.app.event("PanelResizeStartEvent").publish({viewId:this.id,resizeInformation:f});if(null===this.resizePreviewElement||void 0===this.resizePreviewElement)this.resizePreviewElement=document.createElement("div"),this.resizePreviewElement.className="resize-hint";null===this.resizePreviewElement.parentElement&&(this.app.getHostElement().appendChild(this.resizePreviewElement),$(this.resizePreviewElement).css("left",
this.root.getBoundingClientRect().left));f.initialPanelHeight=$(this.resizableRegion).height();f.initialPanelWidth=$(this.resizableRegion).width();if(0===f.initialPanelHeight||f.initialPanelHeight>$(this.resizableRegion.parentElement).height())f.initialPanelHeight=$(this.resizableRegion.parentElement).height();if(0===f.initialPanelWidth||f.initialPanelWidth>$(this.resizableRegion.parentElement).width())f.initialPanelWidth=$(this.resizableRegion.parentElement).width();this.resizeX?($(this.resizePreviewElement).width(f.initialPanelWidth),
$(this.resizePreviewElement).height(f.initialPanelHeight),f.minWidth=parseInt($(this.resizableRegion).css("min-width")),f.maxWidth=parseInt($(this.resizableRegion).css("max-width"))):this.resizeY&&($(this.resizePreviewElement).width(f.initialPanelWidth),$(this.resizePreviewElement).height(f.initialPanelHeight),f.minHeight=parseInt($(this.resizableRegion).css("min-height")),f.maxHeight=parseInt($(this.resizableRegion).css("max-height")));this._resizeAccordingToSizeConstraints(f,this.resizePreviewElement);
$(this.app.getHostElement()).one("mouseup.header-resize touchend.header-resize",function(a){return e._handleResizeEnd(a,f)});$(this.app.getHostElement()).on("mousemove.header-resize ",function(a){e.app.event("PanelResizingEvent").publish({viewId:e.id,resizeInformation:f});f.currentX=a.pageX;f.currentY=a.pageY;e._resizeAccordingToSizeConstraints(f,e.resizePreviewElement);a.preventDefault();return!1});$(this.app.getHostElement()).on("touchmove.header-resize",function(a){e.app.event("PanelResizingEvent").publish({viewId:e.id,
resizeInformation:f});var b=a.originalEvent;f.currentX=b.targetTouches[0].pageX;f.currentY=b.targetTouches[0].pageY;e._resizeAccordingToSizeConstraints(f,e.resizePreviewElement);a.preventDefault();return!1})}else this.app.trace.debug("This panel is not configured to be resizable!")};a.prototype._handleResizeEnd=function(a,c){$(this.app.getHostElement()).off("mousemove.header-resize touchmove.header-resize");this.resizePreviewElement.parentNode&&this.resizePreviewElement.parentNode.removeChild(this.resizePreviewElement);
this._resizeAccordingToSizeConstraints(c,this.resizableRegion);this.app.event("PanelResizeEndEvent").publish({viewId:this.id,resizeInformation:c});this.app.command("ResizeShell").execute();this.app.event("ApplicationResizedEvent").publish()};a.prototype._resizeAccordingToSizeConstraints=function(a,c){if(this.resizeX){var e=a.initialPanelWidth+(a.currentX-a.initialX);e<a.minWidth?$(c).width(a.minWidth):e>a.maxWidth?$(c).width(a.maxWidth):$(c).width(e)}this.resizeY&&(e=a.initialPanelHeight+(a.initialY-
a.currentY),e<a.minHeight?$(c).height(a.minHeight):e>a.maxHeight?$(c).height(a.maxHeight):$(c).height(e))};a.prototype._destroyHoistedMenuOwnerViewIfExists=function(){if(this.hoistedMenuOwnerView){var a=this.hoistedMenuOwnerView;this.hoistedMenuOwnerView=null;a.viewModel=null;this.app.viewManager.destroyView(a);delete this._menuViews[a.id]}};return a}(k.ViewContainerView);h.HoistedClassName="hidden-hoisted-menu";f.SmartPanelView=h});
define("infrastructure/ui/components/MultiPane/PaneViewModelConfig",["require","exports"],function(h,f){});
define("infrastructure/ui/components/MultiPane/PaneViewModel",["require","exports","geocortex/framework/ui/ViewModelBase","geocortex/framework/observables"],function(h,f,k,l){h=function(e){function c(){var a=null!==e&&e.apply(this,arguments)||this;a.currentPaneItem=new l.Observable(null);a.headerIsVisible=new l.Observable(!0);a.showXButton=new l.Observable(!0);return a}__extends(c,e);c.prototype.initialize=function(a){e.prototype.initialize.call(this,a);a&&(a.hasOwnProperty("headerIsVisible")&&this.headerIsVisible.set(!!a.headerIsVisible),
a.hasOwnProperty("showXButton")&&this.showXButton.set(!!a.showXButton))};c.prototype.onDestroy=function(){e.prototype.onDestroy.call(this);this.currentPaneItem.set(null);this.app=this.currentPaneItem=null};return c}(k.ViewModelBase);f.PaneViewModel=h});
define("infrastructure/ui/components/MultiPane/PaneView",["require","exports","geocortex/framework/ui/ViewBase"],function(h,f,k){h=function(f){function e(){var c=null!==f&&f.apply(this,arguments)||this;c._isDestroyed=!1;return c}__extends(e,f);e.prototype.destroy=function(){f.prototype.destroy.call(this);this._isDestroyed=!0};e.prototype.onClose=function(c){};e.prototype.handleClickClose=function(c,a,b){if(this.viewModel&&this.onClose)this.onClose(this.viewModel.currentPaneItem.get());this._isDestroyed||
this.app.command("DestroyView").execute(this.id)};return e}(k.ViewBase);f.PaneView=h});define("infrastructure/ui/components/MultiPane/MultiPaneViewModelConfig",["require","exports"],function(h,f){});
define("infrastructure/ui/components/MultiPane/MultiPaneViewModel",["require","exports","infrastructure/ui/components/SmartPanel/SmartPanelViewModel","geocortex/framework/observables","geocortex/framework/utils/ArrayUtils"],function(h,f,k,l,e){h=function(c){function a(){var a=null!==c&&c.apply(this,arguments)||this;a.paneItems=new l.ObservableCollection;a.defaultPaneItems=new l.ObservableCollection;a.displayedPaneItems=new l.ObservableCollection;a.expanded=new l.Observable(!1);a.headerIsVisible=new l.Observable(!0);
a.showXButton=new l.Observable(!0);a.selectorIconUri=new l.Observable("");a.selectorText=new l.Observable("");return a}__extends(a,c);a.prototype.initialize=function(a){c.prototype.initialize.call(this,a);a&&(a.hasOwnProperty("headerIsVisible")&&this.headerIsVisible.set(!!a.headerIsVisible),a.hasOwnProperty("showXButton")&&this.showXButton.set(!!a.showXButton),a.hasOwnProperty("selectorIconUri")&&this.selectorIconUri.set(a.selectorIconUri),a.hasOwnProperty("selectorText")&&this.selectorText.set(a.selectorText))};
a.prototype.findPaneItemById=function(a){return e.firstOrDefault(this.paneItems.getItems(),function(c){return c.id&&c.id===a})};a.prototype.findDisplayedPaneItemById=function(a){return e.firstOrDefault(this.displayedPaneItems.getItems(),function(c){return c.id&&c.id===a})};return a}(k.SmartPanelViewModel);f.MultiPaneViewModel=h});
define("infrastructure/ui/components/MultiPane/MultiPaneView",["require","exports","infrastructure/ui/components/SmartPanel/SmartPanelView","geocortex/framework/utils/ArrayUtils"],function(h,f,k,l){h=function(e){function c(a,b){var c=e.call(this,a,b)||this;c._panes=[];c.app.event("ApplicationResizedEvent").subscribe(c,c.handleApplicationResizedEvent);c.app.event("ViewDeactivatedEvent").subscribe(c,c.handleViewDeactivatedEvent);return c}__extends(c,e);c.prototype.activated=function(){var a=this;e.prototype.activated.call(this);
this.viewModel&&this.viewModel.expanded.set(!0);setTimeout(function(){a.handleApplicationResizedEvent()},0)};c.prototype.deactivated=function(){e.prototype.deactivated.call(this);this.viewModel&&this.viewModel.expanded.set(!1)};c.prototype.addDefaultPanes=function(){if(!(0<this.viewModel.displayedPaneItems.getLength()))for(var a=0;a<this.viewModel.defaultPaneItems.getLength();a++){var b=this.viewModel.defaultPaneItems.getAt(a);this.addPaneItem(b)}};c.prototype.addPaneItemById=function(a){a=this.viewModel.findPaneItemById(a);
this.addPaneItem(a)};c.prototype.addPaneItem=function(a){throw Error("Not implemented");};c.prototype.canAddPaneItem=function(a){return a&&this.viewModel?!this.viewModel.displayedPaneItems.contains(a):!1};c.prototype.destroyPaneItemById=function(a){a=this.viewModel.findDisplayedPaneItemById(a);this.destroyPaneItem(a)};c.prototype.destroyPaneItem=function(a){if(a&&this.canDestroyPaneItem(a)){var b=this.findPaneForPaneItem(a);if(!b)return!1;this.viewModel.displayedPaneItems.removeItem(a);this.selector.unselectItem(a);
this.app.command("DestroyView").execute(b.id);0!=this.viewModel.displayedPaneItems.length()||this.viewModel.headerIsVisible.get()||this.app.command("DeactivateView").execute(this.id);return!0}return!1};c.prototype.canDestroyPaneItem=function(a){return a&&this.viewModel?this.viewModel.displayedPaneItems.contains(a):!1};c.prototype.clearPaneItems=function(){for(var a=this.viewModel.displayedPaneItems.getLength();a--;){var b=this.viewModel.displayedPaneItems.getAt(a);this.destroyPaneItem(b)}};c.prototype.handleSelectPane=
function(a){this.addPaneItem(a)};c.prototype.handleUnSelectPane=function(a){this.destroyPaneItem(a)};c.prototype.handleClickClose=function(){this.deactivateContainer()};c.prototype.handleApplicationResizedEvent=function(){if(this.viewModel){var a=-1<this.viewModel.regionType.get().indexOf("Stack"),b=this.scrollRegionElement,c=$(".view .pane",b);a&&0!==c.length&&(a=b.clientWidth/c.length-5,$(c).width(a))}};c.prototype.handleViewDeactivatedEvent=function(a){l.firstOrDefault(this._panes,function(b){return a===
b})&&(l.removeItem(this._panes,a),this.handleApplicationResizedEvent())};c.prototype.findPaneForPaneItem=function(a){for(var b=0;b<this._panes.length;b++){var c=this._panes[b];if(c.viewModel.currentPaneItem.get()===a)return c}return null};c.prototype._executeShowMultiPaneView=function(){this.app.command("ActivateView").execute(this.id);this.addDefaultPanes();0<this.viewModel.displayedPaneItems.getLength()&&this.handleApplicationResizedEvent()};return c}(k.SmartPanelView);f.MultiPaneView=h});
define("infrastructure/ui/components/NumericInput/NumericInputWidget",["require","exports","geocortex/framework/ui/ViewBase"],function(h,f,k){h=function(f){function e(c,a){return f.call(this,c,a)||this}__extends(e,f);e.prototype.attach=function(c){f.prototype.attach.call(this,c);this.initialize(this.configuration)};e.prototype.initialize=function(c){var a;(a=dojo.getObject(c.provider))?(this.provider=new a(this.app,this.libraryId),this.provider.initialize(this),this.bindingToken=this.viewModel.range.value.bind(this,
this.setValue)):this.app.trace.error("{0} can't find numeric input provider typed {1}".format(this.id,c.provider))};e.prototype.updateValue=function(c){this.bindingToken&&this.viewModel.range.value.unbind(this.bindingToken);this.viewModel.range.value.set(c);this.bindingToken=this.viewModel.range.value.bind(this,this.setValue)};e.prototype.setValue=function(c){c=this.validate(c);this.provider.setValue(c);this.nativeInput.value=c.toString()};e.prototype.validate=function(c){c=Number(c);return isNaN(c)?
this.viewModel.range.min:c>this.viewModel.range.max?this.viewModel.range.max:c<this.viewModel.range.min?this.viewModel.range.min:Math.ceil(c/this.viewModel.range.step)*this.viewModel.range.step};e.prototype.validateInput=function(){this.viewModel.range.value.set(this.validate(this.viewModel.range.value.get()))};return e}(k.ViewBase);f.NumericInputWidget=h});
define("infrastructure/ui/components/NumericInput/SliderProviderBase",["require","exports"],function(h,f){var k=function(){function f(e,c){this.value=0;this.app=e;this.libraryId=c}f.prototype.initialize=function(e){throw Error("Not implemented");};f.prototype.setValue=function(e){throw Error("Not implemented");};return f}();f.SliderProviderBase=k});
define("infrastructure/ui/components/NumericInput/KendoSliderProvider",["require","exports","infrastructure/ui/components/NumericInput/SliderProviderBase"],function(h,f,k){h=function(f){function e(c,a){return f.call(this,c,a)||this}__extends(e,f);e.prototype.initialize=function(c){this.widget=c};e.prototype.instantiate=function(){(this.slider=this.widget.viewModel.updateOnDrag?$(this.widget.numericInput).kendoSlider({showButtons:!1,tickPlacement:"none",slide:this.updateValue.bind(this),change:this.updateValue.bind(this)}).data("kendoSlider"):
$(this.widget.numericInput).kendoSlider({showButtons:!1,tickPlacement:"none",change:this.updateValue.bind(this)}).data("kendoSlider"))&&this.slider.value(this.value)};e.prototype.setValue=function(c){this.value=c;this.slider?(this.slider.resize(),this.slider.value(c)):this.instantiate()};e.prototype.updateValue=function(c){this.widget.updateValue(c.value)};return e}(k.SliderProviderBase);f.KendoSliderProvider=h});
define("infrastructure/ui/components/PagingControls/PagingControlsViewModel",["require","exports","geocortex/framework/ui/ViewModelBase"],function(h,f,k){h=function(f){function e(c,a){var b=f.call(this,c,"Mapping.Infrastructure")||this;b.libraryId="Mapping.Infrastructure";b.collectionViewModel=a;b.presentableResults=b.collectionViewModel.presentableResults;b.numberOfItems=b.presentableResults.items.length();return b}__extends(e,f);return e}(k.ViewModelBase);f.PagingControlsViewModel=h});
define("infrastructure/ui/components/PagingControls/PagingControlsView",["require","exports","geocortex/framework/ui/ViewBase"],function(h,f,k){h=function(f){function e(){var c=null!==f&&f.apply(this,arguments)||this;c.libraryId="Mapping.Infrastructure";return c}__extends(e,f);e.prototype.attach=function(c){this.viewModel=c};e.prototype.handlePageFirst=function(c,a,b){1<this.viewModel.collectionViewModel.presentableResults.currPageNumber.get()&&this.viewModel.collectionViewModel.presentableResults.currPageNumber.set(1)};
e.prototype.handlePagePrev=function(c,a,b){1<this.viewModel.collectionViewModel.presentableResults.currPageNumber.get()&&(c=this.viewModel.collectionViewModel.presentableResults.currPageNumber.get()-1,this.viewModel.collectionViewModel.presentableResults.currPageNumber.set(c))};e.prototype.handlePageNext=function(c,a,b){this.viewModel.collectionViewModel.presentableResults.lastPageNumber.get()>this.viewModel.collectionViewModel.presentableResults.currPageNumber.get()&&(c=this.viewModel.collectionViewModel.presentableResults.currPageNumber.get()+
1,this.viewModel.collectionViewModel.presentableResults.currPageNumber.set(c))};e.prototype.handlePageLast=function(c,a,b){this.viewModel.collectionViewModel.presentableResults.currPageNumber.get()<this.viewModel.collectionViewModel.presentableResults.lastPageNumber.get()&&(c=this.viewModel.collectionViewModel.presentableResults.lastPageNumber.get(),this.viewModel.collectionViewModel.presentableResults.currPageNumber.set(c))};return e}(k.ViewBase);f.PagingControlsView=h});
define("infrastructure/ui/components/Slider/SliderConfig",["require","exports"],function(h,f){});define("infrastructure/ui/components/Slider/SliderItem",["require","exports"],function(h,f){});
define("infrastructure/ui/components/Slider/SliderViewModelBase","require exports geocortex/framework/ui/ViewModelBase geocortex/framework/observables geocortex/essentials/TimeUnits infrastructure/TimeSliderUtils".split(" "),function(h,f,k,l,e,c){h=function(a){function b(b,c,e){b=a.call(this,b,c)||this;b.items=new l.ObservableCollection([]);b.sliderMinLabel=new l.Observable("");b.sliderMaxLabel=new l.Observable("");b.sliderMinHandleLabel=new l.Observable("");b.sliderMaxHandleLabel=new l.Observable("");
b.sliderMinHandleCurrentItem=new l.Observable(null);b.sliderMaxHandleCurrentItem=new l.Observable(null);b.range=!1;b.disableSnappingForNumericValues=!0;b.lockMinSliderHandleAtMinVal=!1;b.animate=!1;b.isNumeric=null;b.isDateMode=null;b.numericSliderStep=null;b.numericSliderMinVal=null;b.numericSliderMaxVal=null;b.labelGenerator=null;b.itemActivePredicate=null;b.sliderHandleStartLabels=[];b.numericSliderHandleStartValues=[];b.sliderTicks=new l.ObservableCollection;b.isEnabled=new l.Observable(!1);b.sliderMinHandleAriaLabel=
null;b.sliderMaxHandleAriaLabel=null;b.sliderSingleHandleAriaLabel=null;b._underlyingCollection=null;b._underlyingCollectionBindingToken=null;b._config=null;b._defaultNumericLabelGenerator=function(a,b){return a+""};b._defaultItemActivePredicate=function(a,b){return!0};b._numericSliderItemCache={};b._maxSliderTicks=50;b._defaultSliderDivisions=5;b._snappableDatePoints=[];b.itemActivePredicate=b._defaultItemActivePredicate;e&&b.initialize(e);return b}__extends(b,a);b.prototype.initialize=function(a){this._applyConfig(a)};
b.prototype.sliderHandleSlide=function(a,b){};b.prototype.setNextSliderItem=function(a){return this._setNextOrPreviousSliderItem(a,"next")};b.prototype.setPreviousSliderItem=function(a){return this._setNextOrPreviousSliderItem(a,"previous")};b.prototype.setSelectedSliderItem=function(a,b){if(0!==a&&1!==a||!b)throw Error("SliderViewModelBase: Could not set selected slider item.");var c=0===a?this.sliderMinHandleCurrentItem.get():this.sliderMaxHandleCurrentItem.get();c&&c.value===b.value||(0===a?(this.sliderMinHandleLabel.set(b.label),
this.sliderMinHandleCurrentItem.set(b)):(this.sliderMaxHandleLabel.set(b.label),this.sliderMaxHandleCurrentItem.set(b)),this.sliderHandleSlide(b,a))};b.prototype.attachToCollection=function(a,b,c,e){var f=this;this.cleanUp();this.isNumeric=!1;if(!(a&&a instanceof l.ObservableCollection))throw Error("SliderViewModelBase: Could not attach to collection.");b&&dojo.isFunction(b)&&(this.labelGenerator=b);e&&e.length&&(this.sliderHandleStartLabels=e.slice(0));this.itemActivePredicate=c&&dojo.isFunction(c)?
c:this._defaultItemActivePredicate;this._underlyingCollection=a;this.items.set(this._underlyingCollection.get().map(function(a,b){return f._createSliderItem(a,b)}));this._underlyingCollectionBindingToken=this._underlyingCollection.bind(this,this._handleUnderlyingCollectionChanges);this._initializeUIObservables()};b.prototype.setupNumericSlider=function(a,b,c,e,f,h){this.cleanUp();this.isNumeric=!0;a=parseFloat(a);b=parseFloat(b);c=parseFloat(c);if(isNaN(a)||isNaN(b))throw Error("SliderViewModelBase: Could not set numeric slider range. Minimum and/or maximum values invalid.");
h&&h.length&&(this.numericSliderHandleStartValues=h.slice(0));this.numericSliderMinVal=a;this.numericSliderMaxVal=b;this.labelGenerator=e&&dojo.isFunction(e)?e:this._defaultNumericLabelGenerator;this.itemActivePredicate=f&&dojo.isFunction(f)?f:this._defaultItemActivePredicate;this.numericSliderStep=c&&!isNaN(c)&&c<b-a?c:null;null===this.numericSliderStep&&(a=b-a)&&(this.numericSliderStep=1>=a?a/this._defaultSliderDivisions:Math.round(a/this._defaultSliderDivisions),this.isDateMode&&this._resetTimeIntervalBasedOnSliderStep());
this._initializeUIObservables()};b.prototype.setupDateSlider=function(a,b,e,f,h,k,l){this.isDateMode=!0;this.dateModeTimeInterval=e;this.dateModeTimeIntervalUnit=f;this.setupNumericSlider(a,b,c.computeTimeIntervalInMs(e,f),h,k,l);this.disableSnappingForNumericValues||this._generateDateModeSnappablePoints()};b.prototype.getSliderItemByRawSliderValue=function(a,b){void 0===b&&(b=!1);if(void 0===a||null===a)return null;var c=null,e=this.isNumeric?a-this.numericSliderMinVal:a;this.isNumeric?(b&&(a=a>
this.numericSliderMaxVal?this.numericSliderMaxVal:a,a=a<this.numericSliderMinVal?this.numericSliderMinVal:a),a>=this.numericSliderMinVal&&a<=this.numericSliderMaxVal&&(c=this._getUpdatedNumericItemAndUpdateCache(a,e))):-1<e&&e<this.items.length()&&(c=this.items.getAt(e),this._updateSliderItem(c,e));return c};b.prototype.getSliderItemByItemLabel=function(a){if(!a)return null;var b=null;if(this.isNumeric){if(this.labelGenerator)for(var c=this.numericSliderMinVal,e=0;c<=this.numericSliderMaxVal;c+=this.numericSliderStep,
e++)if(this.labelGenerator(c,e)===a){b=this._getUpdatedNumericItemAndUpdateCache(c,e);break}}else for(c=0,e=this.items.length();c<e;c++){var f=this.items.getAt(c);this._updateSliderItem(f,c);if(f.label===a){b=f;break}}return b};b.prototype.getSliderItemByItemValue=function(a){var b=this;if(void 0===a||null===a||this.isNumeric&&"number"!==typeof a)return null;var c=null;c=this.isNumeric?this._getUpdatedNumericItemAndUpdateCache(a,a-this.numericSliderMinVal):(c=this.items.get().filter(function(c,e){if(c.value!==
a)return!1;b._updateSliderItem(c,e);return!0})[0])||null;return c};b.prototype.getNextSliderItem=function(a){return this._getAdjacentSliderItem(a,"next")};b.prototype.getNextActiveSliderItem=function(a){return this._getAdjacentSliderItem(a,"next","active")};b.prototype.getNextInactiveSliderItem=function(a){return this._getAdjacentSliderItem(a,"next","inactive")};b.prototype.getPreviousSliderItem=function(a){return this._getAdjacentSliderItem(a,"prev")};b.prototype.getPreviousActiveSliderItem=function(a){return this._getAdjacentSliderItem(a,
"prev","active")};b.prototype.getPreviousInactiveSliderItem=function(a){return this._getAdjacentSliderItem(a,"prev","inactive")};b.prototype.getClosestDateItemSnappedToInterval=function(a,b,c){void 0===b&&(b="next");void 0===c&&(c=!1);a=this.getRawSliderValueForItem(a);a=this._getClosestDateItemRawValueSnappedToInterval(a,b,c);return null===a?null:this.getSliderItemByRawSliderValue(a,!0)};b.prototype.getRawSliderValueForItem=function(a){var b=null;a&&(this.isNumeric?(a=a.value,a>=this.numericSliderMinVal&&
a<=this.numericSliderMaxVal&&(b=a)):(a=this.items.get().map(function(a){return a.value}).indexOf(a.value),-1<a&&a<this.items.length()&&(b=a)));return b};b.prototype.cleanUp=function(){this.isEnabled.set(!1);this.labelGenerator=null;this.items.clear();this.isNumeric=null;this.sliderMaxHandleCurrentItem.set(null);this.sliderMinHandleCurrentItem.set(null);this.sliderMinHandleLabel.set("");this.sliderMaxHandleLabel.set("");this.sliderMaxLabel.set("");this.sliderMinLabel.set("");this.numericSliderMaxVal=
this.numericSliderMinVal=this.numericSliderStep=null;this._numericSliderItemCache={};this.numericSliderHandleStartValues.length=0;this.sliderHandleStartLabels.length=0;this._snappableDatePoints.length=0;this.itemActivePredicate=this._defaultItemActivePredicate;this.sliderTicks.clear();this._underlyingCollection&&(this._underlyingCollectionBindingToken&&(this._underlyingCollection.unbind(this._underlyingCollectionBindingToken),this._underlyingCollectionBindingToken=null),this._underlyingCollection=
null)};b.prototype._setNextOrPreviousSliderItem=function(a,b){if(0!==a&&1!==a)return this.app.trace.error("SliderViewModelBase: Could not set "+b+" slider item. Invalid handle index.Handle index must be 0 or 1."),!1;var c=0===a?this.sliderMinHandleCurrentItem.get():this.sliderMaxHandleCurrentItem.get(),e=0===a?this.sliderMaxHandleCurrentItem.get():this.sliderMinHandleCurrentItem.get();if(!c)return this.app.trace.error("SliderViewModelBase: Could not set "+b+" slider item. Please set current item first."),
!1;var f="next"===b?this.getNextActiveSliderItem(c):this.getPreviousActiveSliderItem(c);if(f&&(!e||e&&e.value!==f.value)&&f.value!==c.value){if(e&&0===a&&"next"===b&&f.value>=e.value||e&&1===a&&"next"!==b&&f.value<=e.value||this.range&&this.lockMinSliderHandleAtMinVal&&0===a)return!1;this.setSelectedSliderItem(a,f);return!0}return!1};b.prototype._initializeUIObservables=function(){this._setupSliderTicks();this._setupSliderMinMaxLabels();this.isEnabled.set(!0)};b.prototype._setupSliderTicks=function(){this.sliderTicks.clear();
for(var a=this.isNumeric?(this.numericSliderMaxVal-this.numericSliderMinVal)/this.numericSliderStep:this.items.length(),a=a>this._maxSliderTicks?this._maxSliderTicks:a,b=100/a,c=0,e=0;e<a;e++)100>=c&&(this.sliderTicks.addItem({position:c+"%"}),c+=b)};b.prototype._setupSliderMinMaxLabels=function(){var a=this.isNumeric?this.getSliderItemByItemValue(this.numericSliderMinVal):this.items.getAt(0),b=this.isNumeric?this.getSliderItemByItemValue(this.numericSliderMaxVal):this.items.getAt(this.items.length()-
1);this.sliderMinLabel.set(a?a.label:"");this.sliderMaxLabel.set(b?b.label:"")};b.prototype._getAdjacentSliderItem=function(a,b,c){void 0===b&&(b="next");void 0===c&&(c="any");a=this.getRawSliderValueForItem(a);if(null===a)return null;var e=null,f=null;do if(a=this.isNumeric?this._getAdjacentNumericItemRawValue(a,b):"prev"===b?a-1:a+1,f=this.getSliderItemByRawSliderValue(a,this.isNumeric))switch(c){case "active":e=f.active?f:null;break;case "inactive":e=f.active?null:f;break;default:e=f}while(f&&
!e);return e};b.prototype._getAdjacentNumericItemRawValue=function(a,b,c){var f=this;void 0===b&&(b="next");void 0===c&&(c=!1);var h=null,k=function(a){a&&!isNaN(a)&&c&&(a=a>f.numericSliderMaxVal?f.numericSliderMaxVal:a,a=a<f.numericSliderMinVal?f.numericSliderMinVal:a);return a};if(!this.isDateMode||!this.dateModeTimeInterval||!this.dateModeTimeIntervalUnit)return k("prev"===b?a-f.numericSliderStep:a+f.numericSliderStep);var l=function(a){return"next"===b?a:-1*a};switch(this.dateModeTimeIntervalUnit){case e.TimeUnits.UNIT_MILLISECONDS:return a+
l(this.dateModeTimeInterval);case e.TimeUnits.UNIT_SECONDS:return a+l(1E3*this.dateModeTimeInterval);case e.TimeUnits.UNIT_MINUTES:return a+l(6E4*this.dateModeTimeInterval);case e.TimeUnits.UNIT_HOURS:return a+l(36E5*this.dateModeTimeInterval);case e.TimeUnits.UNIT_DAYS:return a+l(864E5*this.dateModeTimeInterval);case e.TimeUnits.UNIT_WEEKS:return a+l(6048E5*this.dateModeTimeInterval);case e.TimeUnits.UNIT_MONTHS:h=new Date(a);h.setUTCMonth(h.getUTCMonth()+l(this.dateModeTimeInterval));break;case e.TimeUnits.UNIT_YEARS:h=
new Date(a);h.setUTCFullYear(h.getUTCFullYear()+l(this.dateModeTimeInterval));break;case e.TimeUnits.UNIT_DECADES:h=new Date(a);h.setUTCFullYear(h.getUTCFullYear()+l(10*this.dateModeTimeInterval));break;case e.TimeUnits.UNIT_CENTURIES:h=new Date(a),h.setUTCFullYear(h.getUTCFullYear()+l(100*this.dateModeTimeInterval))}a=h&&!isNaN(h.getTime())?h.getTime():"prev"===b?a-f.numericSliderStep:a+f.numericSliderStep;return k(a)};b.prototype._resetTimeIntervalBasedOnSliderStep=function(){if(this.dateModeTimeInterval&&
this.dateModeTimeIntervalUnit&&this.numericSliderStep&&!(isNaN(this.numericSliderStep)||0>=this.numericSliderStep)){var a=new Date(this.numericSliderStep);if(!isNaN(a.getTime()))for(var a=[a.getUTCFullYear()-1970,a.getUTCMonth(),a.getUTCDate()-1,a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds()],b=[e.TimeUnits.UNIT_YEARS,e.TimeUnits.UNIT_MONTHS,e.TimeUnits.UNIT_DAYS,e.TimeUnits.UNIT_HOURS,e.TimeUnits.UNIT_MINUTES,e.TimeUnits.UNIT_SECONDS,e.TimeUnits.UNIT_MILLISECONDS],f=0;f<
a.length;f++)if(0<a[f]){this.dateModeTimeIntervalUnit=b[f];this.dateModeTimeInterval=a[f];this.numericSliderStep=c.computeTimeIntervalInMs(this.dateModeTimeInterval,this.dateModeTimeIntervalUnit);break}}};b.prototype._getClosestDateItemRawValueSnappedToInterval=function(a,b,c){void 0===b&&(b="next");void 0===c&&(c=!1);if(!this._snappableDatePoints.length)return c?this._getAdjacentNumericItemRawValue(a,b):a;for(var e=0,f=this._snappableDatePoints.length-1,h,k,l;e<=f;){h=Math.floor((e+f)/2);k=this._snappableDatePoints[h];
if(k===a)return c?this._getAdjacentNumericItemRawValue(a,b):a;if("next"===b?a>k&&a<this._snappableDatePoints[h+1]:a<k&&a>this._snappableDatePoints[h-1]){l=k;break}k<a?e=h+1:k>a&&(f=h-1)}return l?this._getAdjacentNumericItemRawValue(l,b):null};b.prototype._generateDateModeSnappablePoints=function(){if(this.isDateMode&&this.dateModeTimeInterval&&this.dateModeTimeIntervalUnit&&this.numericSliderMinVal&&this.numericSliderMaxVal){this._snappableDatePoints.length=0;var a=this.numericSliderMinVal;if(this.dateModeTimeIntervalUnit===
e.TimeUnits.UNIT_WEEKS||this.dateModeTimeIntervalUnit===e.TimeUnits.UNIT_MONTHS||this.dateModeTimeIntervalUnit===e.TimeUnits.UNIT_YEARS||this.dateModeTimeIntervalUnit===e.TimeUnits.UNIT_DECADES||this.dateModeTimeIntervalUnit===e.TimeUnits.UNIT_CENTURIES){this._snappableDatePoints.push(a);do a=this._getAdjacentNumericItemRawValue(a,"next"),this._snappableDatePoints.push(a);while(a<this.numericSliderMaxVal);this._snappableDatePoints.push(this.numericSliderMaxVal)}}};b.prototype._applyConfig=function(a){this._config=
a||{};this.range=void 0===this._config.range?!1:!!this._config.range;this.animate=void 0===this._config.animate?!1:!!this._config.animate;this.disableSnappingForNumericValues=void 0===this._config.disableSnappingForNumericValues?!0:!!this._config.disableSnappingForNumericValues;this.lockMinSliderHandleAtMinVal=void 0===this._config.lockMinSliderHandleAtMinVal?!1:!!this._config.lockMinSliderHandleAtMinVal;this.sliderMinHandleAriaLabel=a.sliderMinHandleAriaLabel||null;this.sliderMaxHandleAriaLabel=
a.sliderMaxHandleAriaLabel||null;this.sliderSingleHandleAriaLabel=a.sliderSingleHandleAriaLabel||null};b.prototype._handleUnderlyingCollectionChanges=function(a){var b=this,c;switch(a.type){case "clear":this.items.clear();break;case "insert":c=a.sender.getRange(a.rangeStart,a.rangeEnd);this.items.insertItems(a.rangeStart,c.map(function(c,e){return b._createSliderItem(c,a.rangeStart+e)}));break;case "append":c=a.sender.getRange(a.rangeStart,a.rangeEnd);this.items.addItems(c.map(function(c,e){return b._createSliderItem(c,
a.rangeStart+e)}));break;case "remove":this.items.removeRange(a.rangeStart,a.rangeEnd)}this._initializeUIObservables()};b.prototype._createSliderItem=function(a,b){return{value:a,label:this._getItemLabel(a,b),active:this.itemActivePredicate(a,b)}};b.prototype._getItemLabel=function(a,b){var c="";this.labelGenerator&&(c=this.labelGenerator(a,b),c=null===c||void 0===c?"":c+"");return c};b.prototype._updateSliderItem=function(a,b){a.label=this._getItemLabel(a.value,b);a.active=this.itemActivePredicate(a.value,
b);return a};b.prototype._getUpdatedNumericItemAndUpdateCache=function(a,b){if(null===a||void 0===a||null===b||void 0===b)return null;var c=this._numericSliderItemCache[a+""];c?this._updateSliderItem(c,b):c=this._createSliderItem(a,b);return this._numericSliderItemCache[a+""]=c};return b}(k.ViewModelBase);f.SliderViewModelBase=h});
define("infrastructure/ui/components/Slider/SliderViewBase",["require","exports","geocortex/framework/ui/ViewBase"],function(h,f,k){h=function(f){function e(){var c=null!==f&&f.apply(this,arguments)||this;c.sliderElement=null;c.sliderMinLabelElement=null;c.sliderMaxLabelElement=null;c._sliderCurrentRawValues=[];c._sliderCurrentHandlePos=[];c._widgetHostElement=null;c._minHandleBindingToken=null;c._maxHandleBindingToken=null;c._isEnabledBindingToken=null;c._isAdded=!1;c._minHnadleLocked=!1;c._maxHandleLocked=
!1;c._minHandleTag="gcx_timeslider_handle0";c._maxHandleTag="gcx_timeslider_handle1";c._currPosForComputedDirection=[];return c}__extends(e,f);e.prototype.attach=function(c){c&&(f.prototype.attach.call(this,c),this._isAdded&&this._initializeIfEnabled(this.viewModel.isEnabled.get()))};e.prototype.added=function(c){f.prototype.added.call(this,c);this._isAdded=!0;this._widgetHostElement=c;this._cleanUp(!0);this._isEnabledBindingToken=this.viewModel.isEnabled.bind(this,this._initializeIfEnabled);this._initializeIfEnabled(this.viewModel.isEnabled.get())};
e.prototype.onDestroy=function(){f.prototype.onDestroy.call(this);this._cleanUp(!0)};e.prototype.refreshLabelPositions=function(){this._updateLabelPosition(0);this._updateLabelPosition(1)};e.prototype._setupViewModelBindings=function(){var c=this;this._minHandleBindingToken=this.viewModel.sliderMinHandleCurrentItem.bind(this,function(a){return c._setSliderValueAndUpdateLabels(0,c.viewModel.getRawSliderValueForItem(a))});this.viewModel.range&&(this._maxHandleBindingToken=this.viewModel.sliderMaxHandleCurrentItem.bind(this,
function(a){return c._setSliderValueAndUpdateLabels(1,c.viewModel.getRawSliderValueForItem(a))}))};e.prototype._generateJQuerySlider=function(){var c=this,a=this.viewModel,b={animate:a.animate,min:a.isNumeric?a.numericSliderMinVal:0,max:a.isNumeric?a.numericSliderMaxVal:a.items.length()-1,step:a.isNumeric?a.isDateMode||a.disableSnappingForNumericValues?1:a.numericSliderStep:1,orientation:"horizontal",range:a.range,slide:function(a,b){return c._handleSliderRawValueSlide(a,b)},change:function(a,b){return c._handleSliderRawValueChange(a,
b)}};this.viewModel.isDateMode&&(b.slide=function(a,b){return c._dateModeRawValueSlide(a,b)});var d=function(){b.range?b.values=[b.min,b.min+b.step]:b.value=b.min},e=function(){if(b.values[0]===b.values[1]){var a=b.values[0]+b.step,c=b.values[0]-b.step;a<=b.max?b.values[1]=a:b.values[0]=c}};if(a.isNumeric&&a.numericSliderHandleStartValues.length)!b.range||isNaN(a.numericSliderHandleStartValues[0])||isNaN(a.numericSliderHandleStartValues[1])?b.range||isNaN(a.numericSliderHandleStartValues[0])?d():
b.value=a.numericSliderHandleStartValues[0]:(b.values=a.numericSliderHandleStartValues.slice(0,2),a.lockMinSliderHandleAtMinVal&&(b.values[0]=b.min),e());else if(!a.isNumeric&&a.sliderHandleStartLabels.length){var f=a.getSliderItemByItemLabel(a.sliderHandleStartLabels[0]),h=a.getSliderItemByItemLabel(a.sliderHandleStartLabels[1]);b.range&&f&&h?(b.values=[a.items.indexOf(f)-1,a.items.indexOf(h)-1],a.lockMinSliderHandleAtMinVal&&(b.values[0]=b.min),e()):!b.range&&f?b.value=a.items.indexOf(f)-1:d()}else d();
b.range?this._sliderCurrentRawValues=b.values.slice(0):this._sliderCurrentRawValues[0]=b.value;$(this.sliderElement).slider(b);this._wireInKeyboardSupport();var k=this._widgetHostElement?this._widgetHostElement:this;if(k.isActive)this._applyInitViewModelState(b);else var l=this.app.event("ViewActivatedEvent").subscribe(this,function(a){a===k&&(c.app.event("ViewActivatedEvent").unsubscribe(l),l=null,c._applyInitViewModelState(b))})};e.prototype._applyInitViewModelState=function(c){c.range?(this.viewModel.setSelectedSliderItem(0,
this.viewModel.getSliderItemByRawSliderValue(c.values[0])),this.viewModel.setSelectedSliderItem(1,this.viewModel.getSliderItemByRawSliderValue(c.values[1]))):this.viewModel.setSelectedSliderItem(0,this.viewModel.getSliderItemByRawSliderValue(c.value))};e.prototype._handleSliderRawValueChange=function(c,a){var b=this._getSliderHandleIndex(a);this._sliderCurrentRawValues[b]=a.value;this._maxHandleLocked=this._minHnadleLocked=!1;return!0};e.prototype._dateModeRawValueSlide=function(c,a){if(!c||37===
c.which||39===c.which||!c.originalEvent||!$(c.originalEvent.target).hasClass("ui-slider-handle"))return this._handleSliderRawValueSlide(c,a);var b=this._getSliderHandleIndex(a);if(void 0!==this._currPosForComputedDirection[b]&&this._currPosForComputedDirection[b]!==a.value){var d=a.value>this._currPosForComputedDirection[b];if(d&&void 0!==this._sliderCurrentRawValues[b]&&a.value>this._sliderCurrentRawValues[b]||!d&&void 0!==this._sliderCurrentRawValues[b]&&a.value<this._sliderCurrentRawValues[b])return this._currPosForComputedDirection.length=
0,this._handleSliderRawValueSlide(c,a,d)}this._currPosForComputedDirection[b]=a.value;return!1};e.prototype._handleSliderRawValueSlide=function(c,a,b){if(!a||!a.handle||void 0===a.value)return!1;var d=this._getSliderHandleIndex(a);this._currPosForComputedDirection.length=0;this.viewModel.range&&this.viewModel.lockMinSliderHandleAtMinVal&&0===d&&(d=1);if(!this.viewModel.range&&1===d||0===d&&this._minHnadleLocked||1===d&&this._maxHandleLocked)return!1;0===d?this._maxHandleLocked=!0:this._minHnadleLocked=
!0;var e=this.viewModel.getSliderItemByRawSliderValue(a.value),f=this._sliderCurrentRawValues[d];a=void 0===b?void 0===f||a.value>f:b;this.viewModel.isDateMode&&!this.viewModel.disableSnappingForNumericValues&&(e=a?this.viewModel.getClosestDateItemSnappedToInterval(e,"next",37===c.which||39===c.which):this.viewModel.getClosestDateItemSnappedToInterval(e,"prev",37===c.which||39===c.which),this.viewModel.getRawSliderValueForItem(e));e&&!e.active&&(e=a?this.viewModel.getNextActiveSliderItem(e):this.viewModel.getPreviousActiveSliderItem(e),
this.viewModel.getRawSliderValueForItem(e));if(e&&this.viewModel.range&&(c=0===d?this.viewModel.sliderMaxHandleCurrentItem.get():this.viewModel.sliderMinHandleCurrentItem.get(),a=0===d?e.value>c.value:e.value<c.value,c&&(a||e.value===c.value||this.viewModel.isDateMode&&e.label===c.label))){if(this.viewModel.isDateMode){if(this.viewModel.disableSnappingForNumericValues)return!1;e=0===d?this.viewModel.getClosestDateItemSnappedToInterval(e,"prev",!0):this.viewModel.getClosestDateItemSnappedToInterval(e,
"next",!0)}else e=0===d?this.viewModel.getPreviousActiveSliderItem(e):this.viewModel.getNextActiveSliderItem(e);this.viewModel.getRawSliderValueForItem(e)}if(!e)return!1;(c=0===d?this.viewModel.sliderMinHandleCurrentItem.get():this.viewModel.sliderMaxHandleCurrentItem.get())&&e.value===c.value&&(this._maxHandleLocked=this._minHnadleLocked=!1);this.viewModel.setSelectedSliderItem(d,e);return!1};e.prototype._getSliderHandleIndex=function(c){if($(c.handle).hasClass(this._minHandleTag))return 0;if($(c.handle).hasClass(this._maxHandleTag))return 1;
var a=0;this.viewModel.range&&(a=null===c.handle.nextElementSibling||void 0===c.handle.nextElementSibling?1:0);$(c.handle).addClass(0===a?this._minHandleTag:this._maxHandleTag);return a};e.prototype._setSliderValueAndUpdateLabels=function(c,a){null!==a&&(0!==c&&1!==c||isNaN(parseInt(a,10))?this.app.trace.error("SliderViewBase: Could not set slider values and update UI. Required arguments invalid."):(this._setSliderRawValue(c,a),this._updateLabelPosition(c)))};e.prototype._setSliderRawValue=function(c,
a){this.viewModel.range?$(this.sliderElement).slider("values")[c]!==a&&$(this.sliderElement).slider("values",c,a):$(this.sliderElement).slider("value")!==a&&$(this.sliderElement).slider("value",a)};e.prototype._updateSliderHandleAttributes=function(c){var a=0===c?this.viewModel.sliderMinHandleCurrentItem.get():this.viewModel.sliderMaxHandleCurrentItem.get(),b=$(".ui-slider-handle",this.sliderElement).toArray()[c];b&&a&&a.label&&(c=0===c?this.viewModel.range?this.viewModel.sliderMinHandleAriaLabel||
"":this.viewModel.sliderSingleHandleAriaLabel||"":this.viewModel.sliderMaxHandleAriaLabel||"",void 0==$(b).attr("tabindex")&&$(b).attr("tabindex",0),void 0==$(b).attr("role")&&$(b).attr("role","slider"),$(b).attr("aria-label",c||a.label),$(b).attr("aria-valuenow",a.label),$(b).attr("aria-valuetext",a.label),$(b).attr("title",a.label))};e.prototype._updateLabelPosition=function(c){var a=this;this._updateLabelPositionImpl(c);setTimeout(function(){return a._updateLabelPositionImpl(c)},this.viewModel.animate?
400:100)};e.prototype._updateLabelPositionImpl=function(c){if(null!==c&&void 0!==c&&(0===c||1===c)&&(this.viewModel.range||1!==c)){var a=$(".ui-slider-handle",this.sliderElement).toArray();if(0!==a.length){var b=0===c?$(this.sliderMinLabelElement).width()+5:$(this.sliderMaxLabelElement).width(),d=$(this.sliderElement).width(),e=$(a[c]).width(),a=$(a[c]).position().left+$(this.sliderElement).position().left+0.5*e-0.5*b,a=Math.max($(this.sliderElement).position().left-0.5*e,a),a=Math.min(d+$(this.sliderElement).position().left+
0.5*e-b,a),f=this._sliderCurrentHandlePos[(c+1)%2],h=(0===c?$(this.sliderMaxLabelElement).width()+5:$(this.sliderMinLabelElement).width())+5,h=h<0.5*b?b:h,f=isNaN(f)&&this.viewModel.range?d+$(this.sliderElement).position().left+0.5*e-h:f;isNaN(f)||(0===c?(a=f>=b?Math.min(f-b,a):a,a=Math.min(d+$(this.sliderElement).position().left+0.5*e-(h+b-5),a)):1===c&&(a=Math.max(f+h+0.5*e,a)));this._sliderCurrentHandlePos[c]=a;0===c?this.sliderMinLabelElement.style.left=a+"px":this.sliderMaxLabelElement.style.left=
a+"px";this._updateSliderHandleAttributes(c)}}};e.prototype._processInitRoutine=function(){this._cleanUp();this._setupViewModelBindings();this._generateJQuerySlider()};e.prototype._initializeIfEnabled=function(c){c&&this._processInitRoutine()};e.prototype._cleanUp=function(c){void 0===c&&(c=!1);this.sliderElement&&$(this.sliderElement).hasClass("ui-slider")&&$(this.sliderElement).slider("destroy");this.viewModel&&(this._isEnabledBindingToken&&c&&(this.viewModel.isEnabled.unbind(this._isEnabledBindingToken),
this._isEnabledBindingToken=null),this._minHandleBindingToken&&this.viewModel.sliderMinHandleCurrentItem.unbind(this._minHandleBindingToken),this._maxHandleBindingToken&&this.viewModel.sliderMaxHandleCurrentItem.unbind(this._maxHandleBindingToken));this._sliderCurrentHandlePos=[];this._sliderCurrentRawValues=[];this._currPosForComputedDirection=[];this._maxHandleBindingToken=this._minHandleBindingToken=null};e.prototype._wireInKeyboardSupport=function(){var c=this,a=$(".ui-slider-handle",this.sliderElement).toArray();
if(0!==a.length){var b=function(b,e,f){c._handleSliderRawValueSlide({which:f},{handle:a[e],value:"prev"===b?c._sliderCurrentRawValues[e]-1:c._sliderCurrentRawValues[e]+1})};a.forEach(function(a,e){$(a).unbind("keydown");$(a).keydown(function(a){var d=!1;switch(a.which){case 38:case 39:case 33:b("next",e,39);break;case 37:case 40:case 34:b("prev",e,37);break;default:d=!0}c.refreshLabelPositions();d||(a.preventDefault(),a.stopPropagation())})})}};return e}(k.ViewBase);f.SliderViewBase=h});
define("infrastructure/ui/components/WizardPanel/ValidationHandler",["require","exports"],function(h,f){});define("infrastructure/ui/components/WizardPanel/WizardFragmentViewModel",["require","exports"],function(h,f){});
define("infrastructure/ui/components/WizardPanel/WizardPanelViewModel",["require","exports","infrastructure/ui/components/SmartPanel/SmartPanelViewModel"],function(h,f,k){h=function(f){function e(c,a){return f.call(this,c,a)||this}__extends(e,f);e.prototype.showOrHideCloseButtons=function(){var c=this.viewDescriptors.getAt(0);c&&(this.showingBackButton.set(this.currentView!==c.view),this.showingXButton.set(!0))};e.prototype.closeAllViews=function(c){for(c=0;c<this.viewDescriptors.length();c++){var a=
this.viewDescriptors.getAt(c).view,b=a.viewModel;this._isWizardFragment(b)&&b.reset();this.app.viewManager.deactivateView(a)}};e.prototype._isWizardFragment=function(c){return void 0!==c.reset};return e}(k.SmartPanelViewModel);f.WizardPanelViewModel=h});
define("infrastructure/ui/components/WizardPanel/WizardPanelView",["require","exports","infrastructure/ui/components/SmartPanel/SmartPanelView"],function(h,f,k){h=function(f){function e(){return null!==f&&f.apply(this,arguments)||this}__extends(e,f);e.prototype.finish=function(){this.viewModel.closeAllViews()};e.prototype.cancel=function(){this.viewModel.closeAllViews(!0)};e.prototype.handleClickBack=function(c,a,b){f.prototype.handleClickBack.call(this,c,a,b)};e.prototype.handleClickClose=function(c,
a,b){f.prototype.handleClickClose.call(this,c,a,b);this.cancel()};return e}(k.SmartPanelView);f.WizardPanelView=h});
define("infrastructure/ui/components/WizardPanel/WizardFragmentView",["require","exports","geocortex/framework/ui/ViewBase","geocortex/framework-ui/ViewContainer/ViewContainerView"],function(h,f,k,l){h=function(e){function c(a,b){return e.call(this,a,b)||this}__extends(c,e);c.prototype.attach=function(a){var b=this;e.prototype.attach.call(this,a);this._viewContainerActivatedEventToken||(this._viewContainerActivatedEventToken=this.app.event("ViewContainerActivatedEvent").subscribe(this,function(a){null==
b.parentContainer&&b._isViewHostedInContainer(a)&&(b.parentContainer=a)}))};c.prototype._isViewHostedInContainer=function(a){if(a instanceof l.ViewContainerView){a=a.viewModel.regionName.get();var b=this.app.viewManager.getRegionForViewId(this.id);if(b&&b.name===a)return!0}return!1};c.prototype.finishWizard=function(){this.parentContainer&&this.parentContainer.finish()};c.prototype.cancelWizard=function(){this.parentContainer&&this.parentContainer.cancel()};c.prototype.destroy=function(){e.prototype.destroy.call(this);
this._viewContainerActivatedEventToken&&(this.app.event("ViewContainerActivatedEvent").unsubscribe(this._viewContainerActivatedEventToken),this._viewContainerActivatedEventToken=null);this.parentContainer&&(this.parentContainer=null)};c.prototype._validator=function(){return[]};c.prototype.validate=function(a){this.validationProblems=this._validator();return 1>this.validationProblems.length};c.prototype.reset=function(){this.viewModel.reset()};c.prototype.loadState=function(){};c.prototype.saveState=
function(){for(var a=0;a<arguments.length;a++);};c.prototype.goNext=function(){for(var a=0;a<arguments.length;a++);throw Error("This method is abstract");};c.prototype.goBack=function(){for(var a=0;a<arguments.length;a++);throw Error("This method is abstract");};return c}(k.ViewBase);f.WizardFragmentView=h});var Feature=null,FeatureSet=null,FeatureSetCollection=null;
dojo.ready(function(){FeatureAttribute=dojo.getObject("geocortex.essentialsHtmlViewer.mapping.infrastructure.FeatureAttribute");Feature=dojo.getObject("geocortex.essentialsHtmlViewer.mapping.infrastructure.Feature");FeatureSet=dojo.getObject("geocortex.essentialsHtmlViewer.mapping.infrastructure.FeatureSet");FeatureSetCollection=dojo.getObject("geocortex.essentialsHtmlViewer.mapping.infrastructure.FeatureSetCollection")});geocortex||(geocortex={});
geocortex.essentialsHtmlViewer||(geocortex.essentialsHtmlViewer={});geocortex.essentialsHtmlViewer.version="2.8.0.0974";geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/documents/GrantEditorView.html","html","PGRpdiBjbGFzcz0iZ3JhbnQtZWRpdG9yIj4gPGRpdiBjbGFzcz0iZ3JhbnQtZWRpdG9yLW9wdGlvbnMiPiA8ZGl2IGNsYXNzPSJncmFudC1lZGl0b3Itc2VhcmNoLW9wdGlvbnMiPiA8c2VsZWN0IGRhdGEtYmluZGluZz0ie0BlbmFibGVkOiBlbmFibGVkfXtAc291cmNlOiBtb25pa2VyS2luZHN9e0B2YWx1ZTogc2VsZWN0ZWRNb25pa2VyS2luZH0iPiA8b3B0aW9uIGRhdGEtYmluZGluZz0ie0B0ZW1wbGF0ZS1mb3I6IG1vbmlrZXJLaW5kc317QHRleHQ6IGRpc3BsYXlOYW1lfXt2YWx1ZToga2luZH0iIC8+IDwvc2VsZWN0PiA8aW5wdXQgY2xhc3M9ImdyYW50LWVkaXRvci1zZWFyY2giIHR5cGU9InRleHQiIGRhdGEtYmluZGluZz0ie0BlbmFibGVkOiBlbmFibGVkfXtAdmFsdWU6IHNlYXJjaFRleHR9e0B2YXI6IGF1dG9Db21wbGV0ZUlucHV0fXtAZXZlbnQtb25pbnB1dDogaGFuZGxlSW5wdXRDaGFuZ2VkfXtwbGFjZWhvbGRlcjogQGxhbmd1YWdlLWdyYW50LWVkaXRvci1zZWFyY2gtcGxhY2Vob2xkZXJ9e3RpdGxlOiBAbGFuZ3VhZ2UtZ3JhbnQtZWRpdG9yLXNlYXJjaC10aXRsZX17QGV2ZW50LWJsdXI6IGhhbmRsZUF1dG9Db21wbGV0ZUJsdXJ9IiAvPiA8L2Rpdj4gPGRpdiBjbGFzcz0iZm9ybS1idG5zIj4gPGJ1dHRvbiBjbGFzcz0iYnV0dG9uIGFkZC1idXR0b24iIGRhdGEtYmluZGluZz0ie0BlbmFibGVkOiBpc1ZhbGlkTW9uaWtlcn17dGl0bGU6IEBsYW5ndWFnZS1ncmFudC1lZGl0b3ItYWRkLWJ1dHRvbi10aXRsZX17QHRleHQ6IEBsYW5ndWFnZS1ncmFudC1lZGl0b3ItYWRkLWJ1dHRvbi10ZXh0fXtAZXZlbnQtb25jbGljazogaGFuZGxlQWRkTW9uaWtlckJ1dHRvbkNsaWNrfSI+PC9idXR0b24+IDwvZGl2PiA8L2Rpdj4gPGRpdiBjbGFzcz0iZ3JhbnQtZWRpdG9yLXRhYmxlIiBkYXRhLWJpbmRpbmc9IntAY2xhc3Mtc2hvdy1vd25lcjogZWRpdE93bmVyc2hpcH0iPiA8dGFibGU+IDx0aGVhZD4gPHRyPiA8dGggY2xhc3M9ImdyYW50LW5hbWUtY29sdW1uIj48L3RoPiA8dGggZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IEBsYW5ndWFnZS1ncmFudC1lZGl0b3ItdGFibGUtaGVhZGVyLW5vbmV9Ij48L3RoPiA8dGggZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IEBsYW5ndWFnZS1ncmFudC1lZGl0b3ItdGFibGUtaGVhZGVyLXZpZXd9Ij48L3RoPiA8dGggZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IEBsYW5ndWFnZS1ncmFudC1lZGl0b3ItdGFibGUtaGVhZGVyLWVkaXR9Ij48L3RoPiA8dGggY2xhc3M9Im93bmVyLWNvbHVtbiIgZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IEBsYW5ndWFnZS1ncmFudC1lZGl0b3ItdGFibGUtaGVhZGVyLW93bmVyfSI+PC90aD4gPC90cj4gPC90aGVhZD4gPHRib2R5IGRhdGEtYmluZGluZz0ie0Bzb3VyY2U6IG1vbmlrZXJzfSI+IDx0ciBkYXRhLWJpbmRpbmc9IntAdGVtcGxhdGUtZm9yOiBtb25pa2Vyc317QGNsYXNzLWdsb2JhbC1ncmFudDogaXNHbG9iYWx9e0BjbGFzcy1kaXNhYmxlZC1ncmFudDogaXNSZXZva2VkfSI+IDx0ZCBjbGFzcz0iZ3JhbnQtbmFtZS1jb2x1bW4iPiA8aW1nIGRhdGEtYmluZGluZz0ie3NyYzogaWNvblVyaX0iIC8+IDxzcGFuIGNsYXNzPSJncmFudC1uYW1lLWxhYmVsIiBkYXRhLWJpbmRpbmc9IntAdGV4dDogbmFtZX17dGl0bGU6IG5hbWV9Ij48L3NwYW4+IDwvdGQ+IDx0ZD4gPGlucHV0IHR5cGU9InJhZGlvIiBkYXRhLWJpbmRpbmc9IntAZW5hYmxlZDogZW5hYmxlZH17bmFtZTogaWR9e2NoZWNrZWQ6IGlzR2xvYmFsfXtAZXZlbnQtb25jbGljazogaGFuZGxlVXBkYXRlTW9uaWtlcn0iIC8+IDwvdGQ+IDx0ZD4gPGlucHV0IHR5cGU9InJhZGlvIiB2YWx1ZT0icmVhZGVyIiBkYXRhLWJpbmRpbmc9IntAZW5hYmxlZDogZW5hYmxlZH17bmFtZTogaWR9e2NoZWNrZWQ6IGNhblJlYWR9e0BldmVudC1vbmNsaWNrOiBoYW5kbGVVcGRhdGVNb25pa2VyfSIgLz4gPC90ZD4gPHRkPiA8aW5wdXQgdHlwZT0icmFkaW8iIHZhbHVlPSJ3cml0ZXIiIGRhdGEtYmluZGluZz0ie0BlbmFibGVkOiBlbmFibGVkfXtAaGlkZGVuOiBpc1B1YmxpY317bmFtZTogaWR9e2NoZWNrZWQ6IGNhbldyaXRlfXtAZXZlbnQtb25jbGljazogaGFuZGxlVXBkYXRlTW9uaWtlcn0iIC8+IDwvdGQ+IDx0ZCBjbGFzcz0ib3duZXItY29sdW1uIj4gPGlucHV0IHR5cGU9InJhZGlvIiB2YWx1ZT0ib3duZXIiIGRhdGEtYmluZGluZz0ie0BlbmFibGVkOiBlbmFibGVkfXtAaGlkZGVuOiBpc1B1YmxpY317bmFtZTogaWR9e2NoZWNrZWQ6IGNhbkVkaXR9e0BldmVudC1vbmNsaWNrOiBoYW5kbGVVcGRhdGVNb25pa2VyfSIgLz4gPC90ZD4gPC90cj4gPC90Ym9keT4gPC90YWJsZT4gPC9kaXY+IDwvZGl2PiA=");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/menus/IconMenuView.html","html","PGRpdiBjbGFzcz0ibWVudS1uby1pdGVtcyIgZGF0YS1iaW5kaW5nPSJ7QGhpZGRlbjogdmlzaWJsZU1lbnVJdGVtc317QHRleHQ6IEBsYW5ndWFnZS1tZW51LW5vLWl0ZW1zfSI+PC9kaXY+IDxkaXYgY2xhc3M9Imxpc3QtbWVudSBhY3RpdmUgaGFzLWljb24gaWNvbi1tZW51IiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogdmlzaWJsZU1lbnVJdGVtc317QHNvdXJjZTogdmlzaWJsZU1lbnVJdGVtc30iPiA8ZGl2IGNsYXNzPSJsaXN0LW1lbnUtaXRlbSIgZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLWZvcjogdmlzaWJsZU1lbnVJdGVtc317QGVuYWJsZWQ6IGNhbkV4ZWN1dGV9e0BldmVudC1vbmNsaWNrOiBoYW5kbGVNZW51SXRlbUNsaWNrfSI+IDxidXR0b24gY2xhc3M9Imxpc3QtbWVudS1kZXRhaWxzIiBkYXRhLWJpbmRpbmc9IntAZXZlbnQtb25jbGljazogaGFuZGxlTWVudUl0ZW1DbGlja317dGl0bGU6IGRlc2NyaXB0aW9ufSI+IDxpbWcgY2xhc3M9Imxpc3QtbWVudS1pY29uIiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogaWNvblVyaX17c3JjOiBpY29uVXJpfSIgYWx0PSIgIiAvPiA8c3Ryb25nIGNsYXNzPSJsaXN0LW1lbnUtbmFtZSIgZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IHRleHR9Ij48L3N0cm9uZz4gPC9idXR0b24+IDwvZGl2PiA8L2Rpdj4g");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/menus/MenuHyperlinkView.html","html","PGRpdiBjbGFzcz0ibWVudS1oeXBlcmxpbmtzIj4gPHVsIGNsYXNzPSJsaXN0LW1lbnUgYWN0aXZlIiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogdmlzaWJsZU1lbnVJdGVtc317QHNvdXJjZTogdmlzaWJsZU1lbnVJdGVtc30iPiA8bGkgY2xhc3M9Imxpc3QtbWVudS1pdGVtIiBkYXRhLWJpbmRpbmc9IntAdGVtcGxhdGUtZm9yOiB2aXNpYmxlTWVudUl0ZW1zfSI+IDxidXR0b24gY2xhc3M9Imxpc3QtbWVudS1idXR0b24iIGRhdGEtYmluZGluZz0ie3RpdGxlOiBkZXNjcmlwdGlvbn17QHRleHQ6IHRleHR9e0BldmVudC1vbmNsaWNrOiBoYW5kbGVNZW51SXRlbUNsaWNrfXtAZW5hYmxlZDogY2FuRXhlY3V0ZX0iPjwvYnV0dG9uPiA8L2xpPiA8L3VsPiA8L2Rpdj4g");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/menus/MenuView.html","html","PGRpdiBjbGFzcz0ibWVudS1uby1pdGVtcyIgZGF0YS1iaW5kaW5nPSJ7QGhpZGRlbjogdmlzaWJsZU1lbnVJdGVtc317QHRleHQ6IEBsYW5ndWFnZS1tZW51LW5vLWl0ZW1zfSI+PC9kaXY+IDxkaXYgY2xhc3M9Imxpc3QtbWVudSBhY3RpdmUgaGFzLWljb24iIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiB2aXNpYmxlTWVudUl0ZW1zfXtAc291cmNlOiB2aXNpYmxlTWVudUl0ZW1zfSI+IDxkaXYgY2xhc3M9Imxpc3QtbWVudS1pdGVtIiBkYXRhLWJpbmRpbmc9IntAdGVtcGxhdGUtZm9yOiB2aXNpYmxlTWVudUl0ZW1zfXtAZW5hYmxlZDogY2FuRXhlY3V0ZX17QGV2ZW50LW9uY2xpY2s6IGhhbmRsZU1lbnVJdGVtQ2xpY2t9Ij4gPGltZyBjbGFzcz0ibGlzdC1tZW51LWljb24iIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBpY29uVXJpfXtzcmM6IGljb25Vcml9e2FsdDogdGV4dH0iIC8+IDxidXR0b24gY2xhc3M9Imxpc3QtbWVudS1kZXRhaWxzIiBkYXRhLWJpbmRpbmc9IntAZXZlbnQtb25jbGljazogaGFuZGxlTWVudUl0ZW1DbGlja317dGl0bGU6IGRlc2NyaXB0aW9ufSI+IDxzdHJvbmcgY2xhc3M9Imxpc3QtbWVudS1uYW1lIiBkYXRhLWJpbmRpbmc9IntAdGV4dDogdGV4dH0iPjwvc3Ryb25nPiA8c3BhbiBjbGFzcz0ibGlzdC1tZW51LWRlc2MiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBkZXNjcmlwdGlvbn17QHRleHQ6IGRlc2NyaXB0aW9ufSI+PC9zcGFuPiA8L2J1dHRvbj4gPC9kaXY+IDwvZGl2PiA=");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/results/FeatureSetCollectionResultsLabelView.html","html","PGJ1dHRvbiBjbGFzcz0iZ2N4LWxpc3QtYnV0dG9uIGdjeC1saXN0LWJ1dHRvbi1wb2MgaWNvbi1yaWdodCBjaGV2cm9uLXJpZ2h0LTI0IiBkYXRhLWJpbmRpbmc9IntAZXZlbnQtb25jbGljazogaGFuZGxlQ2xpY2t9Ij4gPGltZyBjbGFzcz0ibGlzdC1tZW51LWljb24gbGlzdC1tZW51LWljb24tcG9jIiBkYXRhLWJpbmRpbmc9IntzcmM6IGljb25Vcml9e0B2aXNpYmxlOiBpY29uVXJpfSIgYWx0PSIgIiBhcmlhLWhpZGRlbj0idHJ1ZSIgLz4gPGltZyBjbGFzcz0ibGlzdC1tZW51LWljb24gbGlzdC1tZW51LWljb24tcG9jIiBkYXRhLWJpbmRpbmc9IntAaGlkZGVuOiBpY29uVXJpfSIgc3JjPSJSZXNvdXJjZXMvSW1hZ2VzL0ljb25zL21hcC1kZWZhdWx0LTI0LnBuZyIgYWx0PSIgIiBhcmlhLWhpZGRlbj0idHJ1ZSIgLz4gPHN0cm9uZyBjbGFzcz0iZ2N4LWxpc3QtbGFiZWwgZ2N4LWxpc3QtbGFiZWwtcG9jIj48c3BhbiBkYXRhLWJpbmRpbmc9IntAdmFyOiBmZWF0dXJlc0NvdW50fXtAdGV4dDogZmVhdHVyZXNDb3VudH0iPjwvc3Bhbj4gPHNwYW4gZGF0YS1iaW5kaW5nPSJ7QHZhcjogZmVhdHVyZVNldExhYmVsfXtAdGV4dDogZmVhdHVyZVNldExhYmVsfSI+PC9zcGFuPjwvc3Ryb25nPiA8L2J1dHRvbj4g");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/results/FeatureSetCollectionResultsView.html","html","PGRpdiBjbGFzcz0icmVzdWx0cy1saXN0LWFjdGlvbnMtd2lkZ2V0IiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogZmVhdHVyZVNldENvbGxlY3Rpb259e0B3aWRnZXQ6IEZlYXR1cmVTZXRDb2xsZWN0aW9uQWN0aW9uc1dpZGdldH17QHdpZGdldC1jb250ZXh0OiBmZWF0dXJlU2V0Q29sbGVjdGlvbn17QHdpZGdldC1yZXF1aXJlZDogZmFsc2V9Ig0KICAgICBkYXRhLW1lbnUtaWQ9IkZlYXR1cmVTZXRDb2xsZWN0aW9uUmVzdWx0c0FjdGlvbnMiIGRhdGEtbWVudS10ZW1wbGF0ZT0iTWFwcGluZy9pbmZyYXN0cnVjdHVyZS9tZW51cy9NZW51SHlwZXJsaW5rVmlldy5odG1sIj48L2Rpdj4gIDxkaXYgY2xhc3M9ImxheWVyLWFkZGl0aW9uIG1hcC1zZXJ2aWNlcy1kaWFsb2ciPiAgPGRpdiBjbGFzcz0ibm8tcmVzdWx0cyIgZGF0YS1iaW5kaW5nPSJ7QGhpZGRlbjogZmVhdHVyZVNldHN9e0B0ZXh0OiBzZWFyY2hTdWdnZXN0aW9ufSIgdGFiaW5kZXg9IjAiPjwvZGl2PiA8ZGl2IGNsYXNzPSJwYW5lbC1ncm91cCIgZGF0YS1iaW5kaW5nPSJ7QHZpc2libGU6IGZlYXR1cmVTZXRzfXtAdmFyOiBzY3JvbGxDb250YWluZXJFbGVtZW50fSI+ICA8dWwgY2xhc3M9ImdjeC1saXN0LW1lbnUiIGRhdGEtYmluZGluZz0ie0Bzb3VyY2U6IGZlYXR1cmVTZXRzfSI+IDxsaSBjbGFzcz0iZ2N4LWxpc3QtaXRlbSBoYXMtYWN0aW9uLTEiIGRhdGEtYmluZGluZz0ie3RpdGxlOiBAbGFuZ3VhZ2UtcmVzdWx0cy1mZWF0dXJlLXNldC1lbGVtZW50LXRpdGxlfXtAdGVtcGxhdGUtZm9yOiBmZWF0dXJlU2V0c30iPiAgPGRpdiBjbGFzcz0ic21hcnQtcGFuZWwtaG9pc3RlZC1tZW51LWlubGluZSBmZWF0dXJlLXNldHMtYWN0aW9ucyBib3VuZC1pbnZpc2libGUiIGRhdGEtYmluZGluZz0ie0B3aWRnZXQ6IEZlYXR1cmVTZXRBY3Rpb25zV2lkZ2V0fXtAd2lkZ2V0LWNvbnRleHQ6IEBjb250ZXh0fXtAd2lkZ2V0LXJlcXVpcmVkOiBmYWxzZX0iDQogICAgICAgICAgICAgICAgICAgICBkYXRhLW1lbnUtaWQ9IkZlYXR1cmVTZXRDb2xsZWN0aW9uUmVzdWx0c0ZlYXR1cmVTZXRBY3Rpb25zIiBkYXRhLW1lbnUtaG9pc3QtZGlzYWJsZWQ+PC9kaXY+IDxkaXYgZGF0YS1iaW5kaW5nPSJ7QHdpZGdldDogR2V0RmVhdHVyZVNldExhYmVsfXtAd2lkZ2V0LWNvbnRleHQ6IEBjb250ZXh0fXtAd2lkZ2V0LXJlcGxhY2U6IHRydWV9Ij48L2Rpdj4gIDxidXR0b24gY2xhc3M9ImdjeC1hY3Rpb24tYnV0dG9uIGljb24gbW9yZS0yNCIgZGF0YS1iaW5kaW5nPSJ7dGl0bGU6IEBsYW5ndWFnZS1tZW51LWZlYXR1cmUtc2V0LWFjdGlvbnMtdGl0bGV9e0BldmVudC1jbGljazogaGFuZGxlRmVhdHVyZVNldENvbGxlY3Rpb25GZWF0dXJlU2V0QWN0aW9uc0NsaWNrfSI+PC9idXR0b24+IDwvbGk+IDwvdWw+IDwvZGl2PiA8L2Rpdj4g");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/results/FeatureSetResultsView.html","html","PGRpdiBjbGFzcz0icmVzdWx0cy1saXN0LWFjdGlvbnMtd2lkZ2V0IiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogZmVhdHVyZVNldH17QHdpZGdldDogRmVhdHVyZVNldEFjdGlvbnNXaWRnZXR9e0B3aWRnZXQtY29udGV4dDogZmVhdHVyZVNldH17QHdpZGdldC1yZXF1aXJlZDogZmFsc2V9IiANCiAgICAgZGF0YS1tZW51LWlkPSJGZWF0dXJlU2V0UmVzdWx0c0FjdGlvbnMiIGRhdGEtbWVudS10ZW1wbGF0ZT0iTWFwcGluZy9pbmZyYXN0cnVjdHVyZS9tZW51cy9NZW51SHlwZXJsaW5rVmlldy5odG1sIj48L2Rpdj4gPGRpdiBjbGFzcz0ibGF5ZXItYWRkaXRpb24gbWFwLXNlcnZpY2VzLWRpYWxvZyI+ICA8ZGl2IGNsYXNzPSJuby1yZXN1bHRzIiBkYXRhLWJpbmRpbmc9IntAaGlkZGVuOiBwcmVzZW50YWJsZVJlc3VsdHN9e0B0ZXh0OiBzZWFyY2hTdWdnZXN0aW9ufSIgdGFiaW5kZXg9IjAiPjwvZGl2PiAgIDxkaXYgY2xhc3M9InJlc3VsdHMtbGlzdCIgZGF0YS1iaW5kaW5nPSJ7QHZhcjogc2Nyb2xsQ29udGFpbmVyRWxlbWVudH17QGV2ZW50LW9uc2Nyb2xsOiBoYW5kbGVTY3JvbGxDaGFuZ2V9IiB0YWJpbmRleD0iLTEiPiAgPHVsIGNsYXNzPSJnY3gtbGlzdC1tZW51IiBkYXRhLWJpbmRpbmc9IntAc291cmNlOiByZXN1bHRzUGFnZX17QHZpc2libGU6IHJlc3VsdHNQYWdlfSI+IDxsaSBjbGFzcz0iZ2N4LWxpc3QtaXRlbSBoYXMtYWN0aW9uLTEiIGRhdGEtYmluZGluZz0ie3RpdGxlOiBAbGFuZ3VhZ2UtcmVzdWx0cy1mZWF0dXJlLWVsZW1lbnQtdGl0bGV9e0BldmVudC1tb3VzZWVudGVyOiBoYW5kbGVNb3VzZU92ZXJ9e0BldmVudC1tb3VzZWxlYXZlOiBoYW5kbGVNb3VzZU91dH17QHRlbXBsYXRlLWZvcjogcmVzdWx0c1BhZ2V9Ij4gIDxkaXYgY2xhc3M9InNtYXJ0LXBhbmVsLWhvaXN0ZWQtbWVudS1pbmxpbmUgZmVhdHVyZS1zZXQtYWN0aW9ucyBib3VuZC1pbnZpc2libGUiIGRhdGEtYmluZGluZz0ie0B3aWRnZXQ6IEZlYXR1cmVBY3Rpb25zV2lkZ2V0fXtAd2lkZ2V0LWNvbnRleHQ6IEBjb250ZXh0fXtAd2lkZ2V0LXJlcXVpcmVkOiBmYWxzZX0iDQogICAgICAgICAgICAgICAgICAgICBkYXRhLW1lbnUtaWQ9IkZlYXR1cmVTZXRSZXN1bHRzRmVhdHVyZUFjdGlvbnMiIGRhdGEtbWVudS1ob2lzdC1kaXNhYmxlZD48L2Rpdj4gPGJ1dHRvbiBjbGFzcz0iZ2N4LWxpc3QtYnV0dG9uIGdjeC1saXN0LWJ1dHRvbi1wb2MgaWNvbi1yaWdodCBjaGV2cm9uLXJpZ2h0LTI0IiBkYXRhLWJpbmRpbmc9IntAZXZlbnQtb25mb2N1czogaGFuZGxlTW91c2VPdmVyfXtAZXZlbnQtb25ibHVyOiBoYW5kbGVNb3VzZU91dH17QGV2ZW50LW1vdXNlZG93bjogaGFuZGxlTW91c2VEb3dufXtAZXZlbnQtY2xpY2s6IGhhbmRsZUNsaWNrfXtAZXZlbnQtbW91c2V1cDogaGFuZGxlTW91c2VVcH17QGV2ZW50LXRvdWNoc3RhcnQ6IGhhbmRsZVRvdWNoU3RhcnR9e0BldmVudC10b3VjaG1vdmU6IGhhbmRsZVRvdWNoTW92ZX17QGV2ZW50LXRvdWNoY2FuY2VsOiBoYW5kbGVUb3VjaENhbmNlbH17QGV2ZW50LXRvdWNoZW5kOiBoYW5kbGVUb3VjaEVuZH0iPiA8c3BhbiBjbGFzcz0ibGlzdC1tZW51LWRldGFpbHMiPiA8c3Ryb25nIGNsYXNzPSJnY3gtbGlzdC1sYWJlbCIgZGF0YS1iaW5kaW5nPSJ7QHdpZGdldDogR2V0TGFiZWx9e0B3aWRnZXQtY29udGV4dDogQGNvbnRleHR9e0B2aXNpYmxlOiBsYWJlbH17QGV2ZW50LW1vdXNlZG93bjogaGFuZGxlTW91c2VEb3dufXtAZXZlbnQtY2xpY2s6IGhhbmRsZUNsaWNrfXtAZXZlbnQtbW91c2VvdXQ6IGhhbmRsZU1vdXNlT3V0fXtAZXZlbnQtbW91c2V1cDogaGFuZGxlTW91c2VVcH17QGV2ZW50LXRvdWNoc3RhcnQ6IGhhbmRsZVRvdWNoU3RhcnR9e0BldmVudC10b3VjaG1vdmU6IGhhbmRsZVRvdWNoTW92ZX17QGV2ZW50LXRvdWNoY2FuY2VsOiBoYW5kbGVUb3VjaENhbmNlbH17QGV2ZW50LXRvdWNoZW5kOiBoYW5kbGVUb3VjaEVuZH0iPjwvc3Ryb25nPiA8c3BhbiBjbGFzcz0iZ2N4LWxpc3QtZGVzYyIgZGF0YS1iaW5kaW5nPSJ7QHdpZGdldDogR2V0RGVzY3JpcHRpb259e0B3aWRnZXQtY29udGV4dDogQGNvbnRleHR9Ij48L3NwYW4+IDwvc3Bhbj4gPC9idXR0b24+ICA8YnV0dG9uIGNsYXNzPSJnY3gtYWN0aW9uLWJ1dHRvbiBpY29uIG1vcmUtMjQiIGRhdGEtYmluZGluZz0ie3RpdGxlOiBAbGFuZ3VhZ2UtbWVudS1mZWF0dXJlLWFjdGlvbnMtdGl0bGV9e0BldmVudC1vbmZvY3VzOiBoYW5kbGVNb3VzZU92ZXJ9e0BldmVudC1vbmJsdXI6IGhhbmRsZU1vdXNlT3V0fXtAZXZlbnQtY2xpY2s6IGhhbmRsZUZlYXR1cmVTZXRGZWF0dXJlQWN0aW9uQ2xpY2t9Ij48L2J1dHRvbj4gPC9saT4gPC91bD4gPC9kaXY+ICAgPGRpdiBjbGFzcz0icGFnaW5nLWNvbnRyb2wiIGRhdGEtYmluZGluZz0ie0Bzb3VyY2U6IHByZXNlbnRhYmxlUmVzdWx0c317Y2xhc3NOYW1lOiBwYWdpbmdDb250cm9sQ2xhc3NOYW1lfSI+IDxkaXYgY2xhc3M9InBhZ2luZy1jb250cm9sLWlubmVyIiBkYXRhLWJpbmRpbmc9IntAdGVtcGxhdGUtZm9yOiBwcmVzZW50YWJsZVJlc3VsdHN9Ij4gPGRpdiBjbGFzcz0icGFnaW5nLXJlc3VsdC1pbmZvIj4gPHNwYW4gY2xhc3M9InBhZ2luZy1yZXN1bHRzLXRvdGFsIiBkYXRhLWJpbmRpbmc9IntAaGlkZGVuOiBudW1iZXJPZkl0ZW1zfXtAdGV4dDogQGxhbmd1YWdlLWNvbW1vbi1uby1yZXN1bHRzfSI+PC9zcGFuPiA8c3BhbiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogbnVtYmVyT2ZJdGVtc30iPiA8c3BhbiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXJlc3VsdHMtZGlzcGxheWluZ30iPjwvc3Bhbj4mbmJzcDs8c3BhbiBkYXRhLWJpbmRpbmc9IntAdGV4dDogY3VyckluZGV4U3RhcnRGcm9tT25lfSI+PC9zcGFuPiZuYnNwOy0mbmJzcDs8c3BhbiBkYXRhLWJpbmRpbmc9IntAdGV4dDogY3VyckluZGV4RW5kfSI+PC9zcGFuPiZuYnNwOyg8c3BhbiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXJlc3VsdHMtdG90YWx9Ij48L3NwYW4+OiZuYnNwOzxzcGFuIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBudW1iZXJPZkl0ZW1zfSI+PC9zcGFuPikgPC9zcGFuPiA8L2Rpdj4gPGRpdiBjbGFzcz0icGFnaW5nLWJ1dHRvbnMiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBudW1iZXJPZkl0ZW1zfSI+IDxidXR0b24gY2xhc3M9ImZpcnN0IiBkYXRhLWJpbmRpbmc9IntAZXZlbnQtb25jbGljazogaGFuZGxlUGFnZUZpcnN0fXt0aXRsZTogQGxhbmd1YWdlLXBhZ2UtZmlyc3R9Ij48aW1nIHNyYz0iUmVzb3VyY2VzL0ltYWdlcy9JY29ucy9wYWdpbmctY29udHJvbC1maXJzdC00NC5wbmciIGFsdD0iICIgLz48L2J1dHRvbj4gPGJ1dHRvbiBjbGFzcz0icHJldiIgZGF0YS1iaW5kaW5nPSJ7QGV2ZW50LW9uY2xpY2s6IGhhbmRsZVBhZ2VQcmV2fXt0aXRsZTogQGxhbmd1YWdlLXBhZ2UtcHJldn0iPjxpbWcgc3JjPSJSZXNvdXJjZXMvSW1hZ2VzL0ljb25zL3BhZ2luZy1jb250cm9sLXByZXZpb3VzLTQ0LnBuZyIgYWx0PSIgIiAvPjwvYnV0dG9uPiA8c3BhbiBjbGFzcz0icGFnaW5nLWJ1dHRvbnMtaW5mbyIgdGFiaW5kZXg9IjAiPiA8c3BhbiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXJlc3VsdHMtcGFnZX0iPjwvc3Bhbj4mbmJzcDs8c3BhbiBkYXRhLWJpbmRpbmc9IntAdGV4dDogY3VyclBhZ2VOdW1iZXJ9Ij48L3NwYW4+Jm5ic3A7PHNwYW4gZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IEBsYW5ndWFnZS1yZXN1bHRzLXBhZ2Utb2Z9Ij48L3NwYW4+Jm5ic3A7PHNwYW4gZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IGxhc3RQYWdlTnVtYmVyfSI+PC9zcGFuPiA8L3NwYW4+IDxidXR0b24gY2xhc3M9Im5leHQiIGRhdGEtYmluZGluZz0ie0BldmVudC1vbmNsaWNrOiBoYW5kbGVQYWdlTmV4dH17dGl0bGU6IEBsYW5ndWFnZS1wYWdlLW5leHR9Ij48aW1nIHNyYz0iUmVzb3VyY2VzL0ltYWdlcy9JY29ucy9wYWdpbmctY29udHJvbC1uZXh0LTQ0LnBuZyIgYWx0PSIgIiAvPjwvYnV0dG9uPiA8YnV0dG9uIGNsYXNzPSJsYXN0IiBkYXRhLWJpbmRpbmc9IntAZXZlbnQtb25jbGljazogaGFuZGxlUGFnZUxhc3R9e3RpdGxlOiBAbGFuZ3VhZ2UtcGFnZS1sYXN0fSI+PGltZyBzcmM9IlJlc291cmNlcy9JbWFnZXMvSWNvbnMvcGFnaW5nLWNvbnRyb2wtbGFzdC00NC5wbmciIGFsdD0iICIgLz48L2J1dHRvbj4gPC9kaXY+IDwvZGl2PiA8L2Rpdj4gIDwvZGl2PiA=");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/results/ResultsFeatureActionsView.html","html","PGRpdiBjbGFzcz0ibGlzdC1tZW51IiBkYXRhLWJpbmRpbmc9IntAc291cmNlOiBmZWF0dXJlQWN0aW9uc30iPiA8ZGl2IGNsYXNzPSJsaXN0LW1lbnUtaXRlbSIgZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLWZvcjogZmVhdHVyZUFjdGlvbnN9e0BldmVudC1vbm1vdXNlb3ZlcjogaGFuZGxlR2V0RGVzY3JpcHRpb259e0BldmVudC1vbmNsaWNrOiBoYW5kbGVNZW51SXRlbUNsaWNrfSI+IDxidXR0b24gY2xhc3M9Imxpc3QtbWVudS1kZXRhaWxzIj4gPHN0cm9uZyBjbGFzcz0ibGlzdC1tZW51LW5hbWUiIGRhdGEtYmluZGluZz0ie0B0ZXh0OiB0ZXh0fSI+PC9zdHJvbmc+IDxzcGFuIGNsYXNzPSJsaXN0LW1lbnUtZGVzYyIgZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IGRlc2NyaXB0aW9ufSI+PC9zcGFuPiA8L2J1dHRvbj4gPC9kaXY+IDwvZGl2PiA=");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/results/ResultsListView.html","html","PGRpdiBjbGFzcz0icmVzdWx0cy1saXN0LWFjdGlvbnMtd2lkZ2V0IiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogZmVhdHVyZVNldENvbGxlY3Rpb259e0B3aWRnZXQ6IFJlc3VsdHNMaXN0QWN0aW9uc1dpZGdldH17QHdpZGdldC1jb250ZXh0OiBmZWF0dXJlU2V0Q29sbGVjdGlvbn17QHdpZGdldC1yZXF1aXJlZDogZmFsc2V9IiBkYXRhLW1lbnUtaWQ9IlJlc3VsdHNMaXN0QWN0aW9ucyIgZGF0YS1tZW51LXRlbXBsYXRlPSJNYXBwaW5nL2luZnJhc3RydWN0dXJlL21lbnVzL01lbnVIeXBlcmxpbmtWaWV3Lmh0bWwiPjwvZGl2PiA8ZGl2IGNsYXNzPSJyZXN1bHRzIj4gIDxkaXYgY2xhc3M9Im5vLXJlc3VsdHMiIGRhdGEtYmluZGluZz0ie0BoaWRkZW46IGhhc0ZlYXR1cmVTZXRzfXtAdGV4dDogc2VhcmNoU3VnZ2VzdGlvbn0iIHRhYmluZGV4PSIwIj48L2Rpdj4gICAgPGRpdiBjbGFzcz0icmVzdWx0cy1saXN0IiBkYXRhLWJpbmRpbmc9IntAdmFyOiBzY3JvbGxDb250YWluZXJFbGVtZW50fXtAZXZlbnQtb25zY3JvbGw6IGhhbmRsZVNjcm9sbENoYW5nZX0iIHRhYmluZGV4PSItMSI+IDxkaXYgY2xhc3M9Imxpc3QtbWVudSBhY3RpdmUgaGFzLWljb24iIGRhdGEtYmluZGluZz0ie0Bzb3VyY2U6IHJlc3VsdHNQYWdlfXtAdmlzaWJsZTogcmVzdWx0c1BhZ2V9e0B2YXI6IHJlc3VsdHNMaXN0fSI+IDxkaXYgY2xhc3M9Imxpc3QtbWVudS1pdGVtIiBkYXRhLWJpbmRpbmc9IntAdGVtcGxhdGUtZm9yOiByZXN1bHRzUGFnZX17QGV2ZW50LW1vdXNlZG93bjogaGFuZGxlTW91c2VEb3dufXtAZXZlbnQtY2xpY2s6IGhhbmRsZUNsaWNrfXtAZXZlbnQtb25mb2N1czogaGFuZGxlTW91c2VPdmVyfXtAZXZlbnQtb25ibHVyOiBoYW5kbGVNb3VzZU91dH17QGV2ZW50LW1vdXNlZW50ZXI6IGhhbmRsZU1vdXNlT3Zlcn17QGV2ZW50LW1vdXNlbGVhdmU6IGhhbmRsZU1vdXNlT3V0fXtAZXZlbnQtbW91c2V1cDogaGFuZGxlTW91c2VVcH17QGV2ZW50LXRvdWNoc3RhcnQ6IGhhbmRsZVRvdWNoU3RhcnR9e0BldmVudC10b3VjaG1vdmU6IGhhbmRsZVRvdWNoTW92ZX17QGV2ZW50LXRvdWNoY2FuY2VsOiBoYW5kbGVUb3VjaENhbmNlbH17QGV2ZW50LXRvdWNoZW5kOiBoYW5kbGVUb3VjaEVuZH0iIHRhYmluZGV4PSIwIj4gPGltZyBjbGFzcz0ibGlzdC1tZW51LWljb24iIGRhdGEtYmluZGluZz0ie3NyYzogaWNvblVyaX17YWx0OiBsYWJlbH17QHZpc2libGU6IGljb25Vcml9IiBhbHQ9IiAiIGFyaWEtaGlkZGVuPSJ0cnVlIiAvPiA8aW1nIGNsYXNzPSJsaXN0LW1lbnUtaWNvbiIgZGF0YS1iaW5kaW5nPSJ7YWx0OiBsYWJlbH17QGhpZGRlbjogaWNvblVyaX0iIHNyYz0iUmVzb3VyY2VzL0ltYWdlcy9JY29ucy9tYXAtZGVmYXVsdC0yNC5wbmciIGFsdD0iICIgYXJpYS1oaWRkZW49InRydWUiIC8+IDxzcGFuIGNsYXNzPSJsaXN0LW1lbnUtZGV0YWlscyI+IDxidXR0b24gY2xhc3M9Imxpc3QtbWVudS1uYW1lIiBkYXRhLWJpbmRpbmc9IntAd2lkZ2V0OiBHZXRMYWJlbH17QHdpZGdldC1jb250ZXh0OiBAY29udGV4dH17QHZpc2libGU6IGxhYmVsfXtAZXZlbnQtbW91c2Vkb3duOiBoYW5kbGVNb3VzZURvd259e0BldmVudC1jbGljazogaGFuZGxlQ2xpY2t9e0BldmVudC1tb3VzZW91dDogaGFuZGxlTW91c2VPdXR9e0BldmVudC1tb3VzZXVwOiBoYW5kbGVNb3VzZVVwfXtAZXZlbnQtdG91Y2hzdGFydDogaGFuZGxlVG91Y2hTdGFydH17QGV2ZW50LXRvdWNobW92ZTogaGFuZGxlVG91Y2hNb3ZlfXtAZXZlbnQtdG91Y2hjYW5jZWw6IGhhbmRsZVRvdWNoQ2FuY2VsfXtAZXZlbnQtdG91Y2hlbmQ6IGhhbmRsZVRvdWNoRW5kfSI+PC9idXR0b24+IDxzcGFuIGNsYXNzPSJsaXN0LW1lbnUtZGVzYyIgZGF0YS1iaW5kaW5nPSJ7QHdpZGdldDogR2V0RGVzY3JpcHRpb259e0B3aWRnZXQtY29udGV4dDogQGNvbnRleHR9Ij48L3NwYW4+IDwvc3Bhbj4gPC9kaXY+IDwvZGl2PiA8L2Rpdj4gICA8ZGl2IGNsYXNzPSJwYWdpbmctY29udHJvbCIgZGF0YS1iaW5kaW5nPSJ7QHNvdXJjZTogcHJlc2VudGFibGVSZXN1bHRzfXtjbGFzc05hbWU6IHBhZ2luZ0NvbnRyb2xDbGFzc05hbWV9Ij4gPGRpdiBjbGFzcz0icGFnaW5nLWNvbnRyb2wtaW5uZXIiIGRhdGEtYmluZGluZz0ie0B0ZW1wbGF0ZS1mb3I6IHByZXNlbnRhYmxlUmVzdWx0c30iPiA8ZGl2IGNsYXNzPSJwYWdpbmctcmVzdWx0LWluZm8iPiA8c3BhbiBjbGFzcz0icGFnaW5nLXJlc3VsdHMtdG90YWwiIGRhdGEtYmluZGluZz0ie0BoaWRkZW46IG51bWJlck9mSXRlbXN9e0B0ZXh0OiBAbGFuZ3VhZ2UtY29tbW9uLW5vLXJlc3VsdHN9Ij48L3NwYW4+IDxzcGFuIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBudW1iZXJPZkl0ZW1zfSI+IDxzcGFuIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBAbGFuZ3VhZ2UtcmVzdWx0cy1kaXNwbGF5aW5nfSI+PC9zcGFuPiZuYnNwOzxzcGFuIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBjdXJySW5kZXhTdGFydEZyb21PbmV9Ij48L3NwYW4+Jm5ic3A7LSZuYnNwOzxzcGFuIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBjdXJySW5kZXhFbmR9Ij48L3NwYW4+Jm5ic3A7KDxzcGFuIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBAbGFuZ3VhZ2UtcmVzdWx0cy10b3RhbH0iPjwvc3Bhbj46Jm5ic3A7PHNwYW4gZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IG51bWJlck9mSXRlbXN9Ij48L3NwYW4+KSA8L3NwYW4+IDwvZGl2PiA8ZGl2IGNsYXNzPSJwYWdpbmctYnV0dG9ucyIgZGF0YS1iaW5kaW5nPSJ7QHZpc2libGU6IG51bWJlck9mSXRlbXN9Ij4gPGJ1dHRvbiBjbGFzcz0iZmlyc3QiIGRhdGEtYmluZGluZz0ie0BldmVudC1vbmNsaWNrOiBoYW5kbGVQYWdlRmlyc3R9e3RpdGxlOiBAbGFuZ3VhZ2UtcGFnZS1maXJzdH0iPjxpbWcgc3JjPSJSZXNvdXJjZXMvSW1hZ2VzL0ljb25zL3BhZ2luZy1jb250cm9sLWZpcnN0LTQ0LnBuZyIgYWx0PSIgIiAvPjwvYnV0dG9uPiA8YnV0dG9uIGNsYXNzPSJwcmV2IiBkYXRhLWJpbmRpbmc9IntAZXZlbnQtb25jbGljazogaGFuZGxlUGFnZVByZXZ9e3RpdGxlOiBAbGFuZ3VhZ2UtcGFnZS1wcmV2fSI+PGltZyBzcmM9IlJlc291cmNlcy9JbWFnZXMvSWNvbnMvcGFnaW5nLWNvbnRyb2wtcHJldmlvdXMtNDQucG5nIiBhbHQ9IiAiIC8+PC9idXR0b24+IDxzcGFuIGNsYXNzPSJwYWdpbmctYnV0dG9ucy1pbmZvIiB0YWJpbmRleD0iMCI+IDxzcGFuIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBAbGFuZ3VhZ2UtcmVzdWx0cy1wYWdlfSI+PC9zcGFuPiZuYnNwOzxzcGFuIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBjdXJyUGFnZU51bWJlcn0iPjwvc3Bhbj4mbmJzcDs8c3BhbiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXJlc3VsdHMtcGFnZS1vZn0iPjwvc3Bhbj4mbmJzcDs8c3BhbiBkYXRhLWJpbmRpbmc9IntAdGV4dDogbGFzdFBhZ2VOdW1iZXJ9Ij48L3NwYW4+IDwvc3Bhbj4gPGJ1dHRvbiBjbGFzcz0ibmV4dCIgZGF0YS1iaW5kaW5nPSJ7QGV2ZW50LW9uY2xpY2s6IGhhbmRsZVBhZ2VOZXh0fXt0aXRsZTogQGxhbmd1YWdlLXBhZ2UtbmV4dH0iPjxpbWcgc3JjPSJSZXNvdXJjZXMvSW1hZ2VzL0ljb25zL3BhZ2luZy1jb250cm9sLW5leHQtNDQucG5nIiBhbHQ9IiAiIC8+PC9idXR0b24+IDxidXR0b24gY2xhc3M9Imxhc3QiIGRhdGEtYmluZGluZz0ie0BldmVudC1vbmNsaWNrOiBoYW5kbGVQYWdlTGFzdH17dGl0bGU6IEBsYW5ndWFnZS1wYWdlLWxhc3R9Ij48aW1nIHNyYz0iUmVzb3VyY2VzL0ltYWdlcy9JY29ucy9wYWdpbmctY29udHJvbC1sYXN0LTQ0LnBuZyIgYWx0PSIgIiAvPjwvYnV0dG9uPiA8L2Rpdj4gPC9kaXY+IDwvZGl2PiAgPC9kaXY+IA==");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/results/ResultsTableView.html","html","PGRpdiBjbGFzcz0icmVzdWx0cy10YWJsZS1hY3Rpb25zLXdpZGdldCIgZGF0YS1iaW5kaW5nPSJ7QHZpc2libGU6IGZlYXR1cmVTZXRDb2xsZWN0aW9ufXtAd2lkZ2V0OiBSZXN1bHRzVGFibGVBY3Rpb25zV2lkZ2V0fXtAd2lkZ2V0LWNvbnRleHQ6IGZlYXR1cmVTZXRDb2xsZWN0aW9ufXtAd2lkZ2V0LXJlcXVpcmVkOiBmYWxzZX0iDQogICAgIGRhdGEtbWVudS1pZD0iUmVzdWx0c1RhYmxlQWN0aW9ucyIgZGF0YS1tZW51LXRlbXBsYXRlPSJNYXBwaW5nL2luZnJhc3RydWN0dXJlL21lbnVzL01lbnVIeXBlcmxpbmtWaWV3Lmh0bWwiPjwvZGl2PiA8ZGl2IGNsYXNzPSJyZXN1bHRzIj4gIDxkaXYgY2xhc3M9Im5vLXJlc3VsdHMiIGRhdGEtYmluZGluZz0ie0BoaWRkZW46IGhhc0ZlYXR1cmVTZXRzfXtAdGV4dDogc2VhcmNoU3VnZ2VzdGlvbn0iPjwvZGl2PiAgIDxkaXYgY2xhc3M9InRhYi1jb250YWluZXIiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBoYXNGZWF0dXJlU2V0c317QHZhcjogc2Nyb2xsaW5nVGFiQ29udGFpbmVyRWxlbWVudH0iPiA8dGFibGU+IDx0cj4gPHRkIGNsYXNzPSJ0YWItbGVmdC1zY3JvbGwiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiB0YWJDb250cm9sc0VuYWJsZWR9e0BjbGFzcy1kaXNhYmxlZDogbGVmdFNjcm9sbFRhYkRpc2FibGVkfXtAdmFyOiBzY3JvbGxUYWJMZWZ0RWxlbWVudH0iPiA8YnV0dG9uIGRhdGEtYmluZGluZz0ie0BldmVudC1vbmNsaWNrOiBoYW5kbGVUYWJTY3JvbGxCYWNrfXt0aXRsZTogQGxhbmd1YWdlLXRhYi1zY3JvbGwtcHJldn0iPiA8aW1nIHNyYz0iUmVzb3VyY2VzL0ltYWdlcy9JY29ucy9jaGV2cm9uLWxlZnQtMTYucG5nIiBhbHQ9IiI+IDwvYnV0dG9uPiA8L3RkPiA8dGQgZGF0YS1iaW5kaW5nPSJ7QHNvdXJjZTogZmVhdHVyZVNldENvbGxlY3Rpb259Ij4gPGRpdiBjbGFzcz0idGFiLWNvbnRhaW5lciIgZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLWZvcjogZmVhdHVyZVNldENvbGxlY3Rpb259e0B2YXI6IHRhYkNvbnRhaW5lckVsZW1lbnR9Ij4gPHVsIGNsYXNzPSJ0YWItY29udHJvbCIgZGF0YS1iaW5kaW5nPSJ7QHNvdXJjZTogZmVhdHVyZVNldHN9e0B2YXI6IHRhYkVsZW1lbnRzfSI+IDxsaSBkYXRhLWJpbmRpbmc9IntAdGVtcGxhdGUtZm9yOiBmZWF0dXJlU2V0c30iPiA8YnV0dG9uIGNsYXNzPSJ0YWIiIGRhdGEtYmluZGluZz0ie0BjbGFzcy10YWItYWN0aXZlOiBpc1NlbGVjdGVkSW5Db2xsZWN0aW9ufXtAbm9jbGFzcy10YWI6IGlzU2VsZWN0ZWRJbkNvbGxlY3Rpb259e0BldmVudC1vbmNsaWNrOiBoYW5kbGVUYWJDbGlja30iPiA8c3Ryb25nIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBkaXNwbGF5TmFtZX17dGl0bGU6IGRpc3BsYXlOYW1lfSI+PC9zdHJvbmc+IDwvYnV0dG9uPiA8L2xpPiA8L3VsPiA8L2Rpdj4gPC90ZD4gPHRkIGNsYXNzPSJ0YWItcmlnaHQtc2Nyb2xsIiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogdGFiQ29udHJvbHNFbmFibGVkfXtAY2xhc3MtZGlzYWJsZWQ6IHJpZ2h0U2Nyb2xsVGFiRGlzYWJsZWR9e0B2YXI6IHNjcm9sbFRhYlJpZ2h0RWxlbWVudH0iPiA8YnV0dG9uIGRhdGEtYmluZGluZz0ie0BldmVudC1vbmNsaWNrOiBoYW5kbGVUYWJTY3JvbGxGb3J3YXJkfXt0aXRsZTogQGxhbmd1YWdlLXRhYi1zY3JvbGwtbmV4dH0iPiA8aW1nIHNyYz0iUmVzb3VyY2VzL0ltYWdlcy9JY29ucy9jaGV2cm9uLXJpZ2h0LTE2LnBuZyI+IDwvYnV0dG9uPiA8L3RkPiA8L3RyPiA8L3RhYmxlPiA8L2Rpdj4gICA8ZGl2IGNsYXNzPSJ3aWRnZXQiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBoYXNGZWF0dXJlU2V0c317QHdpZGdldDogVGFibGVWaWV3V2lkZ2V0fXtAd2lkZ2V0LWNvbnRleHQ6IEBjb250ZXh0fXtAd2lkZ2V0LXJlcXVpcmVkOiBmYWxzZX0iPjwvZGl2PiAgIDxkaXYgY2xhc3M9InBhZ2luZy1jb250cm9sIiBkYXRhLWJpbmRpbmc9IntAc291cmNlOiBwcmVzZW50YWJsZVJlc3VsdHN9Ij4gPGRpdiBjbGFzcz0icGFnaW5nLWNvbnRyb2wtaW5uZXIiIGRhdGEtYmluZGluZz0ie0B0ZW1wbGF0ZS1mb3I6IHByZXNlbnRhYmxlUmVzdWx0c30iPiA8ZGl2IGNsYXNzPSJwYWdpbmctcmVzdWx0LWluZm8iPiA8c3BhbiBkYXRhLWJpbmRpbmc9IntAaGlkZGVuOiBudW1iZXJPZkl0ZW1zfXtAdGV4dDogQGxhbmd1YWdlLWNvbW1vbi1uby1yZXN1bHRzfSI+PC9zcGFuPiA8c3BhbiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogbnVtYmVyT2ZJdGVtc30iPiA8c3BhbiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXJlc3VsdHMtZGlzcGxheWluZ30iPjwvc3Bhbj4mbmJzcDs8c3BhbiBkYXRhLWJpbmRpbmc9IntAdGV4dDogY3VyckluZGV4U3RhcnRGcm9tT25lfSI+PC9zcGFuPiZuYnNwOy0mbmJzcDs8c3BhbiBkYXRhLWJpbmRpbmc9IntAdGV4dDogY3VyckluZGV4RW5kfSI+PC9zcGFuPiZuYnNwOyg8c3BhbiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXJlc3VsdHMtdG90YWx9Ij48L3NwYW4+OiZuYnNwOzxzcGFuIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBudW1iZXJPZkl0ZW1zfSI+PC9zcGFuPikgPC9zcGFuPiA8L2Rpdj4gPGRpdiBjbGFzcz0icGFnaW5nLWJ1dHRvbnMiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBudW1iZXJPZkl0ZW1zfSI+IDxidXR0b24gY2xhc3M9ImZpcnN0IiBkYXRhLWJpbmRpbmc9IntAZXZlbnQtb25jbGljazogaGFuZGxlUGFnZUZpcnN0fXt0aXRsZTogQGxhbmd1YWdlLXJlc3VsdHMtcGFnZS1maXJzdH0iPjxpbWcgc3JjPSJSZXNvdXJjZXMvSW1hZ2VzL0ljb25zL3BhZ2luZy1jb250cm9sLWZpcnN0LTQ0LnBuZyIgYWx0PSIgIi8+PC9idXR0b24+IDxidXR0b24gY2xhc3M9InByZXYiIGRhdGEtYmluZGluZz0ie0BldmVudC1vbmNsaWNrOiBoYW5kbGVQYWdlUHJldn17dGl0bGU6IEBsYW5ndWFnZS1yZXN1bHRzLXBhZ2UtcHJldn0iPjxpbWcgc3JjPSJSZXNvdXJjZXMvSW1hZ2VzL0ljb25zL3BhZ2luZy1jb250cm9sLXByZXZpb3VzLTQ0LnBuZyIgYWx0PSIgIi8+PC9idXR0b24+IDxzcGFuIGNsYXNzPSJwYWdpbmctYnV0dG9ucy1pbmZvIiB0YWJpbmRleD0iMCI+IDxzcGFuIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBAbGFuZ3VhZ2UtcmVzdWx0cy1wYWdlfSI+PC9zcGFuPiZuYnNwOzxzcGFuIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBjdXJyUGFnZU51bWJlcn0iPjwvc3Bhbj4mbmJzcDs8c3BhbiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXJlc3VsdHMtcGFnZS1vZn0iPjwvc3Bhbj4mbmJzcDs8c3BhbiBkYXRhLWJpbmRpbmc9IntAdGV4dDogbGFzdFBhZ2VOdW1iZXJ9Ij48L3NwYW4+IDwvc3Bhbj4gPGJ1dHRvbiBjbGFzcz0ibmV4dCIgZGF0YS1iaW5kaW5nPSJ7QGV2ZW50LW9uY2xpY2s6IGhhbmRsZVBhZ2VOZXh0fXt0aXRsZTogQGxhbmd1YWdlLXJlc3VsdHMtcGFnZS1uZXh0fSI+PGltZyBzcmM9IlJlc291cmNlcy9JbWFnZXMvSWNvbnMvcGFnaW5nLWNvbnRyb2wtbmV4dC00NC5wbmciIGFsdD0iICIvPjwvYnV0dG9uPiA8YnV0dG9uIGNsYXNzPSJsYXN0IiBkYXRhLWJpbmRpbmc9IntAZXZlbnQtb25jbGljazogaGFuZGxlUGFnZUxhc3R9e3RpdGxlOiBAbGFuZ3VhZ2UtcmVzdWx0cy1wYWdlLWxhc3R9Ij48aW1nIHNyYz0iUmVzb3VyY2VzL0ltYWdlcy9JY29ucy9wYWdpbmctY29udHJvbC1sYXN0LTQ0LnBuZyIgYWx0PSIgIi8+PC9idXR0b24+IDwvZGl2PiA8L2Rpdj4gPC9kaXY+ICA8L2Rpdj4g");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/symbology/AttributeSymbologySettingsView.html","html","PGRpdiBjbGFzcz0iYXR0cmlidXRlLXN5bWJvbG9neS1zZXR0aW5ncyIgZGF0YS1iaW5kaW5nPSJ7QHZhcjogY29udGFpbmVyfSI+ICA8ZGl2IGNsYXNzPSJzeW1ib2xvZ3ktZHJvcC1kb3duIiBkYXRhLWJpbmRpbmc9IntAZXZlbnQtb25jaGFuZ2U6IGFwcGx5U2V0dGluZ3N9e0BldmVudC1vbmlucHV0OiBhcHBseVNldHRpbmdzfSI+IDxsYWJlbCBjbGFzcz0ic3ltYm9sb2d5LWxhYmVsIiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1waWNrLWF0dHJpYnV0ZX0iPjwvbGFiZWw+IDxzZWxlY3QgZGF0YS1iaW5kaW5nPSJ7QHNvdXJjZTogYXR0cmlidXRlc317QHZhcjogYXR0cmlidXRlSW5wdXR9Ij4gPG9wdGlvbiBkYXRhLWJpbmRpbmc9IntAdGVtcGxhdGUtZm9yOiBhdHRyaWJ1dGVzfXtAdGV4dDogZGlzcGxheU5hbWV9e0B2YWx1ZSBuYW1lfSI+PC9vcHRpb24+IDwvc2VsZWN0PiA8L2Rpdj4gIDxkaXYgY2xhc3M9InN5bWJvbG9neS1zbGlkZXJzIiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogaXNOdW1lcmljQXR0cmlidXRlfSI+IDxkaXYgY2xhc3M9InN5bWJvbG9neS1udW1iZXJpbnB1dCI+IDxsYWJlbCBjbGFzcz0ic3ltYm9sb2d5LWxhYmVsIiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1icmVha3N9Ij48L2xhYmVsPiA8ZGl2IGNsYXNzPSJudW1lcmljLWlucHV0IiBkYXRhLWJpbmRpbmc9IntAd2lkZ2V0OiBOdW1lcmljSW5wdXRXaWRnZXR9e0B3aWRnZXQtY29udGV4dDogY2xhc3NCcmVha3NJbnB1dH0iPjwvZGl2PiA8L2Rpdj4gPC9kaXY+ICA8ZGl2IGNsYXNzPSJzeW1ib2xvZ3ktY29sb3JzIiAgZGF0YS1iaW5kaW5nPSJ7QHZpc2libGU6IGlzTnVtZXJpY0F0dHJpYnV0ZX0iPiAgPGRpdiBjbGFzcz0iY29sb3ItcGlja2VyIGlubGluZS1ibG9jayI+IDxsYWJlbCBjbGFzcz0ic3ltYm9sb2d5LWxhYmVsIiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1zdGFydGNvbG9yfSI+PC9sYWJlbD4gPGRpdiBkYXRhLWJpbmRpbmc9IntAd2lkZ2V0OiBDb2xvclBpY2tlcldpZGdldH17QHdpZGdldC1jb250ZXh0OiBzdGFydENvbG9yfSI+PC9kaXY+IDwvZGl2PiAgPGRpdiBjbGFzcz0iY29sb3ItcGlja2VyIGlubGluZS1ibG9jayI+IDxsYWJlbCBjbGFzcz0ic3ltYm9sb2d5LWxhYmVsIiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1lbmRjb2xvcn0iPjwvbGFiZWw+IDxkaXYgZGF0YS1iaW5kaW5nPSJ7QHdpZGdldDogQ29sb3JQaWNrZXJXaWRnZXR9e0B3aWRnZXQtY29udGV4dDogZW5kQ29sb3J9Ij48L2Rpdj4gPC9kaXY+IDwvZGl2PiAgPGRpdiBjbGFzcz0ic3ltYm9sb2d5LXNsaWRlcnMiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBjdXJyZW50QXR0cmlidXRlfSI+ICA8ZGl2IGNsYXNzPSJzeW1ib2xvZ3ktbnVtYmVyaW5wdXQiPiA8bGFiZWwgY2xhc3M9InN5bWJvbG9neS1sYWJlbCIgZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IEBsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtdHJhbnNwYXJlbmN5fSI+PC9sYWJlbD4gPGRpdiBjbGFzcz0ibnVtZXJpYy1pbnB1dC13cmFwcGVyIj4gPGRpdiBjbGFzcz0ibnVtZXJpYy1pbnB1dCIgZGF0YS1iaW5kaW5nPSJ7QHdpZGdldDogTnVtZXJpY0lucHV0V2lkZ2V0fXtAd2lkZ2V0LWNvbnRleHQ6IHRyYW5zcGFyZW5jeUlucHV0fSI+PC9kaXY+IDxzcGFuIGNsYXNzPSJudW1lcmljLXVuaXRzIiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1wZXJjZW50LXN1ZmZpeH0iPjwvc3Bhbj4gPC9kaXY+IDwvZGl2PiAgPGRpdiBjbGFzcz0ic3ltYm9sb2d5LW51bWJlcmlucHV0IiBkYXRhLWJpbmRpbmc9IntAaGlkZGVuOiBub01hcmtlcn0iPiA8bGFiZWwgY2xhc3M9InN5bWJvbG9neS1sYWJlbCIgZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IEBsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtbWFya2VyLXNpemV9Ij48L2xhYmVsPiA8ZGl2IGNsYXNzPSJudW1lcmljLWlucHV0LXdyYXBwZXIiPiA8ZGl2IGNsYXNzPSJudW1lcmljLWlucHV0IiBkYXRhLWJpbmRpbmc9IntAd2lkZ2V0OiBOdW1lcmljSW5wdXRXaWRnZXR9e0B3aWRnZXQtY29udGV4dDogbWFya2VyU2l6ZUlucHV0fSI+PC9kaXY+IDxzcGFuIGNsYXNzPSJudW1lcmljLXVuaXRzIiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1waXhlbC1zdWZmaXh9Ij48L3NwYW4+IDwvZGl2PiA8L2Rpdj4gIDxkaXYgY2xhc3M9InN5bWJvbG9neS1udW1iZXJpbnB1dCI+IDxsYWJlbCBjbGFzcz0ic3ltYm9sb2d5LWxhYmVsIiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1saW5lLXdpZHRofSI+PC9sYWJlbD4gPGRpdiBjbGFzcz0ibnVtZXJpYy1pbnB1dC13cmFwcGVyIj4gPGRpdiBjbGFzcz0ibnVtZXJpYy1pbnB1dCIgZGF0YS1iaW5kaW5nPSJ7QHdpZGdldDogTnVtZXJpY0lucHV0V2lkZ2V0fXtAd2lkZ2V0LWNvbnRleHQ6IGxpbmVXaWR0aElucHV0fSI+PC9kaXY+IDxzcGFuIGNsYXNzPSJudW1lcmljLXVuaXRzIiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1waXhlbC1zdWZmaXh9Ij48L3NwYW4+IDwvZGl2PiA8L2Rpdj4gIDxkaXYgY2xhc3M9InN5bWJvbG9neS1kcm9wLWRvd24iIGRhdGEtYmluZGluZz0ie0BoaWRkZW46IG5vTWFya2VyfXtAZXZlbnQtb25jaGFuZ2U6IGhhbmRsZU1hcmtlclN0eWxlfXtAZXZlbnQtb25pbnB1dDogaGFuZGxlTWFya2VyU3R5bGV9Ij4gPGxhYmVsIGNsYXNzPSJzeW1ib2xvZ3ktbGFiZWwiIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBAbGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLW1hcmtlci1zdHlsZX0iPjwvbGFiZWw+IDxzZWxlY3QgZGF0YS1iaW5kaW5nPSJ7QHNvdXJjZTogbWFya2VyU3R5bGVzfXtAdmFyOiBtYXJrZXJTdHlsZUlucHV0fSI+IDxvcHRpb24gZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLWZvcjogbWFya2VyU3R5bGVzfXtAdGV4dDogbGFiZWx9Ij48L29wdGlvbj4gPC9zZWxlY3Q+IDwvZGl2PiA8L2Rpdj4gIDxkaXYgY2xhc3M9InN5bWJvbG9neS1jbGFzc2VzIiBkYXRhLWJpbmRpbmc9IntAc291cmNlOiBzeW1ib2xvZ3lDbGFzc2VzfSI+IDxkaXYgZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLWZvcjogc3ltYm9sb2d5Q2xhc3Nlc317QHZhcjogc3ltYm9sb2d5Q2xhc3NDb250YWluZXJ9Ij4gPGJ1dHRvbiBjbGFzcz0iYnV0dG9uIHN5bWJvbG9neS1jbGFzcyIgZGF0YS1iaW5kaW5nPSJ7QGNsYXNzLXNlbGVjdGVkOiBzZWxlY3RlZH17QGV2ZW50LW9uY2xpY2s6IGhhbmRsZVN5bWJvbENsYXNzU2VsZWN0ZWR9e3RpdGxlOiBuYW1lfSI+IDxkaXYgY2xhc3M9InN5bWJvbG9neS10ZXh0IiBkYXRhLWJpbmRpbmc9IntAdGV4dDogbmFtZX0iPjwvZGl2PiA8ZGl2IGNsYXNzPSJzeW1ib2xvZ3ktY29sb3IiIGRhdGEtYmluZGluZz0ie0BzdHlsZS1iYWNrZ3JvdW5kLWNvbG9yOiBkaXNwbGF5Q29sb3J9e0BoaWRkZW46IGlzSW1hZ2V9Ij48L2Rpdj4gPGltZyBjbGFzcz0ic3ltYm9sb2d5LWltYWdlIiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogaXNJbWFnZX17c3JjOiBpbWFnZVNyY30iPjwvaW1nPiA8L2J1dHRvbj4gIDxkaXYgZGF0YS1iaW5kaW5nPSJ7QHZpc2libGU6IHNlbGVjdGVkfXtpZDogd2lkZ2V0SWR9Ij48L2Rpdj4gPC9kaXY+IDwvZGl2PiA8L2Rpdj4g");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/symbology/SymbologySettingsView.html","html","PGRpdiBjbGFzcz0ic3ltYm9sb2d5LXNldHRpbmdzIHBhbmVsLWdyb3VwLWNvbnRlbnRzIiBkYXRhLWJpbmRpbmc9IntAdmFyOiBjb250YWluZXJ9Ij4gIDxkaXYgY2xhc3M9InN5bWJvbG9neS1zZXR0aW5ncy1zZWxlY3RvciBmb3JtLWl0ZW0iIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBzaG93U3ltYm9sb2d5U2VsZWN0b3JNZW51fSI+IDxsYWJlbCBjbGFzcz0ic3ltYm9sb2d5LWxhYmVsIiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1zZWxlY3R9Ij48L2xhYmVsPiA8c2VsZWN0IGRhdGEtYmluZGluZz0ie0Bzb3VyY2U6IHN5bWJvbG9neVdpZGdldHN9e0B2YWx1ZTogY3VycmVudFdpZGdldH0iPiA8b3B0aW9uIGRhdGEtYmluZGluZz0ie0B0ZW1wbGF0ZS1mb3I6IHN5bWJvbG9neVdpZGdldHN9e0B0ZXh0OiBkaXNwbGF5TmFtZX17QGF0dGFjaDogQGNvbnRleHR9Ij48L29wdGlvbj4gPC9zZWxlY3Q+IDwvZGl2PiAgPGRpdiBkYXRhLWJpbmRpbmc9IntAaGlkZGVuOiBzeW1ib2xpemVXaXRoSW1hZ2VyeX0iPiA8ZGl2IGRhdGEtYmluZGluZz0ie0B3aWRnZXQ6IFNpbXBsZVN5bWJvbFdpZGdldH17QHdpZGdldC1yZXBsYWNlOiB0cnVlfSI+PC9kaXY+IDwvZGl2PiAgPGRpdiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogc3ltYm9saXplV2l0aEltYWdlcnl9Ij4gPGRpdiBkYXRhLWJpbmRpbmc9IntAd2lkZ2V0OiBDdXN0b21pemVkUGljdHVyZVN5bWJvbFdpZGdldH17QHdpZGdldC1yZXBsYWNlOiB0cnVlfSI+PC9kaXY+IDwvZGl2PiA8L2Rpdj4g");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/symbology/widgets/PictureSymbolWidget.html","html","PGRpdiBjbGFzcz0ic3R5bGUtc2VsZWN0b3IgbWFya3VwIGltYWdlIiBkYXRhLWJpbmRpbmc9IntAaGlkZGVuOiBub0xpYnJhcmllc30iPiA8ZGl2IGRhdGEtYmluZGluZz0ie0Bzb3VyY2U6IGN1cnJlbnRJbWFnZX0iPiA8c3BhbiBjbGFzcz0ic3ltYm9sLW5hbWUiIGRhdGEtYmluZGluZz0ie0B0ZW1wbGF0ZS1mb3I6IGN1cnJlbnRJbWFnZX17QHRleHQ6IG5hbWV9Ij48L3NwYW4+IDwvZGl2PiAgPGRpdiBjbGFzcz0ic3dhdGNoLWNvbnRhaW5lciBpbWFnZS1jb250YWluZXIiIGRhdGEtYmluZGluZz0ie0Bzb3VyY2U6IGN1cnJlbnRJbWFnZXN9Ij4gPGJ1dHRvbiBjbGFzcz0ibWFya3VwLXN3YXRjaCBtYXJrdXAtc3dhdGNoLWltYWdlIiBkYXRhLWJpbmRpbmc9IntAdGVtcGxhdGUtZm9yOiBjdXJyZW50SW1hZ2VzfXtAY2xhc3Mtc2VsZWN0ZWQ6IHNlbGVjdGVkfXtpZDogaWR9e0BldmVudC1vbmNsaWNrOiBoYW5kbGVDbGlja1N3YXRjaH0iPiA8c3BhbiBjbGFzcz0ic3ltYm9sLWJ1dHRvbi1sYWJlbCIgZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IG5hbWV9Ij48L3NwYW4+IDxpbWcgY2xhc3M9Im1hcmt1cC1zd2F0Y2gtaW1hZ2UiIGRhdGEtYmluZGluZz0ie3NyYzogdXJsfSIgLz4gPC9idXR0b24+IDwvZGl2PiAgPHNwYW4gY2xhc3M9ImltYWdlLWxpYnJhcnktc2VsZWN0b3IgZm9ybS1pdGVtIGlubGluZS1ibG9jayIgZGF0YS1iaW5kaW5nPSJ7QHZpc2libGU6IHNob3dMaWJyYXJ5U3dpdGNoZXJ9Ij4gPGxhYmVsIGNsYXNzPSJzeW1ib2xvZ3ktbGFiZWwiIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBAbGFuZ3VhZ2UtY29tbW9uLWxpYnJhcnl9Ij48L2xhYmVsPiA8c2VsZWN0IGRhdGEtYmluZGluZz0ie0Bzb3VyY2U6IGltYWdlTGlicmFyaWVzfXtAdmFsdWU6IGN1cnJlbnRMaWJyYXJ5fSI+IDxvcHRpb24gZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLWZvcjogaW1hZ2VMaWJyYXJpZXN9e0B0ZXh0OiBAY29udGV4dH17QGF0dGFjaDogQGNvbnRleHR9Ij48L29wdGlvbj4gPC9zZWxlY3Q+IDwvc3Bhbj4gPGRpdiBjbGFzcz0ic3ltYm9sb2d5LXNsaWRlcnMiPiAgPGRpdiBjbGFzcz0ic3ltYm9sb2d5LW51bWJlcmlucHV0Ij4gPGxhYmVsIGNsYXNzPSJzeW1ib2xvZ3ktbGFiZWwiIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBAbGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLWltYWdlLXNpemV9Ij48L2xhYmVsPiA8ZGl2IGNsYXNzPSJudW1lcmljLWlucHV0LXdyYXBwZXIiPiA8ZGl2IGNsYXNzPSJudW1lcmljLWlucHV0IiBkYXRhLWJpbmRpbmc9IntAd2lkZ2V0OiBOdW1lcmljSW5wdXRXaWRnZXR9e0B3aWRnZXQtY29udGV4dDogaW1hZ2VTaXplVmlld01vZGVsfSI+PC9kaXY+IDxzcGFuIGNsYXNzPSJudW1lcmljLXVuaXRzIiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1waXhlbC1zdWZmaXh9Ij48L3NwYW4+IDwvZGl2PiA8L2Rpdj4gIDxkaXYgY2xhc3M9InN5bWJvbG9neS1udW1iZXJpbnB1dCI+IDxsYWJlbCBjbGFzcz0ic3ltYm9sb2d5LWxhYmVsIiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1hbmdsZX0iPjwvbGFiZWw+IDxkaXYgY2xhc3M9Im51bWVyaWMtaW5wdXQtd3JhcHBlciI+IDxkaXYgY2xhc3M9Im51bWVyaWMtaW5wdXQiIGRhdGEtYmluZGluZz0ie0B3aWRnZXQ6IE51bWVyaWNJbnB1dFdpZGdldH17QHdpZGdldC1jb250ZXh0OiBpbWFnZVJvdGF0aW9uVmlld01vZGVsfSI+PC9kaXY+IDxzcGFuIGNsYXNzPSJudW1lcmljLXVuaXRzIiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1kZWdyZWUtc3VmZml4fSI+PC9zcGFuPiA8L2Rpdj4gPC9kaXY+IDwvZGl2PiA8L2Rpdj4gPGRpdiBjbGFzcz0ibm8tc3ltYm9sLWxpYnJhcnkiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBub0xpYnJhcmllc30iPiA8c3BhbiBkYXRhLWJpbmRpbmc9IntAdGV4dDogIEBsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3Mtbm8taW1hZ2UtbGlicmFyaWVzfSIgLz4gPC9kaXY+IA==");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/symbology/widgets/SimpleSymbolWidget.html","html","PGRpdiBjbGFzcz0ic3ltYm9sb2d5LXNldHRpbmdzIiBkYXRhLWJpbmRpbmc9IntAdmFyOiBjb250YWluZXJ9Ij4gIDxkaXYgY2xhc3M9InN5bWJvbG9neS1jb2xvcnMgaW5saW5lLWJsb2NrIj4gIDxkaXYgY2xhc3M9ImNvbG9yLXBpY2tlciBpbmxpbmUtYmxvY2siPiA8bGFiZWwgY2xhc3M9InN5bWJvbG9neS1sYWJlbCIgZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IEBsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtY29sb3J9Ij48L2xhYmVsPiA8ZGl2IGRhdGEtYmluZGluZz0ie0B3aWRnZXQ6IENvbG9yUGlja2VyV2lkZ2V0fXtAd2lkZ2V0LWNvbnRleHQ6IGZpbGx9Ij48L2Rpdj4gPC9kaXY+ICA8ZGl2IGNsYXNzPSJpbmxpbmUtYmxvY2siIGRhdGEtYmluZGluZz0ie0BoaWRkZW46IG5vT3V0bGluZVN5bWJvbH0iPiA8ZGl2IGNsYXNzPSJjb2xvci1waWNrZXIgaW5saW5lLWJsb2NrIiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogc2hvd091dGxpbmVDb2xvcn0iPiA8bGFiZWwgY2xhc3M9InN5bWJvbG9neS1sYWJlbCIgZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IEBsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3Mtb3V0bGluZX0iPjwvbGFiZWw+IDxkaXYgZGF0YS1iaW5kaW5nPSJ7QHdpZGdldDogQ29sb3JQaWNrZXJXaWRnZXR9e0B3aWRnZXQtY29udGV4dDogb3V0bGluZX0iPjwvZGl2PiA8L2Rpdj4gPC9kaXY+IDwvZGl2PiAgPGRpdiBjbGFzcz0ic3ltYm9sb2d5LXNsaWRlcnMiPiA8ZGl2IGNsYXNzPSJzeW1ib2xvZ3ktbnVtYmVyaW5wdXQiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBpc1BvaW50fSI+IDxsYWJlbCBjbGFzcz0ic3ltYm9sb2d5LWxhYmVsIiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1tYXJrZXItc2l6ZX0iPjwvbGFiZWw+IDxkaXYgY2xhc3M9Im51bWVyaWMtaW5wdXQtd3JhcHBlciI+IDxkaXYgY2xhc3M9Im51bWVyaWMtaW5wdXQiIGRhdGEtYmluZGluZz0ie0B3aWRnZXQ6IE51bWVyaWNJbnB1dFdpZGdldH17QHdpZGdldC1jb250ZXh0OiBtYXJrZXJTaXplVmlld01vZGVsfSI+PC9kaXY+IDxzcGFuIGNsYXNzPSJudW1lcmljLXVuaXRzIiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1waXhlbC1zdWZmaXh9Ij48L3NwYW4+IDwvZGl2PiA8L2Rpdj4gPGRpdiBjbGFzcz0ic3ltYm9sb2d5LW51bWJlcmlucHV0Ij4gPGxhYmVsIGNsYXNzPSJzeW1ib2xvZ3ktbGFiZWwiIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBAbGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLWxpbmUtd2lkdGh9Ij48L2xhYmVsPiA8ZGl2IGNsYXNzPSJudW1lcmljLWlucHV0LXdyYXBwZXIiPiA8ZGl2IGNsYXNzPSJudW1lcmljLWlucHV0IiBkYXRhLWJpbmRpbmc9IntAd2lkZ2V0OiBOdW1lcmljSW5wdXRXaWRnZXR9e0B3aWRnZXQtY29udGV4dDogbGluZVdpZHRoVmlld01vZGVsfSI+PC9kaXY+IDxzcGFuIGNsYXNzPSJudW1lcmljLXVuaXRzIiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1waXhlbC1zdWZmaXh9Ij48L3NwYW4+IDwvZGl2PiA8L2Rpdj4gPC9kaXY+ICA8ZGl2IGNsYXNzPSJzeW1ib2xvZ3ktZHJvcC1kb3ducyI+ICA8ZGl2IGNsYXNzPSJzeW1ib2xvZ3ktZHJvcC1kb3duIiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogaXNQb2ludH17QGV2ZW50LW9uY2hhbmdlOiBoYW5kbGVNYXJrZXJTdHlsZX17QGV2ZW50LW9uaW5wdXQ6IGhhbmRsZU1hcmtlclN0eWxlfSI+IDxsYWJlbCBjbGFzcz0ic3ltYm9sb2d5LWxhYmVsIiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1tYXJrZXItc3R5bGV9Ij48L2xhYmVsPiA8c2VsZWN0IGRhdGEtYmluZGluZz0ie0Bzb3VyY2U6IG1hcmtlclN0eWxlc317QHZhcjogbWFya2VyU3R5bGVJbnB1dH0iPiA8b3B0aW9uIGRhdGEtYmluZGluZz0ie0B0ZW1wbGF0ZS1mb3I6IG1hcmtlclN0eWxlc317QHRleHQ6IGxhYmVsfSI+PC9vcHRpb24+IDwvc2VsZWN0PiA8L2Rpdj4gIDxkaXYgY2xhc3M9InN5bWJvbG9neS1kcm9wLWRvd24iIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBzaG93TGluZVN0eWxlc317QGV2ZW50LW9uY2hhbmdlOiBoYW5kbGVMaW5lU3R5bGV9e0BldmVudC1vbmlucHV0OiBoYW5kbGVMaW5lU3R5bGV9Ij4gPGxhYmVsIGNsYXNzPSJzeW1ib2xvZ3ktbGFiZWwiIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBAbGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLWxpbmUtc3R5bGV9Ij48L2xhYmVsPiA8c2VsZWN0IGRhdGEtYmluZGluZz0ie0Bzb3VyY2U6IGxpbmVTdHlsZXN9e0B2YXI6IGxpbmVTdHlsZUlucHV0fSI+IDxvcHRpb24gZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLWZvcjogbGluZVN0eWxlc317QHRleHQ6IGxhYmVsfSI+PC9vcHRpb24+IDwvc2VsZWN0PiA8L2Rpdj4gIDxkaXYgY2xhc3M9InN5bWJvbG9neS1kcm9wLWRvd24iIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBpc1BvbHlnb259e0BldmVudC1vbmNoYW5nZTogaGFuZGxlRmlsbFN0eWxlfXtAZXZlbnQtb25pbnB1dDogaGFuZGxlRmlsbFN0eWxlfSI+IDxsYWJlbCBjbGFzcz0ic3ltYm9sb2d5LWxhYmVsIiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1maWxsLXN0eWxlfSI+PC9sYWJlbD4gPHNlbGVjdCBkYXRhLWJpbmRpbmc9IntAc291cmNlOiBmaWxsU3R5bGVzfXtAdmFyOiBmaWxsU3R5bGVJbnB1dH0iPiA8b3B0aW9uIGRhdGEtYmluZGluZz0ie0B0ZW1wbGF0ZS1mb3I6IGZpbGxTdHlsZXN9e0B0ZXh0OiBsYWJlbH0iPjwvb3B0aW9uPiA8L3NlbGVjdD4gPC9kaXY+IDwvZGl2PiA8L2Rpdj4g");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/symbology/widgets/TextSymbolWidget.html","html","PGRpdiBjbGFzcz0ic3ltYm9sb2d5LXNldHRpbmdzIHRleHQtc3ltYm9sb2d5LXNldHRpbmdzIj4gIDxkaXYgY2xhc3M9InN5bWJvbG9neS10ZXh0aW5wdXQiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBzaG93VGV4dH0iPiA8ZGl2IGNsYXNzPSJmb3JtLWl0ZW0iPiA8bGFiZWwgY2xhc3M9InN5bWJvbG9neS1sYWJlbCIgZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IEBsYW5ndWFnZS1jb21tb24tdGV4dH0iPjwvbGFiZWw+IDxpbnB1dCB0eXBlPSJ0ZXh0IiBkYXRhLWJpbmRpbmc9IntAdmFsdWU6IHN5bWJvbFRleHR9IiAvPiA8L2Rpdj4gPC9kaXY+ICA8ZGl2IGNsYXNzPSJzeW1ib2xvZ3ktY29sb3JzIGlubGluZS1ibG9jayI+ICA8ZGl2IGNsYXNzPSJjb2xvci1waWNrZXIgaW5saW5lLWJsb2NrIiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogc2hvd0ZvbnRDb2xvcn0iPiA8bGFiZWwgY2xhc3M9InN5bWJvbG9neS1sYWJlbCIgZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IEBsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtY29sb3J9Ij48L2xhYmVsPiA8ZGl2IGRhdGEtYmluZGluZz0ie0B3aWRnZXQ6IENvbG9yUGlja2VyV2lkZ2V0fXtAd2lkZ2V0LWNvbnRleHQ6IGZvbnRDb2xvcn0iPjwvZGl2PiA8L2Rpdj4gIDxkaXYgY2xhc3M9ImNvbG9yLXBpY2tlciBpbmxpbmUtYmxvY2siIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBzaG93SGFsb0NvbG9yfSI+IDxsYWJlbCBjbGFzcz0ic3ltYm9sb2d5LWxhYmVsIiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1oYWxvfSI+PC9sYWJlbD4gPGRpdiBkYXRhLWJpbmRpbmc9IntAd2lkZ2V0OiBDb2xvclBpY2tlcldpZGdldH17QHdpZGdldC1jb250ZXh0OiBmb250SGFsb30iPjwvZGl2PiA8L2Rpdj4gPC9kaXY+ICA8ZGl2IGNsYXNzPSJzeW1ib2xvZ3ktZHJvcC1kb3ducyI+IDxkaXYgY2xhc3M9InN5bWJvbG9neS1kcm9wLWRvd24iIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBzaG93Rm9udEZhbWlsaWVzfSI+IDxsYWJlbCBjbGFzcz0ic3ltYm9sb2d5LWxhYmVsIiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1mb250LWZhbWlseX0iPjwvbGFiZWw+IDxkaXYgY2xhc3M9InN5bWJvbG9neS1mb3JtLWNvbnRyb2wiPiA8c2VsZWN0IGRhdGEtYmluZGluZz0ie0Bzb3VyY2U6IGZvbnRGYW1pbGllc317QHZhcjogZm9udEZhbWlseUlucHV0fXtAdmFsdWU6IGZvbnRGYW1pbHl9Ij4gPG9wdGlvbiBkYXRhLWJpbmRpbmc9IntAdGVtcGxhdGUtZm9yOiBmb250RmFtaWxpZXN9e0B0ZXh0OiBAY29udGV4dH0iPjwvb3B0aW9uPiA8L3NlbGVjdD4gPC9kaXY+IDwvZGl2PiA8L2Rpdj4gIDxkaXYgY2xhc3M9InN5bWJvbG9neS1mb3JtLWNvbnRyb2wgaW5saW5lLWJsb2NrIiBkYXRhLWJpbmRpbmc9IntAZW5hYmxlZDogc2hvd0xhYmVsc317QHZpc2libGU6IHNob3dGb250U3R5bGV9Ij4gPGxhYmVsIGNsYXNzPSJzeW1ib2xvZ3ktY2hlY2tib3giPiA8aW5wdXQgdHlwZT0iY2hlY2tib3giIGRhdGEtYmluZGluZz0ie0B2YWx1ZTogZm9udElzQm9sZH0iPiA8c3BhbiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1ib2xkfSI+PC9zcGFuPiA8L2xhYmVsPiA8bGFiZWwgY2xhc3M9InN5bWJvbG9neS1jaGVja2JveCI+IDxpbnB1dCB0eXBlPSJjaGVja2JveCIgZGF0YS1iaW5kaW5nPSJ7QHZhbHVlOiBmb250SXNJdGFsaWN9Ij4gPHNwYW4gZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IEBsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtaXRhbGljfSI+PC9zcGFuPiA8L2xhYmVsPiA8bGFiZWwgY2xhc3M9InN5bWJvbG9neS1jaGVja2JveCI+IDxpbnB1dCB0eXBlPSJjaGVja2JveCIgZGF0YS1iaW5kaW5nPSJ7QHZhbHVlOiBmb250SXNVbmRlcmxpbmV9Ij4gPHNwYW4gZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IEBsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtdW5kZXJsaW5lfSI+PC9zcGFuPiA8L2xhYmVsPiA8L2Rpdj4gIDxkaXYgY2xhc3M9InN5bWJvbG9neS1zbGlkZXJzIj4gPGRpdiBjbGFzcz0ic3ltYm9sb2d5LW51bWJlcmlucHV0IiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogc2hvd0ZvbnRTaXplfSI+IDxsYWJlbCBjbGFzcz0ic3ltYm9sb2d5LWxhYmVsIiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1mb250LXNpemV9Ij48L2xhYmVsPiA8ZGl2IGNsYXNzPSJudW1lcmljLWlucHV0LXdyYXBwZXIiPiA8ZGl2IGNsYXNzPSJudW1lcmljLWlucHV0IiBkYXRhLWJpbmRpbmc9IntAd2lkZ2V0OiBOdW1lcmljSW5wdXRXaWRnZXR9e0B3aWRnZXQtY29udGV4dDogZm9udFNpemVWaWV3TW9kZWx9Ij48L2Rpdj4gPHNwYW4gY2xhc3M9Im51bWVyaWMtdW5pdHMiIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBAbGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLXBvaW50LXN1ZmZpeH0iPjwvc3Bhbj4gPC9kaXY+IDwvZGl2PiA8ZGl2IGNsYXNzPSJzeW1ib2xvZ3ktbnVtYmVyaW5wdXQiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBzaG93SGFsb1NpemV9Ij4gPGxhYmVsIGNsYXNzPSJzeW1ib2xvZ3ktbGFiZWwiIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBAbGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLWhhbG8tc2l6ZX0iPjwvbGFiZWw+IDxkaXYgY2xhc3M9Im51bWVyaWMtaW5wdXQtd3JhcHBlciI+IDxkaXYgY2xhc3M9Im51bWVyaWMtaW5wdXQiIGRhdGEtYmluZGluZz0ie0B3aWRnZXQ6IE51bWVyaWNJbnB1dFdpZGdldH17QHdpZGdldC1jb250ZXh0OiBoYWxvU2l6ZVZpZXdNb2RlbH0iPjwvZGl2PiA8c3BhbiBjbGFzcz0ibnVtZXJpYy11bml0cyIgZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IEBsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtcGl4ZWwtc3VmZml4fSI+PC9zcGFuPiA8L2Rpdj4gPC9kaXY+IDxkaXYgY2xhc3M9InN5bWJvbG9neS1udW1iZXJpbnB1dCIgZGF0YS1iaW5kaW5nPSJ7QHZpc2libGU6IHNob3dUZXh0QW5nbGV9Ij4gPGxhYmVsIGNsYXNzPSJzeW1ib2xvZ3ktbGFiZWwiIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBAbGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLWFuZ2xlfSI+PC9sYWJlbD4gPGRpdiBjbGFzcz0ibnVtZXJpYy1pbnB1dC13cmFwcGVyIj4gPGRpdiBjbGFzcz0ibnVtZXJpYy1pbnB1dCIgZGF0YS1iaW5kaW5nPSJ7QHdpZGdldDogTnVtZXJpY0lucHV0V2lkZ2V0fXtAd2lkZ2V0LWNvbnRleHQ6IHRleHRBbmdsZVZpZXdNb2RlbH0iPjwvZGl2PiA8c3BhbiBjbGFzcz0ibnVtZXJpYy11bml0cyIgZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IEBsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtZGVncmVlLXN1ZmZpeH0iPjwvc3Bhbj4gPC9kaXY+IDwvZGl2PiA8L2Rpdj4gPC9kaXY+IA==");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/ui/components/ColorPicker/ColorPickerWidget.html","html","PGlucHV0IHR5cGU9ImNvbG9yIiB2YWx1ZT0iIzAwMDBmZiIgZGF0YS1iaW5kaW5nPSJ7QHZhcjogY29sb3JJbnB1dH0iLz4g");geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/ui/components/FilterControl/FilterControlView.html","html","PGRpdiBjbGFzcz0iZmlsdGVyLWNvbnRyb2wiPiA8ZGl2IGNsYXNzPSJmaWx0ZXItY29udHJvbC1zZWFyY2giPiA8aW5wdXQgY2xhc3M9InNlYXJjaC1maWVsZCIgdHlwZT0idGV4dCIgZGF0YS1iaW5kaW5nPSJ7QHZhbHVlOiBmaWx0ZXJUZXh0fXtwbGFjZWhvbGRlcjogZmlsdGVySW5wdXRQbGFjZWhvbGRlcn0iIC8+IDxkaXYgY2xhc3M9InN0YXR1cy1pbWciIGFsdD0iICIgYXJpYS1oaWRkZW49InRydWUiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBzaG93QnVzeUljb259Ij48L2Rpdj4gPGJ1dHRvbiBjbGFzcz0iY2xlYXItYnV0dG9uIiBkYXRhLWJpbmRpbmc9IntAZXZlbnQtb25jbGljazogaGFuZGxlRmlsdGVyVGV4dENsZWFyfSI+PC9idXR0b24+IDxidXR0b24gY2xhc3M9ImZpbHRlci1idXR0b24iIGRhdGEtYmluZGluZz0ie0BldmVudC1vbmNsaWNrOiBoYW5kbGVGaWx0ZXJCdXR0b25DbGlja317QHRleHQ6IGZpbHRlckJ1dHRvblRleHR9Ij48L2J1dHRvbj4gPC9kaXY+IDwvZGl2PiA=");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/ui/components/Forms/AutoCompleteBoxFormItemView.html","html","PGRpdiBjbGFzcz0iYXV0b2NvbXBsZXRlLWlubmVyIj4gPGxhYmVsIGRhdGEtYmluZGluZz0ie2ZvcjogYXR0YWNoZWRfY29udHJvbElkfSIgY2xhc3M9IiBmb3JtLWxhYmVsIj4gPHNwYW4gZGF0YS1iaW5kaW5nPSJ7QHNvdXJjZTogbGFiZWx9e0B2aXNpYmxlOiBsYWJlbH0iPiA8c3BhbiBkYXRhLWJpbmRpbmc9IntAdGVtcGxhdGUtZm9yOiBsYWJlbH17QHRleHQ6IHRleHR9Ij48L3NwYW4+IDwvc3Bhbj4gPHNwYW4gY2xhc3M9ImluZGljYXRvciIgZGF0YS1iaW5kaW5nPSJ7QHZpc2libGU6IGF0dGFjaGVkX3Nob3dJbmRpY2F0b3J9Ij4qPC9zcGFuPiA8L2xhYmVsPiA8ZGl2IGNsYXNzPSJmb3JtLWNvbnRyb2wiPiAgPGRpdiBjbGFzcz0iYXV0b2NvbXBsZXRlLWlucHV0Ij4gPGRpdiBjbGFzcz0ibG9hZGVyIiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogaXNCdXN5fSI+PC9kaXY+IDxpbnB1dCB0eXBlPSJ0ZXh0IiBkYXRhLWJpbmRpbmc9IntAdmFyOiB0ZXh0RWxlbWVudH17QGV2ZW50LW9ua2V5dXA6IGhhbmRsZUtleUV2ZW50fXtAZXZlbnQtb25ibHVyOiBoYW5kbGVJbnB1dEJsdXJFdmVudH17QGV2ZW50LW9uY2xpY2s6IGhhbmRsZUlucHV0Q2xpY2tFdmVudH17QGV2ZW50LW9uZm9jdXM6IGhhbmRsZUlucHV0Rm9jdXNFdmVudH17QHZhbHVlOiB0ZXh0fXtAc3R5bGUtd2lkdGg6IHRleHRib3hXaWR0aH17dGl0bGU6IHRvb2xUaXB9e2lkOiBhdHRhY2hlZF9jb250cm9sSWR9e2RhdGEtZ2N4LWZvcm0taXRlbTogaXRlbUlEfSIgLz4gPC9kaXY+ICA8ZGl2IGNsYXNzPSJhdXRvY29tcGxldGUtbWVudSIgZGF0YS1iaW5kaW5nPSJ7QHZhcjogZHJvcERvd25Db250YWluZXJFbGVtZW50fXtAdmlzaWJsZTogaXNEcm9wRG93bk9wZW59e0BzdHlsZS1taW5XaWR0aDogdGV4dGJveFdpZHRofXtAZXZlbnQtb25rZXlkb3duOiBoYW5kbGVEcm9wZG93bktleURvd259e0BldmVudC1vbm1vdXNlZG93bjogaGFuZGxlRHJvcGRvd25Gb2N1c0V2ZW50fXtAZXZlbnQtb25mb2N1czogaGFuZGxlRHJvcGRvd25Gb2N1c0V2ZW50fXtAZXZlbnQtb25ibHVyOiBoYW5kbGVEcm9wZG93bkJsdXJFdmVudH0iPiA8dWwgY2xhc3M9Imxpc3QtbWVudSIgZGF0YS1iaW5kaW5nPSJ7QHZhcjogZHJvcERvd25MaXN0RWxlbWVudH17QHZpc2libGU6IGRhdGFJdGVtc317QHNvdXJjZTogZGF0YUl0ZW1zfSI+IDxsaSBjbGFzcz0ibGlzdC1tZW51LWl0ZW0iIGRhdGEtYmluZGluZz0ie0B0ZW1wbGF0ZS1mb3I6IGRhdGFJdGVtc317QHRleHQ6IHZhbHVlfXtAZXZlbnQtb25jbGljazogaGFuZGxlQ2xpY2tJdGVtfSI+PC9saT4gPC91bD4gPC9kaXY+IDwvZGl2PiA8L2Rpdj4g");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/ui/components/Forms/CheckBoxFormItemView.html","html","PGRpdiBjbGFzcz0iY2hlY2tib3gtaW5uZXIiPiA8dGFibGU+IDx0cj4gPHRkIGNsYXNzPSJmb3JtLWxhYmVsIGxlZnQiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBhdHRhY2hlZF90ZXh0T25MZWZ0fSI+IDxsYWJlbCBkYXRhLWJpbmRpbmc9Intmb3I6IGF0dGFjaGVkX2NvbnRyb2xJZH17QHRleHQ6IGF0dGFjaGVkX2xhYmVsVGV4dH17dGl0bGU6IHRvb2xUaXB9Ij48L2xhYmVsPiA8L3RkPiA8dGQ+IDxpbnB1dCB0eXBlPSJjaGVja2JveCIgZGF0YS1iaW5kaW5nPSJ7QHZhbHVlOiBjaGVja2VkfXtpZDogYXR0YWNoZWRfY29udHJvbElkfXt0aXRsZTogdG9vbFRpcH17ZGF0YS1nY3gtZm9ybS1pdGVtOiBpdGVtSUR9IiAvPiA8L3RkPiA8dGQgY2xhc3M9ImZvcm0tbGFiZWwgbGVmdCIgZGF0YS1iaW5kaW5nPSJ7QGhpZGRlbjogYXR0YWNoZWRfdGV4dE9uTGVmdH0iPiA8bGFiZWwgZGF0YS1iaW5kaW5nPSJ7Zm9yOiBhdHRhY2hlZF9jb250cm9sSWR9e0B0ZXh0OiBhdHRhY2hlZF9sYWJlbFRleHR9e3RpdGxlOiB0b29sVGlwfSI+PC9sYWJlbD4gPC90ZD4gPC90cj4gPC90YWJsZT4gPC9kaXY+IA==");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/ui/components/Forms/ComboBoxFormItemView.html","html","PGRpdiBjbGFzcz0iaW5uZXIiPiA8bGFiZWwgZGF0YS1iaW5kaW5nPSJ7Zm9yOiBhdHRhY2hlZF9jb250cm9sSWR9IiBjbGFzcz0iIGZvcm0tbGFiZWwiPiA8c3BhbiBkYXRhLWJpbmRpbmc9IntAc291cmNlOiBsYWJlbH17QHZpc2libGU6IGxhYmVsfSI+IDxzcGFuIGRhdGEtYmluZGluZz0ie0B0ZW1wbGF0ZS1mb3I6IGxhYmVsfXtAdGV4dDogdGV4dH0iPjwvc3Bhbj4gPC9zcGFuPiA8c3BhbiBjbGFzcz0iaW5kaWNhdG9yIiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogYXR0YWNoZWRfc2hvd0luZGljYXRvcn0iPio8L3NwYW4+IDwvbGFiZWw+IDxkaXYgY2xhc3M9ImZvcm0tY29udHJvbCI+IDxkaXYgY2xhc3M9ImxvYWRlciIgZGF0YS1iaW5kaW5nPSJ7QHZpc2libGU6IGlzQnVzeX0iPjwvZGl2PiA8c2VsZWN0IGRhdGEtYmluZGluZz0ie2lkOiBhdHRhY2hlZF9jb250cm9sSWR9e0Bzb3VyY2U6IGRhdGFJdGVtc317QHZhbHVlOiBzZWxlY3RlZH17QGV2ZW50LW9uY2hhbmdlOiBoYW5kbGVTZWxlY3Rpb25DaGFuZ2VkfXtkaXNhYmxlZDogaXNCdXN5fXt0aXRsZTogdG9vbFRpcH17ZGF0YS1nY3gtZm9ybS1pdGVtOiBpdGVtSUR9Ij4gPG9wdGlvbiBkYXRhLWJpbmRpbmc9IntAdGVtcGxhdGUtZm9yOiBkYXRhSXRlbXN9e0B0ZXh0OiBkaXNwbGF5fXtAYXR0YWNoOiBAY29udGV4dH0iPjwvb3B0aW9uPiA8L3NlbGVjdD4gPC9kaXY+IDwvZGl2PiA=");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/ui/components/Forms/ContainerFormItemView.html","html","PGRpdiBjbGFzcz0iZm9ybS1jb250YWluZXIiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBpc1Zpc2libGV9e0BjbGFzcy1mb3JtLWhvcml6b250YWw6IGF0dGFjaGVkX2lzSG9yaXpvbnRhbH17ZGF0YS1nY3gtZm9ybS1pdGVtOiBpdGVtSUR9Ij4gPHAgY2xhc3M9ImZvcm0taXRlbSBmb3JtLWRlc2MiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBkZXNjcmlwdGlvbn17aW5uZXJIVE1MOiBkZXNjcmlwdGlvbn0iPjwvcD4gPGRpdiBjbGFzcz0iZm9ybSBsYWJlbC1sZWZ0IiBkYXRhLWJpbmRpbmc9IntzdHlsZTogYXR0YWNoZWRfc3R5bGV9e0BzdHlsZS1tYXhXaWR0aDogbWF4V2lkdGh9e0Bzb3VyY2U6IGZvcm1JdGVtc317QHRlbXBsYXRlOiBNYXBwaW5nL2luZnJhc3RydWN0dXJlL3VpL2NvbXBvbmVudHMvRm9ybXMvRm9ybUl0ZW1WaWV3Lmh0bWx9Ij48L2Rpdj4gPC9kaXY+IA==");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/ui/components/Forms/DatePickerFormItemView.html","html","PGRpdiBjbGFzcz0iaW5uZXIiPiA8bGFiZWwgZGF0YS1iaW5kaW5nPSJ7Zm9yOiBhdHRhY2hlZF9jb250cm9sSWR9IiBjbGFzcz0iIGZvcm0tbGFiZWwiPiA8c3BhbiBkYXRhLWJpbmRpbmc9IntAc291cmNlOiBsYWJlbH17QHZpc2libGU6IGxhYmVsfSI+IDxzcGFuIGRhdGEtYmluZGluZz0ie0B0ZW1wbGF0ZS1mb3I6IGxhYmVsfXtAdGV4dDogdGV4dH0iPjwvc3Bhbj4gPC9zcGFuPiA8c3BhbiBjbGFzcz0iaW5kaWNhdG9yIiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogYXR0YWNoZWRfc2hvd0luZGljYXRvcn0iPio8L3NwYW4+IDwvbGFiZWw+IDxkaXYgY2xhc3M9ImZvcm0tY29udHJvbCIgZGF0YS1iaW5kaW5nPSJ7ZGF0YS1nY3gtZm9ybS1pdGVtOiBpdGVtSUR9Ij4gIDxkaXYgY2xhc3M9ImlubGluZS1ibG9jayIgZGF0YS1iaW5kaW5nPSJ7QHNvdXJjZTogQGNvbnRleHR9e0B0ZW1wbGF0ZS1zZWxlY3RvcjogYXR0YWNoZWRfcGlja2VyVHlwZX0iPiAgPGlucHV0IGNsYXNzPSJkYXRlLXRpbWUiIGRhdGEtYmluZGluZz0ie2lkOiBhdHRhY2hlZF9jb250cm9sSWR9e0B2YXI6IG5hdGl2ZV9kYXRldGltZV9lbGVtZW50fXtAdGVtcGxhdGUtc2VsZWN0OiBuYXRpdmVfZGF0ZXRpbWV9e3RpdGxlOiB0b29sVGlwfXtAdmFsdWU6IGRhdGV9IiB0eXBlPSJkYXRldGltZSIgLz4gIDxkaXYgY2xhc3M9ImRhdGUtcGlja2VyLWNvbnRhaW5lciIgZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLXNlbGVjdDogalF1ZXJ5fSI+IDxpbnB1dCBkYXRhLWJpbmRpbmc9IntpZDogYXR0YWNoZWRfY29udHJvbElkfXtAdmFyOiBqUXVlcnlGb3JtYXR0ZWRJbnB1dH17dGl0bGU6IHRvb2xUaXB9e0BldmVudC1vbmNoYW5nZTogaGFuZGxlSnF1ZXJ5RGF0ZVBpY2tlclRleHRDaGFuZ2VkfSIgdHlwZT0idGV4dCIgY2xhc3M9Imhhc0RhdGVwaWNrZXIgZ2N4RGF0ZXBpY2tlciIvPiA8aW5wdXQgZGF0YS1iaW5kaW5nPSJ7aWQ6IGF0dGFjaGVkX2NvbnRyb2xJZH17QHZhcjogalF1ZXJ5UGlja2VyfSIgdHlwZT0iaGlkZGVuIiAvPiA8YnV0dG9uIGNsYXNzPSJ1aS1kYXRlcGlja2VyLXRyaWdnZXIiIGRhdGEtYmluZGluZz0ie0BldmVudC1vbmNsaWNrOiBoYW5kbGVKcXVlcnlEYXRlUGlja2VySW5pdGlhbGl6ZUNsaWNrfXthcmlhLWxhYmVsOiBAbGFuZ3VhZ2UtYWNjZXNzaWJpbGl0eS1kYXRlcGlja2VyLXRyaWdnZXItYnV0dG9uLWFyaWEtbGFiZWx9Ij4uLi48L2J1dHRvbj4gPC9kaXY+ICA8aW5wdXQgZGF0YS1iaW5kaW5nPSJ7aWQ6IGF0dGFjaGVkX2NvbnRyb2xJZH17QHZhcjogbmF0aXZlX2RhdGV0aW1lX2VsZW1lbnR9e0B0ZW1wbGF0ZS1zZWxlY3Q6IG5hdGl2ZX17dGl0bGU6IHRvb2xUaXB9e0B2YWx1ZTogZGF0ZX0iIHR5cGU9ImRhdGUiIC8+ICA8ZGl2IGNsYXNzPSJkYXRlLXBpY2tlci1jb250YWluZXIiIGRhdGEtYmluZGluZz0ie0B0ZW1wbGF0ZS1zZWxlY3Q6IG5hdGl2ZV9kYXRlX2pRdWVyeV90aW1lfXt0aXRsZTogdG9vbFRpcH0iPiA8aW5wdXQgZGF0YS1iaW5kaW5nPSJ7aWQ6IGF0dGFjaGVkX2NvbnRyb2xJZH17QHZhbHVlOiBkYXRlfSIgdHlwZT0iZGF0ZSIgLz4gPGlucHV0IGRhdGEtYmluZGluZz0ie2lkOiBhdHRhY2hlZF9jb250cm9sSWR9e0B2YXI6IGpRdWVyeUZvcm1hdHRlZElucHV0fXt0aXRsZTogdG9vbFRpcH17QGV2ZW50LW9uY2hhbmdlOiBoYW5kbGVKcXVlcnlUaW1lUGlja2VyVGV4dENoYW5nZWR9IiB0eXBlPSJ0ZXh0IiBjbGFzcz0iaGFzRGF0ZXBpY2tlciBnY3hEYXRlcGlja2VyIi8+IDxpbnB1dCBkYXRhLWJpbmRpbmc9IntpZDogYXR0YWNoZWRfY29udHJvbElkfXtAdmFyOiBqUXVlcnlQaWNrZXJ9IiB0eXBlPSJoaWRkZW4iIC8+IDxidXR0b24gY2xhc3M9InVpLWRhdGVwaWNrZXItdHJpZ2dlciIgZGF0YS1iaW5kaW5nPSJ7QGV2ZW50LW9uY2xpY2s6IGhhbmRsZUpxdWVyeURhdGVQaWNrZXJJbml0aWFsaXplQ2xpY2t9e2FyaWEtbGFiZWw6IEBsYW5ndWFnZS1hY2Nlc3NpYmlsaXR5LWRhdGVwaWNrZXItdHJpZ2dlci1idXR0b24tYXJpYS1sYWJlbH0iPi4uLjwvYnV0dG9uPiA8L2Rpdj4gIDxkaXYgY2xhc3M9ImRhdGV0aW1lLXNlbGVjdCBkYXRldGltZS1waWNrZXIiIGRhdGEtYmluZGluZz0ie0B0ZW1wbGF0ZS1zZWxlY3Q6IG5hdGl2ZV9kYXRlX2NvbWJvX3RpbWV9e3RpdGxlOiB0b29sVGlwfSI+IDxzcGFuIGNsYXNzPSJuYXRpdmUtZGF0ZS1waWNrZXIiPiA8aW5wdXQgZGF0YS1iaW5kaW5nPSJ7aWQ6IGF0dGFjaGVkX2NvbnRyb2xJZH17QHZhcjogbmF0aXZlX2RhdGV0aW1lX2VsZW1lbnR9e0B2YWx1ZTogZGF0ZX0iIHR5cGU9ImRhdGUiIC8+IDwvc3Bhbj4gPHNwYW4gY2xhc3M9InRpbWUtc2VsZWN0b3JzIj4gPGxhYmVsIGNsYXNzPSJ0aW1lLXNlbGVjdCI+IDxzcGFuIGNsYXNzPSJ0aW1lLXNlbGVjdC1sYWJlbCIgZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IEBsYW5ndWFnZS1ob3Vycy1hYmJyfSI+PC9zcGFuPiA8c2VsZWN0IGRhdGEtYmluZGluZz0ie2lkOiBhdHRhY2hlZF9jb250cm9sSWR9e0Bzb3VyY2U6IGF0dGFjaGVkX2hvdXJzfXtAdmFsdWU6IGF0dGFjaGVkX2hvdXJ9e0BldmVudC1vbmNoYW5nZTogaGFuZGxlQ2hhbmdlQ29tYm9Cb3hUaW1lV2l0aE5hdGl2ZURhdGV9e0B2YXI6IHNlbGVjdDB9Ij4gPG9wdGlvbiBkYXRhLWJpbmRpbmc9IntAdGVtcGxhdGUtZm9yOiBhdHRhY2hlZF9ob3Vyc317QGF0dGFjaGVkLXZhbHVlOiB2YWx9e0B0ZXh0OiBkZXNjfSI+PC9vcHRpb24+IDwvc2VsZWN0PiA8L2xhYmVsPiA8bGFiZWwgY2xhc3M9InRpbWUtc2VsZWN0Ij4gPHNwYW4gY2xhc3M9InRpbWUtc2VsZWN0LWxhYmVsIiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLW1pbnV0ZXMtYWJicn0iPjwvc3Bhbj4gPHNlbGVjdCBkYXRhLWJpbmRpbmc9IntpZDogYXR0YWNoZWRfY29udHJvbElkfXtAc291cmNlOiBhdHRhY2hlZF9taW51dGVzfXtAdmFsdWU6IGF0dGFjaGVkX21pbnV0ZX17QGV2ZW50LW9uY2hhbmdlOiBoYW5kbGVDaGFuZ2VDb21ib0JveFRpbWVXaXRoTmF0aXZlRGF0ZX17QHZhcjogc2VsZWN0MX0iPiA8b3B0aW9uIGRhdGEtYmluZGluZz0ie0B0ZW1wbGF0ZS1mb3I6IGF0dGFjaGVkX21pbnV0ZXN9e0B0ZXh0OiBAY29udGV4dH17QGF0dGFjaGVkLXZhbHVlOiBAY29udGV4dH0iPjwvb3B0aW9uPiA8L3NlbGVjdD4gPC9sYWJlbD4gPGxhYmVsIGNsYXNzPSJ0aW1lLXNlbGVjdCI+IDxzcGFuIGNsYXNzPSJ0aW1lLXNlbGVjdC1sYWJlbCIgZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IEBsYW5ndWFnZS1zZWNvbmRzLWFiYnJ9Ij48L3NwYW4+IDxzZWxlY3QgZGF0YS1iaW5kaW5nPSJ7aWQ6IGF0dGFjaGVkX2NvbnRyb2xJZH17QHNvdXJjZTogYXR0YWNoZWRfc2Vjb25kc317QHZhbHVlOiBhdHRhY2hlZF9zZWNvbmR9e0BldmVudC1vbmNoYW5nZTogaGFuZGxlQ2hhbmdlQ29tYm9Cb3hUaW1lV2l0aE5hdGl2ZURhdGV9e0B2YXI6IHNlbGVjdDJ9Ij4gPG9wdGlvbiBkYXRhLWJpbmRpbmc9IntAdGVtcGxhdGUtZm9yOiBhdHRhY2hlZF9zZWNvbmRzfXtAdGV4dDogQGNvbnRleHR9e0BhdHRhY2hlZC12YWx1ZTogQGNvbnRleHR9Ij48L29wdGlvbj4gPC9zZWxlY3Q+IDwvbGFiZWw+IDwvc3Bhbj4gPC9kaXY+ICA8ZGl2IGNsYXNzPSJkYXRldGltZS1zZWxlY3QiIGRhdGEtYmluZGluZz0ie0B0ZW1wbGF0ZS1zZWxlY3Q6IGNvbWJvc317dGl0bGU6IHRvb2xUaXB9Ij4gPHNlbGVjdCBjbGFzcz0iZHAteXkiIGRhdGEtYmluZGluZz0ie2lkOiBhdHRhY2hlZF9jb250cm9sSWR9e0Bzb3VyY2U6IGF0dGFjaGVkX3llYXJzfXtAdmFsdWU6IGF0dGFjaGVkX3llYXJ9e0BldmVudC1vbmNoYW5nZTogaGFuZGxlQ2hhbmdlQ29tYm9Cb3hUaW1lfXtAdmFyOiBzZWxlY3QzfSI+IDxvcHRpb24gZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLWZvcjogYXR0YWNoZWRfeWVhcnN9e0B0ZXh0OiBAY29udGV4dH17QGF0dGFjaGVkLXZhbHVlOiBAY29udGV4dH0iPjwvb3B0aW9uPiA8L3NlbGVjdD4gPHNlbGVjdCBjbGFzcz0iZHAtbW0iIGRhdGEtYmluZGluZz0ie0B2YWx1ZTogYXR0YWNoZWRfbW9udGh9e0BldmVudC1vbmNoYW5nZTogaGFuZGxlQ2hhbmdlQ29tYm9Cb3hUaW1lfXtAdmFyOiBzZWxlY3Q0fSI+IDxvcHRpb24gdmFsdWU9IjAiIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBAbGFuZ3VhZ2UtbW9udGhzLTB9Ij48L29wdGlvbj4gPG9wdGlvbiB2YWx1ZT0iMSIgZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IEBsYW5ndWFnZS1tb250aHMtMX0iPjwvb3B0aW9uPiA8b3B0aW9uIHZhbHVlPSIyIiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLW1vbnRocy0yfSI+PC9vcHRpb24+IDxvcHRpb24gdmFsdWU9IjMiIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBAbGFuZ3VhZ2UtbW9udGhzLTN9Ij48L29wdGlvbj4gPG9wdGlvbiB2YWx1ZT0iNCIgZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IEBsYW5ndWFnZS1tb250aHMtNH0iPjwvb3B0aW9uPiA8b3B0aW9uIHZhbHVlPSI1IiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLW1vbnRocy01fSI+PC9vcHRpb24+IDxvcHRpb24gdmFsdWU9IjYiIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBAbGFuZ3VhZ2UtbW9udGhzLTZ9Ij48L29wdGlvbj4gPG9wdGlvbiB2YWx1ZT0iNyIgZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IEBsYW5ndWFnZS1tb250aHMtN30iPjwvb3B0aW9uPiA8b3B0aW9uIHZhbHVlPSI4IiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLW1vbnRocy04fSI+PC9vcHRpb24+IDxvcHRpb24gdmFsdWU9IjkiIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBAbGFuZ3VhZ2UtbW9udGhzLTl9Ij48L29wdGlvbj4gPG9wdGlvbiB2YWx1ZT0iMTAiIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBAbGFuZ3VhZ2UtbW9udGhzLTEwfSI+PC9vcHRpb24+IDxvcHRpb24gdmFsdWU9IjExIiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLW1vbnRocy0xMX0iPjwvb3B0aW9uPiA8L3NlbGVjdD4gPHNlbGVjdCBjbGFzcz0iZHAtZGQiIGRhdGEtYmluZGluZz0ie0Bzb3VyY2U6IGF0dGFjaGVkX2RheXN9e0B2YWx1ZTogYXR0YWNoZWRfZGF5fXtAZXZlbnQtb25jaGFuZ2U6IGhhbmRsZUNoYW5nZUNvbWJvQm94VGltZX17QHZhcjogc2VsZWN0NX0iPiA8b3B0aW9uIGRhdGEtYmluZGluZz0ie0B0ZW1wbGF0ZS1mb3I6IGF0dGFjaGVkX2RheXN9e0B0ZXh0OiBAY29udGV4dH17QGF0dGFjaGVkLXZhbHVlOiBAY29udGV4dH0iPjwvb3B0aW9uPiA8L3NlbGVjdD4gPC9kaXY+ICA8ZGl2IGNsYXNzPSJkcC10cC1zZWxlY3QiIGRhdGEtYmluZGluZz0ie0B0ZW1wbGF0ZS1zZWxlY3Q6IGNvbWJvc19kYXRldGltZX17dGl0bGU6IHRvb2xUaXB9Ij4gPGRpdiBjbGFzcz0iZGF0ZXRpbWUtc2VsZWN0Ij4gPHNlbGVjdCBjbGFzcz0ieWVhci1zZWxlY3QiIGRhdGEtYmluZGluZz0ie2lkOiBhdHRhY2hlZF9jb250cm9sSWR9e0Bzb3VyY2U6IGF0dGFjaGVkX3llYXJzfXtAdmFsdWU6IGF0dGFjaGVkX3llYXJ9e0BldmVudC1vbmNoYW5nZTogaGFuZGxlQ2hhbmdlQ29tYm9Cb3hUaW1lfXtAdmFyOiBzZWxlY3Q2fSI+IDxvcHRpb24gZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLWZvcjogYXR0YWNoZWRfeWVhcnN9e0B0ZXh0OiBAY29udGV4dH17QGF0dGFjaGVkLXZhbHVlOiBAY29udGV4dH0iPjwvb3B0aW9uPiA8L3NlbGVjdD4gPHNlbGVjdCBjbGFzcz0ibW9udGgtc2VsZWN0IiBkYXRhLWJpbmRpbmc9IntpZDogYXR0YWNoZWRfY29udHJvbElkfXtAdmFsdWU6IGF0dGFjaGVkX21vbnRofXtAZXZlbnQtb25jaGFuZ2U6IGhhbmRsZUNoYW5nZUNvbWJvQm94VGltZX17QHZhcjogc2VsZWN0N30iPiA8b3B0aW9uIHZhbHVlPSIwIiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLW1vbnRocy0wfSI+PC9vcHRpb24+IDxvcHRpb24gdmFsdWU9IjEiIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBAbGFuZ3VhZ2UtbW9udGhzLTF9Ij48L29wdGlvbj4gPG9wdGlvbiB2YWx1ZT0iMiIgZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IEBsYW5ndWFnZS1tb250aHMtMn0iPjwvb3B0aW9uPiA8b3B0aW9uIHZhbHVlPSIzIiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLW1vbnRocy0zfSI+PC9vcHRpb24+IDxvcHRpb24gdmFsdWU9IjQiIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBAbGFuZ3VhZ2UtbW9udGhzLTR9Ij48L29wdGlvbj4gPG9wdGlvbiB2YWx1ZT0iNSIgZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IEBsYW5ndWFnZS1tb250aHMtNX0iPjwvb3B0aW9uPiA8b3B0aW9uIHZhbHVlPSI2IiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLW1vbnRocy02fSI+PC9vcHRpb24+IDxvcHRpb24gdmFsdWU9IjciIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBAbGFuZ3VhZ2UtbW9udGhzLTd9Ij48L29wdGlvbj4gPG9wdGlvbiB2YWx1ZT0iOCIgZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IEBsYW5ndWFnZS1tb250aHMtOH0iPjwvb3B0aW9uPiA8b3B0aW9uIHZhbHVlPSI5IiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLW1vbnRocy05fSI+PC9vcHRpb24+IDxvcHRpb24gdmFsdWU9IjEwIiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLW1vbnRocy0xMH0iPjwvb3B0aW9uPiA8b3B0aW9uIHZhbHVlPSIxMSIgZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IEBsYW5ndWFnZS1tb250aHMtMTF9Ij48L29wdGlvbj4gPC9zZWxlY3Q+IDxzZWxlY3QgY2xhc3M9ImRheS1zZWxlY3QiIGRhdGEtYmluZGluZz0ie0Bzb3VyY2U6IGF0dGFjaGVkX2RheXN9e0B2YWx1ZTogYXR0YWNoZWRfZGF5fXtAZXZlbnQtb25jaGFuZ2U6IGhhbmRsZUNoYW5nZUNvbWJvQm94VGltZX17QHZhcjogc2VsZWN0OH0iPiA8b3B0aW9uIGRhdGEtYmluZGluZz0ie0B0ZW1wbGF0ZS1mb3I6IGF0dGFjaGVkX2RheXN9e0B0ZXh0OiBAY29udGV4dH17QGF0dGFjaGVkLXZhbHVlOiBAY29udGV4dH0iPjwvb3B0aW9uPiA8L3NlbGVjdD4gPC9kaXY+IDxkaXYgY2xhc3M9ImRhdGV0aW1lLXNlbGVjdCB0aW1lIj4gPGxhYmVsIGNsYXNzPSJ0aW1lLXNlbGVjdCI+IDxzcGFuIGNsYXNzPSJ0aW1lLXNlbGVjdC1sYWJlbCIgZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IEBsYW5ndWFnZS1ob3Vycy1hYmJyfSI+PC9zcGFuPiA8c2VsZWN0IGRhdGEtYmluZGluZz0ie2lkOiBhdHRhY2hlZF9jb250cm9sSWR9e0Bzb3VyY2U6IGF0dGFjaGVkX2hvdXJzfXtAdmFsdWU6IGF0dGFjaGVkX2hvdXJ9e0BldmVudC1vbmNoYW5nZTogaGFuZGxlQ2hhbmdlQ29tYm9Cb3hUaW1lfXtAdmFyOiBzZWxlY3Q5fSI+IDxvcHRpb24gZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLWZvcjogYXR0YWNoZWRfaG91cnN9e0BhdHRhY2hlZC12YWx1ZTogdmFsfXtAdGV4dDogZGVzY30iPjwvb3B0aW9uPiA8L3NlbGVjdD4gPC9sYWJlbD4gPGxhYmVsIGNsYXNzPSJ0aW1lLXNlbGVjdCI+IDxzcGFuIGNsYXNzPSJ0aW1lLXNlbGVjdC1sYWJlbCIgZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IEBsYW5ndWFnZS1taW51dGVzLWFiYnJ9Ij48L3NwYW4+IDxzZWxlY3QgZGF0YS1iaW5kaW5nPSJ7QHNvdXJjZTogYXR0YWNoZWRfbWludXRlc317QHZhbHVlOiBhdHRhY2hlZF9taW51dGV9e0BldmVudC1vbmNoYW5nZTogaGFuZGxlQ2hhbmdlQ29tYm9Cb3hUaW1lfXtAdmFyOiBzZWxlY3QxMH0iPiA8b3B0aW9uIGRhdGEtYmluZGluZz0ie0B0ZW1wbGF0ZS1mb3I6IGF0dGFjaGVkX21pbnV0ZXN9e0B0ZXh0OiBAY29udGV4dH17QGF0dGFjaGVkLXZhbHVlOiBAY29udGV4dH0iPjwvb3B0aW9uPiA8L3NlbGVjdD4gPC9sYWJlbD4gPGxhYmVsIGNsYXNzPSJ0aW1lLXNlbGVjdCI+IDxzcGFuIGNsYXNzPSJ0aW1lLXNlbGVjdC1sYWJlbCIgZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IEBsYW5ndWFnZS1zZWNvbmRzLWFiYnJ9Ij48L3NwYW4+IDxzZWxlY3QgZGF0YS1iaW5kaW5nPSJ7QHNvdXJjZTogYXR0YWNoZWRfc2Vjb25kc317QHZhbHVlOiBhdHRhY2hlZF9zZWNvbmR9e0BldmVudC1vbmNoYW5nZTogaGFuZGxlQ2hhbmdlQ29tYm9Cb3hUaW1lfXtAdmFyOiBzZWxlY3QxMX0iPiA8b3B0aW9uIGRhdGEtYmluZGluZz0ie0B0ZW1wbGF0ZS1mb3I6IGF0dGFjaGVkX3NlY29uZHN9e0B0ZXh0OiBAY29udGV4dH17QGF0dGFjaGVkLXZhbHVlOiBAY29udGV4dH0iPjwvb3B0aW9uPiA8L3NlbGVjdD4gPC9sYWJlbD4gPC9kaXY+IDwvZGl2PiA8L2Rpdj4gPGRpdiBjbGFzcz0iaW5saW5lLWJsb2NrIiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogbnVsbGFibGV9Ij4gPGJ1dHRvbiBjbGFzcz0iZGF0ZXRpbWUtYnRuIHVuLW51bGxpZnkiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBhdHRhY2hlZF9pc051bGx9e0BldmVudC1vbmNsaWNrOiBoYW5kbGVDbGlja1NldE5vdE51bGx9Ij48L2J1dHRvbj4gPGJ1dHRvbiBjbGFzcz0iZGF0ZXRpbWUtYnRuIG51bGxpZnkiIGRhdGEtYmluZGluZz0ie0BoaWRkZW46IGF0dGFjaGVkX2lzTnVsbH17QGV2ZW50LW9uY2xpY2s6IGhhbmRsZUNsaWNrU2V0TnVsbH0iPjwvYnV0dG9uPiA8L2Rpdj4gPC9kaXY+IDwvZGl2PiA=");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/ui/components/Forms/FilePickerFormItemView.html","html","PGRpdiBjbGFzcz0iaW5uZXIiPiA8bGFiZWwgZGF0YS1iaW5kaW5nPSJ7Zm9yOiBhdHRhY2hlZF9jb250cm9sSWR9IiBjbGFzcz0iZm9ybS1sYWJlbCI+IDxzcGFuIGRhdGEtYmluZGluZz0ie0Bzb3VyY2U6IGxhYmVsfXtAdmlzaWJsZTogbGFiZWx9Ij4gPHNwYW4gZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLWZvcjogbGFiZWx9e0B0ZXh0OiB0ZXh0fSI+PC9zcGFuPiA8L3NwYW4+IDxzcGFuIGNsYXNzPSJpbmRpY2F0b3IiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBhdHRhY2hlZF9zaG93SW5kaWNhdG9yfSI+Kjwvc3Bhbj4gPC9sYWJlbD4gPGRpdiBjbGFzcz0iZm9ybS1jb250cm9sIj4gPGRpdiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogaXNTdXBwb3J0ZWR9Ij4gPGRpdiBjbGFzcz0iZmlsZS1pbnB1dCI+IDxkaXYgY2xhc3M9ImZpbGUtaW5wdXQtYnJvd3NlciI+IDxpbnB1dCB0eXBlPSJmaWxlIiBkYXRhLWJpbmRpbmc9IntpZDogYXR0YWNoZWRfY29udHJvbElkfXtAdmlzaWJsZTogaXNTdXBwb3J0ZWR9e3RpdGxlOiB0b29sVGlwfXttdWx0aXBsZTogYWxsb3dNdWx0aXBsZX17YWNjZXB0OiBhY2NlcHRGaWxlVHlwZXN9e0BldmVudC1jaGFuZ2U6IGhhbmRsZUNoYW5nZX17ZGF0YS1nY3gtZm9ybS1pdGVtOiBpdGVtSUR9IiAvPiA8L2Rpdj4gPC9kaXY+IDxpbnB1dCBjbGFzcz0iZmlsZS1pbnB1dC1jbGVhciIgdHlwZT0iYnV0dG9uIiB2YWx1ZT0iWCIgZGF0YS1iaW5kaW5nPSJ7QHZpc2libGU6IGZpbGVzfXtAZXZlbnQtb25jbGljazogaGFuZGxlQ2xlYXJDbGlja30iIC8+IDwvZGl2PiA8c3BhbiBkYXRhLWJpbmRpbmc9IntAaGlkZGVuOiBpc1N1cHBvcnRlZH17QHRleHQ6IEBsYW5ndWFnZS1maWxlLXBpY2tlci1ub3Qtc3VwcG9ydGVkfSI+PC9zcGFuPiA8L2Rpdj4gPC9kaXY+IA==");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/ui/components/Forms/FormItemView.html","html","PGRpdiBjbGFzcz0iZm9ybS1pdGVtIiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogaXNWaXNpYmxlfXtjbGFzc05hbWU6IGF0dGFjaGVkX2luZGljYXRvckNsYXNzfXtAc291cmNlOiBAY29udGV4dH17QHRlbXBsYXRlLXNlbGVjdG9yOiBmb3JtSXRlbVR5cGV9Ij4gPGRpdiBjbGFzcz0iYXV0b2NvbXBsZXRlIiBkYXRhLWJpbmRpbmc9IntAdGVtcGxhdGUtc2VsZWN0OiBBdXRvQ29tcGxldGVCb3hGb3JtSXRlbX17QHdpZGdldDogQXV0b0NvbXBsZXRlQm94Rm9ybUl0ZW19e0B2aXNpYmxlOiBpc1Zpc2libGV9Ij48L2Rpdj4gPGRpdiBjbGFzcz0iY2hlY2tib3giIGRhdGEtYmluZGluZz0ie0B0ZW1wbGF0ZS1zZWxlY3Q6IENoZWNrQm94Rm9ybUl0ZW19e0B3aWRnZXQ6IENoZWNrQm94Rm9ybUl0ZW19e0B2aXNpYmxlOiBpc1Zpc2libGV9Ij48L2Rpdj4gPGRpdiBjbGFzcz0iY29tYm9ib3giIGRhdGEtYmluZGluZz0ie0B0ZW1wbGF0ZS1zZWxlY3Q6IENvbWJvQm94Rm9ybUl0ZW19e0B3aWRnZXQ6IENvbWJvQm94Rm9ybUl0ZW19e0B2aXNpYmxlOiBpc1Zpc2libGV9Ij48L2Rpdj4gPGRpdiBjbGFzcz0iY29udGFpbmVyIiBkYXRhLWJpbmRpbmc9IntAdGVtcGxhdGUtc2VsZWN0OiBDb250YWluZXJGb3JtSXRlbX17QHdpZGdldDogQ29udGFpbmVyRm9ybUl0ZW19e0B2aXNpYmxlOiBpc1Zpc2libGV9Ij48L2Rpdj4gPGRpdiBjbGFzcz0iZGF0ZXBpY2tlciIgZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLXNlbGVjdDogRGF0ZVBpY2tlckZvcm1JdGVtfXtAd2lkZ2V0OiBEYXRlUGlja2VyRm9ybUl0ZW19e0B2aXNpYmxlOiBpc1Zpc2libGV9Ij48L2Rpdj4gPGRpdiBjbGFzcz0iZmlsZXBpY2tlciIgZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLXNlbGVjdDogRmlsZVBpY2tlckZvcm1JdGVtfXtAd2lkZ2V0OiBGaWxlUGlja2VyRm9ybUl0ZW19e0B2aXNpYmxlOiBpc1Zpc2libGV9Ij48L2Rpdj4gPGRpdiBjbGFzcz0iZ3JvdXBib3giIGRhdGEtYmluZGluZz0ie0B0ZW1wbGF0ZS1zZWxlY3Q6IEdyb3VwQm94Rm9ybUl0ZW19e0B3aWRnZXQ6IEdyb3VwQm94Rm9ybUl0ZW19e0B2aXNpYmxlOiBpc1Zpc2libGV9Ij48L2Rpdj4gPGRpdiBjbGFzcz0ibGluayIgZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLXNlbGVjdDogSHlwZXJsaW5rRm9ybUl0ZW19e0B3aWRnZXQ6IEh5cGVybGlua0Zvcm1JdGVtfXtAdmlzaWJsZTogaXNWaXNpYmxlfSI+PC9kaXY+IDxkaXYgY2xhc3M9ImltYWdlIiBkYXRhLWJpbmRpbmc9IntAdGVtcGxhdGUtc2VsZWN0OiBJbWFnZUZvcm1JdGVtfXtAd2lkZ2V0OiBJbWFnZUZvcm1JdGVtfXtAdmlzaWJsZTogaXNWaXNpYmxlfSI+PC9kaXY+IDxkaXYgY2xhc3M9ImxhYmVsIiBkYXRhLWJpbmRpbmc9IntAdGVtcGxhdGUtc2VsZWN0OiBMYWJlbEZvcm1JdGVtfXtAd2lkZ2V0OiBMYWJlbEZvcm1JdGVtfXtAdmlzaWJsZTogaXNWaXNpYmxlfSI+PC9kaXY+IDxkaXYgY2xhc3M9Imxpc3Rib3giIGRhdGEtYmluZGluZz0ie0B0ZW1wbGF0ZS1zZWxlY3Q6IExpc3RCb3hGb3JtSXRlbX17QHdpZGdldDogTGlzdEJveEZvcm1JdGVtfXtAdmlzaWJsZTogaXNWaXNpYmxlfSI+PC9kaXY+IDxkaXYgY2xhc3M9Im1hcmtkb3duIiBkYXRhLWJpbmRpbmc9IntAdGVtcGxhdGUtc2VsZWN0OiBNYXJrZG93bkZvcm1JdGVtfXtAd2lkZ2V0OiBNYXJrZG93bkZvcm1JdGVtfXtAdmlzaWJsZTogaXNWaXNpYmxlfSI+PC9kaXY+IDxkaXYgY2xhc3M9InJhZGlvYnRuIiBkYXRhLWJpbmRpbmc9IntAdGVtcGxhdGUtc2VsZWN0OiBSYWRpb0J1dHRvbkZvcm1JdGVtfXtAd2lkZ2V0OiBSYWRpb0J1dHRvbkZvcm1JdGVtfXtAdmlzaWJsZTogaXNWaXNpYmxlfSI+PC9kaXY+IDxkaXYgY2xhc3M9InRleHRhcmVhIiBkYXRhLWJpbmRpbmc9IntAdGVtcGxhdGUtc2VsZWN0OiBUZXh0QXJlYUZvcm1JdGVtfXtAd2lkZ2V0OiBUZXh0QXJlYUZvcm1JdGVtfXtAdmlzaWJsZTogaXNWaXNpYmxlfSI+PC9kaXY+IDxkaXYgY2xhc3M9InRleHRib3giIGRhdGEtYmluZGluZz0ie0B0ZW1wbGF0ZS1zZWxlY3Q6IFRleHRCb3hGb3JtSXRlbX17QHdpZGdldDogVGV4dEJveEZvcm1JdGVtfXtAdmlzaWJsZTogaXNWaXNpYmxlfSI+PC9kaXY+IDxkaXYgY2xhc3M9InRleHRhcmVhIiBkYXRhLWJpbmRpbmc9IntAdGVtcGxhdGUtc2VsZWN0OiBUaW1lUGlja2VyRm9ybUl0ZW19e0B3aWRnZXQ6IFRpbWVQaWNrZXJGb3JtSXRlbX17QHZpc2libGU6IGlzVmlzaWJsZX0iPjwvZGl2PiA8L2Rpdj4g");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/ui/components/Forms/GroupBoxFormItemView.html","html","PGZpZWxkc2V0IGRhdGEtYmluZGluZz0ie2RhdGEtZ2N4LWZvcm0taXRlbTogaXRlbUlEfSI+IDxsZWdlbmQgZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IGhlYWRlcn0iPjwvbGVnZW5kPiA8cCBjbGFzcz0iZm9ybS1pdGVtIGZvcm0tZGVzYyIgZGF0YS1iaW5kaW5nPSJ7QHZpc2libGU6IGRlc2NyaXB0aW9ufXtpbm5lckhUTUw6IGRlc2NyaXB0aW9ufSI+PC9wPiAgPGRpdiBjbGFzcz0iZm9ybSBsYWJlbC1sZWZ0IiBkYXRhLWJpbmRpbmc9IntzdHlsZTogYXR0YWNoZWRfc3R5bGV9e0BjbGFzcy1mb3JtLWhvcml6b250YWw6IGF0dGFjaGVkX2lzSG9yaXpvbnRhbH17QHNvdXJjZTogZm9ybUl0ZW1zfXtAdGVtcGxhdGU6IE1hcHBpbmcvaW5mcmFzdHJ1Y3R1cmUvdWkvY29tcG9uZW50cy9Gb3Jtcy9Gb3JtSXRlbVZpZXcuaHRtbH0iPjwvZGl2PiA8L2ZpZWxkc2V0PiA=");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/ui/components/Forms/HyperlinkFormItemView.html","html","PGRpdiBjbGFzcz0iaHlwZXJsaW5rIj4gPGEgZGF0YS1iaW5kaW5nPSJ7QGV2ZW50LW9uY2xpY2s6IGhhbmRsZUNsaWNrfXtocmVmOiB1cml9e0B0ZXh0OiBoeXBlcmxpbmtUZXh0fXt0YXJnZXQ6dGFyZ2V0fXt0aXRsZTogdG9vbFRpcH17ZGF0YS1nY3gtZm9ybS1pdGVtOiBpdGVtSUR9Ij48L2E+IDwvZGl2PiA=");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/ui/components/Forms/ImageFormItemView.html","html","PGRpdiBjbGFzcz0iaW5uZXIiPiA8aW1nIGRhdGEtYmluZGluZz0ie3NyYzogc291cmNlfXtAc3R5bGUtd2lkdGg6IHdpZHRofXtAc3R5bGUtaGVpZ2h0OiBoZWlnaHR9e2FsdDogdG9vbFRpcH17ZGF0YS1nY3gtZm9ybS1pdGVtOiBpdGVtSUR9IiAvPiA8L2Rpdj4g");geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/ui/components/Forms/ListBoxFormItemView.html","html","PGRpdiBjbGFzcz0iaW5uZXIiPiA8bGFiZWwgZGF0YS1iaW5kaW5nPSJ7Zm9yOiBhdHRhY2hlZF9jb250cm9sSWR9IiBjbGFzcz0iZm9ybS1sYWJlbCI+IDxzcGFuIGRhdGEtYmluZGluZz0ie0Bzb3VyY2U6IGxhYmVsfXtAdmlzaWJsZTogbGFiZWx9Ij4gPHNwYW4gZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLWZvcjogbGFiZWx9e0B0ZXh0OiB0ZXh0fSI+PC9zcGFuPiA8L3NwYW4+IDxzcGFuIGNsYXNzPSJpbmRpY2F0b3IiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBhdHRhY2hlZF9zaG93SW5kaWNhdG9yfSI+Kjwvc3Bhbj4gPC9sYWJlbD4gPGRpdiBjbGFzcz0iZm9ybS1jb250cm9sIj4gPGRpdiBjbGFzcz0ibG9hZGVyIiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogaXNCdXN5fSI+PC9kaXY+IDxzZWxlY3QgZGF0YS1iaW5kaW5nPSJ7aWQ6IGF0dGFjaGVkX2NvbnRyb2xJZH17QHNvdXJjZTogZGF0YUl0ZW1zfXtAdmFyOiBzZWxlY3RFbGVtZW50fXttdWx0aXBsZTogYXR0YWNoZWRfaXNNdWx0aXBsZX17QHZhbHVlOiBzZWxlY3Rpb259e0BldmVudC1vbmNoYW5nZTogaGFuZGxlU2VsZWN0aW9uQ2hhbmdlZH17dGl0bGU6IHRvb2xUaXB9e2Rpc2FibGVkOiBpc0J1c3l9e3NpemU6IHNpemV9e2RhdGEtZ2N4LWZvcm0taXRlbTogaXRlbUlEfSI+IDxvcHRpb24gZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLWZvcjogZGF0YUl0ZW1zfXtAdGV4dDogZGlzcGxheX17QGF0dGFjaDogQGNvbnRleHR9Ij48L29wdGlvbj4gPC9zZWxlY3Q+IDwvZGl2PiA8L2Rpdj4g");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/ui/components/Forms/MarkdownFormItemView.html","html","PGRpdiBjbGFzcz0iaW5uZXIiIGRhdGEtYmluZGluZz0ie0B2YXI6IG1hcmtkb3duRWxlbWVudH17ZGF0YS1nY3gtZm9ybS1pdGVtOiBpdGVtSUR9Ij48L2Rpdj4g");geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/ui/components/Forms/RadioButtonFormItemView.html","html","PGRpdiBjbGFzcz0icmFkaW9idG4taW5uZXIiPiA8dGFibGU+IDx0cj4gPHRkIGNsYXNzPSJmb3JtLWxhYmVsIGxlZnQiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBhdHRhY2hlZF90ZXh0T25MZWZ0fSI+IDxsYWJlbCBkYXRhLWJpbmRpbmc9Intmb3I6IGF0dGFjaGVkX2NvbnRyb2xJZH17QHRleHQ6IGF0dGFjaGVkX2xhYmVsVGV4dH17dGl0bGU6IHRvb2xUaXB9Ij48L2xhYmVsPiA8L3RkPiA8dGQ+IDxpbnB1dCB0eXBlPSJyYWRpbyIgZGF0YS1iaW5kaW5nPSJ7QHZhcjogcmFkaW9FbGVtZW50fXtpZDogYXR0YWNoZWRfY29udHJvbElkfXtuYW1lOiBncm91cE5hbWV9e3RpdGxlOiB0b29sVGlwfXtkYXRhLWdjeC1mb3JtLWl0ZW06IGl0ZW1JRH0iIC8+IDwvdGQ+IDx0ZCBjbGFzcz0iZm9ybS1sYWJlbCByaWdodCIgZGF0YS1iaW5kaW5nPSJ7QGhpZGRlbjogYXR0YWNoZWRfdGV4dE9uTGVmdH0iPiA8bGFiZWwgZGF0YS1iaW5kaW5nPSJ7Zm9yOiBhdHRhY2hlZF9jb250cm9sSWR9e0B0ZXh0OiBhdHRhY2hlZF9sYWJlbFRleHR9e3RpdGxlOiB0b29sVGlwfSI+PC9sYWJlbD4gPC90ZD4gPC90cj4gPC90YWJsZT4gPC9kaXY+IA==");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/ui/components/Forms/TextAreaFormItemView.html","html","PGRpdiBjbGFzcz0iaW5uZXIiPiA8bGFiZWwgZGF0YS1iaW5kaW5nPSJ7Zm9yOiBhdHRhY2hlZF9jb250cm9sSWR9IiBjbGFzcz0iZm9ybS1sYWJlbCI+IDxzcGFuIGRhdGEtYmluZGluZz0ie0Bzb3VyY2U6IGxhYmVsfXtAdmlzaWJsZTogbGFiZWx9Ij4gPHNwYW4gZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLWZvcjogbGFiZWx9e0B0ZXh0OiB0ZXh0fSI+PC9zcGFuPiA8L3NwYW4+IDxzcGFuIGNsYXNzPSJpbmRpY2F0b3IiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBhdHRhY2hlZF9zaG93SW5kaWNhdG9yfSI+Kjwvc3Bhbj4gPC9sYWJlbD4gPGRpdiBjbGFzcz0iZm9ybS1jb250cm9sIj4gPHRleHRhcmVhIGRhdGEtYmluZGluZz0ie2lkOiBhdHRhY2hlZF9jb250cm9sSWR9e0B2YWx1ZTogdGV4dH17QHN0eWxlLXdpZHRoOiB0ZXh0Ym94V2lkdGh9e0BzdHlsZS1oZWlnaHQ6IHRleHRib3hIZWlnaHR9e3RpdGxlOiB0b29sVGlwfXtAZXZlbnQtb25ibHVyOiBoYW5kbGVCbHVyQ29udHJvbH17cmVhZG9ubHk6IHJlYWRPbmx5fXtkYXRhLWdjeC1mb3JtLWl0ZW06IGl0ZW1JRH0iPjwvdGV4dGFyZWE+IDwvZGl2PiA8L2Rpdj4g");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/ui/components/Forms/TextBoxFormItemView.html","html","PGRpdiBjbGFzcz0iaW5uZXIiPiA8bGFiZWwgZGF0YS1iaW5kaW5nPSJ7Zm9yOiBhdHRhY2hlZF9jb250cm9sSWR9IiBjbGFzcz0iZm9ybS1sYWJlbCI+IDxzcGFuIGRhdGEtYmluZGluZz0ie0Bzb3VyY2U6IGxhYmVsfXtAdmlzaWJsZTogbGFiZWx9Ij4gPHNwYW4gZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLWZvcjogbGFiZWx9e0B0ZXh0OiB0ZXh0fSI+PC9zcGFuPiA8L3NwYW4+IDxzcGFuIGNsYXNzPSJpbmRpY2F0b3IiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBhdHRhY2hlZF9zaG93SW5kaWNhdG9yfSI+Kjwvc3Bhbj4gPC9sYWJlbD4gPGRpdiBjbGFzcz0iZm9ybS1jb250cm9sIj4gPGlucHV0IGRhdGEtYmluZGluZz0ie2lkOiBhdHRhY2hlZF9jb250cm9sSWR9e3R5cGU6IGF0dGFjaGVkX3R5cGV9e0B2YWx1ZTogdGV4dH17QHN0eWxlLXdpZHRoOiB0ZXh0Ym94V2lkdGh9e3RpdGxlOiB0b29sVGlwfXtyZWFkb25seTogcmVhZE9ubHl9e2RhdGEtZ2N4LWZvcm0taXRlbTogaXRlbUlEfSIgLz4gPC9kaXY+IDwvZGl2PiA=");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/ui/components/Forms/TimePickerFormItemView.html","html","PGRpdiBjbGFzcz0iZm9ybS1pdGVtIHRpbWUtcGlja2VyIj4gPGxhYmVsIGRhdGEtYmluZGluZz0ie2ZvcjogYXR0YWNoZWRfY29udHJvbElkfSIgY2xhc3M9ImZvcm0tbGFiZWwiPiA8c3BhbiBkYXRhLWJpbmRpbmc9IntAc291cmNlOiBsYWJlbH17QHZpc2libGU6IGxhYmVsfSI+IDxzcGFuIGRhdGEtYmluZGluZz0ie0B0ZW1wbGF0ZS1mb3I6IGxhYmVsfXtAdGV4dDogdGV4dH0iPjwvc3Bhbj4gPC9zcGFuPiA8c3BhbiBjbGFzcz0iaW5kaWNhdG9yIiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogYXR0YWNoZWRfc2hvd0luZGljYXRvcn0iPio8L3NwYW4+IDwvbGFiZWw+IDxkaXYgY2xhc3M9ImRhdGV0aW1lLXNlbGVjdCBpbmxpbmUtYmxvY2siIGRhdGEtYmluZGluZz0ie3RpdGxlOiB0b29sVGlwfXtAdmFyOiBzZWxlY3RDb250YWluZXJFbGVtZW50fXtkYXRhLWdjeC1mb3JtLWl0ZW06IGl0ZW1JRH0iPiA8ZGl2PiA8c2VsZWN0IGRhdGEtYmluZGluZz0ie2lkOiBhdHRhY2hlZF9jb250cm9sSWR9e0Bzb3VyY2U6IGF0dGFjaGVkX2hvdXJzfXtAdmFsdWU6IGF0dGFjaGVkX2hvdXJ9e0BldmVudC1vbmNoYW5nZTogaGFuZGxlQ2hhbmdlQ29tYm9Cb3hUaW1lfSI+IDxvcHRpb24gZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLWZvcjogYXR0YWNoZWRfaG91cnN9e0BhdHRhY2hlZC12YWx1ZTogdmFsfXtAdGV4dDogZGVzY30iPjwvb3B0aW9uPiA8L3NlbGVjdD4gPHNlbGVjdCBkYXRhLWJpbmRpbmc9IntAc291cmNlOiBhdHRhY2hlZF9taW51dGVzfXtAdmFsdWU6IGF0dGFjaGVkX21pbnV0ZX17QGV2ZW50LW9uY2hhbmdlOiBoYW5kbGVDaGFuZ2VDb21ib0JveFRpbWV9Ij4gPG9wdGlvbiBkYXRhLWJpbmRpbmc9IntAdGVtcGxhdGUtZm9yOiBhdHRhY2hlZF9taW51dGVzfXtAdGV4dDogQGNvbnRleHR9e0BhdHRhY2hlZC12YWx1ZTogQGNvbnRleHR9Ij48L29wdGlvbj4gPC9zZWxlY3Q+IDxzZWxlY3QgZGF0YS1iaW5kaW5nPSJ7QHNvdXJjZTogYXR0YWNoZWRfc2Vjb25kc317QHZhbHVlOiBhdHRhY2hlZF9zZWNvbmR9e0BldmVudC1vbmNoYW5nZTogaGFuZGxlQ2hhbmdlQ29tYm9Cb3hUaW1lfSI+IDxvcHRpb24gZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLWZvcjogYXR0YWNoZWRfc2Vjb25kc317QHRleHQ6IEBjb250ZXh0fXtAYXR0YWNoZWQtdmFsdWU6IEBjb250ZXh0fSI+PC9vcHRpb24+IDwvc2VsZWN0PiA8L2Rpdj4gPGRpdiBjbGFzcz0iaW5saW5lLWJsb2NrIiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogbnVsbGFibGV9Ij4gPGJ1dHRvbiBjbGFzcz0iZGF0ZXRpbWUtYnRuIHVuLW51bGxpZnkiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBhdHRhY2hlZF90aW1lSXNOdWxsfXtAZXZlbnQtb25jbGljazogaGFuZGxlQ2xpY2tTZXROb3ROdWxsfSI+PC9idXR0b24+IDxidXR0b24gY2xhc3M9ImRhdGV0aW1lLWJ0biBudWxsaWZ5IiBkYXRhLWJpbmRpbmc9IntAaGlkZGVuOiBhdHRhY2hlZF90aW1lSXNOdWxsfXtAZXZlbnQtb25jbGljazogaGFuZGxlQ2xpY2tTZXROdWxsfSI+PC9idXR0b24+IDwvZGl2PiA8L2Rpdj4gPGRpdiBjbGFzcz0iY2xlYXIiPjwvZGl2PiA8L2Rpdj4g");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/ui/components/NumericInput/NumericInputWidget.html","html","PHNwYW4gZGF0YS1iaW5kaW5nPSJ7QHNvdXJjZTogcmFuZ2V9e0B2aXNpYmxlOiBzaG93U2xpZGVyfSIgY2xhc3M9ImdjeC1zbGlkZXItd2lkdGgiPiA8aW5wdXQgdHlwZT0ibnVtYmVyIiBkYXRhLWJpbmRpbmc9IntAdGVtcGxhdGUtZm9yOiByYW5nZX17QHZhcjogbnVtZXJpY0lucHV0fXttaW46IG1pbn17bWF4OiBtYXh9e3ZhbHVlOiB2YWx1ZX17c3RlcDogc3RlcH0iIC8+IDwvc3Bhbj4gPHNwYW4gY2xhc3M9ImlubGluZS1ibG9jayIgZGF0YS1iaW5kaW5nPSJ7QHNvdXJjZTogcmFuZ2V9Ij4gPGlucHV0IHR5cGU9Im51bWJlciIgZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLWZvcjogcmFuZ2V9e0B2YXI6IG5hdGl2ZUlucHV0fXttaW46IG1pbn17bWF4OiBtYXh9e0B2YWx1ZTogdmFsdWV9e3N0ZXA6IHN0ZXB9e0BldmVudC1vbmNoYW5nZTogdmFsaWRhdGVJbnB1dH0iIC8+IDwvc3Bhbj4g");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/ui/components/PagingControls/PagingControlsView.html","html","PGRpdiBjbGFzcz0icGFnaW5nLWNvbnRyb2wiIGRhdGEtYmluZGluZz0ie0Bzb3VyY2U6IHByZXNlbnRhYmxlUmVzdWx0c30iPiA8ZGl2IGNsYXNzPSJwYWdpbmctY29udHJvbC1pbm5lciIgZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLWZvcjogcHJlc2VudGFibGVSZXN1bHRzfSI+IDxkaXYgY2xhc3M9InBhZ2luZy1yZXN1bHQtaW5mbyI+IDxzcGFuIGRhdGEtYmluZGluZz0ie0BoaWRkZW46IG51bWJlck9mSXRlbXN9e0B0ZXh0OiBAbGFuZ3VhZ2UtY29tbW9uLW5vLXJlc3VsdHN9Ij48L3NwYW4+IDxzcGFuIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBudW1iZXJPZkl0ZW1zfSI+IDxzcGFuIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBAbGFuZ3VhZ2UtcGFnZS1kaXNwbGF5aW5nfSI+PC9zcGFuPiZuYnNwOzxzcGFuIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBjdXJySW5kZXhTdGFydEZyb21PbmV9Ij48L3NwYW4+Jm5ic3A7LSZuYnNwOzxzcGFuIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBjdXJySW5kZXhFbmR9Ij48L3NwYW4+Jm5ic3A7KDxzcGFuIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBAbGFuZ3VhZ2UtcGFnZS10b3RhbH0iPjwvc3Bhbj46Jm5ic3A7PHNwYW4gZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IG51bWJlck9mSXRlbXN9Ij48L3NwYW4+KSA8L3NwYW4+IDwvZGl2PiA8ZGl2IGNsYXNzPSJwYWdpbmctYnV0dG9ucyIgZGF0YS1iaW5kaW5nPSJ7QHZpc2libGU6IG51bWJlck9mSXRlbXN9Ij4gPGJ1dHRvbiBjbGFzcz0iZmlyc3QiIGRhdGEtYmluZGluZz0ie0BldmVudC1vbmNsaWNrOiBoYW5kbGVQYWdlRmlyc3R9e3RpdGxlOiBAbGFuZ3VhZ2UtcGFnZS1maXJzdH0iPjxpbWcgc3JjPSJSZXNvdXJjZXMvSW1hZ2VzL0ljb25zL3BhZ2luZy1jb250cm9sLWZpcnN0LTQ0LnBuZyIgYWx0PSIgIiAvPjwvYnV0dG9uPiA8YnV0dG9uIGNsYXNzPSJwcmV2IiBkYXRhLWJpbmRpbmc9IntAZXZlbnQtb25jbGljazogaGFuZGxlUGFnZVByZXZ9e3RpdGxlOiBAbGFuZ3VhZ2UtcGFnZS1wcmV2fSI+PGltZyBzcmM9IlJlc291cmNlcy9JbWFnZXMvSWNvbnMvcGFnaW5nLWNvbnRyb2wtcHJldmlvdXMtNDQucG5nIiBhbHQ9IiAiIC8+PC9idXR0b24+IDxzcGFuIGNsYXNzPSJwYWdpbmctYnV0dG9ucy1pbmZvIiB0YWJpbmRleD0iMCI+IDxzcGFuIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBAbGFuZ3VhZ2UtcGFnZS1wYWdlfSI+PC9zcGFuPiZuYnNwOzxzcGFuIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBjdXJyUGFnZU51bWJlcn0iPjwvc3Bhbj4mbmJzcDs8c3BhbiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXBhZ2Utb2Z9Ij48L3NwYW4+Jm5ic3A7PHNwYW4gZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IGxhc3RQYWdlTnVtYmVyfSI+PC9zcGFuPiA8L3NwYW4+IDxidXR0b24gY2xhc3M9Im5leHQiIGRhdGEtYmluZGluZz0ie0BldmVudC1vbmNsaWNrOiBoYW5kbGVQYWdlTmV4dH17dGl0bGU6IEBsYW5ndWFnZS1wYWdlLW5leHR9Ij48aW1nIHNyYz0iUmVzb3VyY2VzL0ltYWdlcy9JY29ucy9wYWdpbmctY29udHJvbC1uZXh0LTQ0LnBuZyIgYWx0PSIgIiAvPjwvYnV0dG9uPiA8YnV0dG9uIGNsYXNzPSJsYXN0IiBkYXRhLWJpbmRpbmc9IntAZXZlbnQtb25jbGljazogaGFuZGxlUGFnZUxhc3R9e3RpdGxlOiBAbGFuZ3VhZ2UtcGFnZS1sYXN0fSI+PGltZyBzcmM9IlJlc291cmNlcy9JbWFnZXMvSWNvbnMvcGFnaW5nLWNvbnRyb2wtbGFzdC00NC5wbmciIGFsdD0iICIgLz48L2J1dHRvbj4gPC9kaXY+IDwvZGl2PiA8L2Rpdj4g");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/ui/components/Slider/SliderView.html","html","PGRpdiBjbGFzcz0iZ2N4LXNsaWRlci1jb250YWluZXIiPiA8ZGl2IGNsYXNzPSJnY3gtc2xpZGVyLWN1cnJlbnQtbGFiZWwtY29udGFpbmVyIj4gPGRpdiBjbGFzcz0iZ2N4LXNsaWRlci1sYWJlbCBnY3gtc2xpZGVyLWxhYmVsLWN1cnJlbnQtbWluIiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogc2xpZGVyTWluSGFuZGxlTGFiZWx9e0B2YXI6IHNsaWRlck1pbkxhYmVsRWxlbWVudH17QHRleHQ6IHNsaWRlck1pbkhhbmRsZUxhYmVsfSI+PC9kaXY+IDxkaXYgY2xhc3M9ImdjeC1zbGlkZXItbGFiZWwgZ2N4LXNsaWRlci1sYWJlbC1jdXJyZW50LW1heCIgZGF0YS1iaW5kaW5nPSJ7QHZpc2libGU6IHNsaWRlck1heEhhbmRsZUxhYmVsfXtAdmFyOiBzbGlkZXJNYXhMYWJlbEVsZW1lbnR9e0B0ZXh0OiBzbGlkZXJNYXhIYW5kbGVMYWJlbH0iPjwvZGl2PiA8L2Rpdj4gPGRpdiBjbGFzcz0iZ2N4LXNsaWRlci1yYW5nZS1jb250YWluZXIiPiA8ZGl2IGNsYXNzPSJnY3gtc2xpZGVyLXRpY2tzIiBkYXRhLWJpbmRpbmc9IntAc291cmNlOiBzbGlkZXJUaWNrc30iPiA8ZGl2IGNsYXNzPSJnY3gtdGljayIgZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLWZvcjogc2xpZGVyVGlja3N9e0BzdHlsZS1sZWZ0OiBwb3NpdGlvbn0iPjwvZGl2PiA8L2Rpdj4gPGRpdiBjbGFzcz0iZ2N4LXNsaWRlciIgZGF0YS1iaW5kaW5nPSJ7QHZhcjogc2xpZGVyRWxlbWVudH0iPjwvZGl2PiA8L2Rpdj4gPGRpdiBjbGFzcz0iZ2N4LXNsaWRlci1sYWJlbC1jb250YWluZXIiPiA8c3BhbiBjbGFzcz0iZ2N4LXNsaWRlci1sYWJlbCBnY3gtc2xpZGVyLWxhYmVsLW1pbiIgZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IHNsaWRlck1pbkxhYmVsfSI+PC9zcGFuPiA8c3BhbiBjbGFzcz0iZ2N4LXNsaWRlci1sYWJlbCBnY3gtc2xpZGVyLWxhYmVsLW1heCIgZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IHNsaWRlck1heExhYmVsfSI+PC9zcGFuPiA8L2Rpdj4gPC9kaXY+IA==");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/ui/components/SmartPanel/SmartPanelView.html","html","PGRpdiBjbGFzcz0idmlldy1jb250YWluZXItdmlldyBzbWFydC1wYW5lbCIgZGF0YS1iaW5kaW5nPSJ7QHZhcjogY29udGFpbmVyRWxlbWVudH0iPiAgPGJ1dHRvbiBjbGFzcz0iYm90dG9tLXBhbmVsLXJlc2l6ZSByZXNpemUtaGFuZGxlIiB0YWJpbmRleD0iLTEiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiByZXNpemVZfXtAZXZlbnQtbW91c2Vkb3duOiBoYW5kbGVIZWFkZXJNb3VzZURvd259e0BldmVudC10b3VjaHN0YXJ0OiBoYW5kbGVIZWFkZXJUb3VjaFN0YXJ0fXt0aXRsZTogQGxhbmd1YWdlLXNtYXJ0LXBhbmVsLXJlc2l6ZX0iPiA8c3BhbiBjbGFzcz0iaWNvbi1kcmFnIj48L3NwYW4+IDwvYnV0dG9uPiA8ZGl2IGNsYXNzPSJwYW5lbC1oZWFkZXIgYmFubmVyLW5vc2VsZWN0IiAgZGF0YS1iaW5kaW5nPSJ7QHZpc2libGU6IGhlYWRlcklzVmlzaWJsZX17QHZhcjogaGVhZGVyRWxlbWVudH17QGV2ZW50LW1vdXNlZG93bjogaGFuZGxlSGVhZGVyTW91c2VEb3dufQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtAZXZlbnQtdG91Y2hzdGFydDogaGFuZGxlSGVhZGVyVG91Y2hTdGFydH17QGNsYXNzLXJlc2l6ZS1ob3Jpem9udGFsLWhpbnQ6IHJlc2l6ZVh9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge0BjbGFzcy1yZXNpemUtdmVydGljYWwtaGludDogcmVzaXplWX0iPiA8ZGl2IGNsYXNzPSJwYW5lbC1oZWFkZXItY29udGVudHMiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiB0aXRsZUJhcklzVmlzaWJsZX0iPiA8YnV0dG9uIGNsYXNzPSJwYW5lbC1oZWFkZXItYnV0dG9uIHJpZ2h0IGNsb3NlLTE2IiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogc2hvd2luZ1hCdXR0b259e0BldmVudC1vbmNsaWNrOiBoYW5kbGVDbGlja0Nsb3NlfXt0aXRsZTogQGxhbmd1YWdlLXNtYXJ0LXBhbmVsLWNsb3NlfSI+PC9idXR0b24+IDxidXR0b24gY2xhc3M9InBhbmVsLWhlYWRlci1idXR0b24gcmlnaHQiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBzaG93aW5nTWF4aW1pemVCdXR0b259e0BjbGFzcy1taW5pbWl6ZS0xNjogcGFuZWxNYXhpbWl6ZWR9e0Bub2NsYXNzLW1heGltaXplLTE2OiBwYW5lbE1heGltaXplZH17QGV2ZW50LW9uY2xpY2s6IGhhbmRsZU1heGltaXplVG9nZ2xlQ2xpY2t9e3RpdGxlOiBAbGFuZ3VhZ2Utc21hcnQtcGFuZWwtbWF4aW1pemUtcmVzdG9yZX0iPjwvYnV0dG9uPiA8YnV0dG9uIGNsYXNzPSJwYW5lbC1oZWFkZXItYnV0dG9uIG1lbnUtYnV0dG9uIiBkYXRhLWJpbmRpbmc9IntAZW5hYmxlZDogaGFzRXhlY3V0YWJsZU1lbnVJdGVtc317QHZpc2libGU6IGhhc0hvaXN0ZWRNZW51fXtAZXZlbnQtb25jbGljazogaGFuZGxlVGFwTWVudUJ1dHRvbn17QHZhcjogbWVudUJ1dHRvbkVsZW1lbnR9e3RpdGxlOiBAbGFuZ3VhZ2Utc21hcnQtcGFuZWwtbWVudX0iPjwvYnV0dG9uPiA8YnV0dG9uIGNsYXNzPSJwYW5lbC1oZWFkZXItYnV0dG9uIGxlZnQgYmFjay0xNiIgZGF0YS1iaW5kaW5nPSJ7QHZpc2libGU6IHNob3dpbmdCYWNrQnV0dG9ufXtAZXZlbnQtY2xpY2s6IGhhbmRsZUNsaWNrQmFja317dGl0bGU6IEBsYW5ndWFnZS1zbWFydC1wYW5lbC1iYWNrfSI+PC9idXR0b24+IDxoMiBjbGFzcz0icGFuZWwtdGl0bGUgYmFubmVyLW5vc2VsZWN0Ij4gPGltZyBzcmM9IlJlc291cmNlcy9JbWFnZXMvbG9hZGVyLXNtYWxsLmdpZiIgZGF0YS1iaW5kaW5nPSJ7QHZpc2libGU6IHNob3dCdXN5SW5kaWNhdG9yfSIgYWx0PSIgIiAvPiA8c3BhbiBjbGFzcz0icGFuZWwtdGl0bGUtY29udGVudHMiIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBjb250YWluZXJUaXRsZX17QHZpc2libGU6IGNvbnRhaW5lclRpdGxlfSI+PC9zcGFuPiA8c3BhbiBjbGFzcz0icGFuZWwtdGl0bGUtY29udGVudHMiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBjb250YWluZXJUaXRsZX0iPiZuYnNwOy0mbmJzcDs8L3NwYW4+IDxzcGFuIGNsYXNzPSJwYW5lbC10aXRsZS1jb250ZW50cyIgZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IHZpZXdUaXRsZX17QHZpc2libGU6IHZpZXdUaXRsZX17dGl0bGU6IHZpZXdUaXRsZX0iPjwvc3Bhbj4gPC9oMj4gPC9kaXY+IDxkaXYgY2xhc3M9InNtYXJ0LXBhbmVsLWhvaXN0ZWQtbWVudS1pbmxpbmUiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBpbmxpbmVNZW51SXNPcGVufXtAd2lkZ2V0OiBTbWFydFBhbmVsSG9pc3RlZE1lbnV9e0B3aWRnZXQtcmVxdWlyZWQ6IGZhbHNlfXtAd2lkZ2V0LWNvbnRleHQ6IGhvaXN0ZWRNZW51Vmlld01vZGVsfSI+PC9kaXY+IDxkaXYgZGF0YS1iaW5kaW5nPSJ7QGRvbTogaGVhZGVySW5zZXJ0RG9tRWxlbWVudH0iPjwvZGl2PiA8L2Rpdj4gICA8ZGl2IGNsYXNzPSJyZWdpb24gcGFuZWwtc3RhdHVzLXJlZ2lvbiIgZGF0YS1iaW5kaW5nPSJ7QHZhcjogc3RhdHVzUmVnaW9uRWxlbWVudH0iPjwvZGl2PiAgIDxkaXYgY2xhc3M9InBhbmVsLXNjcm9sbC1jb250YWluZXIiIGRhdGEtYmluZGluZz0ie2RhdGEtcmVnaW9uLW5hbWU6IHJlZ2lvbk5hbWV9e2RhdGEtcmVnaW9uLWFkYXB0ZXI6IHJlZ2lvblR5cGV9e0B2YXI6IHNjcm9sbFJlZ2lvbkVsZW1lbnR9e0BldmVudC1vbnNjcm9sbDogaGFuZGxlU2Nyb2xsQ2hhbmdlfSIgdGFiaW5kZXg9Ii0xIj48L2Rpdj4gICA8ZGl2IGNsYXNzPSJwYW5lbC1mb290ZXIiIGRhdGEtYmluZGluZz0ie0B2YXI6IGZvb3RlckVsZW1lbnR9e0B2aXNpYmxlOiBmb290ZXJJbnNlcnREb21FbGVtZW50fSIgc3R5bGU9InBvc2l0aW9uOiBhYnNvbHV0ZSI+IDxkaXYgY2xhc3M9InBhbmVsLWZvb3Rlci1pbm5lciIgZGF0YS1iaW5kaW5nPSJ7QGRvbTogZm9vdGVySW5zZXJ0RG9tRWxlbWVudH0iPjwvZGl2PiA8L2Rpdj4gIDwvZGl2PiA=");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/ui/components/Table/TableView.html","html","PGRpdiBjbGFzcz0icmVzdWx0cy10YWJsZSIgZGF0YS1iaW5kaW5nPSJ7QHZhcjogdGFibGVDb250YWluZXJFbGVtZW50fSI+IDx0YWJsZT4gPHRoZWFkPiA8dHIgZGF0YS1iaW5kaW5nPSJ7QHNvdXJjZTogY29sdW1uSGVhZGVyc30iPiA8dGggZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLWZvcjogY29sdW1uSGVhZGVyc317QHZpc2libGU6IHZpc2libGV9e0BldmVudC1vbmNsaWNrOiBoYW5kbGVDb2x1bW5IZWFkQ2xpY2t9IiBzY29wZT0iY29sIj4gPGJ1dHRvbiBkYXRhLWJpbmRpbmc9InthcmlhLWxhYmVsOiBjb2x1bW5EZXNjcmlwdG9yfSI+IDxzcGFuIGRhdGEtYmluZGluZz0ie2NsYXNzOiBzb3J0Q2xhc3N9e3RpdGxlOiBAbGFuZ3VhZ2UtcmVzdWx0cy1zb3J0fSI+PC9zcGFuPiA8c3BhbiBjbGFzcz0icmVzdWx0LWhlYWRpbmciIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBwcmVzZW50YWJsZVZhbHVlfSI+PC9zcGFuPiA8L2J1dHRvbj4gPC90aD4gPC90cj4gPC90aGVhZD4gPHRib2R5IGRhdGEtYmluZGluZz0ie0Bzb3VyY2U6IHJlY29yZHN9Ij4gPHRyIGNsYXNzPSJyZXN1bHRzLXRhYmxlLXJvdy1pdGVtIiBkYXRhLWJpbmRpbmc9IntAdGVtcGxhdGUtZm9yOiByZWNvcmRzfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge0Bzb3VyY2U6IGF0dHJpYnV0ZXN9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7QGV2ZW50LW1vdXNlZG93bjogaGFuZGxlTW91c2VEb3dufQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge0BldmVudC1tb3VzZXVwOiBoYW5kbGVNb3VzZVVwfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge0BldmVudC10b3VjaHN0YXJ0OiBoYW5kbGVUb3VjaFN0YXJ0fQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge0BldmVudC10b3VjaG1vdmU6IGhhbmRsZVRvdWNoTW92ZX0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtAZXZlbnQtdG91Y2hlbmQ6IGhhbmRsZVRvdWNoRW5kfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge0BldmVudC1jbGljazogaGFuZGxlQ2xpY2t9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7QGV2ZW50LW1vdXNlZW50ZXI6IGhhbmRsZU1vdXNlT3Zlcn0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtAZXZlbnQtbW91c2VsZWF2ZTogaGFuZGxlTW91c2VPdXR9Ij4gPHRkIGRhdGEtYmluZGluZz0ie0B0ZW1wbGF0ZS1mb3I6IGF0dHJpYnV0ZXN9e0B2aXNpYmxlOiB2aXNpYmxlfSI+IDxhIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBkaXNwbGF5QXNVcmx9e0BldmVudC1vbmNsaWNrOiBoYW5kbGVDbGlja0F0dHJpYnV0ZWxpbmt9e2hyZWY6IHZhbHVlfXtAdGV4dDogcHJlc2VudGFibGVWYWx1ZX0iIHRhcmdldD0iX2JsYW5rIj48L2E+IDxidXR0b24gZGF0YS1iaW5kaW5nPSJ7QGhpZGRlbjogZGlzcGxheUFzVXJsfXtAdGV4dDogcHJlc2VudGFibGVWYWx1ZX0iIHRhYmluZGV4PSIwIj48L2J1dHRvbj4gPC90ZD4gPC90cj4gPC90Ym9keT4gPC90YWJsZT4gPC9kaXY+IA==");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Invariant","json","eyJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXRvZ2dsZS1sb2ctdmlldyI6IkFjdGl2YXRlcyBvciBkZWFjdGl2YXRlcyBsb2cgdmlldy4iLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXN0YXJ0LWVkaXRpbmctbmV3LWZlYXR1cmUiOiJCZWdpbnMgZWRpdGluZyBhIG5ldyBmZWF0dXJlLiIsImxhbmd1YWdlLW1lbnUtZmVhdHVyZS1hY3Rpb25zLXRpdGxlIjoiRmVhdHVyZSBhY3Rpb25zLiBDbGljayB0byBvcGVuL2Nsb3NlLiIsImxhbmd1YWdlLXRvb2xiYXItaWRlbnRpZnktcG9seWxpbmUtZGVzYy1rZXlib2FyZCI6IlRvIGxlYXJuIHdoYXRcdTIwMTlzIHRoZXJlLCB1c2UgYXJyb3dzIHRvIG1vdmUgdGhlIHBvaW50LiBIaXQgRU5URVIgdG8gcGxvdCBhbmQgYmVnaW4gbW92aW5nIHRoZSBuZXh0IHBvaW50LiBIaXQgRU5URVIgdHdpY2UgdG8gZmluaXNoLiIsImxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1tYXJrZXItc3R5bGUteCI6IlgiLCJsYW5ndWFnZS1tZW51LXByb2plY3RzLWFjdGlvbnMtcmVmcmVzaC1kZXNjIjoiUmVmcmVzaCB0aGUgbGlzdCBvZiBwcm9qZWN0cy4iLCJsYW5ndWFnZS1ncmFudC1lZGl0b3Itc2VhcmNoLXBsYWNlaG9sZGVyIjoiU2VhcmNoLi4uIiwibGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLWV4Y2VlZGVkLW1heC1jbGFzc2VzLXRpdGxlIjoiRXhjZWVkZWQgbWF4aW11bSB1bmlxdWUgdmFsdWVzIiwibGFuZ3VhZ2UtbGF5ZXJsaXN0LXZpc2libGUtYXQtZXh0ZW50IjoiQ3VycmVudGx5IHdpdGhpbiB2aXNpYmxlIHNjYWxlLiIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tc2hvdy1tYXAtdGlwLXJlc3VsdHMiOiJTaG93cyBtYXAgdGlwIHJlc3VsdHMgZm9yIGEgRmVhdHVyZVNldENvbGxlY3Rpb24gcHJldmlvdXNseSBhZGRlZCB0byB0aGUgRmVhdHVyZVNldE1hbmFnZXIuIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1vcGVuLXJlc3VsdHMtZnJhbWUiOiJBY3RpdmF0ZXMgdGhlIFJlc3VsdHNSZWdpb24uIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1oaWdobGlnaHQtZmVhdHVyZS1zZXQiOiJIaWdobGlnaHRzIGFsbCBvZiB0aGUgZmVhdHVyZXMgaW4gdGhlIHNwZWNpZmllZCBmZWF0dXJlIHNldCBpbiB0aGUgYWN0aXZlIGhpZ2hsaWdodCBsYXllci4iLCJsYW5ndWFnZS1wcm9qZWN0LWVycm9yLWRlbGV0ZS1kZW5pZWQiOiJZb3UgZG8gbm90IGhhdmUgcGVybWlzc2lvbiB0byBkZWxldGUgdGhpcyBwcm9qZWN0LiIsImxhbmd1YWdlLWNvbW1vbi1tZWFzdXJlbWVudC1yZXN1bHRzLWZpZWxkLWFyZWEiOiJBcmVhIiwibGFuZ3VhZ2UtbWVudS1kcmF3LXBvaW50IjoiRHJhdyBhIFBvaW50IiwibGFuZ3VhZ2UtdG9vbGJhci10YXNrcy11cGxvYWQtZGF0YSI6IlVwbG9hZCBEYXRhIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1zaG93LXJlc3VsdHMtZmVhdHVyZS1hY3Rpb24iOiJDcmVhdGVzIFJlc3VsdHNMaXN0RmVhdHVyZUFjdGlvbnNWaWV3IGFuZCBkaXNwbGF5cyB0aGUgRmVhdHVyZSBBY3Rpb25zLiIsImxhbmd1YWdlLXRvb2xiYXItb3Blbi1jb2xsYWJvcmF0aW9uIjoiQ29sbGFib3JhdGlvbiIsImxhbmd1YWdlLXRvb2xiYXItZ3JvdXAtYWR2YW5jZWQtbWVhc3VyZW1lbnQiOiJBZHZhbmNlZCBNZWFzdXJlbWVudCIsImxhbmd1YWdlLXRvb2xiYXItY2xvc2UtdG9vbGJhciI6IkNsb3NlIHRvb2xiYXIiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXpvb20tdG8tZmVhdHVyZSI6Ilpvb21zIHRvIGEgZmVhdHVyZS4iLCJsYW5ndWFnZS1taW51dGVzLWFiYnIiOiJNIiwibGFuZ3VhZ2UtdG9vbGJhci1ncm91cC1maW5kLWRhdGEiOiJGaW5kIERhdGEiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWZlYXR1cmUtbGF5ZXItbW9kdWxlLXJlZnJlc2gtZGF0YSI6IlJlZnJlc2hlcyBsYXllciBlZGl0IHN1bW1hcmllcyBhbmQgdGhlIFwic3luYyBuZWVkZWRcIiBmbGFnLiIsImxhbmd1YWdlLXRvb2xiYXItZ3JvdXAtYW5hbHlzaXMiOiJBbmFseXNpcyIsImxhbmd1YWdlLW1lbnUtdGl0bGUiOiJJIHdhbnQgdG8uLi4iLCJsYW5ndWFnZS10b29sYmFyLXRhYi10b29scyI6IlRvb2xzIiwibGFuZ3VhZ2UtbWVudS1vZmZsaW5lLW1hcC1lZGl0b3ItZ2VvbWV0cnktYWN0aW9ucy1lbGxpcHNlLWRlc2MiOiJEcmF3IGFuIGVsbGlwc2UgZm9yIHRoZSBhcmVhIG9mIGludGVyZXN0IGdlb21ldHJ5LiIsImxhbmd1YWdlLW1lbnUtb2ZmbGluZS1tYXAtZWRpdG9yLWdlb21ldHJ5LWFjdGlvbnMtY3VycmVudGV4dGVudCI6IkN1cnJlbnQgRXh0ZW50IiwibGFuZ3VhZ2UtdG9vbGJhci1pZGVudGlmeS1zbmFwcGluZy10b29sdGlwIjoiRW5hYmxlL0Rpc2FibGUgc25hcHBpbmcgd2hpbGUgaWRlbnRpZnlpbmciLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWFkZC1tYXJrdXAiOiJBZGRzIHRoZSBnaXZlbiBnZW9tZXRyeSB0byB0aGUgbWFya3VwIGxheWVyLiIsImxhbmd1YWdlLWFjY2Vzc2liaWxpdHktZm9ybS1uYW1lZC1jb250YWluZXItc2hvd24iOiJGb3JtIGdyb3VwICd7MH0nIHNob3duLiIsImxhbmd1YWdlLW1lbnUtcmVtb3ZlLXVzZXItYWRkZWQtbWFwc2VydmljZS1kZXNjIjoiUmVtb3ZlIHRoaXMgdXNlciBhZGRlZCBzZXJ2aWNlIGZyb20gdGhlIG1hcC4iLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWhpZ2hsaWdodC1mZWF0dXJlIjoiSGlnaGxpZ2h0cyB0aGUgZmVhdHVyZSBpbiB0aGUgYWN0aXZlIGhpZ2hsaWdodCBsYXllci4iLCJsYW5ndWFnZS10b29sYmFyLWdyb3VwLW1lYXN1cmVtZW50IjoiTWVhc3VyZSIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tc3RlcC16b29tLW91dCI6Ilpvb21zIG91dCBhIHN0ZXAiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWNsZWFyLXN0b3JhZ2UtZm9yLWFwcGxpY2F0aW9uIjoiQ2xlYXJzIHRoZSBvZmZsaW5lIGRhdGEgZm9yIHRoZSBjdXJyZW50IGFwcGxpY2F0aW9uLiIsImxhbmd1YWdlLXRvb2xiYXItaWRlbnRpZnktY29tYmluZS11bmlvbi1kaXNhYmxlLXRvb2x0aXAiOiJEaXNhYmxlIGFkZGluZyByZXN1bHRzIHRvIHRoZSBleGlzdGluZyBpZGVudGlmeSByZXN1bHRzIiwibGFuZ3VhZ2UtdG9vbGJhci10YXNrcy11cGxvYWQtZGF0YS10b29sdGlwIjoiVXBsb2FkIGxheWVycyBmcm9tIHlvdXIgY29tcHV0ZXIgb250byB0aGUgbWFwIiwibGFuZ3VhZ2UtbWVudS16b29tLW91dCI6Ilpvb20gb3V0IiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1ydW4td29ya2Zsb3ctd2l0aC1hcmd1bWVudHMiOiJSdW5zIGEgd29ya2Zsb3cgd2l0aCBhIHNldCBvZiBpbnB1dCBhcmd1bWVudHMuIiwibGFuZ3VhZ2UtbGF5ZXItYWN0aW9ucy10b29sdGlwIjoiQ2xpY2sgdG8gc2VlIGxheWVyIGFjdGlvbnMgYXZhaWxhYmxlIGZvciB7MH0gbGF5ZXIiLCJsYW5ndWFnZS10b29sYmFyLW1hcmt1cC1yZWN0YW5nbGUtdG9vbHRpcCI6IkRyYXcgYSByZWN0YW5nbGUgb24gdGhlIG1hcCIsImxhbmd1YWdlLXRvb2xiYXItc25hcHBpbmctZGlzYWJsZSI6IkRpc2FibGUgU25hcHBpbmciLCJsYW5ndWFnZS1sYXllcmxpc3QtZGVmYXVsdC1mb2xkZXItdGl0bGUiOiJMYXllciBMaXN0IEZvbGRlciIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tdXBkYXRlLWZlYXR1cmUiOiJVcGRhdGVzIGVpdGhlciBhIG5ldyBvciBleGlzdGluZyBmZWF0dXJlLiIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tZnNtLWNvbGxlY3Rpb24tc2V0LWNvbW1hbmQiOiJTZXQgdGhlIHByZWZlcnJlZCBjb21tYW5kIHRvIG9wZW4gdGhlIGZlYXR1cmUgc2V0IGNvbGxlY3Rpb24gZm9yIHRoZSBnaXZlbiBzb3VyY2UgbmFtZS4iLCJsYW5ndWFnZS10b29sYmFyLXRhc2tzLXByaW50LW1hcC10b29sdGlwIjoiQ3JlYXRlIGEgcHJpbnRhYmxlIHZlcnNpb24gb2YgdGhlIG1hcCIsImxhbmd1YWdlLXRvb2xiYXItbWVudS1nbG9iYWwtc2F2ZSI6IlNhdmUiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXRvZ2dsZS1kYXRhLWZyYW1lIjoiQWN0aXZhdGVzIG9yIGRlYWN0aXZhdGVzIGRhdGEgZnJhbWUuIiwibGFuZ3VhZ2Utb2ZmbGluZS1wcm9ncmVzcy1iYXNlbWFwZG93bmxvYWQtY29tcGxldGVkIjoiezB9IGRvd25sb2FkZWQuIiwibGFuZ3VhZ2UtY29tbW9uLWRlbGV0ZSI6IkRlbGV0ZSIsImxhbmd1YWdlLW1lbnUtcmVzdWx0cy1hZGQtZmVhdHVyZS1kZXNjIjoiQWRkIHRoaXMgZmVhdHVyZSB0byB0aGUgY3VycmVudCBzZXQgb2YgcmVzdWx0cyIsImxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1saW5lLXN0eWxlLWRvdCI6IkRvdCIsImxhbmd1YWdlLW1lbnUtY29weS10by1kcmF3aW5ncy1kZXNjIjoiQ29weSB0aGlzIGZlYXR1cmUgdG8gdGhlIGRyYXdpbmcgbGF5ZXIiLCJsYW5ndWFnZS1vZmZsaW5lLXByb2dyZXNzLWJ5dGVzLXBlci1zZWNvbmQiOiJ7MH0gYnl0ZXMvcyIsImxhbmd1YWdlLXRvb2xiYXItc2hvdy1sYXllcmxpc3QtZGVzYyI6IkRpc3BsYXkgdGhlIGxpc3Qgb2YgYXZhaWxhYmxlIGxheWVycyIsImxhbmd1YWdlLW1lbnUtcmVzdWx0cy1yZW1vdmUtZmVhdHVyZSI6IlJlbW92ZSBmcm9tIFJlc3VsdHMiLCJsYW5ndWFnZS10b29sYmFyLW1hcmt1cC10ZXh0IjoiVGV4dCIsImxhbmd1YWdlLXRvb2xiYXItbWFya3VwLXBvaW50LWRlc2Mta2V5Ym9hcmQiOiJVc2UgYXJyb3dzIHRvIG1vdmUgdGhlIHBvaW50LiBIaXQgRU5URVIgdG8gYWRkIGl0IHRvIHRoZSBtYXAuIiwibGFuZ3VhZ2Utb2ZmbGluZS1lcnJvcnMtYnVuZGxlb2ZmaWxpbmUiOiJDYW5ub3QgY3JlYXRlIGEgYnVuZGxlIHdoaWxlIG9mZmxpbmUuIiwibGFuZ3VhZ2UtdG9vbGJhci1ncm91cC1lZGl0aW5nIjoiRWRpdCBEcmF3aW5ncyIsImxhbmd1YWdlLW1hcHNlcnZpY2UtYWN0aW9ucy10aXRsZSI6Ik1hcCBTZXJ2aWNlIEFjdGlvbnMiLCJsYW5ndWFnZS1tZW51LWdyb3VwZWQtcmVzdWx0cy1saXN0LWFjdGlvbnMtZGVzYyI6Ikdyb3VwZWQgUmVzdWx0cyBMaXN0IEFjdGlvbnMiLCJsYW5ndWFnZS1jb29yZGluYXRlcy1ub3J0aC1hYmJyZXYiOiJOIiwibGFuZ3VhZ2UtbWVudS1hZGQtYS1mZWF0dXJlLWRlc2MiOiJDcmVhdGUgYSBuZXcgZmVhdHVyZSBvbiB0aGlzIGxheWVyLiIsImxhbmd1YWdlLXRvb2xiYXItbWFya3VwLWVkaXQtZGVzYyI6IkNsaWNrIG9yIHRhcCBhbiBleGlzdGluZyBkcmF3aW5nIHRvIGJlZ2luIGVkaXRpbmcgaXQuIiwibGFuZ3VhZ2UtdG9vbGJhci1pZGVudGlmeS1mcmVlaGFuZCI6IkZyZWVoYW5kIiwibGFuZ3VhZ2UtY29tbW9uLWRlYWN0aXZhdGUtdG9vbCI6IkRlYWN0aXZhdGUgVG9vbCIsImxhbmd1YWdlLXRvb2xiYXItbXVsdGl0b29sIjoiTXVsdGktdG9vbCIsImxhbmd1YWdlLW1lbnUtc2hvdy1jaGFydGluZy12aWV3LWRlc2MiOiJTd2l0Y2ggdG8gY2hhcnRpbmcgdmlldyIsImxhbmd1YWdlLW1lbnUtbGFiZWwtb3B0aW9ucyI6IkN1c3RvbWl6ZSBsYWJlbHMiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWFkZC10ZXh0LW1hcmt1cCI6IlByb21wdHMgdGhlIHVzZXIgZm9yIHRleHQgdG8gYWRkIGFzIG1hcmt1cC4gV2hlbiBjb21wbGV0ZWQsIHRleHQgbWFya3VwIGlzIGFkZGVkIGF0IHRoZSBwcm92aWRlZCBnZW9tZXRyeS4iLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXpvb20tb3V0LXRvLWV4dGVudCI6Ilpvb21zIG91dCB0byB0aGUgZ2l2ZW4gZXh0ZW50LiIsImxhbmd1YWdlLW1lbnUtbWFwdGlwLWFjdGlvbnMtdmlldy1kZXRhaWxzLWRlc2MiOiJWaWV3IGFkZGl0aW9uYWwgZGV0YWlscyBhYm91dCB0aGlzIGZlYXR1cmUiLCJsYW5ndWFnZS1tZW51LXJ1bi13b3JrZmxvdyI6IlBlcmZvcm0gYSB0YXNrIiwibGFuZ3VhZ2Utb2ZmbGluZS1wcm9ncmVzcy1tZWdhYnl0ZXMtcGVyLXNlY29uZCI6InswfSBNQi9zIiwibGFuZ3VhZ2UtdG9vbGJhci1lZGl0aW5nLW1hbmFnZS1vZmZsaW5lLWRhdGEiOiJNYW5hZ2UgT2ZmbGluZSBEYXRhIiwibGFuZ3VhZ2UtdG9vbGJhci1ncm91cC10b29scyI6IlRvb2xzIiwibGFuZ3VhZ2UtdG9vbGJhci1lZGl0aW5nLWNyZWF0ZS1uZXctZmVhdHVyZS1nZW9sb2NhdGlvbiI6IlVzZSBHZW9sb2NhdGlvbiIsImxhbmd1YWdlLXRvb2xiYXItZWRpdGluZy1kYXRhIjoiRGF0YSIsImxhbmd1YWdlLW1lbnUtcmVzdWx0cy10YWJsZS1hY3Rpb25zLWRlc2MiOiJSZXN1bHRzIFRhYmxlIEFjdGlvbnMiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLW9wZW4tZmVhdHVyZS1zZXQtY29sbGVjdGlvbiI6Ik9wZW5zIHRoZSBmZWF0dXJlIHNldCBjb2xsZWN0aW9uLiIsImxhbmd1YWdlLWNvbW1vbi1ub3RpZmljYXRpb24iOiJOb3RpZmljYXRpb24iLCJsYW5ndWFnZS1sYXllcnNlbGVjdG9yLWljb24tdG9vbHRpcCI6InswfSBpY29uIiwibGFuZ3VhZ2Utc3RhdGVzLWRlZmF1bHQtZGVzY3JpcHRpb24iOiJUaGUgdmlld2VyIGN1cnJlbnRseSBoYXMgbm90aGluZyBhY3RpdmUuIiwibGFuZ3VhZ2UtdG9vbGJhci1pZGVudGlmeS1wb2ludC1kZXNjIjoiQ2xpY2sgb3IgdGFwIGEgbG9jYXRpb24gb24gdGhlIG1hcCB0byBsZWFybiB3aGF0XHUyMDE5cyB0aGVyZS4iLCJsYW5ndWFnZS10b29sYmFyLWlkZW50aWZ5LXBvbHlnb24tdG9vbHRpcCI6IkRyYXcgYSBjdXN0b20gc2hhcGUgb24gdGhlIG1hcCB0byBmaW5kIG91dCBhYm91dCBhbiBhcmVhIiwibGFuZ3VhZ2Utb2ZmbGluZS1wcm9ncmVzcy1zdGFydGluZy1zeW5jIjoiU3RhcnRpbmcgZmVhdHVyZSBsYXllciBzeW5jLiIsImxhbmd1YWdlLW1lbnUtb2ZmbGluZS1tYXAtZWRpdG9yLWdlb21ldHJ5LWFjdGlvbnMtcmVjdGFuZ2xlLWRlc2MiOiJEcmF3IGEgcmVjdGFuZ2xlIGZvciB0aGUgYXJlYSBvZiBpbnRlcmVzdCBnZW9tZXRyeS4iLCJsYW5ndWFnZS1tZW51LWdsb2JhbC1vcGVuLWRlc2MiOiJDaG9vc2UgYSBwcmV2aW91c2x5IHNhdmVkIHByb2plY3QgdG8gcmVzdG9yZSB0aGUgc2F2ZWQgc3RhdGUiLCJsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtY29sb3IiOiJDb2xvciIsImxhbmd1YWdlLXRvb2xiYXItM3JkLXBhcnR5LW1hcHMtc2hvdy1tYXBzLXRvb2x0aXAiOiJEaXNwbGF5IGxpbmtlZCBtYXBzIGluIHRoZSBleHRlcm5hbCBjb21wb25lbnQgdmlldyIsImxhbmd1YWdlLW1lbnUtcGxvdC1jb29yZGluYXRlLWRlc2MiOiJQbG90IGEgY29vcmRpbmF0ZSBvbiB0aGUgbWFwLiIsImxhbmd1YWdlLXRvb2xiYXItYnVmZmVyaW5nLWFsdC1lbmFibGUiOiJFbmFibGUgYnVmZmVyaW5nIGZvciBhY3RpdmUgdG9vbCIsImxhbmd1YWdlLW9mZmxpbmUtcHJvZ3Jlc3MtdXBkYXRpbmctdG9rZW5zIjoiVXBkYXRpbmcgc2VydmljZSB0b2tlbnMuIiwibGFuZ3VhZ2UtdG9vbGJhci1pZGVudGlmeS1sYXllcnMtY2hhbmdlIjoiSWRlbnRpZmlhYmxlIExheWVycyIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tY2xlYXItdGVtcG9yYXJ5LW1hcmt1cCI6IlJlbW92ZXMgdGVtcG9yYXJ5IG1hcmt1cCBjcmVhdGVkIGJ5IEFkZFRlbXBvcmFyeU1hcmt1cEdlb21ldHJ5LiIsImxhbmd1YWdlLWNvbW1vbi1sb2FkaW5nLXJlc3VsdHMiOiJMb2FkaW5nIFJlc3VsdHMuLi4iLCJsYW5ndWFnZS10b29sYmFyLW1hcmt1cC1yZWN0YW5nbGUiOiJSZWN0YW5nbGUiLCJsYW5ndWFnZS1vZmZsaW5lLWVycm9ycy1pc2FjdGl2ZSI6IkNhbm5vdCByZW1vdmUgdGhlIGFjdGl2ZSBvZmZsaW5lIG1hcC4iLCJsYW5ndWFnZS10b29sYmFyLWFuYWx5c2lzLWxvY2F0aW9uLWluZm9ybWF0aW9uIjoiTG9jYXRpb24gSW5mb3JtYXRpb24iLCJsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtbGluZS1zdHlsZS1kYXNoZG90ZG90IjoiRGFzaC1kb3QtZG90IiwibGFuZ3VhZ2UtY29tbW9uLXJlc3VsdHMtY29tYmluZS1uby1yZXN1bHRzIjoiTm8gcmVzdWx0cyB0byBwZXJmb3JtIHRoZSBvcGVyYXRpb24iLCJsYW5ndWFnZS10b29sYmFyLW5hdmlnYXRpb24tem9vbS1pbiI6Ilpvb20gSW4iLCJsYW5ndWFnZS10b29sYmFyLWNsZWFyLWFsbCI6IkNsZWFyIiwibGFuZ3VhZ2Utb2ZmbGluZS1wcm9ncmVzcy1iYXNlbWFwZXhwb3J0LWZhaWxlZCI6InswfSBmYWlsZWQuIHsxfSIsImxhbmd1YWdlLXRvb2xiYXItYXJjZ2lzLXZpZXctbXktY29udGVudC10b29sdGlwIjoiVmlldyB5b3VyIGNvbnRlbnQgc3RvcmVkIGluIEFyY0dJUyIsImxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1saW5lLXN0eWxlIjoiTGluZSBTdHlsZSIsImxhbmd1YWdlLXRvb2xiYXItdGFza3MtcHJpbnRpbmciOiJQcmludGluZyIsImxhbmd1YWdlLXRvb2xiYXItbWFya3VwLWRyYXdpbmciOiJDcmVhdGUiLCJsYW5ndWFnZS10b29sYmFyLWlkZW50aWZ5LWNvbWJpbmUtdW5pb24tZW5hYmxlIjoiRW5hYmxlIEFkZCBSZXN1bHRzIiwidGltZXBpY2tlci5yZWdpb25hbCI6eyJzZWNvbmRUZXh0IjoiU2Vjb25kIiwidGltZXpvbmVUZXh0IjoiVGltZSBab25lIiwiYW1OYW1lcyI6WyJBTSIsIkEiXSwibWljcm9zZWNUZXh0IjoiTWljcm9zZWNvbmQiLCJ0aW1lU3VmZml4IjoiIiwiY3VycmVudFRleHQiOiJOb3ciLCJob3VyVGV4dCI6IkhvdXIiLCJtaWxsaXNlY1RleHQiOiJNaWxsaXNlY29uZCIsInRpbWVGb3JtYXQiOiJISDptbSIsInRpbWVUZXh0IjoiVGltZSIsImNsb3NlVGV4dCI6IkRvbmUiLCJwbU5hbWVzIjpbIlBNIiwiUCJdLCJtaW51dGVUZXh0IjoiTWludXRlIiwiaXNSVEwiOmZhbHNlLCJ0aW1lT25seVRpdGxlIjoiQ2hvb3NlIFRpbWUifSwibGFuZ3VhZ2UtbWFwc2VydmljZS1hY3Rpb25zLWRlc2MiOiJEaXNwbGF5IGEgbGlzdCBvZiBtYXAgc2VydmljZSBhY3Rpb25zIiwibGFuZ3VhZ2UtbWVudS1tYXAtbGF5ZXJzLWV4cGFuZCI6IkV4cGFuZCBhbmQgY29sbGFwc2UgezB9IGxheWVyIGdyb3VwIiwibGFuZ3VhZ2Utb2ZmbGluZS1wcm9ncmVzcy1naWdhYnl0ZXMiOiJ7MH0gR0IiLCJsYW5ndWFnZS1tZW51LXpvb20tdG8tdmlzaWJsZS1zY2FsZSI6Ilpvb20gdG8gdmlzaWJsZSBzY2FsZSIsImxhbmd1YWdlLXByb2plY3QtZXJyb3ItcmVhZC1kZW5pZWQiOiJZb3UgZG8gbm90IGhhdmUgcGVybWlzc2lvbiB0byBvcGVuIHRoaXMgcHJvamVjdC4iLCJsYW5ndWFnZS1tZW51LWNvbWJpbmUtcmVzdWx0cyI6IkNvbWJpbmUgUmVzdWx0cyIsImxhbmd1YWdlLWNvb3JkaW5hdGVzLXdlc3QtYWJicmV2IjoiVyIsImxhbmd1YWdlLXRvb2xiYXItZXJhc2UiOiJFcmFzZSIsImxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1tYXJrZXItc3R5bGUiOiJNYXJrZXIgU3R5bGUiLCJsYW5ndWFnZS10b29sYmFyLW1hcmt1cC1lbGxpcHNlLWRlc2MiOiJDbGljayBhbmQgZHJhZyB0byBkcmF3IGFuIGVsbGlwc2Ugb24gdGhlIG1hcC4iLCJsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtZmlsbC1zdHlsZS1udWxsIjoiTm9uZSIsImxhbmd1YWdlLXNlYXJjaC1mc2MtZGlzcGxheS1uYW1lIjoiU2VhcmNoIFJlc3VsdHM6IHswfSIsImxhbmd1YWdlLW9mZmxpbmUtZXJyb3JzLWNhbmNlbGVkIjoiQ2FuY2VsZWQuIiwibGFuZ3VhZ2Utb2ZmbGluZS1wcm9ncmVzcy1iYXNlbWFwZG93bmxvYWQtY29ubmVjdGluZyI6InswfSBjb25uZWN0aW5nLi4uIiwibGFuZ3VhZ2UtdG9vbGJhci1uYXZpZ2F0aW9uLXpvb20taW4tdG9vbHRpcCI6IkRyYXcgYW4gYXJlYSBvbiB0aGUgbWFwIHRvIHpvb20gdG8iLCJsYW5ndWFnZS10b29sYmFyLWlkZW50aWZ5LXBvaW50LWRlc2Mta2V5Ym9hcmQiOiJVc2UgYXJyb3dzIHRvIG1vdmUgdGhlIHBvaW50LiBIaXQgRU5URVIgdG8gbGVhcm4gd2hhdFx1MjAxOXMgdGhlcmUuIiwibGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLWxpbmUtd2lkdGgiOiJMaW5lIFdpZHRoIiwibGFuZ3VhZ2UtdG9vbGJhci1ncm91cC1lZGl0IjoiRWRpdCIsImxhbmd1YWdlLWxheWVybGlzdC11c2VyLWFkZGVkLWxheWVycy1mb2xkZXItdGl0bGUiOiJVc2VyIEFkZGVkIExheWVycyIsImxhbmd1YWdlLXRvb2xiYXItaWRlbnRpZnktY29tYmluZS1zdWJ0cmFjdC1lbmFibGUtdG9vbHRpcCI6IkVuYWJsZSBzdWJ0cmFjdGluZyByZXN1bHRzIGZyb20gdGhlIGV4aXN0aW5nIGlkZW50aWZ5IHJlc3VsdHMiLCJsYW5ndWFnZS1tZW51LXpvb20tdG8tYWxsLWRlc2MiOiJab29tIHRvIGV4dGVudCBvZiBhbGwgcmVzdWx0cyIsImxhbmd1YWdlLXNtYXJ0LXBhbmVsLW1heGltaXplLXJlc3RvcmUiOiJNYXhpbWl6ZS9SZXN0b3JlIFBhbmVsIiwibGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLXRyYW5zcGFyZW5jeSI6IlRyYW5zcGFyZW5jeSIsImxhbmd1YWdlLXRvb2xiYXItdGltZXNsaWRlci1zaG93dGltZXNsaWRlciI6IlRpbWUgU2xpZGVyIiwibGFuZ3VhZ2Utb2ZmbGluZS1wcm9ncmVzcy1zYXZpbmdvZmZsaW5lbWFwIjoiU2F2aW5nIG9mZmxpbmUgbWFwLiIsImxhbmd1YWdlLWdyYW50LWVkaXRvci10YWJsZS1oZWFkZXItdmlldyI6IlZpZXciLCJsYW5ndWFnZS1tZW51LWxhYmVsLW9wdGlvbnMtdG9nZ2xlLWRlc2MiOiJUdXJuIHRoZSBsYXllcidzIGxhYmVscyBvbiBvciBvZmYuIiwibGFuZ3VhZ2UtdG9vbGJhci1pZGVudGlmeS1mcmVlaGFuZC1wb2x5Z29uLXRvb2x0aXAiOiJJZGVudGlmeSB0aGluZ3Mgb24gdGhlIG1hcCBieSBkcmF3aW5nIGEgZnJlZWhhbmQgc2hhcGUiLCJsYW5ndWFnZS1wcm9qZWN0LWVycm9yLXdyaXRlLWRlbmllZCI6IllvdSBkbyBub3QgaGF2ZSBwZXJtaXNzaW9uIHRvIHNhdmUgdGhpcyBwcm9qZWN0LiIsImxhbmd1YWdlLWFjY2Vzc2liaWxpdHktZm9ybS11bm5hbWVkLWNvbnRhaW5lci1zaG93biI6IkZvcm0gZ3JvdXAgc2hvd24uIiwibGFuZ3VhZ2UtdG9vbGJhci1pZGVudGlmeS1mcmVlaGFuZC1kZXNjIjoiQ2xpY2svdGFwIGFuZCBob2xkIGRvd24sIHRoZW4gZHJhdyBhIGZyZWVoYW5kIHNoYXBlIHRvIGxlYXJuIHdoYXRcdTIwMTlzIHRoZXJlLiIsImxhbmd1YWdlLW1lbnUtc3dpdGNoLXRvLWxheWVybGlzdC1kZXNjIjoiRGlzcGxheSB0aGUgbGlzdCBvZiBhdmFpbGFibGUgbGF5ZXJzIiwibGFuZ3VhZ2UtcHJvamVjdC1lcnJvci1yZWFkLW5vdC1mb3VuZCI6IkNvdWxkIG5vdCBmaW5kIGEgcHJvamVjdCB3aXRoIElEIFwiezB9XCIuIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1kZWxldGUtZmVhdHVyZSI6IkRlbGV0ZXMgZWl0aGVyIGEgbmV3IG9yIGV4aXN0aW5nIGZlYXR1cmUuIiwibGFuZ3VhZ2Utc2Vjb25kcy1hYmJyIjoiUyIsImxhbmd1YWdlLWxheWVybGlzdC1vcGVyYXRpb25hbC1tYXBzLWZvbGRlci10aXRsZSI6Ik9wZXJhdGlvbmFsIExheWVycyIsImxhbmd1YWdlLXRvb2xiYXItdGFza3MtaWRlbnRpZnktdG9vbHRpcCI6IkZpbmQgZGF0YSBvbiB0aGUgbWFwIiwiZGF0ZXBpY2tlci5yZWdpb25hbCI6eyJkYXRlRm9ybWF0IjoibW0vZGQveXkiLCJuZXh0VGV4dCI6Ik5leHQiLCJkYXlOYW1lcyI6WyJTdW5kYXkiLCJNb25kYXkiLCJUdWVzZGF5IiwiV2VkbmVzZGF5IiwiVGh1cnNkYXkiLCJGcmlkYXkiLCJTYXR1cmRheSJdLCJwcmV2VGV4dCI6IlByZXYiLCJkYXlOYW1lc1Nob3J0IjpbIlN1biIsIk1vbiIsIlR1ZSIsIldlZCIsIlRodSIsIkZyaSIsIlNhdCJdLCJ3ZWVrSGVhZGVyIjoiV2siLCJjdXJyZW50VGV4dCI6IlRvZGF5IiwiZmlyc3REYXkiOjAsImNsb3NlVGV4dCI6IkRvbmUiLCJzaG93TW9udGhBZnRlclllYXIiOmZhbHNlLCJkYXlOYW1lc01pbiI6WyJTdSIsIk1vIiwiVHUiLCJXZSIsIlRoIiwiRnIiLCJTYSJdLCJtb250aE5hbWVzU2hvcnQiOlsiSmFuIiwiRmViIiwiTWFyIiwiQXByIiwiTWF5IiwiSnVuIiwiSnVsIiwiQXVnIiwiU2VwIiwiT2N0IiwiTm92IiwiRGVjIl0sImlzUlRMIjpmYWxzZSwibW9udGhOYW1lcyI6WyJKYW51YXJ5IiwiRmVicnVhcnkiLCJNYXJjaCIsIkFwcmlsIiwiTWF5IiwiSnVuZSIsIkp1bHkiLCJBdWd1c3QiLCJTZXB0ZW1iZXIiLCJPY3RvYmVyIiwiTm92ZW1iZXIiLCJEZWNlbWJlciJdLCJ5ZWFyU3VmZml4IjoiIn0sImxhbmd1YWdlLW1lbnUtZ2xvYmFsLXNlYXJjaCI6IlNlYXJjaCIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24taWRlbnRpZnkiOiJFeGVjdXRlcyBhbiBpZGVudGlmeSBvcGVyYXRpb24gb24gYSBnZW9tZXRyeS4iLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWFkZC10ZW1wb3JhcnktbWFya3VwLWdlb21ldHJ5IjoiQWRkcyBhIHRlbXBvcmFyeSBtYXJrdXAgZ3JhcGhpYyB0byB0aGUgbWFwLiBUaGUgQ2xlYXJUZW1wb3JhcnlNYXJrdXAgY29tbWFuZCB3aWxsIGNsZWFyIHRoaXMgbWFya3VwLiIsImxhbmd1YWdlLWNvbW1vbi1jbG9zZSI6IkNsb3NlIiwibGFuZ3VhZ2UtY29tbW9uLXJlc3VsdHMtZm91bmQiOiJSZXN1bHRzIEZvdW5kIiwibGFuZ3VhZ2UtbWVudS1pZGVudGlmeS1idWZmZXJlZC1mZWF0dXJlLXNldC1jb2xsZWN0aW9uLWRlc2MiOiJJZGVudGlmeSBmZWF0dXJlcyBuZWFyIHRoZXNlIHJlc3VsdHMiLCJsYW5ndWFnZS1zdGF0ZXMtZmVhdHVyZS1lZGl0aW5nLXN0YXRlLWdyYXBoaWMtZGVzY3JpcHRpb24iOiJUaGUgY3JlYXRlIGEgZmVhdHVyZSB0b29sIGlzIGN1cnJlbnRseSBlZGl0aW5nIGEgZ3JhcGhpYy4iLCJsYW5ndWFnZS1jb21tb24tbWVhc3VyZW1lbnQtcmVzdWx0cy1maWVsZC11bml0cyI6IlVuaXRzIiwibGFuZ3VhZ2UtcmVzdWx0cy10b2dnbGUtbGlzdC12aWV3LWRlc2MiOiJWaWV3IHJlc3VsdHMgaW4gbGlzdCBmb3JtYXQiLCJsYW5ndWFnZS1tZW51LXpvb20tdG8tbGF5ZXItZGVzYyI6Ilpvb20gdGhlIG1hcCB0byB0aGUgZnVsbCBleHRlbnQgb2YgdGhlIGxheWVyLiIsImxhbmd1YWdlLXRvb2xiYXItdGFiLW9mZmxpbmUiOiJPZmZsaW5lIiwibGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLXBlcmNlbnQtc3VmZml4IjoiJSIsImxhbmd1YWdlLW1lbnUtc2hvdy1yZXN1bHRzLXRhYmxlLWRlc2MiOiJTd2l0Y2ggdG8gVGFibGUgVmlldyIsImxhbmd1YWdlLXRvb2xiYXItbWVudS1nbG9iYWwtc2F2ZS1hcyI6IlNhdmUgYXMiLCJsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtbGluZS1zdHlsZS1kYXNoZG90IjoiRGFzaC1kb3QiLCJsYW5ndWFnZS1jb21tb24tcmVzdWx0cy1yZXBsYWNlLWNvbmZpcm1hdGlvbiI6Iid7MH0nIHJlcGxhY2VkIHdpdGggezF9IiwibGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLW1hcmtlci1zaXplIjoiTWFya2VyIFNpemUiLCJsYW5ndWFnZS1tZW51LWlkZW50aWZ5LXBvaW50IjoiSWRlbnRpZnkgYnkgcG9pbnQiLCJsYW5ndWFnZS10b29sYmFyLXRhYi1ob21lIjoiSG9tZSIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tcmVtb3ZlLXN0YXR1cyI6IlJlbW92ZXMgdGhlIHN0YXR1cyBpbmRpY2F0b3IgZnJvbSB0aGUgc2NyZWVuIHdpdGggdGhlIHNwZWNpZmllZCBJRC4iLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXRvZ2dsZS1yZXN1bHRzLWZyYW1lIjoiQWN0aXZhdGVzIG9yIGRlYWN0aXZhdGVzIFJlc3VsdHMgZnJhbWUuIiwibGFuZ3VhZ2UtdG9vbGJhci1uYXZpZ2F0aW9uLWhvbWUiOiJIb21lIiwibGFuZ3VhZ2UtbWVudS1pZGVudGlmeS1kZXNjIjoiQ2xpY2ssIHRhcCwgb3IgZHJhdyBhIHJlY3RhbmdsZSBvbiB0aGUgbWFwIHRvIGlkZW50aWZ5IGZlYXR1cmVzLiIsImxhbmd1YWdlLWxheWVyLWFjdGlvbnMtZGVzYyI6IkRpc3BsYXkgYSBsaXN0IG9mIGxheWVyIGFjdGlvbnMiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXJ1bi13b3JrZmxvdy13aXRoLWdlb21ldHJ5IjoiUnVucyBhIHdvcmtmbG93IHdpdGggYSBnZW9tZXRyeSB1c2VkIGFzIGFuIGlucHV0IGFyZ3VtZW50LiIsImxhbmd1YWdlLXRvb2xiYXItbmF2aWdhdGlvbi1pbml0aWFsLWV4dGVudC10b29sdGlwIjoiUmV0dXJuIHRvIHRoZSBpbml0aWFsIHBvc2l0aW9uIG9mIHRoZSBtYXAiLCJsYW5ndWFnZS1jb29yZGluYXRlcy1kZWdyZWVzIjoiwrAiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXNob3ctZmVhdHVyZS1sYXllci1tb2RhbC1tZXNzYWdlIjoiQ3JlYXRlcyBhIE1vZGVsTWVzc2FnZVZpZXcgdmlldyBhbmQgZGlzcGxheXMgdGhlIGdpdmVuIG1lc3NhZ2UuIiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtZWRpdCI6IkVkaXQiLCJsYW5ndWFnZS10b29sYmFyLW1hcmt1cC1mcmVlaGFuZC1wb2x5Z29uLWRlc2MiOiJIb2xkIHRoZSBtb3VzZSBidXR0b24gb3IgeW91ciBmaW5nZXJ0aXAgZG93biwgdGhlbiBkcmF3IGEgZnJlZWhhbmQgc2hhcGUuIiwibGFuZ3VhZ2Utb2ZmbGluZS1lcnJvcnMtYnVuZGxlbm90Zm91bmQiOiJCdW5kbGUgbm90IGZvdW5kLiIsImxhbmd1YWdlLWNvbW1vbi1wYW4tZGVzY3JpcHRpb24iOiJQYW4gdGhlIG1hcCB0byBjZW50ZXIgdGhpcyBmZWF0dXJlIiwibGFuZ3VhZ2UtdG9vbGJhci1uYXZpZ2F0aW9uLXByZXZpb3VzLWV4dGVudCI6IlByZXZpb3VzIEV4dGVudCIsImxhbmd1YWdlLXRvb2xiYXItZ3JvdXAtbWVhc3VyZW1lbnQtdG9vbHMiOiJNZWFzdXJlIiwibGFuZ3VhZ2UtbWVudS16b29tLXRvLWFsbCI6Ilpvb20gdG8gQWxsIiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtcG9pbnQiOiJQb2ludCIsImxhbmd1YWdlLXJlc3VsdHMtZmVhdHVyZS1zZXQtZWxlbWVudC10aXRsZSI6IkNsaWNrIHRvIGV4cGFuZCByZXN1bHRzLiIsImxhbmd1YWdlLXRvb2xiYXItbWFya3VwLWNpcmNsZS1kZXNjIjoiRHJhZyBhIGNpcmNsZSBvbiB0byB0aGUgbWFwIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1oaWRlLWZlYXR1cmUtbGF5ZXItbW9kYWwtbWVzc2FnZSI6IlJlbW92ZXMgYSBtb2RhbCBtZXNzYWdlLiIsImxhbmd1YWdlLWNvbW1vbi1zeW5jLWNvbXBsZXRlIjoiU3luY2hyb25pemF0aW9uIGNvbXBsZXRlIiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtcGFsZXR0ZS1zbWFsbC1lZGl0IjoiRWRpdCIsImxhbmd1YWdlLWFjY2Vzc2liaWxpdHktZm9ybS11bm5hbWVkLWNvbnRhaW5lci1oaWRkZW4iOiJGb3JtIGdyb3VwIGhpZGRlbi4iLCJsYW5ndWFnZS1zdGF0ZXMtaWRlbnRpZnktY29tYmluZS1kZXNjcmlwdGlvbiI6IkNvbWJpbmluZyBpcyBlbmFibGVkIGZvciB0aGUgaWRlbnRpZnkgdG9vbC4iLCJsYW5ndWFnZS1tZW51LXNob3ctcmVzdWx0cy10YWJsZSI6IlRhYmxlIFZpZXciLCJsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtZXhjZWVkZWQtbWF4LWNsYXNzZXMiOiJNb3JlIHRoYW4gezB9IHVuaXF1ZSB2YWx1ZXMgZm91bmQuIFRoZSB0b3AgezB9IGhhdmUgYmVlbiB1c2VkIHRvIGNyZWF0ZSB0aGUgcmVuZGVyZXIuIiwibGFuZ3VhZ2UtdG9vbGJhci1uYXZpZ2F0aW9uLW5leHQtZXh0ZW50IjoiTmV4dCBFeHRlbnQiLCJsYW5ndWFnZS1jb250ZW50LXBvbGljeS1wcm9tcHQtdXJpLWRlc2MiOiJUaGUgYXBwbGljYXRpb24gaXMgYXR0ZW1wdGluZyB0byBsb2FkIGNvbnRlbnQgZnJvbSAnezB9Jy4gRG8geW91IHJlY29nbml6ZSBhbmQgdHJ1c3QgdGhpcyBVUkw/IiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1nZW9sb2NhdGUiOiJab29tcyB0byB0aGUgY3VycmVudCBsb2NhdGlvbiBvZiB0aGUgZGV2aWNlLiIsImxhbmd1YWdlLXRvb2xiYXItZ3JvdXAtbmF2aWdhdGlvbiI6Ik5hdmlnYXRpb24iLCJsYW5ndWFnZS10b29sYmFyLW1hcmt1cC1jbGVhciI6IkNsZWFyIiwibGFuZ3VhZ2Utc3RhdGVzLWlkZW50aWZ5LXN0YXRlLWRlc2NyaXB0aW9uIjoiVGhlIGlkZW50aWZ5IHRvb2wgaXMgY3VycmVudGx5IGFjdGl2ZS4iLCJsYW5ndWFnZS1tZW51LWVudGVyLW9mZmxpbmUtZGVzYyI6IkdvIHRvIG9mZmxpbmUgbW9kZSBhbmQgdmlldyBjYWNoZWQgbWFwIGRhdGEuIiwibGFuZ3VhZ2UtdG9vbGJhci10YXNrcy1leHBvcnQtbWFwLXRvb2x0aXAiOiJTYXZlIGEgbWFwIGltYWdlIiwibGFuZ3VhZ2UtdG9vbGJhci1tZW51LWdsb2JhbC1vcGVuLWRlc2MiOiJDaG9vc2UgYSBwcmV2aW91c2x5IHNhdmVkIHByb2plY3QgdG8gcmVzdG9yZSB0aGUgc2F2ZWQgc3RhdGUiLCJsYW5ndWFnZS1tZW51LW9mZmxpbmUtbWFwLWVkaXRvci1nZW9tZXRyeS1hY3Rpb25zLWNsZWFyLWRlc2MiOiJDbGVhciB0aGUgYXJlYSBvZiBpbnRlcmVzdCBnZW9tZXRyeS4iLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWNsZWFyLXN0b3JhZ2UtZm9yLWRvbWFpbiI6IkNsZWFycyBhbGwgb2ZmbGluZSBkYXRhIGZvciB0aGUgY3VycmVudCBkb21haW4uIFRoaXMgaW5jbHVkZXMgZGF0YSBmb3IgYWxsIGFwcGxpY2F0aW9ucyBsb2FkZWQgZnJvbSB0aGUgY3VycmVudCBkb21haW4uIiwibGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLXRyYW5zcGFyZW5jeS1zdWZmaXgiOiIlIiwibGFuZ3VhZ2UtY29tbW9uLXBhbiI6IlBhbiIsImxhbmd1YWdlLW9mZmxpbmUtcHJvZ3Jlc3Mtc3RhcnRpbmctYmFzZW1hcC1kb3dubG9hZCI6IlN0YXJ0aW5nIGJhc2VtYXAgZG93bmxvYWRzLiIsImxhbmd1YWdlLXRvb2xiYXItbWFya3VwLWVkaXQtem9vbWluLXRvb2wiOiJab29tSW5Ub29sIiwibGFuZ3VhZ2UtdG9vbGJhci1pZGVudGlmeS1wb2x5Z29uIjoiUG9seWdvbiIsImxhbmd1YWdlLXJlc3VsdHMtdG9nZ2xlLWxpc3QtdmlldyI6IlN3aXRjaCB0byBMaXN0IiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1yZWNlbnRlci1tYXAtb24tbmV4dC1tYXAtcmVzaXplIjoiUmVjZW50ZXJzIHRoZSBtYXAgdG8gaXRzIGV4aXN0aW5nIHBvc2l0aW9uIHRoZSBuZXh0IHRpbWUgdGhlIG1hcCBpcyByZXNpemVkLiIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tY3JlYXRlLWF0dGFjaG1lbnQiOiJDcmVhdGVzIGEgZmVhdHVyZSBhdHRhY2htZW50LiIsImxhbmd1YWdlLXRvb2xiYXItYnVmZmVyaW5nLWFsdC1kaXNhYmxlIjoiRGlzYWJsZSBidWZmZXJpbmcgZm9yIGFjdGl2ZSB0b29sIiwibGFuZ3VhZ2UtbWVudS1wb3dlcmVkLWJ5LWdlb2NvcnRleCI6IlBvd2VyZWQgYnkgR2VvY29ydGV4IiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1jcmVhdGUtZmVhdHVyZSI6IkNyZWF0ZXMgYSBuZXcgZmVhdHVyZS4iLCJsYW5ndWFnZS1jb21tb24tcmVzdWx0cy1yZW1vdmVkLWNvbmZpcm1hdGlvbiI6InswfSByZXN1bHQocykgcmVtb3ZlZCBmcm9tICd7MX0nIiwibGFuZ3VhZ2UtY29vcmRpbmF0ZXMteSI6IlkiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWNyZWF0ZS1yZWxhdGVkLXJlY29yZCI6IkNyZWF0ZXMgYSByZWxhdGVkIHRhYmxlIHJlY29yZC4iLCJsYW5ndWFnZS10b29sYmFyLWVkaXRpbmctZWRpdCI6IkVkaXQiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXB1bHNlLXN0YXR1cyI6IlJlc2V0cyB0aGUgdGltZXIgb2YgdGhlIHN0YXR1cyB2aWV3TW9kZWwuIiwibGFuZ3VhZ2UtY29vcmRpbmF0ZXMteCI6IlgiLCJsYW5ndWFnZS1tZW51LXN3aXRjaC10by1sZWdlbmQiOiJTaG93IExlZ2VuZCIsImxhbmd1YWdlLXRvb2xiYXItbWFya3VwLXBhbGV0dGUtc21hbGwtZGVsZXRlIjoiRGVsZXRlIiwibGFuZ3VhZ2UtdG9vbGJhci1ncm91cC1ob21lIjoiQmFzaWMgVG9vbHMiLCJsYW5ndWFnZS10b29sYmFyLWFuYWx5c2lzLWxvY2F0aW9uLWluZm8iOiJMb2NhdGlvbiBJbmZvIiwibGFuZ3VhZ2UtbWVudS1nbG9iYWwtc2F2ZS1kZXNjIjoiU2F2ZSB0aGUgc3RhdGUgb2YgeW91ciB2aWV3ZXIgaW4gYSBwcm9qZWN0IiwibGFuZ3VhZ2UtY29tbW9uLWVkaXRpbmciOiJFZGl0aW5nIiwibGFuZ3VhZ2UtY29tbW9uLXJlZnJlc2giOiJSZWZyZXNoIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1kZXN0cm95LXZpZXciOiJEZXN0cm95cyBhIHZpZXcsIHdpcGluZyBvdXQgaXRzIGJpbmRpbmcgYW5kIERPTSBzdWJzdHJ1Y3R1cmVzLiIsImxhbmd1YWdlLWNvbW1vbi1vayI6Ik9LIiwibGFuZ3VhZ2UtbWVudS1ydW4tYS13b3JrZmxvdyI6IlBlcmZvcm0gYSB0YXNrIiwibGFuZ3VhZ2UtdG9vbGJhci1ub3QtYXZhaWxhYmxlIjoiVG9vbGJhciBpcyBub3QgYXZhaWxhYmxlIiwibGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLWZpbGwtc3R5bGUtZGlhZ29uYWwtY3Jvc3MiOiJEaWFnb25hbCBDcm9zcyIsImxhbmd1YWdlLWdyYW50LWVkaXRvci1yZW1vdmUtYnV0dG9uLXRpdGxlIjoiUmVtb3ZlIHRoZSB1c2VyIG9yIGdyb3VwIiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtdGV4dC10b29sdGlwIjoiQWRkIHlvdXIgb3duIHRleHQgdG8gdGhlIG1hcCIsImxhbmd1YWdlLWV4dHJhY3QtZGF0YS1kZXNjcmlwdGlvbiI6IkV4dHJhY3QgZmVhdHVyZSBkYXRhIGZyb20gdGhlIG1hcC4iLCJsYW5ndWFnZS1jb21tb24tdmFsaWRhdGlvbi1zeW1ib2wiOiIqIiwibGFuZ3VhZ2UtcmVzdWx0cy1zb3J0IjoiU29ydCBSZXN1bHRzIiwibGFuZ3VhZ2UtcmVzdWx0cy1wYWdlLW5leHQiOiJOZXh0IHBhZ2UiLCJsYW5ndWFnZS10b29sYmFyLXRhc2tzLWV4cG9ydC1tYXAiOiJFeHBvcnQiLCJsYW5ndWFnZS1jb250ZW50LXBvbGljeS1wcm9tcHQtdXJpLXRpdGxlIjoiUG90ZW50aWFsbHkgVW50cnVzdGVkIENvbnRlbnQgRW5jb3VudGVyZWQiLCJsYW5ndWFnZS1tZW51LXByb2plY3QtZGVsZXRlLXByb2plY3QtZGVzYyI6IkRlbGV0ZSB0aGUgY3VycmVudCBwcm9qZWN0IiwibGFuZ3VhZ2UtbWVudS1tYXAtbGF5ZXJzLWRlc2MiOiJBbHRlciB2aXNpYmlsaXR5IG9mIG1hcCBsYXllcnMsIHBlcmZvcm0gbGF5ZXIgYWN0aW9ucywgYW5kIHZpZXcgdGhlIGxlZ2VuZC4iLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXJlbW92ZS1mZWF0dXJlLXNldC1jb2xsZWN0aW9uIjoiUmVtb3ZlcyB0aGUgc3BlY2lmaWVkIGNvbGxlY3Rpb24gZnJvbSB0aGUgZmVhdHVyZSBzZXQgbWFuYWdlci4iLCJsYW5ndWFnZS1zeW1ib2xvZ3ktZXJyb3JzLW1hbGZvcm1lZC1saWJyYXJ5IjoiQXR0ZW1wdGVkIHRvIGRvd25sb2FkIHRoZSBzeW1ib2wgbGlicmFyeSAnezB9JywgYnV0IGRpZCBub3QgcmVjZWl2ZSBhIGFycmF5IG9mIHN5bWJvbHMgaW4gcmVzcG9uc2UuIiwibGFuZ3VhZ2UtdG9vbGJhci10b2dnbGUtYnVmZmVyLW9uLW5hbWUiOiJCdWZmZXIgT3B0aW9ucyIsImxhbmd1YWdlLW1lbnUtYWNjZXNzaWJpbGl0eS1wYW5lbCI6IlZpZXcgdGhlIGFjY2Vzc2liaWxpdHkgcGFuZWwiLCJsYW5ndWFnZS10b29sYmFyLWdyb3VwLWRyYXciOiJEcmF3IiwibGFuZ3VhZ2UtdG9vbGJhci1pZGVudGlmeS1wb2ludCI6IlBvaW50IiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtZHJhd2luZy1lZGl0LXRvb2xzIjoiRWRpdCIsImxhbmd1YWdlLW1lbnUtbGlzdC1vZmZsaW5lLW1hcHMtYWN0aW9ucy1yZWZyZXNoIjoiUmVmcmVzaCIsImxhbmd1YWdlLXRvb2xiYXItbWFya3VwLWZyZWVoYW5kLXBvbHlnb24iOiJGcmVlaGFuZCBTaGFwZSIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tb3Blbi1kYXRhLWZyYW1lIjoiT3BlbnMgdGhlIERhdGFSZWdpb24sIGlmIHByZXNlbnQgaW4gdGhlIGN1cnJlbnQgc2hlbGwuIiwibGFuZ3VhZ2UtY29tbW9uLXdlbGNvbWUiOiJIb21lIiwibGFuZ3VhZ2UtbWVudS1tYXAtY29udGV4dC1tZW51LXRpdGxlLWRlc2MiOiJPcHRpb25zIHJlbGF0ZWQgdG8gYSBnaXZlbiBwb2ludCBvbiB0aGUgbWFwLiIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tem9vbS10by1pbml0aWFsLWV4dGVudCI6Ilpvb21zIHRvIHRoZSBpbml0aWFsIGV4dGVudCBvZiB0aGUgY3VycmVudCBTaXRlLiIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tY2xlYXItYWN0aXZlLXRvb2wiOiJDbGVhcnMgdGhlIGFjdGl2ZSB0b29sLiIsImxhbmd1YWdlLW1lbnUtcHJvamVjdC1lZGl0LXByb2plY3QtZGVzYyI6IkVkaXQgdGhlIGN1cnJlbnQgcHJvamVjdCIsImxhbmd1YWdlLXN0YXRlcy1lZGl0aW5nLXN0YXRlLWRlc2NyaXB0aW9uIjoiQSBkcmF3aW5nIGlzIGFjdGl2ZWx5IGJlaW5nIGVkaXRlZC4iLCJsYW5ndWFnZS1tZW51LWxhYmVsLW9wdGlvbnMtZGVzYyI6IlRvZ2dsZSBhbmQgY3VzdG9taXplIHRoZSBsYXllcidzIGxhYmVscy4iLCJsYW5ndWFnZS1tZW51LWJvb2ttYXJrLWFkZCI6IkJvb2ttYXJrIGN1cnJlbnQgbWFwIGV4dGVudCIsImxhbmd1YWdlLW1lbnUtem9vbS1pbiI6Ilpvb20gaW4iLCJsYW5ndWFnZS10b29sYmFyLWFyY2dpcy12aWV3LW15LWNvbnRlbnQiOiJWaWV3IE15IENvbnRlbnQiLCJsYW5ndWFnZS1tZW51LW9mZmxpbmUtbWFwLWVkaXRvci1nZW9tZXRyeS1hY3Rpb25zLWRlc2MiOiJHZW9tZXRyeSBBY3Rpb25zIiwibGFuZ3VhZ2UtZ3JhbnQtZWRpdG9yLWFkZC1idXR0b24tdGl0bGUiOiJBZGQgdGhlIHVzZXIgb3IgZ3JvdXAiLCJsYW5ndWFnZS1tZW51LXpvb20tdG8tbGF5ZXIiOiJab29tIHRvIGZ1bGwgZXh0ZW50IiwibGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLWxpbmUtc3R5bGUtc2hvcnRkb3QiOiJTaG9ydC1kb3QiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXpvb20tdG8tZXNyaS1mZWF0dXJlLXNldCI6Ilpvb21zIHRvIHRoZSBleHRlbnQgb2YgYWxsIHRoZSBmZWF0dXJlcyBpbiB0aGUgZmVhdHVyZSBzZXQuIiwibGFuZ3VhZ2Utb2ZmbGluZS1lcnJvcnMtZmV0Y2gtZXJyb3IiOiJFcnJvciBmZXRjaGluZyAnezB9Jy4iLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWNsb3NlLWRhdGEtZnJhbWUiOiJDbG9zZXMgdGhlIERhdGFSZWdpb24sIGlmIGl0IGlzIHByZXNlbnQgaW4gdGhlIGN1cnJlbnQgc2hlbGwuIiwibGFuZ3VhZ2UtbWVudS1ydW4tcmVwb3J0LWRlc2MiOiJSdW4gYSBSZXBvcnQgb24gdGhlIHNlbGVjdGVkIHJlc3VsdHMiLCJsYW5ndWFnZS10b29sYmFyLWdyb3VwLW5hdGl2ZSI6Ik5hdGl2ZSIsImxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1tYXJrZXItc3R5bGUtY2lyY2xlIjoiQ2lyY2xlIiwibGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLWltYWdlLXNpemUiOiJJbWFnZSBTaXplIiwibGFuZ3VhZ2UtY29tbW9uLWxpYnJhcnkiOiJMaWJyYXJ5IiwibGFuZ3VhZ2UtdG9vbGJhci1lZGl0aW5nLW1hbmFnZS1vZmZsaW5lLWRhdGEtdG9vbHRpcCI6IlNlbGVjdCwgc3luYywgYW5kIGNsZWFyIG9mZmxpbmUgZGF0YSIsImxhbmd1YWdlLW1lbnUtZmVhdHVyZS1zZXQtYWN0aW9ucy10aXRsZSI6IlJlc3VsdHMgYWN0aW9ucy4gQ2xpY2sgdG8gb3Blbi9jbG9zZS4iLCJsYW5ndWFnZS10b29sYmFyLXRhc2tzLWFkZC1sYXllcnMiOiJBZGQgTGF5ZXJzIiwibGFuZ3VhZ2UtY29tbW9uLWNhbmNlbCI6IkNhbmNlbCIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tc2V0LWFjdGl2ZS1oaWdobGlnaHQtbGF5ZXIiOiJTZXRzIHRoZSBsYXllciB3aXRoIHRoZSBzcGVjaWZpZWQgbmFtZSBhcyBhY3RpdmUsIGlmIHRoZXJlIGlzIG9uZS4iLCJsYW5ndWFnZS1tZW51LXpvb20tdG8tdmlzaWJsZS1zY2FsZS1kZXNjIjoiWm9vbSB0aGUgbWFwIHRvIGEgc2NhbGUgd2hlcmUgdGhlIGxheWVyIGlzIHZpc2libGUuIiwibGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLWF0dHJpYnV0ZS1kaXNwbGF5bmFtZSI6IkF0dHJpYnV0ZSIsImxhbmd1YWdlLXRvb2xiYXItZmluZC1kYXRhIjoiRmluZCBEYXRhIiwibGFuZ3VhZ2UtY29tbW9uLXNob3ctZGV0YWlscy1kZXNjcmlwdGlvbiI6IlNlZSBhZGRpdGlvbmFsIGRldGFpbHMgZm9yIHRoaXMgZmVhdHVyZS4iLCJsYW5ndWFnZS10b29sYmFyLWlkZW50aWZ5LWNvbWJpbmUtc3VidHJhY3QtZGlzYWJsZSI6IkRpc2FibGUgU3VidHJhY3QgUmVzdWx0cyIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tYWxsb3ctaGlkZS1mZWF0dXJlLWxheWVyLW1vZGFsLW1lc3NhZ2UiOiJTaG93IHRoZSBjbG9zZSBidXR0b24gb24gdGhlIE1vZGFsTWVzc2FnZVZpZXcgYWxsb3dpbmcgdGhlIHVzZXIgdG8gY2xvc2UgaXQuIiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtZGVsZXRlLWRlc2MiOiJDbGljayBvciB0YXAgdG8gaW1tZWRpYXRlbHkgYW5kIHBlcm1hbmVudGx5IGRlbGV0ZSBhIGRyYXdpbmcuIFRoaXMgY2Fubm90IGJlIHVuZG9uZS4iLCJsYW5ndWFnZS1jb21tb24tc2F2ZS1hcyI6IlNhdmUgQXMiLCJsYW5ndWFnZS10b29sYmFyLWVkaXRpbmctY3JlYXRlLW5ldy1mZWF0dXJlLWdlb2xvY2F0aW9uLXRvb2x0aXAiOiJDcmVhdGUgYSBwb2ludC1iYXNlZCBmZWF0dXJlIHVzaW5nIGdlb2xvY2F0aW9uIiwibGFuZ3VhZ2UtZXh0cmFjdC1kYXRhIjoiRXh0cmFjdCBkYXRhIiwibGFuZ3VhZ2Utd2VibWFwLWxheWVyLW5hbWUtcG9pbnQiOiJQb2ludHMiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWNsZWFyLW1hcmt1cCI6IlByb21wdHMgdGhlIHVzZXIgZm9yIGNvbmZpcm1hdGlvbiwgYW5kIGlmIGFwcHJvdmVkLCBjbGVhcnMgYWxsIG9mIHRoZSBtYXJrdXAgZnJvbSB0aGUgbWFya3VwIGxheWVyLiIsImxhbmd1YWdlLWdyYW50LWVkaXRvci1zZWFyY2gtdGl0bGUiOiJUeXBlIHlvdXIgc2VhcmNoIHRlcm1zIiwibGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLWRlZ3JlZS1zdWZmaXgiOiLCsCIsImxhbmd1YWdlLW1lbnUtc2hvdy1sb2ctZGVzYyI6IkRpc3BsYXkgdGhlIHZpZXdlcidzIGxvZywgaW5jbHVkaW5nIGRpYWdub3N0aWMgZXJyb3JzIGFuZCB0aGUgdmVyc2lvbiBudW1iZXIuIiwibGFuZ3VhZ2UtY29tbW9uLW1lYXN1cmVtZW50LXJlc3VsdHMtZmllbGQtYXJlYS11bml0cyI6IkFyZWEgVW5pdHMiLCJsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtdGl0bGUiOiJTeW1ib2xvZ3kgU2V0dGluZ3MiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWRlbGV0ZS1hdHRhY2htZW50IjoiRGVsZXRlcyBhIGZlYXR1cmUgYXR0YWNobWVudC4iLCJsYW5ndWFnZS1jb21tb24tcmVzdWx0cy1hZGRlZC1jb25maXJtYXRpb24iOiJ7MH0gcmVzdWx0KHMpIGFkZGVkIHRvICd7MX0nIiwibGFuZ3VhZ2UtY29vcmRpbmF0ZXMtbGF0aXR1ZGUtYWJicmV2IjoiTGF0IiwibGFuZ3VhZ2Utc3RhdGVzLXRyYW5zaWVudC1hY3RpdmUtZGVzY3JpcHRpb24iOiJBdCBsZWFzdCBvbmUgdHJhbnNpZW50IHRvb2xiYXIgaXMgY3VycmVudGx5IG9wZW4uIiwibGFuZ3VhZ2UtcmVzdWx0cy1leHBvcnQtdG8tc3RhdHVzLW1lc3NhZ2UiOiJFeHBvcnRpbmcgdG8gXCIuezB9XCIiLCJsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtbWFya2VyLXN0eWxlLWNyb3NzIjoiQ3Jvc3MiLCJsYW5ndWFnZS1tZW51LWhvbWUtcGFuZWwtZGVzYyI6IlZpZXcgaW5mb3JtYXRpb24gYWJvdXQgdGhpcyBhcHBsaWNhdGlvbi4iLCJsYW5ndWFnZS1jb21tb24tZmVhdHVyZS1lZGl0aW5nLWRlc2MiOiJFZGl0IHRoZSBhdHRyaWJ1dGVzIG9mIHRoZSBmZWF0dXJlIGFuZCBzYXZlIHRoZW0uIiwibGFuZ3VhZ2UtcmVzdWx0cy1wYWdlLWZpcnN0IjoiRmlyc3QgcGFnZSIsImxhbmd1YWdlLW1lbnUtem9vbS1pbml0aWFsLWV4dGVudCI6IlJldHVybiB0byBpbml0aWFsIG1hcCBleHRlbnQiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWRlbGV0ZS1mcm9tLWVkaXQtbG9nIjoiUmVtb3ZlcyB0aGUgZ2l2ZW4gZW50cnkgZnJvbSB0aGUgZWRpdCBsb2csIHRoZW4gc2V0cyB0aGUgZWRpdCBsb2cuIiwibGFuZ3VhZ2UtbGF5ZXJsaXN0LWJhc2UtbWFwcy1mb2xkZXItdGl0bGUiOiJCYXNlbWFwcyIsImxhbmd1YWdlLW9mZmxpbmUtcHJvZ3Jlc3MtYmFzZW1hcGV4cG9ydC1jb25uZWN0aW5nIjoiezB9IGNvbm5lY3RpbmcgdG8gZ2VuZXJhdGUuLi4iLCJsYW5ndWFnZS10b29sYmFyLWdyb3VwLW9mZmxpbmUtbWFuYWdlbWVudCI6Ik9mZmxpbmUgTWFuYWdlbWVudCIsImxhbmd1YWdlLWNvbW1vbi1lZGl0IjoiRWRpdCIsImxhbmd1YWdlLWNvbW1vbi1mZWF0dXJlLXN5bmMtc2V0dGluZ3MiOiJNYW5hZ2UgU3luYyBTZXR0aW5ncyIsImxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1zdGFydGNvbG9yIjoiU3RhcnQgQ29sb3IiLCJsYW5ndWFnZS1tZW51LXByb2plY3Qtc2hhcmUtcHJvamVjdC1kZXNjIjoiU2hhcmUgdGhlIGN1cnJlbnQgcHJvamVjdCIsImxhbmd1YWdlLWxheWVybGlzdC10b2dnbGUiOiJUb2dnbGUgezB9IGxheWVyIHZpc2liaWxpdHkuIiwibGFuZ3VhZ2UtY29tbW9uLWZlYXR1cmUtc3luYy1zZXR0aW5ncy1kZXNjIjoiRGlzcGxheXMgYSBsaXN0IG9mIGZlYXR1cmUgbGF5ZXJzIHRvIGNob29zZSBmcm9tLiIsImxhbmd1YWdlLXRvb2xiYXItbWFya3VwLXBvbHlnb24tZGVzYy1rZXlib2FyZCI6IlVzZSBhcnJvd3MgdG8gbW92ZSB0aGUgcG9pbnQuIEhpdCBFTlRFUiB0byBwbG90IGFuZCBiZWdpbiBtb3ZpbmcgdGhlIG5leHQgcG9pbnQuIEhpdCBFTlRFUiB0d2ljZSB0byBmaW5pc2guIiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtcmVjdGFuZ2xlLWRlc2MiOiJDbGljayBhbmQgZHJhZyB0byBkcmF3IGEgcmVjdGFuZ2xlIG9uIHRoZSBtYXAuIiwibGFuZ3VhZ2UtcHJvamVjdC1lcnJvci1vd25lciI6IllvdSBkbyBub3Qgb3duIHRoaXMgcHJvamVjdC4iLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWZlYXR1cmUtbGF5ZXItbW9kdWxlLXN0YXJ0LXN5bmMiOiJTdGFydHMgc3luY2hyb25pemVzIHRoZSBmZWF0dXJlIGVkaXRzIHRvIHRoZSBzZXJ2ZXIuIiwibGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLW91dGxpbmUiOiJPdXRsaW5lIENvbG9yIiwibGFuZ3VhZ2UtY29tbW9uLWZlYXR1cmUtZWRpdGluZyI6IkZlYXR1cmUgQXR0cmlidXRlcyIsImxhbmd1YWdlLW1vbnRocy0yIjoiTWFyY2giLCJsYW5ndWFnZS1tb250aHMtMSI6IkZlYnJ1YXJ5IiwibGFuZ3VhZ2UtdG9vbGJhci1pZGVudGlmeS1jb21iaW5lLXN1YnRyYWN0LWVuYWJsZSI6IkVuYWJsZSBTdWJ0cmFjdCBSZXN1bHRzIiwibGFuZ3VhZ2UtbW9udGhzLTQiOiJNYXkiLCJsYW5ndWFnZS1tb250aHMtMyI6IkFwcmlsIiwibGFuZ3VhZ2Utc21hcnQtcGFuZWwtbWVudSI6IlBhbmVsIEFjdGlvbnMgTWVudS4gQ2xpY2sgdG8gb3Blbi9jbG9zZS4iLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXNob3ctbWFwIjoiQWN0aXZhdGVzIG1hcCB2aWV3LiIsImxhbmd1YWdlLW1vbnRocy0wIjoiSmFudWFyeSIsImxhbmd1YWdlLW1vbnRocy05IjoiT2N0b2JlciIsImxhbmd1YWdlLXRvb2xiYXItbmF2aWdhdGlvbi1uZXh0LWV4dGVudC10b29sdGlwIjoiWm9vbSB0byB0aGUgbmV4dCBleHRlbnQiLCJsYW5ndWFnZS1tb250aHMtNiI6Ikp1bHkiLCJsYW5ndWFnZS1tb250aHMtNSI6Ikp1bmUiLCJsYW5ndWFnZS1tZW51LXN3aXRjaC10by1sYXllcmxpc3QiOiJTaG93IExheWVyIExpc3QiLCJsYW5ndWFnZS1tb250aHMtOCI6IlNlcHRlbWJlciIsImxhbmd1YWdlLW1vbnRocy03IjoiQXVndXN0IiwibGFuZ3VhZ2UtbWVudS1leHBvcnQtcmVzdWx0cy10by1zaHAtZGVzYyI6IkV4cG9ydCByZXN1bHRzIHRvIFNoYXBlZmlsZSIsImxhbmd1YWdlLW1lbnUtaWRlbnRpZnktcG9pbnQtZGVzYyI6IkRyYXcgYSBwb2ludCBvbiB0aGUgbWFwIHRvIHZpZXcgaW5mb3JtYXRpb24gYXQgdGhhdCBwb2ludCBvbiB0aGUgbWFwLiIsImxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1tYXJrZXItc3R5bGUtc3F1YXJlIjoiU3F1YXJlIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1pbnZva2UtbWFwLXRpcCI6IkV4ZWN1dGVzIGFuIElkZW50aWZ5IG9wZXJhdGlvbiBvbiB0aGUgZ2l2ZW4gZ2VvbWV0cnkgYW5kIFwiTWFwVGlwXCIgYXMgaXRzIHNvdXJjZSB0YWcuIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1jbG9zZS1mZWF0dXJlLXNldC1jb2xsZWN0aW9uIjoiQ2xvc2VzIHRoZSBmZWF0dXJlIHNldCBjb2xsZWN0aW9uLiIsImxhbmd1YWdlLW1lbnUtYnJvd3NlLXNhdmVkLXJlc3VsdHMtZGVzYyI6IkNob29zZSBmcm9tIGEgbGlzdCBvZiBzYXZlZCByZXN1bHRzIHRvIHZpZXcgdGhlbSIsImxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1lbmRjb2xvciI6IkVuZCBDb2xvciIsImxhbmd1YWdlLW1lbnUtZW50ZXItb25saW5lIjoiR28gdG8gb25saW5lIG1vZGUiLCJsYW5ndWFnZS1tZW51LWVkaXQtZmVhdHVyZS1kZXNjcmlwdGlvbiI6IkVkaXQgdGhlIGRldGFpbHMgYWJvdXQgdGhpcyBmZWF0dXJlLiIsImxhbmd1YWdlLW1lbnUtaWRlbnRpZnktZnJlZWhhbmQiOiJJZGVudGlmeSBieSBmcmVlaGFuZCBzaGFwZSIsImxhbmd1YWdlLXRvb2xiYXItbmF2aWdhdGlvbi16b29tLW91dC1kZXNjIjoiRHJhZyBhIHJlY3RhbmdsZSBvbiB0aGUgbWFwIHRvIHpvb20gb3V0IHdoaWxlIGtlZXBpbmcgdGhhdCBhcmVhIGNlbnRlcmVkIiwibGFuZ3VhZ2UtbWVudS1pZGVudGlmeS1idWZmZXJlZC1mZWF0dXJlLXNldC1jb2xsZWN0aW9uIjoiU2hvdyBCdWZmZXIgT3B0aW9ucyIsImxhbmd1YWdlLXRvb2xiYXItZ3JvdXAtcGxvdGNvb3JkaW5hdGVzIjoiQ29vcmRpbmF0ZXMiLCJsYW5ndWFnZS10b29sYmFyLW5hdmlnYXRpb24tem9vbS1vdXQiOiJab29tIE91dCIsImxhbmd1YWdlLXRvb2xiYXItc25hcHBpbmctYWx0LWVuYWJsZSI6IkVuYWJsZSBzbmFwcGluZyBmb3IgYWN0aXZlIHRvb2wiLCJsYW5ndWFnZS1vZmZsaW5lLXByb2dyZXNzLXVucmVnaXN0ZXJpbmdyZXBsaWNhIjoiVW5yZWdpc3RlcmluZyByZXBsaWNhLiIsImxhbmd1YWdlLWhvdXJzLWFiYnIiOiJIIiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtZGVsZXRlLWRlc2Mta2V5Ym9hcmQiOiJVc2UgYXJyb3dzIHRvIG1vdmUgdGhlIHBvaW50LiBIaXQgRU5URVIgdG8gaW1tZWRpYXRlbHkgYW5kIHBlcm1hbmVudGx5IGRlbGV0ZSBhIGRyYXdpbmcuIFRoaXMgY2Fubm90IGJlIHVuZG9uZS4iLCJsYW5ndWFnZS10b29sYmFyLXNlbGVjdC1sYXllcnMtdG9nZ2xlLW9uLW5hbWUiOiJGaWx0ZXIgTGF5ZXJzIiwibGFuZ3VhZ2UtdG9vbGJhci1pZGVudGlmeS1yZWN0YW5nbGUiOiJSZWN0YW5nbGUiLCJsYW5ndWFnZS10b29sYmFyLXNuYXBwaW5nLXNlbGVjdC1sYXllcnMtdG9vbHRpcCI6IkNoYW5nZSB3aGljaCBsYXllcnMgYXJlIHNuYXBwYWJsZSIsImxhbmd1YWdlLW9mZmxpbmUtZXJyb3JzLW5vdGZvdW5kIjoiT2ZmbGluZSBwcm9maWxlIG5vdCBmb3VuZC4iLCJsYW5ndWFnZS1yZXN1bHRzLXBhZ2UtcHJldiI6IlByZXZpb3VzIHBhZ2UiLCJsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtaGFsbyI6IkhhbG8iLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWNsb3NlLW1vZGFsLXJlZ2lvbiI6IkNsb3NlcyB0aGUgTW9kYWxXaW5kb3dSZWdpb24uIiwibGFuZ3VhZ2UtdG9vbGJhci1uYXZpZ2F0aW9uLWhvbWUtc3ViIjoiSG9tZSIsImxhbmd1YWdlLWFjY2Vzc2liaWxpdHktZm9ybS1uYW1lZC1jb250YWluZXItaGlkZGVuIjoiRm9ybSBncm91cCAnezB9JyBoaWRkZW4uIiwibGFuZ3VhZ2UtdG9vbGJhci10YWItY29sbGFib3JhdGlvbiI6IkNvbGxhYm9yYXRpb24iLCJsYW5ndWFnZS1vZmZsaW5lLWVycm9ycy1jYW5jZWxyZWplY3RlZCI6IkNhbm5vdCBjYW5jZWwgcmlnaHQgbm93LiIsImxhbmd1YWdlLXRvb2xiYXItb3Blbi1hZnRlci1hY3Rpb24tdG9vbHRpcCI6Ik9wZW4gdGhlIEFmdGVyIEFjdGlvbiBQbGF5YmFjayBpbnRlcmZhY2UuIiwibGFuZ3VhZ2UtbWVudS1lZGl0LWZlYXR1cmUiOiJFZGl0IHRoaXMgRmVhdHVyZSIsImxhbmd1YWdlLXRvb2xiYXItbWFya3VwLXBvaW50LXRvb2x0aXAiOiJBZGQgYSBwb2ludCB0byB0aGUgbWFwIiwibGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLWxpbmUtc3R5bGUtc29saWQiOiJTb2xpZCIsImxhbmd1YWdlLWNvb3JkaW5hdGVzLW1pbnV0ZXMiOiInIiwibGFuZ3VhZ2UtbWVudS1tYXAtbGF5ZXJzIjoiQ2hhbmdlIHZpc2libGUgbWFwIGxheWVycyIsImxhbmd1YWdlLWdyYW50LWVkaXRvci1tb25pa2VyLXR5cGUtdXNlciI6IkluZGl2aWR1YWxzIiwibGFuZ3VhZ2UtdG9vbGJhci1jaGFydGluZy1zaG93LWNoYXJ0cyI6IlZpZXcgQ2hhcnRzIiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtcG9seWxpbmUtZGVzYyI6IkNsaWNrIG9yIHRhcCBsb2NhdGlvbnMgYWxvbmcgdGhlIG1hcCB0byBjcmVhdGUgYSBsaW5lLiBEb3VibGUgY2xpY2svdGFwIHRvIGZpbmlzaC4iLCJsYW5ndWFnZS10b29sYmFyLXRhc2tzLWlkZW50aWZ5IjoiSWRlbnRpZnkiLCJsYW5ndWFnZS10b29sYmFyLWlkZW50aWZ5LXJlY3RhbmdsZS1kZXNjIjoiVG8gbGVhcm4gd2hhdFx1MjAxOXMgdGhlcmUsIGNsaWNrIG9yIHRhcCBhbmQgZHJhZyB0byBkcmF3IGEgcmVjdGFuZ2xlIG9uIHRoZSBtYXAuIiwibGFuZ3VhZ2UtcHJvamVjdC1lcnJvci1kZWxldGUiOiJUaGUgcHJvamVjdCBjb3VsZCBub3QgYmUgZGVsZXRlZC4gUmVmZXIgdG8gdGhlIGxvZyBmb3IgbW9yZSBkZXRhaWxzLiIsImxhbmd1YWdlLXNtYXJ0LXBhbmVsLWJhY2siOiJHbyBCYWNrIGluIFBhbmVsIiwibGFuZ3VhZ2UtY29tbW9uLXRleHQiOiJUZXh0IiwibGFuZ3VhZ2Utc3RhdGVzLWJ1ZmZlcmluZy1kZXNjcmlwdGlvbiI6IkJ1ZmZlcmluZyBpcyBlbmFibGVkIGZvciB0aGUgY3VycmVudCB0b29sLiIsImxhbmd1YWdlLW1lbnUtcmVtb3ZlLXVzZXItYWRkZWQtbGF5ZXItZGVzYyI6IlJlbW92ZSB0aGlzIHVzZXIgYWRkZWQgbGF5ZXIgZnJvbSB0aGUgbWFwLiIsImxhbmd1YWdlLW1lbnUtZXhwb3J0LXJlc3VsdHMtdG8tc2hwIjoiRXhwb3J0IHRvIFNoYXBlZmlsZSIsImxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1saW5lLXN0eWxlLWxvbmdkYXNoIjoiTG9uZy1kYXNoIiwibGFuZ3VhZ2UtbWVudS1leHBvcnQtcmVzdWx0cy10by14bHN4IjoiRXhwb3J0IHRvIFhMU1giLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXNob3ctbGF5ZXItbGlzdCI6IkFjdGl2YXRlcyB0aGUgTGF5ZXJMaXN0IFZpZXcuIiwibGFuZ3VhZ2Utb2ZmbGluZS1wcm9ncmVzcy1ieXRlcyI6InswfSBieXRlcyIsImxhbmd1YWdlLWNvbW1vbi1pZGVudGlmeS1yZXN1bHRzIjoiSWRlbnRpZnkgUmVzdWx0cyIsImxhbmd1YWdlLXJlc3VsdHMtdG9nZ2xlLXRhYmxlLXZpZXctZGVzYyI6IlZpZXcgcmVzdWx0cyBpbiB0YWJsZSBmb3JtYXQiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXRha2UtYXBwbGljYXRpb24tb2ZmbGluZSI6IlB1dHMgdGhlIGFwcGxpY2F0aW9uIGluIGFuIG9mZmxpbmUgc3RhdGUuIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1zdGFydC1lZGl0aW5nLWZlYXR1cmUiOiJCZWdpbnMgZWRpdGluZyBhbiBleGlzdGluZyBmZWF0dXJlLiIsImxhbmd1YWdlLW1lbnUtY29tYmluZS1yZXN1bHRzLWludGVyc2VjdCI6Ik1hdGNoIGludGVyc2VjdGluZyByZXN1bHRzIiwibGFuZ3VhZ2UtbWVudS1yZXN1bHRzLWxpc3QtYWN0aW9ucy1kZXNjIjoiUmVzdWx0cyBMaXN0IEFjdGlvbnMiLCJsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtcG9pbnQtc3VmZml4IjoicHQiLCJsYW5ndWFnZS1vZmZsaW5lLXByb2dyZXNzLWJhc2VtYXBleHBvcnQtY29tcGxldGVkIjoiezB9IGdlbmVyYXRlZCBhbmQgZG93bmxvYWRlZC4iLCJsYW5ndWFnZS1jb21tb24taGlkZSI6IkhpZGUiLCJsYW5ndWFnZS10b29sYmFyLXRhYi1uYXZpZ2F0aW9uIjoiTmF2aWdhdGlvbiIsImxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1ub2RhdGEtdGl0bGUiOiJObyBEYXRhIiwibGFuZ3VhZ2UtY29tbW9uLWFwcGx5IjoiQXBwbHkiLCJsYW5ndWFnZS10b29sYmFyLW1hcmt1cC1lZGl0LXpvb21vdXQtdG9vbCI6Ilpvb21PdXRUb29sIiwibGFuZ3VhZ2UtY29tbW9uLWxvYWQiOiJMb2FkIiwibGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLXBpeGVsLXN1ZmZpeCI6InB4IiwibGFuZ3VhZ2UtY29tbW9uLXJlc3VsdHMiOiJSZXN1bHRzIiwibGFuZ3VhZ2UtbWVudS1icm93c2Utc2F2ZWQtcmVzdWx0cyI6Ik9wZW4gU2F2ZWQgUmVzdWx0cyIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tZ2V0LXJlbGF0ZWQtZmVhdHVyZSI6IkdldHMgZmVhdHVyZXMgcmVsYXRlZCB0byB0aGUgZmVhdHVyZS4iLCJsYW5ndWFnZS10b29sYmFyLW1hcmt1cC1mcmVlaGFuZCI6IkZyZWVoYW5kIiwibGFuZ3VhZ2UtbWVudS1tYXB0aXAtYWN0aW9ucyI6IkFjdGlvbnMiLCJsYW5ndWFnZS10b29sYmFyLW1hcmt1cC1leHBvcnQtdG9vbHRpcCI6IkV4cG9ydCBkcmF3aW5ncyB0byBzaGFwZWZpbGUiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXByb2plY3QiOiJDYWxscyBhIGdlb21ldHJ5IHNlcnZpY2UgdG8gcHJvamVjdCBnZW9tZXRyaWVzIGJldHdlZW4gZGlmZmVyZW50IGNvb3JkaW5hdGUgc3lzdGVtcy4iLCJsYW5ndWFnZS1tZW51LW9mZmxpbmUtbWFwLWVkaXRvci1nZW9tZXRyeS1hY3Rpb25zLXBvbHlnb24iOiJQb2x5Z29uIiwibGFuZ3VhZ2UtcmVzdWx0cy1wYWdlLWxhc3QiOiJMYXN0IHBhZ2UiLCJsYW5ndWFnZS1jb21tb24tYmFjayI6IkJhY2siLCJsYW5ndWFnZS1tZW51LWVudGVyLW9ubGluZS1kZXNjIjoiR28gdG8gb25saW5lIG1vZGUgYW5kIHZpZXcgbGl2ZSBtYXAgZGF0YSBmcm9tIHRoZSB3ZWIuIiwibGFuZ3VhZ2UtbWVudS1vZmZsaW5lLW1hcC1lZGl0b3ItZ2VvbWV0cnktYWN0aW9ucy1jaXJjbGUtZGVzYyI6IkRyYXcgYSBjaXJjbGUgZm9yIHRoZSBhcmVhIG9mIGludGVyZXN0IGdlb21ldHJ5LiIsImxhbmd1YWdlLWNvbW1vbi1sb2FkaW5nIjoiTG9hZGluZy4uLiIsImxhbmd1YWdlLW1lbnUtdmlzdWFsaXphdGlvbi1kZXNjIjoiQ3JlYXRlIGFuZCB2aWV3IGN1c3RvbSBsYXllciB2aXN1YWxpemF0aW9ucyBzdWNoIGFzIGhlYXQgbWFwcywgY2x1c3RlcmluZywgYW5kIGxheWVyIHN0eWxlcy4iLCJsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtZmlsbC1zdHlsZS1zb2xpZCI6IlNvbGlkIiwiLy90aW1lcGlja2VyLnJlZ2lvbmFsLmhlbHAiOiJDb3B5IHNldHRpbmdzIGZyb20gb25lIG9mIHRoZSBmaWxlcyBpbiBodHRwczovL2dpdGh1Yi5jb20vdHJlbnRyaWNoYXJkc29uL2pRdWVyeS1UaW1lcGlja2VyLUFkZG9uL3RyZWUvbWFzdGVyL3NyYy9pMThuIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1wYW4tdG8tcG9pbnQiOiJQYW5zIHRvIGEgcG9pbnQgb3Igb3RoZXIgdHlwZSBvZiBHZW9tZXRyeS4iLCJsYW5ndWFnZS10b29sYmFyLW1hcmt1cC1lbGxpcHNlIjoiRWxsaXBzZSIsImxhbmd1YWdlLXRvb2xiYXItdGFiLWFuYWx5c2lzIjoiQW5hbHlzaXMiLCJsYW5ndWFnZS1zbWFydC1wYW5lbC1jbG9zZSI6IkNsb3NlIFBhbmVsIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1mZWF0dXJlLWxheWVyLWNsZWFyLWRhdGEiOiJDbGVhcnMgdGhlIGRhdGEgZm9yIGEgZ2l2ZW4gbWFwIHNlcnZpY2UgVVJMLiIsImxhbmd1YWdlLWNvbW1vbi1jdXN0b21pemUiOiJDdXN0b21pemUiLCJsYW5ndWFnZS1mcmFtZXdvcmstdWktdmlldy1jb250YWluZXItdmlldy1iYWNrIjoiR28gQmFjayB7MH0iLCJsYW5ndWFnZS10b29sYmFyLWlkZW50aWZ5LWZyZWVoYW5kLXRvb2x0aXAiOiJGaW5kIG91dCBhYm91dCBhbiBhcmVhIG9uIHRoZSBtYXAgZGVmaW5lZCBieSBhIGZyZWVoYW5kIHNoYXBlIiwibGFuZ3VhZ2Utc3RhdGVzLWZlYXR1cmUtZWRpdGluZy1zdGF0ZS1kZXNjcmlwdGlvbiI6IlRoZSBjcmVhdGUgYSBmZWF0dXJlIHRvb2wgaXMgY3VycmVudGx5IGFjdGl2ZS4iLCJsYW5ndWFnZS1jb21tb24tY3JlYXRlIjoiQ3JlYXRlIiwibGFuZ3VhZ2UtZ3JhbnQtZWRpdG9yLWdsb2JhbC1ncmFudC1uYW1lLXVzZXIiOiJTaWduZWQtaW4gVXNlcnMiLCJsYW5ndWFnZS1tZW51LW9mZmxpbmUtbWFwLWVkaXRvci1nZW9tZXRyeS1hY3Rpb25zLXBvbHlnb24tZGVzYyI6IkRyYXcgYSBwb2x5Z29uIGZvciB0aGUgYXJlYSBvZiBpbnRlcmVzdCBnZW9tZXRyeS4iLCJsYW5ndWFnZS1zdGF0ZXMtbWVhc3VyZS1zdGF0ZS1kZXNjcmlwdGlvbiI6IlRoZSBtZWFzdXJpbmcgdG9vbCBpcyBjdXJyZW50bHkgYWN0aXZlLiIsImxhbmd1YWdlLW1lbnUtc29jaWFsLWxpbmtzLW1lbnUtZGVzYyI6IlNvY2lhbCBMaW5rcyIsImxhbmd1YWdlLW1lbnUtYWRkLWEtZmVhdHVyZSI6IkNyZWF0ZSBhIGZlYXR1cmUiLCJsYW5ndWFnZS1jb21tb24tcmV2ZXJ0IjoiUmV2ZXJ0IiwibGFuZ3VhZ2UtcGFnZS10b3RhbCI6IlRvdGFsIiwibGFuZ3VhZ2UtdG9vbGJhci1uYXZpZ2F0aW9uLXBhbi10b29sdGlwIjoiQ2FuY2VsIGFueSBhY3RpdmUgdG9vbHMgYW5kIHB1dCB0aGUgbWFwIGludG8gcGFuIG1vZGUiLCJsYW5ndWFnZS11aS10YWJsZS1zb3J0ZWQtZGVzY2VuZGluZyI6IkNvbHVtbiBoZWFkZXIuIHswfSAtIFNvcnRlZCBkZXNjZW5kaW5nLiIsImxhbmd1YWdlLW9mZmxpbmUtcHJvZ3Jlc3MtYmFzZW1hcGV4cG9ydC1kb3dubG9hZGluZyI6InswfSAtIHsxfSBvZiB7Mn0gKHszfSUpIGRvd25sb2FkZWQuIHs0fS4iLCJsYW5ndWFnZS1jb21tb24tZmVhdHVyZS1lZGl0bG9nLWRlc2MiOiJEaXNwbGF5cyBpbmZvcm1hdGlvbiBhYm91dCBlZGl0aW5nIGhpc3Rvcnkgb2YgdGhlIGZlYXR1cmUgbGF5ZXIuIiwibGFuZ3VhZ2UtY29vcmRpbmF0ZXMtbG9uZ2l0dWRlLWFiYnJldiI6IkxvbiIsImxhbmd1YWdlLXN5bWJvbG9neS1lcnJvcnMtZmllbGQtbm90LWZvdW5kIjoiQSBmaWVsZCB3YXMgdXNlZCB0byBjb25maWd1cmUgYSByZW5kZXJlciwgYnV0IHRoZSBmaWVsZCBjYW4gbm8gbG9uZ2VyIGJlIGZvdW5kLiBUaGlzIHJlbmRlcmVyIHdpbGwgbm90IGJlIGxvYWRlZC4iLCJsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3Mtc3ltYm9sLWRpc3BsYXluYW1lIjoiU3ltYm9sIiwibGFuZ3VhZ2Utd2VibWFwLWxheWVyLW5hbWUtcG9seWdvbiI6IlBvbHlnb25zIiwibGFuZ3VhZ2UtbWVudS1zaG93LXJlc3VsdHMtbGlzdCI6Ikxpc3QgVmlldyIsImxhbmd1YWdlLW1lbnUtY2VudGVyLXRleHRtYXAtZGVzYyI6IkNlbnRlciB0aGUgbWFwIG9uIHRoZSBwb2ludCBzcGVjaWZpZWQuIiwibGFuZ3VhZ2UtdG9vbGJhci1pbmZvcm1hdGlvbi1hY3Rpb25zIjoiSW5mb3JtYXRpb24gJiBBY3Rpb25zIiwibGFuZ3VhZ2UtY29tbW9uLWZlYXR1cmUtbGF5ZXItZGV0YWlscyI6IlN5bmMgU2V0dGluZ3MgZm9yIHswfSIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tc2hvdy1yZXN1bHRzLXRhYmxlIjoiRGlzcGxheXMgdGhlIGxpc3Qgb2YgZmVhdHVyZXMgaW4gdGhlIGdpdmVuIGZlYXR1cmUgc2V0IGNvbGxlY3Rpb24gaW4gYSB0YWJ1bGFyIHZpZXcuIiwibGFuZ3VhZ2UtbWVudS1mZWF0dXJlLXNldC1yZXN1bHRzLWFjdGlvbnMtZGVzYyI6IkZlYXR1cmUgU2V0IFJlc3VsdHMgQWN0aW9ucyIsImxhbmd1YWdlLXJlc3VsdHMtZXhwb3J0LXRvLWNvbmZpcm0tdGl0bGUiOiJEb3dubG9hZCBcIi57MH1cIiBmaWxlIiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtZHJhd2luZy10b29scyI6IkRyYXciLCJsYW5ndWFnZS1tZW51LXNob3ctY2hhcnRpbmctdmlldyI6IkNoYXJ0aW5nIFZpZXciLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWNsZWFyLWRlZmF1bHQtaGlnaGxpZ2h0cyI6IlJlbW92ZXMgdGhlIGhpZ2hsaWdodHMgZnJvbSB0aGUgZGVmYXVsdCBoaWdobGlnaHQgbGF5ZXIuIiwibGFuZ3VhZ2UtbWVudS1tYXB0aXAtYWN0aW9ucy1kZXNjIjoiTWFwVGlwIEFjdGlvbnMiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWNoYW5nZS1lZGl0LWxvZy1lbnRyeSI6IkNoYW5nZSBhbiBleGlzdGluZyBlZGl0IGxvZyBlbnRyeS4iLCJsYW5ndWFnZS10b29sYmFyLW1hcmt1cC1mcmVlaGFuZC1kZXNjIjoiSG9sZCB0aGUgbW91c2UgYnV0dG9uIG9yIHlvdXIgZmluZ2VydGlwIGRvd24sIHRoZW4gZHJhdyBhIGZyZWVoYW5kIGxpbmUuIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1jb25maXJtIjoiRGlzcGxheXMgYSBjb25maXJtLiIsImxhbmd1YWdlLW1lbnUtY29weS10by1kcmF3aW5ncyI6IkNvcHkgdG8gRHJhd2luZyBMYXllciIsImxhbmd1YWdlLXVpLXRhYmxlLXVuc29ydGVkIjoiQ29sdW1uIGhlYWRlci4gezB9IC0gVW5zb3J0ZWQiLCJsYW5ndWFnZS1vZmZsaW5lLXByb2dyZXNzLWtpbG9ieXRlcyI6InswfSBrQiIsImxhbmd1YWdlLW1lbnUtYnVmZmVyLWlkZW50aWZ5LWZlYXR1cmUtZGVzYyI6IklkZW50aWZ5IG5lYXJieSBmZWF0dXJlcyIsImxhbmd1YWdlLXRvb2xiYXItbWFya3VwLWVsbGlwc2UtdG9vbHRpcCI6IkRyYXcgYW4gZWxsaXBzZSBvbiB0aGUgbWFwIiwibGFuZ3VhZ2UtdG9vbGJhci1ncm91cC1hcmNnaXMiOiJBcmNHSVMiLCJsYW5ndWFnZS1jb21tb24tZG9uZSI6IkRvbmUiLCJsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtdGV4dC1kaXNwbGF5bmFtZSI6IlRleHQiLCJsYW5ndWFnZS1tZW51LWdsb2JhbC1zZWFyY2gtZGVzYyI6IlNlYXJjaCBmb3IgZmVhdHVyZXMgb24gdGhlIG1hcC4iLCJsYW5ndWFnZS1tZW51LWVudGVyLW9mZmxpbmUiOiJHbyB0byBvZmZsaW5lIG1vZGUiLCJsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3Mtbm8taW1hZ2UtbGlicmFyaWVzIjoiTm8gdmFsaWQgaW1hZ2UgbGlicmFyaWVzIHdlcmUgY29uZmlndXJlZC4gUGxlYXNlIGNvbnRhY3QgeW91ciBhZG1pbmlzdHJhdG9yLiIsImxhbmd1YWdlLW1lbnUtY29tYmluZS1yZXN1bHRzLWludGVyc2VjdC1kZXNjIjoiT25seSBzaG93IHJlc3VsdHMgdGhhdCBhcmUgaW4gYm90aCB5b3VyIGN1cnJlbnQgbGlzdCBhbmQgYSBzYXZlZCBzZXQgb2YgcmVzdWx0cyIsImxhbmd1YWdlLXRvb2xiYXItdGFza3Mtc2hhcmUiOiJTaGFyZSIsImxhbmd1YWdlLWNvbnRlbnQtcG9saWN5LXByb21wdC11cmktcmVqZWN0LWJ0biI6Ik5vLCBkbyBub3QgbG9hZCIsImxhbmd1YWdlLXRvb2xiYXItaWRlbnRpZnktcG9seWdvbi1kZXNjLWtleWJvYXJkIjoiVG8gbGVhcm4gd2hhdFx1MjAxOXMgdGhlcmUsIHVzZSBhcnJvd3MgdG8gbW92ZSB0aGUgcG9pbnQuIEhpdCBFTlRFUiB0byBwbG90IGFuZCBiZWdpbiBtb3ZpbmcgdGhlIG5leHQgcG9pbnQuIEhpdCBFTlRFUiB0d2ljZSB0byBmaW5pc2guIiwibGFuZ3VhZ2Utc3RhdGVzLXNuYXBwaW5nLWRlc2NyaXB0aW9uIjoiU25hcHBpbmcgaXMgZW5hYmxlZCBmb3IgdGhlIGN1cnJlbnQgdG9vbC4iLCJsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3Mtbm9kYXRhIjoiTm8gc3ltYm9saXphYmxlIGRhdGEgd2FzIGZvdW5kIGluIHRoZSBzZWxlY3RlZCBhdHRyaWJ1dGUuIiwibGFuZ3VhZ2UtbWVudS1jb21iaW5lLXJlc3VsdHMtc3VidHJhY3QiOiJTdWJ0cmFjdCBzYXZlZCByZXN1bHRzIiwibGFuZ3VhZ2UtcHJvamVjdC1lcnJvci10aXRsZSI6IlByb2plY3QgRXJyb3IiLCJsYW5ndWFnZS1jb29yZGluYXRlcy1zb3V0aC1hYmJyZXYiOiJTIiwibGFuZ3VhZ2Utc3RhdGVzLXBsb3Rjb29yZGluYXRlcy1zdGF0ZS1kZXNjcmlwdGlvbiI6IlRoZSBQbG90IENvb3JkaW5hdGVzIHRvb2wgaXMgY3VycmVudGx5IGFjdGl2ZS4iLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXN0ZXAtem9vbS1pbiI6Ilpvb21zIGluIGEgc3RlcCIsImxhbmd1YWdlLWNvbW1vbi1zYXZpbmciOiJTYXZpbmcuLi4iLCJsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3Mtc2VsZWN0IjoiVHlwZSIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tdG9nZ2xlLXZpZXciOiJBY3RpdmF0ZXMgb3IgZGVhY3RpdmF0ZXMgYSB2aWV3LiIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tdGFrZS1hcHBsaWNhdGlvbi1vbmxpbmUiOiJDb25uZWN0cyB0aGUgYXBwbGljYXRpb24gdG8gdGhlIGludGVybmV0LiIsImxhbmd1YWdlLXRvb2xiYXItaWRlbnRpZnktcG9seWxpbmUiOiJMaW5lIiwibGFuZ3VhZ2UtdG9vbGJhci10b2dnbGUtYnVmZmVyLW9mZi1uYW1lIjoiQnVmZmVyaW5nIE9uIiwibGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLWZpbGwtc3R5bGUtdmVydGljYWwiOiJWZXJ0aWNhbCIsImxhbmd1YWdlLXBhZ2UtZGlzcGxheWluZyI6IkRpc3BsYXlpbmciLCJsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtZmlsbC1zdHlsZS1jcm9zcyI6IkNyb3NzIiwibGFuZ3VhZ2UtZ3JhbnQtZWRpdG9yLXRhYmxlLWhlYWRlci1ub25lIjoiTm9uZSIsImxhbmd1YWdlLXRvb2xiYXItdGFza3MtYWRkLWxheWVycy10b29sdGlwIjoiQWRkIGxheWVycyB0byB0aGUgbWFwIiwibGFuZ3VhZ2UtcGFnZS1maXJzdCI6IkZpcnN0IHBhZ2UiLCJsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtYnJlYWtzIjoiQ2xhc3NlcyIsImxhbmd1YWdlLW9mZmxpbmUtcHJvZ3Jlc3MtcmVtb3ZpbmdvZmZsaW5lbWFwIjoiUmVtb3Zpbmcgb2ZmbGluZSBtYXAuIiwibGFuZ3VhZ2UtbWVudS1jZW50ZXItbWFwIjoiQ2VudGVyIHRoZSBNYXAgSGVyZSIsImxhbmd1YWdlLXRvb2xiYXItYnVmZmVyaW5nLWVuYWJsZSI6IkVuYWJsZSBidWZmZXJpbmciLCJsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtbGluZS1zdHlsZS1zaG9ydGRhc2hkb3QiOiJTaG9ydC1kYXNoLWRvdCIsImxhbmd1YWdlLXRvb2xiYXItc2VsZWN0LWxheWVycy10b2dnbGUtb2ZmLW5hbWUiOiJMYXllcnMgYXJlIEZpbHRlcmVkIiwibGFuZ3VhZ2Utb2ZmbGluZS1wcm9ncmVzcy1jb21wbGV0ZSI6IkNvbXBsZXRlLiIsImxhbmd1YWdlLW1lbnUtZXhwb3J0LXJlc3VsdHMtdG8tY3N2IjoiRXhwb3J0IHRvIENTViIsImxhbmd1YWdlLXRvb2xiYXItbWFya3VwLWNpcmNsZS10b29sdGlwIjoiRHJhdyBhIGNpcmNsZSBvbiB0aGUgbWFwIiwibGFuZ3VhZ2UtcHJvamVjdC1lcnJvci1yZWFkIjoiVGhlIHByb2plY3QgY291bGQgbm90IGJlIG9wZW5lZC4gUmVmZXIgdG8gdGhlIGxvZyBmb3IgbW9yZSBkZXRhaWxzLiIsImxhbmd1YWdlLWNvbW1vbi1mZWF0dXJlLXRlbXBsYXRlLXBpY2tlci1kZXNjIjoiU2VsZWN0IGEgZmVhdHVyZSB0eXBlLiIsImxhbmd1YWdlLWZpbGUtcGlja2VyLW5vdC1zdXBwb3J0ZWQiOiJUaGUgZmlsZSBwaWNrZXIgaXMgbm90IHN1cHBvcnRlZCBieSB5b3VyIGJyb3dzZXIuIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1jbGVhci1tYXJrdXAtcXVpZXQiOiJDbGVhcnMgYWxsIG9mIHRoZSBtYXJrdXAgZnJvbSB0aGUgbWFya3VwIGxheWVyIHdpdGhvdXQgcHJvbXB0aW5nIGZvciBjb25maXJtYXRpb24uIiwibGFuZ3VhZ2UtY29tbW9uLW1lYXN1cmVtZW50LXJlc3VsdHMtZmllbGQtbGVuZ3RoIjoiTGVuZ3RoIiwibGFuZ3VhZ2UtdG9vbGJhci1pZGVudGlmeS1wb2x5bGluZS10b29sdGlwIjoiRmluZCBvdXQgYWJvdXQgYW4gYXJlYSBvbiB0aGUgbWFwIGRlZmluZWQgYnkgYSBsaW5lIiwibGFuZ3VhZ2UtbWVudS1jb21iaW5lLXJlc3VsdHMtZGVzYyI6IlBlcmZvcm0gYWR2YW5jZWQgb3BlcmF0aW9ucyB3aXRoIG11bHRpcGxlIGxpc3RzIG9mIHJlc3VsdHMiLCJsYW5ndWFnZS10b29sYmFyLXRhYi1lZGl0aW5nIjoiRWRpdGluZyIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tc2V0LWhpZ2hsaWdodC1maWxsLWNvbG9yIjoiU2V0cyB0aGUgZmlsbCBjb2xvciB1c2VkIGZvciBuZXcgaGlnaGxpZ2h0cywgc3BlY2lmaWVkIGluIDYgb3IgOCBkaWdpdCBoZXggaW4gUkdCIG9yIEFSR0IgZm9ybS4iLCJsYW5ndWFnZS1yZXN1bHRzLWZlYXR1cmUtZWxlbWVudC10aXRsZSI6IkNsaWNrIHRvIHZpZXcgZmVhdHVyZSBkZXRhaWxzLiIsImxhbmd1YWdlLW1lbnUtbGFiZWwtb3B0aW9ucy10b2dnbGUiOiJUb2dnbGUgbGFiZWxzIiwibGFuZ3VhZ2UtZ3JhbnQtZWRpdG9yLW1vbmlrZXItdHlwZS1yb2xlIjoiR3JvdXBzIiwibGFuZ3VhZ2Utb2ZmbGluZS1wcm9ncmVzcy1iYXNlbWFwZXhwb3J0LXByb2Nlc3NpbmciOiJ7MH0gZ2VuZXJhdGluZy4uLiIsImxhbmd1YWdlLW1lbnUtcmVzdWx0cy1hZGQtZmVhdHVyZSI6IkFkZCB0byBSZXN1bHRzIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1mZWF0dXJlLWxheWVyLWNsZWFyLWNhY2hlLXNwZWMiOiJTcGVjaWZ5IHRoaXMgbGF5ZXIgYXMgbm90IHRvIGJlIGNhY2hlZCBvbiBuZXh0IHN5bmMuIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1yZW1vdmUtaGlnaGxpZ2h0LWxheWVyIjoiUmVtb3ZlcyB0aGUgaGlnaGxpZ2h0IGxheWVyIHdpdGggdGhlIHNwZWNpZmllZCBuYW1lLCBpZiB0aGVyZSBpcyBvbmUuIiwibGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLW1hcmtlci1zdHlsZS1kaWFtb25kIjoiRGlhbW9uZCIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tc2hvdy1tYXAtY2FsbG91dCI6IkRpc3BsYXlzIGEgbWFwIGNhbGxvdXQgYW5jaG9yZWQgdG8gYSBnaXZlbiBwb2ludC4iLCJsYW5ndWFnZS1jb250ZW50LXBvbGljeS1wcm9tcHQtdXJpLWFjY2VwdC1idG4iOiJZZXMiLCJsYW5ndWFnZS10b29sYmFyLW1hcmt1cC1jaGFuZ2UtbWFya3VwLXN0eWxlIjoiU3R5bGVzIiwibGFuZ3VhZ2UtdG9vbGJhci1uYXZpZ2F0aW9uLWZ1bGwtZXh0ZW50LXRvb2x0aXAiOiJSZXR1cm4gdG8gdGhlIGZ1bGwgZXh0ZW50IG9mIHRoZSBtYXAiLCJsYW5ndWFnZS1yZXN1bHRzLWV4cG9ydC10by1jb25maXJtLWNvbnRlbnQiOiJUaGUgXCIuezB9XCIgZmlsZSBpcyBhYm91dCB0byBiZSBkb3dubG9hZGVkLiBDb25maXJtPyIsImxhbmd1YWdlLW1lbnUtZm9vdGVyLW1lbnUtZGVzYyI6IkZvb3RlciBNZW51IiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtZnJlZWhhbmQtcG9seWdvbi10b29sdGlwIjoiRHJhdyBhIGZyZWVoYW5kIHNoYXBlIG9uIHRoZSBtYXAiLCJsYW5ndWFnZS10b29sYmFyLW1lbnUtZ2xvYmFsLXNhdmUtYXMtZGVzYyI6IlNhdmUgdGhlIHN0YXRlIG9mIHlvdXIgdmlld2VyIGluIGEgbmV3IHByb2plY3QiLCJsYW5ndWFnZS1tZW51LWFkZC10ZXh0LWRlc2MiOiJBZGQgc29tZSB0ZXh0IHRvIHRoZSBtYXAuIiwibGFuZ3VhZ2UtbWVudS1ib29rbWFyay1hZGQtZGVzYyI6IkFkZCB0aGUgY3VycmVudCBtYXAgZXh0ZW50IHRvIHRoZSBsaXN0IG9mIGJvb2ttYXJrcywgc28gdGhhdCBJIGNhbiByZXR1cm4gdG8gaXQgbGF0ZXIuIiwibGFuZ3VhZ2UtbWVudS1vZmZsaW5lLW1hcC1lZGl0b3ItZ2VvbWV0cnktYWN0aW9ucy1jdXJyZW50ZXh0ZW50LWRlc2MiOiJVc2UgdGhlIGN1cnJlbnQgZXh0ZW50IGZvciB0aGUgYXJlYSBvZiBpbnRlcmVzdCBnZW9tZXRyeS4iLCJsYW5ndWFnZS10b29sYmFyLXNuYXBwaW5nLXNlbGVjdC1sYXllcnMiOiJTZWxlY3QgU25hcHBpbmcgTGF5ZXJzIiwibGFuZ3VhZ2UtbWVudS1zaG93LXJlc3VsdHMtbGlzdC1kZXNjIjoiU3dpdGNoIHRvIExpc3QgVmlldyIsImxhbmd1YWdlLXRvb2xiYXItZ3JvdXAtZmluZC1kYXRhLXRvb2xzIjoiRmluZCIsImxhbmd1YWdlLXRvb2xiYXItb3Blbi1hZnRlci1hY3Rpb24iOiJBZnRlciBBY3Rpb24gUGxheWJhY2siLCJsYW5ndWFnZS10b29sYmFyLWlkZW50aWZ5LWZyZWVoYW5kLXBvbHlnb24iOiJGcmVlaGFuZCBTaGFwZSBJZGVudGlmeSIsImxhbmd1YWdlLXJlc3VsdHMtcGFnZSI6IlBhZ2UiLCJsYW5ndWFnZS1tZW51LWNvbWJpbmUtcmVzdWx0cy11bmlvbi1kZXNjIjoiQ29tYmluZSBhIHNhdmVkIHNldCBvZiByZXN1bHRzIHdpdGggeW91ciBjdXJyZW50IHJlc3VsdHMgbGlzdCIsImxhbmd1YWdlLXRvb2xiYXItbWFya3VwLXBvbHlsaW5lLXRvb2x0aXAiOiJEcmF3IGEgbGluZSBvbiB0aGUgbWFwIiwibGFuZ3VhZ2UtbWVudS1yZW1vdmUtdXNlci1hZGRlZC1sYXllciI6IlJlbW92ZSBsYXllciIsImxhbmd1YWdlLXRvb2xiYXItbWFya3VwLWNpcmNsZSI6IkNpcmNsZSIsImxhbmd1YWdlLW9mZmxpbmUtcHJvZ3Jlc3MtbWVnYWJ5dGVzIjoiezB9IE1CIiwibGFuZ3VhZ2UtdG9vbGJhci1lZGl0aW5nLXRvb2xzIjoiRWRpdCBGZWF0dXJlcyIsImxhbmd1YWdlLW1lbnUtcnVuLXJlcG9ydCI6IlJ1biBhIFJlcG9ydCIsImxhbmd1YWdlLW1lbnUtcmVzdWx0cy1yZW1vdmUtZmVhdHVyZS1zZXQiOiJSZW1vdmUgZnJvbSBSZXN1bHRzIiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtZGVsZXRlLXRvb2x0aXAiOiJEZWxldGUgYW4gZXhpc3RpbmcgZHJhd2luZyIsImxhbmd1YWdlLWNvbW1vbi1mZWF0dXJlLXRlbXBsYXRlLXBpY2tlciI6IkNyZWF0ZSBOZXcgRmVhdHVyZSIsImxhbmd1YWdlLW1hcHNlcnZpY2UtYWN0aW9ucyI6IlBlcmZvcm0gYW4gYWN0aW9uIG9uIHswfSIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24taW5pdGlhbGl6ZS1zaXRlIjoiVGVsbHMgdGhlIEdlb2NvcnRleCBFc3NlbnRpYWxzIFNpdGUgb2JqZWN0IHRvIGJlZ2luIGluaXRpYWxpemF0aW9uLiIsImxhbmd1YWdlLXRvb2xiYXItbmF0aXZlLXNob3dvZmZsaW5lbWFwcyI6Ik9mZmxpbmUgTWFwcyIsImxhbmd1YWdlLW1lbnUtcnVuLXdvcmtmbG93LWRlc2MiOiJTZWxlY3QgZnJvbSBhIGxpc3Qgb2YgYXZhaWxhYmxlIHRhc2tzLiIsImxhbmd1YWdlLXRvb2xiYXItZ3JvdXAtbGF5ZXJzIjoiTGF5ZXJzIiwibGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLWxpbmUtc3R5bGUtc2hvcnRkYXNoZG90ZG90IjoiU2hvcnQtZGFzaC1kb3QtZG90IiwibGFuZ3VhZ2UtbWVudS1idWZmZXItaWRlbnRpZnktZmVhdHVyZSI6IlNob3cgQnVmZmVyIE9wdGlvbnMiLCJsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtbGluZS1zdHlsZS1zaG9ydGRhc2giOiJTaG9ydC1kYXNoIiwibGFuZ3VhZ2UtdG9vbGJhci1vcGVuLXRvb2xiYXIiOiJPcGVuIHRvb2xiYXIiLCJsYW5ndWFnZS1vZmZsaW5lLWVycm9ycy1sb2FkZmFpbGVkIjoiVW5hYmxlIHRvIGxvYWQuIiwibGFuZ3VhZ2UtdG9vbGJhci10YWItbWFwIjoiTWFwIiwibGFuZ3VhZ2UtdG9vbGJhci1uYXZpZ2F0aW9uIjoiTmF2aWdhdGlvbiIsImxhbmd1YWdlLXRvb2xiYXItbWVudS1nbG9iYWwtb3BlbiI6Ik9wZW4iLCJsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtaW1hZ2UtZGlzcGxheW5hbWUiOiJJbWFnZSIsImxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1saW5lLXN0eWxlLWxvbmdkYXNoZG90IjoiTG9uZy1kYXNoLWRvdCIsImxhbmd1YWdlLXRvb2xiYXItbmF2aWdhdGlvbi1mdWxsLWV4dGVudCI6IkZ1bGwgRXh0ZW50IiwibGFuZ3VhZ2UtdG9vbGJhci10YXNrcy1wcmludC1tYXAiOiJQcmludCIsImxhbmd1YWdlLXRvb2xiYXItZ3JvdXAtZWRpdC1mZWF0dXJlcyI6IkVkaXQgRmVhdHVyZXMiLCJsYW5ndWFnZS10b29sYmFyLWFyY2dpcy1leHBvcnQtd2ViLW1hcCI6IlNhdmUgdG8gQXJjR0lTIiwibGFuZ3VhZ2UtY29tbW9uLXJlc3VsdHMtdW5pb24tY29uZmlybWF0aW9uIjoiJ3swfScgdW5pb25lZCB3aXRoIHsxfSIsImxhbmd1YWdlLW1lbnUtcHJvamVjdC1hY3Rpb25zLWRlc2MiOiJWaWV3IG9wdGlvbnMgcmVsYXRlZCB0byB0aGUgcHJvamVjdC4iLCIvL2RhdGVwaWNrZXIucmVnaW9uYWwuaGVscCI6IkNvcHkgc2V0dGluZ3MgZnJvbSBvbmUgb2YgdGhlIGZpbGVzIGluIGh0dHBzOi8vZ2l0aHViLmNvbS9qcXVlcnkvanF1ZXJ5LXVpL3RyZWUvbWFzdGVyL3VpL2kxOG4iLCJsYW5ndWFnZS10b29sYmFyLW1hcmt1cC1wb2x5Z29uLWRlc2MiOiJDbGljayBvciB0YXAgbG9jYXRpb25zIHRvIGRlZmluZSBhIHBvbHlnb24uIERvdWJsZS1jbGljay90YXAgdG8gZmluaXNoLiIsImxhbmd1YWdlLXJlc3VsdHMtcGFnZS1vZiI6Im9mIiwibGFuZ3VhZ2UtbWVudS1yZXN1bHRzLXJlbW92ZS1mZWF0dXJlLXNldC1kZXNjIjoiUmVtb3ZlIHRoaXMgZmVhdHVyZSBzZXQgZnJvbSB0aGUgY3VycmVudCBjb2xsZWN0aW9uIG9mIHJlc3VsdHMiLCJsYW5ndWFnZS10b29sYmFyLXNuYXBwaW5nLWVuYWJsZSI6IkVuYWJsZSBTbmFwcGluZyIsImxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy11bmRlcmxpbmUiOiJVbmRlcmxpbmUiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWNsb3NlLXJlc3VsdHMtZnJhbWUiOiJEZWFjdGl2YXRlcyB0aGUgUmVzdWx0c1JlZ2lvbi4iLCJsYW5ndWFnZS10b29sYmFyLWdyb3VwLTNyZC1wYXJ0eS1tYXBzIjoiTGlua2VkIE1hcHMiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWFjdGl2YXRlLXZpZXciOiJBY3RpdmF0ZXMgYSB2aWV3LiIsImxhbmd1YWdlLXJlc3VsdHMtdG9nZ2xlLXRhYmxlLXZpZXciOiJTd2l0Y2ggdG8gVGFibGUiLCJsYW5ndWFnZS10b29sYmFyLW1lbnUtZ2xvYmFsLXNhdmUtZGVzYyI6IlNhdmUgdGhlIHN0YXRlIG9mIHlvdXIgdmlld2VyIGluIGEgcHJvamVjdCIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tdXBkYXRlLWF0dGFjaG1lbnQiOiJVcGRhdGVzIGEgZmVhdHVyZSBhdHRhY2htZW50LiIsImxhbmd1YWdlLW1lbnUtZXhwb3J0LXJlc3VsdHMtdG8teGxzeC1kZXNjIjoiRXhwb3J0IHJlc3VsdHMgdG8gWExTWCIsImxhbmd1YWdlLXRvb2xiYXItbWFya3VwLWVkaXQtdG9vbHRpcCI6IkVkaXQgYW4gZXhpc3RpbmcgZHJhd2luZyIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tcmVtb3ZlLWZlYXR1cmUtc2V0LWNvbGxlY3Rpb24tYnktaWQiOiJSZW1vdmVzIHRoZSBzcGVjaWZpZWQgY29sbGVjdGlvbiBmcm9tIHRoZSBmZWF0dXJlIHNldCBtYW5hZ2VyLiIsImxhbmd1YWdlLWxheWVyc2VsZWN0b3Itc3RhdGUtdG9nZ2xlIjoiVG9nZ2xlIHswfSBsYXllciB2aXNpYmlsaXR5LiIsImxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1ib2xkIjoiQm9sZCIsImxhbmd1YWdlLWdyYW50LWVkaXRvci10YWJsZS1oZWFkZXItZWRpdCI6IkVkaXQiLCJsYW5ndWFnZS1tZW51LW9mZmxpbmUtbWFwLWVkaXRvci1nZW9tZXRyeS1hY3Rpb25zLWNsZWFyIjoiQ2xlYXIiLCJsYW5ndWFnZS10b29sYmFyLXRhc2tzLXNoYXJlLXRvb2x0aXAiOiJTaGFyZSB0aGUgY3VycmVudCBtYXAgb24gdGhlIG1vc3QgY29tbW9uIHNvY2lhbCBtZWRpYSIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tc2V0LWVkaXRvci1mZWF0dXJlLWdlb21ldHJ5IjoiU2V0cyB0aGUgZ2VvbWV0cnkgb2YgdGhlIGZlYXR1cmUgdGhhdCBpcyBjdXJyZW50bHkgYmVpbmcgZWRpdGVkIGluIHRoZSBBdHRyaWJ1dGUgRWRpdG9yLCBhbmQgYWN0aXZhdGVzIHRoZSBBdHRyaWJ1dGVFZGl0b3IgVmlldy4iLCJsYW5ndWFnZS10b29sYmFyLXRpbWVzbGlkZXItc2hvd3RpbWVzbGlkZXItdG9vbHRpcCI6IkFjdGl2YXRlIHRoZSB0aW1lIHNsaWRlciIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tcGFuLXRvLWZlYXR1cmUiOiJQYW5zIHRvIHRoZSBHZW9jb3J0ZXggZmVhdHVyZS4iLCJsYW5ndWFnZS1tZW51LXZpc3VhbGl6YXRpb24iOiJUdXJuIG9uL29mZiBsYXllciB2aXN1YWxpemF0aW9ucyIsImxhbmd1YWdlLW1lbnUtZ3JvdXBlZC1yZXN1bHRzLWxpc3QtYWN0aW9ucyI6Ikdyb3VwZWQgUmVzdWx0cyBMaXN0IEFjdGlvbnMiLCJsYW5ndWFnZS1tZW51LW1hcHRpcC1hY3Rpb25zLXZpZXctZGV0YWlscyI6IlZpZXcgQWRkaXRpb25hbCBEZXRhaWxzIiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtcG9seWdvbi10b29sdGlwIjoiRHJhdyBhIGN1c3RvbSBzaGFwZSBvbiB0aGUgbWFwIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1kaXNwbGF5LXdvcmtmbG93LWNvbnRhaW5lci1jb250ZW50IjoiRGlzcGxheXMgYSB2aWV3IGluIGEgd29ya2Zsb3cgY29udGFpbmVyLiIsImxhbmd1YWdlLXRvb2xiYXItbWFya3VwLWVkaXQtZGVzYy1rZXlib2FyZCI6IlVzZSBhcnJvd3MgdG8gbW92ZSB0aGUgcG9pbnQuIEhpdCBFTlRFUiB0byBiZWdpbiBlZGl0aW5nIGFuIGV4aXN0aW5nIGRyYXdpbmcuIiwibGFuZ3VhZ2UtbWVudS1sYXRpdHVkZS1nZW9ncmFwaGljcy1kZXNjIjoiTGF0aXR1ZGUgR2VvZ3JhcGhpY3MgR3JvdXAgTHRkLiIsImxhbmd1YWdlLWNvb3JkaW5hdGVzLWVhc3QtYWJicmV2IjoiRSIsImxhbmd1YWdlLW9mZmxpbmUtcHJvZ3Jlc3MtYmFzZW1hcGRvd25sb2FkLWNhbmNlbGVkIjoiezB9IGNhbmNlbGVkLiIsImxhbmd1YWdlLWxheWVyc2VsZWN0b3ItaXRlbS1leHBhbmQiOiJDb2xsYXBzZSBvciBleHBhbmQgezB9IGxheWVyIGdyb3VwIiwibGFuZ3VhZ2UtdG9vbGJhci1idWZmZXItdG9nZ2xlLXRvb2x0aXAiOiJCdWZmZXIgYW4gYXJlYSBhcm91bmQgeW91ciBzZWxlY3Rpb24iLCJsYW5ndWFnZS1tZW51LWdsb2JhbC1zYXZlLWFzIjoiU2F2ZSBhcyIsImxhbmd1YWdlLW1lbnUtaWRlbnRpZnktZnJlZWhhbmQtZGVzYyI6IkRyYXcgYSBzaGFwZSB0byB2aWV3IGluZm9ybWF0aW9uIGFib3V0IHRoYXQgYXJlYS4iLCJsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtZmlsbC1zdHlsZS1iYWNrd2FyZC1kaWFnb25hbCI6IkJhY2t3YXJkIERpYWdvbmFsIiwibGFuZ3VhZ2UtbWVudS1nbG9iYWwtc2F2ZSI6IlNhdmUiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXNob3ctZmVhdHVyZS1kZXRhaWxzIjoiQ3JlYXRlcyBhbmQgZGlzcGxheXMgdGhlIEZlYXR1cmUgRGV0YWlscyBkaWFsb2cgZm9yIHRoZSBmZWF0dXJlIG9yIGZlYXR1cmUgc2V0IGNvbGxlY3Rpb24gc3BlY2lmaWVkLiIsImxhbmd1YWdlLW1lbnUtYWRkLXRleHQiOiJBZGQgU29tZSBUZXh0IiwibGFuZ3VhZ2Utb2ZmbGluZS1lcnJvcnMtc2F2ZWZhaWxlZCI6IlVuYWJsZSB0byBzYXZlLiIsImxhbmd1YWdlLW1lbnUtem9vbS1pbml0aWFsLWV4dGVudC1kZXNjIjoiUmV0dXJuIHRvIHRoZSBpbml0aWFsIG1hcCBwb3NpdGlvbiBhbmQgem9vbSBsZXZlbC4iLCJsYW5ndWFnZS1jb21tb24tcXVlcnktcmVzdWx0cyI6IlF1ZXJ5IFJlc3VsdHMiLCJsYW5ndWFnZS1mcmFtZXdvcmstdWktdmlldy1jb250YWluZXItdmlldy1jbG9zZSI6IkNsb3NlIHswfSIsImxhbmd1YWdlLXRvb2xiYXItbWFya3VwLWZyZWVoYW5kLXRvb2x0aXAiOiJEcmF3IGEgZnJlZWhhbmQgbGluZSBvbiB0aGUgbWFwIiwibGFuZ3VhZ2UtdG9vbGJhci1pZGVudGlmeS1sYXllcnMtY2hhbmdlLXRvb2x0aXAiOiJFbmFibGUvRGlzYWJsZSBsYXllcnMgc2VsZWN0ZWQgZm9yIGlkZW50aWZ5IG9wZXJhdGlvbnMiLCJsYW5ndWFnZS1yZXN1bHRzLWV4cG9ydC10by1hbGVydC1lcnJvci1tZXNzYWdlIjoiRXJyb3IgZXhwb3J0aW5nIHRvIFwiLnswfVwiIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1tYXAtcmVzaXplIjoiVGVsbHMgdGhlIG1hcCBjb250cm9sIHRvIHJlc2l6ZSBpdHNlbGYuIFRoaXMgc2hvdWxkIGJlIGNhbGxlZCBhZnRlciBhbHRlcmluZyB0aGUgbWFwIGNvbnRhaW5lcidzIGRpbWVuc2lvbnMuIiwibGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLWZvbnQtZmFtaWx5IjoiRm9udCIsImxhbmd1YWdlLW1lbnUtb2ZmbGluZS1tYXAtZWRpdG9yLWdlb21ldHJ5LWFjdGlvbnMtZnJlZWhhbmRwb2x5Z29uLWRlc2MiOiJEcmF3IGEgZnJlZWhhbmQgcG9seWdvbiBmb3IgdGhlIGFyZWEgb2YgaW50ZXJlc3QgZ2VvbWV0cnkuIiwibGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLWxpbmUtc3R5bGUtbnVsbCI6Ik5vbmUiLCJsYW5ndWFnZS1zdGF0ZXMtZHJhdy1tYXJrdXAtc3RhdGUtZGVzY3JpcHRpb24iOiJUaGUgZHJhdyB0b29sIGlzIGN1cnJlbnRseSBhY3RpdmUuIiwibGFuZ3VhZ2UtY29tbW9uLWRlYnVnLWxvZy1rZXlzIjoiVG8gdmlldyB0aGUgbG9nIG9uIGEgZGVza3RvcCBtYWNoaW5lLCBwcmVzcyBDdHJsICsgU2hpZnQgKyB+LiBPbiBhIG1vYmlsZSBkZXZpY2UsIHByZXNzIGFuZCBob2xkIHRoZSB0b29sYmFyLiIsImxhbmd1YWdlLWNvbW1vbi12aWV3LWxvZyI6IlZpZXcgTG9nIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1hY3RpdmF0ZS1jb250YWluZXJzLWZvci13b3JrZmxvdyI6IkFjdGl2YXRlcyBhbnkgd29ya2Zsb3cgY29udGFpbmVyIHZpZXdzIGFzc29jaWF0ZWQgd2l0aCBhIGdpdmVuIHdvcmtmbG93LiIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tc2V0LWVkaXQtbG9nIjoiU2V0cyB0aGUgZWRpdCBsb2csIHBhc3NpbmcgaXQgaW50byBhIGNhbGxiYWNrLiBJZiBhbiBlcnJvciBvY2N1cnMsIHRoZSBlcnJvciBpcyBwYXNzZWQgaW50byB0aGUgY2FsbGJhY2suIiwibGFuZ3VhZ2UtdG9vbGJhci1uYXZpZ2F0aW9uLWluaXRpYWwtZXh0ZW50IjoiSW5pdGlhbCBWaWV3IiwibGFuZ3VhZ2UtY29tbW9uLXNob3ciOiJTaG93IiwibGFuZ3VhZ2UtY29tbW9uLWV4dHJhY3QtZGF0YSI6IkV4dHJhY3QgRGF0YSIsImxhbmd1YWdlLXRhYi1zY3JvbGwtcHJldiI6IlByZXZpb3VzIExheWVyIiwibGFuZ3VhZ2UtY29tbW9uLXJlc3VsdHMtaW50ZXJzZWN0LWNvbmZpcm1hdGlvbiI6Iid7MH0nIGludGVyc2VjdGVkIHdpdGggezF9IiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtcG9seWxpbmUiOiJMaW5lIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1zaG93LW1hcC1lbGVtZW50IjoiRGlzcGxheXMgYW4gZWxlbWVudCBhbmNob3JlZCB0byBhIHNwZWNpZmljIHBvaW50IG9uIHRoZSBtYXAuIiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtdGV4dC1kZXNjIjoiQ2xpY2sgYSBsb2NhdGlvbiB3aGVyZSB5b3Ugd2FudCB0byBhZGQgdGV4dCBvbiB0aGUgbWFwLiIsImxhbmd1YWdlLXRvb2xiYXItZ3JvdXAtdGFza3MiOiJUYXNrcyIsImxhbmd1YWdlLW9mZmxpbmUtcHJvZ3Jlc3MtYmFzZW1hcGRvd25sb2FkLWZhaWxlZCI6IkJhc2VtYXAgJ3swfScgZmFpbGVkIHRvIGRvd25sb2FkOiB7MX0iLCJsYW5ndWFnZS1tb250aHMtMTEiOiJEZWNlbWJlciIsImxhbmd1YWdlLW1vbnRocy0xMCI6Ik5vdmVtYmVyIiwibGFuZ3VhZ2UtbGF5ZXJsaXN0LWV4cGFuZCI6IkNvbGxhcHNlIG9yIGV4cGFuZCB7MH0gbGF5ZXIgZ3JvdXAiLCJsYW5ndWFnZS10b29sYmFyLXRhYi1maWxlIjoiRmlsZSIsImxhbmd1YWdlLWNsaWNrYWJsZS1ncmFwaGljcy1sYWJlbC1kcmF3aW5nIjoiRHJhd2luZyIsImxhbmd1YWdlLW1lbnUtY29tYmluZS1yZXN1bHRzLXVuaW9uIjoiQWRkIHRvIHJlc3VsdHMiLCJsYW5ndWFnZS1jb21tb24tbm8tcmVzdWx0cy1kZXNjIjoiSXRlbXMgYXBwZWFyIGFmdGVyIHlvdSBwZXJmb3JtIGEgdmFsaWQgc2VhcmNoIG9yIG90aGVyIHRhc2sgdGhhdCByZXR1cm5zIHJlc3VsdHMuIiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtcG9seWdvbiI6IlBvbHlnb24iLCJsYW5ndWFnZS10b29sYmFyLWlkZW50aWZ5LXBvbHlnb24tZGVzYyI6IlRvIGxlYXJuIHdoYXRcdTIwMTlzIHRoZXJlLCBkcmF3IGEgc2hhcGUgb24gdGhlIG1hcC4gRG91YmxlLWNsaWNrL3RhcCB0byBmaW5pc2guIiwibGFuZ3VhZ2UtbWVudS1tYXAtY29udGV4dC1tZW51LXRpdGxlIjoiUG9pbnQgT3B0aW9ucyIsImxhbmd1YWdlLXN0YXRlcy1mZWF0dXJlLWVkaXRpbmctc3RhdGUtcG9pbnQtZ3JhcGhpYy1kZXNjcmlwdGlvbiI6IlRoZSBjcmVhdGUgYSBmZWF0dXJlIHRvb2wgaXMgY3VycmVudGx5IGVkaXRpbmcgYSBwb2ludC1iYXNlZCBncmFwaGljLiIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24taGlkZS1tYXAtZWxlbWVudCI6IlJlbW92ZXMgYW4gZWxlbWVudCBwcmV2aW91c2x5IGFuY2hvcmVkIHRvIHRoZSBtYXAgdXNpbmcgU2hvd01hcEVsZW1lbnQuIiwibGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLWl0YWxpYyI6Ikl0YWxpYyIsImxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1mb250LXNpemUiOiJGb250IFNpemUiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWdldC1mZWF0dXJlLWRldGFpbHMtcHJvdmlkZXJzIjoiQ3JlYXRlcyB2aWV3IGZvciBhbGwgY29uZmlndXJlZCBmZWF0dXJlIGRldGFpbHMgcHJvdmlkZXJzIGFuZCBlbWJlZHMgdGhlbSBpbnRvIGZlYXR1cmUgZGV0YWlscyBkaWFsb2cuIiwibGFuZ3VhZ2UtY29tbW9uLWZlYXR1cmUtbGF5ZXItZGV0YWlscy1kZXNjIjoiTWFuYWdlIGNhY2hpbmcgb2YgYSBmZWF0dXJlIGxheWVyIGZvciBvZmZsaW5lIHVzZS4iLCJsYW5ndWFnZS10b29sYmFyLWlkZW50aWZ5LXBvaW50LXRvb2x0aXAiOiJGaW5kIG91dCBhYm91dCBhIGxvY2F0aW9uIG9uIHRoZSBtYXAiLCJsYW5ndWFnZS1vZmZsaW5lLXByb2dyZXNzLWtpbG9ieXRlcy1wZXItc2Vjb25kIjoiezB9IGtCL3MiLCJsYW5ndWFnZS10b29sYmFyLWVkaXRpbmctY3JlYXRlLW5ldy1mZWF0dXJlIjoiQ3JlYXRlIE5ldyBGZWF0dXJlIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1hZGQtc3RhdHVzIjoiQWRkcyBhIHN0YXR1cyBpbmRpY2F0b3IgdG8gdGhlIHNjcmVlbi4iLCJsYW5ndWFnZS1ncmFudC1lZGl0b3ItdGFibGUtaGVhZGVyLW93bmVyIjoiQWRtaW4iLCJsYW5ndWFnZS1tZW51LW9mZmxpbmUtbWFwLWVkaXRvci1nZW9tZXRyeS1hY3Rpb25zLWZyZWVoYW5kcG9seWdvbiI6IkZyZWVoYW5kIFBvbHlnb24iLCJsYW5ndWFnZS1jb21tb24tc2hhcmUiOiJTaGFyZSIsImxhbmd1YWdlLXdlYm1hcC1sYXllci1uYW1lLXBvbHlsaW5lIjoiTGluZXMiLCJsYW5ndWFnZS1wYWdlLW5leHQiOiJOZXh0IHBhZ2UiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWRlbGV0ZS1yZWxhdGVkLXJlY29yZCI6IkRlbGV0ZXMgYSByZWxhdGVkIHRhYmxlIHJlY29yZC4iLCJsYW5ndWFnZS1wcm9qZWN0LWVycm9yLXdyaXRlIjoiVGhlIHByb2plY3QgY291bGQgbm90IGJlIHNhdmVkLiBSZWZlciB0byB0aGUgbG9nIGZvciBtb3JlIGRldGFpbHMuIiwibGFuZ3VhZ2UtbWVudS1yZXN1bHRzLXJlbW92ZS1mZWF0dXJlLWRlc2MiOiJSZW1vdmUgdGhpcyBmZWF0dXJlIGZyb20gdGhlIGN1cnJlbnQgc2V0IG9mIHJlc3VsdHMiLCJsYW5ndWFnZS1jb21tb24tbG9naW4iOiJMb2cgSW4iLCJsYW5ndWFnZS10b29sYmFyLXRpdGxlIjoiVG9vbGJhciIsImxhbmd1YWdlLW1lbnUtaWRlbnRpZnkiOiJGaW5kIGRhdGEgb24gdGhlIG1hcCIsImxhbmd1YWdlLW1hcHNlcnZpY2UtYWN0aW9ucy10b29sdGlwIjoiQ2xpY2sgdG8gc2VlIGFjdGlvbnMgYXZhaWxhYmxlIGZvciBtYXAgc2VydmljZSB7MH0iLCJsYW5ndWFnZS1tZW51LXByb2plY3RzLWFjdGlvbnMtZGVzYyI6IlByb2plY3RzIEFjdGlvbnMiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXN0YXJ0LWVkaXRpbmctZWRpdC1sb2ctZW50cnkiOiJDcmVhdGVzIGEgYXZpZXcgdG8gY2hhbmdlIGFuIGV4aXN0aW5nIGVkaXQuIiwibGFuZ3VhZ2UtdG9vbGJhci1uYXZpZ2F0aW9uLXpvb20taW4tZGVzYyI6IkNsaWNrIG9yIHRhcCwgdGhlbiBkcmFnIGFyZWEgb2YgaW50ZXJlc3Qgb24gdGhlIG1hcC4gTWFwIHdpbGwgem9vbSB0byB0aGF0IGxvY2F0aW9uLiIsImxhbmd1YWdlLW1lbnUtbm8taXRlbXMiOiJObyBtZW51IG9wdGlvbnMuIiwibGFuZ3VhZ2UtdG9vbGJhci1ob21lLXN1YiI6IkhvbWUiLCJsYW5ndWFnZS10b29sYmFyLW1hcmt1cC1kZWxldGUiOiJFcmFzZSIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tcmVnaXN0ZXItc2VhcmNoLXByb3ZpZGVyIjoiUmVnaXN0ZXJzIGEgc2VhcmNoIHByb3ZpZGVyIGlmIG5vdCBhbHJlYWR5IHJlZ2lzdGVyZWQuIiwibGFuZ3VhZ2UtY29tbW9uLXNhdmUiOiJTYXZlIiwibGFuZ3VhZ2UtdG9vbGJhci10YXNrcy1sYXllci1jYXRhbG9nIjoiTGF5ZXIgQ2F0YWxvZyIsImxhbmd1YWdlLXJlc3VsdHMtZGlzcGxheWluZyI6IkRpc3BsYXlpbmciLCJsYW5ndWFnZS1vZmZsaW5lLXByb2dyZXNzLWJhc2VtYXBkb3dubG9hZC1kb3dubG9hZGluZyI6InswfSAtIHsxfSBvZiB7Mn0gKHszfSUpIGRvd25sb2FkZWQuIHs0fS4iLCJsYW5ndWFnZS1jb29yZGluYXRlcy1zZWNvbmRzIjoiXCIiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXNob3ctcmVzdWx0cy1saXN0IjoiRGlzcGxheXMgdGhlIGxpc3Qgb2YgZmVhdHVyZXMgaW4gdGhlIGdpdmVuIGZlYXR1cmUgc2V0IGNvbGxlY3Rpb24gYXMgYSBsaXN0LiIsImxhbmd1YWdlLXRvb2xiYXItdG9vbGJhciI6IlRvb2xiYXIiLCJsYW5ndWFnZS10b29sYmFyLWlkZW50aWZ5LXBvbHlsaW5lLWRlc2MiOiJUbyBsZWFybiB3aGF0XHUyMDE5cyB0aGVyZSwgZHJhdyBhIGxpbmUgb2YgaW50ZXJlc3QgYWxvbmcgdGhlIG1hcC4gRG91YmxlLWNsaWNrL3RhcCB0byBmaW5pc2guIiwibGFuZ3VhZ2UtbWVudS1zYXZlLXJlc3VsdHMiOiJTYXZlIFJlc3VsdHMiLCJsYW5ndWFnZS1zdGF0ZXMtZWRpdGluZy1hY3RpdmUtc3RhdGUtZGVzY3JpcHRpb24iOiJUaGUgZmVhdHVyZSBlZGl0b3IgaXMgY3VycmVudGx5IGFjdGl2ZS4iLCJsYW5ndWFnZS13ZWJtYXAtZmllbGQtbmFtZS12aXNpYmxlIjoiVmlzaWJsZSIsImxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1maWxsLXN0eWxlLWZvcndhcmQtZGlhZ29uYWwiOiJGb3J3YXJkIERpYWdvbmFsIiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtZXhwb3J0IjoiRXhwb3J0IERyYXdpbmdzIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1mZWF0dXJlLWxheWVyLWNhY2hlLWRhdGEiOiJDYWNoZXMgdGhlIGRhdGEgZm9yIGEgZ2l2ZW4gbWFwIHNlcnZpY2UgVVJMLiIsImxhbmd1YWdlLW1lbnUtbWVudXMtZGVzY3JpcHRpb24iOiJJIFdhbnQgVG8uLi4gTWVudXMiLCJsYW5ndWFnZS1tZW51LWxpc3Qtb2ZmbGluZS1tYXBzLWFjdGlvbnMtcmVmcmVzaC1kZXNjIjoiUmVmcmVzaCB0aGUgbGlzdCBvZiBvZmZsaW5lIG1hcHMuIiwibGFuZ3VhZ2UtYWNjZXNzaWJpbGl0eS1kYXRlcGlja2VyLXRyaWdnZXItYnV0dG9uLWFyaWEtbGFiZWwiOiJPcGVuIHRoZSBkYXRlIHBpY2tlci4iLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWdldC1lZGl0LWxvZyI6IkdldHMgdGhlIGVkaXQgbG9nLCBwYXNzaW5nIGl0IGludG8gYSBjYWxsYmFjay4gSWYgYW4gZXJyb3Igb2NjdXJzLCB0aGUgZXJyb3IgaXMgcGFzc2VkIGludG8gdGhlIGNhbGxiYWNrLiIsImxhbmd1YWdlLXRvb2xiYXItY2hhcnRpbmctc2hvdy1jaGFydHMtdG9vbHRpcCI6IkxhdW5jaCB0aGUgY2hhcnRpbmcgdmlldyIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24taGlnaGxpZ2h0LWZlYXR1cmUtZGVmYXVsdCI6IkhpZ2hsaWdodHMgdGhlIGZlYXR1cmUgaW4gdGhlIGRlZmF1bHQgaGlnaGxpZ2h0IGxheWVyLiIsImxhbmd1YWdlLWNvbW1vbi1zaG93LWRldGFpbHMiOiJTZWUgRGV0YWlscyIsImxhbmd1YWdlLXRvb2xiYXItZ3JvdXAtZ2xvYmFsLXRhc2tzIjoiR2xvYmFsIFRhc2tzIiwibGFuZ3VhZ2UtdG9vbGJhci1lZGl0aW5nLWNyZWF0ZS1uZXctZmVhdHVyZS10b29sdGlwIjoiQ3JlYXRlIGEgbmV3IGZlYXR1cmUgb24gdGhlIG1hcCIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tc2hvdy1mZWF0dXJlLXRlbXBsYXRlLXBpY2tlciI6IlNob3dzIHRoZSBmZWF0dXJlIHRlbXBsYXRlIHBpY2tlciB1c2VkIHRvIGNyZWF0ZSBuZXcgZmVhdHVyZXMuIElmIGEgbGF5ZXIgaXMgc3VwcGxpZWQsIHNob3dzIHRoZSB0ZW1wbGF0ZXMgZm9yIHRoZSBsYXllci4iLCJsYW5ndWFnZS1tZW51LXBsb3QtY29vcmRpbmF0ZSI6IlBsb3QgYSBDb29yZGluYXRlIiwibGFuZ3VhZ2Utb2ZmbGluZS1wcm9ncmVzcy1kb3dubG9hZGluZ3NpdGUiOiJEb3dubG9hZGluZyBzaXRlIHJlc291cmNlcy4iLCJsYW5ndWFnZS1ncmFudC1lZGl0b3ItYWRkLWJ1dHRvbi10ZXh0IjoiQWRkIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1hbGVydCI6IkRpc3BsYXlzIGFuIGFsZXJ0LiIsImxhbmd1YWdlLW1lbnUtcG93ZXJlZC1ieS1nZW9jb3J0ZXgtZGVzYyI6IlBvd2VyZWQgYnkgR2VvY29ydGV4IiwibGFuZ3VhZ2UtbWVudS1hY2Nlc3NpYmlsaXR5LXBhbmVsLWRlc2MiOiJWaWV3IGluZm9ybWF0aW9uIGFib3V0IHRoZSBhY2Nlc3NpYmlsaXR5IG9mIHRoaXMgYXBwbGljYXRpb24uIiwibGFuZ3VhZ2UtdG9vbGJhci1pZGVudGlmeS1jb21iaW5lLXVuaW9uLWRpc2FibGUiOiJEaXNhYmxlIEFkZCBSZXN1bHRzIiwibGFuZ3VhZ2UtdG9vbGJhci1pZGVudGlmeS1mcmVlaGFuZC1wb2x5Z29uLWRlc2MiOiJEcmF3IGEgZnJlZWhhbmQgc2hhcGUgb24gdGhlIG1hcCB0byBzZWUgd2hhdCdzIHRoZXJlIiwibGFuZ3VhZ2UtbWVudS1zd2l0Y2gtdG8tbGVnZW5kLWRlc2MiOiJEaXNwbGF5IHRoZSBsZWdlbmQgZm9yIHZpc2libGUgbGF5ZXJzIiwibGFuZ3VhZ2UtbWVudS1zZXR0aW5ncy1kZXNjcmlwdGlvbiI6Ik1vYmlsZSBTZXR0aW5ncyIsImxhbmd1YWdlLXN0YXRlcy1lZGl0LXN0YXRlLWRlc2NyaXB0aW9uIjoiVGhlIHRvb2wgdG8gc2VsZWN0IGFuIGl0ZW0gZm9yIGVkaXRpbmcgaXMgY3VycmVudGx5IGFjdGl2ZS4iLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXJ1bi13b3JrZmxvdy1ieS1pZCI6IlJ1bnMgYSB3b3JrZmxvdy4iLCJsYW5ndWFnZS1tZW51LWdsb2JhbC1vcGVuIjoiT3BlbiIsImxhbmd1YWdlLW1lbnUtZXhwb3J0LXJlc3VsdHMtdG8tY3N2LWRlc2MiOiJFeHBvcnQgcmVzdWx0cyB0byBDU1YiLCJsYW5ndWFnZS10b29sYmFyLXRhYi10YXNrcyI6IlRhc2tzIiwibGFuZ3VhZ2UtdG9vbGJhci1ob21lLXRvb2x0aXAiOiJPcGVuIHRoZSBIb21lIFBhbmVsIiwibGFuZ3VhZ2UtbWVudS1kZXNjcmlwdGlvbiI6IlF1aWNrIGFjY2VzcyB0byBjb21tb24gdGFza3MiLCJsYW5ndWFnZS1tZW51LXpvb20iOiJab29tIHRvIEZlYXR1cmUiLCJsYW5ndWFnZS1sYXllci1hY3Rpb25zIjoiUGVyZm9ybSBhbiBhY3Rpb24gb24gezB9IiwibGFuZ3VhZ2UtY29tbW9uLWNsZWFyIjoiQ2xlYXIiLCJsYW5ndWFnZS10b29sYmFyLW9wZW4tY29sbGFib3JhdGlvbi10b29sdGlwIjoiT3BlbiB0aGUgQ29sbGFib3JhdGlvbiBpbnRlcmZhY2UuIiwibGFuZ3VhZ2UtbWVudS1ob21lLXBhbmVsIjoiVmlldyB0aGUgaG9tZSBwYW5lbCIsImxhbmd1YWdlLXRvb2xiYXItbmF2aWdhdGlvbi1wYW4iOiJQYW4iLCJsYW5ndWFnZS10b29sYmFyLW1hcmt1cC1lZGl0LWRlc2Mtc2hvcnRjdXRzIjoiVXNlIGFycm93cyB0byBtb3ZlLCBSIHRvIHJvdGF0ZSwgUyB0byBzY2FsZSwgViB0byBzZWxlY3QgdmVydGV4LiBDb21iaW5lIHdpdGggQUxUIGZvciBmaW5lciBjb250cm9sLiBDb21iaW5lIHdpdGggU0hJRlQgdG8gcmV2ZXJzZS4iLCJsYW5ndWFnZS1vZmZsaW5lLWVycm9ycy1ub3RuYXRpdmVpbml0aWFsaXplZCI6IlRoaXMgb3BlcmF0aW9uIGNhbiBvbmx5IGJlIHBlcmZvcm1lZCBpbiB0aGUgbmF0aXZlIGNsaWVudC4iLCJsYW5ndWFnZS1tZW51LW9mZmxpbmUtbWFwLWVkaXRvci1nZW9tZXRyeS1hY3Rpb25zLWNpcmNsZSI6IkNpcmNsZSIsImxhbmd1YWdlLXRvb2xiYXItbmF2aWdhdGlvbi16b29tLW91dC10b29sdGlwIjoiRHJhdyBhbiBhcmVhIG9mIGludGVyZXN0IG9uIHRoZSBtYXAgYW5kIHpvb20gb3V0LCBrZWVwaW5nIHRoZSBhcmVhIGNlbnRlcmVkIiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtcG9pbnQtZGVzYyI6IkNsaWNrIG9yIHRhcCBhIG1hcCBsb2NhdGlvbiB0byBhZGQgYSBwb2ludC4iLCJsYW5ndWFnZS10b29sYmFyLXNuYXBwaW5nLWFsdC1kaXNhYmxlIjoiRGlzYWJsZSBzbmFwcGluZyBmb3IgYWN0aXZlIHRvb2wiLCJsYW5ndWFnZS10b29sYmFyLW1hcmt1cC1wYWxldHRlLXNtYWxsLWNoYW5nZS1zdHlsZSI6IlN0eWxlcyIsImxhbmd1YWdlLXBhZ2UtcHJldiI6IlByZXZpb3VzIHBhZ2UiLCJsYW5ndWFnZS1zbWFydC1wYW5lbC1yZXNpemUiOiJEcmFnIHRvIHJlc2l6ZSB0aGUgcGFuZWwiLCJsYW5ndWFnZS10b29sYmFyLWlkZW50aWZ5LWNvbWJpbmUtdW5pb24tZW5hYmxlLXRvb2x0aXAiOiJFbmFibGUgYWRkaW5nIHJlc3VsdHMgdG8gdGhlIGV4aXN0aW5nIGlkZW50aWZ5IHJlc3VsdHMiLCJsYW5ndWFnZS10b29sYmFyLW1hcmt1cC1wb2x5bGluZS1kZXNjLWtleWJvYXJkIjoiVXNlIGFycm93cyB0byBtb3ZlIHRoZSBwb2ludC4gSGl0IEVOVEVSIHRvIHBsb3QgYW5kIGJlZ2luIG1vdmluZyB0aGUgbmV4dCBwb2ludC4gSGl0IEVOVEVSIHR3aWNlIHRvIGZpbmlzaC4iLCJsYW5ndWFnZS11aS10YWJsZS1zb3J0ZWQtYXNjZW5kaW5nIjoiQ29sdW1uIGhlYWRlci4gezB9IC0gU29ydGVkIGFzY2VuZGluZy4iLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXNlYXJjaCI6IlBlcmZvcm1zIGEgc2VhcmNoIG9uIGFsbCBhY3RpdmUgcHJvdmlkZXJzLiIsImxhbmd1YWdlLXByb2plY3Qtc2lnbi1pbiI6IlNpZ24gaW4iLCJsYW5ndWFnZS10b29sYmFyLW5hdGl2ZS1zaG93b2ZmbGluZW1hcHMtdG9vbHRpcCI6Ik9wZW4gdGhlIGxpc3Qgb2Ygb2ZmbGluZSBtYXBzIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1jbGVhci1oaWdobGlnaHRzIjoiUmVtb3ZlcyB0aGUgaGlnaGxpZ2h0cyBmcm9tIHRoZSBhY3RpdmUgaGlnaGxpZ2h0IGxheWVyLiIsImxhbmd1YWdlLXRvb2xiYXItZ3JvdXAtY29sbGFib3JhdGlvbiI6IkNvbGxhYm9yYXRpb24iLCJsYW5ndWFnZS1tZW51LXJlbW92ZS11c2VyLWFkZGVkLW1hcHNlcnZpY2UiOiJSZW1vdmUgc2VydmljZSIsImxhbmd1YWdlLXRvb2xiYXItbmF2aWdhdGlvbi1wcmV2aW91cy1leHRlbnQtdG9vbHRpcCI6Ilpvb20gdG8gdGhlIHByZXZpb3VzIGV4dGVudCIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tb3Blbi13ZWItcGFnZSI6Ik9wZW5zIGEgd2ViIHBhZ2UgaW4gYW5vdGhlciB0YWIvd2luZG93LiIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tY2FuY2VsLXNlYXJjaCI6IkNhbmNlbCB0aGUgc2VhcmNoIG9uIGFsbCBwcm92aWRlcnMuIiwibGFuZ3VhZ2UtY29tbW9uLXdvcmtmbG93IjoiV29ya2Zsb3ciLCJsYW5ndWFnZS1tZW51LWRvbmUiOiJEb25lIiwibGFuZ3VhZ2UtdG9vbGJhci0zcmQtcGFydHktbWFwcy1zaG93LW1hcHMiOiJMaW5rZWQgTWFwcyIsImxhbmd1YWdlLWxheWVybGlzdC1ub3QtdmlzaWJsZS1hdC1leHRlbnQiOiJDdXJyZW50bHkgbm90IHdpdGhpbiB2aXNpYmxlIHNjYWxlLiIsImxhbmd1YWdlLW1lbnUtem9vbS1kZXNjcmlwdGlvbiI6Ilpvb20gdG8gdGhpcyBmZWF0dXJlIG9uIHRoZSBtYXAiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWdsb2JhbC1zZWFyY2giOiJQZXJmb3JtcyBhIHNlYXJjaCBvbiBhbGwgYWN0aXZlIHByb3ZpZGVycy4iLCJsYW5ndWFnZS1tZW51LXNob3ctbG9nIjoiU2hvdyBMb2ciLCJsYW5ndWFnZS10b29sYmFyLWdyb3VwLXRpbWUtc2xpZGVyIjoiVGltZSBTbGlkZXIiLCJsYW5ndWFnZS10b29sYmFyLXNlbGVjdC1sYXllcnMtdG9nZ2xlLXRvb2x0aXAiOiJGaWx0ZXIgbGF5ZXJzIGZvciBJZGVudGlmeSByZXN1bHRzIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1zZXQtaGlnaGxpZ2h0LWJvcmRlci1jb2xvciI6IlNldHMgdGhlIGJvcmRlciBjb2xvciB1c2VkIGZvciBuZXcgaGlnaGxpZ2h0cywgc3BlY2lmaWVkIGluIDYgb3IgOCBkaWdpdCBoZXggaW4gUkdCIG9yIEFSR0IgZm9ybS4iLCJsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtZmlsbC1zdHlsZS1ob3Jpem9udGFsIjoiSG9yaXpvbnRhbCIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24taGlnaGxpZ2h0LWVzcmktZmVhdHVyZS1zZXQiOiJIaWdobGlnaHRzIGFsbCBvZiB0aGUgZmVhdHVyZXMgaW4gdGhlIHNwZWNpZmllZCBmZWF0dXJlIHNldCBpbiB0aGUgYWN0aXZlIGhpZ2hsaWdodCBsYXllci4iLCJsYW5ndWFnZS1tZW51LWNvbWJpbmUtcmVzdWx0cy1zdWJ0cmFjdC1kZXNjIjoiUmVtb3ZlIGEgc2F2ZWQgc2V0IG9mIHJlc3VsdHMgZnJvbSB5b3VyIGN1cnJlbnQgbGlzdCBvZiByZXN1bHRzIiwibGFuZ3VhZ2UtbWVudS1pZGVudGlmeS1yZWN0YW5nbGUtZGVzYyI6IkRyYXcgYSByZWN0YW5nbGUgdG8gdmlldyBpbmZvcm1hdGlvbiBhYm91dCB0aGF0IGFyZWEuIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1kZWFjdGl2YXRlLWNvbnRhaW5lcnMtZm9yLXdvcmtmbG93IjoiRGVhY3RpdmF0ZXMgYW55IHdvcmtmbG93IHZpZXdzIGFzc29jaWF0ZWQgd2l0aCBhIGdpdmVuIHdvcmtmbG93LiIsImxhbmd1YWdlLW1lbnUtbGlzdC1vZmZsaW5lLW1hcHMtYWN0aW9ucy1kZXNjIjoiT2ZmbGluZSBQcm9maWxlIEFjdGlvbnMiLCJsYW5ndWFnZS1wcm9qZWN0LWVycm9yLXNpZ24taW4tcmVxdWlyZWQiOiJUaGlzIHByb2plY3QgcmVxdWlyZXMgeW91IHRvIHNpZ24gaW4uIFBsZWFzZSBzaWduIGluIHRvIG9wZW4gdGhlIHByb2plY3QuIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1zaG93LW1hcC10aXAiOiJDcmVhdGVzIGEgTWFwIFRpcCBWaWV3IGFuZCBkaXNwbGF5cyB0aGUgZmVhdHVyZSBpbiBpdC4iLCJsYW5ndWFnZS10b29sYmFyLW1hcmt1cC1jbGVhci10b29sdGlwIjoiQ2xlYXIgYWxsIGRyYXdpbmdzIGZyb20gdGhlIG1hcCIsImxhbmd1YWdlLWNvbW1vbi1mZWF0dXJlLW9mZmxpbmUtdG9vbHMiOiJNYW5hZ2UgT2ZmbGluZSBEYXRhIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1kZWFjdGl2YXRlLXZpZXciOiJEZWFjdGl2YXRlcyBhIHZpZXcuIiwibGFuZ3VhZ2UtdG9vbGJhci1pZGVudGlmeS1jb21iaW5lLXN1YnRyYWN0LWRpc2FibGUtdG9vbHRpcCI6IkRpc2FibGUgc3VidHJhY3RpbmcgcmVzdWx0cyBmcm9tIHRoZSBleGlzdGluZyBpZGVudGlmeSByZXN1bHRzIiwibGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLXBpY2stYXR0cmlidXRlIjoiUGljayBhbiBhdHRyaWJ1dGUgdG8gc3ltYm9saXplIiwibGFuZ3VhZ2UtdG9vbGJhci1maW5kLWRhdGEtdG9vbHMiOiJGaW5kIERhdGEgVG9vbHMiLCJsYW5ndWFnZS1tZW51LWdsb2JhbC1zYXZlLWFzLWRlc2MiOiJTYXZlIHRoZSBzdGF0ZSBvZiB5b3VyIHZpZXdlciBpbiBhIG5ldyBwcm9qZWN0IiwibGFuZ3VhZ2Utc2VhcmNoLXdvcmxkLXBsYWNlLW5hbWVzIjoiV29ybGQgUGxhY2UgTmFtZXMiLCJsYW5ndWFnZS1jb21tb24tbm90LWF2YWlsYWJsZS1vZmZsaW5lIjoiVGhpcyBmdW5jdGlvbiBpcyBub3QgYXZhaWxhYmxlIHdoZW4gb2ZmbGluZS4iLCJsYW5ndWFnZS1yZXN1bHRzIjoiUmVzdWx0cyIsImxhbmd1YWdlLXRvb2xiYXItYW5hbHlzaXMtbWVhc3VyZW1lbnQtdG9vbHMiOiJNZWFzdXJlIiwibGFuZ3VhZ2UtdG9vbGJhci1uYXZpZ2F0aW9uLWhvbWUtdG9vbHRpcCI6IlJldHVybnMgdG8gaW50cm9kdWN0b3J5IHBhZ2UiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXNldC1hY3RpdmUtdG9vbCI6IlNldHMgdGhlIGFjdGl2ZSB0b29sLiIsImxhbmd1YWdlLW1lbnUtb2ZmbGluZS1tYXAtZWRpdG9yLWdlb21ldHJ5LWFjdGlvbnMtcmVjdGFuZ2xlIjoiUmVjdGFuZ2xlIiwibGFuZ3VhZ2UtdG9vbGJhci1zaG93LWxheWVybGlzdCI6IkxheWVyIExpc3QiLCJsYW5ndWFnZS1ncmFudC1lZGl0b3ItZ2xvYmFsLWdyYW50LW5hbWUtcHVibGljIjoiRXZlcnlvbmUiLCJsYW5ndWFnZS1tZW51LWRyYXctcG9pbnQtZGVzYyI6IkRyYXcgYSBwb2ludCBvbiB0aGUgbWFwLiIsImxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1oYWxvLXNpemUiOiJIYWxvIFdpZHRoIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi11cGRhdGUtZmVhdHVyZS1sYXllci1tb2RhbC1tZXNzYWdlIjoiVXBkYXRlIHRoZSB2aXNpYmxlIE1vZGVsTWVzc2FnZVZpZXcgdG8gYWxzbyBpbmNsdWRlIHRoZSBnaXZlbiBtZXNzYWdlLiIsImxhbmd1YWdlLXBhZ2Utb2YiOiJvZiIsImxhbmd1YWdlLWNvbW1vbi1mZWF0dXJlLWVkaXRsb2ciOiJWaWV3IEVkaXQgTG9nIiwibGFuZ3VhZ2UtbWVudS1kZWZhdWx0LXRpdGxlIjoiT3B0aW9ucyIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tem9vbS10by1leHRlbnQiOiJab29tcyB0byB0aGUgZ2l2ZW4gZXh0ZW50LiIsImxhbmd1YWdlLXBhZ2UtcGFnZSI6IlBhZ2UiLCJsYW5ndWFnZS1jb21tb24tbm8tcmVzdWx0cy1zaG9ydCI6Ik5vIHJlc3VsdHMiLCJsYW5ndWFnZS10b29sYmFyLW1lbnUtZ2xvYmFsLXNhdmUtc2F2ZS1hcyI6IlNhdmUvU2F2ZSBhcyIsImxhbmd1YWdlLXBhZ2UtbGFzdCI6Ikxhc3QgcGFnZSIsImxhbmd1YWdlLW1lbnUtb2ZmbGluZS1tYXAtZWRpdG9yLWdlb21ldHJ5LWFjdGlvbnMtZWxsaXBzZSI6IkVsbGlwc2UiLCJsYW5ndWFnZS10b29sYmFyLWlkZW50aWZ5LXJlY3RhbmdsZS10b29sdGlwIjoiRmluZCBvdXQgYWJvdXQgYW4gYXJlYSBvbiB0aGUgbWFwIGRlZmluZWQgYnkgYSByZWN0YW5nbGUiLCJsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtYW5nbGUiOiJBbmdsZSIsImxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1hdHRyaWJ1dGUtc2VsZWN0IjoiUGxlYXNlIENob29zZS4uLiIsImxhbmd1YWdlLWNvbW1vbi1sYXllci1kYXRhIjoiTGF5ZXIgRGF0YSIsImxhbmd1YWdlLW1lbnUtbGF0aXR1ZGUtZ2VvZ3JhcGhpY3MiOiJMYXRpdHVkZSBHZW9ncmFwaGljcyBHcm91cCBMdGQuIiwibGFuZ3VhZ2UtdG9vbGJhci10YXNrcy1sYXllci1jYXRhbG9nLXRvb2x0aXAiOiJBZGQgbGF5ZXJzIHRvIHRoZSBtYXAgZnJvbSBhIGxheWVyIGNhdGFsb2ciLCJsYW5ndWFnZS10YWItc2Nyb2xsLW5leHQiOiJOZXh0IExheWVyIiwibGFuZ3VhZ2UtbGF5ZXItYWN0aW9ucy10aXRsZSI6IkxheWVyIEFjdGlvbnMiLCJsYW5ndWFnZS10b29sYmFyLWdyb3VwLXRpbWVzbGlkZXIiOiJUaW1lIFNsaWRlciIsImxhbmd1YWdlLXJlc3VsdHMtdG90YWwiOiJUb3RhbCIsImxhbmd1YWdlLWNvbW1vbi1yZXN1bHRzLXN1YnRyYWN0LWNvbmZpcm1hdGlvbiI6InsxfSBzdWJ0cmFjdGVkIGZyb20gJ3swfSciLCJsYW5ndWFnZS10b29sYmFyLWFyY2dpcy1leHBvcnQtd2ViLW1hcC10b29sdGlwIjoiU2F2ZSB0aGUgY3VycmVudCBtYXAgdG8gQXJjR0lTIiwibGFuZ3VhZ2UtbWVudS1zYXZlLXJlc3VsdHMtZGVzYyI6IlNhdmUgdGhlIGxpc3Qgb2YgcmVzdWx0cyBmb3IgZnV0dXJlIHVzZSIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tcHJvbXB0IjoiRGlzcGxheXMgYSBwcm9tcHQuIiwibGFuZ3VhZ2UtY29tbW9uLW5vLXJlc3VsdHMiOiJObyByZXN1bHRzIHRvIGRpc3BsYXkiLCJsYW5ndWFnZS1vZmZsaW5lLXByb2dyZXNzLWJhc2VtYXBleHBvcnQtY2FuY2VsZWQiOiJ7MH0gY2FuY2VsZWQuIiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtcGFsZXR0ZS1zbWFsbC1jbGVhci1hbGwiOiJDbGVhciBBbGwiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWNyZWF0ZS1oaWdobGlnaHQtbGF5ZXIiOiJDcmVhdGVzIGEgbmV3IGhpZ2hsaWdodCBsYXllciB3aXRoIHRoZSBzcGVjaWZpZWQgbmFtZS4iLCJsYW5ndWFnZS1tZW51LWlkZW50aWZ5LXJlY3RhbmdsZSI6IklkZW50aWZ5IGJ5IHJlY3RhbmdsZSIsImxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1maWxsLXN0eWxlIjoiRmlsbCBTdHlsZSIsImxhbmd1YWdlLXRvb2xiYXItYm9va21hcmstb3BlbiI6Ik9wZW4gdGhlIGJvb2ttYXJrcyB2aWV3IiwibGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLWxpbmUtc3R5bGUtZGFzaCI6IkRhc2giLCJsYW5ndWFnZS10b29sYmFyLWJ1ZmZlcmluZy1kaXNhYmxlIjoiRGlzYWJsZSBidWZmZXJpbmciLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXVwZGF0ZS1yZWxhdGVkLXJlY29yZCI6IlVwZGF0ZXMgYSByZWxhdGVkIHRhYmxlIHJlY29yZC4iLCJsYW5ndWFnZS10b29sYmFyLWJvb2ttYXJrIjoiQm9va21hcmtzIn0=");
geocortex.framework.notifyLibraryDownload("Mapping.Infrastructure");
