!function(){function e(e,t,i){if("string"==typeof e&&(i=t,t=e),void 0!==i)for(var a=t.split("."),r=null,n=window,s=0,o=a.length;s<o;s++)r=a[s],s==o-1?n[r]=i:n[r]||(n[r]={}),n=n[r];else console.warn("Undefined shim for: "+t)}var t="<div class='panel-group' data-binding='{@visible: attachmentInfos}'>    <h3 data-binding='{@text: @language-feature-attachments}'></h3>    <div class='no-item' data-binding='{@hidden: isAttachmentInfosInitialized}{@text: @language-feature-attachments-checking}'></div>    <div class='no-item' data-binding='{@visible: noAttachments}{@text: @language-feature-attachments-no-attachments}'></div>    <div class='no-item' data-binding='{@visible: isOffline}{@text: @language-feature-attachments-no-attachments-offline}'></div>    <ul class='list-menu active has-icon' data-binding='{@source: attachmentInfos}'>        <li class='attachment list-menu-item' data-binding='{@template-for: attachmentInfos}{@class-has-delete-button: canEditAttachments}'>            <a class='list-menu-details' data-binding='{href: url}{@event-onclick: attachment_click}{target: target}'>                <img class='list-menu-icon' src='Resources/Images/Icons/Toolbar/attach-24.png' data-binding='{alt: @language-feature-attachments}' />                <strong class='list-menu-name' data-binding='{@text: name}'></strong>                <span class='list-menu-desc' data-binding='{@text: size}'></span>            </a>            <button class='list-item-button icon icon-delete-16' data-binding='{@visible: canEditAttachments}{@event-click: handleDeleteClick}{title: @language-feature-attachments-delete}{@text: @language-feature-attachments-delete}'></button>        </li>    </ul></div>",i="<div class='panel-group' data-binding='{@visible: providerEnabled}'>    <h3 data-binding='{@text: @language-feature-attributes}' tab-index='1'></h3>    <div class='list-menu attrib static' data-binding='{@source: attributes}'>        <div class='list-menu-item' data-binding='{@template-for: attributes}{@visible: visible}'>            <strong class='list-menu-name' data-binding='{@text: displayName}'></strong>            <div class='list-menu-desc'>                <span data-binding='{@hidden: displayAsUrl}{@text: presentableValue}'></span>                <a data-binding='{href: value}{@visible: displayAsUrl}{@text: presentableValue}{@event-onclick: handleClickAttributeLink}' target='_blank'></a>                <span data-binding='{@hidden: presentableValue}{@text: @language-feature-not-available}'></span>            </div>        </div>    </div></div>",a="<div class='panel-group'>    <h3 data-binding='{@text: displayName}'></h3>    \x3c!-- DataLinks Table --\x3e    <div class='datalinks-table-widget' data-binding='{@widget: DataLinksTableViewWidget}{@widget-context: @context}{@widget-required: false}'></div>    \x3c!-- END: DataLinksTable Table --\x3e</div>",r="<div class='panel-group' data-binding='{@visible: providerEnabled}'>    <h3 data-binding='{@text: displayName}'></h3>    <div class='list-menu active' data-binding='{@source: dataLinks}'>        <button class='list-menu-item' data-binding='{@template-for: dataLinks}{@event-click: handleViewClick}'>            <div class='list-menu-details'>                <div class='list-menu-name' data-binding='{@text: displayName}'></div>            </div>        </button>    </div></div>",n="<div class='panel-group data-link'>    <h3 data-binding='{@text: @language-feature-attributes}'></h3>    <div class='datalinks' data-binding='{@visible: currentDataLink}{@source: currentDataLink}'>        <div class='list-menu attrib' data-binding='{@template-for: currentDataLink}{@source: attributes}'>            <div class='list-menu-item' data-binding='{@template-for: attributes}' tabindex='0'>                <strong class='list-menu-name' data-binding='{@text: name}'></strong>                <span class='list-menu-desc' data-binding='{@visible: presentableValue}'>                    <span data-binding='{@hidden: displayAsUrl}{@text: presentableValue}'></span>                    <a data-binding='{@event-onclick: handleClickDataLink}{href: value}{@visible: displayAsUrl}{@text: value}' target='_blank'></a>                </span>                <span class='list-menu-desc' data-binding='{@hidden: presentableValue}{@text: @language-feature-not-available}'></span>            </div>        </div>    </div></div>",s="<div class='panel-group feature-description-provider' data-binding='{@visible: providerEnabled}'>    <h3 data-binding='{@text: @language-feature-description}' tab-index='1'></h3>    <div class='feature-details-content' data-binding='{@widget: GetDescription}{@widget-context: currentFeature}{@widget-required: false}'>    </div></div>",o="<div class='panel-group' data-binding='{@visible: providerEnabled}'  tabindex='0'>    <h3 data-binding='{@text: @language-feature-actions}' tabindex='0'></h3>    <ul class='list-menu active has-icon' data-binding='{@source: visibleMenuItems}'>        <li class='list-menu-item' data-binding='{@template-for: visibleMenuItems}{@event-onmouseover: getDescription}{@event-onclick: handleMenuItemClick}'>            <button class='list-menu-details'>                <img class='list-menu-icon' data-binding='{@visible: iconUri}{src: iconUri}' alt=''/>                <strong class='list-menu-name' data-binding='{@text: text}'></strong>                <span class='list-menu-desc' data-binding='{@text: description}'></span>            </button>        </li>    </ul></div>",l="<div class='panel-group feature-hyperlinks-provider' data-binding='{@visible: providerEnabled}'>    <h3 data-binding='{@text: @language-feature-hyperlinks}'></h3>    <ul class='list-menu hyperlinks' data-binding='{@visible: providerEnabled}{@source: hyperlinks}'>        <li class='list-menu-item' data-binding='{@template-for: hyperlinks}'>            <a class='list-menu-button' data-binding='{href: uri}{target: target}{@event-onclick: handleClickHyperlink}'>                <span class='list-menu-details' data-binding='{title: toolTip}{@class-disabled: isBroken}'>                    <strong class='list-menu-name' data-binding='{@text: text}'></strong>                </span>            </a>        </li>    </ul></div>",u="<div class='panel-group' data-binding='{@visible: providerEnabled}'>    <h3 data-binding='{@text: @language-feature-attributes}' tabindex='0'></h3>    <div class='attrib static' data-binding='{@source: multiColumnAttributeContainer}'>        <div class='multi-column-container' data-binding='{@template-for: multiColumnAttributeContainer}'>            <ul class='attribute-list columns' data-binding='{@source: @context}{@template: Mapping/modules/FeatureDetails/FeatureDetailsProviders/SingleAttributeView.html}'></ul>        </div>    </div></div>",d="<div class='panel-group' data-binding='{@class-has-editable-related-features: relatedsEditable}{@visible: providerEnabled}' tabindex='0'>    <h3>        <span>            <span data-binding='{@text: displayName}'></span>        </span>    </h3>    \x3c!-- CREATE/EDIT RELATED FEATURES --\x3e    <div class='no-item' data-binding='{@hidden: hasRetrievedData}{@text: @language-feature-related-checking}'></div>    <div class='createfeature' data-binding='{@enabled: hasRetrievedData}'>        <ul class='list-menu has-icon createfeature-actions' data-binding='{@visible: canAdd}'>            <li class='list-menu-item'>                <button class='list-menu-details' data-binding='{@enabled: validCardinality}{@event-click: handleClickAddRelatedRecord}'>                    <img class='list-menu-icon' src='Resources/Images/Icons/add-24.png' alt=' ' />                    <span class='list-menu-desc' data-binding='{@text: @language-feature-create-related-features}'></span>                </button>            </li>        </ul>        <div class='no-item' data-binding='{@visible: noRelatedFeatures}{@text: @language-feature-related-no-data}'></div>        <div class='no-item' data-binding='{@visible: errorFetchingRelatedFeatures}{@text: @language-feature-related-error-fetching}'></div>        \x3c!-- Related Features Table --\x3e        <div class='related-features-table-widget' data-binding='{@hidden: noRelatedFeatures}{@widget: RelatedFeaturesTableViewWidget}{@widget-context: @context}{@widget-required: false}'></div>        \x3c!-- END: Related Features Table --\x3e    </div></div>",c="<div class='panel-group' data-binding='{@visible: providerEnabled}' tabindex='0'>    <h3>        <span>            <span data-binding='{@text: displayName}'></span>        </span>    </h3>    \x3c!-- CREATE/EDIT RELATED FEATURES --\x3e    <div class='no-item' data-binding='{@hidden: hasRetrievedData}{@text: @language-feature-related-checking}'></div>    <div data-binding='{@enabled: hasRetrievedData}'>        <div class='list-menu has-icon' data-binding='{@visible: canAdd}'>            <button class='list-menu-item' data-binding='{@enabled: validCardinality}{@event-click: handleClickAddRelatedRecord}'>                <img class='list-menu-icon' src='Resources/Images/Icons/add-24.png' alt=' ' />                <span class='list-menu-desc' data-binding='{@text: @language-feature-create-related-features}'></span>            </button>        </div>        <div class='no-item' data-binding='{@visible: noRelatedFeatures}{@text: @language-feature-related-no-data}'></div>        <div class='no-item' data-binding='{@visible: errorFetchingRelatedFeatures}{@text: @language-feature-related-error-fetching}'></div>        <div class='list-menu active' data-binding='{@source: relatedEsriFeatureInfo}'>            <button class='list-menu-item' data-binding='{@template-for: relatedEsriFeatureInfo}{@event-click: handleViewClick}'>                <div class='list-menu-details'>                    <strong class='list-menu-name' data-binding='{@text: displayName}'></strong>                </div>            </button>        </div>    </div></div>",p="<li class='attribute-item' data-binding='{@template-for: @context}{@visible: visible}' tabindex='0'>    <span class='attribute-label' data-binding='{@text: displayName}'></span>    <div class='attribute-details'>        <span data-binding='{@hidden: displayAsUrl}{@text: presentableValue}'></span>        <a data-binding='{href: value}{@visible: displayAsUrl}{@text: presentableValue}{@event-onclick: handleClickAttributeLink}' target='_blank'></a>        <span data-binding='{@hidden: presentableValue}{@text: @language-feature-not-available}'></span>    </div></li>",h="<div class='tab-container' data-binding='{@var: scrollingTabContainerElement}'>    <table>        <tr>            <td class='tab-left-scroll' data-binding='{@visible: tabControlsEnabled}{@class-disabled: leftScrollTabDisabled}{@var: scrollTabLeftElement}'>                <button data-binding='{@event-onclick: handleTabScrollBack}{title: @language-tab-scroll-prev}'>                    <img src='Resources/Images/Icons/chevron-left-16.png' data-binding='{alt: @language-feature-details-left-chevron}'>                </button>            </td>            <td >                <div class='tab-container' data-binding='{@var: tabContainerElement}'>                    <ul class='tab-control' data-binding='{@source: viewDescriptors}{@var: tabElements}'>                        <li data-binding='{@template-for: viewDescriptors}{@visible: providerEnabled}{@event-onclick: handleClickTab}'>                            <button data-binding='{@noclass-tab: isActive}{@class-tab-active: isActive}{@text: title}{title: title}'></button>                        </li>                    </ul>                </div>            </td>            <td class='tab-right-scroll' data-binding='{@visible: tabControlsEnabled}{@class-disabled: rightScrollTabDisabled}{@var: scrollTabRightElement}'>                <button data-binding='{@event-onclick: handleTabScrollForward}{title: @language-tab-scroll-next}'>                    <img src='Resources/Images/Icons/chevron-right-16.png' data-binding='{alt: @language-feature-details-right-chevron}' />                </button>            </td>        </tr>    </table></div>",g="<div class='feature-details-header'>    <div class='feature-actions-widget' data-binding='{@visible: currentFeature}{@widget: FeatureActionsWidget}{@widget-context: currentFeature}{@widget-required: false}' data-menu-id='FeatureActions' data-menu-template='Mapping/infrastructure/menus/MenuHyperlinkView.html'></div></div><div data-binding='{@widget: FeatureDetailsRegionWidget}{@widget-context: @context}{@widget-required: true}{@widget-replace: true}' tabindex='0'></div>",b="<div class='large-feature-detail' data-binding='{@visible: headerText}'>        <h2 data-binding='{@text: headerText}'></h2>    <div class='panel-group' data-binding='{@visible: FeatureActions}'>        <ul class='actions-menu' data-binding='{@source: FeatureActions}'>            <li data-binding='{@template-for: FeatureActions}'>                <a href='javascript:void(0);' data-binding='{@text: text}{@event-onmouseover: getDescription}{@event-onclick: handleMenuItemClick}'></a>            </li>        </ul>    </div>        <div class='panel-group' data-region-name='FeatureRegion' data-region-adapter='geocortex.framework.ui.DivStackRegionAdapter'></div> </div>";require({cache:{"Mapping/modules/FeatureDetails/FeatureDetailsModule":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();define(["require","exports","geocortex/framework/application/ModuleBase","geocortex/infrastructure/Feature","geocortex/infrastructure/FeatureSetCollection","geocortex/framework/ui/MultiViewRegionAdapter","geocortex/geocortex","geocortex/infrastructure/TaskUtils","geocortex/infrastructure/GraphicUtils","geocortex/framework/utils/utils"],function(t,i,a,r,n,s,o,l,u,d){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var c=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.providerViewModelList=[],e.providerViewList=[],e._providerConfig=null,e._currentFeature=null,e._defaultViewMode=null,e._viewModes={},e}return e(i,t),i.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this._processConfig(e),this.registerCommands(),this.app.event("GraphicAttributesChangedEvent").subscribe(this,this.handleGraphicAttributesUpdated)},i.prototype.handleGraphicAttributesUpdated=function(e){var t=e.graphic;this._currentFeature&&this._currentFeature.esriFeature&&this._currentFeature.esriFeature.get()===t&&(this._currentFeature.esriFeature.pulse(),this.app.event("FeatureChangedEvent").publish(this._currentFeature))},i.prototype.getStateFilter=function(){return{currentFeature:this.app.project.filter.feature,viewMode:!0}},i.prototype.exportState=function(){var e=this;return Promise.try(function(){var t=e._viewModes[e._defaultViewMode].viewId,i=e.app.viewManager.getViewById(t);return{currentFeature:i&&i.isActive?e.app.project.convert.fromGcxFeature(e._currentFeature):null,viewMode:e._defaultViewMode}})},i.prototype.applyState=function(e){var t=this;return this.app.project.convert.toGcxFeature(e.currentFeature).catch(function(e){return null}).then(function(i){var a=e.viewMode;t._viewModes[a]||(a=t._defaultViewMode),t._executeSetFeatureDetailsMode({viewMode:a,feature:i})})},i.prototype._processConfig=function(e){if(e){if(e.viewModes)for(var t in e.viewModes)e.viewModes.hasOwnProperty(t)&&(e.viewModes[t].viewId&&e.viewModes[t].defaultProviderTargetRegion?(e.defaultViewMode||(e.defaultViewMode=t.toLowerCase()),this._viewModes[t.toLowerCase()]=e.viewModes[t]):this.app.trace.warning("FeatureDetailsModule: Error loading view mode - viewId or defaultProviderTargetRegion not specified. Please check your configuration"));if(this._defaultViewMode=e.defaultViewMode,!this._defaultViewMode)return void this.app.trace.error("FeatureDetailsModule: Could not compute default view mode. Please check your configuration settings");e.providers&&(this._providerConfig=e.providers)}},i.prototype.registerCommands=function(){var e=this;this.app.command("ShowFirstFeatureFromCollection").register(this,function(t){var i=null;if(!t&&e._currentFeature?e.app.command("ShowFeatureDetails").execute(e._currentFeature):"string"==typeof t?i=e.app.featureSetManager.getCollectionById(t):t instanceof n.FeatureSetCollection?i=t:e.app.trace.error("No FeatureSetCollection or ID given"),i){var a=i.firstFeature();a?e.app.command("ShowFeatureDetails").execute(a):e.app.trace.error("No feature in FeatureSetCollection")}else e.app.trace.error("No FeatureSetColection found.")}),this.app.command("ShowFeatureDetails").register(this,function(t){!t&&e._currentFeature&&(t=e._currentFeature),t?"string"==typeof t?e.app.command("ShowFirstFeatureFromCollection").execute(t):(e.app.command("_updateFeatureDetailViewModels").execute(t),e._processFeatureDetails(t)):e.app.trace.error("ShowFeatureDetails: Could not execute command. No feature found.")}),this.app.command("ShowFeatureDetailsFromMaptip").register(this,this._showFeatureDetailsFromMaptip,this._canExecuteshowFeatureDetailsFromMaptip),this.app.command("HideFeatureDetails").register(this,this._deactivateFeatureDetailsView),this.app.command("GetFeatureDetailsProviders").register(this,this._processFeatureDetails),this.app.command("ShowFeatureDetailsCompact").register(this,function(t){e._executeSetFeatureDetailsMode({viewMode:"compact",feature:t}),e.app.command("ShowFeatureDetailsExpanded").raiseCanExecuteChanged()},function(t){return e._canExecuteSetFeatureDetailsMode({viewMode:"compact",feature:t})}),this.app.command("ShowFeatureDetailsExpanded").register(this,function(t){e._executeSetFeatureDetailsMode({viewMode:"expanded",feature:t}),e.app.command("ShowFeatureDetailsCompact").raiseCanExecuteChanged()},function(t){return e._canExecuteSetFeatureDetailsMode({viewMode:"expanded",feature:t})}),this.app.command("SetFeatureDetailsMode").register(this,this._executeSetFeatureDetailsMode,this._canExecuteSetFeatureDetailsMode),this.app.command("GetRelatedFeatures").register(this,this._executeGetRelatedFeatures)},i.prototype._executeSetFeatureDetailsMode=function(e){this._defaultViewMode="string"==typeof e?e:e.viewMode,"string"!=typeof e&&e.feature&&e.feature!==this._currentFeature&&(this.app.command("_updateFeatureDetailViewModels").execute(e.feature),this._processFeatureDetails(e.feature)),this._activateFeatureDetailsView(this._currentFeature)},i.prototype._canExecuteSetFeatureDetailsMode=function(e){var t,i="string"==typeof e?e:e.viewMode,a=this._getViewModeConfigParams(i);a&&(t=this.app.viewManager.getViewById(a.viewId));var r=e.feature;return r&&r!==this._currentFeature?!!t&&!!a.defaultProviderTargetRegion:!(!t||t.isActive||!a.defaultProviderTargetRegion||!r&&!this._currentFeature)},i.prototype.updateFeature=function(e){e&&e!==this._currentFeature&&(this._currentFeature=e,this.providerViewModelList.forEach(function(t){return t.currentFeature.set(e)}),this.app.project.isLoading||this.app.event("FeatureDetailsCurrentFeatureChanged").publish(e))},i.prototype._processFeatureDetails=function(e){var t=this,i=function(){t._loadProviders(t._providerConfig),t.updateFeature(e),t._activateFeatureDetailsView(e),t.app.event("FeatureDetailsInvokedEvent").publish(e)};this.app.allLibrariesLoaded?i():this.app.event("ViewerLibrariesDownloadedEvent").once(this,i)},i.prototype._activateFeatureDetailsView=function(e){if(e){var t=null;if(!this.app.project.isLoading){for(var i in this._viewModes)if(this._viewModes.hasOwnProperty(i)){var a=this._viewModes[i].viewId;if(i===this._defaultViewMode)t=a;else{var r=this.app.viewManager.getViewById(a);r&&r.isActive&&this.app.command("DeactivateView").execute(a)}}t&&(this.app.command("ActivateView").execute(t),t=null)}this._setProviderTargetRegions(this._defaultViewMode)}},i.prototype._showFeatureDetailsFromMaptip=function(e){this.app.configuration.mobileMode||this.app.command("DeactivateView").execute("MapTipView"),this.app.command("RemoveResultsStatus").execute(),this.app.command("ShowFeatureDetails").execute(e)},i.prototype._canExecuteshowFeatureDetailsFromMaptip=function(e){if(e&&e.esriFeature&&e.esriFeature.get()){var t=e.esriFeature.get();if(u.isClickableGraphic(this.app,t)){var i=u.getClickableLayerInfo(this.app,t);if(i&&i.canEdit(t))return!1}}return!0},i.prototype._deactivateFeatureDetailsView=function(){var e=this._getViewModeConfigParams(this._defaultViewMode);if(e&&e.viewId){var t=this.app.viewManager.getViewById(e.viewId);t&&t.isActive&&this.app.command("DeactivateView").execute(e.viewId)}},i.prototype._loadProviders=function(e){var t=this;if(!(this.providerViewModelList.length>0)){var i=function(e,i){i.forEach(function(e){t._wireUpViewBindings(e),t.providerViewList.push(e)}),t._setProviderTargetRegions(t._defaultViewMode)};e.forEach(function(e){if(!1!==e.enabled){var a=dojo.getObject(e.type);if(a){var r=new a(t.app,e.libraryId||t.libraryId),n=t._getProviderViewModeRegionConfig(e);r.app=t.app,r.libraryId=e.libraryId||t.libraryId,r.initialize(e.config),r.createAttachedViews(e,n,function(e){return i(0,e)}),t.providerViewModelList.push(r)}else t.app.trace.warning("Cannot find FeatureDetailsProvider '{0}'.".format(e.type))}})}},i.prototype._getProviderConfigByView=function(e){if(this._providerConfig)for(var t=0,i=this._providerConfig;t<i.length;t++){var a=i[t],r=a.markup;if(r&&"string"==typeof r){if(r===e.markupResource)return a}else for(var n in r)if(r.hasOwnProperty(n)&&r[n]===e.markupResource)return a}return null},i.prototype._getProviderTargetRegionForMode=function(e,t){var i=null;if(e.targetRegion&&e.targetRegion[t])i=e.targetRegion[t];else{var a=this._getViewModeConfigParams(t);a&&(i=a.defaultProviderTargetRegion)}return i},i.prototype._getViewModeConfigParams=function(e){for(var t in this._viewModes)if(this._viewModes.hasOwnProperty(t)&&t===e)return this._viewModes[e];return null},i.prototype._getProviderViewModeRegionConfig=function(e){var t={};if("string"==typeof e.markup)t.default=this._getProviderTargetRegionForMode(e,this._defaultViewMode);else for(var i in e.markup)e.markup.hasOwnProperty(i)&&(t[i]=this._getProviderTargetRegionForMode(e,i));return t},i.prototype._setProviderTargetRegions=function(e){var t=this;e&&(this.providerViewList.forEach(function(i){var a=t._getProviderConfigByView(i),r=t._getProviderTargetRegionForMode(a,e),n="string"==typeof a.markup||a.markup[e]&&a.markup[e]===i.markupResource||void 0===a.markup[e];if(t.app.viewManager.deactivateView(i),n){var s=null;if(r){var o=t.app.viewManager.getRegionForViewId(i.id);o&&(s=i.removed,i.removed=function(){},o.unhostView(i),i.regionName=r)}t.app.viewManager.activateView(i),s&&(i.removed=s),d.isNullOrUndefined(i.viewModel.providerEnabled)||i.viewModel.providerEnabled.pulse()}}),this.app.event("Internal.FeatureProviderTargetRegionsChanged").publish(this._currentFeature))},i.prototype._wireUpViewBindings=function(e){var t=this,i=function(i){if(i){var a=t.app.viewManager.getExistingRegionByName(e.regionName);!a||a instanceof s.MultiViewRegionAdapter&&1!==a.views.length||t.app.viewManager.activateView(e)}else t.app.viewManager.deactivateView(e)};if(e.viewModel&&e.viewModel.providerEnabled&&e.viewModel.providerEnabled.isObservable){i(e.viewModel.providerEnabled.get());var a=e.viewModel.providerEnabled.bind(this,i),r=e.onDestroy.bind(e);e.onDestroy=function(){e.viewModel.providerEnabled.unbind(a);for(var i=t.providerViewList.length-1;i>=0;i--)t.providerViewList[i]===e&&t.providerViewList.splice(i,1);"function"==typeof r&&r()}}},i.prototype._executeGetRelatedFeatures=function(e){this._getRelatedFeatures(e.mapService,e.relationshipId,e.objectId,e.currentFeature,e.successCallback,e.errorCallback)},i.prototype._getRelatedFeatures=function(e,t,i,a,n,s){var u=new dojo.Deferred;if(!e){d=new Error("_getRelatedFeatures: mapService cannot be null.");return o.deferredReject(u,d),"function"==typeof s&&s(d),u}if(isNaN(t)){d=new Error("_getRelatedFeatures: relationshipId cannot be null.");return o.deferredReject(u,d),"function"==typeof s&&s(d),u}if(!i){var d=new Error("_getRelatedFeatures: objectId cannot be null.");return o.deferredReject(u,d),"function"==typeof s&&s(d),u}var c=new esri.tasks.RelationshipQuery;c.outFields=["*"],c.relationshipId=t,c.objectIds=[i];var p=null;return a&&(a instanceof r.Feature?p=a.layer?a.layer:a.featureLayer:a instanceof esri.Graphic&&(p=a.getLayer())),p||(p=e.serviceLayer),p?l.getQueryTask(p,e).executeRelationshipQuery(c).then(function(e){var t=[];for(var i in e)if(e.hasOwnProperty(i))for(var a=0,r=e[i].features;a<r.length;a++){var s=r[a];t.push(s)}o.deferredResolve(u,t),"function"==typeof n&&n(t)},function(e){o.deferredReject(u,e)}):o.deferredResolve(u,[]),u},i}(a.ModuleBase);i.FeatureDetailsModule=c})},"Mapping/modules/FeatureDetails/FeatureDetailsModuleConfig":function(){define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})},"Mapping/modules/FeatureDetails/FeatureDetailsState":function(){define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})},"Mapping/modules/FeatureDetails/FeatureDetailsSwitcherView":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();define(["require","exports","geocortex/framework-ui/ViewSwitcher/ViewSwitcherView"],function(t,i,a){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(t){function i(e,i){var a=t.call(this,e,i)||this;return a.viewModel=null,a.scrollingTabContainerElement=null,a.tabContainerElement=null,a.tabElements=null,a.scrollTabLeftElement=null,a.scrollTabRightElement=null,a.delayedExecuteToken=null,a.appResizedSubToken=null,a}return e(i,t),i.prototype.handleClickTab=function(e,i,a){t.prototype.handleClickTab.call(this,e,i,a),this._refreshTabControlVisibility()},i.prototype.activated=function(){t.prototype.activated.call(this),this.appResizedSubToken=this.app.event("ApplicationResizedEvent").subscribe(this,this.handleResize)},i.prototype.deactivated=function(){t.prototype.deactivated.call(this),this.app.event("ApplicationResizedEvent").unsubscribe(this.appResizedSubToken),this.appResizedSubToken=null},i.prototype.handleResize=function(){var e=this;this.isActive&&(this.delayedExecuteToken&&(clearTimeout(this.delayedExecuteToken),this.delayedExecuteToken=null),this.delayedExecuteToken=setTimeout(function(){e._refreshTabControlVisibility()},200)),this._refreshTabControlVisibility()},i.prototype._updateScrollTabDisabledStatus=function(){if(this.tabContainerElement){var e=this.tabContainerElement.scrollWidth-this.tabContainerElement.offsetWidth;this.viewModel.leftScrollTabDisabled.set(0===this.tabContainerElement.scrollLeft),this.viewModel.rightScrollTabDisabled.set(this.tabContainerElement.scrollLeft>e-1)}},i.prototype.handleTabScrollBack=function(e,t,i){var a=$(this.tabContainerElement),r=a.scrollLeft()-2*this.scrollTabLeftElement.offsetWidth;a.scrollLeft(r<0?0:r),this._updateScrollTabDisabledStatus()},i.prototype.handleTabScrollForward=function(e,t,i){var a=$(this.tabContainerElement),r=this.tabContainerElement.scrollWidth-this.tabContainerElement.offsetWidth,n=a.scrollLeft()+2*this.scrollTabRightElement.offsetWidth;a.scrollLeft(n>r?r:n),this._updateScrollTabDisabledStatus()},i.prototype._refreshTabControlVisibility=function(){var e=this;setTimeout(function(){e.scrollingTabContainerElement&&e.tabElements&&(e.viewModel.tabControlsEnabled.set(e.tabElements.offsetWidth>e.scrollingTabContainerElement.offsetWidth),e._updateScrollTabDisabledStatus())},100)},i}(a.ViewSwitcherView);i.FeatureDetailsSwitcherView=r})},"Mapping/modules/FeatureDetails/FeatureDetailsSwitcherViewDescriptor":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();define(["require","exports","geocortex/framework-ui/ViewSwitcher/ViewSwitcherViewDescriptor","geocortex/framework/observables"],function(t,i,a,r){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.providerEnabled=new r.Observable(!1),e}return e(i,t),i}(a.ViewSwitcherViewDescriptor);i.FeatureDetailsSwitcherViewDescriptor=n})},"Mapping/modules/FeatureDetails/FeatureDetailsSwitcherViewModel":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();define(["require","exports","geocortex/framework-ui/ViewSwitcher/ViewSwitcherViewModel","geocortex/framework/observables","./FeatureDetailsSwitcherViewDescriptor"],function(t,i,a,r,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=function(t){function i(e,i,a){var n=t.call(this,e,i,a)||this;return n.tabControlsEnabled=new r.Observable(!1),n.leftScrollTabDisabled=new r.Observable(!1),n.rightScrollTabDisabled=new r.Observable(!1),n._defaultLayerTabView=null,n._layerTabViews={},n._currFeatureProviderBindings=[],n.app.event("Internal.FeatureProviderTargetRegionsChanged").subscribe(n,n._handleFeatureChanged),n.app.command("_updateFeatureDetailViewModels").register(n,n._handleFeatureChanged),n}return e(i,t),i.prototype.initialize=function(e){if(t.prototype.initialize.call(this,e),e&&e.hasOwnProperty("defaultTabViewForLayer")){var i=e.defaultTabViewForLayer;for(var a in i)if(i.hasOwnProperty(a)){var r=i[a];if(dojo.isArray(r))for(var n=0;n<r.length;n++)this._addProperty(a,r[n]);else this._addProperty(a,r)}}},i.prototype.createDescriptorForView=function(e){var t=new n.FeatureDetailsSwitcherViewDescriptor(e,this);return this._processViewDescriptor(t),t},i.prototype.checkIfSwitcherActive=function(){return dojo.filter(this.viewDescriptors.get(),function(e){return e.providerEnabled.get()}).length>1},i.prototype._addProperty=function(e,t){this._layerTabViews[e]||(this._layerTabViews[e]=[]),e&&"default"===t?this._defaultLayerTabView=e:null!=t.mapServiceId&&null!=t.layerId?this._layerTabViews[e].push(t):this.app.trace.warning("Invalid configuration for default layer tab view. Syntax is - {PreferredViewId} : { {mapServiceId}, {layerId} }")},i.prototype._getPreferredViewDescriptor=function(e,t){if(!e||!t)return null;for(var i in this._layerTabViews)if(this._layerTabViews.hasOwnProperty(i))for(var a=this._layerTabViews[i],r=0;r<a.length;r++)if(e===a[r].mapServiceId&&t===a[r].layerId){var n=this._getDescriptorForFirstEligibleTabView(i);if(n)return n}},i.prototype._processViewDescriptor=function(e){var t=this,i=function(i){e.providerEnabled.bind(t,t.updateViewSwitcherState),e.providerEnabled.sync(i.providerEnabled)};e.view.viewModel?i(e.view.viewModel):dojo.aspect.after(e.view,"attach",dojo.hitch(this,i),!0)},i.prototype._handleFeatureChanged=function(e){if(0!==this.viewDescriptors.length()&&(this._cancelBindingsIfApplicable(),e&&e.layer)){var t=e.layer.mapService?e.layer.mapService.id:null;this._activateDefaultTabViewForLayer(t,e.layer.id)}},i.prototype._activateDefaultTabViewForLayer=function(e,t){var i=this,a=null,r=!1,n=null,s=function(e){var t=e.providerEnabled,a=e.providerEnabled.bind(i,function(t){if(t){var a=n&&e.view.id===n.view.id;r&&!a||(i.app.viewManager.activateView(e.view),a&&i._cancelBindingsIfApplicable()&&(n=null),r=!0)}});i._currFeatureProviderBindings.push({currentFeatureProviderEnabledRef:t,currentFeatureProviderBindingToken:a})};!(a=this._getPreferredViewDescriptor(e,t))&&this._defaultLayerTabView&&(a=this._getDescriptorForFirstEligibleTabView(this._defaultLayerTabView)),a&&!a.providerEnabled.get()&&(n=a,a=null),!a&&(a=function(){for(var e=0;e<i.viewDescriptors.length();e++)if(i.viewDescriptors.getAt(e).providerEnabled.get()&&i.viewDescriptors.getAt(e).view)return i.viewDescriptors.getAt(e);return null}()),a?(this.app.viewManager.activateView(a.view),r=!0,n&&s(n)):this.viewDescriptors.get().forEach(function(e){return s(e)})},i.prototype._cancelBindingsIfApplicable=function(){this._currFeatureProviderBindings.length&&(this._currFeatureProviderBindings.forEach(function(e){e.currentFeatureProviderEnabledRef.unbind(e.currentFeatureProviderBindingToken)}),this._currFeatureProviderBindings=[])},i.prototype._getDescriptorForFirstEligibleTabView=function(e){var t=null;if(!(t=this.getDescriptorForView(this.app.viewManager.getViewById(e)))){var i=this.app.viewManager.getViews().filter(function(t){return t.id.startsWith(e)});if(i.length)for(var a=0;a<i.length&&!(t=this.getDescriptorForView(i[a]));a++);}return t},i}(a.ViewSwitcherViewModel);i.FeatureDetailsSwitcherViewModel=s})},"Mapping/modules/FeatureDetails/FeatureDetailsView":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();define(["require","exports","geocortex/framework/ui/ViewBase"],function(t,i,a){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(t){function i(e,i){var a=t.call(this,e,i)||this;return a._multiRegionCssBindingToken="",a.app.event("FeatureDetailsCurrentFeatureChanged").subscribe(a,a._handleFeatureChanged),a.app.event("ViewContainerViewClosedEvent").subscribe(a,function(e){e.viewId===a.id&&a.viewModel&&a.viewModel.currentFeature.get()&&a.viewModel.setFeatureDetailsDisplayFeatureTag(a.viewModel.currentFeature.get(),!1)}),a}return e(i,t),i.prototype.attach=function(e){t.prototype.attach.call(this,e),this.title.syncTransform(e.headerText,function(e){return String.unescapeHtml(e)}),-1===e.viewsToActivate.indexOf(this.id)&&e.viewsToActivate.push(this.id)},i.prototype.resolveWidget=function(e,i,a){switch(t.prototype.resolveWidget.call(this,e,i,a),e){case"FeatureDetailsRegionWidget":var r=this.app.viewManager.createView({markupResource:"Framework.UI/geocortex/framework/ui/MultiRegion/MultiRegionView.html",libraryId:"Framework.UI",typeName:"geocortex.framework.ui.MultiRegion.MultiRegionView",isVisible:!1});return r&&r.attach(i),this._processView(r),r;case"FeatureActionsWidget":return this.app.menuRegistry.createMenuWidget(this,i,a);default:return}},i.prototype.activated=function(){var e=this;t.prototype.activated.call(this),setTimeout(function(){return e.app.behavior("FeatureDetailsOpenedBehavior").run(e.viewModel.currentFeature.get())},300)},i.prototype.deactivated=function(){t.prototype.deactivated.call(this),this.app.behavior("FeatureDetailsClosedBehavior").run(this.viewModel.currentFeature.get()),this.isActive=!1},i.prototype._handleFeatureChanged=function(e){var t=this,i=this.app.command("ShowMap").postExecute.once(this,function(){setTimeout(function(){t.app.command("FocusOnFirstInputInView").execute(t)},0),i=null});this.app.event("ViewActivated").once(this,function(){i&&(t.app.command("ShowMap").postExecute.unsubscribe(i),setTimeout(function(){t.app.command("FocusOnFirstInputInView").execute(t)},0))})},i.prototype._processView=function(e){var t=this,i=e.multiRegionViewElement,a="",r=function(){i.className=a+" "+t.viewModel.featureMultiRegionCss.get().trim()};this._multiRegionCssBindingToken&&(this.viewModel.featureMultiRegionCss.unbind(this._multiRegionCssBindingToken),this._multiRegionCssBindingToken=""),i&&(a=i.className.trim(),r(),this._multiRegionCssBindingToken=this.viewModel.featureMultiRegionCss.bind(this,r))},i}(a.ViewBase);i.FeatureDetailsView=r})},"Mapping/modules/FeatureDetails/FeatureDetailsViewModel":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();define(["require","exports","geocortex/framework-ui/MultiRegion/MultiRegionViewModel","geocortex/framework/observables","geocortex/infrastructure/Feature","geocortex/infrastructure/FeatureSet","./FeatureDetailsSwitcherViewModel","geocortex/infrastructure/MapUtils"],function(t,i,a,r,n,s,o,l){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var u=function(t){function i(e,i){var a=t.call(this,e,i)||this;return a.headerText=new r.Observable(""),a.currentFeature=new r.Observable(null),a.currentEsriFeatureClone=null,a.currentFeatureSet=null,a.viewsToActivate=[],a.featureMultiRegionCss=new r.Observable(""),a._featureTag="isShownInFeaturedetails",a._lastTaggedCurrentFeature=null,a.currentFeature.bind(a,function(){return a._handleCurrentFeatureChanged()}),a.regionViewSwitcherWidgetMarkup="Mapping/modules/FeatureDetails/FeatureDetailsSwitcherView.html",a.regionViewSwitcherWidgetType="geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsSwitcherView",a.regionViewSwitcherLibraryId=a.libraryId,a._registerCommands(),a._subscribeEvents(),a.currentFeature.bind(a,function(e){e?(a._lastTaggedCurrentFeature&&a.setFeatureDetailsDisplayFeatureTag(a._lastTaggedCurrentFeature,!1),a.setFeatureDetailsDisplayFeatureTag(e,!0),a._lastTaggedCurrentFeature=e):a._lastTaggedCurrentFeature&&a.setFeatureDetailsDisplayFeatureTag(e,!1)}),a}return e(i,t),i.prototype.initialize=function(e){e&&(this._config=e,this._config.autoInsertViewSwitcher=!0),t.prototype.initialize.call(this,e)},i.prototype.createViewSwitcherViewModel=function(e){var t=new o.FeatureDetailsSwitcherViewModel(this.app,this.libraryId,e);return t.initialize(this._config),t},i.prototype.processRegion=function(e){var i=this;t.prototype.processRegion.call(this,e),e.regionActive.bind(this,function(t){return i._updateMultiRegionViewCss(e,t)})},i.prototype._updateMultiRegionViewCss=function(e,t){var i="";this.regionDescriptors.get().forEach(function(e){return i=i.concat(" {0}-{1}".format(e.regionName,e.regionActive.get()?"active":"inactive"))}),this.featureMultiRegionCss.set(i.trim())},i.prototype._registerCommands=function(){var e=this;this.app.command("_updateFeatureDetailViewModels").register(this,function(t){t&&t instanceof n.Feature&&(e._setCurrentFeature(t),e.currentFeatureSet=e.currentFeature.get()?e.currentFeature.get().featureSet:null)})},i.prototype._subscribeEvents=function(){this.app.event("FeatureEditedEvent").subscribe(this,this._handleEditedFeature),this.app.event("FeatureDeletedEvent").subscribe(this,this._handleDeletedFeature),this.app.event("FSMCollectionRemovedEvent").subscribe(this,this._onFeatureSetCollectionRemoved)},i.prototype._handleDeletedFeature=function(e){var t=e.originalFeature||e instanceof esri.Graphic?e:null;t&&this.currentEsriFeatureClone&&l.esriFeaturesEqual(this.currentEsriFeatureClone,t)&&(this.currentEsriFeatureClone=null,this._deactivateViews())},i.prototype._handleEditedFeature=function(e){e.originalFeature&&e.editedFeature?this.currentEsriFeatureClone&&l.esriFeaturesEqual(e.originalFeature,this.currentEsriFeatureClone)&&(this.currentFeature.get().esriFeature.set(e.editedFeature),this._processCurrentFeature(),this.currentEsriFeatureClone=e.editedFeature):this.app.trace.warning("FeatureDetailsViewModel: Could not handle FeatureEditedEvent. Original or Edited feature not provided.")},i.prototype._onFeatureSetCollectionRemoved=function(e){var t=e.featureSetCollection;if(t){var i=this.currentFeature.get();if(i&&i.featureSet){var a=t.getFeatureSetById(i.featureSet.id);a&&a.uniqueId==i.featureSet.uniqueId&&(this._deactivateViews(),this.currentFeature.set(null))}}},i.prototype._setCurrentFeature=function(e){if(this.currentFeature.get()&&this.app.command("ClearFeatureFocus").execute(this.currentFeature.get()),"string"==typeof e){var t=this.app.featureSetManager.getCollectionById(e);if(t){var i=t.firstFeature();i?this.currentFeature.set(i):this.app.trace.error("No feature in feature set collection")}else this.app.trace.error("No feature set collection found matching id: "+e)}else if(e&&e instanceof n.Feature){var a=e;if(null==a.featureSet){var r=new s.FeatureSet({app:this.app});r.addFeature(a),a.featureSet=r}this.currentFeature.set(a)}this._processCurrentFeature()},i.prototype._handleCurrentFeatureChanged=function(){var e=this.currentFeature.get();this.currentEsriFeatureClone=e?l.cloneEsriFeature(e._graphic):null},i.prototype._processCurrentFeature=function(){var e=this.currentFeature.get();this.headerText.removeSync(),e&&this.headerText.sync(e.plainLabel)},i.prototype._deactivateViews=function(){for(var e=0;e<this.viewsToActivate.length;e++){var t=this.viewsToActivate[e];this.app.command("DeactivateView").execute(t)}},i.prototype.setFeatureDetailsDisplayFeatureTag=function(e,t){e&&dojo.isFunction(e.setExtendedProperty)&&e.setExtendedProperty(this._featureTag,!!t)},i}(a.MultiRegionViewModel);i.FeatureDetailsViewModel=u})},"Mapping/modules/FeatureDetails/FeatureDetailsProviders/AttachmentsView":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();define(["require","exports","geocortex/framework/ui/ViewBase"],function(t,i,a){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return e(i,t),i.prototype.attachment_click=function(e,t,i){var a=this;return this.app.isOffline.get()?(this.app.command("RewriteUrlForOffline").execute(i.url.get(),function(e){if(e)return a.app.command("OpenWebPage").execute({url:e,element:t});a.app.command("Alert").execute(a.getResource("language-feature-details-attachment-not-available-offline"))}),!1):this.app.followNavigationLink({url:i.url.get(),element:t})},i.prototype.handleDeleteClick=function(e,t,i){var a=this,r=this.app.getResource(this.libraryId,"language-feature-attachments-delete-prompt-title"),n=this.app.getResource(this.libraryId,"language-feature-attachments-delete-prompt-text");this.app.command("Confirm").execute(n,r,function(e){if(e){var t={layer:a.viewModel.currentFeature.get().layer.mapService.serviceLayer,feature:a.viewModel.currentFeature.get().esriFeature.get(),attachmentIds:[i.attachmentId],callback:function(e){if(e[0]&&e[0].error){var t=a.getResource("language-feature-attachments-delete-prompt-title"),i=e[0].error.message||a.getResource("language-feature-attachments-delete-prompt-error-unknown");a.app.command("Alert").execute(i,t)}else a.viewModel.currentFeature.get().resetAttachmentInfos(),a.viewModel.handleCurrentFeatureChanged(a.viewModel.currentFeature.get())},errback:function(e){var t=a.getResource("language-feature-attachments-delete-prompt-title");a.app.command("Alert").execute(e.message||e,t)}};a.app.command("DeleteAttachments").execute(t)}})},i}(a.ViewBase);i.AttachmentsView=r})},"Mapping/modules/FeatureDetails/FeatureDetailsProviders/AttachmentsViewModel":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();define(["require","exports","geocortex/infrastructure/featureDetails/FeatureProviderBase","geocortex/framework/observables","geocortex/essentials/FeatureLayerService","geocortex/infrastructure/FormatUtils"],function(t,i,a,r,n,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=function(t){function i(e,i){var a=t.call(this,e,i)||this;return a.hasAttachments=new r.Observable(!1),a.attachmentInfos=new r.ObservableCollection,a.isAttachmentInfosInitialized=new r.Observable(!1),a.noAttachments=new r.Observable(!1),a.isOffline=new r.Observable(!1),a.canEditAttachments=new r.Observable(!1),a.bindToken=null,a.app.event("FeatureAttachmentAddedEvent").subscribe(a,a.handleCurrentFeatureChanged),a}return e(i,t),i.prototype.handleCurrentFeatureChanged=function(e){var t=this;if(this.updateProviderState(!1),this.hasAttachments.set(!1),this.noAttachments.set(!1),this.isOffline.set(!1),this.isAttachmentInfosInitialized.set(!1),this.canEditAttachments.set(!1),this._setAttachmentInfos(null),!e)throw new Error("Feature cannot be null for the attachment infos view model");if(this.hasAttachments.set(e.hasAttachments.get()),this.hasAttachments.get()){var i=e.layer&&e.layer.mapService;i&&i instanceof n.FeatureLayerService&&this.canEditAttachments.set(i.canAddAttachments&&i.canEdit),e.attachmentInfosInitialized.get()?(this._setAttachmentInfos(e.attachmentInfos),0===this.attachmentInfos.length()?(this.isOffline.set(this.app.isOffline.get()),this.noAttachments.set(!this.app.isOffline.get())):this.updateProviderState(!0),this.isAttachmentInfosInitialized.set(!0)):this.bindToken=e.attachmentInfosInitialized.bind(this,function(i){i&&(t.isAttachmentInfosInitialized.set(!0),t._setAttachmentInfos(e.attachmentInfos),0===t.attachmentInfos.length()?(t.isOffline.set(t.app.isOffline.get()),t.noAttachments.set(!t.app.isOffline.get())):t.updateProviderState(!0),e.attachmentInfosInitialized.unbind(t.bindToken))}),e.attachmentInfos.get()}},i.prototype._setAttachmentInfos=function(e){if(this.attachmentInfos.clear(),e)for(var t=e.getLength(),i=0;i<t;i++){var a=e.getAt(i),r=this.app.nativeManager.isNative()?null:"_blank";this.attachmentInfos.addItem({name:a.name,url:a.url,canEditAttachments:this.canEditAttachments.get(),size:s.formatBytes(a.size.get()),attachmentId:a.id.get(),target:r})}},i}(a.FeatureProviderBase);i.AttachmentsViewModel=o})},"Mapping/modules/FeatureDetails/FeatureDetailsProviders/AttributesView":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();define(["require","exports","geocortex/framework/ui/ViewBase"],function(t,i,a){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return e(i,t),i.prototype.handleClickAttributeLink=function(e,t,i){return this.app.followNavigationLink({url:i.value.get(),element:t})},i}(a.ViewBase);i.AttributesView=r})},"Mapping/modules/FeatureDetails/FeatureDetailsProviders/AttributesViewModel":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();define(["require","exports","geocortex/infrastructure/featureDetails/FeatureProviderBase","geocortex/framework/observables","geocortex/essentials/Field","geocortex/framework/utils/utils"],function(t,i,a,r,n,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=function(t){function i(e,i){var a=t.call(this,e,i)||this;return a.attributeTypes={},a.MAX_COLUMNS=3,a.COLUMN_THRESHOLD=5,a._attributesChangedSubscriptionToken=null,a.attributes=new r.ObservableCollection([]),a.multiColumnAttributeContainer=new r.ObservableCollection([]),a}return e(i,t),i.prototype.initialize=function(e){t.prototype.initialize.call(this,e),e&&(this.MAX_COLUMNS=isNaN(parseInt(e.maxColumns,10))?this.MAX_COLUMNS:parseInt(e.maxColumns,10),this.COLUMN_THRESHOLD=isNaN(parseInt(e.columnThreshold,10))?this.COLUMN_THRESHOLD:parseInt(e.columnThreshold,10))},i.prototype.handleCurrentFeatureChanged=function(e){if(e){this._getAttributeTypes(this.currentFeature.get());var t=e.getAttributes();this._attributesChangedSubscriptionToken&&this._prevFeatureLinkedAttributes&&this._prevFeatureLinkedAttributes.unbind(this._attributesChangedSubscriptionToken),this._attributesChangedSubscriptionToken=this._prevFeatureLinkedAttributes=null,this._prevFeatureLinkedAttributes=e.linkedAttributes,this._attributesChangedSubscriptionToken=e.linkedAttributes.bind(this,this._handleAttributesChanged),this.processAttributes(t),this._setAttributes(t)}else this._setAttributes(null)},i.prototype._getAttributeTypes=function(e){if(this.attributeTypes={},e.layer&&e.layer.fields)for(var t=0;t<e.layer.fields.length;t++){var i=e.layer.fields[t];if(e.layer instanceof esri.layers.FeatureLayer){var a=i;i.dataType=n.Field.convertFromEsriType(a.type)}this.attributeTypes[i.name]=i.dataType}},i.prototype._handleAttributesChanged=function(){var e=this.currentFeature.get().getAttributes();this.processAttributes(e),this._setAttributes(e)},i.prototype._setAttributes=function(e){this.attributes.clear(),e&&this.attributes.set(e),this._populateMultiColumnAttributeContainer(),this.updateProviderState(!!this.attributes.length())},i.prototype._populateMultiColumnAttributeContainer=function(){this.multiColumnAttributeContainer.clear();var e=dojo.filter(this.attributes.get(),function(e){return e.visible.get()}),t=e.length>this.COLUMN_THRESHOLD?Math.ceil(e.length/this.COLUMN_THRESHOLD):1;t=t>this.MAX_COLUMNS?this.MAX_COLUMNS:t;for(var i=Math.ceil(e.length/t),a=0;a<t;a++){var n=new r.ObservableCollection(e.slice(a*i,(a+1)*i));this.multiColumnAttributeContainer.addItem(n)}},i.prototype.processAttributes=function(e){for(var t=0;t<e.length;t++){e[t].name.get();var i=e[t].value.get();e[t].displayAsUrl=s.isUrl(i)}},i}(a.FeatureProviderBase);i.AttributesViewModel=o})},"Mapping/modules/FeatureDetails/FeatureDetailsProviders/DataLinksView":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();define(["require","exports","geocortex/framework/ui/ViewBase","geocortex/infrastructure/ui/components/Table/TableViewModel"],function(t,i,a,r){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return e(i,t),i.prototype.attach=function(e){this.masterViewModel=e.masterViewModel,t.prototype.attach.call(this,e)},i.prototype.handleViewClick=function(e,t,i){for(var a=0;a<this.viewModel.dataLinks.length();a++){var r=this.viewModel.dataLinks.getAt(a);if(r===i){this.masterViewModel.currentDataLink.set(r);break}}this.masterViewModel.activateDataLinkDetailsView()},i.prototype.resolveWidget=function(e,i,a){var n=this;switch(t.prototype.resolveWidget.call(this,e,i),e){case"DataLinksTableViewWidget":if(this.tableView=this.app.viewManager.createView({typeName:"geocortex.essentialsHtmlViewer.mapping.infrastructure.ui.components.Table.TableView",markupResource:"Mapping/infrastructure/ui/components/Table/TableView.html",libraryId:"Mapping.Infrastructure",isVisible:!0}),this.tableView){var s=new r.TableViewModel(this.app,this.libraryId);s.recordClickEvent=function(e){return n.app.event("DataLinkTableItemClickedEvent").publish(e)},s.recordLongPressEvent=function(e){return n.app.event("DataLinkTableItemPressedEvent").publish(e)},s.syncRows(i.results),s.syncColumns(i.columnHeaders),this.tableView.attach(s)}return this.tableView;default:return null}},i.prototype.activated=function(){t.prototype.activated.call(this),this.tableView&&!this.tableView.isActive&&this.tableView.activated()},i.prototype.deactivated=function(){t.prototype.deactivated.call(this),this.tableView&&this.tableView.deactivated()},i.prototype.destroy=function(){this.tableView&&this.tableView.destroy(),t.prototype.destroy.call(this)},i}(a.ViewBase);i.DataLinksView=n})},"Mapping/modules/FeatureDetails/FeatureDetailsProviders/DataLinksViewModel":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();define(["require","exports","geocortex/framework/observables","geocortex/infrastructure/featureDetails/FeatureProviderBase","geocortex/framework/utils/utils","geocortex/framework-ui/LazyObservable","geocortex/infrastructure/FormatUtils","geocortex/essentials/Field"],function(t,i,a,r,n,s,o,l){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var u=function(t){function i(e,i){var r=t.call(this,e,i)||this;return r.hasDataLinks=new a.Observable(!1),r.dataLinksList=new a.ObservableCollection([]),r.currentDataLink=new a.Observable(null),r.targetDataLinkDetailsRegion=null,r.DEFAULT_VIEW_ID="FeatureDataLinksProviderView",r.DEFAULT_PAGED=!0,r.DEFAULT_PAGE_SIZE=50,r.DATALINK_TABLE_ITEM_CLICKED_EVENT="DataLinkTableItemClickedEvent",r.DATALINK_TABLE_ITEM_PRESSED_EVENT="DataLinkTableItemPressedEvent",r._featureDataLinkBindingToken=null,r._datalinkViews=[],r._addedDataLinks=[],r._dataLinkListBindingTokens=[],r._config=null,r._viewModeRegionConfig=null,r._onViewsCreated=null,r}return e(i,t),i.prototype.initialize=function(e){t.prototype.initialize.call(this,e),e&&(e.dataLinkView||e.dataLinkDetailsView)&&(this.targetDataLinkDetailsRegion=e.dataLinkView||e.dataLinkDetailsView),this.hasDataLinks.bind(this,this.updateProviderState)},i.prototype.handleCurrentFeatureChanged=function(e){this.hasDataLinks.set(!1),this._destroyAttachedViews(),this.dataLinksList.clear(),this._featureDataLinkBindingToken&&this._prevFeatureDataLinkingResults&&this._prevFeatureDataLinkingResults.unbind(this._featureDataLinkBindingToken),this._prevFeatureDataLinkingResults=this._featureDataLinkBindingToken=null,this._prevFeatureDataLinkingResults=e.dataLinkingResults,this._featureDataLinkBindingToken=e.dataLinkingResults.bind(this,this.handleCollectionChanged),this._handleDataLinks(e.dataLinkingResults.get()),this._createAttachedViews()},i.prototype.activateDataLinkDetailsView=function(){if(this.targetDataLinkDetailsRegion){if(!this.currentDataLink.get())throw new Error("Cannot display data link details. Current datalink not set.");this.dataLinkView||(this.dataLinkView=this.app.viewManager.createView({markupResource:"Mapping/modules/FeatureDetails/FeatureDetailsProviders/DataLinkView.html",typeName:"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.DataLinkView",iconUri:"Resources/Images/Icons/Toolbar/file-multi-24.png",regionName:this.targetDataLinkDetailsRegion,isVisible:!1,libraryId:this.libraryId}),this.dataLinkView.attach(this)),this.dataLinkView.title.set(this.currentDataLink.get().displayName),this.app.viewManager.activateView(this.dataLinkView),this.app.command("FocusOnFirstInputInView").execute(this.dataLinkView)}},i.prototype.createAttachedViews=function(e,t,i){this._config=e,this._viewModeRegionConfig=t,this._onViewsCreated=i},i.prototype._createAttachedViews=function(e,i,a){var r=this;if(e=e||this._config,i=i||this._viewModeRegionConfig,a=a||this._onViewsCreated,e){var n=function(){r.dataLinksList.get().forEach(function(n){if(-1===r._addedDataLinks.indexOf(n.displayName)){var s=dojo.clone(e);s.title=n.displayName,s.viewId=r._generateDataLinksViewIdFromConfigViewId(s.viewId,s.title),t.prototype.createAttachedViews.call(r,s,i,function(e){r._datalinkViews=r._datalinkViews.concat(e),a&&a(e)},n),r._addedDataLinks.push(n.displayName)}})};n(),this._dataLinkListBindingTokens.push(this.dataLinksList.bind(this,function(){return n()}))}},i.prototype.handleCollectionChanged=function(e){if("append"===e.type){var t=e.sender.value.slice(e.rangeStart,e.rangeStart+1);this._handleDataLinks(t)}},i.prototype._generateDataLinksViewIdFromConfigViewId=function(e,t){var i=n.alphaNumericToken();return t=t?t+"-"+i:i,"{0} datalink-{1}".format(e||this.DEFAULT_VIEW_ID,t)},i.prototype._destroyAttachedViews=function(){var e=this;this._datalinkViews.forEach(function(t){e.app.viewManager.destroyView(t),delete t.viewModel}),this._dataLinkListBindingTokens.forEach(function(t){return e.dataLinksList.unbind(t)}),this._datalinkViews=[],this._addedDataLinks=[],this._dataLinkListBindingTokens=[]},i.prototype._handleDataLinks=function(e){for(var t=this,i=this,r=0,n=e;r<n.length;r++)!function(e){if(e.dataLink&&e.dataLink.get()&&!e.dataLink.get().isOneToOne){var r=e.table.get(),n=new a.ObservableCollection(r.rows.map(function(e){return{displayName:e.row[0],attributes:new a.ObservableCollection(t.toDict(r.columns,e.row))}})),s=new a.ObservableCollection(r.rows.map(function(e){return{attributes:new a.ObservableCollection(t._buildTableColumns(r.columns,e.row)),selected:e.selected,token:e.token}})),o=new a.ObservableCollection(i._buildTableColumnHeaders(r.columns,s.getAt(0))),l=new a.Observable(i.providerEnabled.get());l.sync(i.providerEnabled),i.dataLinksList.addItem({displayName:e.dataLink.get().displayName,dataLinks:n,results:s,columnHeaders:o,providerEnabled:l,masterViewModel:i}),i.hasDataLinks.get()||i.hasDataLinks.set(!0)}}(n[r])},i.prototype.toDict=function(e,t){for(var i=[],a=0;a<e.length;a++)i.push({name:e[a],value:t[a],presentableValue:o.format(t[a]),displayAsUrl:n.isUrl(t[a])});return i},i.prototype._buildTableColumns=function(e,t){return e.map(function(i,r){return{visible:new a.Observable(!0),value:new a.Observable(t[r]),name:new a.Observable(r.toString()),displayName:new a.Observable(e[r]),type:new a.Observable(l.EssentialsFieldTypes.essentialsFieldTypeString),presentableValue:function(e){return new s.LazyObservable(null,function(){return o.format(t[e])})}(r),displayAsUrl:n.isUrl(t[r])}})},i.prototype._buildTableColumnHeaders=function(e,t){return e.map(function(e,i){var r=t.attributes.getAt(i);return{visible:new a.Observable(r.visible.get()),value:new a.Observable,name:new a.Observable(i.toString()),displayName:new a.Observable(e),type:new a.Observable(new a.Observable(r.value.get()instanceof Date?l.EssentialsFieldTypes.essentialsFieldTypeDate:l.EssentialsFieldTypes.essentialsFieldTypeString)),presentableValue:new a.Observable(""),displayAsUrl:!1}})},i}(r.FeatureProviderBase);i.DataLinksViewModel=u})},"Mapping/modules/FeatureDetails/FeatureDetailsProviders/DataLinkView":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();define(["require","exports","geocortex/framework/ui/ViewBase"],function(t,i,a){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return e(i,t),i.prototype.handleClickDataLink=function(e,t,i){return this.app.followNavigationLink({url:i.value.get(),element:t})},i}(a.ViewBase);i.DataLinkView=r})},"Mapping/modules/FeatureDetails/FeatureDetailsProviders/DescriptionView":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();define(["require","exports","geocortex/framework/ui/ViewBase","geocortex/infrastructure/FeatureDescriptionPresenterView"],function(t,i,a,r){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e._featureChangedToken=null,e._featureEditedToken=null,e._relatedRecordEditedToken=null,e._presenterView=null,e}return e(i,t),i.prototype.attach=function(e){t.prototype.attach.call(this,e),this._featureChangedToken&&(this.app.event("FeatureChangedEvent").unsubscribe(this._featureChangedToken),this._featureChangedToken=null),this._featureEditedToken&&(this.app.event("FeatureEditedEvent").unsubscribe(this._featureEditedToken),this._featureEditedToken=null),this._featureChangedToken=this.app.event("FeatureChangedEvent").subscribe(this,this._handleFeatureChangedEvent),this._featureEditedToken=this.app.event("FeatureEditedEvent").subscribe(this,this._updateDescription),this._relatedRecordEditedToken=this.app.event("RelatedRecordEditedEvent").subscribe(this,this._handleRelatedRecordsEdited)},i.prototype.destroy=function(){t.prototype.destroy.call(this),this._featureChangedToken&&(this.app.event("FeatureChangedEvent").unsubscribe(this._featureChangedToken),this._featureChangedToken=null),this._featureEditedToken&&(this.app.event("FeatureEditedEvent").unsubscribe(this._featureEditedToken),this._featureEditedToken=null),this._relatedRecordEditedToken&&(this.app.event("RelatedRecordEditedEvent").unsubscribe(this._relatedRecordEditedToken),this._relatedRecordEditedToken=null),this._presenterView&&(this._presenterView.destroy(),this._presenterView=null)},i.prototype.resolveWidget=function(e,i,a){if(i&&"GetDescription"===e){var n=new r.FeatureDescriptionPresenterView(this.app,this.libraryId);return n.contentField=this.viewModel.showLongDescription?"longDescription":"description",n.root=dojo.create("div"),n.root.className="feature-description",n.attach(i),this._presenterView=n,n}return t.prototype.resolveWidget.call(this,e,i,a)},i.prototype._handleFeatureChangedEvent=function(e){this._presenterView&&e&&this.viewModel.currentFeature.get()&&this.viewModel.currentFeature.get().token===e.token&&this._updateDescription()},i.prototype._handleRelatedRecordsEdited=function(e){var t=this.viewModel.currentFeature.get(),i=t&&t.esriFeature.get(),a=i&&i.getLayer();t&&a&&i.attributes[a.objectIdField]===e.attributes[a.objectIdField]&&(dojo.mixin(i.attributes,e.attributes),t.esriFeature.pulse())},i.prototype._updateDescription=function(){this._presenterView.reattach(this.viewModel.currentFeature.get())},i}(a.ViewBase);i.DescriptionView=n})},"Mapping/modules/FeatureDetails/FeatureDetailsProviders/DescriptionViewModel":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();define(["require","exports","geocortex/infrastructure/featureDetails/FeatureProviderBase"],function(t,i,a){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.showLongDescription=!1,e}return e(i,t),i.prototype.initialize=function(e){t.prototype.initialize.call(this,e),e&&e.longDescription&&(this.showLongDescription=!0)},i.prototype.handleCurrentFeatureChanged=function(e){if(e.longDescription||e.description){var t=this.showLongDescription?e.longDescription.get():e.description.get();this.updateProviderState(!!t)}else this.app.trace.warning("Input must be a Feature")},i}(a.FeatureProviderBase);i.DescriptionViewModel=r})},"Mapping/modules/FeatureDetails/FeatureDetailsProviders/FeatureActionsView":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();define(["require","exports","geocortex/infrastructure/menus/MenuView"],function(t,i,a){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return e(i,t),i.prototype.attach=function(e){var i=this;t.prototype.attach.call(this,e),this.viewModel.menuContext.sync(e.currentFeature),this.viewModel.visibleMenuItems.bind(this,function(t){var a=i.viewModel.visibleMenuItems.length();if("clear"===t.type)a=0;else if("remove"===t.type){var r=t.sender.get().slice(0);r.splice(t.rangeStart,t.rangeEnd-t.rangeStart+1),a=r.length}e.updateProviderState(!!a)})},i}(a.MenuView);i.FeatureActionsView=r})},"Mapping/modules/FeatureDetails/FeatureDetailsProviders/FeatureActionsViewModel":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();define(["require","exports","geocortex/infrastructure/featureDetails/FeatureProviderBase"],function(t,i,a){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return e(i,t),i}(a.FeatureProviderBase);i.FeatureActionsViewModel=r})},"Mapping/modules/FeatureDetails/FeatureDetailsProviders/Hyperlink":function(){define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){return function(e,t){if(this.text=null,this.uri=null,this.iconUri=null,this.target=null,this.toolTip=null,this.isBroken=!1,t&&(this.currentFeature=t,e)){if(e.text)this.text=this.currentFeature.formatTemplateString(e.text),this.text=String.unescapeHtml(this.text);else{if(!e.uri)return;this.text=this.currentFeature.formatTemplateString(e.uri),this.text=String.unescapeHtml(this.text)}e.uri&&(this.uri=this.currentFeature.formatTemplateString(e.uri),this.uri=String.unescapeHtml(this.uri)),e.iconUri&&(this.iconUri=e.iconUri),e.target&&(this.target=e.target),e.toolTip&&(this.toolTip=this.currentFeature.formatTemplateString(e.toolTip),this.toolTip=String.unescapeHtml(this.toolTip))}}}();t.Hyperlink=i})},"Mapping/modules/FeatureDetails/FeatureDetailsProviders/HyperlinksView":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();define(["require","exports","geocortex/framework/ui/ViewBase"],function(t,i,a){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return e(i,t),i.prototype.handleClickHyperlink=function(e,t,i){return!i.isBroken&&this.app.followNavigationLink({url:i.uri,element:t})},i}(a.ViewBase);i.HyperlinksView=r})},"Mapping/modules/FeatureDetails/FeatureDetailsProviders/HyperlinksViewModel":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();define(["require","exports","geocortex/infrastructure/featureDetails/FeatureProviderBase","geocortex/framework/observables","geocortex/config"],function(t,i,a,r,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=function(t){function i(e,i){var a=t.call(this,e,i)||this;return a._numHyperlinksChecked=0,a._numHyperlinksTotal=0,a.hyperlinks=new r.ObservableCollection,a}return e(i,t),i.prototype.handleCurrentFeatureChanged=function(e){if(this.hyperlinks.set(null),e&&e.hyperlinks){var t=dojo.getObject("geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.Hyperlink");if(t){var i=[];this._numHyperlinksChecked=0,this._numHyperlinksTotal=e.hyperlinks.getLength(),0!==e.hyperlinks.getLength()&&this.updateProviderState(!0);for(var a=0;a<this._numHyperlinksTotal;a++){var r=new t(e.hyperlinks.getAt(a),e);i.push(r),e.layer&&"ShowAll"!==e.layer.showFeatureHyperlinks&&this._testHyperlink(r,i,"HEAD")}e.layer&&"ShowAll"===e.layer.showFeatureHyperlinks&&this._showHyperlinks(i)}else this.hyperlinks.addItems(e.hyperlinks.get())}},i.prototype._testHyperlink=function(e,t,i){var a=this,r=function(){++a._numHyperlinksChecked===a._numHyperlinksTotal&&a._showHyperlinks(t)};if(!e.uri)return e.isBroken=!0,void r();if(e.uri&&e.uri.length>n.config.io.postLength-500)return this.app.trace.warning("Unable to test hyperlink with URI '{0}...'. The URI was too long.".format(e.uri.substr(0,100))),void r();var s={type:i,cache:!0,url:e.uri};"GET"===i&&(s.headers={"If-Match":"LatitudeGeographics"}),s.success=function(e,t,i){r()},s.error=function(n,s,o){var l=n.status;"HEAD"!==i||405!==l&&0!==l?(e.isBroken=l>=400&&412!==l,r()):a._testHyperlink(e,t,"GET")},$.ajax(s)},i.prototype._showHyperlinks=function(e){for(var t=this.currentFeature.get(),i=t&&t.layer?t.layer.showFeatureHyperlinks:null,a=0;a<e.length;a++){var r=e[a];if(null!=r.uri&&""!==r.uri){if(i&&"HideBrokenLinks"===i&&r.isBroken)continue;this.hyperlinks.addItem(r)}}0===this.hyperlinks.getLength()&&this.updateProviderState(!1)},i}(a.FeatureProviderBase);i.HyperlinksViewModel=s})},"Mapping/modules/FeatureDetails/FeatureDetailsProviders/RelatedFeaturesView":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();define(["require","exports","geocortex/framework/ui/ViewBase","geocortex/infrastructure/ui/components/Table/TableViewModel","geocortex/framework/utils/utils"],function(t,i,a,r,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return e(i,t),i.prototype.attach=function(e){this.masterViewModel=e.masterViewModel,t.prototype.attach.call(this,e),this.masterViewModel._viewContainerViewClosedEventBindingToken||(this.masterViewModel._viewContainerViewClosedEventBindingToken=this.app.event("ViewContainerViewClosedEvent").subscribe(this,this._checkIfEventIsRelevant))},i.prototype.activated=function(){t.prototype.activated.call(this),this.tableView&&!this.tableView.isActive&&this.tableView.activated()},i.prototype.deactivated=function(){t.prototype.deactivated.call(this),this.tableView&&this.tableView.deactivated()},i.prototype.destroy=function(){this.tableView&&this.tableView.destroy(),this.masterViewModel._viewContainerViewClosedEventBindingToken&&0===this.masterViewModel.relatedFeatureViews.length&&(this.app.event("ViewContainerViewClosedEvent").unsubscribe(this.masterViewModel._viewContainerViewClosedEventBindingToken),this.masterViewModel._viewContainerViewClosedEventBindingToken=null),t.prototype.destroy.call(this)},i.prototype.resolveWidget=function(e,i,a){var n=this;switch(t.prototype.resolveWidget.call(this,e,i),e){case"RelatedFeaturesTableViewWidget":if(this.tableView=this.app.viewManager.createView({typeName:"geocortex.essentialsHtmlViewer.mapping.infrastructure.ui.components.Table.TableView",markupResource:"Mapping/infrastructure/ui/components/Table/TableView.html",libraryId:"Mapping.Infrastructure",isVisible:!0}),this.tableView){var s=new r.TableViewModel(this.app,this.libraryId);s.recordClickEvent=function(e){return n.app.event("RelatedFeatureTableItemClickedEvent").publish(e)},s.recordLongPressEvent=function(e){return n.app.event("RelatedFeatureTableItemPressedEvent").publish(e)},s.syncRows(i.results),s.syncColumns(i.columnHeaders),this.tableView.attach(s)}return this.tableView;default:return null}},i.prototype.handleViewClick=function(e,t,i){if(i&&i.attributes&&i.attributes.getLength()>0)for(var a=i.attributes.get(),r=0;r<a.length;r++){var s=a[r].value.get();a[r].displayAsUrl=n.isUrl(s)}this.isBusy.set(!0),this.masterViewModel.activateRelatedFeatureView(i)},i.prototype.handleClickAddRelatedRecord=function(e,t,i){var a=this;if(!i)return!1;if(i.editable&&!i.editable.get())return!1;var r=this.masterViewModel;r&&r.generateRelatedLayerObject(i,function(e){a.app.command("StartEditingNewRelatedRecord").execute(e,!0)})},i.prototype._checkIfEventIsRelevant=function(e){(e.backButtonClicked||e.xButtonClicked)&&this.masterViewModel.showParentView()},i}(a.ViewBase);i.RelatedFeaturesView=s})},"Mapping/modules/FeatureDetails/FeatureDetailsProviders/RelatedFeaturesViewModel":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();define(["require","exports","./RelatedFeaturesViewModelBase","geocortex/framework/observables","geocortex/essentials/Layer","geocortex/infrastructure/TaskUtils","geocortex/essentials/utilities/LayerUtilities","geocortex/infrastructure/FeatureSet"],function(t,i,a,r,n,s,o,l){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var u=function(t){function i(e,i){var a=t.call(this,e,i)||this;return a._canEditOffline=!1,a.app.event("RelatedRecordCreatedEvent").subscribe(a,a._relatedRecordCreated),a.app.event("RelatedRecordEditedEvent").subscribe(a,a._relatedRecordEdited),a}return e(i,t),i.prototype.initialize=function(e){var i=this;t.prototype.initialize.call(this,e),this.app.nativeManager.hasNativeCapability("editing").then(function(e){i._canEditOffline=e})},i.prototype.handleCurrentFeatureChanged=function(e){var t=this;if(!e)throw new Error("Feature cannot be null for the related features view model");this._destroyAttachedViews(),this.hasRelationships.set(!1),this.relationList.clear(),this._allRelatedFeatureInfo=[],this.relatedLayers=new r.ObservableCollection([]),this._relatedLayerPromises&&(this._relatedLayerPromises.cancel(),this._relatedLayerPromises=null);var i=[],a=this.currentFeature.get().layer||this.currentFeature.get().featureLayer;if(a&&a.relationships){for(var s=0;s<a.relationships.length;s++){var o=a.relationships[s];a instanceof n.Layer&&i.push(new Promise(function(e,t){return a.getRelatedFeatureLayer(o.id,e,t)}))}this._relatedLayerPromises=Promise.all(i),this._relatedLayerPromises.then(function(i){if(t._relatedLayerPromises=null,t.relatedLayers.addItems(i),e.hasVisibleRelationships.get()&&a&&a.relationships&&t.app.site.getFeatureServices()){t.hasRelationships.set(!0);for(var n=0;n<a.relationships.length;n++)if(a.relationships[n].visible){!function(){var e=new r.Observable(t.providerEnabled.get()),i=new r.ObservableCollection([]);e.sync(t.providerEnabled);var s={displayName:new r.Observable(a.relationships[n].displayName||a.relationships[n].name),id:new r.Observable(a.relationships[n].id),relatedTableId:new r.Observable(a.relationships[n].relatedTableId),visible:new r.Observable(a.relationships[n].visible),relatedEsriFeatureInfo:new r.ObservableCollection([]),relatedGcxFeatures:i,hasRetrievedData:new r.Observable(!1),noRelatedFeatures:new r.Observable(!1),canAdd:new r.Observable(!0),validCardinality:new r.Observable(!0),errorFetchingRelatedFeatures:new r.Observable(!1),results:i,columnHeaders:new r.ObservableCollection([]),providerEnabled:e,masterViewModel:t};s.relatedEsriFeatureInfo.bind(t,function(e){t._generateGCXFeaturesFromRelatedFeatureInfos(e.sender.getRange(e.rangeStart,e.rangeEnd))}),t.relationList.addItem(s)}()}t._fetchRelatedFeatures()}t._createAttachedViews(),t._updateProviderState(),null==t.parentFeature.get()&&t.parentFeature.set(t.currentFeature.get())})}},i.prototype._generateGCXFeaturesFromRelatedFeatureInfos=function(e){for(var t=0;t<e.length;t++){var i=e[t];this._generateRelatedGCXFeature(i)}},i.prototype._generateRelatedGCXFeature=function(e){var t={featureInfo:e,esriFeature:null,gcxFeature:null,layer:null},i={};e.attributes.get().forEach(function(e){var t=e.name.get(),a=e.value.get();i[t]=a});var a=new esri.Graphic;a.setAttributes(i);var r=null;(this.currentFeature.get().layer||this.currentFeature.get().featureLayer).relationships.forEach(function(t){(t.name?t.name:t.displayName)==e.relationName.get()&&(r=t.relatedTableId)});for(var n=null,s=0;s<this.relatedLayers.getLength();s++){var o=this.relatedLayers.getAt(s);o.layerId===r&&(n=o)}if(n)null!=r&&(n.add(a),t.layer=n,t.esriFeature=a,this._checkRelatedFeature(t));else{for(var l=new RegExp("/[^/]*.$"),u=e.featureUrl.replace(l,""),d=this.app.site.getFeatureServices(),s=0;s<d.length;s++){var c=d[s];u==this._getProperMapServiceUrlForComparison(c,u)&&(n=c.serviceLayer)}t.layer=n,t.esriFeature=a,this._checkRelatedFeature(t)}},i.prototype.generateRelatedLayerObject=function(e,t){var i=this,a=null,r=null;try{this._getFeatureLayerForCurrentFeature(e,function(n){n.relationships.forEach(function(t){t.id==e.id.get()&&t.relatedTableId==e.relatedTableId.get()&&(r=t)}),a={id:e.id.get(),text:"New "+e.displayName.get(),relatedFeature:i.currentFeature.get().esriFeature.get(),essentialsRelatedFeature:i.currentFeature.get(),feature:null,editable:!0,relationship:r},t(a)})}catch(e){this.app.trace.error("Error in generating related layer object for creation: "+e)}},i.prototype._getFeatureLayerForCurrentFeature=function(e,t){var i=this.currentFeature.get().esriFeature.get().getLayer();if(i)t(i);else{if(!i&&"Table"!=this.currentFeature.get().layer.type)return this.app.command("GetFeatureDetailsProviders").execute(this.currentFeature.get()),(i=this.currentFeature.get().esriFeature.get().getLayer())||(i=this.currentFeature.get().layer.mapService.layers[0]),void t(i);if(!i)for(var a=this.app.site.getFeatureServices(),r=0;r<a.length;r++)for(var n=a[r],s=0;s<n.layers.length;s++)n.layers[s].id==e.relatedTableId.get()&&n.getRelatedFeatureLayer(e.id.get(),function(e){t(i=e)},function(e){})}},i.prototype._relatedRecordCreated=function(e){this.handleCurrentFeatureChanged(this.currentFeature.get())},i.prototype._relatedRecordEdited=function(e){e.attributes.Date&&(e.attributes.Date=this._formatDate(e.attributes.Date));var t=this.currentFeature.get().esriFeature.get().attributes;for(var i in t)e.attributes[i]&&(t[i]=e.attributes[i]);this.currentFeature.get().loadAttributes(!0)},i.prototype._fetchRelatedFeatures=function(){var e=this,t=this.currentFeature.get(),i=this.currentFeature.get().layer||this.currentFeature.get().featureLayer;if(t&&i&&this.relationList&&this.relationList.length()>0){var a=t.layer?t.layer:t.featureLayer;if(a){var r;for(r=0;r<this.relationList.length();r++){!function(i){var r=i.id.get(),n=new esri.tasks.RelationshipQuery;n.outFields=["*"],n.relationshipId=i.id.get(),null!=t.getPrimaryKeyValue()?n.objectIds=[t.getPrimaryKeyValue()]:n.objectIds=[t.esriFeature.get().attributes.OBJECTID],s.getQueryTask(a).executeRelationshipQuery(n).then(function(t){var n=!1;for(var s in t)if(t.hasOwnProperty(s)){n=!0;break}if(!n)return e._setCanAddNewFeature(a,i),i.noRelatedFeatures.set(!0),void i.hasRetrievedData.set(!0);var o=null,l=null;if(a.getRelatedFeatureLayer)o=a.getRelatedFeatureLayer(r);else for(var u=e.app.site.getFeatureServices(),d=a.url.match(/.*\//g),c=0;c<u.length;c++){var p=u[c],h=p.serviceLayer;if(p.serviceUrl.match(/.*\//g)[0]===d[0]){for(var g=0;g<h.relationships.length;g++){var b=h.relationships[g];if(b.relatedTableId==i.relatedTableId.get()){o=p.getRelatedFeatureLayer(b.id,null,null);break}}if(h.layerId==i.relatedTableId.get()){l=p.serviceLayer;break}if(o)break}}if(!o){for(var v in t)if(t.hasOwnProperty(v)){e._resolveDatalinksAfterFeaturesResolved(i,t[v].features.length);for(c=0;c<t[v].features.length;c++){var f=t[v].features[c],m=e._processRelatedFeature(l,f,i);i.relatedEsriFeatureInfo.addItem(m),l.hasAttachments&&setTimeout(function(e,t){return function(){t._loadAttachments(e)}}(m,e),100)}}return e._setCanAddNewFeature(a,i),void i.hasRetrievedData.set(!0)}o.then(function(r){if(r.message)return e._setCanAddNewFeature(a,i),i.noRelatedFeatures.set(!0),void i.hasRetrievedData.set(!0);for(var n in t)if(t.hasOwnProperty(n)){e._resolveDatalinksAfterFeaturesResolved(i,t[n].features.length);for(var s=0;s<t[n].features.length;s++){var o=t[n].features[s],l=e._processRelatedFeature(r,o,i);i.relatedEsriFeatureInfo.addItem(l),r.hasAttachments&&setTimeout(function(e,t){return function(){t._loadAttachments(e)}}(l,e),100)}}e._setCanAddNewFeature(a,i),i.hasRetrievedData.set(!0)},function(t){i.errorFetchingRelatedFeatures.set(!0),i.hasRetrievedData.set(!0),e.app.trace.error("Error getting related record for layer {0}: {1}.".format(a.displayName,t.message))})},function(t){i.errorFetchingRelatedFeatures.set(!0),i.hasRetrievedData.set(!0),e.app.trace.error("Error getting related record for layer {0}: {1}.".format(a.displayName,t.message))})}(this.relationList.getAt(r))}}}},i.prototype._setCanAddNewFeature=function(e,t){var i=null,a=null;if(t.canAdd.set(!0),t.validCardinality.set(!0),e instanceof n.Layer){(i=e).mapService;i.mapService.serviceLayer instanceof esri.layers.FeatureLayer&&(a=i.mapService.serviceLayer)}else e instanceof esri.layers.FeatureLayer&&(a=e);if(!a)return this.app.trace.debug("Attempted to see if related feature could be created but layer is not a Essentials Layer or Esri FeatureLayer."),t.canAdd.set(!1),void t.validCardinality.set(!1);if(a){var r=a.relationships,s=null;if(r&&r.length)for(d=0;d<r.length;d++){var l=r[d];l.id===t.id.get()&&(s=l)}if(s){"esriRelCardinalityOneToOne"===s.cardinality&&"esriRelRoleOrigin"===s.role&&t.relatedEsriFeatureInfo.get().length>0&&t.validCardinality.set(!1);for(var u=this.app.site.essentialsMap.mapServices,d=0;d<u.length;d++){var c=u[d].serviceLayer;if(c instanceof esri.layers.FeatureLayer){var p=c;p.layerId===t.relatedTableId.get()&&!1===p.getEditCapabilities().canCreate&&t.canAdd.set(!1)}}var h=o.LayerUtilities.decomposeFeatureLayerUrl(a.url).serviceUrl+"/"+t.relatedTableId.get();if(this.app.offlineManager.isOfflineMapActive.get()){var g=this.app.offlineManager.syncInfo.findLayerOrTable(h);this._canEditOffline&&g&&g.canEdit||t.canAdd.set(!1)}}}},i.prototype._resolveDatalinksAfterFeaturesResolved=function(e,t){if(e&&!(t<1)){var i=function(){var t=e.relatedGcxFeatures.getAt(0).layer;if(t){var i=new l.FeatureSet;i.features.set(e.relatedGcxFeatures.get()),i.layer=t,i.esriFeatureSet=new esri.tasks.FeatureSet,i.esriFeatureSet.features=e.relatedGcxFeatures.get().map(function(e){return e.esriFeature.get()}),i.resolveDataLinks()}};if(e.relatedGcxFeatures.length()===t)i();else var a=e.relatedGcxFeatures.bind(this,function(){e.relatedGcxFeatures.length()===t&&(e.relatedGcxFeatures.unbind(a),a=null,i())})}},i}(a.RelatedFeaturesViewModelBase);i.RelatedFeaturesViewModel=u})},"Mapping/modules/FeatureDetails/FeatureDetailsProviders/RelatedFeaturesViewModelBase":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();define(["require","exports","geocortex/framework/observables","geocortex/infrastructure/Feature","geocortex/framework-ui/PresentableCollection","geocortex/infrastructure/featureDetails/FeatureProviderBase","geocortex/framework/utils/utils","geocortex/essentials/utilities/TimeZoneUtils","geocortex/framework/utils/ArrayUtils","geocortex/infrastructure/FormatUtils","geocortex/infrastructure/gis/FieldInfo","geocortex/infrastructure/AttachmentInfo","geocortex/essentials/LayerType","geocortex/infrastructure/MapUtils","geocortex/infrastructure/TaskUtils","geocortex/essentials/RestHelperHTTPService"],function(t,i,a,r,n,s,o,l,u,d,c,p,h,g,b,v){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var f=function(t){function i(e,i){var r=t.call(this,e,i)||this;return r.DEFAULT_VIEW_ID="FeatureRelationsProviderView",r.DEFAULT_PAGED=!0,r.DEFAULT_PAGE_SIZE=50,r.REL_FEATURES_TABLE_ITEM_CLICKED_EVENT="RelatedFeatureTableItemClickedEvent",r.REL_FEATURES_TABLE_ITEM_PRESSED_EVENT="RelatedFeatureTableItemPressedEvent",r.hasRelationships=new a.Observable(!1),r.relationList=new a.ObservableCollection([]),r.parentFeature=new a.Observable(null),r.relatedLayers=new a.ObservableCollection([]),r.relatedFeatures=new a.ObservableCollection,r.relatedFeatureViews=[],r._viewContainerViewClosedEventBindingToken=null,r._config=null,r._viewModeRegionConfig=null,r._onViewsCreated=null,r._allRelatedFeatureInfo=[],r._addedRelatedFeatures=[],r._relatedFeatureListBindingTokens=[],r._relatedLayerPromises=null,r.app.command("ShowFeatureParentDetails").register(r,r.showParentView),r.app.command("ClearFeatureInformation").register(r,r._cleanup),r.app.event(r.REL_FEATURES_TABLE_ITEM_CLICKED_EVENT).subscribe(r,r.activateRelatedFeatureView),r}return e(i,t),i.prototype.createAttachedViews=function(e,t,i,a){this._config=e,this._viewModeRegionConfig=t,this._onViewsCreated=i},i.prototype.createAttachedViewsSuper=function(e,i,a,r){t.prototype.createAttachedViews.call(this,e,i,a,r)},i.prototype.activateRelatedFeatureView=function(e){var t;if(t=e instanceof r.Feature?this._getFeatureInfoFromFeature(e):e)for(var i=0;i<this._allRelatedFeatureInfo.length;i++){var a=this._allRelatedFeatureInfo[i].featureInfo;if(t.id.get()===a.id.get()){if(t.layer&&a.layer&&t.layer!==a.layer&&t.layer.layerId!==a.layer.layerId)continue;this._displayGeocortexFeatureDetails(this._allRelatedFeatureInfo[i].gcxFeature);break}}},i.prototype.showParentView=function(){this.relatedFeatures.getLength()<1?this.parentFeature.get()&&this.parentFeature.set(null):(this.relatedFeatures.removeItem(this.currentFeature.get()),0!=this.relatedFeatures.getLength()?this.app.command("ShowFeatureDetails").execute(this.relatedFeatures.getAt(this.relatedFeatures.length()-1)):this.app.command("ShowFeatureDetails").execute(this.parentFeature.get()))},i.prototype._generateRelatedFeaturesViewIdFromConfigViewId=function(e,t){var i=o.alphaNumericToken();return t=t?t+"-"+i:i,"{0} relatedfeatures-{1}".format(e||this.DEFAULT_VIEW_ID,t)},i.prototype._createConfiguredPresentableResultCollection=function(e){var t=new n.PresentableCollection(e);return t.pageSize.set(this.DEFAULT_PAGE_SIZE),this.DEFAULT_PAGED!=t.isPaginated.get()&&t.isPaginated.set(this.DEFAULT_PAGED),t.items.useThrottling=!0,t.sortingPredicate=null,t},i.prototype._createColumnHeaderItems=function(e){var t=[],i=e.get();if(i.length)for(var a=i[0].attributes.get(),r=0;r<a.length;r++)t.push(a[r]);return t},i.prototype._getFeatureInfoFromFeature=function(e){for(var t=0;t<this._allRelatedFeatureInfo.length;t++)if(this._allRelatedFeatureInfo[t].gcxFeature===e)return this._allRelatedFeatureInfo[t].featureInfo;return null},i.prototype._getFeatureFromFeatureInfo=function(e){for(var t=0;t<this._allRelatedFeatureInfo.length;t++)if(this._allRelatedFeatureInfo[t].featureInfo===e)return this._allRelatedFeatureInfo[t].gcxFeature;return null},i.prototype._displayGeocortexFeatureDetails=function(e){this._addFeatureToBucket(e),this.app.command("ShowFeatureDetails").execute(e)},i.prototype._addFeatureToBucket=function(e){e!=this.relatedFeatures.getAt(this.relatedFeatures.getLength())&&this.relatedFeatures.addItem(e)},i.prototype._destroyAttachedViews=function(){for(var e=this,t=this.relatedFeatureViews.length-1;t>=0;t--){var i=this.relatedFeatureViews[t];this.relatedFeatureViews.splice(t,1),this.app.viewManager.destroyView(i),delete i.viewModel}this._relatedFeatureListBindingTokens.forEach(function(t){return e.relationList.unbind(t)}),this._addedRelatedFeatures=[],this._relatedFeatureListBindingTokens=[]},i.prototype._getRelationshipObjectFromFeatureInfo=function(e){for(var t=null,i=0;i<this.relationList.length();i++){t=this.relationList.getAt(i);for(var a=0;a<t.relatedEsriFeatureInfo.length();a++)if(e===t.relatedEsriFeatureInfo.getAt(a))return t}return t},i.prototype._processGeneratedGCXFeature=function(e){this._allRelatedFeatureInfo.push(e);var t=this._getRelationshipObjectFromFeatureInfo(e.featureInfo);t&&(t.relatedGcxFeatures.addItem(e.gcxFeature),t.columnHeaders.length()||t.columnHeaders.addItems(this._createColumnHeaderItems(t.results)))},i.prototype._generateGeocortexFeature=function(e,t,i){var a=l.getTimeZoneFromLayer(t),n=null;this.parentFeature.get()&&this.parentFeature.get().layer&&(n=l.getDisplayTimeZoneFromMapService(this.parentFeature.get().layer.mapService),a||(a=l.getTimeZoneFromMapService(this.parentFeature.get().layer.mapService)));var s=new r.Feature({graphic:e,layer:t,featureLayer:i,timeZoneId:a,displayTimeZoneId:n});if(s.loadAttributes(!0),t)s.defaultNumberFormat=u.firstOrDefault([t.defaultNumberFormat,t.mapService.defaultNumberFormat],function(e){return!!e}),s.defaultDateFormat=u.firstOrDefault([t.defaultDateFormat,t.mapService.defaultDateFormat],function(e){return!!e});else if(this.parentFeature.get()){var o=this.parentFeature.get().layer;o&&(s.defaultNumberFormat=o.mapService.defaultNumberFormat,s.defaultDateFormat=o.mapService.defaultDateFormat)}if(i&&!t&&i.relationships.length>0){s.hasVisibleRelationships.set(!0);for(var d=0;d<i.relationships.length;d++)i.relationships[d].visible=!0}return s},i.prototype._makeAttributesObservable=function(e,t){var i=new a.ObservableCollection,r=this._getAttributeTypes(t);if(e)for(var n in e)if(e.hasOwnProperty(n)){var s=e[n];r[n]&&"esriFieldTypeDate"===r[n]&&s&&(s=this._formatDate(s)),i.addItem({name:new a.Observable(n),value:new a.Observable(s)})}return i},i.prototype._getAttributeTypes=function(e){var t={};return e&&e.fields&&dojo.forEach(e.fields,function(e){t[e.name]=e.type}),t},i.prototype._formatDate=function(e){return d.formatDate(d.parseDate(e))},i.prototype._cleanup=function(){this.parentFeature.set(null),this.relatedFeatures.clear()},i.prototype._processRelatedFeature=function(e,t,i){var r=new a.ObservableCollection,n=t.attributes[e.displayField];if(e.getField&&n){var s=c.FieldInfo.fromEsriField(e.getField(e.displayField),e);if(s.isCodedValueDomain()||s.hasSubtypeCodedValueDomains()){var o=t.attributes[e.typeIdField];n=s.resolveCodedDomainValue(n,o)}else"esriFieldTypeDate"===s.type&&(n=this._formatDate(n))}n||(n=t.attributes[e.objectIdField]);var l=e.objectIdField;return{id:new a.Observable(t.attributes[l]),displayName:new a.Observable(n),relationName:new a.Observable(i.displayName.get()),layer:e,featureUrl:e.url+"/"+t.attributes[e.objectIdField],attributes:this._makeAttributesObservable(t.attributes,e),geometry:new a.Observable(t.geometry),hasAttachments:new a.Observable(!1),attachmentInfos:r}},i.prototype._loadAttachments=function(e){var t=this,i=e.featureUrl+"/attachments",a=null,r={url:i+"?f=json&ts="+(new Date).getTime(),handleAs:"json"};if(e.layer instanceof esri.layers.FeatureLayer&&e.layer.url)a=e.layer.queryAttachmentInfos(parseInt(e.id.get()));else a=esri.request(r);a.then(function(t){if(t.length>0&&!t.attachmentInfos&&t instanceof Array){t.attachmentInfos=[];for(var a=0;a<t.length;a++)t.attachmentInfos[a]=t[a]}if(t&&t.attachmentInfos&&t.attachmentInfos.length>0){var r;for(r=0;r<t.attachmentInfos.length;r++){var n=t.attachmentInfos[r],s=new p.AttachmentInfo;s.id.set(n.id),s.contentType.set(n.contentType),s.size.set(n.size),s.name.set(n.name),s.url.set(i+"/"+n.id),e.attachmentInfos.addItem(s)}e.hasAttachments.set(!0)}},function(i){t.app.trace.error("Unable to retrieve attachment information for related feature '"+e.featureUrl+"': "+i.message)})},i.prototype._updateProviderState=function(){var e=this,t=!1;this.updateProviderState(t);var i=function(i){(i.canAdd.get()||!i.errorFetchingRelatedFeatures.get()&&i.relatedEsriFeatureInfo.length())&&(t=!0),e.updateProviderState(t)};if(this.relationList.length())for(var a=0;a<this.relationList.length();a++){!function(){if(!t){var r=e.relationList.getAt(a);r.hasRetrievedData.get()?i(r):r.hasRetrievedData.once(e,function(){return i(r)})}}()}},i.prototype._createAttachedViews=function(e,i,a){var r=this;if(e=e||this._config,a=a||this._onViewsCreated,i=i||this._viewModeRegionConfig,e){var n=function(){r.relationList.get().forEach(function(n){if(-1===r._addedRelatedFeatures.indexOf(n.displayName.get())){var s=dojo.clone(e);s.title=n.displayName.get(),s.viewId=r._generateRelatedFeaturesViewIdFromConfigViewId(s.viewId,n.displayName.get()),t.prototype.createAttachedViews.call(r,s,i,function(e){r.relatedFeatureViews=r.relatedFeatureViews.concat(e),a&&a(e)},n),r._addedRelatedFeatures.push(n.displayName.get())}})};n(),this._relatedFeatureListBindingTokens.push(this.relationList.bind(this,function(){return n()}))}},i.prototype._checkRelatedFeature=function(e){var t=this;if(e){var i=e.layer,a=e.esriFeature,r=null;if(i&&((r=this._findGeocortexLayer(i,this.app.site))||this.app.trace.debug("Could not find related layer in site. Related features will not be editable and will not contain spatial information.")),!a.geometry&&r&&r.mapService&&r.mapService.serviceLayer&&r.type!==h.LayerType.TABLE_LAYER){var n=null,s=r.mapService.serviceLayer;if(s instanceof esri.layers.FeatureLayer&&(n=g.findFeatureInMap(a,this.app.site,s)),n&&n!==a)e.gcxFeature=this._generateGeocortexFeature(n,r,s),this._processGeneratedGCXFeature(e);else{var o=new esri.tasks.Query;if(o.objectIds=[a.attributes[r.getObjectIdFieldName()]],o.outFields=["*"],o.returnGeometry=!0,s instanceof esri.layers.FeatureLayer)s.queryFeatures(o,function(i){i.features&&(a=i.features[0],e.gcxFeature=t._generateGeocortexFeature(a,r,s),t._processGeneratedGCXFeature(e))},function(e){t.app.trace.error("There was an error in retrieving the related feature: "+e)});else{r.mapService.serviceUrl.split("?");var l=b.getQueryTask(r);r.getFeatureLayer().then(function(i){l.execute(o,function(n){n.features&&(a=n.features[0],e.gcxFeature=t._generateGeocortexFeature(a,r,i),t._processGeneratedGCXFeature(e))},function(e){t.app.trace.error("There was an error in retrieving the related feature: "+e)})}).catch(function(e){t.app.trace.error("There was an error in returning the feature layer: "+e)})}}}else e.gcxFeature=this._generateGeocortexFeature(a,r,i),this._processGeneratedGCXFeature(e)}},i.prototype._findGeocortexLayer=function(e,t){if(e&&t&&t.essentialsMap)return t.essentialsMap.findLayerFromMatchingEsriFeatureLayer(e)},i.prototype._getProperMapServiceUrlForComparison=function(e,t){var i=e.serviceUrl;return e.serviceToken&&t.search(/token=.[^&]*/g)>0&&(i=v.RestHelperHTTPService.appendTokenToUrl(i,e.serviceToken)),i},i}(s.FeatureProviderBase);i.RelatedFeaturesViewModelBase=f})},"Mapping/modules/FeatureDetails/FeatureDetailsProviders/SearchTablesRelatedFeaturesViewModel":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();define(["require","exports","./RelatedFeaturesViewModelBase","geocortex/essentials/Layer","geocortex/infrastructure/Feature","geocortex/infrastructure/FilterUtils","geocortex/framework/observables","geocortex/infrastructure/gis/FieldInfo","geocortex/infrastructure/TaskUtils","geocortex/infrastructure/FeatureSet"],function(t,i,a,r,n,s,o,l,u,d){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var c=function(t){function i(e,i){var a=t.call(this,e,i)||this;return a.SEARCHTABLE_KEY="parentSearchTable",a.SEARCH_TABLE_ID_KEY="SearchTableId",a.datalinkSearches=[],a.currentSearchTable=null,e.site&&e.site.isInitialized?a._siteInitialized():e.event("SiteInitializedEvent").once(a,a._siteInitialized),a}return e(i,t),i.prototype.activateRelatedFeatureView=function(e){e instanceof n.Feature||(e=this._getFeatureFromFeatureInfo(e));var i=this.parentFeature.get();i&&e&&e instanceof n.Feature&&i.getExtendedPropertyByName(this.SEARCH_TABLE_ID_KEY)==e.getExtendedPropertyByName(this.SEARCH_TABLE_ID_KEY)?this.showParentView():t.prototype.activateRelatedFeatureView.call(this,e)},i.prototype.handleCurrentFeatureChanged=function(e){var t=this;if(!e)throw new Error("Feature cannot be null for the related features view model");this._destroyAttachedViews(),this.hasRelationships.set(!1),this.relationList.clear(),this._allRelatedFeatureInfo=[],this.datalinkSearches=[],this.currentSearchTable=null,this._featureLayers={},this._allLayers=[],this._relatedLayerPromises&&(this._relatedLayerPromises.cancel(),this._relatedLayerPromises=null);var i=e.getExtendedPropertyByName(this.SEARCHTABLE_KEY);if(i){var a=i.getExtendedPropertyByName(this.SEARCH_TABLE_ID_KEY),n=this._getSearchTable(a);if(n){var l={allowFrames:!1,uriTransformer:function(e){return e}},u=new o.Observable(this.providerEnabled.get()),d=new o.ObservableCollection([]),c=i.esriFeature.get(),p={id:new o.Observable("Parent_SearchTable"),displayName:new o.Observable(s.sanitize(i.label.get(),l)),relationName:new o.Observable(null),layer:null,featureUrl:"",attributes:i.attributes,geometry:new o.Observable(c.geometry),hasAttachments:new o.Observable(!1),attachmentInfos:new o.ObservableCollection([])};u.sync(this.providerEnabled);var h={displayName:new o.Observable(n.displayName),id:new o.Observable(0),relatedTableId:new o.Observable(null),visible:new o.Observable(!0),relatedEsriFeatureInfo:new o.ObservableCollection([p]),relatedGcxFeatures:d,hasRetrievedData:new o.Observable(!0),noRelatedFeatures:new o.Observable(!1),canAdd:new o.Observable(!1),validCardinality:new o.Observable(!1),errorFetchingRelatedFeatures:new o.Observable(!1),results:d,columnHeaders:new o.ObservableCollection([]),providerEnabled:u,masterViewModel:this};this.relationList.addItem(h);var g={featureInfo:p,esriFeature:c,gcxFeature:i,layer:null};this._checkRelatedFeature(g),g.gcxFeature.setExtendedProperty(this.SEARCH_TABLE_ID_KEY,a),this._createAttachedViews(),this.updateProviderState(!0)}}else{a=e.getExtendedPropertyByName(this.SEARCH_TABLE_ID_KEY);if(this.currentSearchTable=this._getSearchTable(a),!this.currentSearchTable||!this._searchTablesRelationships.hasOwnProperty(this.currentSearchTable.id))return;this.datalinkSearches=this._searchTablesRelationships[this.currentSearchTable.id];for(var b=[],v=0,f=this.datalinkSearches.length;v<f;v++){!function(){var e=t.datalinkSearches[v],i=e&&e.dataLink?e.dataLink.layer:null;if(t._allLayers.push(i),i&&i instanceof r.Layer){var a=i.getFeatureLayer();a.then(function(e){t._featureLayers[i.url]=e}),b.push(a)}}()}this._relatedLayerPromises=Promise.all(b),this._relatedLayerPromises.then(function(){if(t._relatedLayerPromises=null,t.datalinkSearches.length>0){t.hasRelationships.set(!0);for(var i=0,a=t.datalinkSearches.length;i<a;i++){!function(){var a=t.datalinkSearches[i],r=a.dataLink.layer,n=a.displayName,s=new o.Observable(t.providerEnabled.get()),l=new o.ObservableCollection([]);s.sync(t.providerEnabled);var u={displayName:new o.Observable(n),id:new o.Observable(i),relatedTableId:new o.Observable(null),visible:new o.Observable(!0),relatedEsriFeatureInfo:new o.ObservableCollection([]),relatedGcxFeatures:l,hasRetrievedData:new o.Observable(!1),noRelatedFeatures:new o.Observable(!1),canAdd:new o.Observable(!1),validCardinality:new o.Observable(!1),errorFetchingRelatedFeatures:new o.Observable(!1),results:l,columnHeaders:new o.ObservableCollection([]),providerEnabled:s,masterViewModel:t},d=t._featureLayers[r.url];t._resolveRelatedFeatures(u,e,a,d),t.relationList.addItem(u)}()}}if(t._createAttachedViews(),t._updateProviderState(),null==t.parentFeature.get()){t.parentFeature.set(t.currentFeature.get());t.parentFeature.get()}})}},i.prototype._findGeocortexLayer=function(e){for(var i in this._featureLayers)if(this._featureLayers.hasOwnProperty(i)&&this._featureLayers[i]==e)for(var a=0,r=this._allLayers.length;a<r;a++){var n=this._allLayers[a];if(n&&n.url==i)return n}return t.prototype._findGeocortexLayer.call(this,e,this.app.site)},i.prototype._siteInitialized=function(){this._findSearchTableRelationships()},i.prototype._findSearchTableRelationships=function(){if(this._searchTablesRelationships={},this.app.site&&this.app.site.essentialsMap)for(var e=this.app.site.essentialsMap.allLayers(),t=0,i=e.length;t<i;t++)for(var a=e[t],r=0,n=a.dataLinks.length;r<n;r++)for(var s=a.dataLinks[r],o=0,l=s.searches.length;o<l;o++){var u=s.searches[o],d=u.searchTableId;this._searchTablesRelationships.hasOwnProperty(d)||(this._searchTablesRelationships[d]=[]),this._searchTablesRelationships[d].push(u)}},i.prototype._resolveRelatedFeatures=function(e,t,i,a){var r=this;if(e&&t&&i&&a){var n=i.dataLink,s=n?n.layer:null,o=(s&&s.mapService&&s.mapService.serviceLayer,t.esriFeature.get()),c=o&&o.attributes&&i.tableField?o.attributes[i.tableField]:null,p=s?s.getFieldByName(i.featureField):null,h=this._getEsriField(a,i.featureField),g=h?l.FieldInfo.fromEsriField(h,null,p):null,b=[];if(s&&g){g.searchable=!0,b.push(g);var v=u.getSearchTextWhereClause(s,b,c),f=new esri.tasks.Query;f.where=v,f.outFields=["*"],f.outSpatialReference=this.app.map.spatialReference,f.returnGeometry=!0,u.getQueryTask(s).execute(f,function(i){if(0==i.features.length)return e.noRelatedFeatures.set(!0),void e.hasRetrievedData.set(!0);for(var n=new d.FeatureSet({layer:s,app:r.app,esriFeatureSet:new esri.tasks.FeatureSet}),o=0,l=i.features.length;o<l;o++){var u={featureInfo:null,esriFeature:null,gcxFeature:null,layer:a},c=i.features[o];u.esriFeature=c;var p=r._processRelatedFeature(a,c,e);u.featureInfo=p,e.relatedEsriFeatureInfo.addItem(p),r._checkRelatedFeature(u),n.addFeature(u.gcxFeature),u.gcxFeature.setExtendedProperty(r.SEARCHTABLE_KEY,t),u.gcxFeature.hasVisibleRelationships.set(!0),a.hasAttachments&&setTimeout(function(e,t){return function(){t._loadAttachments(e)}}(p,r),100)}n.resolveDataLinks(function(e){r.app.event("FeatureChangedEvent").publish(e)}),e.hasRetrievedData.set(!0)},function(t){e.errorFetchingRelatedFeatures.set(!0),e.hasRetrievedData.set(!0),r.app.trace.error("Error getting related record for search table datalink {0}: {1}.".format(i.displayName,t.message))})}}else this.app.trace.error("_resolveRelatedFeatures missing parameters")},i.prototype._getEsriField=function(e,t){var i=null;if(e&&e.fields)for(var a=e.fields,r=0,n=a.length;r<n;r++){a[r];if(a[r].name==t){i=a[r];break}}return i},i.prototype._getSearchTable=function(e){var t=null,i=this.app.site;return e&&i&&i.hasSearchTables&&(t=i.getResourceById(i.searchTables,e)),t},i}(a.RelatedFeaturesViewModelBase);i.SearchTablesRelatedFeaturesViewModel=c})},"url:/Mapping/modules/FeatureDetails/FeatureDetailsProviders/AttachmentsView.html":t,"url:/Mapping/modules/FeatureDetails/FeatureDetailsProviders/AttributesView.html":i,"url:/Mapping/modules/FeatureDetails/FeatureDetailsProviders/DataLinksTableView.html":a,"url:/Mapping/modules/FeatureDetails/FeatureDetailsProviders/DataLinksView.html":r,"url:/Mapping/modules/FeatureDetails/FeatureDetailsProviders/DataLinkView.html":n,"url:/Mapping/modules/FeatureDetails/FeatureDetailsProviders/DescriptionView.html":s,"url:/Mapping/modules/FeatureDetails/FeatureDetailsProviders/FeatureActionsView.html":o,"url:/Mapping/modules/FeatureDetails/FeatureDetailsProviders/HyperlinksView.html":l,"url:/Mapping/modules/FeatureDetails/FeatureDetailsProviders/MultiColumnAttributesView.html":u,"url:/Mapping/modules/FeatureDetails/FeatureDetailsProviders/RelatedFeaturesTableView.html":d,"url:/Mapping/modules/FeatureDetails/FeatureDetailsProviders/RelatedFeaturesView.html":c,"url:/Mapping/modules/FeatureDetails/FeatureDetailsProviders/SingleAttributeView.html":p,"url:/Mapping/modules/FeatureDetails/FeatureDetailsSwitcherView.html":h,"url:/Mapping/modules/FeatureDetails/FeatureDetailsView.html":g,"url:/Mapping/modules/FeatureDetails/LargeFeatureDetailsView.html":b}}),require(["geocortex/framework/resourceManager"],function(e){e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/CSS/common.css","css","DQovKiBGRUFUVVJFIERFVEFJTCBQUk9WSURFUlMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovDQouRmVhdHVyZURldGFpbHNDb21wYWN0VmlldyBoMiwNCi5GZWF0dXJlRGV0YWlsc1ZpZXcgaDIsDQouRmVhdHVyZURldGFpbHNDb21wYWN0VmlldyBoMywNCi5GZWF0dXJlRGV0YWlsc1ZpZXcgaDMgew0KICAgIGZvbnQtd2VpZ2h0OiBsaWdodGVyOw0KfQ0KDQouRmVhdHVyZURldGFpbHNDb21wYWN0VmlldyBoMyBidXR0b24sDQouRmVhdHVyZURldGFpbHNWaWV3IGgzIGJ1dHRvbiB7DQogICAgYmFja2dyb3VuZDogbm9uZTsNCiAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgI0Q5RDlEOTsNCiAgICBmb250LXNpemU6IDEuMjVlbTsNCiAgICBtYXJnaW4tYm90dG9tOiAxZW07DQp9DQoNCi5GZWF0dXJlRGV0YWlsc0NvbXBhY3RWaWV3IC5wYW5lbC1ncm91cCwNCi5GZWF0dXJlRGV0YWlsc1ZpZXcgLnBhbmVsLWdyb3VwIHsNCiAgICBwYWRkaW5nOiAwIDAgMWVtIDA7DQogICAgZmxvYXQ6IGxlZnQ7DQogICAgd2lkdGg6IDEwMCU7DQogICAgLXdlYmtpdC1ib3gtc2l6aW5nOiBib3JkZXItYm94Ow0KICAgIC1tb3otYm94LXNpemluZzogYm9yZGVyLWJveDsNCiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94Ow0KfQ0KLkZlYXR1cmVEZXRhaWxzQ29tcGFjdFZpZXcgLnBhbmVsLWdyb3VwIGgzLA0KLkZlYXR1cmVEZXRhaWxzVmlldyAucGFuZWwtZ3JvdXAgaDMgew0KICAgIGJhY2tncm91bmQ6IG5vbmU7DQogICAgZm9udC1zaXplOiAxLjVlbTsNCn0NCg0KLm1hcC1jYWxsb3V0LWNvbnRlbnRzIC5tb2RpZnkgew0KICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBiYWNrZ3JvdW5kOiAjZmZmZmZmOw0KfQ0KDQoubWFwLWNhbGxvdXQtY29udGVudHMgLm1vZGlmeSBhIHsNCiAgICBwYWRkaW5nOiAxZW0gMDsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBjb2xvcjogIzE5N0RDODsNCiAgICBkaXNwbGF5OiBibG9jazsNCiAgICB3aWR0aDogMTAwJTsNCn0NCi5mZWF0dXJlLWRlc2NyaXB0aW9uLXByb3ZpZGVyIGgzLCAuZmVhdHVyZS1kZXRhaWxzLWNvbnRlbnQsIC5GZWF0dXJlQXR0cmlidXRlc1Byb3ZpZGVyVmlldyBoMyB7DQogICAgd29yZC1icmVhazogYnJlYWstd29yZDsNCiAgICB3b3JkLXdyYXA6IGJyZWFrLXdvcmQ7DQogICAgcGFkZGluZy1yaWdodDogMWVtOw0KfQ0KLmZlYXR1cmUtZGV0YWlscy1jb250ZW50IHsNCiAgICBwYWRkaW5nLWxlZnQ6IDFlbTsNCiAgICB3aGl0ZS1zcGFjZTogcHJlLXdyYXA7DQp9DQouZmVhdHVyZS1kZXRhaWxzLWNvbnRlbnQgPiBpZnJhbWUsDQouZmVhdHVyZS1kZXRhaWxzLWNvbnRlbnQgPiBpbWcgeyAvKiBIYXZlIHRoZSBmZWF0dXJlIGltYWdlIG9yIGlmcmFtZSBmbG9hdCBzbyB0aGUgY29udGVudCB3aWxsIGxpbmUgdXAgbmV4dCB0byBpdC4gKi8NCiAgICBmbG9hdDogbGVmdDsNCiAgICBtYXJnaW46IDAgMWVtIDFlbSAwOw0KfQ0KDQouZmVhdHVyZS1kZXRhaWxzLWNvbnRlbnQgPiBpZnJhbWUgKyBiciwNCi5mZWF0dXJlLWRldGFpbHMtY29udGVudCA+IGltZyArIGJyIHsgLyogSWYgdGhlIGZlYXR1cmUgaW1hZ2Ugb3IgaWZyYW1lIGhhcyBhIGJyIHRhZyBmb2xsb3cgaXQsIGhpZGUgaXQgc28gdGhlIGNvbnRlbnQgaW4gdGhlIG5leHQgY29sdW1uIGRvZXNuJ3QgaGF2ZSBhbiBleHRyYSBzcGFjZSBhYm92ZSBpdC4gKi8NCiAgICBkaXNwbGF5OiBub25lOw0KfQ0KDQouYXR0cmlidXRlLWxpc3QsDQouYXR0cmlidXRlLWl0ZW0gew0KICAgIGRpc3BsYXk6IGJsb2NrOw0KICAgIG1hcmdpbjogMDsNCiAgICBwYWRkaW5nOiAwOw0KICAgIGxpc3Qtc3R5bGU6IG5vbmU7DQp9DQoNCi5hdHRyaWJ1dGUtaXRlbSB7DQogICAgbWFyZ2luLXRvcDogMWVtOw0KfQ0KLmF0dHJpYnV0ZS1pdGVtOmZpcnN0LWNoaWxkIHsNCiAgICBtYXJnaW4tdG9wOiAwOw0KfQ0KDQouYXR0cmlidXRlLWxhYmVsLA0KLmF0dHJpYnV0ZS1kZXRhaWxzIHsNCiAgICBkaXNwbGF5OiBibG9jazsNCiAgICAtd2Via2l0LWJveC1zaXppbmc6IGJvcmRlci1ib3g7DQogICAgLW1vei1ib3gtc2l6aW5nOiBib3JkZXItYm94Ow0KICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7DQp9DQoNCi5hdHRyaWJ1dGUtbGFiZWwgew0KICAgIGNvbG9yOiAjNzY3Njc2Ow0KfQ0KDQouYXR0cmlidXRlLWRldGFpbHMgew0KICAgIGZvbnQtc2l6ZTogMS4yNWVtOw0KICAgIGxpbmUtaGVpZ2h0OiAxLjI1ZW07DQogICAgd29yZC13cmFwOiBicmVhay13b3JkOw0KfQ0KDQouRmVhdHVyZURldGFpbHNWaWV3IC50YWItY29udGFpbmVyIHsNCiAgICBiYWNrZ3JvdW5kOiAjRkZGRkZGOw0KICAgIGJvcmRlci1jb2xvcjogI0Q5RDlEOTsNCn0NCg0KLkZlYXR1cmVEZXRhaWxzVmlldyAudGFiIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjRUVFRUVFOw0KICAgIGJvcmRlci1jb2xvcjogI0Q5RDlEOTsNCiAgICBvdmVyZmxvdzogaGlkZGVuOw0KICAgIHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzOw0KfQ0KDQouRmVhdHVyZURldGFpbHNWaWV3IC50YWItYWN0aXZlIHsNCiAgICBiYWNrZ3JvdW5kOiAjRkZGRkZGOw0KICAgIG92ZXJmbG93OiBoaWRkZW47DQogICAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7DQp9DQoNCi5GZWF0dXJlRGV0YWlsc1ZpZXcgLnRhYjpob3ZlciB7DQogICAgYmFja2dyb3VuZDogI0RERERERDsNCn0NCi5GZWF0dXJlRGV0YWlsc0NvbXBhY3RWaWV3IC5tdWx0aS1jb2x1bW4tY29udGFpbmVyLA0KLm11bHRpLWNvbHVtbi1jb250YWluZXIgew0KICAgIGZsb2F0OiBsZWZ0Ow0KICAgIHdpZHRoOiA5NSU7DQogICAgbWFyZ2luOiAwIGF1dG87DQp9DQouRmVhdHVyZURldGFpbHNDb21wYWN0VmlldyAubXVsdGktY29sdW1uLWNvbnRhaW5lciB7DQogICAgbWFyZ2luOiAwIDAgMC41ZW0gMDsNCiAgICBib3JkZXI6IDA7DQogICAgcGFkZGluZy10b3A6IDAuNWVtOw0KfQ0KDQoubXVsdGktY29sdW1uLWNvbnRhaW5lciB7DQogICAgd2lkdGg6IDQ1JTsNCiAgICBtYXJnaW4tcmlnaHQ6IDFlbTsNCiAgICBwYWRkaW5nLWxlZnQ6IDFlbTsNCiAgICBib3JkZXItbGVmdDogMXB4IHNvbGlkICNFRUVFRUU7DQp9DQoubXVsdGktY29sdW1uLWNvbnRhaW5lcjpmaXJzdC1jaGlsZCB7DQogICAgbWFyZ2luLWxlZnQ6IDA7DQogICAgYm9yZGVyLWxlZnQ6IG5vbmU7DQp9DQoNCg0KQG1lZGlhIGFsbCBhbmQgKG1pbi13aWR0aDogMTAwMHB4KSB7DQogICAgLm11bHRpLWNvbHVtbi1jb250YWluZXIgew0KICAgICAgICB3aWR0aDogMzAlOw0KICAgIH0NCn0NCg0KLnJlZ2lvbi1jb250YWluZXIgew0KICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsNCiAgICBmbG9hdDogbGVmdDsNCn0NCg0KLkZlYXR1cmVEZXRhaWxzVG9wTGVmdFJlZ2lvbi1hY3RpdmUuRmVhdHVyZURldGFpbHNUb3BSaWdodFJlZ2lvbi1hY3RpdmUgLmZlYXR1cmUtZGV0YWlscy10b3AtbGVmdC1yZWdpb24sDQouRmVhdHVyZURldGFpbHNUb3BMZWZ0UmVnaW9uLWFjdGl2ZS5GZWF0dXJlRGV0YWlsc1RvcFJpZ2h0UmVnaW9uLWFjdGl2ZSAuZmVhdHVyZS1kZXRhaWxzLXRvcC1yaWdodC1yZWdpb24gew0KICAgIHdpZHRoOiA1MCU7DQp9DQouRmVhdHVyZURldGFpbHNUb3BMZWZ0UmVnaW9uLWFjdGl2ZS5GZWF0dXJlRGV0YWlsc1RvcFJpZ2h0UmVnaW9uLWluYWN0aXZlIC5mZWF0dXJlLWRldGFpbHMtdG9wLWxlZnQtcmVnaW9uLA0KLkZlYXR1cmVEZXRhaWxzVG9wTGVmdFJlZ2lvbi1pbmFjdGl2ZS5GZWF0dXJlRGV0YWlsc1RvcFJpZ2h0UmVnaW9uLWFjdGl2ZSAuZmVhdHVyZS1kZXRhaWxzLXRvcC1yaWdodC1yZWdpb24sDQouZmVhdHVyZS1kZXRhaWxzLWJvdHRvbS1yZWdpb24gew0KICAgIHdpZHRoOiAxMDAlOw0KfQ0KLmZlYXR1cmUtZGV0YWlscy1ib3R0b20tcmVnaW9uOmFmdGVyIHsNCiAgICAgY29udGVudDogIiAiOw0KICAgICBkaXNwbGF5OiBibG9jazsNCiAgICAgaGVpZ2h0OiAwOw0KICAgICBjbGVhcjogYm90aDsNCiAgICAgdmlzaWJpbGl0eTogaGlkZGVuOyANCn0NCg0KLyogSGlkZSB0aGUgRGV0YWlscyBoZWFkZXIgd2hlbiBpdCBpcyB0aGUgb25seSBvbmUgcHJlc2VudCAqLw0KLkZlYXR1cmVEZXRhaWxzRXhwYW5kZWRWaWV3IC5GZWF0dXJlQXR0cmlidXRlc1Byb3ZpZGVyVmlldyAucGFuZWwtZ3JvdXAgaDMgew0KICAgIGRpc3BsYXk6IG5vbmU7DQp9DQoNCi8qIEhpZGUgdGhlIGhlYWRlciB3aGVuIHRhYnMgYXJlIHByZXNlbnQgaW4gdGhlIHJlZ2lvbiBoZWFkZXIgKi8NCi5yZWdpb24tdmlldy1zd2l0Y2hlci5ib3VuZC12aXNpYmxlICsgLnJlZ2lvbiAudmlldyAucGFuZWwtZ3JvdXAgaDMgew0KICAgIGRpc3BsYXk6IG5vbmU7DQp9DQoucmVnaW9uLXZpZXctc3dpdGNoZXIuYm91bmQtdmlzaWJsZSArIC5yZWdpb24gLnZpZXcuRmVhdHVyZURlc2NyaXB0aW9uUHJvdmlkZXJWaWV3LmFjdGl2ZSAucGFuZWwtZ3JvdXAgLmZlYXR1cmUtZGV0YWlscy1jb250ZW50IHsNCiAgICBtYXJnaW4tdG9wOiAxZW07DQp9DQouZGF0YWxpbmtzLXRhYmxlLXdpZGdldCwNCi5yZWxhdGVkLWZlYXR1cmVzLXRhYmxlLXdpZGdldCB7DQogICAgd2lkdGg6IDEwMCU7DQogICAgcG9zaXRpb246IGFic29sdXRlOw0KICAgIHRvcDogMi4zZW07DQogICAgYm90dG9tOiAwOw0KfQ0KLmNyZWF0ZWZlYXR1cmUtYWN0aW9ucy5ib3VuZC12aXNpYmxlIH4gLnJlbGF0ZWQtZmVhdHVyZXMtdGFibGUtd2lkZ2V0IHsNCiAgICB0b3A6IDUuM2VtOw0KfSANCg0KLyouZGF0YWxpbmtzLXRhYmxlLXdpZGdldCwgDQoucmVsYXRlZC1mZWF0dXJlcy10YWJsZS13aWRnZXQgew0KICAgIGhlaWdodDogaW5oZXJpdDsNCn0qLw0KLkZlYXR1cmVEZXRhaWxzRXhwYW5kZWRWaWV3IC5tdWx0aS1jb2x1bW4tY29udGFpbmVyIHsNCiAgICBwYWRkaW5nLXRvcDogMC41ZW07DQp9DQoucmVnaW9uLWNvbnRhaW5lci5mZWF0dXJlLXJlZ2lvbiB7DQogICAgd2lkdGg6IDEwMCU7DQogICAgcGFkZGluZy10b3A6IDAuNWVtOw0KfQ0KDQoucGFuZWwtZ3JvdXAgew0KICAgIGZsb2F0OiBub25lOw0KICAgIGNsZWFyOiBib3RoOw0KICAgIHdpZHRoOiAxMDAlOw0KfQ0KLkZlYXR1cmVEZXRhaWxzQ29tcGFjdFZpZXcgLm11bHRpLWNvbHVtbi1jb250YWluZXIgew0KICAgIGZsb2F0OiBub25lOw0KfQ0KLkZlYXR1cmVEZXRhaWxzQ29tcGFjdFZpZXcgLnNpbmdsZS1mZWF0dXJlLWNoYXJ0IGgzIHsNCiAgICBtYXJnaW4tYm90dG9tOiAwOw0KfQ0KLkZlYXR1cmVEZXRhaWxzQ29tcGFjdFZpZXcgLnBhbmVsLWdyb3VwIGgzIHsNCiAgICBwYWRkaW5nLWxlZnQ6IC43NWVtOw0KfQ0KLkZlYXR1cmVEZXRhaWxzQ29tcGFjdFZpZXcgLnBhbmVsLWdyb3VwIGJ1dHRvbi5saXN0LW1lbnUtaXRlbSB7DQogICAgYm9yZGVyOiAwOw0KICAgIGRpc3BsYXk6IGJsb2NrOw0KICAgIHdpZHRoOiAxMDAlOw0KICAgIHBhZGRpbmctdG9wOiAwLjQzOGVtOw0KICAgIHBhZGRpbmctYm90dG9tOiAwLjQzOGVtOw0KfQ0KDQoudG91Y2ggLkZlYXR1cmVEZXRhaWxzQ29tcGFjdFZpZXcgLnBhbmVsLWdyb3VwIGJ1dHRvbi5saXN0LW1lbnUtaXRlbSB7DQogICAgcGFkZGluZy10b3A6IDFlbTsNCiAgICBwYWRkaW5nLWJvdHRvbTogMWVtOw0KfQ0KDQouRmVhdHVyZURldGFpbHNDb21wYWN0VmlldyAucGFuZWwtZ3JvdXAgLmxpc3QtbWVudS5oYXMtaWNvbiBidXR0b24ubGlzdC1tZW51LWl0ZW0gew0KICAgIHBhZGRpbmctdG9wOiAwLjI1ZW07DQogICAgcGFkZGluZy1ib3R0b206IDAuMjVlbTsNCn0NCg0KLnRvdWNoIC5GZWF0dXJlRGV0YWlsc0NvbXBhY3RWaWV3IC5wYW5lbC1ncm91cCAubGlzdC1tZW51Lmhhcy1pY29uIGJ1dHRvbi5saXN0LW1lbnUtaXRlbSB7DQogICAgcGFkZGluZy10b3A6IDFlbTsNCiAgICBwYWRkaW5nLWJvdHRvbTogMWVtOw0KfQ0KDQouRmVhdHVyZURldGFpbHNDb21wYWN0VmlldyAucGFuZWwtZ3JvdXAgLmxpc3QtbWVudSAuYXR0YWNobWVudC5saXN0LW1lbnUtaXRlbSB7DQogICAgcGFkZGluZy1sZWZ0OiAwOw0KfQ0KDQovKiBHVkgtMTAxMjI6IFRhZ3MgZm9yIHRhYiBjb250cm9scyBjb3BpZWQgZnJvbSBNYXBwaW5nL2luZnJhc3RydWN0dXJlL3Jlc3VsdHMvQ1NTL2NvbW1vbi5jc3MgKi8NCg0KLkZlYXR1cmVEZXRhaWxzRXhwYW5kZWRWaWV3IC50YWItY29udGFpbmVyIHsNCiAgICBvdmVyZmxvdzogaGlkZGVuOw0KfQ0KDQouRmVhdHVyZURldGFpbHNFeHBhbmRlZFZpZXcgLnRhYi1jb250YWluZXIgdGFibGUgew0KICAgIHRhYmxlLWxheW91dDogZml4ZWQ7DQogICAgd2lkdGg6IDEwMCU7DQogICAgb3ZlcmZsb3c6IGhpZGRlbjsNCn0NCg0KLkZlYXR1cmVEZXRhaWxzRXhwYW5kZWRWaWV3IC50YWItbGVmdC1zY3JvbGwsIA0KLkZlYXR1cmVEZXRhaWxzRXhwYW5kZWRWaWV3IC50YWItcmlnaHQtc2Nyb2xsIHsNCiAgICB2ZXJ0aWNhbC1hbGlnbjogdG9wOw0KICAgIHdpZHRoOiAyLjc1ZW07DQogICAgcG9zaXRpb246IHJlbGF0aXZlOw0KICAgIHotaW5kZXg6IDEwMDsNCn0NCi5GZWF0dXJlRGV0YWlsc0V4cGFuZGVkVmlldyAudGFiLWxlZnQtc2Nyb2xsIHsNCiAgICBib3JkZXItcmlnaHQ6IDFweCBzb2xpZCAjRDlEOUQ5Ow0KfQ0KLkZlYXR1cmVEZXRhaWxzRXhwYW5kZWRWaWV3IC50YWItcmlnaHQtc2Nyb2xsIHsNCiAgICBib3JkZXItbGVmdDogMXB4IHNvbGlkICNEOUQ5RDk7DQp9DQouRmVhdHVyZURldGFpbHNFeHBhbmRlZFZpZXcgLnRhYi1sZWZ0LXNjcm9sbCBpbWcsIA0KLkZlYXR1cmVEZXRhaWxzRXhwYW5kZWRWaWV3IC50YWItcmlnaHQtc2Nyb2xsIGltZyB7DQogICAgbWFyZ2luOiAwIGF1dG87DQogICAgZGlzcGxheTogYmxvY2s7DQp9DQouRmVhdHVyZURldGFpbHNFeHBhbmRlZFZpZXcgLnRhYi1sZWZ0LXNjcm9sbCBidXR0b24sIA0KLkZlYXR1cmVEZXRhaWxzRXhwYW5kZWRWaWV3IC50YWItcmlnaHQtc2Nyb2xsIGJ1dHRvbiB7DQogICAgd2lkdGg6IDEwMCU7DQogICAgaGVpZ2h0OiAyLjJlbTsNCiAgICBiYWNrZ3JvdW5kOiAjZmZmZmZmOw0KfQ0KLkZlYXR1cmVEZXRhaWxzRXhwYW5kZWRWaWV3IC50YWItbGVmdC1zY3JvbGwuZGlzYWJsZWQgYnV0dG9uLCANCi5GZWF0dXJlRGV0YWlsc0V4cGFuZGVkVmlldyAudGFiLXJpZ2h0LXNjcm9sbC5kaXNhYmxlZCBidXR0b24gew0KICAgIGJhY2tncm91bmQ6ICNlZWVlZWU7DQp9DQouRmVhdHVyZURldGFpbHNFeHBhbmRlZFZpZXcgLnJlc3VsdHMgLndpZGdldC5ib3VuZC12aXNpYmxlIHsNCiAgICB0b3A6IDIuMTVlbTsNCn0NCg0KLkZlYXR1cmVEZXRhaWxzRXhwYW5kZWRWaWV3IC50YWItY29udHJvbCB7DQogICAgLyogV2lkdGggaW5oZXJpdCBpcyByZXF1aXJlZCBzbyB0YWIgY29udHJvbCBvZmZzZXQgd2lkdGggY2FuIGJlIGNvbXBhcmVkIHRvIHRoYXQgb2YgdGhlIHRhYiBjb250YWluZXIgdG8gY2hlY2sgd2hldGhlciB0byBkaXNwbGF5IHRhYiBzY3JvbGwgYnV0dG9ucyAqLw0KICAgIHdpZHRoOiBpbmhlcml0Ow0KICAgIGRpc3BsYXk6IGlubGluZS1ibG9jayAhaW1wb3J0YW50Ow0KICAgIHpvb206IDE7DQp9DQoNCi5GZWF0dXJlRGV0YWlsc0V4cGFuZGVkVmlldyAudGFiLWNvbnRyb2wgew0KICAgIC8qIFdpZHRoIGluaGVyaXQgaXMgcmVxdWlyZWQgc28gdGFiIGNvbnRyb2wgb2Zmc2V0IHdpZHRoIGNhbiBiZSBjb21wYXJlZCB0byB0aGF0IG9mIHRoZSB0YWIgY29udGFpbmVyIHRvIGNoZWNrIHdoZXRoZXIgdG8gZGlzcGxheSB0YWIgc2Nyb2xsIGJ1dHRvbnMgKi8NCiAgICB3aWR0aDogaW5oZXJpdDsNCiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2sgIWltcG9ydGFudDsNCiAgICB6b29tOiAxOw0KfQ0KDQovKiBlbmQgb2YgdGFiIGNvbnRyb2wgdGFncyAqLw0KDQpAbWVkaWEgYWxsIGFuZCAobWluLXdpZHRoOiAwcHgpIGFuZCAobWF4LXdpZHRoOiA0NTBweCkgew0KICAgIC5GZWF0dXJlRGV0YWlsc0V4cGFuZGVkVmlldyAubXVsdGktY29sdW1uLWNvbnRhaW5lciB7DQogICAgICAgIHBhZGRpbmctdG9wOiAxZW07DQogICAgICAgIGZsb2F0OiBub25lOw0KICAgICAgICBib3JkZXI6IDA7DQogICAgICAgIHdpZHRoOiAxMDAlOw0KICAgICAgICBtYXJnaW46IDA7DQogICAgfQ0KfQ0KDQoubGlzdC1tZW51Lmh5cGVybGlua3Mgew0KICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCAjRUVFRUVFOw0KfQ0KDQoubGlzdC1tZW51Lmh5cGVybGlua3MgLmxpc3QtbWVudS1kZXRhaWxzIHsNCiAgICBwYWRkaW5nOiAwLjVlbSAxZW07DQp9"),e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/CSS/large.css","css","DQovKiBGRUFUVVJFIERFVEFJTCBQUk9WSURFUlMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovDQoNCi5hdHRyaWIgLmxpc3QtbWVudS1pdGVtIC5saXN0LW1lbnUtbmFtZSwNCi5hdHRyaWIgLmxpc3QtbWVudS1pdGVtIC5saXN0LW1lbnUtZGVzYyB7DQogICAgYm94LXNpemluZzogYm9yZGVyLWJveDsNCiAgICAtbW96LWJveC1zaXppbmc6IGJvcmRlci1ib3g7DQp9DQoNCi5hdHRyaWIgLmxpc3QtbWVudS1pdGVtIHsNCiAgICBkaXNwbGF5OiBibG9jazsNCiAgICBtYXgtd2lkdGg6NTBlbTsNCiAgICBwYWRkaW5nOiAwOw0KfQ0KDQouYXR0cmliIC5saXN0LW1lbnUtbmFtZSwNCi5hdHRyaWIgLmxpc3QtbWVudS1kZXNjIHsNCiAgICBmbG9hdDogbGVmdDsNCiAgICB2ZXJ0aWNhbC1hbGlnbjogYm90dG9tOw0KICAgIHBhZGRpbmc6IDFlbTsNCiAgICB3b3JkLXdyYXA6IGJyZWFrLXdvcmQ7DQp9DQoNCi5hdHRyaWIgLmxpc3QtbWVudS1uYW1lIHsNCiAgICB3aWR0aDogNDAlOw0KICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQp9DQoNCi5hdHRyaWIgLmxpc3QtbWVudS1kZXNjIHsNCiAgICB3aWR0aDogNjAlOw0KfQ0KDQouZmVhdHVyZS1kZXRhaWxzLWhlYWRlciAucGFuZWwtdGl0bGUgew0KICAgIGZsb2F0OiBsZWZ0Ow0KICAgIG1hcmdpbjogMCAyMHB4Ow0KfQ0KDQouZmVhdHVyZS1kZXRhaWxzLWhlYWRlciAuZmVhdHVyZS1hY3Rpb25zLXdpZGdldCB7DQogICAgZmxvYXQ6IHJpZ2h0Ow0KICAgIG1hcmdpbjogMCAyMHB4Ow0KICAgIG1heC13aWR0aDogNjAlOw0KfQ0KDQouZmVhdHVyZS1kZXRhaWxzLWJvdHRvbS1yZWdpb24gLnBhbmVsLXNjcm9sbC1jb250YWluZXIgew0KICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsNCn0NCg0KLmZlYXR1cmUtZGV0YWlscy1ib3R0b20tcmVnaW9uIGgzIHsNCn0NCg0KLyogSGlkZSB0aGUgY2hhcnQgaGVhZGVyIGluIGZlYXR1cmUgZGV0YWlscywgc2luY2Ugd2UgaGF2ZSBhIGNoYXJ0IHNlbGVjdG9yIHRoYXQgZG9lcyB0aGUgc2FtZSB0aGluZyAqLw0KLnJlZ2lvbiAudmlldyAucGFuZWwtZ3JvdXAuc2luZ2xlLWZlYXR1cmUtY2hhcnQuYm91bmQtdmlzaWJsZSBoMyB7DQogICAgZGlzcGxheTogbm9uZTsNCn0NCg0KLyogSWYgdGhlIGhlYWRlciBpcyBub3QgdmlzaWJsZSwgd2UgbmVlZCB0byBtYWtlIGFkanVzdG1lbnRzIHRvIGNoYXJ0IHZpZXcgKi8NCi5yZWdpb24gLnZpZXcgLnBhbmVsLWdyb3VwLnNpbmdsZS1mZWF0dXJlLWNoYXJ0LmJvdW5kLXZpc2libGUgaW1nIHsNCiAgICB0b3A6IDA7DQp9DQoNCi8qLkZlYXR1cmVEZXRhaWxzVmlldyAuRmVhdHVyZUNoYXJ0c1Byb3ZpZGVyVmlldyAuc2luZ2xlLWZlYXR1cmUtY2hhcnQgLmZ1aS1zZWxlY3RvciB7DQogICAgcGFkZGluZzogMDsNCn0qLw0KDQouZmVhdHVyZS1kZXRhaWxzLWhlYWRlciB7DQogICAgZGlzcGxheTogYmxvY2s7DQogICAgd2lkdGg6IDEwMCU7DQp9DQoNCi5mZWF0dXJlLWRldGFpbHMtaGVhZGVyIC5mZWF0dXJlLWFjdGlvbnMtd2lkZ2V0IC5tZW51LWh5cGVybGlua3MgLmxpc3QtbWVudSB7DQogICAgbWFyZ2luLXRvcDogMDsNCiAgICBib3JkZXItdG9wOiBub25lOw0KfQ0KLkZlYXR1cmVEZXRhaWxzVG9wUmlnaHRSZWdpb24tYWN0aXZlIC5mZWF0dXJlLWRldGFpbHMtdG9wLXJpZ2h0LXJlZ2lvbiAucmVzdWx0cy10YWJsZSB7DQogICAgbWF4LXdpZHRoOiA1MCU7DQogICAgbWluLXdpZHRoOiAwOw0KfQ0K"),e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/CSS/medium.css","css","DQovKiBGRUFUVVJFIERFVEFJTCBQUk9WSURFUlMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovDQoNCi5hdHRyaWIgLmxpc3QtbWVudS1pdGVtIC5saXN0LW1lbnUtbmFtZSwNCi5hdHRyaWIgLmxpc3QtbWVudS1pdGVtIC5saXN0LW1lbnUtZGVzYyB7DQogICAgYm94LXNpemluZzogYm9yZGVyLWJveDsNCiAgICAtbW96LWJveC1zaXppbmc6IGJvcmRlci1ib3g7DQp9DQoNCi5hdHRyaWIgLmxpc3QtbWVudS1pdGVtIHsNCiAgICBkaXNwbGF5OiBibG9jazsNCiAgICBtYXgtd2lkdGg6NTBlbTsNCiAgICBwYWRkaW5nOiAwOw0KfQ0KDQouYXR0cmliIC5saXN0LW1lbnUtbmFtZSwNCi5hdHRyaWIgLmxpc3QtbWVudS1kZXNjIHsNCiAgICBmbG9hdDogbGVmdDsNCiAgICB2ZXJ0aWNhbC1hbGlnbjogYm90dG9tOw0KICAgIHBhZGRpbmc6IDFlbTsNCiAgICB3b3JkLXdyYXA6IGJyZWFrLXdvcmQ7DQp9DQoNCi5hdHRyaWIgLmxpc3QtbWVudS1uYW1lIHsNCiAgICB3aWR0aDogNDAlOw0KICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQp9DQoNCi5hdHRyaWIgLmxpc3QtbWVudS1kZXNjIHsNCiAgICB3aWR0aDogNjAlOw0KfQ0KDQouZmVhdHVyZS1kZXRhaWxzLWhlYWRlciAucGFuZWwtdGl0bGUgew0KICAgIGZsb2F0OiBsZWZ0Ow0KICAgIG1hcmdpbjogMCAyMHB4Ow0KfQ0KDQouZmVhdHVyZS1kZXRhaWxzLWhlYWRlciAuZmVhdHVyZS1hY3Rpb25zLXdpZGdldCB7DQogICAgZmxvYXQ6IHJpZ2h0Ow0KICAgIG1hcmdpbjogMCAyMHB4Ow0KICAgIG1heC13aWR0aDogNjAlOw0KfQ0KDQouZmVhdHVyZS1kZXRhaWxzLXRvcC1sZWZ0LXJlZ2lvbiwNCi5mZWF0dXJlLWRldGFpbHMtdG9wLXJpZ2h0LXJlZ2lvbiB7DQogICAgd2lkdGg6IDUwJTsNCiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7DQogICAgZmxvYXQ6IGxlZnQ7DQp9DQoNCi5mZWF0dXJlLWRldGFpbHMtYm90dG9tLXJlZ2lvbiB7DQogICAgd2lkdGg6IDEwMCU7DQogICAgZGlzcGxheTogaW5saW5lLWJsb2NrOw0KfQ0KDQouZmVhdHVyZS1kZXRhaWxzLWJvdHRvbS1yZWdpb24gLnBhbmVsLXNjcm9sbC1jb250YWluZXIgew0KICAgIHRvcDphdXRvICFpbXBvcnRhbnQ7DQogICAgYm90dG9tOiBhdXRvICFpbXBvcnRhbnQ7DQogICAgcG9zaXRpb246IHJlbGF0aXZlOw0KfQ0KDQouZmVhdHVyZS1kZXRhaWxzLWJvdHRvbS1yZWdpb24gaDMgew0KfQ0KDQovKiBIaWRlIHRoZSBjaGFydCBoZWFkZXIgaW4gZmVhdHVyZSBkZXRhaWxzLCBzaW5jZSB3ZSBoYXZlIGEgY2hhcnQgc2VsZWN0b3IgdGhhdCBkb2VzIHRoZSBzYW1lIHRoaW5nICovDQoucmVnaW9uIC52aWV3IC5wYW5lbC1ncm91cC5zaW5nbGUtZmVhdHVyZS1jaGFydC5ib3VuZC12aXNpYmxlIGgzIHsNCiAgICBkaXNwbGF5OiBub25lOw0KfQ0KDQovKiBJZiB0aGUgaGVhZGVyIGlzIG5vdCB2aXNpYmxlLCB3ZSBuZWVkIHRvIG1ha2UgYWRqdXN0bWVudHMgdG8gY2hhcnQgdmlldyAqLw0KLnJlZ2lvbiAudmlldyAucGFuZWwtZ3JvdXAuc2luZ2xlLWZlYXR1cmUtY2hhcnQuYm91bmQtdmlzaWJsZSBpbWcgew0KICAgIHRvcDogMDsNCn0NCg0KLyouRmVhdHVyZURldGFpbHNWaWV3IC5GZWF0dXJlQ2hhcnRzUHJvdmlkZXJWaWV3IC5zaW5nbGUtZmVhdHVyZS1jaGFydCAuZnVpLXNlbGVjdG9yIHsNCiAgICBwYWRkaW5nOiAwOw0KfSovDQoNCi5mZWF0dXJlLWRldGFpbHMtaGVhZGVyIHsNCiAgICBkaXNwbGF5OiBibG9jazsNCiAgICB3aWR0aDogMTAwJTsNCn0NCg0KLmZlYXR1cmUtZGV0YWlscy1oZWFkZXIgLmZlYXR1cmUtYWN0aW9ucy13aWRnZXQgLm1lbnUtaHlwZXJsaW5rcyAubGlzdC1tZW51IHsNCiAgICBtYXJnaW4tdG9wOiAwOw0KICAgIGJvcmRlci10b3A6IG5vbmU7DQp9DQpAbWVkaWEgYWxsIGFuZCAobWF4LXdpZHRoOiA5ODBweCkgew0KDQogICAgLmZlYXR1cmUtZGV0YWlscy1ib3R0b20tcmVnaW9uIC5tdWx0aS1jb2x1bW4tY29udGFpbmVyIHsNCiAgICAgICAgcGFkZGluZy1sZWZ0OiAxZW07DQogICAgICAgIG1hcmdpbjogMDsNCiAgICAgICAgYm9yZGVyLWxlZnQ6MDsNCiAgICB9DQp9DQoNCi5kYXRhbGlua3MtdGFibGUtd2lkZ2V0LA0KLnJlbGF0ZWQtZmVhdHVyZXMtdGFibGUtd2lkZ2V0IHsNCiAgICB0b3A6IDMuNWVtOw0KfQ0KDQouY3JlYXRlZmVhdHVyZS1hY3Rpb25zLmJvdW5kLXZpc2libGUgfiAucmVsYXRlZC1mZWF0dXJlcy10YWJsZS13aWRnZXQgew0KICAgIHRvcDogNi41ZW07DQp9"),e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/CSS/small.css","css","LnJlZ2lvbi1jb250YWluZXIuZmVhdHVyZS1yZWdpb24gew0KICAgIHdpZHRoOiAxMDAlOw0KfQ0KLkZlYXR1cmVEZXRhaWxzVmlldyAucGFuZWwtZ3JvdXAgew0KICAgIGZsb2F0OiBub25lOw0KICAgIGNsZWFyOiBib3RoOw0KICAgIHdpZHRoOiAxMDAlOw0KfQ0KLkZlYXR1cmVEZXRhaWxzVmlldyAubXVsdGktY29sdW1uLWNvbnRhaW5lciB7DQogICAgZmxvYXQ6IG5vbmU7DQp9DQouRmVhdHVyZURldGFpbHNWaWV3IC5zaW5nbGUtZmVhdHVyZS1jaGFydCBoMyB7DQogICAgbWFyZ2luLWJvdHRvbTogMDsNCn0="),e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/FeatureDetailsProviders/AttachmentsView.html","html",t),e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/FeatureDetailsProviders/AttributesView.html","html",i),e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/FeatureDetailsProviders/DataLinksTableView.html","html",a),e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/FeatureDetailsProviders/DataLinksView.html","html",r),e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/FeatureDetailsProviders/DataLinkView.html","html",n),e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/FeatureDetailsProviders/DescriptionView.html","html",s),e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/FeatureDetailsProviders/FeatureActionsView.html","html",o),e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/FeatureDetailsProviders/HyperlinksView.html","html",l),e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/FeatureDetailsProviders/MultiColumnAttributesView.html","html",u),e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/FeatureDetailsProviders/RelatedFeaturesTableView.html","html",d),e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/FeatureDetailsProviders/RelatedFeaturesView.html","html",c),e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/FeatureDetailsProviders/SingleAttributeView.html","html",p),e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/FeatureDetailsSwitcherView.html","html",h),e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/FeatureDetailsView.html","html",g),e.resourceManager.register("Mapping","inv","Mapping/modules/FeatureDetails/LargeFeatureDetailsView.html","html",b)}),require({cache:{}}),define(["Mapping/modules/FeatureDetails/FeatureDetailsModule","Mapping/modules/FeatureDetails/FeatureDetailsSwitcherView","Mapping/modules/FeatureDetails/FeatureDetailsSwitcherViewDescriptor","Mapping/modules/FeatureDetails/FeatureDetailsSwitcherViewModel","Mapping/modules/FeatureDetails/FeatureDetailsView","Mapping/modules/FeatureDetails/FeatureDetailsViewModel","Mapping/modules/FeatureDetails/FeatureDetailsProviders/AttachmentsView","Mapping/modules/FeatureDetails/FeatureDetailsProviders/AttachmentsViewModel","Mapping/modules/FeatureDetails/FeatureDetailsProviders/AttributesView","Mapping/modules/FeatureDetails/FeatureDetailsProviders/AttributesViewModel","Mapping/modules/FeatureDetails/FeatureDetailsProviders/DataLinksView","Mapping/modules/FeatureDetails/FeatureDetailsProviders/DataLinksViewModel","Mapping/modules/FeatureDetails/FeatureDetailsProviders/DataLinkView","Mapping/modules/FeatureDetails/FeatureDetailsProviders/DescriptionView","Mapping/modules/FeatureDetails/FeatureDetailsProviders/DescriptionViewModel","Mapping/modules/FeatureDetails/FeatureDetailsProviders/FeatureActionsView","Mapping/modules/FeatureDetails/FeatureDetailsProviders/FeatureActionsViewModel","Mapping/modules/FeatureDetails/FeatureDetailsProviders/Hyperlink","Mapping/modules/FeatureDetails/FeatureDetailsProviders/HyperlinksView","Mapping/modules/FeatureDetails/FeatureDetailsProviders/HyperlinksViewModel","Mapping/modules/FeatureDetails/FeatureDetailsProviders/RelatedFeaturesView","Mapping/modules/FeatureDetails/FeatureDetailsProviders/RelatedFeaturesViewModel","Mapping/modules/FeatureDetails/FeatureDetailsProviders/RelatedFeaturesViewModelBase","Mapping/modules/FeatureDetails/FeatureDetailsProviders/SearchTablesRelatedFeaturesViewModel"],function(t,i,a,r,n,s,o,l,u,d,c,p,h,g,b,v,f,m,w,F,y,V,I,C){e(t,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsModule",t.FeatureDetailsModule),e(i,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsSwitcherView",i.FeatureDetailsSwitcherView),e(a,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsSwitcherViewDescriptor",a.FeatureDetailsSwitcherViewDescriptor),e(r,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsSwitcherViewModel",r.FeatureDetailsSwitcherViewModel),e(n,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsView",n.FeatureDetailsView),e(s,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsViewModel",s.FeatureDetailsViewModel),e(o,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.AttachmentsView",o.AttachmentsView),e(l,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.AttachmentsViewModel",l.AttachmentsViewModel),e(u,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.AttributesView",u.AttributesView),e(d,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.AttributesViewModel",d.AttributesViewModel),e(c,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.DataLinksView",c.DataLinksView),e(p,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.DataLinksViewModel",p.DataLinksViewModel),e(h,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.DataLinkView",h.DataLinkView),e(g,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.DescriptionView",g.DescriptionView),e(b,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.DescriptionViewModel",b.DescriptionViewModel),e(v,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.FeatureActionsView",v.FeatureActionsView),e(f,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.FeatureActionsViewModel",f.FeatureActionsViewModel),e(m,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.Hyperlink",m.Hyperlink),e(w,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.HyperlinksView",w.HyperlinksView),e(F,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.HyperlinksViewModel",F.HyperlinksViewModel),e(y,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.RelatedFeaturesView",y.RelatedFeaturesView),e(V,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.RelatedFeaturesViewModel",V.RelatedFeaturesViewModel),e(I,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.RelatedFeaturesViewModelBase",I.RelatedFeaturesViewModelBase),e(C,"geocortex.essentialsHtmlViewer.mapping.modules.FeatureDetails.FeatureDetailsProviders.SearchTablesRelatedFeaturesViewModel",C.SearchTablesRelatedFeaturesViewModel)})}();