/*
	
	Copyright (c) 2016, Latitude Geographics Group Ltd.
	All rights reserved.
	       
	Redistribution is not permitted. 
	
	Use in binary form, without modification, is permitted provided that neither 
	the name of the organization nor the names of its contributors may be used 
	to endorse or promote products derived from this software without specific 
	prior written permission.
	       
	THIS SOFTWARE IS PROVIDED BY COPYRIGHT HOLDER ''AS IS'' AND ANY
	EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
	WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
	DISCLAIMED. IN NO EVENT SHALL LATITUDE GEOGRAPHICS GROUP LTD. BE LIABLE FOR ANY
	DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
	(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
	LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
	ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
	(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
	SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/

var __extends=this&&this.__extends||function(c,f){function h(){this.constructor=c}for(var l in f)f.hasOwnProperty(l)&&(c[l]=f[l]);c.prototype=null===f?Object.create(f):(h.prototype=f.prototype,new h)},geocortex;
(function(c){(function(c){(function(c){(function(c){function k(a,e,d){b||(b=new c.AnimationFactory);return b.create(a,e,d)}function d(){e=0;for(var b=a.splice(0,c.MAX_OPS_PER_FRAME),m=0;m<b.length;++m)b[m]();a.length&&!e&&setTimeout(function(){e=requestAnimationFrame(d)},0)}c.MAX_OPS_PER_FRAME=1E3;var b=null,a=[],e=0;c.getDefault=function(){return b};c.create=k;c.play=function(a,e,b){return k(a,e,b).play(b)};c.scheduleForAnimationFrame=function(b){a.push(b);e||(e=requestAnimationFrame(d))}})(c.animation||
(c.animation={}))})(c.ui||(c.ui={}))})(c.framework||(c.framework={}))})(geocortex||(geocortex={}));
(function(c){(function(c){(function(c){(function(c){var k=function(){function d(b){this._animationProvider=b||null}d.prototype.create=function(b,a,e){this._isInitialized||this._init();return new c.AnimationSequence(this.getAnimationProvider(),b,a||[],e)};d.prototype.getAnimationProvider=function(){return this._animationProvider};d.prototype.setAnimationProvider=function(b){this._animationProvider=b};d.prototype._init=function(){this._isInitialized=!0;this._animationProvider||(this._animationProvider=
new c.CssTransitionAnimationProvider)};return d}();c.AnimationFactory=k})(c.animation||(c.animation={}))})(c.ui||(c.ui={}))})(c.framework||(c.framework={}))})(geocortex||(geocortex={}));(function(c){c=c.framework||(c.framework={});c=c.ui||(c.ui={});(c.animation||(c.animation={})).reservedKeyframeProperties=["className","duration","isDynamic"]})(geocortex||(geocortex={}));
(function(c){(function(c){(function(c){(function(c){var k=function(){function c(){}c.prototype.animate=function(b,a,e,g,m){throw Error("Not implemented");};return c}();c.AnimationProviderBase=k})(c.animation||(c.animation={}))})(c.ui||(c.ui={}))})(c.framework||(c.framework={}))})(geocortex||(geocortex={}));
(function(c){(function(c){(function(c){var f;(function(c){function d(){return 0<c._activeAnimations.length}function b(){if(d())return!1;var e=a.slice();a=[];for(var b=0;b<e.length;++b)try{e[b]()}catch(c){console.error("Error during animation delegate: "+c)}return!0}c._activeAnimations=[];var a=[];c.isAnimating=d;c.checkAndRunIdle=b;c.runWhenIdle=function(e){a.push(e);setTimeout(function(){return b()},0)};var e=function(){function a(e,b,g,d){var f=this;this._frameProvider=e;this._element=b;this._frame=
-1;this._frames=[];this._frameCallback=d;this._state=c.AnimationState.Idle;g&&g.forEach(function(a){return f.add(a)})}a.prototype.resets=function(){return this._resets};a.prototype.setResets=function(a){this._resets=a;return this};a.prototype.play=function(e){var b=this;e&&(this._frameCallback=e);if(this._state!==c.AnimationState.Idle)return this._animationPromise.reject(Error("Animation already in progress."));this._animationPromise=$.Deferred();if(e=a.getActiveAnimationForElement(this._element))return e._animationPromise.then(function(a){return b._startAnimation()});
if(this._frames.length)return this._startAnimation();if(this._isDynamic&&!this._frames.length)return this._state=c.AnimationState.Idle,this._animationPromise};a.prototype.stop=function(){this._state=c.AnimationState.Stopped;return this._complete(!1)};a.prototype.add=function(a){if("string"===typeof a){var e=null;-1<a.indexOf(":")&&(e=a.split(":"),a=e[0],e=parseInt(e[1]));this._frames.push({className:a,duration:e})}else{var e={},b;for(b in a)a.hasOwnProperty(b)&&(e[b]=a[b]);this._isDynamic&&(e.isDynamic=
!0);this._frames.push(e)}this._isDynamic&&this._state===c.AnimationState.Idle&&this._tick();return this};a.prototype._startAnimation=function(){var e=this;f._activeAnimations.push(this);this._state=c.AnimationState.Started;this._frame=-1;setTimeout(function(){e._tick()},0);return this._animationPromise.then(function(b){a.removeAnimationForElement(e._element);return b})};a.prototype._tick=function(){this._frame>=this._frames.length?this._isDynamic?this._state=c.AnimationState.Idle:this._complete():
this._applyFrame()};a.prototype._complete=function(a){setTimeout(function(){f.checkAndRunIdle()},0);return this._animationPromise.resolve({state:a?c.AnimationState.Stopped:c.AnimationState.Completed,element:this._element,frame:null})};a.prototype._onFrameEnd=function(){++this._frame;this._state=c.AnimationState.Started;this._tick()};a.prototype._applyFrame=function(){var a=this;c.scheduleForAnimationFrame(function(){var e=-1===a._frame?null:a._frames[a._frame],b=a._frame>=a._frames.length-1?null:
a._frames[a._frame+1];a._isDynamic&&!b?a._state=c.AnimationState.Idle:(a._state=c.AnimationState.FrameBegin,a._frameProvider.animate(a,a._element,e,b,function(b){b=b||{state:c.AnimationState.FrameEnd,element:a._element,frame:e};if(a._frameCallback)try{a._frameCallback(b)}catch(g){return console.error("Error in animation frame callback: "+g),a._animationPromise.reject(b)}if(b){if(b.state===c.AnimationState.Error)return a._animationPromise.reject(b);if(b.state!==c.AnimationState.FrameEnd)throw Error("Animation provider emitted an event other than an error or a frame.");
}a._onFrameEnd()}))})};a.getActiveAnimationForElement=function(a){return f._activeAnimations.filter(function(e){return e._element===a})[0]||null};a.removeAnimationForElement=function(a){for(var e=0;e<f._activeAnimations.length;++e)if(f._activeAnimations[e]._element===a)return f._activeAnimations.splice(e,1),!0;return!1};return a}();c.AnimationSequence=e})(f=c.animation||(c.animation={}))})(c.ui||(c.ui={}))})(c.framework||(c.framework={}))})(geocortex||(geocortex={}));
(function(c){c=c.framework||(c.framework={});c=c.ui||(c.ui={});c=c.animation||(c.animation={});c=c.AnimationState||(c.AnimationState={});c[c.Idle=0]="Idle";c[c.Started=1]="Started";c[c.FrameBegin=2]="FrameBegin";c[c.FrameEnd=3]="FrameEnd";c[c.Completed=4]="Completed";c[c.Stopped=5]="Stopped";c[c.Error=6]="Error"})(geocortex||(geocortex={}));
(function(c){(function(c){(function(h){(function(l){var k=function(d){function b(){d.call(this);this._poolSize=1E3;this._poolFlushFactor=0.75;this._poolSizeTarget=0.5;this._cachedKeyframeMap={};this._cachedKeyframesArray=[];this._cssPropertyNameMap={};this._emittedStylesheet||(this._setupPropertyMap(),this._setupStylesheet())}__extends(b,d);b.prototype.getKeyframeStyleCount=function(){return this._emittedStylesheet.cssRules.length};b.prototype.animate=function(a,e,b,c,d){var f,h,k=d,l;b&&c?(b.className||
(l=this._getCachedKeyframeData(e,c),b.className=l.emittedClassName),l=e.className.replace(b.className,"").trim()):l=b?e.className:e.className.replace(/anim-keyframe[-\d\w]+/g,"").trim();c&&(f=c.duration,c.className?-1===e.className.indexOf(c.className)&&(l=l?l+" "+c.className:c.className):(h=this._getCachedKeyframeData(e,c),c.className=h.emittedClassName,-1===e.className.indexOf(c.className)&&(l=l?l+" "+h.emittedClassName:h.emittedClassName),++h.refCount,k=function(){d();--h.refCount}));c&&$(e).hasClass(c.className)?
setTimeout(k,10):(e.className=l.trim().replace(/\s\s+/g," "),h&&h.duration&&(f=h.duration),null==f&&(!c&&b.duration?f=b.duration:c&&(f=this._getKeyframeDuration(e),c.duration=f,h&&(h.duration=c.duration))),!c&&a.resets()&&(e.className=e.className.replace(b.className,"").trim()),setTimeout(k,null!=f?f:10))};b.prototype._setupPropertyMap=function(){var a="-{0}-".format(h.utils.detectBrowserPrefix()),e;if(window.getComputedStyle){var g=window.getComputedStyle(document.body);e=[];for(var c=0;c<g.length;++c)e.push(g[c])}else e=
b._animatableProperties;["transition","transform"].forEach(function(e){return a+e});for(c=0;c<e.length;++c)g=e[c].replace(a,"").replace(/\-(\w)/g,function(a){return a.toUpperCase().replace("-","")}),this._cssPropertyNameMap[g]=e[c]};b.prototype._setupStylesheet=function(){var a=document.createElement("style");document.getElementsByTagName("head")[0].appendChild(a);this._emittedStylesheet=a.sheet};b.prototype._generateFrameId=function(){return"anim-keyframe-"+c.utils.alphaNumericToken(8)};b.prototype.getCssNameForProperty=
function(a){return this._cssPropertyNameMap[a]||a};b.prototype._getHashKey=function(a){var e={},b;for(b in a)!a.hasOwnProperty(b)||-1<l.reservedKeyframeProperties.indexOf(b)&&"duration"!==b||(e[b]=a[b]);return String.quickHashCode(JSON.stringify(e))};b.prototype._getCachedKeyframeData=function(a,e){var b="anim-keyframe"+this._getHashKey(e),c=this._cachedKeyframeMap[b];if(c)return++c.count,c;var d=null!=e.duration;e.className=b;e.duration=null!=e.duration?e.duration:this._getKeyframeDuration(a);c=
{key:b,count:0,refCount:0,emittedClassName:b,frame:e,duration:e.duration,styleBlockIndex:-1};this._cachedKeyframeMap[b]=c;this._cachedKeyframesArray.push(c);var b="."+e.className+" { ",f;for(f in e)if(e.hasOwnProperty(f)&&"className"!==f&&"duration"!==f)var h=this.getCssNameForProperty(f)||f,b=b+(h+": "+e[f]+"; ");d&&(b+=this.getCssNameForProperty("transitionDuration")+": "+e.duration+"ms !important; ");c.styleBlockIndex=this._emittedStylesheet.insertRule(b+"} ",this._emittedStylesheet.cssRules.length);
this._emittedStylesheet.cssRules.length>=this._poolSize*this._poolFlushFactor&&(++c.refCount,this.flushKeyframes(),--c.refCount);return c};b.prototype.flushKeyframes=function(){for(var a={},b=[],g=[],c=0;c<this._cachedKeyframesArray.length;++c){var d=this._cachedKeyframesArray[c];0===d.refCount?g.push(d):(b.push(d),a[d.key]=d)}this._swapKeyframeSets(b,a);this._removeKeyframesFromStylesheets(g)};b.prototype._swapKeyframeSets=function(a,b){this._cachedKeyframesArray=a.slice();this._cachedKeyframeMap=
{};for(var g in b)this._cachedKeyframeMap[g]=b[g]};b.prototype._removeKeyframesFromStylesheets=function(a,b){for(var g=0;g<a.length;++g)this._emittedStylesheet.removeRule(a[g].styleBlockIndex-g);for(g=0;g<this._emittedStylesheet.rules.length;++g){var c=this._emittedStylesheet.rules[g].selectorText.substr(1);this._cachedKeyframeMap[c].styleBlockIndex=g}};b.prototype._getKeyframeDuration=function(a){if(!window.getComputedStyle)return null;var b=window.getComputedStyle(a);a=b.getPropertyValue("transition-duration")||
"0";b=b.getPropertyValue("transition-delay")||"0";a=-1<a.indexOf("ms")?parseFloat(a):1E3*parseFloat(a);return(-1<b.indexOf("ms")?parseFloat(b):1E3*parseFloat(b))+a};b.prototype._setPoolOptions=function(a){a.hasOwnProperty("poolSize")&&(this._poolSize=a.poolSize);a.hasOwnProperty("poolFlushFactor")&&(this._poolFlushFactor=a.poolFlushFactor);a.hasOwnProperty("poolSizeTarget")&&(this._poolSizeTarget=a.poolSizeTarget)};b._animatableProperties="background background-color background-position border-bottom-color border-bottom-width border border-color border-left-color border-left-width border-right-color border-right-width border-spacing border-top-color border-top-width bottom clip color crop font-size font-weight height left letter-spacing line-height margin margin-bottom margin-left margin-right margin-top max-height max-width min-height min-width opacity outline-color outline-offset outline-width padding padding-bottom padding-left padding-right padding-top right text-indent text-shadow transform transition-duration transform-origin top vertical-align visibility width word-spacing z-index".split(" ");
return b}(l.AnimationProviderBase);l.CssTransitionAnimationProvider=k})(h.animation||(h.animation={}))})(c.ui||(c.ui={}))})(c.framework||(c.framework={}))})(geocortex||(geocortex={}));
(function(c){(function(f){(function(f){var l=function(){return function(c,b,a){this.pageNumber=new Observable(c||null);this.isActive=new Observable(b||!1);this.cssClass=new Observable(a||"pc-page-shortcut")}}();f.PresentableCollectionPageShortcut=l;var k=function(d){function b(a){d.call(this,null,null);this.items=new ObservableCollection;this.isSorted=new Observable(!1);this.isFiltered=new Observable(!1);this.isPaginated=new Observable(!0);this.isMultiplePages=new Observable(!0);this.numberOfItems=
new Observable(0);this.currIndexStart=new Observable(0);this.currIndexStartFromOne=new Observable(1);this.currIndexEnd=new Observable(0);this.currPageNumber=new Observable(1);this.prevPageNumber=new Observable;this.nextPageNumber=new Observable;this.firstPageNumber=new Observable(1);this.lastPageNumber=new Observable(1);this.pageSize=new Observable(5);this.pageShortcuts=new ObservableCollection;this.numPageShortcuts=new Observable(10);this._itemCollection=new ObservableCollection;this.filterPredicate=
this.sortingPredicate=this.sortMethod=null;this._prevIndexStart=this.currIndexStart.get();this._prevIndexEnd=this.currIndexEnd.get();this._prevPageNum=0;this._prevPageSize=this.pageSize.get();this.sortMethod=this.defaultNativeSort;this.sortingPredicate=function(a,b){return a===b?0:a>b?1:-1};a&&this.attachToCollection(a);this.auto(this.isSorted,this,function(a){a?this.sortCollection():this.unsortCollection()});this.currIndexStartFromOne.syncTransform(this.currIndexStart,function(a){return a+1});this.auto(this.isPaginated,
this,this._enableOrDisablePagination);this.auto(this.currPageNumber,this,this._handlePageChange);this.auto(this.pageSize,this,this._handlePageChange)}__extends(b,d);b.prototype.nextPage=function(){this.currPageNumber.set(this.currPageNumber.get()+1)};b.prototype.prevPage=function(){this.currPageNumber.set(this.currPageNumber.get()-1)};b.prototype.getAt=function(a){return this._itemCollection.getAt(a)};b.prototype.getLength=function(){return this._itemCollection.getLength()};b.prototype.destroy=function(){d.prototype.destroy.call(this);
this.cleanUp()};b.prototype.cleanUp=function(){this._itemCollection&&this._itemCollection.clear();this.items&&this.items.clear();this._underlyingCollection&&(this._underlyingCollection.unbind(this._underlyingCollectionBindingToken),this._underlyingCollectionBindingToken=this._underlyingCollection=null)};b.prototype.attachToCollection=function(a){this.cleanUp();if(!a)throw Error("Could not attach to collection.");this._attachToUnderlyingCollection(a)};b.prototype._attachToUnderlyingCollection=function(a){this._underlyingCollection=
a;this._underlyingCollectionBindingToken=this._underlyingCollection.bind(this,this._handleUnderlyingCollectionChanges);this._itemCollection.set(a.getRange(0));a=this._itemCollection.getLength();this.numberOfItems.set(a);this.currIndexStart.set(0);this.currIndexEnd.set(this.pageSize.get());this.currPageNumber.set(1);a<this.currIndexEnd.get()&&(this.currIndexEnd.set(a),this._prevIndexEnd=a);this._bindEntirePage();this._maintainPageRanges()};b.prototype._bindEntirePage=function(){this._calculatePageWindow();
this.items.clear();for(var a=[],b=this.currIndexStart.get(),g=this.currIndexEnd.get(),c=b;c<g;++c){var d=this._itemCollection.getAt(c);a.push(d)}this.items.addItems(a);this._prevIndexStart=b;this._prevIndexEnd=this._prevIndexEnd};b.prototype._enableOrDisablePagination=function(a){a?(this.currIndexStart.set(this.currPageNumber.get()*this._prevPageSize),this.pageSize.set(this._prevPageSize),this._calculatePageWindow(),this._bindEntirePage(),this._maintainPageRanges()):(this.currIndexStart.set(0),this._prevPageSize=
this.pageSize.get(),this.pageSize.set(Number.MAX_VALUE),this.pageShortcuts.clear(),this._calculatePageWindow(),this._bindEntirePage())};b.prototype._calculatePageWindow=function(){var a=this._itemCollection.length();this.lastPageNumber.set(Math.ceil(a/this.pageSize.get()));var b=this.currIndexStart.get(),g=this.currIndexEnd.get(),c=this.pageSize.get(),d=0,f=0,h=0;g>a&&(g=a);this.currIndexStart.set(0>b?0:b);this.currIndexEnd.set(Math.min(this._itemCollection.getLength(),this.currIndexEnd.get()));d=
this.currIndexStart.get()-this._prevIndexStart;a<=b&&(f=0,h=-1*~~((b-a+1)/c+1),d=Math.max(0,h*c));g-b<c&&a>=g&&(f=Math.min(c,a)-(g-b));0!==h&&(f=d=0);return{pageShift:h,startShift:d,endShift:f}};b.prototype._handlePageChange=function(a){this.isPaginated.get()?(this.pageSize.value=Math.max(0,Number(this.pageSize.get())),this.currPageNumber.value=Math.max(1,Number(this.currPageNumber.get())),isNaN(this.pageSize.get())||1>this.pageSize.get()||(this.currPageNumber.get()>this.lastPageNumber.get()&&0<this.lastPageNumber.get()?
this.currPageNumber.set(this.lastPageNumber.get()):(this.currIndexStart.set((this.currPageNumber.get()-1)*this.pageSize.get()),this.currIndexEnd.set(Math.min(this._itemCollection.getLength(),this.currIndexStart.get()+this.pageSize.get())),this._prevIndexStart=this.currIndexStart.get(),this._prevIndexEnd=this.currIndexEnd.get(),this._maintainPageRanges(),this._bindEntirePage()))):a!=Number.MAX_VALUE&&(this._prevPageSize=a,this.pageSize.set(Number.MAX_VALUE))};b.prototype._maintainPageRanges=function(){var a=
Math.ceil(this._itemCollection.getLength()/this.pageSize.get());this.lastPageNumber.set(a);1<a&&!this.isMultiplePages.get()?this.isMultiplePages.set(!0):1>=a&&this.isMultiplePages.get()&&this.isMultiplePages.set(!1);this.firstPageNumber.set(1);var b=this.numPageShortcuts.get(),g=Math.max(0,this.currPageNumber.get()-b/2),c=b/2-(this.currPageNumber.get()-g),a=Math.min(a,this.currPageNumber.get()+b/2+c);a-g<this.numPageShortcuts.get()&&(g-=this.numPageShortcuts.get()-(a-g),0>g&&(g=0));this.pageShortcuts.clear();
for(b=[];g<a;++g)b.push(new l(g+1,!1));this.pageShortcuts.addItems(b);this._highlightCorrectPageShortcut()};b.prototype._highlightCorrectPageShortcut=function(){for(var a=0;a<this.pageShortcuts.getLength();++a){var b=this.pageShortcuts.getAt(a);b.pageNumber.get()===this.currPageNumber.get()?b.cssClass.set("pc-page-shortcut pc-shortcut-active"):b.cssClass.set("pc-page-shortcut")}};b.prototype._performWindowRecalc=function(a){if(0!==a.pageShift)this.currIndexStart.set((this.currPageNumber.get()-1)*
this.pageSize.get()),this.currIndexEnd.set(this.currIndexStart.get()+this.pageSize.get()),this.currIndexStart.set(Math.max(0,this.currIndexStart.get())),this.currIndexEnd.set(Math.min(this._itemCollection.getLength(),this.currIndexEnd.get())),this._bindEntirePage();else{if(0>a.startShift){var b=Math.max(0,this._prevIndexStart+a.startShift),b=this._itemCollection.getRange(b,this._prevIndexStart-1);this.items.insertItems(0,b)}else 0<a.startShift&&this.items.removeRange(0,a.startShift-1);0>a.endShift?
this.items.removeRange(this.items.getLength()+a.endShift,this.items.getLength()):0<a.endShift&&(b=Math.min(this._itemCollection.getLength(),this.currIndexEnd.get()+a.endShift),b=this._itemCollection.getRange(this.currIndexEnd.get(),b-1),this.items.addItems(b));this.currIndexStart.set(this.currIndexStart.get()+a.startShift);this.currIndexEnd.set(this.currIndexEnd.get()+a.endShift);0>this.currIndexStart.get()&&(this.currIndexEnd.set(Math.min(this.items.length(),this.currIndexEnd.get()-this.currIndexStart.get())),
this.currIndexStart.set(0))}this._prevIndexStart=this.currIndexStart.get();this._prevIndexEnd=this.currIndexEnd.get()};b.prototype._handleUnderlyingCollectionChanges=function(a){if(!a||"clear"===a.type)this.items.clear(),this._itemCollection.clear(),this._calculatePageWindow();else if("replace"===a.type)this.items.clear(),this._itemCollection.clear(),this._itemCollection.addItems(this._underlyingCollection.getRange(0)),this._calculatePageWindow(),this._bindEntirePage();else if("insert"===a.type){if(!this.isSorted.get()){var e=
this._underlyingCollection.getRange(a.rangeStart,a.rangeEnd);this._itemCollection.insertItems(a.rangeStart,e);var g=b.getIntersectType(this.currIndexStart.get(),this.currIndexEnd.get(),a.rangeStart,a.rangeEnd);if(g===b.RANGE_RELATION_BEFORE||g===b.RANGE_RELATION_HEAD)a=a.rangeEnd-a.rangeStart+1,this._prevIndexStart+=a,this._prevIndexEnd+=a,this._performWindowRecalc({pageShift:0,startShift:-a,endShift:Math.min(-a+Math.max(this.pageSize.get()-this.numberOfItems.get(),0),0)});else if(g===b.RANGE_RELATION_CONTAINED)this._performWindowRecalc({pageShift:0,
startShift:0,endShift:Math.min(-(a.rangeEnd-a.rangeStart+1)+Math.max(this.pageSize.get()-this.numberOfItems.get(),0),0)}),this.items.insertItems(a.rangeStart-this.currIndexStart.get(),e),this.currIndexEnd.get()<this.items.length()&&this.currIndexEnd.set(this.items.length());else if(g===b.RANGE_RELATION_TAIL){this.items.removeRange(a.rangeStart-this.currIndexStart.get(),this.items.getLength());var g=this.currIndexStart.get()+this.pageSize.get(),c=Math.min(g,a.rangeEnd);this._performWindowRecalc({pageShift:0,
startShift:0,endShift:c-this.currIndexEnd.get()});a.rangeStart+e.length>g&&(e=e.slice(0,g-a.rangeStart));this.items.insertItems(a.rangeStart-this.currIndexStart.get(),e);this.currIndexEnd.get()<this.items.length()&&this.currIndexEnd.set(this.items.length())}else g===b.RANGE_RELATION_AFTER?(a=this.currIndexEnd.get()-this.currIndexStart.get(),a<this.pageSize.get()&&this.items.addItems(e.slice(0,this.pageSize.get()-a))):this._bindEntirePage()}}else if("append"===a.type)if(this.isSorted.get())for(e=a.rangeStart;e<=
a.rangeEnd;++e)g=this._underlyingCollection.getAt(e),c=this.getSortedPosition(g),this._itemCollection.insertItem(c,g),c<=this.currIndexStart.get()?(this.items.removeRange(this.items.getLength()-1),this.items.insertItem(0,this._itemCollection.getAt(this.currIndexStart.get()))):c>this.currIndexStart.get()&&c<=this.currIndexEnd.get()&&(this.items.removeRange(this.items.getLength()-1),this.items.insertItem(c-this.currIndexStart.get(),g));else this._itemCollection.addItems(this._underlyingCollection.getRange(a.rangeStart,
a.rangeEnd)),this._performWindowRecalc(this._calculatePageWindow());else if("remove"===a.type)if(0<a.rangeEnd-a.rangeStart){if(this.isSorted.get())for(e=a.rangeStart;e<=a.rangeEnd;++e)g=this.getSortedPosition(this._underlyingCollection.getAt(e)),this._itemCollection.removeRange(g,g);else this._itemCollection.removeRange(a.rangeStart,a.rangeEnd);this._bindEntirePage()}else g=this.isSorted.get()?this.getSortedPosition(this._underlyingCollection.getAt(a.rangeStart)):a.rangeStart,this._itemCollection.removeRange(g,
g),g<this.currIndexStart.get()?(this.currIndexEnd.set(this.currIndexEnd.get()-1),this._performWindowRecalc({pageShift:0,startShift:1,endShift:1}),this.currIndexEnd.set(this.currIndexEnd.get()+1)):g>=this.currIndexStart.get()&&g<this.currIndexEnd.get()&&(a=g-this.currIndexStart.get(),this.items.removeRange(a,a),this.currIndexEnd.set(this.currIndexEnd.get()-1),this._performWindowRecalc({pageShift:0,startShift:0,endShift:1}));this.numberOfItems.set(this._itemCollection.getLength());this._maintainPageRanges()};
b.prototype.sortCollection=function(){var a=this._itemCollection.get();this.sortMethod(a,this.sortingPredicate||null);this._bindEntirePage()};b.prototype.unsortCollection=function(){this._itemCollection.set(this._underlyingCollection.getRange(0));this._bindEntirePage()};b.prototype.getSortedPosition=function(a){if(!1===this.isSorted.get())return this._itemCollection.getLength();var b=this._itemCollection.get();this._itemCollection.getLength();for(var g=0,c=b.length-1,d=~~((c-g)/2);d<c&&d>g;){var f=
this.sortingPredicate(a,b[d]);if(0===this.sortingPredicate(a,b[c]))return c;if(0===this.sortingPredicate(a,b[g]))return g;if(0<f)g=d;else if(0>f)c=d;else break;d=~~((c-g)/2)+g}return d};b.prototype.defaultNativeSort=function(a,b){var g=null;return g=null===b||"undefined"===typeof b?a.sort():a.sort(b)};b.getIntersectType=function(a,e,g,d){return a===g&&e===d?c.framework.ui.PresentableCollection.RANGE_RELATION_SAME:g<a&&d<=a?b.RANGE_RELATION_BEFORE:g<=a&&d<e?b.RANGE_RELATION_HEAD:g<a&&d>e?b.RANGE_RELATION_CONTAINS:
g>a&&d<e?b.RANGE_RELATION_CONTAINED:g<=e&&d>e?b.RANGE_RELATION_TAIL:g>e?b.RANGE_RELATION_AFTER:b.RANGE_RELATION_SAME};b.RANGE_RELATION_SAME=0;b.RANGE_RELATION_BEFORE=1;b.RANGE_RELATION_HEAD=2;b.RANGE_RELATION_TAIL=3;b.RANGE_RELATION_AFTER=4;b.RANGE_RELATION_CONTAINS=5;b.RANGE_RELATION_CONTAINED=6;return b}(c.framework.FrameworkObject);f.PresentableCollection=k})(f.ui||(f.ui={}))})(c.framework||(c.framework={}))})(geocortex||(geocortex={}));
(function(c){(function(c){(function(c){(function(f){var k=function(c){function b(){c.apply(this,arguments)}__extends(b,c);b.prototype.attach=function(a){c.prototype.attach.call(this,a);this._wireUpEventSubscriptions()};b.prototype.resolveWidget=function(a,b,g){c.prototype.resolveWidget.call(this,a,b,g);if("RegionViewSwitcherWidget"===a){if(!b)return null;(a=this.app.viewManager.createView({markupResource:this.viewModel.regionViewSwitcherWidgetMarkup,typeName:this.viewModel.regionViewSwitcherWidgetType,
libraryId:this.viewModel.regionViewSwitcherLibraryId}))&&a.attach(b);return a}return null};b.prototype._wireUpEventSubscriptions=function(){this.app.event("RegionActivatedEvent").subscribe(this,this._handleRegionActivatedEvent);this.app.event("RegionDeactivatedEvent").subscribe(this,this._handleRegionDeactivatedEvent)};b.prototype._handleRegionActivatedEvent=function(a){if(a=this.viewModel.getRegionDescriptorByRegionName(a.name.toString()))a.regionActive.set(!0),this.regionName&&!this.isActive&&this.app.viewManager.activateView(this)};
b.prototype._handleRegionDeactivatedEvent=function(a){if(a=this.viewModel.getRegionDescriptorByRegionName(a.name.toString()))a.regionActive.set(!1),dojo.some(this.viewModel.regionDescriptors.get(),function(a){return!0===a.regionActive.get()})||this.regionName&&this.isActive&&this.app.viewManager.deactivateView(this)};return b}(c.ViewBase);f.MultiRegionView=k})(c.MultiRegion||(c.MultiRegion={}))})(c.ui||(c.ui={}))})(c.framework||(c.framework={}))})(geocortex||(geocortex={}));
(function(c){(function(c){(function(c){(function(c){var f=function(){return function(c,b,a){this.regionActive=new Observable(!1);this.displayRegionViewSwitcher=new Observable(!1);this.viewSwitcherViewModel=new Observable(null);this.DEFAULT_REGION_TYPE="geocortex.framework.ui.MultiDivRegionAdapter";this.DEFAULT_CSS_CLASS="region-container";if(!c)throw Error("RegionDescriptor Error: Cannot create region descriptor. Region name not defined.");this.regionName=c;this.regionType=b||this.DEFAULT_REGION_TYPE;
this.regionCss=this.DEFAULT_CSS_CLASS+(a?" "+a.trim():"")}}();c.RegionDescriptor=f})(c.MultiRegion||(c.MultiRegion={}))})(c.ui||(c.ui={}))})(c.framework||(c.framework={}))})(geocortex||(geocortex={}));
(function(c){(function(c){(function(c){(function(c){var f=function(){return function(c,b){this.view=c;this.viewSwitcherViewModel=b;this.title=c.title;this.isActive=new Observable(c.isActive)}}();c.ViewSwitcherViewDescriptor=f})(c.ViewSwitcher||(c.ViewSwitcher={}))})(c.ui||(c.ui={}))})(c.framework||(c.framework={}))})(geocortex||(geocortex={}));
(function(c){(function(c){(function(c){(function(f){var k=function(c){function b(a,b,g){c.call(this,a,b);this.viewDescriptors=new ObservableCollection([]);this.viewSwitcherActive=new Observable(!1);this.targetRegion=g||""}__extends(b,c);b.prototype.initialize=function(a){a&&!this.targetRegion&&(this.targetRegion=a.targetRegion);this.targetRegion?this._subscribeEvents():this.app.trace.error("ViewSwitcherViewModel: Target region not configured.")};b.prototype.getDescriptorForView=function(a){if(a)for(var b=
0;b<this.viewDescriptors.getLength();++b){var c=this.viewDescriptors.getAt(b);if(c.view.id===a.id)return c}return null};b.prototype.updateViewSwitcherState=function(){this.viewSwitcherActive.set(this.checkIfSwitcherActive())};b.prototype.createDescriptorForView=function(a){return new f.ViewSwitcherViewDescriptor(a,this)};b.prototype.handleViewHostedEvent=function(a){a.region.name===this.targetRegion&&a.view&&(a=this.createDescriptorForView(a.view),this.viewDescriptors.addItem(a),this.updateViewSwitcherState())};
b.prototype.handleViewUnHostedEvent=function(a){a.region.name===this.targetRegion&&a.view&&(a=this.getDescriptorForView(a.view))&&(this.viewDescriptors.removeItem(a),this.updateViewSwitcherState())};b.prototype.handleViewActivatedEvent=function(a){if(a=this.getDescriptorForView(a))this._deactivateActiveTabsInTargetRegion(),a.isActive.set(!0)};b.prototype.handleViewDeactivatedEvent=function(a){(a=this.getDescriptorForView(a))&&a.isActive.set(!1)};b.prototype.checkIfSwitcherActive=function(){return 1<
this.viewDescriptors.length()};b.prototype._deactivateActiveTabsInTargetRegion=function(){this.viewDescriptors.get().forEach(function(a){return a.isActive.get()&&a.isActive.set(!1)})};b.prototype._subscribeEvents=function(){this.app.event("ViewHostedEvent").subscribe(this,this.handleViewHostedEvent);this.app.event("ViewUnhostedEvent").subscribe(this,this.handleViewUnHostedEvent);this.app.event("ViewActivatedEvent").subscribe(this,this.handleViewActivatedEvent);this.app.event("ViewDeactivatedEvent").subscribe(this,
this.handleViewDeactivatedEvent)};return b}(c.ViewModelBase);f.ViewSwitcherViewModel=k})(c.ViewSwitcher||(c.ViewSwitcher={}))})(c.ui||(c.ui={}))})(c.framework||(c.framework={}))})(geocortex||(geocortex={}));
(function(c){(function(f){(function(f){(function(f){var h=function(d){function b(){d.apply(this,arguments);this.regionDescriptors=new ObservableCollection([]);this.autoInsertViewSwitcher=!1;this.regionViewSwitcherWidgetMarkup="Framework.UI/geocortex/framework/ui/ViewSwitcher/ViewSwitcherView.html";this.regionViewSwitcherWidgetType="geocortex.framework.ui.ViewSwitcher.ViewSwitcherView";this.regionViewSwitcherLibraryId="Framework.UI";this.supportedViewSwitcherRegionAdapters=["geocortex.framework.ui.MultiDivRegionAdapter",
"geocortex.framework.ui.MultiViewRegionAdapter"]}__extends(b,d);b.prototype.initialize=function(a){var b=this;a&&a.regions&&dojo.isArray(a.regions)?(this.autoInsertViewSwitcher=!!a.autoInsertViewSwitcher,a.regions.forEach(function(a){return a.regionName&&b.regionDescriptors.addItem(b.createDescriptorForRegion(a.regionName,a.regionType,a.regionCss))}),this._processRegionDescriptors()):this.app.trace.error("MultiRegionViewModel: Region configuration not found or invalid region configuration syntax.")};
b.prototype.getRegionDescriptorByRegionName=function(a){for(var b=0;b<this.regionDescriptors.length();b++){var c=this.regionDescriptors.getAt(b);if(c.regionName===a)return c}return null};b.prototype.supportsViewSwitcher=function(a){return this.autoInsertViewSwitcher&&-1<this.supportedViewSwitcherRegionAdapters.indexOf(a.regionType)};b.prototype.createDescriptorForRegion=function(a,b,c){return new f.RegionDescriptor(a,b,c)};b.prototype.createViewSwitcherViewModel=function(a){return new c.framework.ui.ViewSwitcher.ViewSwitcherViewModel(this.app,
this.libraryId,a)};b.prototype.processRegion=function(a){a&&this.supportsViewSwitcher(a)&&(a.viewSwitcherViewModel.set(this.createViewSwitcherViewModel(a.regionName)),a.displayRegionViewSwitcher.sync(a.viewSwitcherViewModel.get().viewSwitcherActive))};b.prototype._processRegionDescriptors=function(){var a=this;this.regionDescriptors.get().forEach(function(b){return a.processRegion(b)})};return b}(c.framework.ui.ViewModelBase);f.MultiRegionViewModel=h})(f.MultiRegion||(f.MultiRegion={}))})(f.ui||(f.ui=
{}))})(c.framework||(c.framework={}))})(geocortex||(geocortex={}));
(function(c){(function(c){(function(c){(function(f){var k=function(c){function b(a,b){var g=this;c.call(this,a,b);this._siteInitializedFailedToken=this._siteInitializedToken=null;this.app.command("HideSplashScreen").register(this,function(){this.removeSplash()});this.app.site&&this.app.site.isInitialized?this.removeSplash():(this._siteInitializedToken=this.app.event("SiteInitializedEvent").once(this,function(){setTimeout(function(){g.removeSplash()},0)}),this._siteInitializedFailedToken=this.app.event("SiteInitializationFailedEvent").subscribe(this,
function(){setTimeout(function(){g.removeSplash()},0)}),this._siteInitializedFailedToken=this.app.event("UserSignInCancelledEvent").subscribe(this,function(){setTimeout(function(){g.removeSplash()},0)}))}__extends(b,c);b.prototype.removeSplash=function(){var a=this;this.app.viewManager.deactivateView(this);this.app.command("HideSplashScreen").clear();this._siteInitializedToken&&this.app.event("SiteInitializedEvent").unsubscribe(this._siteInitializedToken);this._siteInitializedFailedToken&&this.app.event("SiteInitializationFailedEvent").unsubscribe(this._siteInitializedFailedToken);
setTimeout(function(){a.app.viewManager.destroyView(a)},250)};return b}(c.ViewBase);f.SplashScreenView=k})(c.SplashScreen||(c.SplashScreen={}))})(c.ui||(c.ui={}))})(c.framework||(c.framework={}))})(geocortex||(geocortex={}));
(function(c){(function(f){(function(f){var l=function(f){function d(b){f.call(this);this._collectionsBindingToken=null;this._collectionsMembersBindingTokens=[];b&&this.setCollectionsSource(b)}__extends(d,f);d.prototype.setCollectionsSource=function(b){if(b!==this._collections){if(null!=this._collections){this._collections.unbind(this._collectionsBindingToken);this._collectionsBindingToken=null;if(0<this._collections.length()){var a=new c.framework.events.CollectionChangedArgs;a.type="clear";a.rangeStart=
0;a.rangeEnd=this.length()-1;this.collectionsChanged(a)}this._collections=null}null!=b&&(this._collections=b,this._collectionsBindingToken=this._collections.bind(this,this.collectionsChanged),b=new c.framework.events.CollectionChangedArgs,b.rangeStart=0,b.rangeEnd=this._collections.length()-1,b.type="append",this.collectionsChanged(b))}};d.prototype.getCollectionSource=function(){return this._collections};d.prototype.collectionsChanged=function(b){this.fixBindings(b);this.propagateEvents(b)};d.prototype.fixBindings=
function(b){if("append"==b.type||"insert"==b.type)for(var a=b.rangeStart;a<=b.rangeEnd;a++)this._collectionsMembersBindingTokens.splice(a,0,this._collections.getAt(a).bindingEvent.subscribe(this,this.underlyingCollectionChanged));else if("remove"==b.type||"clear"==b.type){for(a=b.rangeStart;a<=b.rangeEnd;a++)this._collections.getAt(a).bindingEvent.unsubscribe(this._collectionsMembersBindingTokens[a]),this._collectionsMembersBindingTokens[a]=null;this._collectionsMembersBindingTokens.splice(b.rangeStart,
b.rangeEnd-b.rangeStart+1)}else{if("replace"==b.type)throw Error("The original value is lost and we need to unbind from it");throw Error("Unknown argument type");}};d.prototype.propagateEvents=function(b){var a=this._collections.length(),e=new c.framework.events.CollectionChangedArgs;e.type=b.type;e.rangeStart=0;for(var g=e.rangeEnd=0;g<a&&g<b.rangeStart;g++)e.rangeStart+=this._collections.getAt(g).length();for(e.rangeEnd=e.rangeStart-1;g<a&&g<=b.rangeEnd;g++)e.rangeEnd+=this._collections.getAt(g).length();
e.rangeEnd>=e.rangeStart&&(e.sender=this,this.bindingEvent.publish(e))};d.prototype.underlyingCollectionChanged=function(b){var a=new c.framework.events.CollectionChangedArgs;a.sender=this;a.type=b.type;for(var e=0,g=this._collections.length(),d=0;d<g;d++){var f=this._collections.getAt(d);if(f===b.sender){"append"==b.type&&d!=g-1?a.type="insert":"clear"==b.type&&1!=g&&(a.type="remove");a.rangeStart=e+b.rangeStart;a.rangeEnd=e+b.rangeEnd;break}else e+=f.length()}this.bindingEvent.publish(a)};d.prototype.isEmpty=
function(){if(null==this._collections)return!0;for(var b=this._collections.length(),a=0;a<b;a++)if(!this._collections.getAt(a).isEmpty())return!1;return!0};d.prototype.length=function(){if(null==this._collections)return 0;for(var b=0,a=this._collections.length(),e=0;e<a;e++)b+=this._collections.getAt(e).length();return b};d.prototype.contains=function(b){if(null==this._collections)return!1;for(var a=this._collections.length(),e=0;e<a;e++)if(this._collections.getAt(e).contains(b))return!0;return!1};
d.prototype.getAt=function(b){if(null==this._collections)return null;for(var a=this._collections.length(),e=0;e<a;e++){var c=this._collections.getAt(e),d=c.length();if(b>=d)b-=d;else return c.getAt(b)}throw Error("Index out of bounds");};d.prototype.getRange=function(b,a){if(null==this._collections)return[];void 0===a&&(a=Number.POSITIVE_INFINITY);for(var e=null,c=0,d=this._collections.length(),f=0;f<d&&0<=a;f++,b-=c,a-=c){var h=this._collections.getAt(f),c=h.length();c>b&&(h=h.getRange(0<b?b:0,a),
e=null==e?h:e.concat(h))}return e};d.prototype.indexOf=function(b){if(null==this._collections)return-1;for(var a=0,e=this._collections.length(),c=0;c<e;c++){var d=this._collections.getAt(c),f=d.indexOf(b);if(-1!=f)return a+f;a+=d.length()}return-1};d.prototype.get=function(){throw Error("Raw array manipulation not supported");};d.prototype.getItems=function(){throw Error("Raw array manipulation not supported");};d.prototype.getLength=function(){return this.length()};d.prototype.addItems=function(b){throw Error("Operation not supported");
};d.prototype.addItem=function(b){throw Error("Operation not supported");};d.prototype.insertItems=function(b,a){throw Error("Operation not supported");};d.prototype.insertItem=function(b,a){throw Error("Operation not supported");};d.prototype.removeItem=function(b){throw Error("Operation not supported");};d.prototype.removeAt=function(b){throw Error("Operation not supported");};d.prototype.removeRange=function(b,a){throw Error("Operation not supported");};d.prototype.clear=function(){throw Error("Operation not supported");
};d.prototype.set=function(b){throw Error("Operation not supported");};d.prototype.sync=function(b){throw Error("Operation not supported");};d.prototype.equals=function(b){throw Error("Operation not supported");};return d}(ObservableCollection);f.ObservableCollectionAggregator=l})(f.ui||(f.ui={}))})(c.framework||(c.framework={}))})(geocortex||(geocortex={}));
(function(c){(function(c){(function(c){var f=function(c){function d(b,a,e){c.call(this,b);this.delegateGetter=a||null;e&&(this.cacheDelegateResults=e)}__extends(d,c);d.prototype.get=function(){var b=c.prototype.get.call(this);if(null!=b||this._delegateNullCached)return b;if(this.delegateGetter){var a=this.delegateGetter();this.cacheDelegateResults&&a!==b&&c.prototype.set.call(this,a);this.cacheDelegateNull&&(this._delegateNullCached=!0);return a}return null};d.prototype.clear=function(){c.prototype.set.call(this,
null);delete this._delegateNullCached};return d}(Observable);c.LazyObservable=f;f.prototype.cacheDelegateResults=!1;f.prototype.cacheDelegateNull=!1;f.prototype._delegateNullCached=!1})(c.ui||(c.ui={}))})(c.framework||(c.framework={}))})(geocortex||(geocortex={}));
(function(c){(function(f){(function(f){var l=function(f){function d(b,a){f.call(this);this._sourceBindingToken=this._source=null;this._filter=this._defaultFilter;this._indexMap=[];b&&this.setSource(b);a&&this.setFilter(a)}__extends(d,f);d.prototype.setSource=function(b){if(b!==this._source){if(this._source&&this._sourceBindingToken){this._source.unbind(this._sourceBindingToken);this._sourceBindingToken=null;if(0<this.length()){var a=new c.framework.events.CollectionChangedArgs;a.type="clear";a.rangeStart=
0;a.rangeEnd=this.length()-1;this.bindingEvent.publish(a)}this._source=null}null!=b&&(this._source=b,this._sourceBindingToken=this._source.bind(this,this._sourceChanged),this._redo())}};d.prototype.getSource=function(){return this._source};d.prototype.setFilter=function(b){b||(b=this._defaultFilter);b!==this._filter&&(this._filter=b,this._source&&this._redo())};d.prototype.getFilter=function(){return this._filter===this._defaultFilter?null:this._filter};d.prototype.refresh=function(){this._redo()};
d.prototype._redo=function(b){void 0===b&&(b=new c.framework.events.CollectionChangedArgs);b.sender=this;0!=this._indexMap.length&&(b.type="clear",b.rangeStart=0,b.rangeEnd=this._indexMap.length-1,this.bindingEvent.publish(b));for(var a=this._indexMap.length=0,e=this._source?this._source.length():0;a<e;a++)this._filter(this._source.getAt(a))&&this._indexMap.push(a);0!=this._indexMap.length&&(b.type="append",b.rangeStart=0,b.rangeEnd=this._indexMap.length-1,this.bindingEvent.publish(b))};d.prototype._sourceChanged=
function(b){var a,e,g=new c.framework.events.CollectionChangedArgs;g.sender=this;switch(b.type){case "set":this._redo(g);return;case "append":g.type="append";g.rangeStart=this._indexMap.length;for(a=b.rangeStart;a<=b.rangeEnd;a++)this._filter(this._source.getAt(a))&&this._indexMap.push(a);g.rangeEnd=this._indexMap.length-1;break;case "insert":for(e=0<b.rangeStart?this._findIndexMapIx(b.rangeStart):0;e<this._indexMap.length&&this._indexMap[e]<b.rangeStart;)e++;g.type=e<this._indexMap.length?"insert":
"append";g.rangeStart=e;for(a=b.rangeStart;a<=b.rangeEnd;a++)this._filter(this._source.getAt(a))&&this._indexMap.splice(e++,0,a);g.rangeEnd=e-1;for(a=b.rangeEnd-b.rangeStart+1;e<this._indexMap.length;e++)this._indexMap[e]+=a;break;case "remove":for(e=0<b.rangeStart?this._findIndexMapIx(b.rangeStart):0;e<this._indexMap.length&&this._indexMap[e]<b.rangeStart;)e++;for(g.rangeStart=e;e<this._indexMap.length&&this._indexMap[e]<=b.rangeEnd;)e++;g.rangeEnd=e-1;g.type=0==g.rangeStart&&g.rangeEnd==this._indexMap.length-
1?"clear":"remove";break;case "clear":if(0==this.length())return;g.type="clear";g.rangeStart=0;g.rangeEnd=this._indexMap.length;break;default:throw Error("Unhandled case: "+b.type);}g.rangeStart<=g.rangeEnd&&this.bindingEvent.publish(g);switch(g.type){case "remove":this._indexMap.splice(g.rangeStart,g.rangeEnd-g.rangeStart+1);g=b.rangeEnd-b.rangeStart+1;for(e=b.rangeStart;e<this._indexMap.length;e++)this._indexMap[e]-=g;break;case "clear":this._indexMap.length=0}};d.prototype._findIndexMapIx=function(b){for(var a=
0,e=this._indexMap.length-1,c=0;a<=e;)if(c=Math.floor((a+e)/2),this._indexMap[c]>b)e=c-1;else if(this._indexMap[c]<b)a=c+1;else break;return c};d.prototype._defaultFilter=function(b){return!0};d.prototype.isEmpty=function(){return 0==this._indexMap.length};d.prototype.length=function(){return this._indexMap.length};d.prototype.contains=function(b){return this._source&&this._filter(b)&&this._source.contains(b)};d.prototype.getAt=function(b){return this._source?this._source.getAt(this._indexMap[b]):
null};d.prototype.getRange=function(b,a){if(null===a||void 0===a||a>=this._indexMap.length)a=this._indexMap.length-1;for(var e=Array(a-b+1),c=b;c<=a;c++)e[c-b]=this.getAt(c);return e};d.prototype.indexOf=function(b){if(!this._source||!this._filter(b))return-1;b=this._source.indexOf(b);return-1==b?-1:this._findIndexMapIx(b)};d.prototype.get=function(){throw Error("Raw array manipulation not supported");};d.prototype.getItems=function(){throw Error("Raw array manipulation not supported");};d.prototype.getLength=
function(){return this._indexMap.length};d.prototype.addItems=function(b){throw Error("Operation not supported");};d.prototype.addItem=function(b){throw Error("Operation not supported");};d.prototype.insertItems=function(b,a){throw Error("Operation not supported");};d.prototype.insertItem=function(b,a){throw Error("Operation not supported");};d.prototype.removeItem=function(b){throw Error("Operation not supported");};d.prototype.removeAt=function(b){throw Error("Operation not supported");};d.prototype.removeRange=
function(b,a){throw Error("Operation not supported");};d.prototype.clear=function(){throw Error("Operation not supported");};d.prototype.set=function(b){throw Error("Operation not supported");};d.prototype.sync=function(b){throw Error("Operation not supported");};d.prototype.equals=function(b){throw Error("Operation not supported");};return d}(ObservableCollection);f.FilterableCollection=l})(f.ui||(f.ui={}))})(c.framework||(c.framework={}))})(geocortex||(geocortex={}));
(function(c){(function(f){(function(f){(function(f){var h=function(){function d(b,a,e){this.id=new Observable;this.id.set(c.framework.utils.alphaNumericToken());this.displayName=new Observable(null===b||void 0===b?"":b);this.isSelected=new Observable(!!e);this.item=a||null}d.prototype.getId=function(){return this.id.get()};return d}();f.SelectorItemViewModel=h})(f.Selector||(f.Selector={}))})(f.ui||(f.ui={}))})(c.framework||(c.framework={}))})(geocortex||(geocortex={}));
(function(c){(function(f){(function(f){(function(f){var h=function(c){function b(){c.apply(this,arguments);this._itemViews=[]}__extends(b,c);b.prototype.attach=function(a){var b=this;c.prototype.attach.call(this,a);this.viewModel.singleSelect||dojo.attr(this.selectElement,"multiple","multiple");a.openState.bind(this,function(a){a&&(a={view:b,onOtherInteracted:function(a){return b.viewModel.openState.set(!1)}},b.app.command("TapToDismiss").execute(a),b.viewModel.openState.get()&&!b.viewModel.showNativeSelect.get()&&
b.positionCustomSelect())});a.items.bind(this,function(a){if(-1<["remove"].indexOf(a.type))for(var c=a.rangeStart;c<=a.rangeEnd;++c)for(var d=b._itemViews.length;d--;){var f=b._itemViews[d];f&&f.viewModel==a.sender.getAt(c)&&(b.app.viewManager.destroyView(f),b._itemViews.splice(d,1))}})};b.prototype.handleSelectionChange=function(a,b,c){var d=this;a=[];for(c=0;c<b.options.length;++c)a.push(b.options[c]);if(1>a.filter(function(a){return a.selected&&null==a.attributes["data-is-dummy"]}).length)return this.viewModel.unselectAll(),
!0;setTimeout(function(){var a=d.viewModel.items.get(),b=d.viewModel.getSelectedItems();a.map(function(a){-1<b.indexOf(a)?d.viewModel.selectItem(a.item,a):d.viewModel.unselectItem(a.item,a)});d.viewModel.singleSelect&&d.viewModel.toggleOpenState()});return!0};b.prototype.handleClickItem=function(a,b,c){if(c===this.viewModel.dummyItem)this.viewModel.unselectAll(),this.viewModel.toggleOpenState();else return this.viewModel.handleSelectionChange(null,c),this.viewModel.singleSelect&&this.viewModel.toggleOpenState(),
!0};b.prototype.handleClickSelector=function(a,b,c){this.viewModel.toggleOpenState();return!0};b.prototype.positionCustomSelect=function(){var a=this.customSelect;a.style.top="auto";a.style.left="auto";a.style.opacity="0";this.app.viewManager.activateView(this);var b=document.body.clientWidth,c=document.body.clientHeight,d=a.getBoundingClientRect();d.left+d.width>b&&(a.style.left=-1*d.width+"px");d.top+d.height>c&&(a.style.top=-1*d.height+"px");a.style.opacity="1"};b.prototype.resolveWidget=function(a,
b,c){if("SelectorItemWidget"===a)return(a=this.viewModel.templatePath)||(a="Framework.UI/geocortex/framework/ui/Selector/DefaultItemTemplate.html"),a=this.app.viewManager.createView({typeName:"geocortex.framework.ui.ViewBase",markupResource:a,isVisible:!0,libraryId:this.libraryId}),a.parentView=this,a.attach(b),this._itemViews.push(a),a};return b}(c.framework.ui.ViewBase);f.SelectorView=h})(f.Selector||(f.Selector={}))})(f.ui||(f.ui={}))})(c.framework||(c.framework={}))})(geocortex||(geocortex={}));
(function(c){(function(c){(function(c){(function(f){var k=function(c){function b(a,b,g,h){void 0===g&&(g=!0);void 0===h&&(h=!0);c.call(this,a,b);this.displayNameField="displayName";this.templatePath=this.dummyItemText=null;this.mobileMode=!0;this.singleSelect=g;this._selectedItems=new ObservableCollection;this.showSelectorHeader=new Observable(!1);this.showNativeSelect=new Observable(h);this.selectorText=new Observable("");this.noItemsText=new Observable("");this.openState=new Observable(this.showNativeSelect.get()&&
g);this.items=new ObservableCollection;this.selectedItems=new ObservableCollection;this.dummyItem=new f.SelectorItemViewModel}__extends(b,c);b.prototype.toggleOpenState=function(){this.showNativeSelect.get()&&this.singleSelect||this.openState.set(!this.openState.get())};b.prototype.setCollection=function(a,b,c){this.syncToken&&(this._underlyingCollection.unbind(this.syncToken),this.syncToken=null);this.displayNameField=b;this.templatePath=c;this.showSelectorHeader.set(!this.showNativeSelect.get()||
!this.singleSelect);this._underlyingCollection=a;this.syncToken=this._underlyingCollection.bind(this,this.handleUnderlyingCollectionChange);this.clear();this.items.addItems(this._adapt(this._underlyingCollection.get()))};b.prototype.clear=function(){this.items.clear();this.dummyItemText&&(this.dummyItem.displayName.set(this.dummyItemText),this.items.addItem(this.dummyItem))};b.prototype._adapt=function(a){var b=this,c=[];a.forEach(function(a){var d=new f.SelectorItemViewModel;a[b.displayNameField].isObservable?
d.displayName.set(a[b.displayNameField].get()):d.displayName.set(a[b.displayNameField]);d.item=a;c.push(d)});return c};b.prototype.handleUnderlyingCollectionChange=function(a){var b;switch(a.type){case "append":b=this._adapt(this._underlyingCollection.getRange(a.rangeStart,a.rangeEnd));this.items.addItems(b);break;case "insert":b=this._adapt(this._underlyingCollection.getRange(a.rangeStart,a.rangeEnd));this.items.insertItems(a.rangeStart,b);break;case "remove":this.items.removeRange(a.rangeStart,
a.rangeEnd);break;case "clear":this.clear();break;case "set":b=this._adapt(this._underlyingCollection.getRange(a.rangeStart,a.rangeEnd)),this.clear(),this.items.addItems(b)}};b.prototype.getViewModelForItem=function(a){for(var b=0;b<this.items.getLength();++b)if(this.items.getAt(b).item===a)return this.items.getAt(b);return null};b.prototype.getViewModelForSelectedItem=function(a){for(var b=0;b<this._selectedItems.getLength();++b)if(this._selectedItems.getAt(b).item===a)return this._selectedItems.getAt(b);
return null};b.prototype.getSelectedItems=function(){return this._selectedItems.get().slice()};b.prototype.hasItemViewModelFor=function(a){return!!this.getViewModelForItem(a)};b.prototype.selectItem=function(a,b){this._setItemSelectedState(a,b,!0)};b.prototype.unselectItem=function(a,b){this._setItemSelectedState(a,b,!1)};b.prototype.onSelectItem=function(a){};b.prototype.onUnselectItem=function(a){};b.prototype.handleSelectionChange=function(a,b){!0===a?this.selectItem(null,b):b.isSelected.get()?
this.unselectItem(null,b):this.selectItem(null,b)};b.prototype.unselectAll=function(a){var b=this;this._selectedItems.get().forEach(function(c){"string"!==typeof c&&!0===c.isSelected.get()&&(a&&a===c||b.unselectItem(null,c))});this.openState.get()&&!this.singleSelect&&this.openState.set(!1)};b.prototype._setItemSelectedState=function(a,b,c){b=b||this.getViewModelForItem(a);if(!b)throw Error("Tried to select an item in a Framework UI selector but item was not part of bound collection.");this.singleSelect&&
c&&this.unselectAll(b);if(b.isSelected.get()!==c)if(b.isSelected.set(c),c?this._selectedItems.addItem(b):this._selectedItems.removeItem(b),c&&this.onSelectItem)this.onSelectItem(b);else if(!c&&this.onUnselectItem)this.onUnselectItem(b)};return b}(c.ViewModelBase);f.SelectorViewModel=k})(c.Selector||(c.Selector={}))})(c.ui||(c.ui={}))})(c.framework||(c.framework={}))})(geocortex||(geocortex={}));
(function(c){(function(f){(function(f){var l=function(f){function d(b,a){f.call(this,b);this._sorter=null;a&&this.setSortFunction(a)}__extends(d,f);d.prototype.setSortFunction=function(b){if(this._sorter!==b){var a=this.length();if(b){var e=new c.framework.events.CollectionChangedArgs;e.type="clear";e.rangeStart=0;e.rangeEnd=a-1;e.sender=this;this.bindingEvent.publish(e)}if(this._sorter=b)f.prototype.get.call(this).sort(this._sorter),e=new c.framework.events.CollectionChangedArgs,e.type="append",
e.rangeStart=0,e.rangeEnd=a-1,e.sender=this,this.bindingEvent.publish(e)}};d.prototype.getSortFunction=function(){return this._sorter};d.prototype.addItems=function(b){if(this._sorter)if(0===this.length())f.prototype.addItems.call(this,b.concat().sort(this._sorter));else for(var a=0;a<b.length;a++)this.addItem(b[a]);else f.prototype.addItems.call(this,b)};d.prototype.addItem=function(b){if(this._sorter){for(var a=0,c=f.prototype.length.call(this);a<c&&0>this._sorter(f.prototype.getAt.call(this,a),
b);a++);a>=c?f.prototype.addItem.call(this,b):f.prototype.insertItem.call(this,a,b)}else f.prototype.addItem.call(this,b)};d.prototype.set=function(b){this._sorter?f.prototype.set.call(this,b.concat().sort(this._sorter)):f.prototype.set.call(this,b)};d.prototype.sync=function(b){this._unsortedSyncToken&&this._unsortedSyncSource&&(this._unsortedSyncSource.bindingEvent.unsubscribe(this._unsortedSyncToken),this._unsortedSyncToken=this._unsortedSyncSource=null);b&&b.bindingEvent&&(this.clear(),this.addItems(b.getRange(0,
b.length()-1)),this._unsortedSyncSource=b,this._unsortedSyncToken=b.bindingEvent.subscribe(this,this._onSyncedCollectionChanged))};d.prototype._onSyncedCollectionChanged=function(b){switch(b.type){case "set":this.set(b.sender.getRange(b.rangeStart,b.rangeEnd));break;case "append":case "insert":this.addItems(b.sender.getRange(b.rangeStart,b.rangeEnd));break;case "remove":for(var a=b.rangeStart;a<=b.rangeEnd;a++)this.removeItem(b.sender.getAt(a));break;case "clear":this.clear();break;default:throw Error("Unhandled case: "+
b.type);}};d.prototype.insertItems=function(b,a){throw Error("Direct insertion is not supported");};d.prototype.insertItem=function(b,a){throw Error("Direct insertion is not supported");};return d}(ObservableCollection);f.OrderedCollection=l})(f.ui||(f.ui={}))})(c.framework||(c.framework={}))})(geocortex||(geocortex={}));
(function(c){(function(c){(function(c){(function(f){var k=function(c){function b(){c.apply(this,arguments)}__extends(b,c);b.prototype.attach=function(a){var b=this;c.prototype.attach.call(this,a);this.app.event("DataFrameOpenedEvent").subscribe(this,function(){return b._yield(function(){return b._updateLabels()})});this.app.event("PanelResizeEndEvent").subscribe(this,function(){return b._yield(function(){return b._updateLabels()})});this.viewModel.activeViewDescriptors.bind(this,function(a){var c=
b.viewModel.activeViewDescriptors.getLength();"remove"===a.type?c-=a.rangeEnd-a.rangeStart+1:"clear"===a.type&&(c=0);b._updateLabels(c)})};b.prototype.handleClickTab=function(a,b,c){(a=c.view)&&this.app.viewManager.activateView(a)};b.prototype._updateLabels=function(a){a=a||this.viewModel.activeViewDescriptors.getLength();var b=$(this.buttonTabStripElement);75<b.width()/a?b.removeClass("no-label"):b.addClass("no-label")};b.prototype._yield=function(a){return setTimeout(a,0)};return b}(c.ViewBase);
f.ButtonTabStripView=k})(c.ViewContainer||(c.ViewContainer={}))})(c.ui||(c.ui={}))})(c.framework||(c.framework={}))})(geocortex||(geocortex={}));
(function(c){(function(c){(function(c){(function(c){function f(b,a,c){if(a)if(b.allLibrariesLoaded)for(var g=0;g<c.length;g++){var d=c[g].get();d&&9<d.length&&"@language"==d.substring(0,9)&&c[g].set(b.getResource(a,d.substring(1)))}else b.event("ViewerLibrariesDownloadedEvent").once(this,function(){f(b,a,c)})}function d(b,a,c,g){if(a&&c&&g)if(b.allLibrariesLoaded)c&&9<c.length&&"@language"==c.substring(0,9)?g(b.getResource(a,c.substring(1))):g(c);else var f=b.event("ViewerLibrariesDownloadedEvent").subscribe(this,
function(){b.event("ViewerLibrariesDownloadedEvent").unsubscribe(f);d(b,a,c,g)})}c.localizeObservables=f;c.localizeString=d})(c.stringLocalizer||(c.stringLocalizer={}))})(c.ui||(c.ui={}))})(c.framework||(c.framework={}))})(geocortex||(geocortex={}));
(function(c){(function(c){(function(c){(function(c){function f(b,a,c,g){var d=!1,h="tapToDismiss"+a.id;a.root===b.target?d=!0:$(b.target).parents().each(function(b){this===a.root&&(d=!0)});d?c?g&&g(b):a.app.viewManager.deactivateView(a):($(document.body).off("mousedown."+h+" touchstart."+h),c&&c(b))}var d=null;c.detectBrowserPrefix=function(b){if(!b&&null!==d)return d;var a=b?b.toLowerCase():navigator.userAgent.toLowerCase(),a=/opera/.exec(a)||/(msie|trident)/.exec(a)||/firefox/.exec(a)||/(chrome|safari|webkit)/.exec(a),
c={opera:"O",chrome:"webkit",safari:"webkit",webkit:"webkit",firefox:"Moz",msie:"ms",trident:"ms"},a=a?c[a[0]]||"":"";b||(d=a);return a};c.tapToDismissThis=function(b,a,c){if(b){var g="tapToDismiss"+b.id;$(document.body).off("mousedown."+g+" touchstart."+g);$(document.body).on("mousedown."+g+" touchstart."+g,function(g){return f(g,b,a,c)})}}})(c.utils||(c.utils={}))})(c.ui||(c.ui={}))})(c.framework||(c.framework={}))})(geocortex||(geocortex={}));
(function(c){(function(c){(function(c){(function(c){var f=function(){return function(c,b,a,e){this.containerViewId=c;this.viewId=b;this.xButtonClicked=a;this.backButtonClicked=e}}();c.ViewContainerViewClosedEventArgs=f})(c.ViewContainer||(c.ViewContainer={}))})(c.ui||(c.ui={}))})(c.framework||(c.framework={}))})(geocortex||(geocortex={}));
(function(c){(function(f){(function(f){(function(l){var k=function(d){function b(a,b){d.call(this,a,b);this._active=this._hasDiscoveredRegions=!1;this._keyDownEventToken=null;this._activatingForViewInContainer=!1;this.headerInsertDomElement=new Observable(null);this.footerInsertDomElement=new Observable(null);this.scrollContainerTop=new Observable(0);this.scrollContainerBottom=new Observable(0);this.app.eventRegistry.event("ViewActivatedInContainerEvent").subscribe(this,this._handleViewActivatedInContainerEvent);
this.app.event("RegionActivatedEvent").subscribe(this,this.handleRegionActivatedEvent);this.app.event("RegionDeactivatedEvent").subscribe(this,this.handleRegionDeactivatedEvent);this.app.event("ViewDimensionsChangedEvent").subscribe(this,this.resize);this.app.event("SiteInitializedEvent").once(this,this.delayedResize)}__extends(b,d);b.prototype.attach=function(a){var b=this;d.prototype.attach.call(this,a);this.title.sync(this.viewModel.viewTitle);this.headerInsertDomElement.sync(this.viewModel.headerInsertDomElement);
this.footerInsertDomElement.sync(this.viewModel.footerInsertDomElement);this.viewModel.headerIsVisible.bind(this,function(a){return b.delayedResize()});this.delayedResize()};b.prototype.resize=function(){if(this.headerElement&&this.scrollRegionElement&&this.containerElement){var a=$(this.scrollRegionElement),b=$(this.headerElement),c=$(this.footerElement),b=b.length&&"none"!==b.css("display")?b.outerHeight():0,c=c.length&&"none"!==c.css("display")?c.outerHeight():0;"relative"!==a.css("position")&&
a.css("top",b+"px");a.css("bottom",c+"px")}};b.prototype.delayedResize=function(){var a=this;setTimeout(function(){a.resize()},1)};b.prototype.getZerothView=function(){for(var a=0;a<this.viewModel.viewDescriptors.getLength();++a){var b=this.viewModel.viewDescriptors.getAt(a);if(0===this.viewModel.getViewPriority(b.view.id))return b.view}return null};b.prototype.activated=function(){d.prototype.activated.call(this);if(!this._active&&this.viewModel&&!this._activatingForViewInContainer){this._activatingForViewInContainer=
!1;this._active=!0;var a=this.getZerothView();if(a&&!a.isActive)this.app.viewManager.activateView(a),this._active=!0;else var b=this.viewModel.viewDescriptors.bind(this,function(a){(a=a.sender.getAt(0))&&0===this.viewModel.getViewPriority(a.view.id)&&(a.view.isActive||this.app.viewManager.activateView(a.view),this.viewModel.viewDescriptors.unbind(b))})}this.viewModel&&this.viewModel.showOrHideCloseButtons();this.viewModel&&this.viewModel.closeOnEscape&&(this._keyDownEventToken=dojo.connect(document,
"keydown",this,this._documentKeyDown));this.app.event("ViewContainerActivatedEvent").publish(this);this.delayedResize()};b.prototype.deactivated=function(){d.prototype.deactivated.call(this);this._activatingForViewInContainer=!1;this._keyDownEventToken&&(dojo.disconnect(this._keyDownEventToken),this._keyDownEventToken=null);this.app.event("ViewContainerDeactivatedEvent").publish(this)};b.prototype.activateContainer=function(){this._active=!0;this.regionName&&this.app.viewManager.activateView(this)};
b.prototype.deactivateContainer=function(){this._active=!1;this.app.viewManager.deactivateView(this)};b.prototype.handleScrollChange=function(a,b,c){c.getDescriptorForActiveView(c.currentView).scrollTop=b.scrollTop};b.prototype.handleRegionActivatedEvent=function(a){this.viewModel&&a.name===this.viewModel.regionName.get()&&this.activateContainer()};b.prototype.handleRegionDeactivatedEvent=function(a){this.viewModel&&a.name===this.viewModel.regionName.get()&&this.deactivateContainer()};b.prototype.handleClickBack=
function(a,b,c){c.currentView&&(a=c.currentView,this._closeCurrentView(c),this._broadcastClosedEvent(a,!1,!0))};b.prototype.handleClickClose=function(a,b,c){c.currentView&&(a=c.currentView,this._closeCurrentView(c),this._broadcastClosedEvent(a,!0,!1))};b.prototype.handleClickTab=function(a,b,c){(a=c.view)&&this.app.command("ActivateView").execute(a.id)};b.prototype.handleClickCloseTab=function(a,b,c){(a=c.view)&&this.app.viewManager.destroyView(a)};b.prototype._documentKeyDown=function(a){27===a.keyCode&&
this.viewModel&&(a=this.viewModel.currentView,this._closeCurrentView(this.viewModel),this._broadcastClosedEvent(a,!0,!1))};b.prototype._handleViewActivatedInContainerEvent=function(a){var b=this;this._activatingForViewInContainer=!1;var c=null;if(this.viewModel&&(c=this.viewModel.getDescriptorForActiveView(a))){this._activatingForViewInContainer=!0;this.regionName&&this.app.viewManager.activateView(this);var d=void 0===c.scrollTop?0:c.scrollTop;"FeatureDetailsView"!=c.view.id&&"EditorView"!=c.view.id&&
setTimeout(function(){dojo.style(b.scrollRegionElement,"scrollTop",d);b.scrollRegionElement.scrollTop=d},0);this.delayedResize()}};b.prototype._closeCurrentView=function(a){a.closeCurrentView()};b.prototype._broadcastClosedEvent=function(a,b,d){a=new c.framework.ui.ViewContainer.ViewContainerViewClosedEventArgs(this.id,a.id,b,d);this.app.event("ViewContainerViewClosedEvent").publish(a)};return b}(f.ViewBase);l.ViewContainerView=k})(f.ViewContainer||(f.ViewContainer={}))})(f.ui||(f.ui={}))})(c.framework||
(c.framework={}))})(geocortex||(geocortex={}));
(function(c){(function(f){(function(f){(function(l){var k=function(d){function b(a,b){d.call(this,a,b);this.regionName=new Observable("");this.regionType=new Observable(null);this.headerIsVisible=new Observable(!0);this.titleBarIsVisible=new Observable(!0);this.hasCustomHeaderComponent=new Observable(!1);this.hasCustomFooterComponent=new Observable(!1);this.showingBackButton=new Observable(!0);this.showBusyIndicator=new Observable(!1);this.showHostedViews=new Observable(!1);this.showingXButton=new Observable(!0);
this.containerTitle=new Observable("");this.containerManagedTitle=new Observable("");this.viewTitle=new Observable("");this.closeTitle=new Observable("");this.backTitle=new Observable("");this.fullTitle=new Observable("");this.viewDescriptors=new ObservableCollection;this.activeViewDescriptors=new ObservableCollection;this.headerInsertDomElement=new Observable(null);this.footerInsertDomElement=new Observable(null);this.managedViewsOnly=!1;this._viewDescriptorConstructor=this.defaultViewIconUri=null;
this._activeViews={};this._insertedViews=[];this._ordering={};this._showBackButtonAsX=this._showBackButton=this._backButtonOnRootView=!0;this._showHeaderForStandaloneViews=this._originalHeaderIsVisibleSetting=!1;this._fullTitleFormatString="{0} - {1}";var c=this.app.viewManager.getExistingRegionByName(this.regionName.get());if(c)for(var f=0;f<c.views.length;++f)this._addOrderedView(this.createDescriptorForView(c.views[f]));this.app.event("ViewHostedEvent").subscribe(this,this.handleViewHosted);this.app.event("ViewUnhostedEvent").subscribe(this,
this.handleViewUnhosted);this.app.event("ViewActivatedEvent").subscribe(this,this.handleViewActivatedEvent);this.app.event("ViewDeactivatedEvent").subscribe(this,this.handleViewDeactivatedEvent)}__extends(b,d);b.prototype.initialize=function(a){var b=this;this.regionName.set(a.containerRegionName);this.regionType.set(a.containerRegionType||"geocortex.framework.ui.MultiDivRegionAdapter");this.containerTitle.set(a.containerTitle||null);this.containerManagedTitle.set(a.containerManagedTitle||null);this.defaultViewIconUri=
a.defaultViewIcon||null;this.containerTitle.get()&&this.viewTitle.sync(this.containerTitle);this._originalHeaderIsVisibleSetting=null!==a.headerIsVisible&&void 0!==a.headerIsVisible?!!a.headerIsVisible:!0;this._showHeaderForStandaloneViews=!!a.showHeaderForStandaloneViews;this.headerIsVisible.set(this._originalHeaderIsVisibleSetting);this.showHostedViews.set(!!a.showHostedViews);this._ordering=a.ordering||{};this._backButtonOnRootView=a.backButtonOnRootView;this._showBackButtonAsX=a.showBackButtonAsX;
this.closeOnEscape=!!a.closeOnEscape;this._viewDescriptorConstructor=a.viewDescriptor||null;var c=function(d,f){if(a["{0}InsertMarkup".format(d)])try{var h={markupResource:a["{0}InsertMarkup".format(d)],typeName:a["{0}InsertType".format(d)]};if(a["{0}InsertLibraryId".format(d)]){if(!b.app.allLibrariesLoaded){var l=b.app.event("ViewerLibrariesDownloadedEvent").subscribe(b,function(){b.app.event("ViewerLibrariesDownloadedEvent").unsubscribe(l);c(d,f)});return}h.libraryId=a["{0}InsertLibraryId".format(d)]}var k=
b.app.viewManager.createView(h);k.attach(b);b._insertedViews.push(k);f.set(k.root)}catch(n){b.app.trace.error("Could not create view {0} container insert: {1}".format(d,n.toString()))}};c("header",this.headerInsertDomElement);c("footer",this.footerInsertDomElement)};b.prototype.createDescriptorForView=function(a){if(this._viewDescriptorConstructor){var b=dojo.getObject(this._viewDescriptorConstructor);if(b)return new b(a,this);this.app.trace.error("Couldn't find viewDescriptor type: "+this._viewDescriptorConstructor);
this._viewDescriptorConstructor=null}return new l.ViewDescriptor(a,this)};b.prototype.getDescriptorForView=function(a){for(var b=0;b<this.viewDescriptors.getLength();++b){var c=this.viewDescriptors.getAt(b);if(c.view===a)return c}return null};b.prototype.getDescriptorForActiveView=function(a){for(var b=0;b<this.activeViewDescriptors.getLength();++b){var c=this.activeViewDescriptors.getAt(b);if(c.view===a)return c}return null};b.prototype.handleViewHosted=function(a){if((!this.managedViewsOnly||a.view.isManaged)&&
a.region.name===this.regionName.get()){var b=this.getDescriptorForView(a.view);b||(b=this.createDescriptorForView(a.view),this._addOrderedView(b),this.showHostedViews.get()&&(this.getDescriptorForActiveView(a.view)||this.insertActiveViewDescriptor(b)))}};b.prototype.handleViewUnhosted=function(a){a.region.name===this.regionName.get()&&(a=this.getDescriptorForView(a.view))&&(this.viewDescriptors.removeItem(a),this.showHostedViews.get()||this.activeViewDescriptors.removeItem(a))};b.prototype.handleViewActivatedEvent=
function(a){if(!this.managedViewsOnly||a.isManaged){var b=this.app.viewManager.getRegionForViewId(a.id);b&&b.name===this.regionName.get()&&(b=this.getDescriptorForView(a),b||(b=this.createDescriptorForView(a),this._addOrderedView(b)),this._activeViews[a.id]=!0,this.app.trace.debug("--- Activated view {0}".format(a.id)),this.activateViewInContainer(a))}};b.prototype.handleViewDeactivatedEvent=function(a){var b=this.app.viewManager.getRegionForViewId(a.id);b&&b.name===this.regionName.get()&&(this._activeViews[a.id]=
!1,(b=this.getDescriptorForView(a))&&!this.showHostedViews.get()&&this.activeViewDescriptors.removeItem(b),this.app.trace.debug("--- Deactivated view {0}".format(a.id)),this.deactivateViewInContainer(a))};b.prototype.activateViewInContainer=function(a){this.deactivateViews();this.currentView=a;var b=this.getDescriptorForView(a);b?(b.isActive.set(!0),b.cssClass.set("tab-active")):a.isManaged&&(b=this.createDescriptorForView(a),b.isActive.set(!0),b.cssClass.set("tab-active"),this._addOrderedView(b));
this.getDescriptorForActiveView(a)||this.insertActiveViewDescriptor(b);this.app.event("ViewActivatedInContainerEvent").publish(a);!this._showHeaderForStandaloneViews||a instanceof c.framework.ui.ViewContainer.ViewContainerView?this.headerIsVisible.set(this._originalHeaderIsVisibleSetting):this.headerIsVisible.set(!0);this.showOrHideCloseButtons();this.containerTitle.get()||this.viewTitle.sync(a.title);this.backTitle.set(this.app.getResource(this.libraryId,"language-framework-ui-view-container-view-back").format(this.viewTitle.get()));
this.closeTitle.set(this.app.getResource(this.libraryId,"language-framework-ui-view-container-view-close").format(this.viewTitle.get()));this.showBusyIndicator.sync(a.isBusy)};b.prototype.showOrHideCloseButtons=function(){var a=this.viewDescriptors.getAt(0);a&&(this.currentView===a.view?this._backButtonOnRootView?(this.showingXButton.set(this._showBackButtonAsX),this.showingBackButton.set(!this._showBackButtonAsX)):(this.showingBackButton.set(!1),this.showingXButton.set(!1)):this.currentView&&this.currentView.hasOwnProperty("configuration")&&
this.currentView.configuration.hasOwnProperty("showXButton")?(this.showingXButton.set(this.currentView.configuration.showXButton),this.showingBackButton.set(!1)):(this.showingXButton.set(this._showBackButtonAsX),this.showingBackButton.set(!this._showBackButtonAsX)))};b.prototype.deactivateViewInContainer=function(a){if(a=this.getDescriptorForView(a))a.isActive.set(!1),a.cssClass.set("tab-inactive"),this.showHostedViews.get()||this.activeViewDescriptors.removeItem(a);this.showOrHideCloseButtons()};
b.prototype.closeCurrentView=function(){var a=this.getDescriptorForView(this.currentView);a&&!this.showHostedViews.get()&&this.activeViewDescriptors.removeItem(a);this.deactivateCurrentView()};b.prototype.deactivateCurrentView=function(){this.currentView&&this.app.viewManager.deactivateView(this.currentView)};b.prototype.deactivateViews=function(){for(var a=0;a<this.viewDescriptors.getLength();++a){var b=this.viewDescriptors.getAt(a);b.isActive.set(!1);b.cssClass.set("tab-inactive")}};b.prototype.getViewPriority=
function(a){return this._ordering.hasOwnProperty(a)?parseInt(this._ordering[a]):null};b.prototype._addOrderedView=function(a){var b=a.view,c=this.getDescriptorForActiveView(b);if(this._ordering){var d=b.id;if(d)if(d=this.getViewPriority(d),a.priority=d,null===d||void 0===d)a.priority=this.activeViewDescriptors.getLength()+1,this.viewDescriptors.addItem(a),b.isActive&&!c&&this.insertActiveViewDescriptor(a);else{for(var c=!1,f=0;f<this.viewDescriptors.getLength();++f){var h=this.viewDescriptors.getAt(f).view,
h=this.getViewPriority(h.id);if(null===h||d<=h){c=!0;this.viewDescriptors.insertItem(f,a);break}}c||this.viewDescriptors.addItem(a);b.isActive&&this.insertActiveViewDescriptor(a)}else this.viewDescriptors.addItem(a),b.isActive&&!c&&this.insertActiveViewDescriptor(a)}else this.viewDescriptors.addItem(a),b.isActive&&!c&&this.insertActiveViewDescriptor(a)};b.prototype.insertActiveViewDescriptor=function(a){for(var b=0;b<this.activeViewDescriptors.getLength();++b){var c=this.activeViewDescriptors.getAt(b);
if(a.priority<c.priority){this.activeViewDescriptors.insertItem(b,a);return}}this.activeViewDescriptors.addItem(a)};b.prototype.dispose=function(){for(var a=0;a<this._insertedViews.length;a++)this.app.viewManager.destroyView(this._insertedViews[a]);this._insertedViews.length=0};return b}(f.ViewModelBase);l.ViewContainerViewModel=k})(f.ViewContainer||(f.ViewContainer={}))})(f.ui||(f.ui={}))})(c.framework||(c.framework={}))})(geocortex||(geocortex={}));
(function(c){(function(c){(function(c){(function(f){var k=function(){return function(d,b){this.containerTitle=new Observable(null);this.isBusy=new Observable(null);this.isActive=new Observable(!1);this.cssClass=new Observable("tab-inactive");this.view=d;this.iconUri=d.iconUri.get()?d.iconUri:new Observable(b.defaultViewIconUri);this.title=d.title;this.isBusy=d.isBusy;this.priority=1;!0===d instanceof c.ViewContainer.ViewContainerView&&(this.containerTitle.set(d.viewModel.containerTitle.get()),d.viewModel.containerManagedTitle.get()&&
(this.title=d.viewModel.containerManagedTitle))}}();f.ViewDescriptor=k})(c.ViewContainer||(c.ViewContainer={}))})(c.ui||(c.ui={}))})(c.framework||(c.framework={}))})(geocortex||(geocortex={}));
(function(c){(function(c){(function(c){(function(f){var k=function(c){function b(){c.apply(this,arguments)}__extends(b,c);b.prototype.handleClickTab=function(a,b,c){(a=c.view)&&this.app.viewManager.activateView(a)};return b}(c.ViewBase);f.ViewSwitcherView=k})(c.ViewSwitcher||(c.ViewSwitcher={}))})(c.ui||(c.ui={}))})(c.framework||(c.framework={}))})(geocortex||(geocortex={}));geocortex||(geocortex={});geocortex.essentialsHtmlViewer||(geocortex.essentialsHtmlViewer={});
geocortex.essentialsHtmlViewer.version="2.7.2.0026";geocortex.resourceManager.register("Framework.UI","inv","Framework.UI/geocortex/framework/ui/MultiRegion/MultiRegionView.html","html","PGRpdiBjbGFzcz0ibXVsdGktcmVnaW9uLXZpZXciIGRhdGEtYmluZGluZz0ie0B2YXI6IG11bHRpUmVnaW9uVmlld0VsZW1lbnR9e0Bzb3VyY2U6IHJlZ2lvbkRlc2NyaXB0b3JzfSI+IDxkaXYgZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLWZvcjogcmVnaW9uRGVzY3JpcHRvcnN9e2NsYXNzOiByZWdpb25Dc3N9Ij4gPGRpdiBjbGFzcz0icmVnaW9uLXZpZXctc3dpdGNoZXIiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBkaXNwbGF5UmVnaW9uVmlld1N3aXRjaGVyfXtAd2lkZ2V0OiBSZWdpb25WaWV3U3dpdGNoZXJXaWRnZXR9e0B3aWRnZXQtY29udGV4dDogdmlld1N3aXRjaGVyVmlld01vZGVsfXtAd2lkZ2V0LXJlcXVpcmVkOiBmYWxzZX0iPjwvZGl2PiA8ZGl2IGNsYXNzPSJyZWdpb24iIGRhdGEtYmluZGluZz0ie2RhdGEtcmVnaW9uLW5hbWU6IHJlZ2lvbk5hbWV9e2RhdGEtcmVnaW9uLWFkYXB0ZXI6IHJlZ2lvblR5cGV9Ij48L2Rpdj4gPC9kaXY+IDwvZGl2PiA=");
geocortex.resourceManager.register("Framework.UI","inv","Framework.UI/geocortex/framework/ui/Selector/DefaultItemTemplate.html","html","PGxpIGNsYXNzPSJzZWxlY3Rvci1pdGVtIHNpbmdsZS1zZWxlY3QiPiA8ZGl2IGRhdGEtYmluZGluZz0ie0BldmVudC1vbmNsaWNrOiBoYW5kbGVDbGlja0l0ZW19e0BldmVudC10b3VjaHN0YXJ0OiBoYW5kbGVDbGlja0l0ZW19Ij4gPGlucHV0IGNsYXNzPSJzZWxlY3Rvci1jaGVja2JveCIgZGF0YS1iaW5kaW5nPSJ7aWQ6IGlkfXtjaGVja2VkOiBpc1NlbGVjdGVkfSIgdHlwZT0iY2hlY2tib3giIC8+IDxsYWJlbCBkYXRhLWJpbmRpbmc9IntAdGV4dDogZGlzcGxheU5hbWV9e2ZvcjogaWR9Ij48L2xhYmVsPiA8L2Rpdj4gPC9saT4g");
geocortex.resourceManager.register("Framework.UI","inv","Framework.UI/geocortex/framework/ui/Selector/SelectorView.html","html","PGRpdiBjbGFzcz0iZnVpLXNlbGVjdG9yIiBkYXRhLWJpbmRpbmc9IntAY2xhc3MtZXhwYW5kZWQ6IG9wZW5TdGF0ZX0iPiA8ZGl2IGNsYXNzPSJmdWktc2VsZWN0b3ItaGVhZGVyIiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogc2hvd1NlbGVjdG9ySGVhZGVyfXtAbm9jbGFzcy1uby1zZWxlY3Rvci1pdGVtczogaXRlbXN9Ij4gPGJ1dHRvbiBkYXRhLWJpbmRpbmc9IntAZXZlbnQtb25jbGljazogaGFuZGxlQ2xpY2tTZWxlY3Rvcn17QHZpc2libGU6IGl0ZW1zfSI+PHNwYW4gZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IHNlbGVjdG9yVGV4dH0iPjwvc3Bhbj48L2J1dHRvbj4gPHNwYW4gZGF0YS1iaW5kaW5nPSJ7QGhpZGRlbjogaXRlbXN9e0B0ZXh0OiBub0l0ZW1zVGV4dH0iPjwvc3Bhbj4gPC9kaXY+IDxkaXYgZGF0YS1iaW5kaW5nPSJ7QHZpc2libGU6IG9wZW5TdGF0ZX0iPiA8dWwgY2xhc3M9ImZ1aS1zZWxlY3Rvci1ib2R5IiBkYXRhLWJpbmRpbmc9IntAaGlkZGVuOnNob3dOYXRpdmVTZWxlY3R9e0Bzb3VyY2U6IGl0ZW1zfXtAY2xhc3MtZXhwYW5kZWQ6IG9wZW5TdGF0ZX17QHZhcjogY3VzdG9tU2VsZWN0fSI+IDxsaSBjbGFzcz0iZnVpLXNlbGVjdG9yLWl0ZW0iIGRhdGEtYmluZGluZz0ie0B0ZW1wbGF0ZS1mb3I6IGl0ZW1zfXtAd2lkZ2V0OiBTZWxlY3Rvckl0ZW1XaWRnZXR9e0B3aWRnZXQtY29udGV4dDogQGNvbnRleHR9e0B3aWRnZXQtcmVwbGFjZTogdHJ1ZX0iIC8+IDwvdWw+IDxzZWxlY3QgY2xhc3M9ImZ1aS1zZWxlY3Rvci1ib2R5IiBkYXRhLWJpbmRpbmc9IntAY2xhc3MtZXhwYW5kZWQ6IG9wZW5TdGF0ZX17QHZpc2libGU6IHNob3dOYXRpdmVTZWxlY3R9e0B2YXI6IHNlbGVjdEVsZW1lbnR9e0Bzb3VyY2U6IGl0ZW1zfXtAdmFsdWU6IF9zZWxlY3RlZEl0ZW1zfQ0KICAgICAgICAgICAge0BldmVudC1vbmNoYW5nZTogaGFuZGxlU2VsZWN0aW9uQ2hhbmdlfSI+IDxvcHRpb24gZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLWZvcjogaXRlbXN9e0BldmVudC1vbmNsaWNrOiBoYW5kbGVDbGlja0l0ZW19e0B0ZXh0OiBkaXNwbGF5TmFtZX17QGF0dGFjaDpAY29udGV4dH0iPjwvb3B0aW9uPiA8L3NlbGVjdD4gPC9kaXY+IDwvZGl2PiA=");
geocortex.resourceManager.register("Framework.UI","inv","Framework.UI/geocortex/framework/ui/SplashScreen/SplashScreenView.html","html","PGRpdiBjbGFzcz0ic3BsYXNoLXNjcmVlbiI+PC9kaXY+IA==");geocortex.resourceManager.register("Framework.UI","inv","Framework.UI/geocortex/framework/ui/ViewContainer/ButtonTabStripView.html","html","DQo8ZGl2IGNsYXNzPSJidXR0b24tdGFiLXN0cmlwIiBkYXRhLWJpbmRpbmc9IntAdmFyOiBidXR0b25UYWJTdHJpcEVsZW1lbnR9Ij4gPGRpdiBkYXRhLWJpbmRpbmc9IntAc291cmNlOiBhY3RpdmVWaWV3RGVzY3JpcHRvcnN9Ij4gPGJ1dHRvbiBkYXRhLWJpbmRpbmc9IntAdGVtcGxhdGUtZm9yOiBhY3RpdmVWaWV3RGVzY3JpcHRvcnN9e0BldmVudC1vbmNsaWNrOiBoYW5kbGVDbGlja1RhYn17Y2xhc3NOYW1lOiBjc3NDbGFzc317dGl0bGU6IHRpdGxlfSI+IDxpbWcgY2xhc3M9InRhYi1zdHJpcC1pY29uIiBkYXRhLWJpbmRpbmc9IntzcmM6IGljb25Vcml9e0B2aXNpYmxlOiBpY29uVXJpfSIgYWx0PSIgIiAvPiA8cCBjbGFzcz0idGFiLXN0cmlwLWxhYmVsIiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogdGl0bGV9e0B0ZXh0OiB0aXRsZX0iPjwvcD4gPC9idXR0b24+IDwvZGl2PiA8L2Rpdj4g");
geocortex.resourceManager.register("Framework.UI","inv","Framework.UI/geocortex/framework/ui/ViewContainer/ViewContainerView.html","html","PGRpdiBjbGFzcz0idmlldy1jb250YWluZXItdmlldyIgZGF0YS1iaW5kaW5nPSJ7QHZhcjogY29udGFpbmVyRWxlbWVudH0iPiA8ZGl2IGNsYXNzPSJwYW5lbC1oZWFkZXIiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBoZWFkZXJJc1Zpc2libGV9e0B2YXI6IGhlYWRlckVsZW1lbnR9Ij4gPGRpdiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogdGl0bGVCYXJJc1Zpc2libGV9Ij4gPGJ1dHRvbiBjbGFzcz0icGFuZWwtaGVhZGVyLWJ1dHRvbiByaWdodCBjbG9zZS0xNiIgZGF0YS1iaW5kaW5nPSJ7QHZpc2libGU6IHNob3dpbmdYQnV0dG9ufXtAZXZlbnQtb25jbGljazogaGFuZGxlQ2xpY2tDbG9zZX17dGl0bGU6IGNsb3NlVGl0bGV9Ij48L2J1dHRvbj4gPGJ1dHRvbiBjbGFzcz0icGFuZWwtaGVhZGVyLWJ1dHRvbiBsZWZ0IGJhY2stMTYiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBzaG93aW5nQmFja0J1dHRvbn17QGV2ZW50LWNsaWNrOiBoYW5kbGVDbGlja0JhY2t9e3RpdGxlOiBiYWNrVGl0bGV9Ij48L2J1dHRvbj4gPGgyIGNsYXNzPSJwYW5lbC10aXRsZSI+IDxpbWcgc3JjPSJSZXNvdXJjZXMvSW1hZ2VzL2xvYWRlci1zbWFsbC5naWYiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBzaG93QnVzeUluZGljYXRvcn0iIGFsdD0iICIgLz4gPHNwYW4gZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IGNvbnRhaW5lclRpdGxlfXtAdmlzaWJsZTogY29udGFpbmVyVGl0bGV9Ij48L3NwYW4+IDxzcGFuIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBjb250YWluZXJUaXRsZX0iPiZuYnNwOy0mbmJzcDs8L3NwYW4+IDxzcGFuIGRhdGEtYmluZGluZz0ie0B0ZXh0OiB2aWV3VGl0bGV9e0B2aXNpYmxlOiB2aWV3VGl0bGV9Ij48L3NwYW4+IDwvaDI+IDwvZGl2PiA8ZGl2IGRhdGEtYmluZGluZz0ie0Bkb206IGhlYWRlckluc2VydERvbUVsZW1lbnR9Ij48L2Rpdj4gPC9kaXY+IDxkaXYgY2xhc3M9InBhbmVsLXNjcm9sbC1jb250YWluZXIiIGRhdGEtYmluZGluZz0ie2RhdGEtcmVnaW9uLW5hbWU6IHJlZ2lvbk5hbWV9e2RhdGEtcmVnaW9uLWFkYXB0ZXI6IHJlZ2lvblR5cGV9e0B2YXI6IHNjcm9sbFJlZ2lvbkVsZW1lbnR9e0BldmVudC1vbnNjcm9sbDogaGFuZGxlU2Nyb2xsQ2hhbmdlfSI+PC9kaXY+IDxkaXYgY2xhc3M9InBhbmVsLWZvb3RlciIgZGF0YS1iaW5kaW5nPSJ7QHZhcjogZm9vdGVyRWxlbWVudH17QHZpc2libGU6IGZvb3Rlckluc2VydERvbUVsZW1lbnR9IiBzdHlsZT0icG9zaXRpb246IGFic29sdXRlIj4gPGRpdiBjbGFzcz0icGFuZWwtZm9vdGVyLWlubmVyIiBkYXRhLWJpbmRpbmc9IntAZG9tOiBmb290ZXJJbnNlcnREb21FbGVtZW50fSI+PC9kaXY+IDwvZGl2PiA8L2Rpdj4g");
geocortex.resourceManager.register("Framework.UI","inv","Framework.UI/geocortex/framework/ui/ViewSwitcher/ViewSwitcherView.html","html","PGRpdiBjbGFzcz0idGFiLWNvbnRhaW5lciI+IDx1bCBjbGFzcz0idGFiLWNvbnRyb2wiIGRhdGEtYmluZGluZz0ie0Bzb3VyY2U6IHZpZXdEZXNjcmlwdG9yc30iPiA8bGkgZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLWZvcjogdmlld0Rlc2NyaXB0b3JzfXtAZXZlbnQtb25jbGljazogaGFuZGxlQ2xpY2tUYWJ9Ij4gPGEgZGF0YS1iaW5kaW5nPSJ7QG5vY2xhc3MtdGFiOiBpc0FjdGl2ZX17QGNsYXNzLXRhYi1hY3RpdmU6IGlzQWN0aXZlfSI+IDxzcGFuIGRhdGEtYmluZGluZz0ie0B0ZXh0OiB0aXRsZX17dGl0bGU6IHRpdGxlfSI+PC9zcGFuPiA8L2E+IDwvbGk+IDwvdWw+IDwvZGl2PiA=");
geocortex.resourceManager.register("Framework.UI","inv","Framework.UI/geocortex/framework/ui/Selector/CSS/common.css","css","");geocortex.resourceManager.register("Framework.UI","inv","invariant","json","eyJsYW5ndWFnZS1mcmFtZXdvcmstdWktdmlldy1jb250YWluZXItdmlldy1jbG9zZSI6IkNsb3NlIHswfSIsImxhbmd1YWdlLWZyYW1ld29yay11aS12aWV3LWNvbnRhaW5lci12aWV3LWJhY2siOiJHbyBCYWNrIHswfSJ9");geocortex.framework.notifyLibraryDownload("Framework.UI");
