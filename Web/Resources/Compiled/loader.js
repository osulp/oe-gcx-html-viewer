var geocortex;
(function(a){(function(a){var l=function(){function a(h,c){c===void 0&&(c="transition"in document.createElement("span").style);this.splashOverlay=h;this.useTransitions=c}a.getDefaultSplash=function(){return new a(document.querySelector(".splash-overlay"))};a.prototype.destroy=function(){if(this.splashOverlay)this.splashOverlay.parentElement.removeChild(this.splashOverlay),this.splashOverlay=null;return this};a.prototype.close=function(a){var c=this;a===void 0&&(a=1E3);if(this.splashOverlay&&!this.splashOverlay.hasAttribute("data-closing"))this.useTransitions?
(this.splashOverlay.setAttribute("data-closing","true"),this.splashOverlay.style.transition="opacity "+a+"ms linear",setTimeout(function(){c.splashOverlay.style.opacity="0";setTimeout(function(){c.destroy()},a)})):this.destroy();return this};return a}();a.Splash=l})(a.essentialsHtmlViewer||(a.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(a){(function(a){(function(a){(function(a){var e=function(){function c(b){b&&this.merge(b)}c.prototype.find=function(b){for(var d in this)if(this.hasOwnProperty(d)&&b.toLowerCase()===d.toLowerCase())return{name:d,value:this[d]};return null};c.prototype.has=function(b){return this.find(b)?true:false};c.prototype.get=function(b){return(b=this.find(b))?b.value:void 0};c.prototype.getAsBoolean=function(b){return(b=this.find(b))?(typeof b.value!="string"||b.value.toLowerCase()!=="false")&&b.value!==
false&&b.value!==null:false};c.prototype.set=function(b,d){var o=this.find(b);this[o?o.name:b]=d;return this};c.prototype.merge=function(b){for(var d in b)b.hasOwnProperty(d)&&this.set(d,b[d]);return this};return c}();a.CaselessMap=e})(a.loading||(a.loading={}))})(a.application||(a.application={}))})(a.framework||(a.framework={}))})(geocortex||(geocortex={}));
(function(a){a=a.framework||(a.framework={});a=a.application||(a.application={});a=a.resources||(a.resources={});a=a.ResourceStatus||(a.ResourceStatus={});a[a.Unloaded=0]="Unloaded";a[a.Loading=1]="Loading";a[a.Pending=2]="Pending";a[a.Loaded=3]="Loaded";a[a.Error=4]="Error"})(geocortex||(geocortex={}));
(function(a){(function(a){(function(a){(function(a){var e=function(){function c(b){this.status=0;this.name=b}c.prototype.load=function(){throw Error("Not implemented.");};return c}();a.Resource=e})(a.resources||(a.resources={}))})(a.application||(a.application={}))})(a.framework||(a.framework={}))})(geocortex||(geocortex={}));var __extends=this.__extends||function(a,e){function l(){this.constructor=a}for(var h in e)e.hasOwnProperty(h)&&(a[h]=e[h]);l.prototype=e.prototype;a.prototype=new l};
(function(a){(function(a){(function(a){(function(a){(function(a){a[a.Concurrent=0]="Concurrent";a[a.ConcurrentLegacyIE=1]="ConcurrentLegacyIE";a[a.Sequential=2]="Sequential"})(a.ScriptLoadingMode||(a.ScriptLoadingMode={}));var e=function(a){function b(b){a.call(this,b)}__extends(b,a);b.detectScriptLoadingMode=function(b,a){if(a===void 0)a=document.documentMode;return document.createElement("script").async===true?0:a?1:2};b.sniffScriptLoadingMode=function(b,a){if(b===void 0)b=navigator.userAgent;if(a===
void 0)a=document.documentMode;return a?a>=10?0:1:/Chrome/i.test(b)||/Chromium/i.test(b)?0:/Firefox/i.test(b)?2:/Safari\//i.test(b)&&!/Chrome\//i.test(b)&&!/Chromium\//i.test(b)&&parseInt(/Version\/([\w]+)/i.exec(b)[1])>5?0:/Opera/i.test(b)&&!/Opera Mini/i.test(b)?0:2};b.prototype.load=function(d){var a=this;d===void 0&&(d={});if(this.status===0){this.status=1;var c=document.head||document.getElementsByTagName("head")[0],f=document.createElement("script");f.setAttribute("data-injected-script","");
try{if(b.loadingMode===0){if(f.async=false,f.onload=function(){a.status=3;if(d.onLoaded)d.onLoaded(a);f.onload=null},f.onerror=function(){var b=Error("Script failed to load ("+a.name+")");b.name="ResourceLoadError";if(d.onError)d.onError(a,b);else console.error(b);f.onerror=null},f.src=this.name,c.appendChild(f),d.onNext)d.onNext(this)}else if(b.loadingMode===1){f.onerror=function(){var b=Error("Script failed to load ("+a.name+")");b.name="ResourceLoadError";if(d.onError)d.onError(a,b);else console.error(b);
f.onerror=null};f.src=this.name;var w=setInterval(function(){if(!(a.prevResource&&a.prevResource.status!==3))if(f.readyState==="loaded"){a.status=2;a.pendingExecution=f;if(d.onPending)d.onPending(a);d.parent||a.executePending()}else if(f.readyState==="complete")clearInterval(w),a.status=3,d.onLoaded(a)},b.concurrentLegacyIEInterval);if(d.onNext)d.onNext(this)}else if(b.loadingMode===2){var e=false;f.onload=f.onreadystatechange=function(){if(!e&&(!f.readyState||f.readyState=="loaded"||f.readyState==
"complete")){a.status=3;if(d.onLoaded)d.onLoaded(a);if(d.onNext)d.onNext(a);e=true;f.onload=f.onreadystatechange=null}};f.onerror=function(){var b=Error("Script failed to load ("+a.name+")");b.name="ResourceLoadError";if(d.onError)d.onError(a,b);else console.error(b);f.onerror=null};f.src=this.name;c.appendChild(f)}}catch(h){if(d.onError)d.onError(this,h);else console.error(h)}}};b.prototype.executePending=function(){if(this.status===2&&this.pendingExecution)(document.head||document.getElementsByTagName("head")[0]).appendChild(this.pendingExecution),
this.pendingExecution=null};b.loadingMode=b.detectScriptLoadingMode();b.concurrentLegacyIEInterval=150;return b}(a.Resource);a.ScriptResource=e})(a.resources||(a.resources={}))})(a.application||(a.application={}))})(a.framework||(a.framework={}))})(geocortex||(geocortex={}));
(function(a){(function(a){(function(a){(function(a){var e=function(a){function b(b){a.call(this,b)}__extends(b,a);b.prototype.load=function(b){b===void 0&&(b={});if(this.status===0){this.status=1;for(var a=document.head||document.getElementsByTagName("head")[0],c=null,f=0;f<a.children.length;f++){var e=a.children[f];e.tagName.toLowerCase()==="link"&&e.getAttribute("[data-injected-stylesheet]")===""&&(c=e)}f=document.createElement("link");f.rel="stylesheet";f.href=this.name;f.setAttribute("data-injected-stylesheet",
"");c?c.nextSibling?a.insertBefore(f,c.nextSibling):a.appendChild(f):a.firstChild?a.insertBefore(f,a.firstChild):a.appendChild(f);this.status=3;if(b.onLoaded)b.onLoaded(this);if(b.onNext)b.onNext(this)}};return b}(a.Resource);a.StyleResource=e})(a.resources||(a.resources={}))})(a.application||(a.application={}))})(a.framework||(a.framework={}))})(geocortex||(geocortex={}));
(function(a){(function(a){(function(a){(function(a){var e=function(c){function b(b,a){c.call(this,b);this.resources=[];a&&this.append(a)}__extends(b,c);b.prototype.load=function(d){function c(b,a){if(b.length<1)return a.onNext(this);b.shift().load({parent:f,onNext:function(){c(b,a)},onPending:function(b){m--;if(m<1)a.onPending(b)},onLoaded:function(b){e--;if(e<1)a.onLoaded(b)},onError:function(b,d){a.onError(b,d)}})}var n=this;d===void 0&&(d={});if(this.status===0){this.status=1;var f=this,e=this.resources.length,
m=0;if(a.ScriptResource.loadingMode===1)for(var g=0;g<this.resources.length;g++){var j=this.resources[g];if(g>0)j.prevResource=this.resources[g-1];if(j instanceof a.ScriptResource)m++;else if(j instanceof b){if(j.resources.length>0)j.resources[0].prevResource=j.prevResource;for(var i=false,j=j.getAllResources(),l=0;l<j.length;l++)if(j[l]instanceof a.ScriptResource){i=true;break}i&&m++}}c(this.resources.slice(),{onNext:function(){if(d.onNext)d.onNext(n)},onPending:function(){if(d.onPending)d.onPending(n);
d.parent||n.executePending()},onLoaded:function(){n.status=3;if(d.onLoaded)d.onLoaded(n)},onError:function(b,a){n.status=4;if(d.onError)d.onError(b,a);else console.error(a)}})}};b.prototype.executePending=function(){function b(a){if(a.length){var c=a.shift();c.executePending&&c.executePending();b(a)}}b(this.resources.slice())};b.prototype.getAllResources=function(){for(var a=[this],c=0,n=this.resources.length;c<n;c++){var f=this.resources[c];if(f instanceof b)for(var f=f.getAllResources(),e=0,g=f.length;e<
g;e++)a.push(f[e]);else a.push(f)}return a};b.prototype.find=function(b){for(var a=this.getAllResources(),c=0,f=a.length;c<f;c++){var e=a[c];if(b===e.name)return e}return null};b.prototype.add=function(a,c){c===void 0&&(c=false);for(var e=0,f=a.length;e<f;e++){var g=b.interpretItemAsResource(a[e]);g&&(c?this.resources.unshift(g):this.resources.push(g))}return this};b.prototype.append=function(a){this.add(a,false);return this};b.prototype.prepend=function(a){this.add(a,true);return this};b.interpretItemAsResource=
function(c){if(typeof c==="string")if(/\.js$/.test(c))return new a.ScriptResource(c);else if(/\.css$/.test(c))return new a.StyleResource(c);else throw Error('Resource string "'+c+"\" didn't match any known file extensions (must be *.js or *.css).");else if(typeof c==="object")return c instanceof a.Resource?c:b.generateResourceSetFromLiteral(c);else throw Error("Unknown item type: "+typeof c);};b.generateResourceSetFromLiteral=function(a){if(a instanceof b)return a;for(var c=new b(a.name),e=0,f=a.resources.length;e<
f;e++)c.append([a.resources[e]]);return c};return b}(a.Resource);a.ResourceSet=e})(a.resources||(a.resources={}))})(a.application||(a.application={}))})(a.framework||(a.framework={}))})(geocortex||(geocortex={}));
(function(a){(function(a){(function(a){(function(e){var g=function(){function c(b){this.resourceSet=b||new a.resources.ResourceSet("everything")}c.prototype.initializeApplication=function(){throw Error("Not implemented.");};c.prototype.loadAndInitialize=function(a){var c=this;a===void 0&&(a={});this.resourceSet.load({onLoaded:function(){var e=c.initializeApplication(a);if(a.onInitialized)a.onInitialized(e,c)},onError:function(e,g){c.handleError(g,a.onError)}})};c.prototype.handleError=function(a,
c,e){if(c)c(a,this);else if(console.error(a),c=false,e&&(e.trace.error("[{0}]: {1}".format(a.name,a.message)),e.command("Alert").execute("[{0}]: {1}".format(a.name,a.message),"Viewer Error"),c=true),!c){e=document.createElement("div");e.setAttribute("class","application-error");e.setAttribute("style","padding: 1em; font-size: 1em; color: #333; border: 1px solid #cccccc; border-radius: 0.25em; margin: 2%;");c=document.createElement("h1");c.textContent=c.innerText="An error occurred.";c.style.fontSize=
"1.5em";c.style.fontWeight="normal";c.style.paddingBottom="0.25em";c.style.color="#990000";var g=document.createElement("strong");g.textContent=g.innerText=a.name+": ";a=document.createTextNode(a.message);e.appendChild(c);e.appendChild(g);e.appendChild(a);document.body.appendChild(e)}};return c}();e.ApplicationLoader=g})(a.loading||(a.loading={}))})(a.application||(a.application={}))})(a.framework||(a.framework={}))})(geocortex||(geocortex={}));
(function(a){(function(e){var l=function(h){function g(c){c===void 0&&(c={});h.call(this);this.aliases=new a.framework.application.loading.CaselessMap;var b="loaderResourcePrefix"in c?c.loaderResourcePrefix:null;b||(b="baseUrl"in c?c.baseUrl:"./");"useLocalEsriApi"in c?window.geocortexUseLocalEsriApi=c.useLocalEsriApi:c.useLocalEsriApi="geocortexUseLocalEsriApi"in window?window.geocortexUseLocalEsriApi:false;this.resourceSet.append([{name:"dependencies",resources:[{name:"css",resources:[b+"Resources/Styles/jquery.ui.custom.css",
b+"Resources/Scripts/esri/css/esri.css",b+"Resources/Styles/common.css",b+"Resources/Styles/Animations.css"]},{name:"tools",resources:[b+"Resources/Scripts/jquery.min.js",b+"Resources/Scripts/jquery.ui.custom.js",b+"Resources/Scripts/jquery.ui.touch-punch.js",b+"Resources/Scripts/jquery-ui-timepicker-addon.min.js",b+"Resources/Scripts/modernizr.js",b+"Resources/Scripts/modernizr-fix.js",b+"Resources/Scripts/bluebird.min.js",b+"Resources/Scripts/iso8601.min.js",b+"Resources/Scripts/remarkable.min.js",
b+"Resources/Scripts/fastclick.js"]},{name:"esri",resources:[b+"Resources/Scripts/dojo-config.js",b+"Resources/Scripts/esri.js",b+"Resources/Scripts/dojo-requires.js"]}]},{name:"viewer",resources:[b+"Resources/Compiled/Framework.js",b+"Resources/Compiled/Framework.UI.js",b+"Resources/Compiled/Charting.Infrastructure.js",b+"Resources/Compiled/Essentials.js",b+"Resources/Compiled/Mapping.Infrastructure.js",b+"Resources/Scripts/Insight.EventRelay.js",b+"Resources/Scripts/Bridge.js"]}]);(c=document.documentMode)&&
c<=8&&this.resourceSet.find("css").prepend([b+"Resources/Styles/IE.css"]);(!c||c&&c>=10)&&this.resourceSet.find("tools").append([b+"Resources/Scripts/hammer.js"])}__extends(g,h);g.determineAppropriateShell=function(a){if(a===void 0)a=navigator.userAgent;var b=function(b){return RegExp(b,"i").test(a)};return b("Android")&&b("mobile")||b("Windows")&&b("Phone")||b("iPhone")||b("iPod")||b("BlackBerry")||b("BB10")?"Handheld":b("Android")||b("iPad")||b("Playbook")||b("Touch")?"Tablet":"Desktop"};g.prototype.addAlias=
function(a,b){this.aliases.set(a,b);return this};g.prototype.initializeApplication=function(c){var b=this;c===void 0&&(c={});try{var d=new a.framework.application.loading.CaselessMap(c.query||function(){var a=/^.*\?([^#]*).*$/.exec(location.href);return a?dojo.queryToObject(a[1]):{}}());new window.FastClick(document.body);var o=c.hostElement||document.body,n=d.has("debug")?d.getAsBoolean("debug"):c.debug||false,f=d.has("offline")?d.getAsBoolean("offline"):c.offline||false,h=window.viewerConfig;h&&
this.aliases.merge(h.configurations||{});this.aliases.merge(c.aliases||{});var m=d.has("configBase")?d.get("configBase"):c.configBase,l=!!m;m||(m="Resources/Config/Default/");/\/$/.test(m)||(m+="/");var j=c.shell||g.determineAppropriateShell(),i=d.get("viewerConfigUri");if(!i)i=c.viewerConfigUri;if(!i){var q=d.get("viewer");if(q){var r=this.aliases.get(q);if(r)i=r;else{var s=Error("Viewer alias '"+q+"' not found.");s.name="ViewerAliasNotFound";throw s;}}}if(!i&&h&&h.viewerConfigUri)i=h.viewerConfigUri;
if(!i){var t=this.aliases.get("default");t&&!l&&(i=t)}i||(i=m+j+".json.js");var u=i.split("/"),v=u.slice(0,u.length-1).join("/")+"/",x=String.quickHashCode(a.framework.utils.makeUrlAbsolute(v)),p=document.createElement("div");p.setAttribute("class","shell splash-blurred");p.setAttribute("data-region-name","ApplicationRegion");p.setAttribute("data-region-adapter","geocortex.framework.ui.MultiDivRegionAdapter");o.appendChild(p);var k=new a.essentialsHtmlViewer.ViewerApplication(i,o,x);k.shellName=j;
k.viewerConfigPath=v;k.debugMode=n;k.urlParameters=d;k.isOffline.set(f);k.event("SiteInitializedEvent").subscribe(window,function(){e.Splash.getDefaultSplash().close();if(c.onSiteInitialized)c.onSiteInitialized(k,b)});k.event("SiteInitializationFailedEvent").subscribe(window,function(a){a.name="SiteInitializationFailedEvent/"+a.name;b.handleError(a,c.onError)});k.event("SiteAuthorizationFailedEvent").subscribe(window,function(a){a.name="SiteAuthorizationFailedEvent/"+a.name;b.handleError(a,c.onError)});
k.event("ConfigurationLoadFailedEvent").subscribe(window,function(a){a.name="ConfigurationLoadFailed/"+a.name;b.handleError(a,c.onError)});k.event("TraceEvent").subscribe(window,function(a){function b(a,c,d){a+="";return a.length>=c?a:Array(c-a.length+1).join(d||"0")+a}var c=a.timestamp,c="{0}:{1}:{2}.{3}".format(b(c.getHours(),2),b(c.getMinutes(),2),b(c.getSeconds(),2),b(c.getMilliseconds(),3)),a="[{0}]: {1}: {2}".format(a.level,c,a.message);console.info?console.info(a):console.log(a)});k.initialize();
return k}catch(y){this.handleError(y,c.onError)}};g.prototype.loadAndInitialize=function(a){var b=this;a===void 0&&(a={});var d=a.onError;a.onError=function(a){b.handleError(a,d)};this.resourceSet.find("dependencies").load({onLoaded:function(){dojo.ready(function(){b.resourceSet.find("viewer").load({onLoaded:function(){var d=b.initializeApplication(a);if(a.onInitialized)a.onInitialized(d,b)},onError:function(d,e){b.handleError(e,a.onError)}})});require.on("error",function(d){d.name="DojoLoaderError";
d.message="Failed to load dojo module "+("info"in d&&d.info.length>0?"("+d.info[0]+")":"")+".";b.handleError(d,a.onError)})},onError:function(d,e){b.handleError(e,a.onError)}})};g.prototype.handleError=function(a,b,d){e.Splash.getDefaultSplash().destroy();h.prototype.handleError.call(this,a,b,d)};return g}(a.framework.application.loading.ApplicationLoader);e.ViewerLoader=l})(a.essentialsHtmlViewer||(a.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));window.shellName=geocortex.essentialsHtmlViewer.ViewerLoader.determineAppropriateShell();
