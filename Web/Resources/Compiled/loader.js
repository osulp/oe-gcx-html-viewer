var __extends=this&&this.__extends||function(a,e){function m(){this.constructor=a}for(var l in e)e.hasOwnProperty(l)&&(a[l]=e[l]);a.prototype=null===e?Object.create(e):(m.prototype=e.prototype,new m)},geocortex;
(function(a){(function(a){(function(a){(function(a){var t=function(){return function(a){var f=this;void 0===a&&(a=window.location.href);(a=/^.*\?([^#]*).*$/.exec(a))&&a[1].split("&").forEach(function(d){var c=d.split("=");d=c.shift();c=c.join("=");f[decodeURIComponent(d)]=c?decodeURIComponent(c):void 0})}}();a.QueryParameters=t})(a.loading||(a.loading={}))})(a.application||(a.application={}))})(a.framework||(a.framework={}))})(geocortex||(geocortex={}));
(function(a){(function(a){var m=function(){function a(l,p){void 0===p&&(p="transition"in document.createElement("span").style);this.splashOverlay=l;this.useTransitions=p}a.getDefaultSplash=function(){return new a(document.querySelector(".splash-overlay"))};a.prototype.display=function(a){var l=document.querySelector(".splash-plate");l&&(l.className=l.className.replace(" splash-invisible",""));(l=document.querySelector(".splash-image"))&&!l.src&&(l.src=a?a:"Resources/Images/splash-logo.png");(a=document.querySelector(".splash-pre-loader"))&&
this.splashOverlay&&this.splashOverlay.removeChild(a);return this};a.prototype.destroy=function(){this.splashOverlay&&(this.splashOverlay.parentElement.removeChild(this.splashOverlay),this.splashOverlay=null);return this};a.prototype.close=function(a){var l=this;void 0===a&&(a=1E3);this.splashOverlay&&!this.splashOverlay.hasAttribute("data-closing")&&(this.useTransitions?(this.splashOverlay.setAttribute("data-closing","true"),this.splashOverlay.style.transition="opacity "+a+"ms linear",setTimeout(function(){l.splashOverlay.style.opacity=
"0";setTimeout(function(){l.destroy()},a)})):this.destroy());return this};return a}();a.Splash=m})(a.essentialsHtmlViewer||(a.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(a){(function(a){(function(a){(function(a){var e=function(){function a(f){f&&this.merge(f)}a.prototype.find=function(a){if(a)for(var d in this)if(this.hasOwnProperty(d)&&a.toLowerCase()===d.toLowerCase())return{name:d,value:this[d]};return null};a.prototype.has=function(a){return this.find(a)?!0:!1};a.prototype.get=function(a){return(a=this.find(a))?a.value:void 0};a.prototype.getAsBoolean=function(a){return(a=this.find(a))?("string"!=typeof a.value||"false"!==a.value.toLowerCase())&&!1!==
a.value&&null!==a.value:!1};a.prototype.set=function(a,d){var c=this.find(a);this[c?c.name:a]=d;return this};a.prototype.merge=function(a){for(var d in a)a.hasOwnProperty(d)&&this.set(d,a[d]);return this};return a}();a.CaselessMap=e})(a.loading||(a.loading={}))})(a.application||(a.application={}))})(a.framework||(a.framework={}))})(geocortex||(geocortex={}));
(function(a){a=a.framework||(a.framework={});a=a.application||(a.application={});a=a.resources||(a.resources={});a=a.ResourceStatus||(a.ResourceStatus={});a[a.Unloaded=0]="Unloaded";a[a.Loading=1]="Loading";a[a.Pending=2]="Pending";a[a.Loaded=3]="Loaded";a[a.Error=4]="Error"})(geocortex||(geocortex={}));
(function(a){(function(a){(function(a){(function(a){var e=function(){function e(f){this.status=a.ResourceStatus.Unloaded;this.name=f}e.prototype.load=function(a){throw Error("Not implemented.");};return e}();a.Resource=e})(a.resources||(a.resources={}))})(a.application||(a.application={}))})(a.framework||(a.framework={}))})(geocortex||(geocortex={}));
(function(a){(function(a){(function(a){(function(a){var e=function(e){function f(){e.apply(this,arguments)}__extends(f,e);f.prototype.load=function(d){var c=this;void 0===d&&(d={});if(this.status===a.ResourceStatus.Unloaded&&(this.status=a.ResourceStatus.Loading,require([this.name],function(b){c.status=a.ResourceStatus.Loaded;c.module=b;if(d.onLoaded)d.onLoaded(c,b)}),d.onNext))d.onNext(this)};f.prefixRegex=/^require:(.*)$/i;return f}(a.Resource);a.RequireResource=e})(a.resources||(a.resources={}))})(a.application||
(a.application={}))})(a.framework||(a.framework={}))})(geocortex||(geocortex={}));
(function(a){(function(a){(function(a){(function(a){(function(a){a[a.Concurrent=0]="Concurrent";a[a.ConcurrentLegacyIE=1]="ConcurrentLegacyIE";a[a.Sequential=2]="Sequential"})(a.ScriptLoadingMode||(a.ScriptLoadingMode={}));var e=a.ScriptLoadingMode,p=function(f){function d(c){f.call(this,c)}__extends(d,f);d.detectScriptLoadingMode=function(c,a){void 0===a&&(a=document.documentMode);return!0===document.createElement("script").async?e.Concurrent:a?e.ConcurrentLegacyIE:e.Sequential};d.sniffScriptLoadingMode=
function(c,a){void 0===c&&(c=navigator.userAgent);void 0===a&&(a=document.documentMode);return a?10<=a?e.Concurrent:e.ConcurrentLegacyIE:/Chrome/i.test(c)||/Chromium/i.test(c)?e.Concurrent:/Firefox/i.test(c)?e.Sequential:/Safari\//i.test(c)&&!/Chrome\//i.test(c)&&!/Chromium\//i.test(c)&&5<parseInt(/Version\/([\w]+)/i.exec(c)[1])||/Opera/i.test(c)&&!/Opera Mini/i.test(c)?e.Concurrent:e.Sequential};d.prototype.load=function(c){var b=this;void 0===c&&(c={});if(this.status===a.ResourceStatus.Unloaded){this.status=
a.ResourceStatus.Loading;var g=document.head||document.getElementsByTagName("head")[0],k=document.createElement("script");k.setAttribute("data-injected-script","");try{if(d.loadingMode===e.Concurrent){if(k.async=!1,k.onload=function(){b.status=a.ResourceStatus.Loaded;if(c.onLoaded)c.onLoaded(b);k.onload=null},k.onerror=function(a){a=Error("Script failed to load ("+b.name+")");a.name="ResourceLoadError";if(c.onError)c.onError(b,a);else console.error(a);k.onerror=null},k.src=this.name,g.appendChild(k),
c.onNext)c.onNext(this)}else if(d.loadingMode===e.ConcurrentLegacyIE){k.onerror=function(){var a=Error("Script failed to load ("+b.name+")");a.name="ResourceLoadError";if(c.onError)c.onError(b,a);else console.error(a);k.onerror=null};k.src=this.name;var f=setInterval(function(){if(!b.prevResource||b.prevResource.status===a.ResourceStatus.Loaded)if("loaded"===k.readyState){b.status=a.ResourceStatus.Pending;b.pendingExecution=k;if(c.onPending)c.onPending(b);c.parent||b.executePending()}else"complete"===
k.readyState&&(clearInterval(f),b.status=a.ResourceStatus.Loaded,c.onLoaded(b))},d.concurrentLegacyIEInterval);if(c.onNext)c.onNext(this)}else if(d.loadingMode===e.Sequential){var n=!1;k.onload=k.onreadystatechange=function(){if(!(n||k.readyState&&"loaded"!=k.readyState&&"complete"!=k.readyState)){b.status=a.ResourceStatus.Loaded;if(c.onLoaded)c.onLoaded(b);if(c.onNext)c.onNext(b);n=!0;k.onload=k.onreadystatechange=null}};k.onerror=function(){var a=Error("Script failed to load ("+b.name+")");a.name=
"ResourceLoadError";if(c.onError)c.onError(b,a);else console.error(a);k.onerror=null};k.src=this.name;g.appendChild(k)}}catch(h){if(c.onError)c.onError(this,h);else console.error(h)}}};d.prototype.executePending=function(){this.status===a.ResourceStatus.Pending&&this.pendingExecution&&((document.head||document.getElementsByTagName("head")[0]).appendChild(this.pendingExecution),this.pendingExecution=null)};d.loadingMode=d.detectScriptLoadingMode();d.concurrentLegacyIEInterval=150;return d}(a.Resource);
a.ScriptResource=p})(a.resources||(a.resources={}))})(a.application||(a.application={}))})(a.framework||(a.framework={}))})(geocortex||(geocortex={}));
(function(a){(function(a){(function(a){(function(a){var e=function(e){function f(a){e.call(this,a)}__extends(f,e);f.prototype.load=function(d){void 0===d&&(d={});if(this.status===a.ResourceStatus.Unloaded){this.status=a.ResourceStatus.Loading;for(var c=document.head||document.getElementsByTagName("head")[0],b=null,g=0;g<c.children.length;g++){var f=c.children[g];"link"===f.tagName.toLowerCase()&&""===f.getAttribute("[data-injected-stylesheet]")&&(b=f)}g=document.createElement("link");g.rel="stylesheet";
g.href=this.name;g.setAttribute("data-injected-stylesheet","");b?b.nextSibling?c.insertBefore(g,b.nextSibling):c.appendChild(g):c.firstChild?c.insertBefore(g,c.firstChild):c.appendChild(g);this.status=a.ResourceStatus.Loaded;if(d.onLoaded)d.onLoaded(this);if(d.onNext)d.onNext(this)}};return f}(a.Resource);a.StyleResource=e})(a.resources||(a.resources={}))})(a.application||(a.application={}))})(a.framework||(a.framework={}))})(geocortex||(geocortex={}));
(function(a){(function(e){(function(e){(function(e){var m=function(p){function f(d,c){p.call(this,d);this.resources=[];a.framework.application.resources.ScriptResource;c&&this.append(c)}__extends(f,p);f.prototype.load=function(a){function c(a,b){if(1>a.length)return b.onNext(this);a.shift().load({parent:g,onNext:function(d){c(a,b)},onPending:function(a){u--;if(1>u)b.onPending(a)},onLoaded:function(a){k--;if(1>k)b.onLoaded(a)},onError:function(a,c){b.onError(a,c)}})}var b=this;void 0===a&&(a={});if(this.status===
e.ResourceStatus.Unloaded){this.status=e.ResourceStatus.Loading;var g=this,k=this.resources.length,u=0;if(e.ScriptResource.loadingMode===e.ScriptLoadingMode.ConcurrentLegacyIE)for(var n=0;n<this.resources.length;n++){var h=this.resources[n];0<n&&(h.prevResource=this.resources[n-1]);if(h instanceof e.ScriptResource)u++;else if(h instanceof f){0<h.resources.length&&(h.resources[0].prevResource=h.prevResource);for(var p=!1,h=h.getAllResources(),m=0;m<h.length;m++)if(h[m]instanceof e.ScriptResource){p=
!0;break}p&&u++}}c(this.resources.slice(),{onNext:function(c){if(a.onNext)a.onNext(b)},onPending:function(c){if(a.onPending)a.onPending(b);a.parent||b.executePending()},onLoaded:function(c){b.status=e.ResourceStatus.Loaded;if(a.onLoaded)a.onLoaded(b)},onError:function(c,g){b.status=e.ResourceStatus.Error;if(a.onError)a.onError(c,g);else console.error(g)}})}};f.prototype.executePending=function(){function a(c){if(c.length){var b=c.shift();b.executePending&&b.executePending();a(c)}}a(this.resources.slice())};
f.prototype.getAllResources=function(){for(var a=[this],c=0,b=this.resources.length;c<b;c++){var g=this.resources[c];if(g instanceof f)for(var g=g.getAllResources(),e=0,u=g.length;e<u;e++)a.push(g[e]);else a.push(g)}return a};f.prototype.find=function(a){for(var c=this.getAllResources(),b=0,g=c.length;b<g;b++){var e=c[b];if(a===e.name)return e}return null};f.prototype.add=function(a,c){void 0===c&&(c=!1);for(var b=0,g=a.length;b<g;b++){var e=f.interpretItemAsResource(a[b]);e&&(c?this.resources.unshift(e):
this.resources.push(e))}return this};f.prototype.append=function(a){this.add(a,!1);return this};f.prototype.prepend=function(a){this.add(a,!0);return this};f.interpretItemAsResource=function(a){if("string"===typeof a){if(e.RequireResource.prefixRegex.test(a))return a=e.RequireResource.prefixRegex.exec(a)[1],new e.RequireResource(a);if(/\.js$/i.test(a))return new e.ScriptResource(a);if(/\.css$/i.test(a))return new e.StyleResource(a);throw'Unknown resource type "'+a+'"';}if("object"===typeof a)return a instanceof
e.Resource?a:f.generateResourceSetFromLiteral(a);throw Error("Unknown item type: "+typeof a);};f.generateResourceSetFromLiteral=function(a){if(a instanceof f)return a;for(var c=new f(a.name),b=0,g=a.resources.length;b<g;b++)c.append([a.resources[b]]);return c};return f}(e.Resource);e.ResourceSet=m})(e.resources||(e.resources={}))})(e.application||(e.application={}))})(a.framework||(a.framework={}))})(geocortex||(geocortex={}));
(function(a){(function(a){(function(a){(function(e){var t=function(){function e(f){var d=this;this._isUnloading=!1;this.resourceSet=f||new a.resources.ResourceSet("everything");window.addEventListener("beforeunload",function(a){d._isUnloading=!0})}e.prototype.initializeApplication=function(a){throw Error("Not implemented.");};e.prototype.loadAndInitialize=function(a){var d=this;void 0===a&&(a={});this.resourceSet.load({onLoaded:function(){var c=d.initializeApplication(a);if(a.onInitialized)a.onInitialized(c,
d)},onError:function(c,b){d.handleError(b,a.onError)}})};e.prototype.handleError=function(a,d,c){if(d)d(a,this);else if(console.error(a),!this._isUnloading&&(d=!1,c&&(c.trace.error("[{0}]: {1}".format(a.name,a.message)),c.command("Alert").execute("[{0}]: {1}".format(a.name,a.message),"Viewer Error"),d=!0),!d)){c=document.createElement("div");c.setAttribute("class","application-error");c.setAttribute("style","padding: 1em; font-size: 1em; color: #333; border: 1px solid #cccccc; border-radius: 0.25em; margin: 2%;");
d=document.createElement("h1");d.textContent=d.innerText="An error occurred.";d.style.fontSize="1.5em";d.style.fontWeight="normal";d.style.paddingBottom="0.25em";d.style.color="#990000";var b=document.createElement("strong");b.textContent=b.innerText=a.name+": ";a=document.createTextNode(a.message);c.appendChild(d);c.appendChild(b);c.appendChild(a);document.body.appendChild(c)}};return e}();e.ApplicationLoader=t})(a.loading||(a.loading={}))})(a.application||(a.application={}))})(a.framework||(a.framework=
{}))})(geocortex||(geocortex={}));
(function(a){(function(e){function m(a){try{var d=JSON.parse(a);if(d&&"object"===typeof d)return d}catch(c){return{error:{message:"Could not parse response. Error: "+c}}}}function l(a,d,c){t(a,function(a,e){var k=m(a);!k||"error"in k?c(Error("Error reported from server: "+k?k.error.message:"no response returned"),e):d(k,e)},c)}function t(a,d,c){var b=new XMLHttpRequest;b.open("GET",a,!0);b.send();b.onload=function(){var a=null;200===b.status&&b.responseText?d(b.responseText,a,b):(a=Error("xhrGet request failed. Status: "+
b.status+"."),c(a,b))};b.onerror=function(){c(Error("xhrGet request failed. Status: "+b.status+"."),b)}}var p=function(f){function d(c){void 0===c&&(c={});f.call(this);this.aliases=new a.framework.application.loading.CaselessMap;var b="loaderResourcePrefix"in c?c.loaderResourcePrefix:null;b||(b="baseUrl"in c?c.baseUrl:"./");"useLocalEsriApi"in c?window.geocortexUseLocalEsriApi=c.useLocalEsriApi:c.useLocalEsriApi="geocortexUseLocalEsriApi"in window?window.geocortexUseLocalEsriApi:!1;this.resourceSet.append([{name:"dependencies",
resources:[{name:"css",resources:[b+"Resources/Styles/jquery.ui.custom.css",b+"Resources/Scripts/esri/css/esri.css",b+"Resources/Styles/common.css",b+"Resources/Styles/Animations.css"]},{name:"tools",resources:[b+"Resources/Scripts/jquery.min.js",b+"Resources/Scripts/jquery.ui.custom.js",b+"Resources/Scripts/jquery.ui.touch-punch.js",b+"Resources/Scripts/jquery-ui-timepicker-addon.min.js",b+"Resources/Scripts/modernizr.js",b+"Resources/Scripts/modernizr-fix.js",b+"Resources/Scripts/bluebird.min.js",
b+"Resources/Scripts/iso8601.min.js",b+"Resources/Scripts/remarkable.min.js",b+"Resources/Scripts/fastclick.js",b+"Resources/Scripts/globalize/cldr.min.js",b+"Resources/Scripts/globalize/globalize.min.js",b+"Resources/Scripts/caja-html-sanitizer-minified.js"]},{name:"esri",resources:[b+"Resources/Scripts/dojo-config.js",b+"Resources/Scripts/esri.js",b+"Resources/Scripts/dojo-requires.js"]}]},{name:"viewer",resources:[b+"Resources/Compiled/Framework.js",b+"Resources/Compiled/Framework.UI.js",b+"Resources/Compiled/Charting.Infrastructure.js",
b+"Resources/Compiled/Essentials.js",b+"Resources/Compiled/Mapping.Infrastructure.js",b+"Resources/Scripts/Insight.EventRelay.js",b+"Resources/Scripts/Bridge.js",b+"Resources/Scripts/moment/moment-timezone-with-data.js"]}]);"function"!==typeof WeakMap&&this.resourceSet.find("tools").append([b+"Resources/Scripts/weakmap.js"]);(c=document.documentMode)&&8>=c&&this.resourceSet.find("css").prepend([b+"Resources/Styles/IE.css"]);c&&9>=c&&this.resourceSet.find("tools").append([b+"Resources/Scripts/jquery.iframe-transport-1.0.0.min.js"]);
(!c||c&&10<=c)&&this.resourceSet.find("tools").append([b+"Resources/Scripts/hammer.js"])}__extends(d,f);d.determineAppropriateShell=function(a){void 0===a&&(a=navigator.userAgent);var b=function(b){return RegExp(b,"i").test(a)};return b("Android")&&b("mobile")||b("Windows")&&b("Phone")||b("iPhone")||b("iPod")||b("BlackBerry")||b("BB10")?"Handheld":b("Android")||b("iPad")||b("Playbook")||b("Touch")?"Tablet":"Desktop"};d.prototype.addAlias=function(a,b){this.aliases.set(a,b);return this};d.prototype.initializeApplication=
function(c){var b=this;void 0===c&&(c={});try{dojo.contentHandlers.json=function(a){return JSON.parse(a.responseText)};var g=new a.framework.application.loading.CaselessMap(c.query||this.loadQueryParams(c));new window.FastClick(document.body);var k=c.hostElement||document.body,f=g.has("debug")?g.getAsBoolean("debug"):c.debug||!1,n=g.has("offline")?g.getAsBoolean("offline"):c.offline||!1,h=c.configBase,l=!!h;h||(h="Resources/Config/Default/");/\/$/.test(h)||(h+="/");var m=c.shell||d.determineAppropriateShell(),
q=c.viewerConfigUri;if(!q){var r=this.aliases.get("default");r&&!l&&(q=r)}q||(q=h+m+".json.js");var w=q.split("/"),x=w.slice(0,w.length-1).join("/")+"/",p=String.quickHashCode(a.framework.utils.makeUrlAbsolute(x)),v=document.createElement("div");v.setAttribute("class","shell splash-blurred");v.setAttribute("data-region-name","ApplicationRegion");v.setAttribute("data-region-adapter","geocortex.framework.ui.MultiDivRegionAdapter");k.appendChild(v);var s=new a.essentialsHtmlViewer.ViewerApplication(q,
k,p);s.shellName=m;s.viewerConfigPath=x;s.debugMode=f;s.urlParameters=g;s.isOffline.set(n);s.event("SiteInitializedEvent").subscribe(window,function(){e.Splash.getDefaultSplash().close();if(c.onSiteInitialized)c.onSiteInitialized(s,b)});s.event("SiteInitializationFailedEvent").subscribe(window,function(a){a.name="SiteInitializationFailedEvent/"+a.name;b.handleError(a,c.onError,s)});s.event("SiteAuthorizationFailedEvent").subscribe(window,function(a){a.name="SiteAuthorizationFailedEvent/"+a.name;b.handleError(a,
c.onError,s)});s.event("ConfigurationLoadFailedEvent").subscribe(window,function(a){a.name="ConfigurationLoadFailed/"+a.name;b.handleError(a,c.onError,s)});s.event("TraceEvent").subscribe(window,function(a){function c(a,b,d){a+="";return a.length>=b?a:Array(b-a.length+1).join(d||"0")+a}var b=a.timestamp,b="{0}:{1}:{2}.{3}".format(c(b.getHours(),2),c(b.getMinutes(),2),c(b.getSeconds(),2),c(b.getMilliseconds(),3));a="[{0}]: {1}: {2}".format(a.level,b,a.message);console.info?console.info(a):console.log(a)});
s.initialize();return s}catch(t){this.handleError(t,c.onError)}};d.prototype.obtainConfigFromAlias=function(a,b,d){var e=this,f=a.query;d=f.get("viewer");var n="",h=f.get("configBase"),l=f.get("viewerConfigUri");d||(h?(d=this.getViewerIDFromConfig(h),n=this.getSiteIDFromConfig(h)):l&&(d=this.getViewerIDFromConfig(l),n=this.getSiteIDFromConfig(l)));(f=window.viewerConfig)&&f.configurations&&this.aliases.merge(f.configurations||{});this.aliases.merge(a.aliases||{});var m=this.aliases.get(d);if(f&&f.viewerConfigUri)a.viewerConfigUri=
f.viewerConfigUri,b(!0);else if(m)a.viewerConfigUri=m,b(!0);else{var q=0!=n.length?n+"."+d:d,r=function(){h&&0!==h.length?a.configBase=h:l&&0!==l.length&&(a.viewerConfigUri=l);b(!0)};this.getViewerSettingsFromJson(function(d){var g=0!=location.hash.length&&0===location.hash.indexOf("#gcx-"),f=d.endpoints,h=!1;(d.viewerSettings||[]).forEach(function(d){a.splashScreenUrl=d.splashScreenUrl?d.splashScreenUrl:"";q&&d.id.toLowerCase()===q.toLowerCase()&&!h&&(h=!0,e.canPassWithoutRedirect(d,g,d.securityUrl)&&
(d.viewerConfigUri?a.viewerConfigUri=d.viewerConfigUri:d.url&&(a.configBase=d.url),b(!0)))});q&&!h&&f&&f[0]&&f[0].externalUrl?(q=encodeURIComponent(q),e.getConfigBaseFromEndpoints({alias:q,hasToken:g,options:a,endpoints:f,index:0,onSuccess:b,onError:r})):h||r()},r)}};d.prototype.loadAndInitialize=function(c){var b=this;void 0===c&&(c={});var d=c.onError;c.onError=function(a,c){b.handleError(a,d)};c.query=c.query||new a.framework.application.loading.CaselessMap(new a.framework.application.loading.QueryParameters(location.href));
var f=0,l=function(a){a&&e.Splash.getDefaultSplash().display(c.splashScreenUrl);++f;if(1<f){var d=b.initializeApplication(c);window.addEventListener("unload",function(){$(d.getHostElement()).empty().off("*");$(document.head).empty().off("*");d.shutdown(null)});if(c.onInitialized)c.onInitialized(d,b)}};this.obtainConfigFromAlias(c,l,function(a){b.handleError(a,c.onError)});this.resourceSet.find("dependencies").load({onLoaded:function(){window.Globalize&&(window._globalize=window.Globalize,delete window.Globalize);
dojo.ready(function(){b.resourceSet.find("viewer").load({onLoaded:function(){l()},onError:function(a,d){b.handleError(d,c.onError)}})});require.on("error",function(a){b.handleError(a,c.onError)})},onError:function(a,d){b.handleError(d,c.onError)}})};d.prototype.resolveSplashScreenUrl=function(a,b){if(/^(?:[a-z]+:)?\/\//i.test(b))return b;var d=a.indexOf("REST/");0<=d&&(d+=5);a=a.substring(0,d);return a+b};d.prototype.getViewerSettingsFromJson=function(a,b){l("ViewerSettings.json.js",a,b)};d.prototype.canPassWithoutRedirect=
function(a,b,d){return!0===a.isAuthorized?!0:!b&&d&&0!==d.length?(d+=encodeURIComponent(this.replaceConfigParamsWithAliasInUrl(window.location.toString(),a.id)),location.assign(d),!1):!0};d.prototype.getConfigBaseFromEndpoints=function(a){var b=this,d=a.alias,e=a.hasToken,f=a.options,n=a.endpoints,h=a.index,m=a.onSuccess,p=a.onError;if(h===n.length)p();else{var q=function(a,c){return a.lastIndexOf(c)===a.length-c.length},r=String(n[h].externalUrl);if(q(r,"/")||q(r,"\\"))r=r.slice(0,-1);r+="/";l(r+
d+"?f=json",function(a){var c=a.url;if(q(c,"/")||q(c,"\\"))c=c.slice(0,-1);if(0===c.indexOf("/")||0===c.indexOf("\\"))c=c.slice(0,1);f.splashScreenUrl=a.splashScreenUrl?a.splashScreenUrl:"";f.splashScreenUrl&&(f.splashScreenUrl=b.resolveSplashScreenUrl(r,f.splashScreenUrl));b.canPassWithoutRedirect(a,e,r+a.securityUrl)&&(f.configBase=r+c+"/Resources/Config/Default",m(!0))},function(a,c){a.name="EssentialsEndpointHttpError/"+a.name;a.message+=' - Error with essentials endpoint "'+n[h].externalUrl+
'"';console.log(a);++h;b.getConfigBaseFromEndpoints({alias:d,hasToken:e,options:f,endpoints:n,index:h,onSuccess:m,onError:p})})}};d.prototype.replaceConfigParamsWithAliasInUrl=function(a,b){var d="",d=a.match(/((\&|\?)configBase=|(\&|\?)viewerConfigUri=)/);if(null==d)return a;var d=d[0],d=a.indexOf(d)+1,e=a.substring(d),e=0<e.indexOf("&")?e.indexOf("&"):e.length,e=a.substring(d+e);return a.substring(0,d)+"viewer="+b+e};d.prototype.loadQueryParams=function(a){return(a=/^.*\?([^#]*).*$/.exec(location.href))?
dojo.queryToObject(a[1]):{}};d.prototype.getSiteIDFromConfig=function(a){var b=a.toLowerCase(),b=b.indexOf("/sites/")+7||b.indexOf("\\sites\\")+7;a=a.substr(b);b=a.indexOf("/")||a.indexOf("\\");return a.substr(0,b)};d.prototype.getViewerIDFromConfig=function(a){var b=a.toLowerCase(),b=b.toLocaleLowerCase().indexOf("/viewers/")+9||b.indexOf("\\viewers\\")+9;a=a.substr(b);b=a.indexOf("/")||a.indexOf("\\");return a.substr(0,b)};d.prototype.handleError=function(a,b,d){e.Splash.getDefaultSplash().destroy();
d&&(d.getHostElement().className+=" viewer-loader-error");f.prototype.handleError.call(this,a,b,d)};return d}(a.framework.application.loading.ApplicationLoader);e.ViewerLoader=p;e.tryParseJson=m;e.getJson=l;e.xhrGet=t})(a.essentialsHtmlViewer||(a.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));window.shellName=geocortex.essentialsHtmlViewer.ViewerLoader.determineAppropriateShell();
