/*
	
	Copyright (c) 2016, Latitude Geographics Group Ltd.
	All rights reserved.
	       
	Redistribution is not permitted. 
	
	Use in binary form, without modification, is permitted provided that neither 
	the name of the organization nor the names of its contributors may be used 
	to endorse or promote products derived from this software without specific 
	prior written permission.
	       
	THIS SOFTWARE IS PROVIDED BY COPYRIGHT HOLDER ''AS IS'' AND ANY
	EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
	WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
	DISCLAIMED. IN NO EVENT SHALL LATITUDE GEOGRAPHICS GROUP LTD. BE LIABLE FOR ANY
	DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
	(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
	LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
	ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
	(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
	SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/

dojo.require("esri.urlUtils");dojo.require("esri.arcgis.utils");dojo.require("esri.arcgis.Portal");dojo.require("esri.layers.FeatureLayer");dojo.require("esri.layers.wms");dojo.require("esri.layers.wmts");dojo.require("esri.layers.WebTiledLayer");dojo.require("esri.virtualearth.VETiledLayer");dojo.require("dojox.data.CsvStore");dojo.require("dojo.aspect");dojo.require("dojo.on");dojo.require("dojox.gfx.matrix");dojo.require("esri.toolbars.draw");dojo.require("esri.toolbars.edit");dojo.require("moment.moment");
moment=moment.moment;var __extends=this&&this.__extends||function(d,k){function q(){this.constructor=d}for(var h in k)k.hasOwnProperty(h)&&(d[h]=k[h]);d.prototype=null===k?Object.create(k):(q.prototype=k.prototype,new q)},geocortex;
(function(d){(function(d){(function(d){d.commandsMetadata=[{name:"ActivateView",metadata:{arguments:"string",description:"Activates a view.",isHyperlinkable:!0,visibility:"public"}},{name:"DeactivateView",metadata:{arguments:"string",description:"Deactivates a view.",isHyperlinkable:!0,visibility:"public"}},{name:"ToggleView",metadata:{arguments:"string",description:"Activates or deactivates a view.",isHyperlinkable:!0,visibility:"public"}},{name:"ToggleLogView",metadata:{arguments:"none",description:"Activates or deactivates log view.",
isHyperlinkable:!0,visibility:"public"}},{name:"ShowLog",metadata:{arguments:"boolean",description:"Shows the log view if the parameter is true.",isHyperlinkable:!0,visibility:"public"}},{name:"HideLog",metadata:{arguments:"none",description:"Hides the log view.",isHyperlinkable:!0,visibility:"public"}},{name:"ToggleResultsFrame",metadata:{arguments:"none",description:"Activates or deactivates Results frame.",isHyperlinkable:!0,visibility:"public"}},{name:"ToggleDataFrame",metadata:{arguments:"none",
description:"Activates or deactivates data frame.",isHyperlinkable:!0,visibility:"public"}},{name:"DestroyView",metadata:{arguments:"string",description:"Destroys a view, wiping out its bindings and DOM substructure.",isHyperlinkable:!0,visibility:"public"}},{name:"CloseModalRegion",metadata:{arguments:"none",description:"Closes the ModalWindowRegion.",isHyperlinkable:!0,visibility:"public"}},{name:"OpenWebPage",metadata:{arguments:"string",description:"Opens a web page in another tab/window.",isHyperlinkable:!0,
visibility:"public"}},{name:"Alert",metadata:{arguments:"string",description:"Displays an alert.",isHyperlinkable:!0,visibility:"public"}},{name:"Confirm",metadata:{arguments:"list",description:"Displays a confirm.",isHyperlinkable:!0,visibility:"private"}},{name:"ConsoleDir",metadata:{arguments:"object",description:"Displays a representation of the specified parameter object in the browser's debugging console.",isHyperlinkable:!0,visibility:"public"}},{name:"Identify",metadata:{arguments:"esri.geometry.Geometry",
description:"Executes an identify operation on a geometry.",isHyperlinkable:!0,visibility:"private"}},{name:"IdentifyBufferedGeometry",metadata:{arguments:"esri.geometry.Geometry",description:"Activates the Buffer Options dialog, buffers input geometry using settings specified by the user, places temporary markup on the map and identifies using the buffered geometry.",isHyperlinkable:!0,visibility:"private"}},{name:"IdentifyBufferedFeature",metadata:{arguments:"esri.Graphic|essentialsHtmlViewer.mapping.infrastructure.Feature",
description:"Activates the Buffer Options dialog, buffers input feature geometry using settings specified by the user, places temporary markup on the map and identifies using the buffered geometry.",isHyperlinkable:!0,visibility:"private"}},{name:"IdentifyBufferedFeatureSet",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.FeatureSet|essentialsHtmlViewer.mapping.infrastructure.FeatureSetCollection|string",description:"Activates the Buffer Options dialog, buffers input feature set geometry using settings specified by the user, places temporary markup on the map and identifies using the buffered geometry.",
isHyperlinkable:!0,visibility:"private"}},{name:"IdentifyBufferedFeatureSetCollection",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.FeatureSetCollection|string",description:"Activates the Buffer Options dialog, buffers input feature set collection geometry using settings specified by the user, places temporary markup on the map and identifies using the buffered geometry.",isHyperlinkable:!0,visibility:"private"}},{name:"Prompt",metadata:{arguments:"object",description:"Displays a prompt.",
isHyperlinkable:!0,visibility:"private"}},{name:"StartOfflineSyncAndShowProgress",metadata:{arguments:"string",description:"Starts downloading or syncing an offline map an displays the progress to the user.",isHyperlinkable:!0,visibility:"public"}},{name:"StepZoomIn",metadata:{arguments:"none",description:"Zooms in a step.",isHyperlinkable:!0,visibility:"public"}},{name:"StepZoomOut",metadata:{arguments:"none",description:"Zooms out a step.",isHyperlinkable:!0,visibility:"public"}},{name:"RecenterMapOnNextMapResize",
metadata:{arguments:"none",description:"Recenters the map to its existing position the next time the map is resized.",isHyperlinkable:!0,visibility:"public"}},{name:"PanToPoint",metadata:{arguments:"esri.geometry.Geometry",description:"Pans to a point or other type of Geometry.",isHyperlinkable:!0,visibility:"private"}},{name:"PanUp",metadata:{arguments:"none",description:"Pans the map up.",isHyperlinkable:!0,visibility:"public"}},{name:"PlotCoordinates",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.coordinates.CoordinateBase|essentialsHtmlViewer.mapping.infrastructure.coordinates.CoordinateBase[]",
description:"Plots a coordinate (or a number of coordinates) on the map.",isHyperlinkable:!1,visibility:"public"}},{name:"PanDown",metadata:{arguments:"none",description:"Pans the map down.",isHyperlinkable:!0,visibility:"public"}},{name:"PanLeft",metadata:{arguments:"none",description:"Pans the map left.",isHyperlinkable:!0,visibility:"public"}},{name:"PanRight",metadata:{arguments:"none",description:"Pans the map right.",isHyperlinkable:!0,visibility:"public"}},{name:"ZoomToExtent",metadata:{arguments:"esri.geometry.Extent",
description:"Zooms to the given extent.",isHyperlinkable:!0,visibility:"public"}},{name:"ZoomToScale",metadata:{arguments:"number",description:"Zooms to the given scale.",isHyperlinkable:!0,visibility:"public"}},{name:"ZoomOutToExtent",metadata:{arguments:"esri.geometry.Extent",description:"Zooms out to the given extent.",isHyperlinkable:!0,visibility:"public"}},{name:"ZoomToLayerExtent",metadata:{arguments:"geocortex.essentials.Layer",description:"Zooms to the extent of all the features in a layer.",
isHyperlinkable:!0,visibility:"private"}},{name:"ZoomToLayerVisibleScale",metadata:{arguments:"geocortex.essentials.Layer",description:"Zooms to the scale at which features in a layer become visible.",isHyperlinkable:!0,visibility:"private"}},{name:"InitializeSite",metadata:{arguments:"none",description:"Tells the Geocortex Essentials Site object to begin initialization.",isHyperlinkable:!0,visibility:"public"}},{name:"ZoomToInitialExtent",metadata:{arguments:"none",description:"Zooms to the initial extent of the current Site.",
isHyperlinkable:!0,visibility:"public"}},{name:"ZoomToPreviousExtent",metadata:{arguments:"none",description:"Zooms to the previous recorded map extent if any.",isHyperlinkable:!0,visibility:"public"}},{name:"ZoomToNamedExtent",metadata:{arguments:"string",description:"Zooms to the bookmarked extent with the specified name.",isHyperlinkable:!0,visibility:"public"}},{name:"ZoomToNextExtent",metadata:{arguments:"none",description:"Zooms to the next recorded map extent if any.",isHyperlinkable:!0,visibility:"public"}},
{name:"ZoomToOfflineMapExtent",metadata:{arguments:"none",description:"Zooms to the extent of the currently active offline map.",isHyperlinkable:!0,visibility:"public"}},{name:"ZoomToFullExtent",metadata:{arguments:"none",description:"Zooms to the full extent of the current Site.",isHyperlinkable:!0,visibility:"public"}},{name:"MapResize",metadata:{arguments:"none",description:"Tells the map control to resize itself. This should be called after altering the map container's dimensions.",isHyperlinkable:!0,
visibility:"public"}},{name:"MaximizePanel",metadata:{arguments:"string",description:"Instructs the region hosting a view to maximize itself if it supports this action. As of v2.4, only the BottomPanelRegion and its sub regions support this action.",isHyperlinkable:!0,visibility:"public"}},{name:"RestorePanel",metadata:{arguments:"string",description:"Instructs the region hosting a view to restore itself to default dimensions if it supports this action. As of v2.4, only the BottomPanelRegion and its sub regions support this action.",
isHyperlinkable:!0,visibility:"public"}},{name:"AddTemporaryMarkupGeometry",metadata:{arguments:"esri.geometry.Geometry",description:"Adds a temporary markup graphic to the map. The {@link Commands.ClearTemporaryMarkup} command will clear this piece of markup.",isHyperlinkable:!0,visibility:"private"}},{name:"ClearTemporaryMarkup",metadata:{arguments:"none",description:"Removes temporary markup created by the command 'AddTemporaryMarkupGeometry'",isHyperlinkable:!0,visibility:"public"}},{name:"ClearTrustedUrls",
metadata:{arguments:"none",description:"Clears list of trusted URLs which are added by clicking 'yes' on potentially untrusted content popup",isHyperlinkable:!0,visibility:"public"}},{name:"ZoomToFeature",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",description:"Zooms to a feature.",isHyperlinkable:!0,visibility:"private"}},{name:"ZoomToFeatureIfOutsideMapExtent",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",description:"Zooms to a feature if the it's outside of the map's extent, otherwise nothing happens.",
isHyperlinkable:!0,visibility:"private"}},{name:"ZoomToFeatures",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.FeatureSet",description:"Zooms to the extent of all the features in the feature set.",isHyperlinkable:!0,visibility:"private"}},{name:"ZoomToAllFeatures",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature[]",description:"Zooms to the extent of all the features.",isHyperlinkable:!0,visibility:"private"}},{name:"ShowMap",metadata:{arguments:"none",description:"Activates map view.",
isHyperlinkable:!0,visibility:"public"}},{name:"ShowMapElement",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.ShowMapElementArgs",description:"Displays an element anchored to a specific point on the map.",isHyperlinkable:!0,visibility:"private"}},{name:"ShowMapCallout",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.ShowMapElementArgs",description:"Displays a map callout anchored to a given point.",isHyperlinkable:!0,visibility:"private"}},
{name:"HideMapElement",metadata:{arguments:"string",description:"Removes an element previously anchored to the map using {@link Commands.ShowMapElement}.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowMapTipResults",metadata:{arguments:"string",description:"Shows map tip results for a FeatureSetCollection previously added to the FeatureSetManager.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowMapTipResultsInCallout",metadata:{arguments:"string",description:"Shows map tip results for a FeatureSetCollection previously added to the FeatureSetManager, in a floating callout window on the map (the default behavior prior to version 2.4).",
isHyperlinkable:!0,visibility:"public"}},{name:"OpenDataFrame",metadata:{arguments:"none",description:"Opens the DataRegion, if it is present in the current shell.",isHyperlinkable:!0,visibility:"public"}},{name:"CloseDataFrame",metadata:{arguments:"none",description:"Closes the DataRegion, if it is present in the current shell.",isHyperlinkable:!0,visibility:"public"}},{name:"OpenBottomRegion",metadata:{arguments:"none",description:"Opens the BottomPanelRegion, if it is present in the current shell.",
isHyperlinkable:!0,visibility:"public"}},{name:"CloseBottomRegion",metadata:{arguments:"none",description:"Closes the BottomPanelRegion, if it is present in the current shell.",isHyperlinkable:!0,visibility:"public"}},{name:"RunWorkflowById",metadata:{arguments:"string",description:"Runs a workflow.",isHyperlinkable:!0,visibility:"public"}},{name:"RunWorkflowWithGeometry",metadata:{arguments:"object",description:"Runs a workflow with a geometry used as an input argument.",isHyperlinkable:!0,visibility:"private"}},
{name:"RunWorkflowWithArguments",metadata:{arguments:"object",description:"Runs a workflow with a set of input arguments.",isHyperlinkable:!0,visibility:"public"}},{name:"DisplayWorkflowContainerContent",metadata:{arguments:"object",description:"Displays a view in a workflow container.",isHyperlinkable:!0,visibility:"private"}},{name:"ClearActiveTool",metadata:{arguments:"none",description:"Clears the active tool.",isHyperlinkable:!0,visibility:"public"}},{name:"SetActiveTool",metadata:{arguments:"string",
description:"Sets the active tool.",isHyperlinkable:!0,visibility:"public"}},{name:"Geolocate",metadata:{arguments:"object",description:"Zooms to the current location of the device when it becomes available.",isHyperlinkable:!0,visibility:"public"}},{name:"GeolocateTrack",metadata:{arguments:"none",description:"Enables the tracking of the device's location when it is available, without panning the map.",isHyperlinkable:!0,visibility:"public"}},{name:"GeolocateFollow",metadata:{arguments:"none",description:"Enables the following of the device's location when it is available, panning the map.",
isHyperlinkable:!0,visibility:"public"}},{name:"GeolocateStop",metadata:{arguments:"none",description:"Stops the tracking and following of the device's location.",isHyperlinkable:!0,visibility:"public"}},{name:"GeolocateShowBuffer",metadata:{arguments:"none",description:"Display a circular buffer showing the accuracy of the latest GPS reading.",isHyperlinkable:!0,visibility:"public"}},{name:"GeolocateHideBuffer",metadata:{arguments:"none",description:"Hide a circular buffer showing the accuracy of the latest GPS reading.",
isHyperlinkable:!0,visibility:"public"}},{name:"TakeApplicationOffline",metadata:{arguments:"none",description:"Puts the application in an offline state.",isHyperlinkable:!1,visibility:"public"}},{name:"TapToDismiss",metadata:{arguments:"args: {view: framework.ui.ViewBase; onOtherInteracted?: (evt?: Event) => void ; onElementInteracted?: (evt?: Event) => void}",description:"Dismisses the specified view on the next tap anywhere on the screen. Optionally fires specified callbacks.",isHyperlinkable:!1,
visibility:"private"}},{name:"TakeApplicationOnline",metadata:{arguments:"none",description:"Connects the application to the internet.",isHyperlinkable:!1,visibility:"public"}},{name:"SetGMAFOfflineButtonState",metadata:{arguments:"string",description:"Sets the visibility of the online/offline button in the GMAF app.",isHyperlinkable:!0,visibility:"public"}},{name:"ToggleConnectivity",metadata:{arguments:"none",description:"Toggles the connectivity of the app, from offline to online or viceversa",
isHyperlinkable:!0,visibility:"public"}},{name:"RefreshOfflineMapsList",metadata:{arguments:"string",description:"Refresh the list of offline maps on the OfflineMapsList view.",isHyperlinkable:!1,visibility:"public"}},{name:"OpenFeatureSetCollection",metadata:{arguments:"string",description:"Opens the FeatureSetCollection.",isHyperlinkable:!0,visibility:"public"}},{name:"OpenPortalMyContentWindow",metadata:{arguments:"none",description:"Opens a new browser window to the authenticated users ArcGIS Portal 'My Content' page.",
isHyperlinkable:!0,visibility:"public"}},{name:"CloseFeatureSetCollection",metadata:{arguments:"string",description:"Closes the FeatureSetCollection.",isHyperlinkable:!0,visibility:"public"}},{name:"RemoveFeatureSetCollection",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.FeatureSetCollection",description:"Removes the specified collection from the FeatureSetManager.",isHyperlinkable:!0,visibility:"private"}},{name:"RemoveFeatureSetCollectionById",metadata:{arguments:"string",description:"Removes the collection specified by ID from the FeatureSetManager.",
isHyperlinkable:!0,visibility:"public"}},{name:"Search",metadata:{arguments:"string",description:"Performs a search on all active providers.",isHyperlinkable:!0,visibility:"public"}},{name:"GlobalSearch",metadata:{arguments:"string",description:"Performs a search on all active providers.",isHyperlinkable:!0,visibility:"public"}},{name:"BufferGeometry",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.buffer.BufferGeometryArgs",description:"Buffers input geometry, adds buffer markup to the map, and fires the callback and event with the buffered geometry. When the source command is specified, buffers using current settings for the command.",
isHyperlinkable:!0,visibility:"private"}},{name:"CancelEditCoordinate",metadata:{arguments:"none",description:"Cancels editing of a coordinate if currently active.",isHyperlinkable:!0,visibility:"public"}},{name:"CancelSearch",metadata:{arguments:"none",description:"Cancel the search on all providers.",isHyperlinkable:!0,visibility:"public"}},{name:"ClearSearch",metadata:{arguments:"none",description:"Clear the search results.",isHyperlinkable:!0,visibility:"public"}},{name:"ClearSelection",metadata:{arguments:"none",
description:"Clears the open identify results/selection.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowExportWebMapDialog",metadata:{arguments:"none",description:"Activates the export web map view.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowFeatureDetails",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",description:"Creates and displays the Feature Details dialog for the Feature or FeatureSetCollection specified.",isHyperlinkable:!0,visibility:"private"}},
{name:"ShowFeatureDetailsCompact",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",description:"Creates and displays the Feature Details dialog for the {@link geocortex.essentialsHtmlViewer.mapping.infrastructure.Feature} in Compact View mode. If the feature is not specified, details for the last feature will be displayed.",isHyperlinkable:!0,visibility:"private"}},{name:"ShowFeatureDetailsExpanded",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",
description:"Creates and displays the Feature Details dialog for the {@link geocortex.essentialsHtmlViewer.mapping.infrastructure.Feature} in Expanded View mode. If the feature is not specified, details for the last feature will be displayed.",isHyperlinkable:!0,visibility:"private"}},{name:"SetFeatureDetailsMode",metadata:{arguments:"string",description:"Sets the feature details dialog to the specified view mode.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowFeatureParentDetails",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",
description:"Shows the previously opened feature when browsing related features in the feature details view.",isHyperlinkable:!0,visibility:"private"}},{name:"ShowFeatureAttributeEditor",metadata:{arguments:"none",description:"Shows the feature attribute editor used to set feature attributes.",isHyperlinkable:!0,visibility:"public"}},{name:"HideFeatureAttributeEditor",metadata:{arguments:"none",description:"Hides the feature attribute editor used to set feature attributes.",isHyperlinkable:!0,visibility:"public"}},
{name:"ShowFeatureTemplatePicker",metadata:{arguments:"layer",description:"Shows the feature template picker used to create new features. If a layer is supplied, shows the templates for the layer.",isHyperlinkable:!0,visibility:"private"}},{name:"HideFeatureTemplatePicker",metadata:{arguments:"none",description:"Hides the feature template picker used to create new features.",isHyperlinkable:!0,visibility:"public"}},{name:"FSMCollectionSetCommand",metadata:{arguments:"string, string",description:"Set the preferred command to open the FeatureSetCollection for the given source name.",
isHyperlinkable:!0,visibility:"private"}},{name:"PanToAllFeatures",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature[]",description:"Pans to the extent of all the features.",isHyperlinkable:!0,visibility:"private"}},{name:"PanToFeature",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",description:"Pans to a Geocortex feature.",isHyperlinkable:!0,visibility:"private"}},{name:"PanToFeatureIfOutsideMapExtent",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",
description:"Pans to a Geocortex feature if the feature is outside of the map's extent, otherwise nothing happens.",isHyperlinkable:!0,visibility:"private"}},{name:"Project",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.ProjectArgs",description:"Calls a geometry service to project geometries between different coordinate systems.",isHyperlinkable:!1,visibility:"private"}},{name:"InvokeMapTip",metadata:{arguments:"esri.geometry.Geometry",description:'Executes an Identify operation on the given geometry and sets "MapTip" as its source tag.',
isHyperlinkable:!0,visibility:"private"}},{name:"ShowMapTip",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",description:"Displays a feature in the map tip view.",isHyperlinkable:!0,visibility:"private"}},{name:"ShowMapTipInCallout",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",description:"Displays a feature in a map tip callout anchored to the map.",isHyperlinkable:!0,visibility:"private"}},{name:"SuspendMapTips",metadata:{arguments:"none",description:"Suspends the display of map tips, allowing other components the opportunity to interact with the map without invoking map tips on click/tap events.",
isHyperlinkable:!0,visibility:"public"}},{name:"SwitchToLayerTheme",metadata:{arguments:"string",description:"Switches to the specified layer theme, identified by ID or display name.",isHyperlinkable:!0,visibility:"public"}},{name:"ResumeMapTips",metadata:{arguments:"none",description:"Resumes the previously suspended display of map tips.",isHyperlinkable:!0,visibility:"public"}},{name:"ClearStorageForApplication",metadata:{arguments:"none",description:"Clears the offline data for the current application.",
isHyperlinkable:!0,visibility:"public"}},{name:"ClearStorageForDomain",metadata:{arguments:"none",description:"Clears all offline data for the current domain. This includes data for all applications loaded from the current domain.",isHyperlinkable:!0,visibility:"public"}},{name:"ListReports",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.FeatureSetCollection",description:"Presents a user interface for choosing to run a report from a list of reports that are available to the given reportable input (group of features).",
isHyperlinkable:!1,visibility:"public"}},{name:"RunFeatureReport",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",description:"Alias to 'ListReports' for backwards compatibility with the Silverlight viewer.",isHyperlinkable:!0,visibility:"public"}},{name:"RunFeaturesReport",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.FeatureSetCollection",description:"Alias to 'ListReports' for backwards compatibility with the Silverlight viewer.",isHyperlinkable:!1,
visibility:"public"}},{name:"RunReport",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.RunReportArgs",description:"Runs a given report on the provided features, and displays the result (a download link to the report file) to the user.",isHyperlinkable:!1,visibility:"public"}},{name:"ShowResultsList",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.FeatureSetCollection",description:"Displays the list of features in the given FeatureSetCollection as a list.",
isHyperlinkable:!1,visibility:"private"}},{name:"ShowResultsTable",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.FeatureSetCollection",description:"Displays the list of features in the given FeatureSetCollection in a tabular view.",isHyperlinkable:!1,visibility:"private"}},{name:"SwitchToListResultsView",metadata:{arguments:"none",description:"Switches from Results Table to Results List view if the Results Table view is currently active.",isHyperlinkable:!0,visibility:"public"}},
{name:"SwitchToTabularResultsView",metadata:{arguments:"none",description:"Switches from Results List to Results Table view if the Results List view is currently active.",isHyperlinkable:!0,visibility:"public"}},{name:"OpenResultsFrame",metadata:{arguments:"none",description:"Activates the ResultsRegion.",isHyperlinkable:!0,visibility:"public"}},{name:"CloseResultsFrame",metadata:{arguments:"none",description:"Deactivates the ResultsRegion.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowLayerList",
metadata:{arguments:"none",description:"Displays the layer list.",isHyperlinkable:!0,visibility:"public"}},{name:"SwitchToLayerView",metadata:{arguments:"none",description:"Displays the layer list.",isHyperlinkable:!0,visibility:"public"}},{name:"SwitchToLegendView",metadata:{arguments:"none",description:"Displays the legend view.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowLayerActions",metadata:{arguments:"geocortex.essentials.Layer",description:"Shows available actions for a given layer.",
isHyperlinkable:!0,visibility:"private"}},{name:"ShowMapServiceActions",metadata:{arguments:"geocortex.essentials.MapService",description:"Shows available actions for a given map service.",isHyperlinkable:!0,visibility:"private"}},{name:"HideMapServiceActions",metadata:{arguments:"none",description:"Closes the map service actions view.",isHyperlinkable:!0,visibility:"private"}},{name:"PulseStatus",metadata:{arguments:"string",description:"Resets the timer of the status view model.",isHyperlinkable:!0,
visibility:"public"}},{name:"RemoveStatus",metadata:{arguments:"string",description:"Removes the status indicator from the screen with the specified ID.",isHyperlinkable:!0,visibility:"public"}},{name:"AddStatus",metadata:{arguments:"string",description:"Adds a status indicator to the screen.",isHyperlinkable:!0,visibility:"public"}},{name:"CreateHighlightLayer",metadata:{arguments:"string",description:"Creates a new highlight layer with the specified name.",isHyperlinkable:!0,visibility:"public"}},
{name:"SetActiveHighlightLayer",metadata:{arguments:"string",description:"Sets the layer with the specified name as active, if there is one.",isHyperlinkable:!0,visibility:"public"}},{name:"SetActiveHighlightLayerDefault",metadata:{arguments:"none",description:"Sets the default highlight layer as the active highlight layer.",isHyperlinkable:!0,visibility:"public"}},{name:"HighlightEsriFeatureSet",metadata:{arguments:"esri.tasks.FeatureSet",description:"Highlights all of the features in the specified Esri feature set in the active highlight layer.",
isHyperlinkable:!1,visibility:"private"}},{name:"SetHighlightBorderColor",metadata:{arguments:"string",description:"Sets the border color used for new highlights, specified in 6 or 8 digit hex in RGB or ARGB form.",isHyperlinkable:!0,visibility:"public"}},{name:"SetHighlightBorderWidth",metadata:{arguments:"number",description:"Sets the border width (in pixels) used for new highlights.",isHyperlinkable:!0,visibility:"public"}},{name:"SetHighlightFillColor",metadata:{arguments:"string",description:"Sets the current highlight fill color to use, if the feature does not specify one.",
isHyperlinkable:!0,visibility:"public"}},{name:"RemoveHighlightLayer",metadata:{arguments:"string",description:"Removes the highlight layer with the specified name, if there is one.",isHyperlinkable:!0,visibility:"public"}},{name:"AddMapService",metadata:{arguments:"essentials.MapService",description:"Integrate a map service and its sub-components into the viewer and onto the map.",isHyperlinkable:!0,visibility:"private"}},{name:"RemoveMapService",metadata:{arguments:"essentials.MapService",description:"Removes a user added map service off of the map and out of the viewer.",
isHyperlinkable:!0,visibility:"private"}},{name:"RemoveUserAddedLayer",metadata:{arguments:"essentials.Layer",description:"Remove a user added layer (and its parent map service) off of the map and out of the viewer.",isHyperlinkable:!0,visibility:"private"}},{name:"ClearHighlights",metadata:{arguments:"none",description:"Removes the highlights from the active highlight layer.",isHyperlinkable:!0,visibility:"public"}},{name:"ClearDefaultHighlights",metadata:{arguments:"none",description:"Removes the highlights from the default highlight layer.",
isHyperlinkable:!0,visibility:"public"}},{name:"HighlightFeatureSet",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.FeatureSet",description:"Highlights all of the features in the specified feature set in the active highlight layer.",isHyperlinkable:!0,visibility:"private"}},{name:"HighlightFeature",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",description:"Highlights the feature in the active highlight layer.",isHyperlinkable:!0,visibility:"private"}},
{name:"HighlightFeatureDefault",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",description:"Highlights the feature in the default highlight layer.",isHyperlinkable:!0,visibility:"private"}},{name:"AddMarkup",metadata:{arguments:"esri.geometry.Geometry",description:"Adds the given geometry to the markup layer.",isHyperlinkable:!0,visibility:"private"}},{name:"AddMarkupGeometry",metadata:{arguments:"esri.geometry.Geometry",description:"Adds the given geometry to the markup layer.  (Identical to the AddMarkup command.)",
isHyperlinkable:!0,visibility:"private"}},{name:"AddTextMarkup",metadata:{arguments:"esri.geometry.Geometry",description:"Prompts the user for text to add as markup. When completed, text markup is added at the provided geometry.",isHyperlinkable:!0,visibility:"private"}},{name:"ClearMarkup",metadata:{arguments:"none",description:"Prompts the user for confirmation, and if approved, clears all of the markup from the markup layer.",isHyperlinkable:!0,visibility:"public"}},{name:"ClearMarkupQuiet",metadata:{arguments:"none",
description:"Clears all of the markup from the markup layer without prompting for confirmation.",isHyperlinkable:!0,visibility:"public"}},{name:"MeasureDistance",metadata:{arguments:"esri.geometry.Polyline",description:"Computes the total and segment distance measurements for the specified Polyline geometry and plots it on the map along with its measurements. NOTE: An Esri or Geocortex feature may also be provided as arguments in lieu of a polyline geometry.",isHyperlinkable:!0,visibility:"private"}},
{name:"MeasureArea",metadata:{arguments:"esri.geometry.Polygon",description:"Computes the area, perimeter and individual segment distances for the specified Polylgon geometry and plots it on the map along with its measurements. NOTE: An Esri or Geocortex feature may also be provided as arguments in lieu of a polygon geometry.",isHyperlinkable:!0,visibility:"private"}},{name:"DeleteMeasurement",metadata:{arguments:"esri.geometry.Geometry",description:"Deletes measurement markup within the given geometry",
isHyperlinkable:!0,visibility:"private"}},{name:"SetMeasurementUnits",metadata:{arguments:"string, string",description:"Sets the measurement units for the measurements performed by the measurement module. Also updates existing measurements already on the map.",isHyperlinkable:!1,visibility:"private"}},{name:"ResizeShell",metadata:{arguments:"none",description:"Recalculate the size and layout of the shell and refresh the shell accordingly.",isHyperlinkable:!0,visibility:"public"}},{name:"ActivateHomePanel",
metadata:{arguments:"none",description:"Activates Home Panel if it is configured to be included.",isHyperlinkable:!0,visibility:"public"}},{name:"ActivatePlotCoordinatesView",metadata:{arguments:"none",description:"Activates the Plot Coordinates view.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowHomePanel",metadata:{arguments:"none",description:"Activates Home Panel if it is configured to be included.",isHyperlinkable:!0,visibility:"public"}},{name:"HideHomePanel",metadata:{arguments:"none",
description:"Deactivates/hides the Home Panel if it is configured to be included.",isHyperlinkable:!0,visibility:"public"}},{name:"AttachFileToFeature",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",description:"Checks for HTML5 FileReader / Cordova support and activates File Attachments if supported.",isHyperlinkable:!0,visibility:"private"}},{name:"ToggleToolbar",metadata:{arguments:"none",description:"Toggles the visibility of the toolbar if present.",isHyperlinkable:!0,
visibility:"public"}},{name:"OpenToolbar",metadata:{arguments:"none",description:"Opens the toolbar, if present.",isHyperlinkable:!0,visibility:"public"}},{name:"CloseToolbar",metadata:{arguments:"none",description:"Closes the toolbar, if present.",isHyperlinkable:!0,visibility:"public"}},{name:"PrintMap",metadata:{arguments:"none",description:"Displays a dialog to create a printable map.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowExportMapDialog",metadata:{arguments:"none",description:"Displays a dialog to save a map image.",
isHyperlinkable:!0,visibility:"public"}},{name:"ShowLayerCatalog",metadata:{arguments:"none",description:"Shows the layer catalog view.",isHyperlinkable:!0,visibility:"public"}},{name:"ActivateTimeSlider",metadata:{arguments:"none",description:"Activates and shows the Time Slider if time slider profiles are available in the site.",isHyperlinkable:!0,visibility:"public"}},{name:"DeactivateTimeSlider",metadata:{arguments:"none",description:"Deactivates time settings applied to the map and hides the Time Slider.",
isHyperlinkable:!0,visibility:"public"}},{name:"HideTimeSlider",metadata:{arguments:"none",description:"Hides the time slider if currently visible but does not deactivate time settings applied to the map.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowTimeSliderSettings",metadata:{arguments:"none",description:"Shows the time slider settings view.",isHyperlinkable:!0,visibility:"public"}},{name:"HideTimeSliderSettings",metadata:{arguments:"none",description:"Hides the time slider settings view.",
isHyperlinkable:!0,visibility:"public"}},{name:"ToggleTimeSliderActions",metadata:{arguments:"none",description:"Toggles the time slider actions container visibility.",isHyperlinkable:!0,visibility:"public"}},{name:"SetTimeSliderProfile",metadata:{arguments:"none",description:"Validates and sets a specified time slider profile.",isHyperlinkable:!1,visibility:"private"}},{name:"AddCatalogLayers",metadata:{arguments:"Comma seperated string of layer ids.",description:"Adds catalog layers.",isHyperlinkable:!1,
visibility:"public"}},{name:"AppendCatalogLayers",metadata:{arguments:"Comma seperated string of layer ids.",description:"Appends catalog layers.",isHyperlinkable:!1,visibility:"public"}},{name:"ClearLayerCatalogLayers",metadata:{arguments:"none",description:"Clears all catalog layers.",isHyperlinkable:!0,visibility:"public"}},{name:"RemoveLayerCatalogIds",metadata:{arguments:"A string array of CatalogIds to be removed",description:"Removes specific catalog layers",isHyperlinkable:!1,visibility:"public"}},
{name:"ShowBookmarks",metadata:{arguments:"none",description:"Displays the Bookmarked Locations menu if the BookmarkViewModel's property, bookmarksEnabled, is set to true.",isHyperlinkable:!0,visibility:"public"}},{name:"AddBookmark",metadata:{arguments:"string",description:"Bookmark the current extent with the given name.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowAddBookmark",metadata:{arguments:"none",description:"Prompts the user to bookmark the current extent by entering a name.",isHyperlinkable:!0,
visibility:"public"}},{name:"ShowCoordinateActions",metadata:{arguments:"string",description:"Shows the configured coordinate actions.",isHyperlinkable:!0,visibility:"public"}},{name:"RemoveBookmark",metadata:{arguments:"string",description:"Removes a bookmark with the given name if exists.",isHyperlinkable:!0,visibility:"public"}},{name:"SelectBaseMap",metadata:{arguments:"string",description:"A map can have a number of basemaps associated with it. SelectBaseMap allows you to programmatically select one of the basemaps to display. All other basemaps are then faded out.",
isHyperlinkable:!0,visibility:"public"}},{name:"ActivateSelectLayersForIdentify",metadata:{arguments:"none",description:"Activates the Layer Selector for Identify and applies current settings.",isHyperlinkable:!0,visibility:"public"}},{name:"DeactivateSelectLayersForIdentify",metadata:{arguments:"none",description:"Deactivates the Layer Selector for Identify and enables all default identifiable layers.",isHyperlinkable:!0,visibility:"public"}},{name:"ActivateBuffering",metadata:{arguments:"string|string[]",
description:"Activates buffering for the specified command(s). Uses currently configured settings for the command.",isHyperlinkable:!0,visibility:"public"}},{name:"ActivateBufferingAndDisplayOptions",metadata:{arguments:"string",description:"Activates buffering for the specified command and displays the associated Buffer Options dialog. ",isHyperlinkable:!0,visibility:"public"}},{name:"ActivateTransientElements",metadata:{arguments:"string",description:"Activates any transient elements configured against a specific ID in the toolbar module.",
isHyperlinkable:!0,visibility:"public"}},{name:"DeactivateBuffering",metadata:{arguments:"string|string[]",description:"Deactivates buffering, if active, for the specified command(s).",isHyperlinkable:!0,visibility:"public"}},{name:"DeactivateBufferingAndDismissOptions",metadata:{arguments:"string",description:"Deactivates buffering for the specified command and dismisses the associated Buffer Options dialog if its active. ",isHyperlinkable:!0,visibility:"public"}},{name:"DeactivateTransientElements",
metadata:{arguments:"string",description:"Deactivates any transient elements configured against a specific ID in the toolbar module.",isHyperlinkable:!0,visibility:"public"}},{name:"DeleteAllCoordinates",metadata:{arguments:"none",description:"Deletes all plotted Coordinates from the map.",isHyperlinkable:!0,visibility:"public"}},{name:"DeleteCoordinates",metadata:{arguments:"string|string[]",description:"Deletes one or many plotted Coordinates from the map.",isHyperlinkable:!0,visibility:"public"}},
{name:"EditCoordinate",metadata:{arguments:"string|null",description:"Edits a plotted Coordinate on the map or creates a new coordinate in edit mode if no descriptor Id is provided.",isHyperlinkable:!0,visibility:"public"}},{name:"EditMarkup",metadata:{arguments:"esri.geometry.Geometry",description:"Edits markup that intersects the extent of the provided geometry.",isHyperlinkable:!0,visibility:"private"}},{name:"DeleteMarkup",metadata:{arguments:"esri.geometry.Geometry",description:"Deletes markup within the given geometry",
isHyperlinkable:!0,visibility:"private"}},{name:"CreateMarkupStyleView",metadata:{arguments:"string",description:"Activates the style picker if 'point', 'polyline', 'polygon', or 'text' is the string provided. If it is null, then the app will try and detect what style selector to activate.",isHyperlinkable:!0,visibility:"public"}},{name:"ChangeMarkupStyle",metadata:{arguments:"MarkupTemplate",description:"Takes a MarkupTemplate, PointTemplate, PolylineTemplate, PolygonTemplate, or TextTemplate. It will change the style of the markup to suit the template provided.",
isHyperlinkable:!0,visibility:"private"}},{name:"StopEditingMarkup",metadata:{arguments:"boolean",description:"Stops editing. If arg is true, clears the active tool, if arg is false, doesn't clear active tool.",isHyperlinkable:!0,visibility:"public"}},{name:"StartEditingFeature",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",description:"Shows the editing form.",isHyperlinkable:!0,visibility:"private"}},{name:"EnableSearchRefinement",metadata:{arguments:"boolean",description:"Enables or disables the refinement of a global search from within search hints (if any).",
isHyperlinkable:!0,visibility:"public"}},{name:"ExportResultsTo",metadata:{arguments:"{ format: string, fsc: geocortex.essentialsHtmlViewer.mapping.infrastructure.FeatureSetCollection }",description:"Enables or disables the refinement of a global search from within search hints (if any).",isHyperlinkable:!0,visibility:"private"}},{name:"ExportMarkupLayer",metadata:{arguments:"none",description:"Exports markup layer.",isHyperlinkable:!0,visibility:"public"}},{name:"ExportGraphicsLayer",metadata:{arguments:"{ args:  geocortex.essentialsHtmlViewer.mapping.infrastructure.commandArgs.ExportGraphicsLayerArgs}",
description:"Exports graphics layer.",isHyperlinkable:!1,visibility:"public"}},{name:"HideAllCoordinates",metadata:{arguments:"none",description:"Hides all plotted Coordinates temporarily.",isHyperlinkable:!0,visibility:"public"}},{name:"HideCoordinates",metadata:{arguments:"string|string[]",description:"Hides one or many plotted Coordinates temporarily.",isHyperlinkable:!0,visibility:"public"}},{name:"HideCoordinateActions",metadata:{arguments:"none",description:"Hide any coordinate actions view that is currently open.",
isHyperlinkable:!0,visibility:"public"}},{name:"SignIn",metadata:{arguments:"string",description:"Navigates to the sign-in page. The sign in experience can be customized by crafting a custom sign-in URL, otherwise the default sign-in URL for the site will be used.",isHyperlinkable:!0,visibility:"public"}},{name:"SignOut",metadata:{arguments:"string",description:"Navigates to the sign-out page, which will sign the current user out.",isHyperlinkable:!0,visibility:"public"}},{name:"LogOptimizerEvent",
metadata:{arguments:"string, string",description:"Logs an event for Geocortex Optimizer.",isHyperlinkable:!0,visibility:"private"}},{name:"AddPushpin",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",description:"Creates and displays a pushpin for the Feature specified.",isHyperlinkable:!0,visibility:"private"}},{name:"AddPushpins",metadata:{arguments:"string",description:"Creates and displays pushpins for the FeatureSetCollection specified.",isHyperlinkable:!0,visibility:"public"}},
{name:"RemovePushpin",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",description:"Removes the pushpin from the map for the given feature, if there is one.",isHyperlinkable:!0,visibility:"private"}},{name:"RemovePushpins",metadata:{arguments:"none",description:"Removes all pushpins from the map.",isHyperlinkable:!0,visibility:"public"}},{name:"EnablePushpins",metadata:{arguments:"none",description:"Enables the display of pushpins/markers on the map.",isHyperlinkable:!0,visibility:"public"}},
{name:"DisablePushpins",metadata:{arguments:"none",description:"Disables the display of pushpins/markers on the map.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowPushpins",metadata:{arguments:"none",description:"Displays pushpins by setting their visibility to true, for each result in the results list or results table.  Pushpins must be enabled for this command to work.",isHyperlinkable:!0,visibility:"public"}},{name:"StopFeaturePlacementState",metadata:{arguments:"none",description:"Cancels any feature placement while a feature is being created or edited.",
isHyperlinkable:!0,visibility:"public"}},{name:"HidePushpins",metadata:{arguments:"none",description:"Prevents the display of pushpins by setting their visibility to false.  Pushpins must be enabled for this command to work.",isHyperlinkable:!0,visibility:"public"}},{name:"SetCollectionOfInterest",metadata:{arguments:"string",description:"Sets the FeatureSetCollection of interest that will be used to generate data for Charts.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowChartingView",metadata:{arguments:"none",
description:"Activates the charting view.",isHyperlinkable:!0,visibility:"public"}},{name:"DisplayBufferOptions",metadata:{arguments:"string",description:"Displays the Buffer Options dialog for the specified target command",isHyperlinkable:!0,visibility:"public"}},{name:"DisplayChartById",metadata:{arguments:"string",description:"Opens the specified chart in the charting view.",isHyperlinkable:!0,visibility:"public"}},{name:"RemoveChartById",metadata:{arguments:"string",description:"Removes the specified chart from the charting view.",
isHyperlinkable:!0,visibility:"public"}},{name:"ClearCharts",metadata:{arguments:"none",description:"Removes all charts from the charting view.",isHyperlinkable:!0,visibility:"public"}},{name:"ClearFeatureInformation",metadata:{arguments:"none",description:"Used to 'reset' the information stored within RelatedFeatures (which features are currently open, etc.)",isHyperlinkable:!0,visibility:"public"}},{name:"DisableMapClick",metadata:{arguments:"none",description:"Prevents the commands configured to execute on map click from executing and also prevents the MapClickedEvent from firing.",
isHyperlinkable:!0,visibility:"public"}},{name:"DisableMapTips",metadata:{arguments:"none",description:"Disables the display of map tips on the map.",isHyperlinkable:!0,visibility:"public"}},{name:"EnableAllLayersForIdentify",metadata:{arguments:"none",description:"Enables all identifiable layers such that they participate in Identify operations",isHyperlinkable:!0,visibility:"public"}},{name:"DisableAllLayersForIdentify",metadata:{arguments:"none",description:"Disables all identifiable layers such that they do not participate in Identify operations",
isHyperlinkable:!0,visibility:"public"}},{name:"EnableLayerForIdentify",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.identify.LayerDescriptor",description:"Enables the specified layer, if it's identifiable, such that it participates in Identify operations.",isHyperlinkable:!0,visibility:"public"}},{name:"DisableLayerForIdentify",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.identify.LayerDescriptor",description:"Disables the specified layer, if it's in the list of identifiable layers, such that it does not participate in Identify operations.",
isHyperlinkable:!0,visibility:"public"}},{name:"EnableMapClick",metadata:{arguments:"none",description:"Enables all configured commands to execute on map click and also wires up the MapClickEvent to fire when the map is clicked.",isHyperlinkable:!0,visibility:"public"}},{name:"EnableMapTips",metadata:{arguments:"none",description:"Enables the display of map tips on the map.",isHyperlinkable:!0,visibility:"public"}},{name:"HideAllMapTips",metadata:{arguments:"none",description:"Prevents the display of map tips by setting their visibility to `false`.  Map tips must be enabled for this command to work.",
isHyperlinkable:!0,visibility:"public"}},{name:"HideMapTips",metadata:{arguments:"none",description:"Prevents the display of map tips by setting their visibility to `false`, and suspends displaying map tips.  Map tips must be enabled for this command to work.",isHyperlinkable:!0,visibility:"public"}},{name:"RestoreAllMapTips",metadata:{arguments:"none",description:"Displays previously hidden map tips by setting their visibility to `true`.  Map tips must be enabled for this command to work.",isHyperlinkable:!0,
visibility:"public"}},{name:"ShowAllCoordinates",metadata:{arguments:"none",description:"Shows all plotted coordinates (including temporarily hidden ones) on the map.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowCoordinates",metadata:{arguments:"string|string[]",description:"Shows one or many plotted, hidden Coordinates on the map.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowMapTips",metadata:{arguments:"none",description:"Displays previously hidden map tips by setting their visibility to `true`, and resumes displaying map tips.  Map tips must be enabled for this command to work.",
isHyperlinkable:!0,visibility:"public"}},{name:"ToggleMouseCoordinates",metadata:{arguments:"none",description:"Toggles the visibility of the mouse coordinates widget if present.",isHyperlinkable:!0,visibility:"public"}},{name:"SetTimeExtent",metadata:{arguments:"esri.TimeExtent",description:"Sets the time extent for the map.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowShareView",metadata:{arguments:"none",description:"Activates the share view",isHyperlinkable:!0,visibility:"public"}},{name:"ShareOn",
metadata:{arguments:"string",description:"Shares the Viewer url on the specified platform",isHyperlinkable:!0,visibility:"public"}},{name:"ScreenReaderNarrate",metadata:{arguments:"string",description:"If a user has screenreader software enabled, then the provided string is immediately spoken to them.",isHyperlinkable:!0,visibility:"public"}},{name:"DisableScreenReaderNarrate",metadata:{arguments:"none",description:"Disables the 'ScreenReaderNarrate' command temporarily.",isHyperlinkable:!0,visibility:"public"}},
{name:"EnableScreenReaderNarrate",metadata:{arguments:"none",description:"Enables screen reader narration if it was previously disabled using DisableScreenReaderNarrate.",isHyperlinkable:!0,visibility:"public"}},{name:"BroadcastCurrentViewpoint",metadata:{arguments:"string",description:"Broadcasts the viewers current viewpoint to the specified external component.",isHyperlinkable:!0,visibility:"private"}},{name:"UpdateStatus",metadata:{arguments:"string",description:"Updates the message shown on the status indicator.",
isHyperlinkable:!0,visibility:"public"}},{name:"UploadData",metadata:{arguments:"none",description:"Prompt the user to upload layers onto the map straight from their own computer.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowExternalComponentView",metadata:{arguments:"none",description:"Activates the external component view.",isHyperlinkable:!0,visibility:"public"}},{name:"DisplayDockedExternalComponentById",metadata:{arguments:"string",description:"Opens the specified external component in the external components view. If this component is open in a separate window, it will be closed.",
isHyperlinkable:!0,visibility:"public"}},{name:"DisplayUndockedExternalComponentById",metadata:{arguments:"string",description:"Opens the specified external component in a separate window from the viewer. If this component is open in the viewer, it will be closed.",isHyperlinkable:!0,visibility:"public"}},{name:"RemoveExternalComponentById",metadata:{arguments:"string",description:"Removes the specified external component from the viewer. If the component is in a separate window, that window will be closed.",
isHyperlinkable:!0,visibility:"public"}},{name:"ToggleExternalComponentSyncById",metadata:{arguments:"string",description:"Toggle whether the specified external component is synchronized with the viewer.",isHyperlinkable:!0,visibility:"private"}},{name:"ListenToExternalComponentFrame",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.integration.ComponentFrameInfo",description:"Wires up a PostMessage Transport and enables bi-directional communication with the component.",isHyperlinkable:!0,
visibility:"private"}},{name:"CreateOrEditFeatureFromBarcodeScan",metadata:{arguments:"object",description:"Launch the barcode scanner, and use the result to create a new feature or edit an existing one.",isHyperlinkable:!0,visibility:"public"}},{name:"LaunchBarcodeScannerWithCallback",metadata:{arguments:"none",description:"Lauches a QR scan, then calls the provided callback with the result.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowMarkers",metadata:{arguments:"none",description:"Displays markers by setting their visibility to `true`.",
isHyperlinkable:!0,visibility:"private"}},{name:"HideMarkers",metadata:{arguments:"none",description:"Prevents the display of markers by setting their visibility to `false`.",isHyperlinkable:!0,visibility:"private"}},{name:"AddMarker",metadata:{arguments:"string",description:"Creates and displays a marker on the map.",isHyperlinkable:!0,visibility:"private"}},{name:"RemoveMarker",metadata:{arguments:"string",description:"Removes the marker from the map.",isHyperlinkable:!0,visibility:"private"}},
{name:"UpdateMarker",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.MarkerArgs",description:"Updates the marker with the given marker arguments.",isHyperlinkable:!0,visibility:"private"}},{name:"ShowAccessibilityView",metadata:{arguments:"none",description:"Activates the accessibility view.",isHyperlinkable:!0,visibility:"public"}},{name:"AddClusterLayer",metadata:{arguments:"string",description:"Adds a cluster layer to an existing Geocortex Layer that holds an Esri FeatureLayer.",
isHyperlinkable:!0,visibility:"public"}},{name:"RemoveClusterLayer",metadata:{arguments:"string",description:"Removes a cluster layer from an existing Geocortex Layer that holds an Esri FeatureLayer.",isHyperlinkable:!0,visibility:"public"}},{name:"AddHeatMap",metadata:{arguments:"string",description:"Adds a heat map visualization to a given Geocortex layer.",isHyperlinkable:!0,visibility:"public"}},{name:"Redo",metadata:{arguments:"none",description:"Reverses the last recorded undo operation or transaction.",
isHyperlinkable:!0,visibility:"public"}},{name:"RemoveHeatMap",metadata:{arguments:"string",description:"Removes a heat map visualization from a Geocortex layer.",isHyperlinkable:!0,visibility:"public"}},{name:"RemoveVisualization",metadata:{arguments:"string",description:"Removes the visualization from a Geocortex layer, if one is enabled.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowVisualizationView",metadata:{arguments:"string",description:"Shows the visualization options view for a given Geocortex layer if the layer supports any visualizations.",
isHyperlinkable:!0,visibility:"public"}},{name:"Undo",metadata:{arguments:"none",description:"Invokes the last recorded undo operation or transaction.",isHyperlinkable:!0,visibility:"public"}},{name:"CreateGraphicsInMemory",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.EditInMemoryArgs",description:"Creates new graphics. These edits are only applied to the graphics layer in memory.",isHyperlinkable:!0,visibility:"private"}},{name:"UpdateGraphicsInMemory",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.UpdateGraphicsArgs",
description:"Updates existing graphics. These edits are only applied to the graphics layer in memory.",isHyperlinkable:!0,visibility:"private"}},{name:"DeleteGraphicsInMemory",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.EditInMemoryArgs",description:"Deletes graphics. These edits are only applied to the graphics layer in memory.",isHyperlinkable:!0,visibility:"private"}},{name:"CutGraphicsInMemory",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.CutGraphicsArgs",
description:"Cut graphics using a polyline. These edits are only applied to the graphics layer in memory.",isHyperlinkable:!0,visibility:"private"}},{name:"ExplodeGraphicsInMemory",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.EditInMemoryArgs",description:"Separates multi-part graphics into individual graphics. These edits are only applied to the graphics layer in memory.",isHyperlinkable:!0,visibility:"private"}},{name:"UnionGraphicsInMemory",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.EditInMemoryArgs",
description:"Merge graphics into a single graphic. These edits are only applied to the graphics layer in memory.",isHyperlinkable:!0,visibility:"private"}},{name:"DeleteProject",metadata:{arguments:"string",description:"Deletes a project.",isHyperlinkable:!0,visibility:"public"}},{name:"LoadProject",metadata:{arguments:"string",description:"Loads a project and applies it to the viewer.",isHyperlinkable:!0,visibility:"public"}},{name:"ListSelections",metadata:{arguments:"none",description:"List the available selections.",
isHyperlinkable:!0,visibility:"public"}},{name:"RefreshProjectsList",metadata:{arguments:"none",description:"Refresh the list of browsable projects.",isHyperlinkable:!0,visibility:"public"}},{name:"RegisterChartPointAdapter",metadata:{arguments:"object",description:"Register the chart point adapter.",isHyperlinkable:!0,visibility:"private"}},{name:"SaveAsProject",metadata:{arguments:"none",description:"Displays the user interface to fill in details about a project to be saved.",isHyperlinkable:!0,
visibility:"public"}},{name:"SaveProject",metadata:{arguments:"none",description:"Save the current state of the viewer as a project or displays the user interface to fill in details about the project to be saved.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowProjectEditor",metadata:{arguments:"string",description:"Shows the user interface for editing a project.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowProjects",metadata:{arguments:"none",description:"Shows the user interface for browsing and loading projects.",
isHyperlinkable:!0,visibility:"public"}},{name:"ShowShareProject",metadata:{arguments:"string",description:"Shows the user interface for sharing projects.",isHyperlinkable:!0,visibility:"public"}},{name:"HideFeatureDetails",metadata:{arguments:"none",description:"Hides the Feature Details dialog.",isHyperlinkable:!0,visibility:"public"}},{name:"ShowSaveSelectionDialog",metadata:{arguments:"string",description:"Displays a dialog to save a FeatureSetCollection as a named selection.",isHyperlinkable:!0,
visibility:"public"}},{name:"CreateSelection",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.SelectionArgs",description:"Creates a new named, saved selection based on the supplied FeatureSetCollection.",isHyperlinkable:!0,visibility:"private"}},{name:"DeleteSelection",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.SelectionArgs",description:"Deletes a named selection.",isHyperlinkable:!0,visibility:"private"}},{name:"FindSelection",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.FindSelectionArgs",
description:"Looks up a particular named selection.",isHyperlinkable:!0,visibility:"private"}},{name:"RenameSelection",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.RenameSelectionArgs",description:"Assigns a new name to a saved selection.",isHyperlinkable:!0,visibility:"private"}},{name:"RestoreSelection",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.SelectionArgs",description:"Loads a named, saved selection into the results view.",isHyperlinkable:!0,
visibility:"private"}},{name:"UpdateSelection",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.SelectionArgs",description:"Updates an existing named, saved selection with the supplied FeatureSetCollection.",isHyperlinkable:!0,visibility:"private"}},{name:"UpdateSelectionFindAllSelectionMetadata",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.FindAllSelectionMetadataArgs",description:"Lists all the available metadata for named selections.",
isHyperlinkable:!0,visibility:"private"}},{name:"FindMetadataForSelection",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.FindMetadataForSelectionArgs",description:"Looks up metadata about a particular named selection.",isHyperlinkable:!0,visibility:"private"}},{name:"AddFeatureToResults",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",description:"Adds an individual feature to the current FeatureSetCollection displayed in the results view.",
isHyperlinkable:!0,visibility:"public"}},{name:"RemoveFeatureFromResults",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.Feature",description:"Removes an individual feature from the current FeatureSetCollection displayed in the results view.",isHyperlinkable:!0,visibility:"public"}},{name:"CombineResults",metadata:{arguments:"essentialsHtmlViewer.mapping.infrastructure.commandArgs.CombineResultsArgs",description:"Performs advanced set operations with multiple lists of results.",
isHyperlinkable:!0,visibility:"public"}},{name:"CombineResultsInteractive",metadata:{arguments:"object",description:"Performs advanced set operations with multiple lists of results.",isHyperlinkable:!0,visibility:"public"}},{name:"ResultsIntersect",metadata:{arguments:"string",description:"Only keeps results from the current set of results that also appear in the supplied FeatureSetCollection.",isHyperlinkable:!0,visibility:"public"}},{name:"ResultsReplace",metadata:{arguments:"string",description:"Replaces the current set of results with the FeatureSetCollection supplied as argument.",
isHyperlinkable:!0,visibility:"public"}},{name:"ResultsSubtract",metadata:{arguments:"string",description:"Removes the supplied FeatureSetCollection from the current set of results.",isHyperlinkable:!0,visibility:"public"}},{name:"ResultsUnion",metadata:{arguments:"string",description:"Adds the supplied FeatureSetCollection to the current set of results.",isHyperlinkable:!0,visibility:"public"}},{name:"AddResultsStatus",metadata:{arguments:"string",description:"Displays a status indicator that can relay short messages in the results list or table.",
isHyperlinkable:!0,visibility:"public"}},{name:"RemoveResultsStatus",metadata:{arguments:"none",description:"Removes the status indicator from the results list or table.",isHyperlinkable:!0,visibility:"public"}}];d.metadataForCommandName=function(h){for(var g=0;g<d.commandsMetadata.length;g++){var m=d.commandsMetadata[g];if(m.name===h)return m.metadata}return null};d.publicCommands=function(){for(var h=[],g=0;g<d.commandsMetadata.length;g++){var m=d.commandsMetadata[g];"public"===m.metadata.visibility&&
h.push(m)}return h}})(d.Commands||(d.Commands={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){var g=[],m=!1,c=function(){function b(a){this._debounceInterval=250;this._flags=0;this._app=a}b.prototype.hasFlag=function(a){return(this._flags&a)===a};b.prototype.setFlag=function(a){this._flags|=a};b.prototype.screenUris=function(a){this._siteValidator||(this._siteValidator=new d.validation.SiteUrlValidator(this._app));for(var e=[],b=0;b<a.length;b++){var l=a[b];l.uri=this._screenDataUri(l.uri);null===l.uri?this._app.trace.debug("Skipped unknown, untrusted data URI."):
e.push(l)}return this._validateUris(e)};b.prototype.tryScreenNavLinkSynchronously=function(a){if(!this._siteValidator)return!1;var e=this._siteValidator.tryValidateSynchronously(a.uri);return e?e:this._getMemoizedResult(a)||!1};b.prototype._validateUris=function(a){var e=this,b=[],l=[],l=a.map(function(a){return new Promise(function(l,c){var s=a.uri;return e.hasFlag(2)&&a.type===d.FilterUtils.UriType.Markup&&"img"===a.tag&&"src"===a.attribute?l(a):e._validateUriAgainstSite(a).then(function(e){if(null==
e.validatedValue||""===e.validatedValue)return a.uri=s,b.push(a),l(null);a.type===d.FilterUtils.UriType.NavigableLink&&a.forcePrompt&&b.push(a);return l(a)},function(e){a.uri=s;b.push(a);return l(a)})})});return Promise.all(l).then(function(){return e._promptForUris(b)}).then(function(){return a})};b.prototype._validateUriAgainstSite=function(a){return this._siteValidator?this._siteValidator.validate(a.uri):(a.uri="",Promise.resolve({validatedValue:null}))};b.prototype._promptForUris=function(a){var e=
this;return Promise.map(a,function(a,b){return new Promise(function(b,l){e._enqueueConfirmation({uriDetails:a,resolve:b})})})};b.prototype._enqueueConfirmation=function(a){g.push(a);this._processConfirmationQueue()};b.prototype._processConfirmationQueue=function(){if(!m){m=!0;try{for(;g.length;){var a=g.shift();if(this._getConfirmation(a))return}}catch(e){throw m=!1,e;}m=!1}};b.prototype._getConfirmation=function(a){var e=this;if(!a.uriDetails.forcePrompt&&this.hasFlag(1))return a.resolve(a.uriDetails),
!1;var b=a.uriDetails.type===d.FilterUtils.UriType.NavigableLink,l=this._getMemoizedResult(a.uriDetails);if(b||!0!==l){if(b||!1!==l){var l=function(l){m=!1;e._memoizeResult(a.uriDetails,l);!0!==l&&(a.uriDetails.uri="");a.resolve(a.uriDetails);try{if(b){var n=a.uriDetails.linkChallengeCallback;n&&n(l,a.uriDetails)}}finally{e._processConfirmationQueue()}},n={okLabel:this._app.getResource("Mapping.Infrastructure","language-content-policy-prompt-uri-accept-btn"),cancelLabel:this._app.getResource("Mapping.Infrastructure",
"language-content-policy-prompt-uri-reject-btn")},c=this._app.getResource("Mapping.Infrastructure","language-content-policy-prompt-uri-title"),p=this._app.getResource("Mapping.Infrastructure","language-content-policy-prompt-uri-desc"),p=p.format(a.uriDetails.uri);if(this._app.command("Confirm").canExecute(p,c,l,n))this._app.command("Confirm").execute(p,c,l,n);else return n=window.confirm(p),l(n),!1;return!0}a.uriDetails.uri="";a.resolve(a.uriDetails);return!1}a.resolve(a.uriDetails);return!1};b.prototype._getMemoizationKey=
function(a){var e;e=this.hasFlag(4)?d.UrlUtils.parseUrl(a.uri):d.UrlUtils.getFolder(a.uri);e=String.quickHashCode(e.toString());return"uri."+d.FilterUtils.UriType[a.type].toLowerCase()+"."+e};b.prototype._memoizeResult=function(a,e){var b=this._getMemoizationKey(a);window.localStorage.setItem(b,e.toString())};b.prototype._getMemoizedResult=function(a){a=this._getMemoizationKey(a);a=window.localStorage.getItem(a);return null===a?null:"true"===a};b.prototype._screenDataUri=function(a){var e=!!d.FilterUtils.DataUri.parseDataUri(a),
b=d.FilterUtils.DataUri.isDataUriSafe(a);return!e||b?a:""};return b}();d.ContentPolicy=c})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){function h(b){if(b=c[b])return b;throw Error("Units cannot be converted because are not supported");}var c={};c[d.essentials.DistanceUnitType.METERS]=1;c[d.essentials.DistanceUnitType.MILLIMETERS]=0.001;c[d.essentials.DistanceUnitType.CENTIMETERS]=0.01;c[d.essentials.DistanceUnitType.DECIMETERS]=0.1;c[d.essentials.DistanceUnitType.KILOMETERS]=1E3;c[d.essentials.DistanceUnitType.INCHES]=0.0254;c[d.essentials.DistanceUnitType.FEET]=0.3048;
c[d.essentials.DistanceUnitType.US_SURVEY_FEET]=0.3048006096012192;c[d.essentials.DistanceUnitType.YARDS]=0.9144;c[d.essentials.DistanceUnitType.MILES]=1609.344;c[d.essentials.DistanceUnitType.NAUTICAL_MILES]=1852;c[d.essentials.DistanceUnitType.DEGREES]=111319.49079327357;c[d.essentials.DistanceUnitType.GRADS]=100187.54171394621;c[d.essentials.DistanceUnitType.RADIANS]=6378136.999999998;g.canConvert=function(b,a){var e=!1,f=!1;if(b===a)return!0;for(var l in d.essentials.DistanceUnitType)d.essentials.DistanceUnitType.hasOwnProperty(l)&&
(d.essentials.DistanceUnitType[l]===b?e=!0:d.essentials.DistanceUnitType[l]===a&&(f=!0));return f&&e};g.convert=function(b,a,e){if(!a||b===e)return a;e=h(e);a*=e;b=h(b);return a/b}})(h.distances||(h.distances={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(){function c(b,a){this.app=b;this.libraryId=a}c.prototype.initialize=function(b){b.id&&(this.id=b.id)};return c}();d.AccessibilityProviderBase=h})(d.accessibility||(d.accessibility={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(){function c(){}c.MOUSE="mouse";c.KEYBOARD="keyboard";return c}();d.InputMethod=h})(d.accessibility||(d.accessibility={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){var g=function(){function g(){}g.translate=function(c,b,a,e){if(!c||!b)return null;switch(c.type){case "point":c=b.toScreen(c);c=b.toMap(c.offset(a,e));break;case "polyline":c=this._applyOffset(c,c.paths,a,e,b);break;case "polygon":c=this._applyOffset(c,c.rings,a,e,b)}return{geometry:c,transform:dojox.gfx.matrix.translate(a,e)}};g.rotate=function(c,b,a,e){if(!c||!b)return null;e=e||this.getCentroid(c);var f=dojox.gfx.matrix.rotategAt(-a,e.x,e.y);
switch(c.type){case "polyline":c=this._applyTransform(c,c.paths,f);break;case "polygon":c=this._applyTransform(c,c.rings,f)}b=b.toScreen(e);return{geometry:c,transform:dojox.gfx.matrix.rotategAt(-a,b.x,b.y)}};g.scale=function(c,b,a,e){void 0===e&&(e=null);if(!c||!b)return null;if(isNaN(a)||Infinity===a||-Infinity===a)a=1;if(null===e||"undefined"===typeof e)e=a;var f=this.getCentroid(c),l=dojox.gfx.matrix.scaleAt(a,e,f.x,f.y);switch(c.type){case "polyline":c=this._applyTransform(c,c.paths,l);break;
case "polygon":c=this._applyTransform(c,c.rings,l)}b=b.toScreen(f);return{geometry:c,transform:dojox.gfx.matrix.scaleAt(a,e,b.x,b.y)}};g.getCentroid=function(c){if(!c||!c.type||!d.GeometryUtils.isValidGeometry(c))return null;var b;switch(c.type){case "point":return c;case "multipoint":case "polyline":case "polygon":if(b=c.getExtent())return b.getCenter();case "extent":return c.getCenter()}return null};g._applyOffset=function(c,b,a,e,f){if(c&&b){var l=c.getPoint(0,0);e=f.toMap(f.toScreen(l).offset(a,
e));a=e.x-l.x;l=e.y-l.y;for(e=0;e<b.length;e++)for(f=0;f<b[e].length;f++){var n=c.getPoint(e,f);c.setPoint(e,f,n.offset(a,l))}}return c};g._applyTransform=function(c,b,a){if(c&&b)for(var e=0;e<b.length;e++)for(var f=0;f<b[e].length;f++){var l=c.getPoint(e,f),n=dojox.gfx.matrix.multiplyPoint(a,l.x,l.y);l.setX(n.x);l.setY(n.y);c.setPoint(e,f,l)}return c};return g}();d.MatrixUtils=g})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer=
{}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(){function c(b,a,e){this.map=this.graphic=this.owner=null;this.suspended=!1;this.graphic=b;this.map=a;this.owner=e}c.prototype.destroy=function(){this.suspended=!1;this.graphic=this.map=this.owner=null};c.prototype.refresh=function(b){};c.prototype.suspend=function(){this.suspended=!0};c.prototype.resume=function(){this.suspended=!1};return c}();d.EditCapabilityBase=h})(d.accessibility||(d.accessibility={}))})(d.infrastructure||
(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(g){var m=function(c){function b(a,e,b,l){c.call(this,a,e,b);this._keyUpHandle=this._keyDownHandle=null;this._keyDy=this._keyDx=0;this._transform=null;this._isActive=this._isMoving=!1;this._vertexHandleGraphic=this._selectedControl=this._allControls=this._midpointControls=this._vertexControls=null;this._options={offsetX:10,offsetY:10,preciseOffsetX:1,preciseOffsetY:1,allowAddVertices:!0,allowDeleteVertices:!0};this._snappingInputMovedToken=
null;this._options=dojo.mixin(this._options,l||{});this._init();this.owner&&this.owner.app&&(this._snappingInputMovedToken=this.owner.app.event("SnappingFeedbackEvent").subscribe(this,this._handleSnappingInputMovedEvent))}__extends(b,c);b.create=function(a,e,b,l){if(!a||!a.geometry)return null;switch(a.geometry.type){case "multipoint":return new g.MultipointVertexEditor(a,e,b,l);case "polyline":return new g.PolylineVertexEditor(a,e,b,l);case "polygon":return new g.PolygonVertexEditor(a,e,b,l)}return null};
b.prototype._handleSnappingInputMovedEvent=function(a){a&&a.snappingPoint&&this.graphic&&this.getSelectedVertex()&&this._vertexHandleGraphic&&this._vertexHandleGraphic.visible&&(this._updateGraphicVertex(a.snappingPoint,this.getSelectedVertex().segmentIndex,this.getSelectedVertex().pointIndex),this.owner.refresh())};b.prototype.isActive=function(){return this._isActive};b.prototype.hideVertexHandle=function(){this._vertexHandleGraphic&&(this._vertexHandleGraphic.hide(),this.owner&&this.owner.app&&
this.owner.app.event("VertexHandleHiddenEvent").publish())};b.prototype.showVertexHandle=function(){if(this._selectedControl){var a=this._selectedControl.point.offset(0,0);this._vertexHandleGraphic?(this._vertexHandleGraphic.setGeometry(a).setSymbol(this._options.selectedVertexSymbol),this._vertexHandleGraphic.show()):this._vertexHandleGraphic=this.map.graphics.add(new esri.Graphic(a,this._options.selectedVertexSymbol));this.owner&&this.owner.app&&this.owner.app.event("VertexHandleShownEvent").publish(a);
(a=this._vertexHandleGraphic.getDojoShape())&&a.moveToFront()}};b.prototype.destroy=function(){this._cleanUp();c.prototype.destroy.call(this)};b.prototype.refresh=function(a){void 0===a&&(a=!1);this._transform=null;a?(this._removeControllers(),this._addControllers()):this._refreshControllers()};b.prototype.getSelectedVertex=function(){return this._selectedControl};b.prototype.onVertexAdd=function(a){if(a&&a.segmentIndex===this._selectedControl.segmentIndex){var e=null,b=this._selectedControl.segmentIndex,
l=this._selectedControl.pointIndex;this._selectedControl.isGhost?(e=this._midpointControls,a.pointIndex<l+1?l+=1:a.pointIndex===l+1&&(l=a.pointIndex,e=this._vertexControls)):(e=this._vertexControls,l+=a.pointIndex<=l?1:0);this._selectedControl=e[b][l]}};b.prototype.onVertexDelete=function(a){if(a&&a.segmentIndex===this._selectedControl.segmentIndex){var e=null,b=this._selectedControl.segmentIndex,l=this._selectedControl.pointIndex;this._selectedControl.isGhost?(e=this._midpointControls,l-=a.pointIndex<=
l?1:0):(e=this._vertexControls,l-=a.pointIndex<=l&&0<l?1:0);this._selectedControl=e[b][l]}};b.prototype._init=function(){this._keyDownHandle=dojo.on(this.map.root,"keydown",dojo.hitch(this,"_onKeyDownHandler"))};b.prototype._cleanUp=function(){this._isMoving=this._isActive=!1;this._selectedControl=this._transform=null;this._removeControllers();this._vertexHandleGraphic&&(this.map.graphics.remove(this._vertexHandleGraphic),this._vertexHandleGraphic=null);this._keyDownHandle&&(this._keyDownHandle.remove(),
this._keyDownHandle=null);this._keyUpHandle&&(this._keyUpHandle.remove(),this._keyUpHandle=null);this.owner.app&&this.owner.app&&this._snappingInputMovedToken&&this.owner.app.event("SnappingFeedbackEvent").unsubscribe(this._snappingInputMovedToken)};b.prototype._getSegments=function(a){throw Error("This method is abstract");};b.prototype._getMidpointSegments=function(a){throw Error("This method is abstract");};b.prototype._updatePoints=function(a){throw Error("This method is abstract");};b.prototype._insertGraphicVertex=
function(a,e,b){throw Error("This method is abstract");};b.prototype._updateGraphicVertex=function(a,e,b){throw Error("This method is abstract");};b.prototype._deleteGraphicVertex=function(a,e){throw Error("This method is abstract");};b.prototype._findVertex=function(a,e){for(var b=e?e.length:0,l=0;l<b;l++)for(var n=e[l],c=0;c<n.length;c++){var p=n[c];if(p&&d.GeometryUtils.pointsAreEqual(p.point,a))return p}return null};b.prototype._addControllers=function(){var a=this;this._vertexControls=this._add(this._getSegments(this.graphic.geometry));
this._options.allowAddVertices&&(this._midpointControls=this._add(this._getMidpointSegments(this.graphic.geometry),!0));this._allControls=[];this._vertexControls.forEach(function(e,b){e.forEach(function(e,n){a._allControls.push(e);a._midpointControls&&a._midpointControls[b]&&n<a._midpointControls[b].length&&a._allControls.push(a._midpointControls[b][n])})})};b.prototype._removeControllers=function(){this._remove(this._vertexControls);this._remove(this._midpointControls);this._vertexControls=this._midpointControls=
this._allControls=null};b.prototype._refreshControllers=function(){this._refresh(this._vertexControls,this._getSegments(this.graphic.geometry));this._options.allowAddVertices&&this._refresh(this._midpointControls,this._getMidpointSegments(this.graphic.geometry),!0)};b.prototype._add=function(a,e){void 0===e&&(e=!1);for(var b=[],l=0;l<a.length;l++){for(var n=a[l],c=[],p=0;p<n.length;p++)c.push({isGhost:e,segmentIndex:l,pointIndex:p,point:n[p]});b.push(c)}return b};b.prototype._remove=function(a){a&&
(a.forEach(function(a){a.length=0}),a.length=0)};b.prototype._refresh=function(a,e,b){void 0===b&&(b=!1);a&&e&&a.forEach(function(a,b){a.forEach(function(a,f){a.point=e[b][f]})})};b.prototype._previous=function(){var a=this._allControls.indexOf(this._selectedControl);this._selectedControl=0==a?this._allControls[this._allControls.length-1]:this._allControls[a-1];this.showVertexHandle();this._refreshControllers()};b.prototype._next=function(){var a=this._allControls.indexOf(this._selectedControl);this._selectedControl=
this._allControls[(a+1)%this._allControls.length];this.showVertexHandle();this._refreshControllers()};b.prototype._onKeyDownHandler=function(a){this.suspended||(this._isActive?this._onKeyDownWhenActive(a):86===(a.keyCode||a.which)&&(a.preventDefault(),a.stopImmediatePropagation(),this._isActive=!0,this.owner.suspend(),this.resume(),this._addControllers(),this._selectedControl=this._vertexControls[0][0],this.showVertexHandle()))};b.prototype._onKeyDownWhenActive=function(a){var e=a.altKey,b=e?this._options.preciseOffsetX:
this._options.offsetX,e=e?this._options.preciseOffsetY:this._options.offsetY;switch(a.keyCode||a.which){case 86:a.preventDefault();a.stopImmediatePropagation();a.shiftKey?this._previous():this._next();return;case dojo.keys.ENTER:case dojo.keys.NUMPAD_ENTER:a.preventDefault();a.stopImmediatePropagation();this.owner.resume();this._isActive=this._isMoving=!1;this._selectedControl=null;this._vertexHandleGraphic&&(this.hideVertexHandle(),this.map.graphics.remove(this._vertexHandleGraphic),this._vertexHandleGraphic=
null);return;case 68:this._options.allowDeleteVertices&&(this._delete(this.getSelectedVertex()),a.preventDefault(),a.stopImmediatePropagation());return;case dojo.keys.UP_ARROW:case dojo.keys.NUMPAD_8:this._keyDy-=e;break;case dojo.keys.RIGHT_ARROW:case dojo.keys.NUMPAD_6:this._keyDx+=b;break;case dojo.keys.DOWN_ARROW:case dojo.keys.NUMPAD_2:this._keyDy+=e;break;case dojo.keys.LEFT_ARROW:case dojo.keys.NUMPAD_4:this._keyDx-=b;break;case dojo.keys.PAGE_UP:case dojo.keys.NUMPAD_9:this._keyDx+=b;this._keyDy-=
e;break;case dojo.keys.PAGE_DOWN:case dojo.keys.NUMPAD_3:this._keyDx+=b;this._keyDy+=e;break;case dojo.keys.END:case dojo.keys.NUMPAD_1:this._keyDx-=b;this._keyDy+=e;break;case dojo.keys.HOME:case dojo.keys.NUMPAD_7:this._keyDx-=b;this._keyDy-=e;break;default:return}a.preventDefault();a.stopImmediatePropagation();this._move(this.getSelectedVertex(),this._keyDx,this._keyDy);this._moveStop(this.getSelectedVertex(),this._keyDx,this._keyDy);this._keyDx=this._keyDy=0};b.prototype._move=function(a,e,b){var l=
{isGhost:a.isGhost,pointIndex:a.pointIndex,segmentIndex:a.segmentIndex};this._isMoving||(this._isMoving=!0,this.owner.onVertexMoveStart(this.graphic,l),this.owner.onVertexFirstMove(this.graphic,l));a=this.map.toScreen(a.point).offset(e,b);this._vertexHandleGraphic.setGeometry(this.map.toMap(a));this.owner.onVertexMove(this.graphic,l,this._transform);l={sender:this,mapPoint:this.map.toMap(a),screenPoint:a};this._raiseEditVertexMoved(l)};b.prototype._raiseEditVertexMoved=function(a){this.owner&&this.owner.app&&
this.owner.app.event("EditVertexMovedEvent").publish(a)};b.prototype._moveStop=function(a,e,b){this._isMoving=!1;if(a&&a.point){var l={isGhost:a.isGhost,pointIndex:a.pointIndex,segmentIndex:a.segmentIndex};a=d.MatrixUtils.translate(a.point,this.map,e,b);this._transform=a.transform;l.isGhost?(l.pointIndex+=1,this._insertGraphicVertex(a.geometry,l.segmentIndex,l.pointIndex)):this._updateGraphicVertex(a.geometry,l.segmentIndex,l.pointIndex);this.owner.refresh();this.owner.onVertexMoveStop(this.graphic,
l,this._transform);l.isGhost&&(l.isGhost=!1,this.owner.onVertexAdd(this.graphic,l))}};b.prototype._delete=function(a){if(a&&!a.isGhost){var e={isGhost:a.isGhost,pointIndex:a.pointIndex,segmentIndex:a.segmentIndex};this._deleteGraphicVertex(a.segmentIndex,a.pointIndex);this.owner.refresh();this.owner.onVertexDelete(this.graphic,e)}};return b}(g.EditCapabilityBase);g.VertexEditor=m})(d.accessibility||(d.accessibility={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||
(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(c){function b(){c.apply(this,arguments)}__extends(b,c);b.prototype._getSegments=function(a){for(var e=0,b=[];e<a.points.length;e++)b.push(a.getPoint(e));return[b]};b.prototype._getMidpointSegments=function(a){return[]};b.prototype._insertGraphicVertex=function(a,e,b){};b.prototype._updateGraphicVertex=function(a,e,b){e=this.graphic.geometry;e.setPoint(b,a.offset(0,0));this.graphic.setGeometry(e)};b.prototype._deleteGraphicVertex=
function(a,e){var b=this.graphic.geometry;b.removePoint(e);this.graphic.setGeometry(b)};return b}(d.VertexEditor);d.MultipointVertexEditor=h})(d.accessibility||(d.accessibility={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(g){var m=function(c){function b(){c.apply(this,arguments)}__extends(b,c);b.prototype._getSegments=function(a){for(var e=[],b=0;b<a.rings.length;b++){for(var l=a.rings[b].length,n=[],c=0;c<l-1;c++)n.push(a.getPoint(b,c));e.push(n)}return e};b.prototype._getMidpointSegments=function(a){for(var e=[],b=0;b<a.rings.length;b++){for(var l=a.rings[b].length,n=[],c=0;c<l-1;c++){var p=a.getPoint(b,c),s=a.getPoint(b,c+1),p=d.GeometryUtils.getMidpoint(p,
s);n.push(p)}e.push(n)}return e};b.prototype._insertGraphicVertex=function(a,e,b){var l=this.graphic.geometry;l.insertPoint(e,b,a.offset(0,0));this.graphic.setGeometry(l)};b.prototype._updateGraphicVertex=function(a,e,b){var l=this.graphic.geometry;l.setPoint(e,b,a.offset(0,0));0===b&&l.setPoint(e,l.rings[e].length-1,a.offset(0,0));this.graphic.setGeometry(l)};b.prototype._deleteGraphicVertex=function(a,e){var b=this.graphic.geometry;b.removePoint(a,e);if(0===e){var l=b.rings[a],n=b.getPoint(a,0);
b.setPoint(a,l.length-1,n.offset(0,0))}this.graphic.setGeometry(b)};return b}(g.VertexEditor);g.PolygonVertexEditor=m})(d.accessibility||(d.accessibility={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(g){var m=function(c){function b(){c.apply(this,arguments)}__extends(b,c);b.prototype._getSegments=function(a){for(var e=[],b=0;b<a.paths.length;b++){for(var l=a.paths[b].length,n=[],c=0;c<l;c++)n.push(a.getPoint(b,c));e.push(n)}return e};b.prototype._getMidpointSegments=function(a){for(var b=[],f=0;f<a.paths.length;f++){for(var l=a.paths[f].length,n=[],c=0;c<l-1;c++){var p=a.getPoint(f,c),s=a.getPoint(f,c+1),p=d.GeometryUtils.getMidpoint(p,
s);n.push(p)}b.push(n)}return b};b.prototype._insertGraphicVertex=function(a,b,f){var l=this.graphic.geometry;l.insertPoint(b,f,a.offset(0,0));this.graphic.setGeometry(l)};b.prototype._updateGraphicVertex=function(a,b,f){var l=this.graphic.geometry;l.setPoint(b,f,a.offset(0,0));this.graphic.setGeometry(l)};b.prototype._deleteGraphicVertex=function(a,b){var f=this.graphic.geometry;f.removePoint(a,b);this.graphic.setGeometry(f)};return b}(g.VertexEditor);g.PolylineVertexEditor=m})(d.accessibility||
(d.accessibility={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(){function c(b){this._registeredComponentTypes={"esri.toolbars.draw":"esri.toolbars.Draw","esri.toolbars.edit":"esri.toolbars.Edit","geocortex.accessibility.draw":"geocortex.essentialsHtmlViewer.mapping.infrastructure.accessibility.Draw","geocortex.accessibility.edit":"geocortex.essentialsHtmlViewer.mapping.infrastructure.accessibility.Edit"};this._stack=[];this.app=b;this.app.event("AccessibleComponentStartedEvent").subscribe(this,
this._handleAccessibleComponentStarted);this.app.event("AccessibleComponentCompletedEvent").subscribe(this,this._handleAccessibleComponentCompleted)}c.prototype.registerComponent=function(b,a){if(null==b||null==a)throw Error("[AccessibilityManager::registerComponent] Null name or typeName passed to registerComponent");this._registeredComponentTypes[b]=a};c.prototype.unregisterComponent=function(b){return b&&this._registeredComponentTypes.hasOwnProperty(b)?(delete this._registeredComponentTypes[b],
!0):!1};c.prototype.createComponent=function(b,a,e){if(b&&this._registeredComponentTypes.hasOwnProperty(b)){var f=this._registeredComponentTypes[b],l=dojo.getObject(f);if(l)return new l(a,e,this.app);this.app.trace.warning("Could not create component '{0}' from type name '{1}'".format(b,f))}return null};c.prototype._handleAccessibleComponentStarted=function(b){if(b&&this._stack){var a=this._stack.indexOf(b);-1<a&&this._stack.splice(a,1);this._stack.forEach(function(a){return!a.suspended&&a.suspend()});
this._stack.push(b);b.resume()}};c.prototype._handleAccessibleComponentCompleted=function(b){if(b&&this._stack&&0!=this._stack.length){var a=this._stack.indexOf(b);-1<a&&(this._stack.splice(a,1),!b.suspended&&b.suspend());0<this._stack.length&&this._stack[this._stack.length-1].resume()}};return c}();d.AccessibilityManager=h})(d.accessibility||(d.accessibility={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||
(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var h=function(){function c(b,a){this.inputMethod=null;this.isKeyboardActive=this.suspended=!1;this.id=d.framework.utils.alphaNumericToken();this._keyUpHandle=this._keyDownHandle=this._mouseDownHandle=this._mapNavState=this._map=null;this.setMap(b);this.setApp(a)}c.prototype.setMap=function(b){this._map=b};c.prototype.setApp=function(b){this.app=b};c.prototype.setInputMethod=function(b){if(b!==this.inputMethod){var a=this.inputMethod;
this.inputMethod=b;this.onInputMethodChange({previousMethod:a,newMethod:this.inputMethod})}};c.prototype.setKeyboardActive=function(b){this.isKeyboardActive=b};c.prototype.suspend=function(){this.suspended=!0};c.prototype.resume=function(){this.suspended=!1};c.prototype.disableMapNavigation=function(b,a,e){void 0===b&&(b=!1);void 0===a&&(a=!1);void 0===e&&(e=!0);var f=this._map;this._mapNavState={isDoubleClickZoom:f.isDoubleClickZoom,isClickRecenter:f.isClickRecenter,isPan:f.isPan,isRubberBandZoom:f.isRubberBandZoom,
isKeyboardNavigation:f.isKeyboardNavigation,isScrollWheelZoom:f.isScrollWheelZoom,isShiftDoubleClickZoom:f.isShiftDoubleClickZoom,isPanArrows:f.isPanArrows,isZoomSlider:f.isZoomSlider};f.disableDoubleClickZoom();f.disableClickRecenter();f.disablePan();f.disableRubberBandZoom();f.disableKeyboardNavigation();f.disableScrollWheelZoom();f.disableShiftDoubleClickZoom();b&&f.isZoomSlider&&f.hideZoomSlider();a&&f.isPanArrows&&f.hidePanArrows();e&&f.graphics.disableMouseEvents();return this._mapNavState};
c.prototype.enableMapNavigation=function(b,a,e,f){void 0===b&&(b=!1);void 0===a&&(a=!1);void 0===e&&(e=!0);var l=this._map;if(f=f||this._mapNavState)f.isDoubleClickZoom&&l.enableDoubleClickZoom(),f.isClickRecenter&&l.enableClickRecenter(),f.isPan&&l.enablePan(),f.isRubberBandZoom&&l.enableRubberBandZoom(),f.isKeyboardNavigation&&l.enableKeyboardNavigation(),f.isScrollWheelZoom&&l.enableScrollWheelZoom(),f.isShiftDoubleClickZoom&&l.enableShiftDoubleClickZoom(),b&&f.isZoomSlider&&l.showZoomSlider(),
a&&f.isPanArrows&&l.showPanArrows(),e&&l.graphics.enableMouseEvents()};c.prototype.getMapState=function(){return this._mapNavState};c.prototype.activateMouseControls=function(b){var a=this;void 0===b&&(b=!0);this.deactivateMouseControls(b);this._mouseDownHandle=this.app.map.on("mouse-down",function(){a._mouseDownHandle.remove();a._mouseDownHandle=null;a.setInputMethod(g.InputMethod.MOUSE)})};c.prototype.deactivateMouseControls=function(b){void 0===b&&(b=!0);this._mouseDownHandle&&(this._mouseDownHandle.remove(),
this._mouseDownHandle=null);b&&this.inputMethod===g.InputMethod.MOUSE&&this.setInputMethod(null)};c.prototype.activateKeyboardControls=function(b){void 0===b&&(b=!0);this.isKeyboardActive&&this.deactivateKeyboardControls(b);this.setKeyboardActive(!0);this._keyDownHandle=dojo.on(this._map.root,"keydown",dojo.hitch(this,"_onKeyDown"));this._keyUpHandle=dojo.on(this._map.root,"keyup",dojo.hitch(this,"_onKeyUp"));this.app.event("AccessibleComponentStartedEvent").publish(this)};c.prototype.deactivateKeyboardControls=
function(b){void 0===b&&(b=!0);this.setKeyboardActive(!1);this._keyDownHandle&&(this._keyDownHandle.remove(),this._keyDownHandle=null);this._keyUpHandle&&(this._keyUpHandle.remove(),this._keyUpHandle=null);b&&this.inputMethod===g.InputMethod.KEYBOARD&&this.setInputMethod(null);this.app.event("AccessibleComponentCompletedEvent").publish(this)};c.prototype.toggleKeyboardMode=function(){if(this.inputMethod!==g.InputMethod.KEYBOARD)this.onKeyboardStart();else this.onKeyboardStop()};c.prototype.onInputMethodChange=
function(b){this.app.event("InputMethodChangedEvent").publish(b)};c.prototype.onKeyboardStart=function(){this._mouseDownHandle&&(this._mouseDownHandle.remove(),this._mouseDownHandle=null);this.setInputMethod(g.InputMethod.KEYBOARD)};c.prototype.onKeyboardStop=function(b){this.setInputMethod(null)};c.prototype._onKeyDown=function(b){};c.prototype._onKeyUp=function(b){};return c}();g.AccessibleMapComponent=h})(h.accessibility||(h.accessibility={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||
(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var m=function(c){function b(a,b,f,l,n){c.call(this,a,b,f);this._options={rotateEnabled:!1,scaleEnabled:!1,uniformScaling:!1,rotationAngle:15,preciseRotationAngle:1,scaleFactor:0.2,preciseScaleFactor:0.01};this._isScaling=this._isRotating=this._modified=this._isTextPoint=this._uniformScaling=this._rotateEnabled=this._scaleEnabled=!1;this._keyUpHandle=this._keyDownHandle=this._transform=this._markerSymbol=this._lineSymbol=null;this._options=
dojo.mixin(this._options,n||{});a=f.getOptions();this._markerSymbol=this._options.boxHandleSymbol?this._options.boxHandleSymbol:a.boxHandleSymbol;this._lineSymbol=this._options.boxLineSymbol?this._options.boxLineSymbol:a.boxLineSymbol;this._scaleEnabled=!!this._options.scaleEnabled;this._rotateEnabled=!!this._options.rotateEnabled;this._uniformScaling=!!this._options.uniformScaling;this._isTextPoint=l;this._init()}__extends(b,c);b.prototype.destroy=function(){c.prototype.destroy.call(this);this._cleanUp()};
b.prototype._init=function(){this._keyDownHandle=dojo.on(this.map.root,"keydown",dojo.hitch(this,"_onKeyDownHandler"));this._keyUpHandle=dojo.on(this.map.root,"keyup",dojo.hitch(this,"_onKeyUpHandler"))};b.prototype._cleanUp=function(){this._isRotating=this._isScaling=this._modified=this._scaleEnabled=this._rotateEnabled=this._uniformScaling=this._isTextPoint=!1;this._lineSymbol=this._markerSymbol=this._transform=null;this._keyDownHandle&&(this._keyDownHandle.remove(),this._keyDownHandle=null);this._keyUpHandle&&
(this._keyUpHandle.remove(),this._keyUpHandle=null)};b.prototype._onKeyDownHandler=function(a){if(!this.suspended){var b=a.altKey,f=a.shiftKey,l=!1,n=b?this._options.preciseScaleFactor:this._options.scaleFactor,b=b?this._options.preciseRotationAngle:this._options.rotationAngle,c=a.keyCode||a.which;if(this._scaleEnabled)switch(c){case 83:n=f?-1*n:n,this._scaleGraphic(1+n,1+n),l=!0}if(this._rotateEnabled)switch(c){case 82:this._rotateGraphic(f?-1*b:b),l=!0}l&&(a.preventDefault(),a.stopPropagation())}};
b.prototype._onKeyUpHandler=function(a){if(!this.suspended){var b=a.keyCode||a.which,f=!1;if(this._scaleEnabled)switch(b){case 83:this._isScaling=!1,this.owner.onScaleStop(this.graphic,this._transform),f=!0}if(this._rotateEnabled)switch(b){case 82:this._isRotating=!1,this.owner.onRotateStop(this.graphic,this._transform),f=!0}f&&(a.preventDefault(),a.stopPropagation())}};b.prototype._rotateGraphic=function(a,b){this._isRotating||(this.owner.onRotateStart(this.graphic),this.owner.onRotateFirstMove(this.graphic),
this._isRotating=!0);var f=this.graphic.geometry,l=b||h.GeometryUtils.getMiddle(f);if(h.GeometryUtils.isValidGeometry(f)&&!d.framework.utils.isNullOrUndefined(l)){f=h.MatrixUtils.rotate(f,this.map,a,l);this._transform=f.transform;this._modified=!0;if(this._isTextPoint){var n=this.graphic.symbol;n.angle+=a;this.graphic.setSymbol(n)}else this.graphic.setGeometry(f.geometry);l={transform:f.transform,angle:a,scaleX:1,scaleY:1,around:this.map.toScreen(l)};this.owner.refresh();this.owner.onRotate(this.graphic,
l)}};b.prototype._scaleGraphic=function(a,b){this._isScaling||(this.owner.onScaleStart(this.graphic),this.owner.onScaleFirstMove(this.graphic),this._isScaling=!0);if(null===b||"undefined"===typeof b)b=a;var f=h.MatrixUtils.scale(this.graphic.geometry,this.map,a,b);this._transform=f.transform;this._modified=!0;if(this._isTextPoint){var l=this.graphic.symbol;l.font.setSize(Math.round(100*l.font.size*a)/100);this.graphic.setSymbol(l)}else this.graphic.setGeometry(f.geometry);f={transform:f.transform,
angle:0,scaleX:a,scaleY:b,around:null};this.owner.refresh();this.owner.onScale(this.graphic,f)};return b}(g.EditCapabilityBase);g.BoxEditor=m})(h.accessibility||(h.accessibility={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(g){var m=function(c){function b(a,b,f,l,n){c.call(this,a,b,f);this._options={offsetX:10,offsetY:10,preciseOffsetX:1,preciseOffsetY:1};this._isMoving=this._modified=!1;this._keyUpHandle=this._keyDownHandle=this._textAnchor=this._transform=null;this._options=dojo.mixin(this._options,n||{});this._textAnchor=l;this._init()}__extends(b,c);b.prototype.hasMoved=function(){return this._modified};b.prototype.destroy=function(){c.prototype.destroy.call(this);
this._cleanUp()};b.prototype.refresh=function(a){void 0===a&&(a=!1);c.prototype.refresh.call(this,a);this.graphic&&(a||this._needsRefresh())&&(this._cleanUp(),this._init())};b.prototype._needsRefresh=function(){return null==this._keyDownHandle};b.prototype._init=function(){this._keyDownHandle=dojo.on(this.map.root,"keydown",dojo.hitch(this,"_onKeyDownHandler"));this._keyUpHandle=dojo.on(this.map.root,"keyup",dojo.hitch(this,"_onKeyUpHandler"))};b.prototype._cleanUp=function(){this._isMoving=this._modified=
!1;this._textAnchor=this._transform=null;this._keyDownHandle&&(this._keyDownHandle.remove(),this._keyDownHandle=null);this._keyUpHandle&&(this._keyUpHandle.remove(),this._keyUpHandle=null)};b.prototype._onKeyDownHandler=function(a){if(!this.suspended){var b=a.altKey,f=b?this._options.preciseOffsetX:this._options.offsetX,b=b?this._options.preciseOffsetY:this._options.offsetY,l=0,n=0;switch(a.keyCode||a.which){case dojo.keys.UP_ARROW:case dojo.keys.NUMPAD_8:n=-1;break;case dojo.keys.RIGHT_ARROW:case dojo.keys.NUMPAD_6:l=
1;break;case dojo.keys.DOWN_ARROW:case dojo.keys.NUMPAD_2:n=1;break;case dojo.keys.LEFT_ARROW:case dojo.keys.NUMPAD_4:l=-1;break;case dojo.keys.PAGE_UP:case dojo.keys.NUMPAD_9:l=1;n=-1;break;case dojo.keys.PAGE_DOWN:case dojo.keys.NUMPAD_3:n=l=1;break;case dojo.keys.END:case dojo.keys.NUMPAD_1:l=-1;n=1;break;case dojo.keys.HOME:case dojo.keys.NUMPAD_7:n=l=-1;break;default:return}this._moveGraphic(l*f,n*b);a.preventDefault();a.stopPropagation()}};b.prototype._onKeyUpHandler=function(a){if(!this.suspended){switch(a.keyCode||
a.which){case dojo.keys.UP_ARROW:case dojo.keys.NUMPAD_8:case dojo.keys.RIGHT_ARROW:case dojo.keys.NUMPAD_6:case dojo.keys.DOWN_ARROW:case dojo.keys.NUMPAD_2:case dojo.keys.LEFT_ARROW:case dojo.keys.NUMPAD_4:case dojo.keys.PAGE_UP:case dojo.keys.NUMPAD_9:case dojo.keys.PAGE_DOWN:case dojo.keys.NUMPAD_3:case dojo.keys.END:case dojo.keys.NUMPAD_1:case dojo.keys.HOME:case dojo.keys.NUMPAD_7:this._isMoving=!1;this.map.enableMapNavigation();this.owner.onGraphicMoveStop(this.graphic,this._transform);break;
default:return}a.preventDefault();a.stopPropagation()}};b.prototype._moveGraphic=function(a,b){this._isMoving||(this.owner.onGraphicMoveStart(this.graphic),this.owner.onGraphicFirstMove(this.graphic),this._isMoving=!0,this.map.disableMapNavigation());var f=d.MatrixUtils.translate(this.graphic.geometry,this.map,a,b);this._transform=f.transform;this._modified=!0;this.graphic.setGeometry(f.geometry);this._textAnchor&&this._textAnchor.setGeometry(new esri.geometry.Point(this.graphic.geometry.toJson()));
this.owner.refresh();this.owner.onGraphicMove(this.graphic,f.transform);this.graphic.geometry instanceof esri.geometry.Point&&(f=this.graphic.geometry.offset(0,0),f={sender:this,mapPoint:f,screenPoint:this.map.toScreen(f)},this._raiseEditVertexMoved(f))};b.prototype._raiseEditVertexMoved=function(a){this.owner&&this.owner.app&&this.owner.app.event("EditVertexMovedEvent").publish(a)};return b}(g.EditCapabilityBase);g.GraphicMover=m})(d.accessibility||(d.accessibility={}))})(d.infrastructure||(d.infrastructure=
{}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var m=function(c){function b(a,b,f){c.call(this,a,f);this._defaultOptions=this._options=this._editObject=null;this._tool=0;this._needsRefresh=this._cancelled=this._modified=this._active=this._isGeo=this._isTextPoint=!1;this._handles=[];this._boxEditor=this._vertexEditor=this._graphicMover=this._lastSnapPoint=this._snappingFeedbackEventToken=null;f=Modernizr&&!!Modernizr.touch;f={vertexSymbol:new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,
f?20:12,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new esri.Color([0,0,0,0.5]),1),new esri.Color([128,128,128])),ghostVertexSymbol:new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,f?18:10,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new esri.Color([0,0,0,0.5]),1),new esri.Color([255,255,255,0.75])),ghostLineSymbol:new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_DOT,new esri.Color([128,128,
128]),2),allowDeleteVertices:!0,allowAddVertices:!0,narrateKeyboardShortcuts:!0,rotateHandleOffset:f?24:16,boxLineSymbol:new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_DASH,new esri.Color([64,64,64]),1),boxHandleSymbol:new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_SQUARE,f?16:9,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new esri.Color([0,0,0,0.5]),1),new esri.Color([255,255,255,0.75])),textAnchorSymbol:new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,
10,null,new esri.Color([255,0,0])),selectedVertexSymbol:new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,f?25:15,null,new esri.Color([0,0,255,0.75]))};this._defaultOptions=dojo.mixin(f,b||{});this._editObject=new esri.toolbars.Edit(a,b)}__extends(b,c);b.prototype.activate=function(a,e,f){var l=this;this.deactivate();this.app&&(this._snappingFeedbackEventToken=this.app.event("SnappingFeedbackEvent").subscribe(this,function(a){l._lastSnapPoint=a&&a.snappingPoint?a.snappingPoint:
null}));this._active=!0;this._graphic=e;this._tool=a;this._options=dojo.mixin(dojo.mixin({},this._defaultOptions),f||{});if(0<a){f=this._map.spatialReference;var n=e&&e.geometry?e.geometry.spatialReference:null;this._isGeo=f&&n&&!f.equals(n)&&f.isWebMercator()&&4326===n.wkid;this._isTextPoint=e&&e.geometry&&"point"===e.geometry.type?(f=this._getSymbol(e))&&"textsymbol"===f.type:!1;e&&e.geometry&&"multipoint"===e.geometry.type&&(this._options.allowAddVertices=!1);this._handles.push(dojo.aspect.after(this._editObject,
"onGraphicClick",dojo.hitch(this,"_onGraphicClickImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,"onGraphicFirstMove",dojo.hitch(this,"_onGraphicFirstMoveImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,"onGraphicMove",dojo.hitch(this,"_onGraphicMoveImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,"onGraphicMoveStart",dojo.hitch(this,"_onGraphicMoveStartImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,"onGraphicMoveStop",dojo.hitch(this,
"_onGraphicMoveStopImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,"onRotate",dojo.hitch(this,"_onRotateImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,"onRotateFirstMove",dojo.hitch(this,"_onRotateFirstMoveImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,"onRotateStart",dojo.hitch(this,"_onRotateStartImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,"onRotateStop",dojo.hitch(this,"_onRotateStopImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,
"onScale",dojo.hitch(this,"_onScaleImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,"onScaleFirstMove",dojo.hitch(this,"_onScaleFirstMoveImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,"onScaleStart",dojo.hitch(this,"_onScaleStartImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,"onScaleStop",dojo.hitch(this,"_onScaleStopImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,"onVertexAdd",dojo.hitch(this,"_onVertexAddImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,
"onVertexClick",dojo.hitch(this,"_onVertexClickImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,"onVertexDelete",dojo.hitch(this,"_onVertexDeleteImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,"onVertexFirstMove",dojo.hitch(this,"_onVertexFirstMoveImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,"onVertexMouseOut",dojo.hitch(this,"_onVertexMouseOutImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,"onVertexMouseOver",dojo.hitch(this,
"_onVertexMouseOverImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,"onVertexMove",dojo.hitch(this,"_onVertexMoveImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,"onVertexMoveStart",dojo.hitch(this,"_onVertexMoveStartImpl"),!0));this._handles.push(dojo.aspect.after(this._editObject,"onVertexMoveStop",dojo.hitch(this,"_onVertexMoveStopImpl"),!0));this.activateMouseControls();this.activateKeyboardControls();var c=n=f=!1;(a&b.MOVE)===b.MOVE&&(f=this._enableMove(e));
var d=(a&b.SCALE)===b.SCALE,s=(a&b.ROTATE)===b.ROTATE;if(d||s)n=this._enableBoxEditing(e,d,s);(a&b.EDIT_VERTICES)===b.EDIT_VERTICES&&(c=this._enableVertexEditing(e));if(!f&&!n&&!c)throw Error("[esri.toolbars.Edit::activate] Unable to activate the tool. Check if the tool is valid for the given geometry type.");this.onKeyboardStart();this._updateToolStatusMessage();this.onActivate(a,e);this.raiseGraphicEditActivated({sender:this,graphic:e,tool:a})}};b.prototype.deactivate=function(){var a=this._tool;
this._active=!1;this.app&&this._snappingFeedbackEventToken&&(this.app.event("SnappingFeedbackEvent").unsubscribe(this._snappingFeedbackEventToken),this._snappingFeedbackEventToken=null);if(0<a){var b=this._modified,f=this._cancelled,l=this._graphic;this._graphicMover&&this._graphicMover.hasMoved()&&this._adjustGraphicMoverPoint(l,this._lastSnapPoint);this._clear();this._graphic=null;this._isGeo=this._isTextPoint=!1;this.deactivateMouseControls();this.deactivateKeyboardControls();if(this.app.toolRegistry&&
this.app.toolRegistry.getActiveTool){var n=this.app.toolRegistry.getActiveTool();n instanceof h.tools.MapTool&&n.drawMode===h.tools.DrawMode.EXTENT&&l.setGeometry(this._convertPolygonToExtent(l.geometry))}this.onDeactivate(a,l,{isModified:b,cancelled:f});this.raiseGraphicEditDeactivated({sender:this,graphic:l,tool:a,isModified:b,cancelled:f})}};b.prototype._convertPolygonToExtent=function(a){if(a.getExtent)return a.getExtent();this.app.trace.warning("Tried to convert polygon to extent, but failed. Polygon object lacks getExtent() method.");
return null};b.prototype.getOptions=function(){return this._options||this._defaultOptions||{}};b.prototype.getCurrentState=function(){return{tool:this._tool,graphic:this._graphic,isModified:this._modified}};b.prototype.getEnabledTools=function(){return[this._graphicMover,this._boxEditor,this._vertexEditor].filter(function(a){return!d.framework.utils.isNullOrUndefined(a)})};b.prototype.refresh=function(){this._editObject.refresh();this._needsRefresh=!1};b.prototype.setNeedsRefresh=function(a){this._needsRefresh=
a};b.prototype.suspend=function(){c.prototype.suspend.call(this);this.getEnabledTools().forEach(function(a){return a.suspend()})};b.prototype.resume=function(){c.prototype.resume.call(this);this.getEnabledTools().forEach(function(a){return a.resume()})};b.prototype.isActive=function(){return this._active};b.prototype.activateMouseControls=function(a){void 0===a&&(a=!0);c.prototype.activateMouseControls.call(this,a);if(0<this._tool)this._editObject.__attached_stopEvent=!0,this._editObject.activate(this._tool,
this._graphic,this._options);else throw Error("[esri.toolbars.Edit::activate] Unable to activate the tool. Check if the tool is valid for the given geometry type.");};b.prototype.deactivateMouseControls=function(a){void 0===a&&(a=!0);c.prototype.deactivateMouseControls.call(this,a);this._editObject.__attached_stopEvent=!0;this._editObject.deactivate()};b.prototype.on=function(a,b){throw Error("[geocortex.essentialsHtmlViewer.mapping.infrastructure.accessibility.Edit] On style events not implemented yet. Use connect instead.");
};b.prototype.onActivate=function(a,b){};b.prototype.onDeactivate=function(a,b,f){};b.prototype.onGraphicClick=function(a,b){};b.prototype._onGraphicClickImpl=function(a,b){this.onGraphicClick(a,b)};b.prototype.onGraphicFirstMove=function(a){this._modified=!0};b.prototype._onGraphicFirstMoveImpl=function(a){this.suspend();null!==this._vertexEditor&&this._vertexEditor.isActive()&&this._vertexEditor.hideVertexHandle();this.onGraphicFirstMove(a)};b.prototype.onGraphicMove=function(a,b){};b.prototype._onGraphicMoveImpl=
function(a,b){this.onGraphicMove(a,b)};b.prototype.onGraphicMoveStart=function(a){};b.prototype._onGraphicMoveStartImpl=function(a){this.onGraphicMoveStart(a)};b.prototype.onGraphicMoveStop=function(a,b){};b.prototype._onGraphicMoveStopImpl=function(a,b){this.resume();null!==this._vertexEditor&&this._vertexEditor.isActive()&&(this.suspend(),this._vertexEditor.resume(),this._vertexEditor.refresh(),this._vertexEditor.showVertexHandle());this.onGraphicMoveStop(a,b)};b.prototype.onRotate=function(a,b){};
b.prototype._onRotateImpl=function(a,b){this.onRotate(a,b)};b.prototype.onRotateFirstMove=function(a){this._modified=!0};b.prototype._onRotateFirstMoveImpl=function(a){this.suspend();null!==this._vertexEditor&&this._vertexEditor.isActive()&&this._vertexEditor.hideVertexHandle();this.onRotateFirstMove(a)};b.prototype.onRotateStart=function(a){};b.prototype._onRotateStartImpl=function(a){this.onRotateStart(a)};b.prototype.onRotateStop=function(a,b){};b.prototype._onRotateStopImpl=function(a,b){this.resume();
null!==this._vertexEditor&&this._vertexEditor.isActive()&&(this.suspend(),this._vertexEditor.resume(),this._vertexEditor.refresh(),this._vertexEditor.showVertexHandle());this.onRotateStop(a,b)};b.prototype.onScale=function(a,b){};b.prototype._onScaleImpl=function(a,b){this.onScale(a,b)};b.prototype.onScaleFirstMove=function(a){this._modified=!0};b.prototype._onScaleFirstMoveImpl=function(a){this.suspend();null!==this._vertexEditor&&this._vertexEditor.isActive()&&this._vertexEditor.hideVertexHandle();
this.onScaleFirstMove(a)};b.prototype.onScaleStart=function(a){};b.prototype._onScaleStartImpl=function(a){this.onScaleStart(a)};b.prototype.onScaleStop=function(a,b){};b.prototype._onScaleStopImpl=function(a,b){this.resume();null!==this._vertexEditor&&this._vertexEditor.isActive()&&(this.suspend(),this._vertexEditor.resume(),this._vertexEditor.refresh(),this._vertexEditor.showVertexHandle());this.onScaleStop(a,b)};b.prototype.onVertexAdd=function(a,b){this._modified=!0;null!==this._vertexEditor&&
this._vertexEditor.isActive()&&(this._vertexEditor.refresh(!0),this._vertexEditor.onVertexAdd(b),this._vertexEditor.showVertexHandle())};b.prototype._onVertexAddImpl=function(a,b){this.onVertexAdd(a,b)};b.prototype.onVertexClick=function(a,b){};b.prototype._onVertexClickImpl=function(a,b){this.onVertexClick(a,b)};b.prototype.onVertexDelete=function(a,b){this._modified=!0;null!==this._vertexEditor&&this._vertexEditor.isActive()&&(this._vertexEditor.refresh(!0),this._vertexEditor.onVertexDelete(b),
this._vertexEditor.showVertexHandle())};b.prototype._onVertexDeleteImpl=function(a,b){this.onVertexDelete(a,b)};b.prototype.onVertexFirstMove=function(a,b){this._modified=!0};b.prototype._onVertexFirstMoveImpl=function(a,b){this.suspend();null!==this._vertexEditor&&this._vertexEditor.isActive()&&this._vertexEditor.hideVertexHandle();this.onVertexFirstMove(a,b)};b.prototype.onVertexMouseOut=function(a,b){};b.prototype._onVertexMouseOutImpl=function(a,b){this.onVertexMouseOut(a,b)};b.prototype.onVertexMouseOver=
function(a,b){};b.prototype._onVertexMouseOverImpl=function(a,b){this.onVertexMouseOver(a,b)};b.prototype.onVertexMove=function(a,b,f){b&&b.graphic&&this.app.event("EditVertexHandleMovedEvent").publish(b.graphic)};b.prototype._onVertexMoveImpl=function(a,b,f){this.onVertexMove(a,b,f)};b.prototype.onVertexMoveStart=function(a,b){};b.prototype._onVertexMoveStartImpl=function(a,b){this.onVertexMoveStart(a,b)};b.prototype.onVertexMoveStop=function(a,b,f){null!==this._vertexEditor&&this._vertexEditor.isActive()&&
!b.isGhost&&(this._vertexEditor.refresh(),this._vertexEditor.showVertexHandle())};b.prototype._onVertexMoveStopImpl=function(a,b,f){this.resume();null!==this._vertexEditor&&this._vertexEditor.isActive()&&(this.suspend(),this._vertexEditor.resume());this.onVertexMoveStop(a,b,f)};b.prototype.onKeyboardStart=function(){c.prototype.onKeyboardStart.call(this)};b.prototype.onKeyboardStop=function(a){void 0===a&&(a=!1);c.prototype.onKeyboardStop.call(this,a);this._cancelled=a;this.deactivate()};b.prototype._onKeyDown=
function(a){c.prototype._onKeyDown.call(this,a);if(!this.suspended&&this._active&&this.inputMethod!==g.InputMethod.MOUSE){var b=!1;switch(a.keyCode||a.which){case dojo.keys.ENTER:case dojo.keys.NUMPAD_ENTER:this.toggleKeyboardMode();b=!0;break;case dojo.keys.ESCAPE:this.onKeyboardStop(!0),b=!0}b&&(a.preventDefault(),a.stopPropagation())}};b.prototype.raiseGraphicEditActivated=function(a){this.app.event("GraphicEditActivatedEvent").publish(a)};b.prototype.raiseGraphicEditDeactivated=function(a){this.app.event("GraphicEditDeactivatedEvent").publish(a)};
b.prototype._updateToolStatusMessage=function(){if(this._graphic&&this._graphic.geometry&&"point"!==this._graphic.geometry.type){var a=this.app.getResource("Mapping.Infrastructure","language-toolbar-markup-edit-desc-shortcuts");if(this.app.toolRegistry&&this.app.toolRegistry.getActiveTool()){var b=this.app.toolRegistry.getActiveTool(),f=this.app.getResource("Mapping.Infrastructure","language-toolbar-markup-edit-zoomin-tool"),l=this.app.getResource("Mapping.Infrastructure","language-toolbar-markup-edit-zoomout-tool");
if(b.name===f||b.name===l)a=this.app.getResource("Mapping.Infrastructure","language-toolbar-markup-edit-desc-shortcuts-zoom")}a&&(this.app.command("UpdateStatus").execute(new d.essentialsHtmlViewer.mapping.infrastructure.commandArgs.AddStatusArgs(a)),this._options.narrateKeyboardShortcuts&&this.app.command("ScreenReaderNarrate").execute(a))}};b.prototype._clear=function(){this._disableMove();this._disableBoxEditing();this._disableVertexEditing();this._tool=0;this.suspended=this._cancelled=this._modified=
!1;this.setInputMethod(null)};b.prototype._getSymbol=function(a){if(a){var b=a.symbol;if(b)return b;if(b=a.getLayer()?a.getLayer().renderer:null)return b.getSymbol(a)}return null};b.prototype._enableMove=function(a){switch(a.geometry.type){case "point":return this._graphicMover=new g.GraphicMover(a,this._map,this,this._isTextPoint&&this._editObject._textAnchor?this._editObject._textAnchor:null),!0;case "polyline":case "polygon":return this._graphicMover=new g.GraphicMover(a,this._map,this,null),!0}return!1};
b.prototype._enableBoxEditing=function(a,b,f){b={scaleEnabled:b,rotateEnabled:f,uniformScaling:this._options.uniformScaling,boxHandleSymbol:this._options.boxHandleSymbol,boxLineSymbol:this._options.boxLineSymbol};return this._isTextPoint||-1<["polyline","polygon"].indexOf(a.geometry.type)?(this._boxEditor=new g.BoxEditor(a,this._map,this,this._isTextPoint,b),!0):!1};b.prototype._enableVertexEditing=function(a){var b={allowAddVertices:this._options.allowAddVertices,allowDeleteVertices:this._options.allowDeleteVertices,
selectedVertexSymbol:this._options.selectedVertexSymbol};switch(a.geometry.type){case "multipoint":case "polyline":case "polygon":return this._vertexEditor=g.VertexEditor.create(a,this._map,this,b),!0}return!1};b.prototype._adjustGraphicMoverPoint=function(a,b){b&&a&&b instanceof esri.geometry.Point&&a.geometry instanceof esri.geometry.Point&&a.setGeometry(b)};b.prototype._disableMove=function(){this._graphicMover&&(this._graphicMover.destroy(),this._graphicMover=null)};b.prototype._disableBoxEditing=
function(){this._boxEditor&&(this._boxEditor.destroy(),this._boxEditor=null)};b.prototype._disableVertexEditing=function(){this._vertexEditor&&(this._vertexEditor.destroy(),this._vertexEditor=null)};b._edit=function(){require(["esri/toolbars/edit"],function(a){b.EDIT_TEXT=a.EDIT_TEXT;b.EDIT_VERTICES=a.EDIT_VERTICES;b.MOVE=a.MOVE;b.ROTATE=a.ROTATE;b.SCALE=a.SCALE})}();return b}(g.AccessibleMapComponent);g.Edit=m})(h.accessibility||(h.accessibility={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||
(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(g){var m=function(c){function b(a,e,f){c.call(this,a,f);this.respectDrawingVertexOrder=!1;this._arrowShapeTemplate=[[0,0],[-24,24],[-24,12],[-96,12],[-96,-12],[-24,-12],[-24,-24],[0,0]];this._leftArrowShapeTemplate=[[0,0],[24,24],[24,12],[96,12],[96,-12],[24,-12],[24,-24],[0,0]];this._rightArrowShapeTemplate=[[0,0],[-24,24],[-24,12],[-96,12],[-96,-12],[-24,-12],[-24,-24],[0,0]];this._upArrowShapeTemplate=[[0,0],[-24,24],[-12,24],[-12,96],
[12,96],[12,24],[24,24],[0,0]];this._downArrowShapeTemplate=[[0,0],[-24,-24],[-12,-24],[-12,-96],[12,-96],[12,-24],[24,-24],[0,0]];this._triangleShapeTemplate=[[0,-48],[41.56921938165306,24],[-41.56921938165306,24],[0,-48]];this._rectangleShapeTemplate=[[0,-48],[96,-48],[96,0],[0,0],[0,-48]];this._defaultOptions=this._options=this._editObject=this._drawObject=null;this._active=!1;this._createGeometryDeferred=this._graphic=null;this._isPlottingPolyGeometry=!1;this._ghostLine=this._vertexAnchor=this._lastVertexPosition=
null;this._handles=[];this._lastSnappingPoint=this._dblClickHandlerToken=this._editCompletedHandle=this._polyGeometryKeyDownHandle=null;var l=Modernizr&&!!Modernizr.touch,l={enableEditing:!0,vertexOffsetX:10,vertexOffsetY:10,preciseVertexOffsetX:1,preciseVertexOffsetY:1,vertexSymbol:new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,l?20:12,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new esri.Color([0,0,0,0.5]),1),new esri.Color([128,128,128])),
selectedVertexSymbol:new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,l?25:15,null,new esri.Color([0,0,255,0.75]))};this._defaultOptions=dojo.mixin(l,e||{});this._points=[];this._drawObject=new esri.toolbars.Draw(a,e);this._twoClicksWithin300MsFixup();this._editObject=new b.EditInternal(a,null,f);this.fillSymbol=this._drawObject.fillSymbol;this.lineSymbol=this._drawObject.lineSymbol;this.markerSymbol=this._drawObject.markerSymbol;this.respectDrawingVertexOrder=this._drawObject.respectDrawingVertexOrder;
this.setVertexSymbol(this._defaultOptions.vertexSymbol);this.setSelectedVertexSymbol(this._defaultOptions.selectedVertexSymbol);this.app&&this.app.event("SnappingFeedbackEvent").subscribe(this,this._handleSnappingEvent)}__extends(b,c);b.createEllipse=function(a){var b=a.center,f=a.longAxis||48,l=a.shortAxis||24,n=a.numberOfPoints||60,c=a.map;a=[];for(var d=2*Math.PI/n,s=0;s<n;s++){var g=Math.cos(s*d),m=Math.sin(s*d),g=c.toMap(new esri.geometry.ScreenPoint({x:f*g+b.x,y:l*m+b.y}));a.push(g)}a.push(a[0]);
b=new esri.geometry.Polygon(c.spatialReference);b.addRing(a);return b};b.createCircle=function(a){return b.createEllipse({center:a.center,longAxis:a.radius,shortAxis:a.radius,numberOfPoints:a.numberOfPoints,map:a.map})};b.prototype.activate=function(a,e){var f=this;(this._active||this._geometryType)&&this.deactivate();this._handles.push(this.app.map.on("click",function(a){return f.app.trace.debug("[DrawTool] map-click")}));this._handles.push(this.app.map.on("dbl-click",function(a){return f.app.trace.debug("[DrawTool] map-double-click")}));
this._active=!0;this._geometryType=a;this._options=dojo.mixin(dojo.mixin({},this._defaultOptions),e||{});a===b.MULTI_POINT&&(this._options.enableEditing=!1);this.setVertexSymbol(this._options.vertexSymbol);this.setSelectedVertexSymbol(this._options.selectedVertexSymbol);this._handles.push(dojo.aspect.after(this._drawObject,"onDrawEnd",dojo.hitch(this,"onDrawEnd"),!0));this._handles.push(dojo.aspect.after(this._drawObject,"onDrawComplete",dojo.hitch(this,"onDrawComplete"),!0));this._drawObject&&"function"===
typeof this._drawObject._onClickHandler&&this._handles.push(dojo.aspect.after(this._drawObject,"_onClickHandler",dojo.hitch(this,"_onClickHandler"),!0));this._extraPointOnTouchDevicesFixup();this.activateMouseControls();this._supportsKeyboardInput(this._geometryType)&&this.activateKeyboardControls();this.onActivate();this.raiseGraphicDrawActivated({sender:this,geometryType:a})};b.prototype.deactivate=function(){var a=this._geometryType;this._active=!1;this._clear();this.setInputMethod(null);this._dblClickHandlerToken&&
(this._dblClickHandlerToken.remove(),this._dblClickHandlerToken=null);this._handles.forEach(function(a){a.remove()});this._handles.length=0;this._geometryType=this.vertexSymbol=this.selectedVertexSymbol=null;this.onDeactivate();this.raiseGraphicDrawDeactivated({sender:this,geometryType:a})};b.prototype.finishDrawing=function(){switch(this.inputMethod){case g.InputMethod.MOUSE:this._drawObject.finishDrawing();this._syncPointsCollection();break;case g.InputMethod.KEYBOARD:this._finishKeyboardDrawing()}};
b.prototype.setFillSymbol=function(a){this.fillSymbol=a;this._drawObject.setFillSymbol(a)};b.prototype.setLineSymbol=function(a){this.lineSymbol=a;this._drawObject.setLineSymbol(a)};b.prototype.setMarkerSymbol=function(a){this.markerSymbol=a;this._drawObject.setMarkerSymbol(a)};b.prototype.setRespectDrawingVertexOrder=function(a){this.respectDrawingVertexOrder=a;this._drawObject.setRespectDrawingVertexOrder(a)};b.prototype.setVertexSymbol=function(a){this.vertexSymbol=a};b.prototype.setSelectedVertexSymbol=
function(a){this.selectedVertexSymbol=a};b.prototype.activateMouseControls=function(a){void 0===a&&(a=!0);c.prototype.activateMouseControls.call(this,a);this._geometryType&&(this._drawObject.__attached_stopEvent=!0,this._drawObject.activate(this._geometryType,this._options))};b.prototype.deactivateMouseControls=function(a){void 0===a&&(a=!0);c.prototype.deactivateMouseControls.call(this,a);this._drawObject.__attached_stopEvent=!0;this._drawObject.deactivate()};b.prototype.raiseGraphicDrawActivated=
function(a){this.app.event("GraphicDrawActivatedEvent").publish(a)};b.prototype.raiseGraphicDrawDeactivated=function(a){this.app.event("GraphicDrawDeactivatedEvent").publish(a)};b.prototype.raiseGraphicVertexAdded=function(a){this.app.event("GraphicVertexAddedEvent").publish(a)};b.prototype.raiseGraphicVertexMoved=function(a){this.app.event("GraphicVertexMovedEvent").publish(a)};b.prototype.on=function(a,b){throw Error("[geocortex.essentialsHtmlViewer.mapping.infrastructure.accessibilit.Draw::on] On style events not implemented yet. Use connect instead.");
};b.prototype.onActivate=function(){};b.prototype.onDeactivate=function(){};b.prototype.onDrawComplete=function(a){this.inputMethod==g.InputMethod.MOUSE&&this._clear()};b.prototype.onDrawEnd=function(a){this.app.trace.debug("[DrawTool] Number of vertices drawn "+this._vertexCount(a));this.inputMethod==g.InputMethod.MOUSE&&this._clear();this.app.event("GraphicDrawCompletedEvent").publish(a)};b.prototype.onKeyboardStart=function(){var a=this;c.prototype.onKeyboardStart.call(this);this.deactivateMouseControls();
var b=this._map.extent.getCenter();this._plotShape(b,this._geometryType).then(function(b){return a._editShape(b)})};b.prototype.onKeyboardStop=function(a){void 0===a&&(a=!1);c.prototype.onKeyboardStop.call(this,a);this._graphic&&!a?(a=this._graphic.geometry,this._clear(),this._drawEnd(a)):this._clear()};b.prototype._onKeyDown=function(a){c.prototype._onKeyDown.call(this,a);if(!this.suspended&&this._active&&this.inputMethod!==g.InputMethod.MOUSE){var b=!1;switch(a.keyCode||a.which){case dojo.keys.ENTER:case dojo.keys.NUMPAD_ENTER:this.toggleKeyboardMode();
b=!0;break;case dojo.keys.ESCAPE:this.onKeyboardStop(!0),b=!0}b&&(a.preventDefault(),a.stopPropagation())}};b.prototype._onClickHandler=function(a){this.inputMethod===g.InputMethod.MOUSE&&this._syncPointsCollection()};b.prototype._supportsKeyboardInput=function(a){switch(a){case b.ARROW:case b.CIRCLE:case b.DOWN_ARROW:case b.ELLIPSE:case b.EXTENT:case b.LEFT_ARROW:case b.MULTI_POINT:case b.POINT:case b.POLYGON:case b.POLYLINE:case b.RECTANGLE:case b.RIGHT_ARROW:case b.TRIANGLE:case b.UP_ARROW:return!0}return!1};
b.prototype._finishKeyboardDrawing=function(a){void 0===a&&(a=!0);if(this._active){var e,f=this._map.spatialReference,l=this._points.slice(0,this._points.length);switch(this._geometryType){case b.POLYLINE:if(!this._graphic||2>l.length)return;e=new esri.geometry.Polyline(f);e.addPath(l);this._graphic.setGeometry(e);break;case b.POLYGON:if(!this._graphic||2>l.length)return;l.push(l[0].offset(0,0));esri.geometry.Polygon.prototype.isClockwise(l)||this.respectDrawingVertexOrder||(this.app.trace.debug("Polygons drawn in anti-clockwise direction will be reversed to be clockwise."),
l.reverse());e=new esri.geometry.Polygon(f);e.addRing(l);this._graphic.setGeometry(e);break;case b.MULTI_POINT:e=new esri.geometry.Multipoint(f);l.forEach(function(a){e.addPoint(a)});this._graphic.setGeometry(e);break;default:if(!this._graphic||!this._graphic.geometry)return;e=this._graphic.geometry}if(a)this.onKeyboardStop()}};b.prototype._clear=function(){this._graphic&&this._map.graphics.remove(this._graphic);this._ghostLine&&this._map.graphics.remove(this._ghostLine);this._vertexAnchor&&this._map.graphics.remove(this._vertexAnchor);
this._editCompletedHandle&&this._editCompletedHandle.remove();this._polyGeometryKeyDownHandle&&this._polyGeometryKeyDownHandle.remove();this._editObject&&this._editObject.deactivate();this._polyGeometryKeyDownHandle=this._editCompletedHandle=this._createGeometryDeferred=this._graphic=this._vertexAnchor=this._ghostLine=null;this._isPlottingPolyGeometry=!1;this._lastVertexPosition=null;this.suspended=!1;this._points.length=0;this.deactivateMouseControls();this._supportsKeyboardInput(this._geometryType)&&
this.deactivateKeyboardControls();this.setInputMethod(null);this._active&&(this.activateMouseControls(),this._supportsKeyboardInput(this._geometryType)&&this.activateKeyboardControls())};b.prototype._drawEnd=function(a){if(a){this.onDrawEnd(a);var b,f=this._map.spatialReference;f&&(f.isWebMercator()?b=esri.geometry.webMercatorToGeographic(a):4326===f.wkid&&(b=esri.geometry.fromJson(a.toJson())));this.onDrawComplete({geometry:a,geographicGeometry:b})}};b.prototype._moveVertexAnchor=function(a,e){if(this._vertexAnchor&&
!isNaN(a)&&!isNaN(e)){var f=this._vertexAnchor.geometry,l=this._map.toMap(this._map.toScreen(f).offset(a,e)),f=f.offset(l.x-f.x,l.y-f.y);-1<[b.POLYLINE,b.POLYGON].indexOf(this._geometryType)&&this._updateGhostLine(f);this._vertexAnchor.setGeometry(f).setSymbol(this.selectedVertexSymbol);this._vertexAnchor.getDojoShape().moveToFront();f={sender:this,mapPoint:f,screenPoint:this._map.toScreen(f),snappingPoint:this._lastSnappingPoint};this.raiseGraphicVertexMoved(f)}};b.prototype._handleSnappingEvent=
function(a){this._active&&this._editObject.isActive()||(this._lastSnappingPoint=a.snappingPoint)&&this._ghostLine&&this._updateGhostLine(this._lastSnappingPoint)};b.prototype._updateGhostLine=function(a){if(this._points&&0<this._points.length){var b=this._ghostLine.geometry;b.setPoint(0,0,this._points[this._points.length-1].offset(0,0));b.setPoint(0,1,a);this._ghostLine.setGeometry(b)}};b.prototype._addVertex=function(a){var e=a;this._lastSnappingPoint&&(a=this._lastSnappingPoint);var f;this._points.push(a.offset(0,
0));switch(this._geometryType){case b.POLYLINE:1===this._points.length?(f=new esri.geometry.Polyline(this._map.spatialReference),f.addPath(this._points),this._graphic=this._map.graphics.add(new esri.Graphic(f,this.lineSymbol)),f=new esri.geometry.Polyline(this._map.spatialReference),f.addPath([a.offset(0,0),a.offset(0,0)]),this._ghostLine=this._map.graphics.add(new esri.Graphic(f,this.lineSymbol))):(f=this._graphic.geometry,f.insertPoint(0,f.paths[0].length,a.offset(0,0)),this._graphic.setGeometry(f).setSymbol(this.lineSymbol),
f=this._ghostLine.geometry,f.setPoint(0,0,a.offset(0,0)),f.setPoint(0,1,a.offset(0,0)),this._ghostLine.setGeometry(f));break;case b.POLYGON:1===this._points.length?(f=new esri.geometry.Polygon(this._map.spatialReference),f.addRing(this._points),this._graphic=this._map.graphics.add(new esri.Graphic(f,this.fillSymbol)),f=new esri.geometry.Polyline(this._map.spatialReference),f.addPath([a.offset(0,0),a.offset(0,0)]),this._ghostLine=this._map.graphics.add(new esri.Graphic(f,this.fillSymbol))):(f=this._graphic.geometry,
f.insertPoint(0,f.rings[0].length,a.offset(0,0)),this._graphic.setGeometry(f).setSymbol(this.fillSymbol),f=this._ghostLine.geometry,f.setPoint(0,0,a.offset(0,0)),f.setPoint(0,1,a.offset(0,0)),this._ghostLine.setGeometry(f));break;case b.MULTI_POINT:1===this._points.length?(f=new esri.geometry.Multipoint(this._map.spatialReference),f.addPoint(a.offset(0,0)),this._graphic=this._map.graphics.add(new esri.Graphic(f,this.markerSymbol))):(f=this._graphic.geometry,f.addPoint(a.offset(0,0)),this._graphic.setGeometry(f).setSymbol(this.markerSymbol))}this._lastVertexPosition=
e.offset(0,0);this._vertexAnchor.setGeometry(e.offset(0,0)).setSymbol(this.selectedVertexSymbol);this._vertexAnchor.getDojoShape().moveToFront()};b.prototype._drawPolyGeometry=function(a,b){var f=this;if(!a||this._isPlottingPolyGeometry)return Promise.resolve(null);this._lastSnappingPoint&&(a=this._lastSnappingPoint);this._isPlottingPolyGeometry=!0;this.app.map.disableMapNavigation();this.suspend();this._lastVertexPosition=null;this._vertexAnchor=this._map.graphics.add(new esri.Graphic(a.offset(0,
0),this.selectedVertexSymbol));var l={sender:this,mapPoint:a,screenPoint:this._map.toScreen(a),snappingPoint:this._lastSnappingPoint};this.raiseGraphicVertexMoved(l);this._polyGeometryKeyDownHandle&&(this._polyGeometryKeyDownHandle.remove(),this._polyGeometryKeyDownHandle=null);var n=null;return(new Promise(function(a,b){return f._polyGeometryKeyDownHandle=f._drawPolyGeometry_handleKeyDown(a,b)})).then(function(a){return n=a})["catch"](function(){f.onKeyboardStop(!0);return n=null}).lastly(function(){f._isPlottingPolyGeometry=
!1;f.app.map.enableMapNavigation();f._polyGeometryKeyDownHandle&&(f._polyGeometryKeyDownHandle.remove(),f._polyGeometryKeyDownHandle=null);f.resume();return n})};b.prototype._drawPolyGeometry_handleKeyDown=function(a,b){var f=this;return dojo.on(this._map.root,"keydown",function(l){var n=l.altKey,c=n?f._options.preciseVertexOffsetX:f._options.vertexOffsetX,n=n?f._options.preciseVertexOffsetY:f._options.vertexOffsetY;switch(l.keyCode||l.which){case dojo.keys.UP_ARROW:case dojo.keys.NUMPAD_8:f._moveVertexAnchor(0,
-n);break;case dojo.keys.RIGHT_ARROW:case dojo.keys.NUMPAD_6:f._moveVertexAnchor(c,0);break;case dojo.keys.DOWN_ARROW:case dojo.keys.NUMPAD_2:f._moveVertexAnchor(0,n);break;case dojo.keys.LEFT_ARROW:case dojo.keys.NUMPAD_4:f._moveVertexAnchor(-c,0);break;case dojo.keys.PAGE_UP:case dojo.keys.NUMPAD_9:f._moveVertexAnchor(c,-n);break;case dojo.keys.PAGE_DOWN:case dojo.keys.NUMPAD_3:f._moveVertexAnchor(c,n);break;case dojo.keys.END:case dojo.keys.NUMPAD_1:f._moveVertexAnchor(-c,n);break;case dojo.keys.HOME:case dojo.keys.NUMPAD_7:f._moveVertexAnchor(-c,
-n);break;case dojo.keys.ENTER:case dojo.keys.NUMPAD_ENTER:d.GeometryUtils.pointsAreEqual(f._vertexAnchor.geometry,f._lastVertexPosition)?(f._graphic&&f._map.graphics.remove(f._graphic),f._vertexAnchor&&f._map.graphics.remove(f._vertexAnchor),f._finishKeyboardDrawing(!1),a(f._graphic?f._graphic.geometry:null)):(c=f._vertexAnchor.geometry,f._addVertex(c),c={sender:f,mapPoint:c,screenPoint:f._map.toScreen(c),snappingPoint:f._lastSnappingPoint},f.raiseGraphicVertexAdded(c));break;case dojo.keys.ESCAPE:b(null);
break;default:return}l.preventDefault();l.stopPropagation()})};b.prototype._plotShape=function(a,e){var f=this._map.toScreen(a);switch(e){case b.POINT:return Promise.resolve(a.offset(0,0));case b.POLYLINE:return this._drawPolyGeometry(a,e);case b.POLYGON:return this._drawPolyGeometry(a,e);case b.MULTI_POINT:return this._drawPolyGeometry(a,e);case b.ARROW:return Promise.resolve(this._toPolygon(this._arrowShapeTemplate,f.x,f.y));case b.LEFT_ARROW:return Promise.resolve(this._toPolygon(this._leftArrowShapeTemplate,
f.x,f.y));case b.RIGHT_ARROW:return Promise.resolve(this._toPolygon(this._rightArrowShapeTemplate,f.x,f.y));case b.UP_ARROW:return Promise.resolve(this._toPolygon(this._upArrowShapeTemplate,f.x,f.y));case b.DOWN_ARROW:return Promise.resolve(this._toPolygon(this._downArrowShapeTemplate,f.x,f.y));case b.TRIANGLE:return Promise.resolve(this._toPolygon(this._triangleShapeTemplate,f.x,f.y));case b.RECTANGLE:case b.EXTENT:return Promise.resolve(this._toPolygon(this._rectangleShapeTemplate,f.x-48,f.y+24));
case b.CIRCLE:return f=b.createCircle({center:f,radius:48,numberOfPoints:60,map:this._map}),Promise.resolve(f);case b.ELLIPSE:return f=b.createEllipse({center:f,longAxis:48,shortAxis:24,numberOfPoints:60,map:this._map}),Promise.resolve(f)}return Promise.resolve(null)};b.prototype._editShape=function(a){if(a)if(!1===this._options.enableEditing)this._clear(),this._drawEnd(a);else{this.suspend();var b;switch(a.type){case "point":case "multipoint":b=this.markerSymbol;break;case "polyline":b=this.lineSymbol;
break;case "polygon":case "extent":b=this.fillSymbol}var f=this._getEditMode(this._geometryType);this._graphic=this._map.graphics.add(new esri.Graphic(a,b));this._editCompletedHandle&&(this._editCompletedHandle.remove(),this._editCompletedHandle=null);this._editCompletedHandle=dojo.aspect.after(this._editObject,"onDeactivate",dojo.hitch(this,"_onEditShapeCompleted"),!0);this._editObject.activate(f.mode,this._graphic,f.options)}};b.prototype._onEditShapeCompleted=function(a,b,f){a=f?!!f.isModified:
!1;f=f?!!f.cancelled:!1;b&&a&&(this._graphic=b);this.resume();this.onKeyboardStop(f)};b.prototype._toPolygon=function(a,b,f){var l=this._map;a=a.map(function(a){return l.toMap(new esri.geometry.ScreenPoint(a[0]+b,a[1]+f))});var n=new esri.geometry.Polygon(l.spatialReference);n.addRing(a);return n};b.prototype._syncPointsCollection=function(){this._points=this._drawObject._points};b.prototype._getEditMode=function(a){var e={mode:0,options:{}};switch(a){case b.POINT:e.mode=g.Edit.MOVE;break;case b.MULTI_POINT:e.mode=
g.Edit.EDIT_VERTICES;e.options.allowAddVertices=!1;e.options.allowDeleteVertices=!0;break;case b.POLYLINE:case b.ARROW:case b.LEFT_ARROW:case b.RIGHT_ARROW:case b.UP_ARROW:case b.DOWN_ARROW:case b.TRIANGLE:case b.RECTANGLE:case b.POLYGON:e.mode=g.Edit.MOVE|g.Edit.ROTATE|g.Edit.SCALE|g.Edit.EDIT_VERTICES;e.options.allowAddVertices=!0;e.options.allowDeleteVertices=!0;e.options.uniformScaling=!1;break;case b.EXTENT:e.mode=g.Edit.MOVE|g.Edit.SCALE;e.options.allowAddVertices=!1;e.options.allowDeleteVertices=
!1;e.options.uniformScaling=!1;break;case b.CIRCLE:e.mode=g.Edit.MOVE|g.Edit.SCALE;e.options.uniformScaling=!0;break;case b.ELLIPSE:e.mode=g.Edit.MOVE|g.Edit.ROTATE|g.Edit.SCALE,e.options.uniformScaling=!1}return e};b.prototype._vertexCount=function(a){return a&&"polyline"===a.type?a.paths[0].length:a&&"polygon"===a.type?a.rings[0].length-1:a&&"multipoint"===a.type?a.points.length:0};b.prototype._twoClicksWithin300MsFixup=function(){var a=this,b=this._drawObject;if(b&&"function"===typeof b._onClickHandler){var f=
b._onClickHandler;b._onClickHandler=function(b){return a._twoClicksWithin300MsFixup_handleClick(b,f)}}else this.app.trace.warning("The _drawObject _onClickHandler hook is dysfunctional. Markup and Measurement (tool) functionality may be affected on touch devices.")};b.prototype._twoClicksWithin300MsFixup_handleClick=function(a,e){var f=!1,l=0,n=0,c=function(a){l=a[0].mapPoint.x;n=a[0].mapPoint.y};if(this._geometryType===b.POLYLINE||this._geometryType===b.POLYGON||this._geometryType===b.POINT||this._geometryType===
b.MULTI_POINT){if(!f&&(a.mapPoint.x!==l||a.mapPoint.y!==n)){f=!0;setTimeout(function(){f=!1},300);var d={sender:this,mapPoint:a.mapPoint,screenPoint:a.screenPoint,snappingPoint:this._lastSnappingPoint};e.apply(this._drawObject,arguments);this.raiseGraphicVertexAdded(d)}c(arguments)}else e.apply(this._drawObject,arguments)};b.prototype._extraPointOnTouchDevicesFixup=function(){var a=this,b=function(b){var e=a._drawObject,n=!!(require&&require.has&&require.has("esri-touch"));a.app.trace.debug("[DrawTool] IsTouch = "+
n);var c=e?e._points:null;if(c)if(n){if(2<=c.length){var d=c.push;c.push=function(){a.app.trace.debug("[DrawTool] points.length "+c.length);c.push=d}}}else if(2>c.length||c[c.length-1].x!==b.mapPoint.x&&c[c.length-1].y!==b.mapPoint.y)a._lastSnappingPoint?a.app.trace.debug("[DrawTool] Bailout due to snapping"):(c.push(b.mapPoint),a.raiseGraphicVertexAdded({sender:a,mapPoint:b.mapPoint,screenPoint:b.screenPoint,snappingPoint:a._lastSnappingPoint}))};this._dblClickHandlerToken?this.app.trace.debug("[DrawTool] No double click subscribed"):
this._dblClickHandlerToken=this.app.map.on("dbl-click",b)};b._draw=function(){require(["esri/toolbars/draw"],function(a){b.ARROW=a.ARROW;b.CIRCLE=a.CIRCLE;b.DOWN_ARROW=a.DOWN_ARROW;b.ELLIPSE=a.ELLIPSE;b.EXTENT=a.EXTENT;b.FREEHAND_POLYGON=a.FREEHAND_POLYGON;b.FREEHAND_POLYLINE=a.FREEHAND_POLYLINE;b.LEFT_ARROW=a.LEFT_ARROW;b.LINE=a.LINE;b.MULTI_POINT=a.MULTI_POINT;b.POINT=a.POINT;b.POLYGON=a.POLYGON;b.POLYLINE=a.POLYLINE;b.RECTANGLE=a.RECTANGLE;b.RIGHT_ARROW=a.RIGHT_ARROW;b.TRIANGLE=a.TRIANGLE;b.UP_ARROW=
a.UP_ARROW})}();return b}(g.AccessibleMapComponent);g.Draw=m;(function(c){var b=function(a){function b(){a.apply(this,arguments)}__extends(b,a);b.prototype.raiseGraphicEditActivated=function(a){this.app.event("GraphicDrawAccessibleEditActivatedEvent").publish(a)};b.prototype.raiseGraphicEditDeactivated=function(a){this.app.event("GraphicDrawAccessibleEditDeactivatedEvent").publish(a)};return b}(d.accessibility.Edit);c.EditInternal=b})(m=g.Draw||(g.Draw={}))})(d.accessibility||(d.accessibility={}))})(d.infrastructure||
(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){var g=function(){function c(){this._tokenImpl=new m}c.prototype.token=function(){return this._tokenImpl};c.prototype.cancel=function(){this._tokenImpl.cancel()};c.prototype.dispose=function(){this._tokenImpl.dispose()};c.none=function(){this._none||(this._none={isCancellationRequested:!1,register:function(b){}});return this._none};return c}();d.CancellationTokenSource=g;var m=function(){function c(){this._listeners=[];this.isCancellationRequested=
!1}c.prototype.register=function(b){this._listeners.push(b)};c.prototype.cancel=function(){this.isCancellationRequested=!0;for(var b=0;b<this._listeners.length;b++)this._listeners[b]()};c.prototype.dispose=function(){this._listeners.length=0};return c}()})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(c){c[c.Site=0]="Site";c[c.User=1]="User";c[c.Project=2]="Project"})(d.BookmarkSource||(d.BookmarkSource={}));var g=d.BookmarkSource,m=function(){function c(b){this._projectBookmarks=[];if(!b)throw Error('Parameter "app" required.');this.app=b}c.prototype.getAll=function(){var b=this;return Promise.join(this.getSiteBookmarks(),this.getUserBookmarks()).spread(function(a,e){return(a||[]).concat(e).concat(b._projectBookmarks)})};c.prototype.getUserBookmarks=
function(){var b=this;return new Promise(function(a,e){b.app.store.get("bookmarks",function(e){var l=[];if(e)try{l=JSON.parse(e)}catch(n){b.app.trace.warning("Unable to parse user bookmarks: {0}".format(n))}e=l.map(function(a){return b._deserialize(a)});a(e)},e)})};c.prototype.getSiteBookmarks=function(){var b=this;return this.app.waitUntilSiteInitialized().then(function(){return(b.app.site.namedExtents||[]).map(function(a){return{name:a.displayName,extent:a.extent,source:g.Site}})})};c.prototype.getProjectBookmarks=
function(){return Promise.resolve(this._projectBookmarks)};c.prototype.add=function(b){var a=this;if(!b)throw Error('Parameter "bookmark" required.');b.source=b.source||g.User;return b.source===g.Project?(this._projectBookmarks.push(b),this.app.event("BookmarksModifiedEvent").publish(""),Promise.resolve()):this.getUserBookmarks().then(function(e){e.push(b);return a._save(e)})};c.prototype.remove=function(b){var a=this;if(b)return"string"===typeof b?this._projectBookmarks=this._projectBookmarks.filter(function(a){return a.name!==
b}):"object"===typeof b&&(this._projectBookmarks=this._projectBookmarks.filter(function(a){return a!==b})),this.getUserBookmarks().then(function(e){"string"===typeof b?e=e.filter(function(a){return a.name!==b}):"object"===typeof b&&(e=e.filter(function(a){return a!==b}));return a._save(e)})};c.prototype["export"]=function(b){var a=this;b=b||[g.Site,g.User,g.Project];return this.getAll().then(function(e){return e.filter(function(a){return 0<=b.indexOf(a.source)}).map(function(b){return{name:b.name,
extent:a.app.project.convert.fromEsriGeometry(b.extent)}})})};c.prototype._save=function(b){var a=this;return new Promise(function(e,f){var l=JSON.stringify((b||[]).map(function(b){return a._serialize(b)}));a.app.store.set("bookmarks",l,function(b,f){e();a.app.event("BookmarksModifiedEvent").publish(l)},f)})};c.prototype._serialize=function(b){return{displayName:b.name,extent:this.app.webMap.convert.fromEsriGeometry(b.extent),isUserDefined:!0}};c.prototype._deserialize=function(b){return{name:b.displayName,
extent:this.app.webMap.convert.toEsriGeometry(b.extent),source:g.User}};return c}();d.BookmarkManager=m})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){var g=function(){return function(){}}();d.AttributeGroup=g})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){var g=function(){function g(){this.dataLink=new Observable;this.table=new Observable}g.prototype.toAttributes=function(){var c=this.table.get();if(!c)return null;for(var b={},a=0;a<c.columns.length;a++)b[c.columns[a]]=0<c.rows.length?c.rows[0].row[a]:null;return b};g.prototype.asAttributeGroup=function(){this._attributeGroup||(this._attributeGroup=new d.AttributeGroup,this._attributeGroup.owner=this,this._attributeGroup.attributes=this.toAttributes());
return this._attributeGroup};return g}();d.DataLinkingResult=g})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){var g=function(){function g(c,b,a,e,f,l,n){this.value=new Observable("undefined"===typeof c?"":c);this.name=new Observable("undefined"===typeof b?"":b);this.alias=new Observable("undefined"===typeof a?this.name.get():a);this.displayName=new Observable("undefined"===typeof e?this.alias.get()?this.alias.get():this.name.get():e);this.visible=new Observable("undefined"===typeof f?!0:f);this.type=new Observable("undefined"===typeof n?"":n);l=l||h.PresentableDelegateFactory.valuePresenterDelegate(null,
null);this.presentableValue=new d.framework.ui.LazyObservable(null,l(c),!0);this.displayAsUrl=d.framework.utils.isUrl(c)}g.ignoreAttribute=function(c){return c&&g.ignoreAttributeMatcher.test(c)};g.ignoreAttributeMatcher=/.*\.Name\(\)$/;return g}();h.FeatureAttribute=g})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){var g=function(){function d(){}d.DATE_SHORT="d";d.DATE_LONG="D";d.TIME_SHORT="t";d.TIME_LONG="T";d.DATE_TIME_SHORT="g";d.DATE_TIME_LONG="G";d.FULL="f";d.ISO_8601="u";d.ROUND_TRIP="u";d.DEFAULT="g";d.DEFAULT_PARSING_FORMATS=[d.ISO_8601,d.DATE_TIME_SHORT,d.DATE_TIME_LONG,d.DATE_SHORT,d.DATE_LONG];return d}();d.DateFormat=g;g=function(){function d(){}d.NUMBER="n";d.FIXED_POINT="f";d.CURRENCY="c";d.ACCOUNTING="a";d.PERCENT="p";d.ROUND_TRIP="r";d.DEFAULT=
d.FIXED_POINT;return d}();d.NumberFormat=g})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){function m(a,b,f){void 0===b&&(b=h.DateFormat.DEFAULT);var l=null;if(!a||!a.getTime||isNaN(a.getTime()))return"";if(!moment)throw Error('Error: The "moment.js" library is required for formatting dates.');var n=c(a,f);f&&(a=moment(a.toISOString()),f.displayTimeZoneId&&(l=a.tz(f.displayTimeZoneId).format("Z")));return moment(n).format(e(b,l))}function c(a,b){return b&&(b.timeZoneId||b.displayTimeZoneId)?b.displayTimeZoneId?b.timeZoneId?
h.TimeZoneUtils.correctDatesForDisplayInDisplayTimeZone(a,b.timeZoneId,b.displayTimeZoneId):h.TimeZoneUtils.correctDatesForDisplayInDisplayTimeZone(a,h.TimeZoneUtils.UTC_ZONE_ID,b.displayTimeZoneId):h.TimeZoneUtils.correctDatesForDisplayInLocalTime(a,b.timeZoneId):a}function b(a,b,e){void 0===b&&(b=h.NumberFormat.DEFAULT);void 0===e&&(e={});if(null===a||void 0===a||isNaN(a))return"";b=b||h.NumberFormat.DEFAULT;e=e||{};if(b===h.NumberFormat.ROUND_TRIP)return a.toString();if(!_globalize)throw Error('Error: The "globalize.js" library is required for formatting numbers.');
var l=b.toLowerCase();if(l===h.NumberFormat.CURRENCY||l===h.NumberFormat.ACCOUNTING)b=l+(void 0!==e.fractionalDigits?e.fractionalDigits:""),b+=e.currency?"$"+e.currency.toUpperCase():"";else if(l===h.NumberFormat.NUMBER||l===h.NumberFormat.FIXED_POINT||l===h.NumberFormat.PERCENT)b=l+(void 0!==e.fractionalDigits?e.fractionalDigits:"");e=(_globalize.locale()?_globalize.locale().locale:"en")+"|"+b;l=n[e];l||(l=[],b=b.split(";",3),1===b.length?(l[0]=f(b[0]),l[1]=l[0],l[2]=l[0]):2===b.length?(l[0]=f(b[0]),
l[1]=f(b[1]),l[2]=l[0]):3===b.length&&(l[0]=f(b[0]),l[1]=f(b[1]),l[2]=f(b[2])),n[e]=l);return 0<a?l[0](a):0>a?l[1](a):l[2](a)}function a(a,b,f){if(a instanceof Date)return a;if("number"===typeof a)return new Date(a);if(!a||"string"!==typeof a)return l;if(void 0===f){var n=parseFloat(a);if(!isNaN(n)&&isFinite(a))return new Date(n)}if(!moment)throw Error('Error: The "moment.js" library is required for parsing dates.');f=f||h.DateFormat.DEFAULT_PARSING_FORMATS;f=[].concat(f);f=f.map(function(a){a=e(a);
return void 0===a?moment.ISO_8601:a});a=b?moment.utc(a,f):moment(a,f);return a.isValid()?a.toDate():l}function e(a,b){a=a||h.DateFormat.DEFAULT;var e=a+(b?b:"");switch(a){case h.DateFormat.DATE_SHORT:return"L";case h.DateFormat.DATE_LONG:return"LL";case h.DateFormat.TIME_SHORT:return"LT";case h.DateFormat.TIME_LONG:return"LTS";case h.DateFormat.DATE_TIME_SHORT:return"lll";case h.DateFormat.DATE_TIME_LONG:return"LLL";case h.DateFormat.FULL:return"LLLL";case h.DateFormat.ISO_8601:break;default:var f=
p[e];if(f)return f;for(var l=a.match(/%?([dfFghHKmMstyz])\1*|\\.|(["'])[^\2]+\2|[^dfFghHKmMstyz\\'"]+/g),f="",n=0;n<l.length;n++){var c=l[n];c.startsWith("%")&&(c=c.slice(1));switch(c[0]){case "y":f=2>=c.length?f+"YY":4>=c.length?f+"YYYY":f+"YYYYY";break;case "d":f=2>=c.length?f+c.slice(0,2).toUpperCase():f+c.slice(0,4);break;case "f":case "F":f+=c.slice(0,3).replace(/[Ff]/g,"S");break;case "t":f+="A";break;case "z":f+=b?"["+b+"]":"Z";break;case "M":f+=c.slice(0,4);break;case "h":case "H":case "m":case "s":f+=
c.slice(0,2);break;case "g":case "K":console.warn('The "{0}" date format specifier is not supported.'.format(c));break;default:c.startsWith('"')||c.startsWith("'")?c=c.slice(1,-1):c.startsWith("\\")&&(c=c.slice(1)),f+="["+c+"]"}}return p[e]=f}}function f(a,b){var e=b||{},f=a.match(/^([acfnp])(\d*)(?:\$([a-zA-Z]{3}))?$/i);if(f){var l=f[1].toLowerCase(),n=Math.min(20,parseInt(f[2])),f=f[3];l===h.NumberFormat.CURRENCY||l===h.NumberFormat.ACCOUNTING?f||(f=(f=d.framework.applications[0])&&f.configuration&&
f.configuration.defaultCurrency?f.configuration.defaultCurrency:"USD"):(f="",void 0===e.minimumFractionDigits&&(e.minimumFractionDigits=0),void 0===e.maximumFractionDigits&&(e.maximumFractionDigits=Math.max(4,e.minimumFractionDigits)));l===h.NumberFormat.PERCENT?e.style="percent":l===h.NumberFormat.ACCOUNTING?e.style="accounting":l===h.NumberFormat.FIXED_POINT&&(e.useGrouping=!1);isNaN(n)||(e.minimumFractionDigits=n,e.maximumFractionDigits=n);return f?_globalize.currencyFormatter(f,e):_globalize.numberFormatter(e)}var f=
a.match(/[0#]+|\.|,|%|\\.|(["'])[^\1]+\1|[^0#.,\\'"]+/g),c=!1,r=n=l="",p="";e.minimumFractionDigits=0;e.maximumFractionDigits=0;e.useGrouping=!1;for(var g=0;g<f.length;g++){var m=f[g];switch(m[0]){case ".":c=!0;break;case ",":e.useGrouping=!0;break;case "%":e.style="percent";break;case "0":case "#":c?n+=m:l+=m;break;default:m.startsWith('"')||m.startsWith("'")?m=m.slice(1,-1):m.startsWith("\\")&&(m=m.slice(1)),l||n?p+=m:r+=m}}l&&(f=l.indexOf("0"),0<=f&&(e.minimumIntegerDigits=l.length-f));n&&(f=n.lastIndexOf("0"),
e.minimumFractionDigits=0<=f?f+1:0,e.maximumFractionDigits=Math.min(20,n.length));if(l||n){var k=_globalize.numberFormatter(e);return function(a){return void 0!==e.minimumIntegerDigits&&0>a?r+"-"+k(-1*a)+p:r+k(a)+p}}return function(a){return r+p}}var l=new Date(NaN);g.format=function(a){return a instanceof Date?m(a):"number"===typeof a?b(a):null===a||void 0===a?"":a.toString()};g.formatDate=m;g.formatDateFromNow=function(a,b){if(!a||!a.getTime||isNaN(a.getTime()))return"";if(!moment)throw Error('Error: The "moment.js" library is required for formatting dates.');
var e=c(a,b);return moment(e).fromNow()};g.formatNumber=b;g.parseDate=function(b,e){return a(b,!1,e)};g.parseUtcDate=function(b,e){return a(b,!0,e)};g.parseNumber=function(a,b){if("number"===typeof a)return a;if("boolean"===typeof a)return a?1:0;if(null===a||void 0===a)return NaN;if(!_globalize)throw Error('Error: The "globalize.js" library is required for parsing numbers.');a=a.toString().trim();a=a.replace(" ","\u00a0");var e=_globalize.locale()?_globalize.locale().locale:"en",l=r[e];l||(l=_globalize.numberParser(),
r[e]=l);e=1;a&&"("===a[0]&&")"===a[a.length-1]&&(e=-1,a=a.slice(1,-1));var n=l(a);isNaN(n)&&(n=parseFloat(a));if(isNaN(n))return n;var n=n*e,l=[].concat(b||[]),c=/^([acfnp])(?:\$([a-zA-Z]{3}))?$/i;return!l.length||l.some(function(b){var e=f(b,{minimumFractionDigits:0,maximumFractionDigits:20});if(a===e(n))return!0;if(b.match(c))for(var l=0;20>=l;l++)if(e=f(b,{minimumFractionDigits:l,maximumFractionDigits:l}),a===e(n))return!0;return!1})?n:NaN};var n={},r={},p={}})(h.FormatUtils||(h.FormatUtils={}))})(k.infrastructure||
(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){var g=function(){function g(){}g.typeIdForLayerAndAttributes=function(c,b){return c.typeIdField?b[c.typeIdField]:null};g.typeFromLayerAndId=function(c,b){for(var a=0;a<c.types.length;a++)if(c.types[a].id==b)return c.types[a];return null};g.makeValueTruthy=function(c){return 0===c?"0":!1===c?"false":c};g.valuePresenterDelegate=function(c,b){var a,e;"string"===typeof c?(e=c,b&&b.layer&&(a=b.layer.fields.filter(function(a){return a.name===e})[0])):
c instanceof d.essentials.Field?(a=c,e=a.name):c&&c.name&&(e=c.name);return function(f){return function(){var l=b?b.featureLayer:null,n=b?b.getType():null,r=l?l.getField(e):null,p;c instanceof h.gis.FieldInfo&&(p=c);if(!r&&!a&&!p)return f instanceof Date?h.FormatUtils.formatDate(f,b?b.defaultDateFormat:h.DateFormat.DEFAULT):"number"===typeof f?h.FormatUtils.formatNumber(f,b?b.defaultNumberFormat:h.NumberFormat.DEFAULT):g.makeValueTruthy(f);a&&a.hyperlinkLabel&&d.framework.utils.isUrl(f)&&(f=a.hyperlinkLabel);
if(b){var s=b.esriFeature.get();if(s&&s.attributes.hasOwnProperty(e+".Name()"))return g.makeValueTruthy(s.attributes[e+".Name()"])}p||(p=r?h.gis.FieldInfo.fromEsriField(r,l,a):h.gis.FieldInfo.fromGcxField(a));p.isDate()&&!p.format&&b&&b.defaultDateFormat?p.format="{0:"+b.defaultDateFormat+"}":p.isNumeric()&&!p.format&&b&&b.defaultNumberFormat&&(p.format="{0:"+b.defaultNumberFormat+"}");return p.formatValue(f,n?n.id.toString():null)}}};return g}();h.PresentableDelegateFactory=g})(k.infrastructure||
(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){var g=function(){return function(){this.id=new Observable;this.contentType=new Observable;this.size=new Observable;this.name=new Observable;this.url=new Observable}}();d.AttachmentInfo=g})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(){return function(c,b,a,e,f){this.geometries=c;this.outputSpatialReference=e;this.callback=b;this.errback=a;this.transformation=f}}();d.ProjectArgs=h})(d.commandArgs||(d.commandArgs={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){function h(a,b,e){if(a===b)return!0;if(null==a||null==b)return!1;var f=Object.keys(a),l=Object.keys(b),f=n.difference(f,e),l=n.difference(l,e);if(f.length!==l.length)return!1;for(e=0;e<f.length;e++)if(l=f[e],a[l]!==b[l])return!1;return!0}function c(a,b){return a===b||a.type===b.type&&a.spatialReference&&b.spatialReference&&a.spatialReference.equals(b.spatialReference)}function b(a,b){return a===b||a.x==b.x&&a.y==b.y&&c(a,b)}function a(a,
b){var e=c(a,b);if(e&&a.points.length===b.points.length){for(var f=0;e&&f<a.points.length;f++)e=a.points[f][0]===b.points[f][0]&&a.points[f][1]===b.points[f][1];return e}return!1}function e(a,b){var e=c(a,b);e&&dojo.forEach(a.paths,function(a,f){if(a.length===b.paths[f].length){for(var l=0;e&&l<a.length;l++)e=a[l][0]===b.paths[f][l][0]&&a[l][1]===b.paths[f][l][1];if(!e)return e}else e=!1});return e}function f(a,b){var e=c(a,b);e&&dojo.forEach(a.rings,function(a,f){if(a.length===b.rings[f].length){for(var l=
0;e&&l<a.length;l++)e=a[l][0]===b.rings[f][l][0]&&a[l][1]===b.rings[f][l][1];if(!e)return e}else e=!1});return e}function l(a,b){return c(a,b)&&a.xmin==b.xmin&&a.xmax==b.xmax&&a.ymin==b.ymin&&a.ymax==b.ymax}var n=d.framework.utils.ArrayUtils;g.stepZoom=function(a,b,e){null==e&&(e=a.extent);b=d.essentials.GeometryUtilities.scaleEnvelopeWithoutTranslation(e,1/b);a.setExtent(b,!!a._fitTiledMapsToExtent);return b};g.stepZoomWithPriority=function(a,b,e,f){null==e&&(e=a.getMap().extent);var l=a.essentialsMap.getMap();
e=d.essentials.GeometryUtilities.scaleEnvelopeWithoutTranslation(e,1/b);var n=l.getLevel();if(void 0!==n&&null!==n&&-1<n)return a=n,1<b?a=n+1:1>b&&(a=n-1),l.setLevel(a),e;a.essentialsMap.extentManager.setExtentWithPriority(e,f);return e};g.getExtent=function(a){return a?"point"==a.type?new esri.geometry.Extent(a.x,a.y,a.x,a.y,a.spatialReference):a.getExtent():null};g.panToPointWithPriority=function(a,b,e,f){function l(b){a.trace.warning("PanToPoint: "+b.message)}var n=function(b){var l=null,n=null;
b&&0<b.length&&(l=b[0]);a.map&&l&&((f||void 0===f)&&a.command("ShowMap").execute(),"point"==l.type?a.site.essentialsMap.extentManager.centerAtWithPriority(l,e):"extent"==l.type?a.site.essentialsMap.extentManager.centerAtWithPriority(l.getCenter(),e):("polyline"==l.type||"polygon"==l.type||"multipoint"==l.type)&&(n=l.getExtent())&&a.site.essentialsMap.extentManager.centerAtWithPriority(n.getCenter(),e))};b&&b.isInstanceOf(esri.geometry.Geometry)&&(b=new d.essentialsHtmlViewer.mapping.infrastructure.commandArgs.ProjectArgs([b],
n,l),a.command("Project").execute(b))};g.zoomToExtent=function(a,b,e){this.zoomToExtentWithPriority(a,b,null,null,e)};g.zoomToExtentWithPriority=function(a,b,e,f){var l=function(b){b&&0<b.length&&((f||void 0===f)&&a.command("ShowMap").execute(),null==e?a.map.setExtent(b[0],!!a.map._fitTiledMapsToExtent):a.site.essentialsMap.extentManager.setExtentWithPriority(b[0],e),a.event("MapStartupExtentChangedEvent").publish(b[0]))};b&&b.isInstanceOf(esri.geometry.Extent)&&(!b.spatialReference&&a.map.spatialReference?
(b.spatialReference=a.map.spatialReference,l([b])):(b.spatialReference&&!b.spatialReference.toJson&&(b.spatialReference.wkid||b.spatialReference.wkt)&&(b.spatialReference=new esri.SpatialReference(b.spatialReference)),b=new d.essentialsHtmlViewer.mapping.infrastructure.commandArgs.ProjectArgs([b],l,function(b){a.trace.warning("ZoomToExtent: "+b.message)}),a.command("Project").execute(b)))};g.getClosestScale=function(a,b,e){a=a.__tileInfo&&a.__tileInfo.lods;if(!a||!a.length)return e;for(var f=0,l=
0;l<a.length;l++){if(a[l].scale===e)return e;if(b===r.LessThan){if(e<a[l].scale)continue}else if(a[l].scale>e){f=a[l].scale;continue}return b===r.LessThan?a[l].scale:f}};(function(a){a[a.LessThan=0]="LessThan";a[a.GreaterThan=1]="GreaterThan"})(g.ScaleChangeMode||(g.ScaleChangeMode={}));var r=g.ScaleChangeMode;g.cloneEsriFeature=function(a){var b=new esri.Graphic(a.toJson());b._graphicsLayer=a._graphicsLayer;return b};g.esriFeatureAttributesEqual=h;g.esriFeaturesEqual=function(a,b){if(a===b)return!0;
if(null==a||null==b)return!1;var e=["timestamp","clusterId","clusterCount","extent"],f=a.getLayer();f&&f instanceof esri.layers.FeatureLayer||(f=b.getLayer());if(f instanceof esri.layers.FeatureLayer){var l=f.objectIdField;if(l&&a.attributes&&b.attributes&&a.attributes[l]===b.attributes[l])return!0;if(f.editFieldsInfo)for(var l=0,n=Object.keys(f.editFieldsInfo);l<n.length;l++)e.push(f.editFieldsInfo[n[l]])}return h(a.attributes,b.attributes,e)};g.esriGeometriesEqual=function(n,c){switch(n?n.type:
null){case "point":return b(n,c);case "multipoint":return a(n,c);case "polyline":return e(n,c);case "polygon":return f(n,c);case "extent":return l(n,c)}return!1};g.compareTypeSR=c;g.esriPointsEqual=b;g.esriMultipointsEqual=a;g.esriPolylinesEqual=e;g.esriPolygonsEqual=f;g.esriExtentsEqual=l;g.findFeatureInLayer=function(a,b){if(!a||!b)return null;var e=b.objectIdField,f=b.graphics;if(1>f.length)return null;var l=["timestamp","clusterId","clusterCount","extent"];if(b.editFieldsInfo)for(var n in b.editFieldsInfo)b.editFieldsInfo.hasOwnProperty(n)&&
l.push(b.editFieldsInfo[n]);n=function(a){var b=0,e;for(e in a)!d.framework.utils.ArrayUtils.contains(l,e)&&a.hasOwnProperty(e)&&++b;return b};var c=f[0].attributes;if(n(c)!==n(a.attributes))return null;var r=0,g=[],h=[],m;for(m in c){var k=d.framework.utils.ArrayUtils.contains(l,m);if(!(k||c.hasOwnProperty(m)&&a.attributes.hasOwnProperty(m)))return null;k||(g.push(m),h.push(m),++r)}for(m=0;m<r;++m)if(g[m]!==h[m])return null;for(r=0;r<f.length;r++)if(g=f[r],n(c)===n(a.attributes)&&g.attributes[e]===
a.attributes[e])return g._graphicsLayer=b,g;return null};g.findFeatureInMap=function(a,b,e){var f=null;if(e&&(f=this.findFeatureInLayer(a,e)))return f._graphicsLayer=e,f;b=b.getFeatureServices();for(var l=0;l<b.length;l++){var n=b[l].serviceLayer;if(!e||n!==e)if(f=this.findFeatureInLayer(a,n))return f}!f&&a.getLayer&&a.getLayer()&&(f=a);return f};g.getThumbnailUri=function(a,b,e,f,l){void 0===e&&(e=150);void 0===f&&(f=150);void 0===l&&(l=20);var n=new d.essentials.ReportParameters;n.outputFormat=
"PNG";n.includeData=!0;n.imageWidth=e;n.imageHeight=f;n.resolution={displayName:"custom",dpi:l};n.customExtent=b||a.map.extent;n.extentType=d.essentials.ReportParameters.CUSTOM_EXTENT;n.populateMapGraphicsLayers(a.map);return new Promise(function(b,e){a.site.essentialsMap.exportMap(n,function(a){a.data?b("data:image/png;base64,{0}".format(a.data)):a.href?b(a.href):b(null)},function(e){a.trace.error("Error exporting map for thumbnail: {0}".format(e.message));b(null)})})}})(h.MapUtils||(h.MapUtils=
{}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){var g=function(){function g(c){var b=this;this._isAttachmentInfosLoaded=!1;this._defaultFieldFormatString="{0}: {1}";this.featureSet=this.featureLayer=this.token=null;this.labelFormat=new d.framework.ui.LazyObservable;this.minScale=new d.framework.ui.LazyObservable;this.maxScale=new d.framework.ui.LazyObservable;this.zoomScale=new d.framework.ui.LazyObservable;this.zoomFactor=new d.framework.ui.LazyObservable;this.zoomExtent=new Observable;this.borderColor=
new d.framework.ui.LazyObservable;this.borderWidth=new d.framework.ui.LazyObservable;this.fillColor=new d.framework.ui.LazyObservable;this.id=new d.framework.ui.LazyObservable;this.attributes=new ObservableCollection;this.label=new d.framework.ui.LazyObservable;this.plainLabel=new d.framework.ui.LazyObservable;this.description=new d.framework.ui.LazyObservable;this.descriptionFormat=new d.framework.ui.LazyObservable;this.longDescription=new d.framework.ui.LazyObservable;this.longDescriptionFormat=
new d.framework.ui.LazyObservable;this.hyperlinks=new ObservableCollection;this.extendedProperties=new ObservableCollection;this.attachmentInfos=null;this.attachmentInfosInitialized=new Observable(!1);this.hasAttachments=new Observable(!1);this.hasRelationships=new Observable(!1);this.hasVisibleRelationships=new Observable(!1);this.hasGeometry=new d.framework.ui.LazyObservable;this.hasValidGeometry=new d.framework.ui.LazyObservable;this.iconUri=new d.framework.ui.LazyObservable;this.linkedAttributes=
new ObservableCollection;this.dataLinkingResults=new ObservableCollection;this.defaultNumberFormat=h.NumberFormat.DEFAULT;this.defaultDateFormat=h.DateFormat.DEFAULT;this.isModified=!1;this.displayTimeZoneId=this.timeZoneId=null;this._resolveLayerFields=this._allowUnsafeContent=!1;this._attributeValueBindingTokens={};var a=null;c&&c.hasOwnProperty("graphic")&&(this._graphic=c.graphic);c&&c.hasOwnProperty("featureLayer")&&(this.featureLayer=c.featureLayer);c&&c.hasOwnProperty("layer")&&(a=c.layer)&&
!this.featureLayer&&a.getFeatureLayer().then(function(a){(b.featureLayer=a)&&b._refreshPresentableValues()});c&&c.hasOwnProperty("resolveLayerFields")?this._resolveLayerFields=c.resolveLayerFields:a&&a.fields&&(this._resolveLayerFields=!0);c&&c.hasOwnProperty("allowUnsafeContent")?this._allowUnsafeContent=c.allowUnsafeContent:this._allowUnsafeContent=!1;c&&c.hasOwnProperty("timeZoneId")&&(this.timeZoneId=c.timeZoneId);c&&c.hasOwnProperty("displayTimeZoneId")&&(this.displayTimeZoneId=c.displayTimeZoneId);
this.token=d.framework.utils.alphaNumericToken();this.esriFeature=new Observable(this._graphic);this.esriFeature.bind(this,function(){b._graphic=b.esriFeature.get();b.loadAttributes(b._resolveLayerFields);b._setupLinkedAttributes();b.attachmentInfos.clear();b._isAttachmentInfosLoaded=!1;b.attachmentInfosInitialized.set(!1);b._refreshPresentableValues()});this.connectDelegates();if(a){this.layer=a;this.hasAttachments.set(this.layer.hasAttachments);if(this.layer.relationships&&0<this.layer.relationships.length)for(this.hasRelationships.set(!0),
c=0;c<this.layer.relationships.length;c++)if(this.layer.relationships[c].visible){this.hasVisibleRelationships.set(!0);break}null!=a.featureHyperlinks&&this.hyperlinks.addItems(a.featureHyperlinks)}this.loadAttributes(this._resolveLayerFields);this.isModified=!1;this._prepAttachmentInfos();this._graphic&&this._setupLinkedAttributes()}g.prototype.getExtendedPropertyByName=function(c){for(var b=0;b<this.extendedProperties.getLength();b++){var a=this.extendedProperties.getAt(b);if(a&&a.name==c)return a.value}return null};
g.prototype.setExtendedProperty=function(c,b){for(var a=0;a<this.extendedProperties.getLength();a++){var e=this.extendedProperties.getAt(a);if(e&&e.name==c){e.value=b;return}}this.extendedProperties.addItem({name:c,value:b})};g.prototype.connectDelegates=function(){var c=this;this.hasGeometry.delegateGetter=function(){return!(!c._graphic||!c._graphic.geometry)};this.hasValidGeometry.delegateGetter=function(){return!(!c._graphic||!c._graphic.geometry)&&h.GeometryUtils.isValidGeometry(c._graphic.geometry)};
this.id.cacheDelegateResults=!0;this.id.delegateGetter=function(){var b="";if(c._graphic&&c.layer){var a=null;c.layer&&(a=c.layer.getObjectIdFieldName());a&&c._graphic.attributes&&c._graphic.attributes.hasOwnProperty(a)&&(b=c._graphic.attributes[a])}return b};this.label.delegateGetter=function(){var b=null,b=c.labelFormat.get(),b=c.formatTemplateString(b);null!=b&&void 0!=b&&b.toString().trim()||(b=c._getDefaultFieldValue(),void 0!=b&&null!=b&&c.layer&&(b=c.layer.displayName&&c.layer.displayName.toString().trim()?
c.layer.displayName+(b.toString().trim()?", "+b:""):b.toString().trim()?b:""));return h.FilterUtils.sanitize(b,{allowFrames:!1,uriTransformer:function(a,b){return b.type!==h.FilterUtils.UriType.NavigableLink?a:/^mailto\:/.test(a)?a:"command:OpenWebPage?"+a}})};this.plainLabel.delegateGetter=function(){return h.FilterUtils.stripHtml(c.label.get())};this.labelFormat.delegateGetter=function(){return c.layer&&c.layer.featureLabel?c.layer.featureLabel:c.layer&&c.layer.displayField?"{"+c._sanitizeFieldName(c.layer.displayField.name)+
"}":c.featureSet&&c.featureSet.esriFeatureSet&&c.featureSet.esriFeatureSet.displayFieldName&&c.featureSet.layer&&c.featureSet.layer.displayName?c.featureSet.layer.displayName+", {"+c.featureSet.esriFeatureSet.displayFieldName+"}":c.featureSet&&c.featureSet.esriFeatureSet&&c.featureSet.esriFeatureSet.displayFieldName?"{"+c._sanitizeFieldName(c.featureSet.esriFeatureSet.displayFieldName)+"}":""};this.borderColor.delegateGetter=function(){return c.layer&&c.layer.featureBorderColor?c.layer.featureBorderColor:
null};this.borderWidth.delegateGetter=function(){return c.layer&&"number"==typeof c.layer.featureBorderWidth&&0<=c.layer.featureBorderWidth?c.layer.featureBorderWidth:null};this.fillColor.delegateGetter=function(){return c.layer&&c.layer.featureFillColor?c.layer.featureFillColor:null};this.description.delegateGetter=function(){var b=c.descriptionFormat.get();return c.formatTemplateString(b)};this.descriptionFormat.delegateGetter=function(){return c.layer&&c.layer.featureDescription?c.layer.featureDescription:
null};this.longDescription.delegateGetter=function(){var b=c.longDescriptionFormat.get();return c.formatTemplateString(b)};this.longDescriptionFormat.delegateGetter=function(){return c.layer&&c.layer.featureLongDescription?c.layer.featureLongDescription:c.descriptionFormat.get()};this.minScale.delegateGetter=function(){return c.layer&&!isNaN(c.layer.minScale)?c.layer.minScale:Infinity};this.maxScale.delegateGetter=function(){return c.layer&&!isNaN(c.layer.maxScale)?c.layer.maxScale:0};this.iconUri.delegateGetter=
function(){return c.layer&&c.layer.iconUri?c.layer.iconUri:c.featureSet&&c.featureSet.iconUri&&c.featureSet.iconUri.get()?c.featureSet.iconUri.get():null};this.zoomScale.delegateGetter=function(){return c.layer&&c.layer.featureZoomScale?c.layer.featureZoomScale:null};this.zoomFactor.delegateGetter=function(){return c.layer&&c.layer.featureZoomFactor?c.layer.featureZoomFactor:null}};g.prototype.withinScaleRange=function(c){return 0==this.maxScale.get()&&Infinity==this.minScale.get()||isNaN(this.maxScale.get())&&
isNaN(this.minScale.get())?!0:c?this.maxScale.get()<=c&&c<=this.minScale.get():!1};g.prototype.calculateScaleToMakeVisible=function(c){return this.withinScaleRange(c)?c:c<this.maxScale.get()?this.maxScale.get():this.minScale.get()};g.prototype._sanitizeFieldName=function(c){return c?c.replace(/\W/g,""):""};g.prototype._getDefaultFieldValue=function(){var c="",b=this.esriFeature.get();b&&this.layer&&this.layer.displayField&&(c=b.attributes[this.layer.displayField.name],null!==c&&void 0!==c&&(c=c.toString().trim()));
null!=c&&void 0!=c&&c||!b||!b.attributes||(c=b.attributes.OBJECTID,null!==c&&void 0!==c&&(c=c.toString().trim()));if((null==c||void 0==c||!c)&&b&&b.attributes)for(var a in b.attributes)if(c=b.attributes[a],null!==c&&void 0!==c&&(c=c.toString().trim()),c)break;return String.escapeHtmlEncode(c)};g.prototype._prepAttachmentInfos=function(){var c=this,b=new ObservableCollection,a=b.get;b.get=function(){c._isAttachmentInfosLoaded||c._loadAttachmentsInfos();return a.call(b)};var e=b.getItems;b.getItems=
function(){c._isAttachmentInfosLoaded||c._loadAttachmentsInfos();return e.call(b)};var f=b.getAt;b.getAt=function(a){c._isAttachmentInfosLoaded||c._loadAttachmentsInfos();return f.call(b,a)};this.attachmentInfos=b};g.prototype.loadAttributes=function(c){var b=this,a={};this.attributes.get().forEach(function(e){a[e.name.get()]=e.value.get();var l=b._attributeValueBindingTokens[e.name.get()];l&&e.value.unbind(l)});this.attributes.clear();this._attributeValueBindingTokens={};c=this.getAttributesFromEsriFeature(this._graphic.attributes,
c);c.forEach(function(e){var l=e.name.get(),n=e.value.get();b._attributeValueBindingTokens[l]=e.value.bind(b,function(){b.isModified=!0});b.isModified=b.isModified||a.hasOwnProperty(l)&&n!==a[l]||!a.hasOwnProperty(l)});var e=this._graphic.attributes||{};this.isModified=this.isModified||Object.keys(a).some(function(a){return!e.hasOwnProperty(a)});this.attributes.addItems(c)};g.prototype.getAttributesFromEsriFeature=function(c,b){var a=this,e=[];if(!1!==b&&this.layer&&this.layer.fields){var f=null;
this.layer.mapService&&(f=this.layer.mapService.serviceLayer);for(var l=[],n=0;n<this.layer.fields.length;n++){var r=this.layer.fields[n],p;c&&(r.name||r.alias)&&(p=c.hasOwnProperty(r.name)?c[r.name]:c[r.alias]);d.essentialsHtmlViewer.mapping.infrastructure.FeatureAttribute.ignoreAttribute(r.name)?l.push(r):"undefined"===typeof p||null==p?e.push(new h.FeatureAttribute("",r.name,r.alias,r.displayName,r.visible,h.PresentableDelegateFactory.valuePresenterDelegate(r,this),r.dataType)):e.push(new h.FeatureAttribute(p,
r.name,r.alias,r.displayName,r.visible,h.PresentableDelegateFactory.valuePresenterDelegate(r,this),r.dataType))}for(p=0;p<l.length;p++){var g=l[p];g.visible&&(n=e.filter(function(a){return a.name.get()===g.name.substr(0,g.name.length-7)}),n=1===n.length?n[0]:null)&&(n.visible.get()||n.visible.set(!0),n.alias.set(g.alias),n.displayName.set(g.displayName))}if(f instanceof esri.layers.WMSLayer)for(var m in c){f=!1;l=c[m];for(p=0;p<this.layer.fields.length;p++)if(m===this.layer.fields[p].name){f=!0;break}f||
e.push(new h.FeatureAttribute(l,m))}}else if(this.featureLayer)this.featureLayer.fields.forEach(function(b){var f=b.alias?b.alias:b.name;if(b.type===d.essentials.EsriFieldTypes.esriFieldTypeDate){var l=k.infrastructure.gis.FieldInfo.fromEsriField(b,a.featureLayer);l.timeZoneId||(l.timeZoneId=a.timeZoneId);l.displayTimeZoneId||(l.displayTimeZoneId=a.displayTimeZoneId);!a.layer&&a.defaultDateFormat&&(l.format="{0:"+a.defaultDateFormat+"}");e.push(new h.FeatureAttribute(c[b.name],b.name,f,f,!0,h.PresentableDelegateFactory.valuePresenterDelegate(l,
null)))}else e.push(new h.FeatureAttribute(c[b.name],b.name,f,f,!0,h.PresentableDelegateFactory.valuePresenterDelegate(b.name,a)))});else if(this.featureSet&&this.featureSet.attributes&&0<this.featureSet.attributes.length()&&c)for(p=0;p<this.featureSet.attributes.length();p++)m=this.featureSet.attributes.getAt(p),f=m.name.get(),d.essentialsHtmlViewer.mapping.infrastructure.FeatureAttribute.ignoreAttribute(f)||c.hasOwnProperty(f)&&e.push(new h.FeatureAttribute(c[f],f,m.alias.get(),m.displayName.get(),
m.visible.get(),h.PresentableDelegateFactory.valuePresenterDelegate(f,this)));else if(c)for(f in c)e.push(new h.FeatureAttribute(c[f],f,f,f,!0,h.PresentableDelegateFactory.valuePresenterDelegate(f,this)));return e};g.prototype.getAttributes=function(c){c=this.linkedAttributes.get();for(var b=[],a=0;a<c.length;a++){var e=c[a];if(0===a)for(var e=this.attributes.get(),f=0;f<e.length;f++)b.push(e[f]);else{var e=e.attributes,l;for(l in e)e.hasOwnProperty(l)&&b.push(new h.FeatureAttribute(e[l],l,l,l,!0,
h.PresentableDelegateFactory.valuePresenterDelegate(null,null)))}}return b};g.prototype.getPrimaryKeyValue=function(){var c=null;if(this.layer&&this.layer.primaryKeyField){var b=this.layer.primaryKeyField;b&&(c=this._graphic.attributes[b.name])}return c};g.prototype.getFeatureUrl=function(){var c=null,b=this.layer.getLayerUrl?this.layer.getLayerUrl():this.layer.url,a=null;this.layer instanceof d.essentials.Layer?a=this.getPrimaryKeyValue():this.layer instanceof esri.layers.Layer&&(a=this.layer,a=
this.esriFeature.get().attributes[a.objectIdField]);b&&a&&(c=b+"/"+a);return c};g.prototype.getType=function(){if(!this.featureLayer)return null;var c=h.PresentableDelegateFactory.typeIdForLayerAndAttributes(this.featureLayer,this._graphic.attributes);if(null!==c)return h.PresentableDelegateFactory.typeFromLayerAndId(this.featureLayer,c)};g.prototype.structurallyEquals=function(c){return c&&c instanceof d.essentialsHtmlViewer.mapping.infrastructure.Feature?this===c||this._graphic&&c._graphic&&this._graphic===
c._graphic?!0:null!=this._graphic&&null!=c._graphic&&this._getLayerUniqueId()==c._getLayerUniqueId()&&this.id.get()===c.id.get()?String.isNullOrEmpty(this.id.get())?h.MapUtils.esriFeaturesEqual(this._graphic,c._graphic):!0:!1:!1};g.prototype.equals=function(c){if(!(c&&c instanceof d.essentialsHtmlViewer.mapping.infrastructure.Feature&&this._graphic&&c._graphic))return!1;if(this===c)return!0;var b=this._graphic.geometry,a=c._graphic.geometry,e=this.id.get()===c.id.get()||this.id.get()&&c.id.get()&&
this.id.get()==c.id.get(),f=this.layer===c.layer||this.layer&&c.layer&&this.layer.id==c.layer.id,l=this.layer===c.layer||this.layer&&c.layer&&this.layer.mapService===c.layer.mapService||this.layer&&c.layer&&this.layer.mapService&&c.layer.mapService&&this.layer.mapService.id==c.layer.mapService.id,n=b===a||b&&a&&b.declaredClass==a.declaredClass;if(!(e&&f&&l&&n&&d.essentialsHtmlViewer.mapping.infrastructure.MapUtils.esriFeaturesEqual(this._graphic,c._graphic)))return!1;if(b===a)return!0;switch(b.declaredClass){case "esri.geometry.Point":case "esri.geometry.ScreenPoint":return h.MapUtils.esriPointsEqual(b,
a);case "esri.geometry.MultiPoint":return h.MapUtils.esriMultipointsEqual(b,a);case "esri.geometry.Polyline":return h.MapUtils.esriPolylinesEqual(b,a);case "esri.geometry.Polygon":return h.MapUtils.esriPolygonsEqual(b,a);case "esri.geometry.Extent":return h.MapUtils.esriExtentsEqual(b,a);default:throw Error("Warning: equals() in Feature.ts - declared class does not match known geometry.");}};g.prototype._loadAttachmentsInfos=function(){var c=this;this._isAttachmentInfosLoaded=!0;if(!this.layer)throw Error("Error fetching attachment infos: Feature was not associated with any known layer.");
var b={url:this.getFeatureUrl()+"/attachments/?f=json&ts={0}".format((new Date).getTime()),handleAs:"json"},a=this.layer.mapService&&this.layer.mapService.serviceToken?this.layer.mapService.serviceToken:null,e=this.layer;!this.layer.mapService&&e.credential&&e.credential.token&&(a=e.credential.token);a&&(b.url+="&token="+encodeURIComponent(a));e=null;try{e=this.layer.mapService.serviceLayer.queryAttachmentInfos(parseInt(this.id.get()))}catch(f){e=esri.request(b)}e.then(function(b){if(0<b.length&&
!b.attachmentInfos&&b instanceof Array){b.attachmentInfos=[];for(var e=0;e<b.length;e++)b.attachmentInfos[e]=b[e]}if(b&&b.attachmentInfos&&0<b.attachmentInfos.length)for(e=0;e<b.attachmentInfos.length;e++){var f=b.attachmentInfos[e],p=new d.essentialsHtmlViewer.mapping.infrastructure.AttachmentInfo;p.id.set(f.id);p.contentType.set(f.contentType);p.size.set(f.size);p.name.set(f.name);f="{0}/attachments/{1}".format(c.getFeatureUrl(),f.id);a&&(f+="?token="+a);p.url.set(f);c.attachmentInfos.addItem(p)}c.attachmentInfosInitialized.set(!0)},
function(a){c.attachmentInfosInitialized.set(!0)})};g.prototype.formatTemplateString=function(c){var b=this;return c?c.replace(/{{.+?}}|{.+?}/g,function(a){if(a.match(/{{.+?}}/g))return a.substring(1,a.length-1);a=a.substring(1,a.length-1);var e="",f=a.match(/(.*)\.Name\(\)$/);f&&(a=f[1]);for(var f=b.getAttributes(),l=0;l<f.length;l++)if(f[l].name&&f[l].name.get()===a||f[l].alias&&f[l].alias.get()===a){if(b.layer&&b.layer.getFieldByName(a)&&d.framework.utils.isUrl(f[l].value.get())){e=f[l].value.get();
break}e=f[l].presentableValue.get();break}!e&&b.layer&&(e=d.essentials.utilities.StringUtilities.replaceLayerTokens(a,b.layer));!e&&b.layer&&b.layer.mapService&&(e=d.essentials.utilities.StringUtilities.replaceMapServicetokens(a,b.layer.mapService));if(!e&&(f={},b.parseDataLinkId(a,f)&&b.dataLinkingResults.get()))for(l=0;l<b.dataLinkingResults.length();l++){var n=b.dataLinkingResults.getAt(l);if(n.dataLink.get()&&n.dataLink.get().id===f.dataLinkId){if("_rowcount"===f.attributeName.toLowerCase())e=
n.table?n.table.get().rows.length:0;else if(n.table.get())for(l=n.table.get(),n=0;n<l.columns.length;n++)if(l.columns[n].toLowerCase()===f.attributeName.toLowerCase()){0<l.rows.length&&(e=l.rows[0].row[n]);break}break}}e||"RestToken"!==a||(e=d.essentials.RestHelperHTTPService.token);b._allowUnsafeContent?null==e&&(e=""):e=e||0===e?String.escapeHtmlEncode(e.toString()):"";if(null===e||void 0===e)e="";return e}):""};g.prototype.parseDataLinkId=function(c,b){var a=c.indexOf(".");if(0>a)return!1;b.dataLinkId=
c.substring(0,a);b.attributeName=c.substring(a+1);return!0};g.prototype._getLayerUniqueId=function(){var c="";this.layer&&(c=this.layer.id,this.layer.mapService&&(c=this.layer.mapService.id+"/"+c));return c};g.prototype._setupLinkedAttributes=function(){var c=new d.essentialsHtmlViewer.mapping.infrastructure.AttributeGroup;c.owner=this._graphic;c.attributes=this._graphic.attributes;this.linkedAttributes.clear();this.linkedAttributes.addItem(c)};g.prototype._refreshPresentableValues=function(){this.attributes.get().forEach(function(c){c.presentableValue.clear();
c.presentableValue.pulse()});this.label.clear();this.plainLabel.clear();this.description.clear();this.longDescription.clear();this.label.pulse();this.plainLabel.pulse();this.description.pulse();this.longDescription.pulse()};return g}();h.Feature=g})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){d.isKmlProperty="__isKml";var g=function(g){function c(b){g.call(this,b);var a=(b=this.esriFeature.get())?b.attributes||{}:{};this.labelFormat.set(a.hasOwnProperty("name")?"{name}":"{id}");this.descriptionFormat.set("{snippet}");this.longDescriptionFormat.set(a.hasOwnProperty("balloonStyleText")?"{balloonStyleText}":"{description}");b&&!b[d.isKmlProperty]&&(b[d.isKmlProperty]=!0)}__extends(c,g);return c}(d.Feature);d.KmlFeature=g})(d.infrastructure||
(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(c){c[c.Unresolved=0]="Unresolved";c[c.Resolving=1]="Resolving";c[c.Resolved=2]="Resolved"})(h.DataLinksState||(h.DataLinksState={}));var g=h.DataLinksState,m=function(){function c(b){var a=this;this.id="";this.featureLayer=null;this.displayName=new d.framework.ui.LazyObservable;this.features=new ObservableCollection;this.attributes=new ObservableCollection;this.iconUri=new d.framework.ui.LazyObservable;this.extendedProperties=new ObservableCollection;
this.isSelectedInCollection=new Observable(!1);this.dataLinksResolved=new Observable(!1);this.defaultNumberFormat=h.NumberFormat.DEFAULT;this.defaultDateFormat=h.DateFormat.DEFAULT;this._objectIds=new h.Dictionary;this._watchHandles={};this._dataLinksState=g.Unresolved;var e=null,f=null;b=b||{};b.hasOwnProperty("esriFeatureSet")&&(e=b.esriFeatureSet);b.hasOwnProperty("featureLayer")&&(this.featureLayer=b.featureLayer);b.hasOwnProperty("layer")&&(f=b.layer);b.hasOwnProperty("allowUnsafeContent")?this._allowUnsafeContent=
b.allowUnsafeContent:this._allowUnsafeContent=!1;b.hasOwnProperty("app")&&(this.app=b.app);this.defaultDateFormat=b.defaultDateFormat||h.DateFormat.DEFAULT;this.defaultNumberFormat=b.defaultNumberFormat||h.NumberFormat.DEFAULT;this.uniqueId="fs_"+d.framework.utils.alphaNumericToken();this.esriFeatureSet=e;f&&(this.layer=f)&&this.layer.mapService&&(this.id="{0}/{1}".format(this.layer.mapService.id,this.layer.id));this.displayName.delegateGetter=function(){return a.layer&&a.layer.displayName?a.layer.displayName:
""};this.iconUri.delegateGetter=function(){return a.layer&&a.layer.iconUri?a.layer.iconUri:""};this.loadFeatures();this.loadAttributes()}Object.defineProperty(c.prototype,"dataLinksState",{get:function(){return this._dataLinksState},enumerable:!0,configurable:!0});c.prototype.setDataLinksState=function(b){this._dataLinksState=b;this.dataLinksResolved.set(b===g.Resolved)};c.prototype.getExtendedPropertyByName=function(b){for(var a=0;a<this.extendedProperties.getLength();a++){var e=this.extendedProperties.getAt(a);
if(e&&e.name==b)return e.value}return null};c.prototype.setExtendedProperty=function(b,a){for(var e=0;e<this.extendedProperties.getLength();e++){var f=this.extendedProperties.getAt(e);if(f&&f.name==b){f.value=a;return}}this.extendedProperties.addItem({name:b,value:a})};c.prototype.addFeature=function(b,a){var e=new d.framework.events.CollectionChangedArgs,f=this.features.length();e.type="append";e.rangeStart=f;e.rangeEnd=f;e.sender=this.features;return this._addFeatureWithoutNotification(b,a)?(this.features.bindingEvent.publish(e),
!0):!1};c.prototype._addFeatureWithoutNotification=function(b,a){if(!b)throw Error("Feature cannot be null.");var e=this.features.getItems();return a||!this.containsFeature(b)?(b.featureSet=this,e.push(b),this.esriFeatureSet&&this.esriFeatureSet.features&&this.esriFeatureSet.features.push(b.esriFeature.get()),!0):!1};c.prototype.removeFeature=function(b){if(!b)throw Error("Feature cannot be null.");var a=b.id.get();if(!String.isNullOrEmpty(a)&&!this._objectIds.containsKey(a))return!1;a=new d.framework.events.CollectionChangedArgs;
a.type="remove";for(var e=this.features.length();e--;){var f=this.features.getAt(e);if(f&&f.structurallyEquals(b))return a.rangeStart=e,a.rangeEnd=e,a.sender=this.features,this.features.bindingEvent.publish(a),this._removeWithoutNotificationAt(e),!0}return!1};c.prototype._removeWithoutNotificationAt=function(b){var a=this.features.getItems();if(0<=b&&b<a.length){var e=a[b],f=e.esriFeature.get();f&&this.esriFeatureSet&&this.esriFeatureSet.features&&d.framework.utils.ArrayUtils.removeItem(this.esriFeatureSet.features,
f);e.featureSet=null;d.framework.utils.ArrayUtils.remove(a,b,b);return!0}return!1};c.prototype.containsFeature=function(b){if(!b)throw Error("Feature cannot be null.");var a=b.id.get();if(a&&this._objectIds.containsKey(a))return!0;for(a=0;a<this.features.length();a++)if(this.features.getAt(a).structurallyEquals(b))return!0;return!1};c.prototype.clearFeatures=function(){if(0!=this.features.length()){var b=new d.framework.events.CollectionChangedArgs;b.type="clear";b.rangeStart=0;b.rangeEnd=this.features.length()-
1;b.sender=this.features;for(this.features.bindingEvent.publish(b);0<this.features.length();)this._removeWithoutNotificationAt(0)}};c.prototype.loadGeometries=function(b,a,e){var f=this,l=new dojo.Deferred;if(!this.layer){var n=Error("loadGeometries: Layer must be present.");d.deferredReject(l,n);"function"==typeof e&&e(n);return l}if(!this.layer.primaryKeyField)return n=Error("loadGeometries: Layer must have a PrimaryKeyField to load geometries."),d.deferredReject(l,n),"function"==typeof e&&e(n),
l;var c=this.layer.primaryKeyField.name;b||(b=this.features.getItems());var p=[];if(b)for(n=0;n<b.length;n++){var g=b[n];if(!g.hasGeometry.get()){var m=g.esriFeature.get();m&&m.attributes[c]&&p.push(g)}}if(0<p.length){b=[];for(n=0;n<p.length;n++)b.push(p[n].esriFeature.get().attributes[c]);n=h.taskUtils.getQueryTask(this.layer);g=new esri.tasks.Query;g.objectIds=b;g.returnGeometry=!0;g.outFields=[c];this.layer&&this.layer.mapService&&this.layer.mapService.essentialsMap&&this.layer.mapService.essentialsMap.site&&
this.layer.mapService.essentialsMap.site.getMap()&&(g.outSpatialReference=this.layer.mapService.essentialsMap.site.getMap().spatialReference);n.execute(g).then(function(b){if(b&&b.features&&0<b.features.length)for(var e=0;e<b.features.length;e++){var n=b.features[e],g=f._findFeature(n.attributes[c],c,p);g&&(g.esriFeature.get().geometry=n.geometry)}d.deferredResolve(l,void 0);"function"==typeof a&&a()},function(a){a=Error("loadGeometries: Query error: "+a.message);d.deferredReject(l,a);"function"==
typeof e&&e(a)})}else d.deferredResolve(l,void 0),"function"==typeof a&&a();return l};c.prototype.findFeatureById=function(b){return this._objectIds.get(b)};c.prototype.findFeatureByEsriFeature=function(b){var a=null,e=b.getLayer();if(e&&this.layer&&this.layer.mapService&&this.layer.mapService.serviceLayer!==e)return null;for(e=0;e<this.features.length();e++){var f=this.features.getAt(e);if(f.esriFeature&&(f.esriFeature.get()===b||h.MapUtils.esriFeaturesEqual(f.esriFeature.get(),b))){a=f;break}}return a};
c.prototype._findFeature=function(b,a,e){var f=null,l,n;if(e&&0<e.length)for(l=0;l<e.length;l++)if((n=e[l].esriFeature.get())&&n.attributes&&n.attributes[a]==b){f=e[l];break}return f};c.prototype.loadFeatures=function(){this._watchFeatureSetChanges();this.features.clear();var b=[],a;if(this.esriFeatureSet&&this.esriFeatureSet.features)for(var e=0;e<this.esriFeatureSet.features.length;++e){a=this.esriFeatureSet.features[e];var f={graphic:a,layer:this.layer,featureLayer:this.featureLayer,resolveLayerFields:!0,
allowUnsafeContent:this._allowUnsafeContent};a=a&&a[h.isKmlProperty]?new h.KmlFeature(f):new h.Feature(f);a.featureSet=this;a.defaultDateFormat=this.defaultDateFormat;a.defaultNumberFormat=this.defaultNumberFormat;b.push(a)}this.features.useThrottling=!1;this.features.addItems(b)};c.prototype.loadAttributes=function(){this.attributes.clear();var b=[],a=[];if(this.layer&&this.layer.fields){for(var e=0;e<this.layer.fields.length;e++){var f=this.layer.fields[e];d.essentialsHtmlViewer.mapping.infrastructure.FeatureAttribute.ignoreAttribute(f.name)?
a.push(f):b.push(new h.FeatureAttribute("",f.name,f.alias,f.displayName,f.visible,h.PresentableDelegateFactory.valuePresenterDelegate(f,null)))}for(e=0;e<a.length;e++){var l=a[e];l.visible&&(f=b.filter(function(a){return a.name.get()===l.name.substr(0,l.name.length-7)}),f=1===f.length?f[0]:null)&&(f.visible.get()||f.visible.set(!0),f.alias.set(l.alias),f.displayName.set(l.displayName))}}else if(this.features&&0<this.features.getLength())for(a=this.features.getAt(0),e=0;e<a.attributes.getLength();e++)f=
a.attributes.getAt(e),b.push(new h.FeatureAttribute("",f.name.get(),f.alias.get(),f.displayName.get()));else if(this.esriFeatureSet&&this.esriFeatureSet.features&&0<this.esriFeatureSet.features.length)for(e in a=this.esriFeatureSet.features[0],a.attributes)a.attributes.hasOwnProperty(e)&&b.push(new h.FeatureAttribute("",e,e,e));this.attributes.addItems(b)};c.prototype.featureSetChanged=function(b){if("append"==b.type||"insert"==b.type)for(var a=b.rangeStart;a<=b.rangeEnd;a++){var e=this.features.getAt(a);
e.featureSet=this;var f=e.id.get();f&&this._objectIds.set(f,e)}if("remove"==b.type||"clear"==b.type)for(a=b.rangeStart;a<=b.rangeEnd;a++)this.features.getAt(a).featureSet=null,(f=this.features.getAt(a).id.get())&&this._objectIds.remove(f)};c.prototype._applyDataLinks=function(b,a,e,f,l){for(var n=0;n<b.features.length();n++){var c=b.features.getAt(n);if(0<c.linkedAttributes.length()){var p=c.linkedAttributes.getAt(0);c.linkedAttributes.clear();c.linkedAttributes.addItem(p);c.dataLinkingResults.clear()}}for(b=
0;b<e.length;b++)for(var n=f[b],p=e[b],g=0;g<n.length;g++){var c=n[g],h=new d.essentialsHtmlViewer.mapping.infrastructure.DataLinkingResult;h.table.set(c.linkedData);h.dataLink.set(p);c=a[c.index];c.dataLinkingResults.addItem(h);l&&l(c);p.isOneToOne&&c.linkedAttributes.addItem(h.asAttributeGroup())}};c.prototype.resolveDataLinks=function(b,a,e,f,l){var n=this,c=this;if(this.dataLinksState===g.Resolving)l&&l(this,Error("Currently performing data linking"),e);else if("undefined"===typeof a&&(a=!0),
c.layer&&c.layer.hasDataLinks&&0<c.features.length()){c.setDataLinksState(g.Resolving);var d=this.features.get().slice(),m=[],m=a?dojo.filter(c.layer.dataLinks,function(a){return a.visible}):c.layer.dataLinks,m=dojo.filter(m,function(a){return!!(a&&a.parameters&&a.parameters.length)}),t=[],k=0,q=0,x=!1;for(a=0;a<m.length&&!x;a++){var u=function(a){return function(l){if(!x&&(t[a]=l,k++,k>=m.length)){n._applyDataLinks(c,d,m,t,b);c.setDataLinksState(g.Resolved);if("undefined"!==typeof n.app)for(l=0;l<
m.length;l++)n.app.event("DatalinkResolutionCompletedEvent").publish(m[l].id,c);f&&f(c,e)}}},z=u(a),B=function(a){return function(b){q++;q>=m.length?(console.error("There was an error in resolving {0} datalink. Message : {1}".format(m[a].displayName,b.message)),x=!0,c.setDataLinksState(g.Unresolved),l&&l(c,b,e)):(console.error("There was an error in resolving {0} datalink. Message : {1}".format(m[a].displayName,b.message)),u(a)(new h.DataLinkingResult))}}(a);"undefined"!==typeof this.app&&this.app.event("DatalinkResolutionStartedEvent").publish(m[a].id,
c);m[a].performDataLinking(c.esriFeatureSet,z,B)}}else c.setDataLinksState(g.Resolved),f&&f(c,e)};c.prototype.doWhenDataLinkingCompleted=function(b){var a=this;if("function"===typeof b)if(this.dataLinksResolved.get())b(this);else var e=this.dataLinksResolved.bind(this,function(f){f&&(a.dataLinksResolved.unbind(e),b(a))})};c.prototype.append=function(b){for(var a={},e=0;e<this.features.length();e++){var f=this.features.getAt(e),l;this.layer&&this.layer.primaryKeyField&&(l=this.layer.primaryKeyField.name);
if(l){var n=f.esriFeature.get().attributes[l];a[n]=f}}for(e=0;e<b.features.length();e++)f=b.features.getAt(e),b.layer&&b.layer.primaryKeyField&&(l=b.layer.primaryKeyField.name),l?(n=f.esriFeature.get().attributes[l],a[n]||this.features.addItem(f)):this.features.addItem(f)};c.prototype.union=function(b){for(var a=this.clone(),e=b&&b.features?b.features.length():0,f=0;f<e;f++)a.containsFeature(b.features.getAt(f))||a.addFeature(b.features.getAt(f),!0);return a};c.prototype.unionInPlace=function(b){if(!b||
!b.features||0===b.features.length())return!1;var a=new d.framework.events.CollectionChangedArgs;a.type="append";a.rangeStart=this.features.length();for(var e=!1,f=0,l=0;l<b.features.length();l++){var n=b.features.getAt(l);!this.containsFeature(n)&&this._addFeatureWithoutNotification(n,!0)&&(e=!0,f++)}e&&(a.rangeEnd=a.rangeStart+f-1,a.sender=this.features,this.features.bindingEvent.publish(a));return e};c.prototype.subtract=function(b){for(var a=this.cloneStructure(),e=0;null!=b&&e<this.features.length();e++)b.containsFeature(this.features.getAt(e))||
a.addFeature(this.features.getAt(e));return a};c.prototype.subtractInPlace=function(b){if(!b||!b.features||0===b.features.length())return!1;for(var a=!1,e=this.features.length();e--;){var f=this.features.getAt(e);b.containsFeature(f)&&(this._removeWithoutNotificationAt(e),a=!0)}a&&this.features.pulse();return a};c.prototype.intersect=function(b){for(var a=this.cloneStructure(),e=0;null!=b&&e<this.features.length();e++)b.containsFeature(this.features.getAt(e))&&a.addFeature(this.features.getAt(e));
return a};c.prototype.intersectInPlace=function(b){if(!b||!b.features)return!1;for(var a=!1,e=this.features.length();e--;){var f=this.features.getAt(e);b.containsFeature(f)||(this._removeWithoutNotificationAt(e),a=!0)}a&&this.features.pulse();return a};c.prototype.clone=function(){for(var b=this.cloneStructure(),a=0;a<this.features.length();a++)b.addFeature(this.features.getAt(a),!0);return b};c.prototype.cloneStructure=function(){var b=new c({app:this.app,layer:this.layer,featureLayer:this.featureLayer,
allowUnsafeContent:this._allowUnsafeContent,defaultDateFormat:this.defaultDateFormat,defaultNumberFormat:this.defaultNumberFormat});b.id=this.id;b.isSelectedInCollection.set(this.isSelectedInCollection.get());b.setDataLinksState(this.dataLinksState);b.displayName.set(this.displayName.get());b.iconUri.set(this.iconUri.get());b.attributes.set(this.attributes.get());b.extendedProperties.set(this.extendedProperties.get());b.esriFeatureSet=this._cloneEsriStructure(this.esriFeatureSet);return b};c.prototype._cloneEsriStructure=
function(b){if(!b)return null;var a=new esri.tasks.FeatureSet;a.displayFieldName=b.displayFieldName;a.exceededTransferLimit=b.exceededTransferLimit;a.fieldAliases=b.fieldAliases;a.geometryType=b.geometryType;a.spatialReference=b.spatialReference;b.fields&&(a.fields=b.fields);return a};c.prototype._watchFeatureSetChanges=function(){var b=this;this._unwatchFeatureSetChanges();var a=this.features.bind(this,this.featureSetChanged),e={remove:function(){return b.features.unbind(a)}};return this._watchHandles.features=
e};c.prototype._unwatchFeatureSetChanges=function(){var b=this._watchHandles.features;b&&b.remove();this._watchHandles.features=null};return c}();h.FeatureSet=m})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){var g=function(){function g(){this.displayName=new Observable("");this.isModified=new Observable(!1);this.featureSets=new ObservableCollection;this.extendedProperties=new ObservableCollection;this.id="FSC-{0}".format(d.framework.utils.alphaNumericToken());this.featureSets.useThrottling=!1}g.prototype.getExtendedPropertyByName=function(c){for(var b=0;b<this.extendedProperties.getLength();b++){var a=this.extendedProperties.getAt(b);if(a&&a.name==c)return a.value}return null};
g.prototype.setExtendedProperty=function(c,b){for(var a=0;a<this.extendedProperties.getLength();a++){var e=this.extendedProperties.getAt(a);if(e&&e.name==c){e.value=b;return}}this.extendedProperties.addItem({name:c,value:b})};g.prototype.getFeatureSetById=function(c){for(var b=0;b<this.featureSets.getLength();++b){var a=this.featureSets.getAt(b);if(a.id==c)return a}return null};g.prototype.getFeatureSetByLayer=function(c){if(!c)return null;for(var b=0;b<this.featureSets.getLength();++b){var a=this.featureSets.getAt(b),
e=a.layer,f=c===e||c&&e&&c.mapService===e.mapService||c&&e&&c.mapService&&e.mapService&&c.mapService.id==e.mapService.id;if((c===e||c&&e&&c.id==e.id)&&f)return a}return null};g.prototype.findFeatureByEsriFeature=function(c){for(var b=0;b<this.featureSets.getLength();b++){var a=this.featureSets.getAt(b).findFeatureByEsriFeature(c);if(a)return a}return null};g.prototype.firstFeature=function(){for(var c=0;c<this.featureSets.getLength();c++){var b=this.featureSets.getAt(c);if(0<b.features.getLength())return b.features.getAt(0)}return null};
g.prototype.countFeatures=function(){for(var c=0,b=0;b<this.featureSets.length();b++)c+=this.featureSets.getAt(b).features.length();return c};g.prototype.clear=function(){for(var c=0;c<this.featureSets.getLength();c++)this.featureSets.getAt(c).features.clear();this.featureSets.clear()};g.prototype.clone=function(c){void 0===c&&(c=!1);for(var b=this.cloneStructure(),a=0;a<this.featureSets.length();a++){var e=c?this.featureSets.getAt(a).clone():this.featureSets.getAt(a);b.featureSets.addItem(e)}return b};
g.prototype.cloneStructure=function(){var c=new h.FeatureSetCollection;c.sourceName=this.sourceName;c.displayName.set(this.displayName.get());c.isModified.set(this.isModified.get());c.tag=this.tag;this.extendedProperties.getItems().forEach(function(b){return c.setExtendedProperty(b.name,b.value)});return c};g.prototype.unionInPlace=function(c){if(!c||0===c.featureSets.length())return!1;for(var b=this._buildFeatureSetLookup(),a=this._buildLayerLookup(),e=!1,f=0;f<c.featureSets.length();f++){var l=
c.featureSets.getAt(f),n=l.id,d=l.layer,p=null;n&&b.containsKey(n)&&(p=b.get(n));!p&&d&&d.mapService&&(n=this._generateLayerKey(d.mapService.id,d.id),p=a.get(n));p?p.unionInPlace(l)&&(e=!0):(this.featureSets.addItem(l),e=!0)}return e};g.prototype.unionManyInPlace=function(c){if(!c||0==c.length)return!1;for(var b=!1,a=0;a<c.length;a++)this.unionInPlace(c[a])&&(b=!0);return b};g.prototype.subtractInPlace=function(c){if(!c||0===c.featureSets.length())return!1;var b=c._buildFeatureSetLookup();c=c._buildLayerLookup();
for(var a=!1,e=this.featureSets.length();e--;){var f=this.featureSets.getAt(e),l=f.id,n=f.layer,d=null;l&&b.containsKey(l)&&(d=b.get(l));!d&&n&&n.mapService&&(l=this._generateLayerKey(n.mapService.id,n.id),d=c.get(l));d&&(f.subtractInPlace(d)&&(a=!0),0==f.features.length()&&(this.featureSets.removeAt(e),a=!0))}return a};g.prototype.subtractManyInPlace=function(c){if(!c||0==c.length)return!1;for(var b=!1,a=0;a<c.length;a++)this.subtractInPlace(c[a])&&(b=!0);return b};g.prototype.intersectInPlace=function(c){if(!c)return!1;
var b=c._buildFeatureSetLookup();c=c._buildLayerLookup();for(var a=!1,e=this.featureSets.length();e--;){var f=this.featureSets.getAt(e),l=f.id,n=f.layer,d=null;l&&b.containsKey(l)&&(d=b.get(l));!d&&n&&n.mapService&&(l=this._generateLayerKey(n.mapService.id,n.id),d=c.get(l));d?(f.intersectInPlace(d)&&(a=!0),0==f.features.length()&&(this.featureSets.removeAt(e),a=!0)):(this.featureSets.removeAt(e),a=!0)}return a};g.prototype.intersectManyInPlace=function(c){if(!c||0==c.length)return!1;for(var b=!1,
a=0;a<c.length;a++)this.intersectInPlace(c[a])&&(b=!0);return b};g.prototype._generateLayerKey=function(c,b){return"{0}/{1}".format(c,b)};g.prototype._buildLayerLookup=function(){for(var c=new h.Dictionary,b=0;b<this.featureSets.length();b++){var a=this.featureSets.getAt(b);if(a&&a.layer&&a.layer.mapService){var e=this._generateLayerKey(a.layer.mapService.id,a.layer.id);c.containsKey(e)||c.set(e,a)}}return c};g.prototype._buildFeatureSetLookup=function(){for(var c=new h.Dictionary,b=0;b<this.featureSets.length();b++){var a=
this.featureSets.getAt(b);a&&a.id&&!c.containsKey(a.id)&&c.set(a.id,a)}return c};return g}();h.FeatureSetCollection=g})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(){return function(c){dojo.safeMixin(this,c)}}();d.FeatureSetManagerEventArgs=h})(d.eventArgs||(d.eventArgs={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));geocortex.essentialsHtmlViewer.mapping.infrastructure.FeatureSetManagerEventArgs=geocortex.essentialsHtmlViewer.mapping.infrastructure.eventArgs.FeatureSetManagerEventArgs;
(function(d){(function(k){(function(k){(function(h){var g=function(){function g(c){this.featureSetCollections=new ObservableCollection;this._featureSetCollectionsMap={};this._collectionChangedEventMap={};this._collectionOpenCount={};this._searchSuggestions={};this.app=c;this._registerCommands()}g.prototype._registerCommands=function(){this.app.command("OpenFeatureSetCollection").register(this,this.openCollection);this.app.command("CloseFeatureSetCollection").register(this,this.closeCollection);this.app.command("RemoveCollection").register(this,
this.removeCollection);this.app.command("RemoveFeatureSetCollection").register(this,this.removeCollection);this.app.command("RemoveCollectionById").register(this,this.removeCollectionById);this.app.command("RemoveFeatureSetCollectionById").register(this,this.removeCollectionById)};g.prototype.openCollection=function(c){if(!this._featureSetCollectionsMap.hasOwnProperty(c))return this.app.trace.warning("Cannot open feature set collection '{0}': No feature set collection with matching ID found.".format(c)),
null;this._collectionOpenCount.hasOwnProperty(c)||(this._collectionOpenCount[c]=0);++this._collectionOpenCount[c];if(1==this._collectionOpenCount[c]){var b=new d.essentialsHtmlViewer.mapping.infrastructure.eventArgs.FeatureSetManagerEventArgs({sender:this,featureSetCollection:this._featureSetCollectionsMap[c],featureSetCollectionId:c});this.app.event("FSMCollectionOpenedEvent").publish(b)}return this._featureSetCollectionsMap[c]};g.prototype.closeCollection=function(c){if(!this._featureSetCollectionsMap.hasOwnProperty(c))return this.app.trace.warning("Cannot close feature set collection '{0}': No feature set collection with matching ID found.".format(c)),
!1;if(!this._collectionOpenCount.hasOwnProperty(c)||0==this._collectionOpenCount[c])return this.app.trace.warning("Attempted to close an already-closed FeatureSetCollection."),!1;--this._collectionOpenCount[c];0==this._collectionOpenCount[c]&&(c=new d.essentialsHtmlViewer.mapping.infrastructure.eventArgs.FeatureSetManagerEventArgs({sender:this,featureSetCollection:this._featureSetCollectionsMap[c],featureSetCollectionId:c}),this.app.event("FSMCollectionClosedEvent").publish(c));return!0};g.prototype.tryCloseCollection=
function(c){return this._featureSetCollectionsMap.hasOwnProperty(c)?this.isCollectionOpen(c)?this.closeCollection(c):!0:!1};g.prototype.isCollectionOpen=function(c){return this._featureSetCollectionsMap.hasOwnProperty(c)?this._collectionOpenCount.hasOwnProperty(c)&&0<this._collectionOpenCount[c]:(this.app.trace.warning("Cannot check open state of feature set collection '{0}': No feature set collection with matching ID found.".format(c)),!1)};g.prototype.addCollection=function(c){return this._addCollectionImpl(c)};
g.prototype._addCollectionImpl=function(c){if(!c)throw Error("FeatureSetManager.addCollection: Parameter 'fsc' required.");var b=this._featureSetCollectionsMap[c.id];if(c===b)return!0;if(b)return this.app.trace.warning("Cannot add feature set collection '{0}': A feature set collection with that ID already exists.".format(c.id)),!1;this._featureSetCollectionsMap[c.id]=c;this.featureSetCollections.addItem(c);b=c.featureSets.bind(this,dojo.hitch(this,function(a){this.handleCollectionChanged(c,a)}));
this._collectionChangedEventMap[c.id]=b;b=new d.essentialsHtmlViewer.mapping.infrastructure.eventArgs.FeatureSetManagerEventArgs({sender:this,featureSetCollection:this._featureSetCollectionsMap[c.id],featureSetCollectionId:c.id});this.app.event("FSMCollectionAddedEvent").publish(b);return!0};g.prototype.handleCollectionChanged=function(c,b){var a=new d.essentialsHtmlViewer.mapping.infrastructure.eventArgs.FeatureSetManagerEventArgs({sender:this,featureSetCollection:c,featureSetCollectionId:c.id,collectionChangedEventArgs:b});
this.app.event("FSMCollectionChangedEvent").publish(a)};g.prototype.removeCollection=function(c){return this.canRemoveCollection(c)?this.removeCollectionById(c.id):!1};g.prototype.removeCollectionById=function(c){if(!this._featureSetCollectionsMap.hasOwnProperty(c))return this.app.trace.warning("Cannot remove feature set collection '{0}': Collection not found.".format(c)),!1;this.isCollectionOpen(c)&&this.closeCollection(c);this._featureSetCollectionsMap[c].featureSets.unbind(this._collectionChangedEventMap[c]);
this.featureSetCollections.removeItem(this._featureSetCollectionsMap[c]);delete this._collectionOpenCount[c];var b=new d.essentialsHtmlViewer.mapping.infrastructure.eventArgs.FeatureSetManagerEventArgs({sender:this,featureSetCollection:this._featureSetCollectionsMap[c],featureSetCollectionId:c});this.app.event("FSMCollectionRemovedEvent").publish(b);delete this._featureSetCollectionsMap[c];return!0};g.prototype.canRemoveCollection=function(c){return null!=c&&null!=this.getCollectionById(c.id)};g.prototype.getCollectionById=
function(c){return this._featureSetCollectionsMap[c]};g.prototype.getCollectionIds=function(){var c=[],b;for(b in this._featureSetCollectionsMap)this._featureSetCollectionsMap.hasOwnProperty(b)&&c.push(b);return c};g.prototype.findFeaturesByEsriFeature=function(c){var b=[];this.featureSetCollections.get().forEach(function(a){(a=a.findFeatureByEsriFeature(c))&&b.push(a)});return b};g.prototype.addSearchSuggestions=function(c){for(var b in c)c.hasOwnProperty(b)&&(this._searchSuggestions.hasOwnProperty(b)?
this.app.trace.warning("Cannot add search suggestion '{0}': A search suggestion for that feature set type already exists.".format(c[b])):c[b]&&(this._searchSuggestions[b]=c[b]))};g.prototype.getSearchSuggestion=function(c){return this._searchSuggestions[c]};return g}();h.FeatureSetManager=g})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(g){g.getColorFromList=function(d){d&&4===d.length&&1<d[3]&&(d[3]/=255);return new dojo.Color(d)};g.getColorFromString=function(d){if("string"===typeof d&&d.startsWith("#")&&9===d.length){var c=parseInt(d.slice(1,3),16),b=parseInt(d.slice(3,5),16),a=parseInt(d.slice(5,7),16);d=parseInt(d.slice(7,9),16);return new esri.Color([b,a,d,c/255])}return new esri.Color(d)};g.getStringFromList=function(d){if(d){if(4===d.length)return 1<d[3]&&(d[3]/=
255),"rgba({0}, {1}, {2}, {3})".format(d[0],d[1],d[2],d[3]);if(3===d.length)return"rgb({0}, {1}, {2})".format(d[0],d[1],d[2])}};g.getStringFromHex=function(d){if("string"===typeof d&&d.startsWith("#")){if(9===d.length){var c=parseInt(d.slice(1,3),16),b=parseInt(d.slice(3,5),16),a=parseInt(d.slice(5,7),16);d=parseInt(d.slice(7,9),16);return"rgba({0}, {1}, {2}, {3})".format(b,a,d,c/255)}if(7===d.length)return b=parseInt(d.slice(1,3),16),a=parseInt(d.slice(3,5),16),d=parseInt(d.slice(5,7),16),"rgb({0}, {1}, {2})".format(b,
a,d)}};g.generateRandomColors=function(g){void 0===g&&(g=6);for(var c=[],b=Math.random(),a=0;a<g;a++){var e=b+1/g*a,e=e-Math.floor(e),e=new d.visualization.SymbolColor({h:e,s:0.8,v:1});0===a%3&&(e=e.darken(Math.random()/1.8));1===a%3&&(e=e.lighten(Math.random()/1.1));c.push(e)}return c.sort(function(a){return 0.5-Math.random()})};g.generateRandomColor=function(){var g=Math.random();return new d.visualization.SymbolColor({h:g,s:0.8,v:1})};g.isColorInputSupported=function(){if(-1<window.navigator.userAgent.indexOf("GeocortexApp.Windows"))return!1;
var d=document.createElement("input");d.setAttribute("type","color");return"text"!==d.type}})(d.ColorUtils||(d.ColorUtils={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){var g=function(){function g(){this.fillColor=new esri.Color([236,236,0,0.22745]);this.borderColor=new esri.Color([204,204,51,1]);this.borderWidth=2;this.defaultSymbol=null;this._pictureMarkerSymbolCache={}}g.prototype.clone=function(){var c=new d.essentialsHtmlViewer.mapping.infrastructure.SimpleRenderer;c.fillColor=this.fillColor;c.borderColor=this.borderColor;c.borderWidth=this.borderWidth;return c};g.prototype.getSymbol=function(c){return c&&
c.geometry?c.geometry instanceof esri.geometry.Point||c.geometry instanceof esri.geometry.Multipoint?new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,10,null,this.borderColor):c.geometry instanceof esri.geometry.Polygon?new esri.symbol.SimpleFillSymbol(esri.symbol.SimpleFillSymbol.STYLE_SOLID,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,this.borderColor,this.borderWidth),this.fillColor):c.geometry instanceof esri.geometry.Polyline?new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,
this.borderColor,this.borderWidth):null:null};g.prototype.getSymbolWithHacks=function(c,b){if(b&&b.renderer&&c&&c.geometry&&(c.geometry instanceof esri.geometry.Point||c.geometry instanceof esri.geometry.Multipoint)){var a=b.renderer.getSymbol(c);if(a instanceof esri.symbol.SimpleMarkerSymbol)return new esri.symbol.SimpleMarkerSymbol(a.style,a.size+2,null,this.fillColor);if(a instanceof esri.symbol.PictureMarkerSymbol)return this._getPictureMarkerSymbolHighlight(a);if(a instanceof esri.symbol.MarkerSymbol)return new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,
a.size,null,this.fillColor)}return this.getSymbol(c)};g.prototype._getPictureMarkerSymbolHighlight=function(c){if(this._pictureMarkerSymbolCache.hasOwnProperty(c.url))return this._pictureMarkerSymbolCache[c.url];if(Modernizr&&Modernizr.canvas)try{var b=document.createElement("canvas");b.width=c.width;b.height=c.height;var a=b.getContext("2d");a.fillStyle=this.fillColor.toCss(Modernizr.rgba);a.fillRect(0,0,b.width,b.height);a.globalCompositeOperation="destination-atop";var e=new Image;e.src=c.url;
a.drawImage(e,0,0);return this._pictureMarkerSymbolCache[c.url]=new esri.symbol.PictureMarkerSymbol(b.toDataURL("image/png"),b.width,b.height)}catch(f){}return this._pictureMarkerSymbolCache[c.url]=new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,Math.min(c.width,c.height),null,this.fillColor)};g.prototype.toJson=function(){return{fillColor:this.fillColor,borderColor:this.borderColor,borderWidth:this.borderWidth}};return g}();h.SimpleRenderer=g})(k.infrastructure||(k.infrastructure=
{}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){var g=function(){function g(c){this._activeHighlightLayerName=null;this._highlightLayers={};this._managedGraphics={};this._nextHighlightId=0;this._defaultRenderer=new h.SimpleRenderer;this._defaultHighlightLayerName=null;this.app=c}g.prototype.createHighlightLayer=function(c,b,a){if(!c)throw Error("Unable to create new highlight layer with null or empty name");if(this._highlightLayers.hasOwnProperty(c))return this.app.trace.warning("Cannot create highlight layer because layer with name '{0}' already exists.".format(c)),
null;var e=new esri.layers.GraphicsLayer;if(null!==b&&void 0!==b||null!==a&&void 0!==a)e.renderer=this._defaultRenderer.clone(),null!==b&&void 0!==b&&(e.renderer.fillColor="string"==typeof b?h.ColorUtils.getColorFromString(b):h.ColorUtils.getColorFromList(b)),null!==a&&void 0!==a&&(e.renderer.borderColor="string"==typeof a?h.ColorUtils.getColorFromString(a):h.ColorUtils.getColorFromList(a));this._highlightLayers[c]=e;this._addLayerToMap(e);this._activeHighlightLayerName&&""!==this._activeHighlightLayerName||
(this._activeHighlightLayerName=c);this.app.event("HighlightLayerCreated").publish(c);return e};g.prototype.setActiveHighlightLayer=function(c){if(!c)throw Error("Unable to set the active highlight layer because no layer name was given.");if(!this._highlightLayers.hasOwnProperty(c))throw Error("Unable to set {0} as the active highlight layer, because a highlight layer with that name does not exist".format(c));this._activeHighlightLayerName=c};g.prototype.highlightEsriFeatureSet=function(c,b){if(c)if(c.features&&
0!=c.features.length){var a=this.getHighlightLayerOrActive(b);a&&a.graphics||this.app.trace.warning("Unable to highlight feature because the required layer was not found, or could not accept graphics");for(var e=0;e<c.features.length;e++)this._drawGraphic(c.features[e],a)}else this.app.trace.warning("No features detected in FeatureSet; as such, no features were highlighted");else this.app.trace.warning("No FeatureSet was provided; as such, no features were highlighted")};g.prototype.highlightFeatures=
function(c,b){if(c){var a=this.getHighlightLayerOrActive(b);a||this.app.trace.warning("Unable to highlight feature because the required layer was not found, or could not accept graphics");for(var e=this._defaultRenderer.borderColor,f=this._defaultRenderer.fillColor,l=this._defaultRenderer.borderWidth,n=0;n<c.length;n++){var d=c[n];try{var p;d.borderColor&&d.borderColor.get()&&(p=h.ColorUtils.getColorFromList(d.borderColor.get()))&&this._setBorderColor(p);d.fillColor&&d.fillColor.get()&&(p=h.ColorUtils.getColorFromList(d.fillColor.get()))&&
this._setFillColor(p);if(d.borderWidth&&d.borderWidth.get()){var g=d.borderWidth.get();0<=g&&this._setBorderWidth(g)}this._drawGraphic(d.esriFeature.get(),a)}finally{this._setBorderColor(e),this._setFillColor(f),this._setBorderWidth(l)}}}else this.app.trace.warning("No Features were provided, as such, no features were highlighted")};g.prototype.highlightGraphics=function(c,b){if(c){var a=this.getHighlightLayerOrActive(b);a||this.app.trace.warning("Unable to highlight feature because the required layer was not found, or could not accept graphics");
for(var e=0;e<c.length;e++)this._drawGraphic(c[e],a)}else this.app.trace.warning("No Graphics were provided, as such, no graphics were highlighted")};g.prototype.removeHighlightLayer=function(c){if(!c)throw Error("Unable to remove a highlight layer with null or empty name");if(!this._highlightLayers.hasOwnProperty(c))throw Error("Cannot remove highlight layer because layer with name {0} does not exist.".format(c));var b=this._highlightLayers[c];this.clearHighlights(b);this.app.map.removeLayer(b);
delete this._highlightLayers[c];this._activeHighlightLayerName===c&&(this._activeHighlightLayerName=null)};g.prototype.clearHighlights=function(c){var b=null;!c&&this._activeHighlightLayerName&&(b=this._activeHighlightLayerName);var a=null;if(b||"string"==typeof c)b||(b=c),a=this.getHighlightLayer(b);if(a||"object"==typeof c&&c instanceof esri.layers.GraphicsLayer)if(a||(a=c),a&&a.graphics)for(c=a.graphics.length-1;0<=c;c--)this._removeClonedGraphic(a.graphics[c]);else this.app.trace.warning("An attempt was made to clear a highlight layer which contained no graphics")};
g.prototype.refreshHighlights=function(){var c=[],b;for(b in this._managedGraphics)if(this._managedGraphics.hasOwnProperty(b)){var a=this._managedGraphics[b],e=this._defaultRenderer.borderColor,f=this._defaultRenderer.fillColor,l=this._defaultRenderer.borderWidth;try{for(var n=function(b){var e=a[b];b=new h.Feature({graphic:e.managedGraphic});var f=void 0;b.borderColor&&b.borderColor.get()&&(f=h.ColorUtils.getColorFromList(b.borderColor.get()))&&d._setBorderColor(f);b.fillColor&&b.fillColor.get()&&
(f=h.ColorUtils.getColorFromList(b.fillColor.get()))&&d._setFillColor(f);b.borderWidth&&b.borderWidth.get()&&(p=b.borderWidth.get(),0<=p&&d._setBorderWidth(p));b=d._defaultRenderer.getSymbolWithHacks(e.managedGraphic,e.managedGraphic._graphicsLayer);e.clonedGraphic.setSymbol(b);0===c.filter(function(a){return a.id===e.layer.id}).length&&c.push(e.layer)},d=this,p,g=0;g<a.length;g++)n(g)}finally{this._setBorderColor(e),this._setFillColor(f),this._setBorderWidth(l)}}for(b=0;b<c.length;b++)c[b].redraw()};
g.prototype.getHighlightFillColor=function(){return this._toARGBHex(this._getFillColor())};g.prototype.getHighlightBorderColor=function(){return this._toARGBHex(this._getBorderColor())};g.prototype.getHighlightBorderWidth=function(){return this._getBorderWidth()};g.prototype.setHighlightFillColor=function(c){this._setFillColor(h.ColorUtils.getColorFromString(c))};g.prototype.setHighlightBorderColor=function(c){this._setBorderColor(h.ColorUtils.getColorFromString(c))};g.prototype.setHighlightBorderWidth=
function(c){this._setBorderWidth(c)};g.prototype.getHighlightLayer=function(c){return c?this._highlightLayers[c]:(this.app.trace.warning("Unable to get a highlight layer with null or empty name"),null)};g.prototype.getHighlightLayers=function(){return this._highlightLayers};g.prototype.getHighlightLayerOrActive=function(c){return c?this.getHighlightLayer(c):this._activeHighlightLayer()};g.prototype.activeHighlightLayerGraphics=function(){var c=this._activeHighlightLayer();return c&&c.graphics?c.graphics.slice(0):
null};g.prototype.defaultHighlightLayerGraphics=function(){var c=this.getHighlightLayer(this._defaultHighlightLayerName);return c?c.graphics.slice(0):null};g.prototype.exportState=function(){var c=this;return Promise["try"](function(){var b=c.app.project.convert,a={highlightLayers:{},activeHighlightLayerName:c._activeHighlightLayerName,highlights:[]},e;for(e in c._highlightLayers)a.highlightLayers[e]=b.fromEsriLayer(c._highlightLayers[e]);for(var f in c._managedGraphics)c._managedGraphics[f].forEach(function(e){a.highlights.push({feature:b.fromEsriGraphic(e.managedGraphic),
highlightLayer:b.fromEsriLayer(e.layer)})});return a})};g.prototype.applyState=function(c){var b=this,a=this.app.project.convert,e={},f;for(f in c.highlightLayers)e[f]=a.toEsriLayer(c.highlightLayers[f]);e={highlightLayers:h.PromiseUtils.propsSkipRejected(e),highlights:h.PromiseUtils.mapSkipRejected(c.highlights,function(b){return Promise.props({graphic:a.toEsriGraphic(b.feature),highlightLayer:a.toEsriLayer(b.highlightLayer)})})};return Promise.props(e).then(function(a){for(var e in b._highlightLayers)b.clearHighlights(e);
b._highlightLayers={};b._managedGraphics={};b._nextHighlightId=0;a.highlights.forEach(function(a){a=parseInt(b._getHighlightId(a.graphic));b._nextHighlightId=Math.max(b._nextHighlightId,a+1)});for(var f in a.highlightLayers)b._highlightLayers[f]=a.highlightLayers[f];b._activeHighlightLayerName=c.activeHighlightLayerName;a.highlights.forEach(function(a){b._getHighlightId(a.graphic);var e=d.framework.utils.ArrayUtils.firstOrDefault(a.highlightLayer.graphics,function(e){return b._getHighlightId(e)===
b._getHighlightId(a.graphic)});e?b._trackGraphic(a.graphic,e,a.highlightLayer):b._drawGraphic(a.graphic,a.highlightLayer)})})};g.prototype._drawGraphic=function(c,b){if(c&&b){this._showHighlightLayer(b);var a=this._getHighlightId(c);a||(a=this._nextId(),this._setHighlightId(c,a));if(this._managedGraphics.hasOwnProperty(a))for(var e=0;e<this._managedGraphics[a].length;e++)if(this._managedGraphics[a][e].layer===b)return;e=new esri.Graphic;e.attributes={};for(var f in c.attributes)c.attributes.hasOwnProperty(f)&&
(e.attributes[f]=c.attributes[f]);e.geometry=c.geometry;this._setHighlightId(e,a);this._trackGraphic(c,e,b);e.geometry&&(b.renderer||(e.symbol=this._defaultRenderer.getSymbolWithHacks(e,c._graphicsLayer)),b.add(e))}else this.app.trace.error("HighlightManager given null graphic or layer. Skipping...")};g.prototype._trackGraphic=function(c,b,a){var e,f=this._getHighlightId(c);this._managedGraphics.hasOwnProperty(f)?e=this._managedGraphics[f]:(e=[],this._managedGraphics[f]=e);for(f=0;f<e.length;f++)if(e[f].layer===
a)return;e.push({layer:a,managedGraphic:c,clonedGraphic:b})};g.prototype._getFillColor=function(){return this._defaultRenderer.fillColor};g.prototype._setFillColor=function(c){this._defaultRenderer.fillColor=c};g.prototype._getBorderColor=function(){return this._defaultRenderer.borderColor};g.prototype._setBorderColor=function(c){this._defaultRenderer.borderColor=c};g.prototype._getBorderWidth=function(){return this._defaultRenderer.borderWidth};g.prototype._setBorderWidth=function(c){this._defaultRenderer.borderWidth=
c};g.prototype._toARGBHex=function(c){var b=("00"+Math.floor(255*c.a).toString(16)).slice(-2),a=("00"+c.r.toString(16)).slice(-2),e=("00"+c.g.toString(16)).slice(-2);c=("00"+c.b.toString(16)).slice(-2);return"#"+b+a+e+c};g.prototype._nextId=function(){return(this._nextHighlightId++).toString()};g.prototype._getHighlightId=function(c){return c&&c.attributes?c.__gcxHlId:void 0};g.prototype._setHighlightId=function(c,b){c.__gcxHlId=b};g.prototype._showHighlightLayer=function(c){this.app.map.reorderLayer(c,
this.app.map.graphicsLayerIds.length-1);c!=this._highlightLayers[this._defaultHighlightLayerName]&&this.app.map.reorderLayer(this._highlightLayers[this._defaultHighlightLayerName],this.app.map.graphicsLayerIds.length-1)};g.prototype._addLayerToMap=function(c){this.app.map.addLayer(c)};g.prototype._activeHighlightLayer=function(){return this._activeHighlightLayerName?this.getHighlightLayer(this._activeHighlightLayerName):null};g.prototype._removeClonedGraphic=function(c){var b=this._getHighlightId(c);
this._managedGraphics.hasOwnProperty(b)&&(b=d.framework.utils.ArrayUtils.firstOrDefault(this._managedGraphics[b],function(a){return a.clonedGraphic===c}),this._removeManagedGraphic(b.managedGraphic,b.layer))};g.prototype._removeManagedGraphic=function(c,b){var a=this._getHighlightId(c);if(this._managedGraphics.hasOwnProperty(a)){for(var e=this._managedGraphics[a],f=null,l=0;l<e.length;l++)if(e[l].layer===b){f=e[l];break}f&&(b.remove(f.clonedGraphic),f=e.indexOf(f),e.splice(f,1),0===e.length&&delete this._managedGraphics[a])}};
return g}();h.HighlightManager=g})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var h=function(){function c(b,a){this.app=b;this.libraryId=a;this.id="SearchProvider-"+d.framework.utils.alphaNumericToken();this.supportsHints=this.supportsOffline=!1;this.status=d.essentialsHtmlViewer.mapping.infrastructure.search.Status.IDLE}c.prototype.initialize=function(b){};c.prototype.search=function(b,a){};c.prototype.cancelSearch=function(){};c.prototype.getResource=function(b,a){return this.app.getResource(this.libraryId,
b,a)};return c}();g.SearchProviderBase=h})(h.search||(h.search={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(){return function(){this.query=this.results=this.message=this.error=this.endpointUrl=this.searchType=this.status=null}}();d.SearchProgressEventArgs=h})(d.eventArgs||(d.eventArgs={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
geocortex.essentialsHtmlViewer.mapping.infrastructure.search.SearchProgressEventArgs=geocortex.essentialsHtmlViewer.mapping.infrastructure.eventArgs.SearchProgressEventArgs;
(function(d){(function(k){(function(k){(function(h){(function(g){(function(c){c.IDLE="Idle";c.SEARCHING="Searching";c.ERROR="Error"})(g.Status||(g.Status={}));var m=function(){function c(b){this._searchProviders=[];this._fscRootID="SearchResultsCollection";this._count=0;this._fscSourceName="Search";this.app=b;this._registerCommands();this.app.event("SearchProgressEvent").subscribe(this,this._searchProgress)}c.prototype._resetFeatureSetCollection=function(){this._fsc||(this._fsc=this.app.featureSetManager.getCollectionById(this._fscRootID));
this._fsc?(this.app.featureSetManager.getCollectionById(this._fsc.id)||this.app.featureSetManager.addCollection(this._fsc),this._fsc.clear(),this.app.featureSetManager.tryCloseCollection(this._fsc.id)):(this._fsc=new h.FeatureSetCollection,this._fsc.id=this._fscRootID,this._fsc.sourceName=this._fscSourceName,this.app.featureSetManager.addCollection(this._fsc))};c.prototype.getSearchHints=function(b,a){var e=this._enabledProviders();if(0==e.length)this.app.trace.warning("No search providers enabled.");
else for(var f=0;f<e.length;f++)e[f].supportsHints&&e[f].getSearchHints(b,a)};c.prototype._registerCommands=function(){this.app.command("RegisterSearchProvider").register(this,this._registerProvider);this.app.command("Search").register(this,this._search);this.app.command("GlobalSearch").register(this,this._search);this.app.command("CancelSearch").register(this,this._cancelSearch);this.app.command("ClearSearch").register(this,this._clearSearch)};c.prototype._registerProvider=function(b){if(!b)throw Error("Search Provider cannot be null.");
for(var a=0;a<this._searchProviders.length;a++)if(this._searchProviders[a].id==b.id)throw Error("Search Provider '{0}' already registered.".format(b.name));this._searchProviders.push(b)};c.prototype._enabledProviders=function(){for(var b=[],a=0;a<this._searchProviders.length;a++){var e=this._searchProviders[a];e.isEnabled&&(!0===this.app.isOffline.get()?e.supportsOffline&&b.push(e):b.push(e))}return b};c.prototype._isSearching=function(){for(var b=0;b<this._searchProviders.length;b++)if(this._searchProviders[b].status==
d.essentialsHtmlViewer.mapping.infrastructure.search.Status.SEARCHING)return!0;return!1};c.prototype._cancelSearch=function(){if(this._isSearching())for(var b=0;b<this._searchProviders.length;b++){var a=this._searchProviders[b];a.status==d.essentialsHtmlViewer.mapping.infrastructure.search.Status.SEARCHING&&a.cancelSearch()}};c.prototype._clearSearch=function(){this._isSearching()&&this._cancelSearch();this._resetFeatureSetCollection()};c.prototype._search=function(b){this._isSearching()&&this._cancelSearch();
this._resetFeatureSetCollection();if(b&&""!=b.replace(/ /g,"")){var a=this._enabledProviders();if(0==a.length)this.app.trace.warning("No search providers enabled.");else{var e=this.app.getResource("Mapping","language-search-fsc-display-name");this._fsc.displayName.set(e.format(b));this.app.featureSetManager.isCollectionOpen(this._fsc.id)||this.app.featureSetManager.openCollection(this._fsc.id);for(e=0;e<a.length;e++)a[e].search(this._fsc,b)}}else this.app.trace.warning("Cannot perform search without search text.")};
c.prototype._searchProgress=function(b){var a=!0;if(b.status!=d.essentialsHtmlViewer.mapping.infrastructure.search.Status.SEARCHING){for(var e=0;e<this._searchProviders.length;e++)this._searchProviders[e].status==d.essentialsHtmlViewer.mapping.infrastructure.search.Status.SEARCHING&&(a=!1);a&&this.app.featureSetManager.tryCloseCollection(b.results.id)}};return c}();g.SearchManager=m})(h.search||(h.search={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||
(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(){return function(c,b){b&&b.command?(this.app=c,this.command=c.command(b.command),this.commandParameter=b.commandParameter||null,this.abortBatchOnFailure=!!b.abortBatchOnFailure):c&&c.trace.warning("BatchItemModel: Could not create batch item. Configuration or command not specified.")}}();d.BatchItemModel=h})(d.menus||(d.menus={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||
(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var h=function(){function c(b,a){var e=this;if(!b||!a)throw Error("MenuItemModel: Required input parameters cannot be undefined");this.menuModel=b;this.app=b.app;this.text=a.text||"";this.description=a.description||"";this.iconUri=a.iconUri||this.menuModel.defaultIconUri;this.hideOnDisable=void 0!=a.hideOnDisable?a.hideOnDisable:!1;a.batch?(this.batchItems=[],this._setBatchItems(a.batch)):a.command&&(this.command=this.app.command(a.command),
this.commandParameter=a.commandParameter||null);a.libraryId&&(d.framework.ui.stringLocalizer.localizeString(this.app,a.libraryId,this.text,function(a){return e.text=a}),d.framework.ui.stringLocalizer.localizeString(this.app,a.libraryId,this.description,function(a){return e.description=a}))}c.prototype._setBatchItems=function(b){var a=this;b&&b.length&&b.forEach(function(b){b&&b.command&&a.batchItems.push(new g.BatchItemModel(a.app,b))})};return c}();g.MenuItemModel=h})(h.menus||(h.menus={}))})(k.infrastructure||
(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var h=function(){function c(b,a){if(!b||!a||!a.id)throw Error("MenuModel: Required input parameters cannot be undefined");this.app=b;this.id=a.id;this.title=a.title||"";this.description=a.description||"";this.defaultIconUri=a.defaultIconUri||"";this.items=this._createMenuItems(a.items)}c.prototype._createMenuItems=function(b){var a=this,e=[];b&&b.length&&b.forEach(function(b){try{var l=new d.essentialsHtmlViewer.mapping.infrastructure.menus.MenuItemModel(a,
b);l&&(l.command||l.batchItems)?e.push(l):a.app.trace.warning("MenuModel: Could not create menu item for menu with id: {0}. Invalid configuration.".format(a.id))}catch(n){a.app.trace.warning("Unexpected configuration error: {0}".format(n.message))}});return e};return c}();g.MenuModel=h})(h.menus||(h.menus={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var h=function(){function c(b){this.menuList=[];this._viewMenuEntries={};this._menuConfig=[];this.app=b}c.prototype.loadMenus=function(b){var a=this;b&&b.menus&&b.menus.length&&(b.menus.forEach(function(b){return a.register(b)}),this._menuConfig=this._menuConfig.concat(b.menus))};c.prototype.register=function(b){var a=b&&b.id;this._validMenuId(a)?(b=b instanceof g.MenuModel?b:new g.MenuModel(this.app,b),this._validateMenuModel(b)?this.menuList.push(b):
this.app.trace.warning("Could not register menu with id: {0}. Invalid menu configuration.".format(a))):this.app.trace.warning("Could not register menu with id: {0}. Menu id should be defined and unique.".format(a))};c.prototype.unregister=function(b){for(var a=this.menuList.length-1;0<=a;a--)this.menuList[a].id===b&&this.menuList.splice(a,1)};c.prototype.getMenu=function(b){for(var a=this.menuList,e=0;e<a.length;e++)if(a[e].id===b)return a[e];return null};c.prototype.getDefaultIconUri=function(b){return(b=
this.getMenu(b))&&b.defaultIconUri?b.defaultIconUri:""};c.prototype.getMenuWidgetsForView=function(b){return this._viewMenuEntries[b.id]||[]};c.prototype.createMenuWidget=function(b,a,e,f){var l=this,n=e.domElement,c=e.viewModel,p=n.getAttribute("data-menu-id");if(!p||!this.getMenu(p))return console.log("Warning: Could not create menu view from DOM element attributes. Menu Id: {0} not registered with the MenuRegistry.".format(p)),null;var g=n.getAttribute("data-menu-template")||"Mapping/infrastructure/menus/MenuView.html",
h=n.getAttribute("data-menu-type")||"geocortex.essentialsHtmlViewer.mapping.infrastructure.menus.MenuView",m=n.getAttribute("data-menu-library-id")||f||"Mapping";f=!n.hasAttribute("data-menu-hoist-disabled");g=this.app.viewManager.createView({typeName:h,markupResource:g,isVisible:!0});if(!g)return console.log("Warning: Could not create menu '{0}' for view '{1}': Could not construct the menu widget view.".format(p,b.id)),null;g.app=this.app;g.configuration.menuId=p;m&&(g.libraryId=m);h=new d.essentialsHtmlViewer.mapping.infrastructure.menus.MenuViewModel(this.app,
m);h.id="MenuViewModel-{0}".format(g.id);h.menuSourceView=b;g.attach(h);(m=a)&&a.isObservable?h.menuContext.sync(m):c&&e&&c[e.target]&&c[e.target].isObservable?(m=c[e.target],h.menuContext.sync(m)):h.menuContext.set(m);a={view:b,widgetView:g,widgetViewModel:h,context:m,menuId:p,hoistMenu:f,domElement:n};this._viewMenuEntries[b.id]||(this._viewMenuEntries[b.id]=[]);this._viewMenuEntries[b.id].push(a);dojo.aspect.after(b,"onDestroy",function(){return l._viewMenuEntries[b.id]=null});this.app.event("MenuWidgetCreatedForView").publish(a);
return g};c.prototype.destroyMenuWidget=function(b){var a=this;b.viewModel&&(b.viewModel.menuContext.removeSync(),b.viewModel.destroy());for(var e in this._viewMenuEntries)this._viewMenuEntries.hasOwnProperty(e)&&null!=this._viewMenuEntries[e]&&this._viewMenuEntries[e].filter(function(a){return a.widgetView===b}).forEach(function(b,l){a._viewMenuEntries[e].splice(l,1)})};c.prototype._validMenuId=function(b){var a=b?this.menuList.filter(function(a){return a.id===b}):null;return null!==a&&0===a.length};
c.prototype._validateMenuModel=function(b){return!!(b&&b.id&&b.items&&b.items.length)};return c}();g.MenuRegistry=h})(h.menus||(h.menus={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(){function c(b,a){this.name="";this.isActive=!1;dojo.mixin(this,a);this.app=b}c.prototype.setActive=function(b){b?(this.isActive=!0,this.onActivated()):(this.isActive=!1,this.onDeactivated())};c.prototype.onActivated=function(){};c.prototype.onDeactivated=function(){};return c}();d.ToolBase=h})(d.tools||(d.tools={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer=
{}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(){function c(b){this.tools={};this._subscriptions={};this._toolTypes={};this.app=b;this._registerCommands()}c.prototype._registerCommands=function(){var b=this;this.app.command("SetActiveTool").register(this,function(a){return b.setActiveTool(a)},function(a){return b._setActiveToolCanExecute(a)});this.app.command("ClearActiveTool").register(this,function(){return b.clearActiveTool()})};c.prototype._setActiveToolCanExecute=
function(b){return this.tool(b)?!0:!1};c.prototype.clearActiveTool=function(){for(var b in this.tools)if(this.tools.hasOwnProperty(b)){var a=this.tools[b];a&&a.isActive&&a.setActive(!1)}};c.prototype.getActiveTool=function(){for(var b in this.tools)if(this.tools.hasOwnProperty(b)){var a=this.tools[b];if(a&&a.isActive)return a}return null};c.prototype.setActiveTool=function(b){this.clearActiveTool();if(b){var a=this.tool(b);a?a.setActive(!0):this.app.trace.warning("Could not activate tool '{0}'. The tool does not exist in the registry.".format(b))}};
c.prototype.tool=function(b){return this.tools[b]};c.prototype.register=function(b){var a=this;this.unregister(b);b&&b.name&&(this.tools[b.name]=b,this._subscriptions[b.name]=dojo.connect(b,"setActive",function(e){if(!0===e){for(var f in a.tools)a.hasOwnProperty(f)&&(e=a.tools[f])&&e!=b&&e.isActive&&e.setActive(!1);a.app.event("ActiveToolChanged").publish({tool:b,previousTool:null});a.app.event("ActiveToolChanged").publish({tool:b,previousTool:null});a.app.event("ActiveToolChangedEvent").publish({tool:b,
previousTool:null});b instanceof d.MapTool&&a.app.event("ToolCommandActivatedEvent").publish(b.command)}else a.getActiveTool()||(a.app.event("ActiveToolChanged").publish({tool:null,previousTool:b}),a.app.event("ActiveToolChangedEvent").publish({tool:null,previousTool:b}),b instanceof d.MapTool&&a.app.event("ToolCommandDeactivatedEvent").publish(b.command))}))};c.prototype.unregister=function(b){if(b&&b.name&&this.tools[b.name]==b){this.tools[b.name]=null;var a=this._subscriptions[b.name];a&&(dojo.disconnect(a),
this._subscriptions[b.name]=null)}};c.prototype.clear=function(){for(var b in this.tools){var a=this.tools[b];a&&this.unregister(a)}};c.prototype.createTools=function(b,a){var e=this,f=[];b&&b.forEach(function(b){var n=b.typeName?b.typeName:"geocortex.essentialsHtmlViewer.mapping.infrastructure.tools.MapTool";e._toolTypes.hasOwnProperty(b.command)&&(n=e._toolTypes[b.command]);var c=dojo.getObject(n);c?(b=new c(e.app,b),f.push(b),a&&e.register(b)):e.app.trace.warning("Could not create tool '{0}' from type name '{1}'.".format(b.name,
n))});return f};c.prototype.registerToolTypeForCommand=function(b,a){this._toolTypes[b]=a};return c}();d.ToolRegistry=h})(d.tools||(d.tools={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){var g=function(d){function c(b,a,e,f){d.call(this,b,a);this.commandName="";this.commandParameter=null;this.canExecute=new Observable(!0);this.notExecuteHidden=new Observable(!1);e&&this._bindToCommand(e,f)}__extends(c,d);c.prototype.applyContext=function(b){this._command&&b&&this.canExecute.set(this._command.canExecute(b))};c.prototype._bindToCommand=function(b,a){this._canExecuteChangedBindingToken&&this._command&&this._command.canExecuteChanged.unsubscribe(this._canExecuteChangedBindingToken);
this.commandName=b;this.commandParameter=a||null;this._command=this.app.command(b);this._canExecuteChangedBindingToken=this._command.canExecuteChanged.subscribe(this,this._handleCanExecuteChanged);this.canExecute.set(this._command.canExecute(a))};c.prototype._handleCanExecuteChanged=function(){this.canExecute.set(this._command.canExecute(this.commandParameter))};return c}(d.framework.ui.ViewModelBase);h.CommandViewModel=g})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||
(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));(function(d){var k=d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}),k=k.mapping||(k.mapping={}),k=k.modules||(k.modules={});(k.command||(k.command={})).CommandViewModel=d.essentialsHtmlViewer.mapping.infrastructure.CommandViewModel})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var h=function(){function c(b,a,e){this.libraryId="";this.isActive=new Observable(!0);this.activeTransient=new Observable(!1);this.disabled=new Observable(!1);this.hidden=new Observable(!1);this.cssClass=new Observable;this.hasSmallLayout=new Observable(!1);this.selectedTool=new Observable(null);this.toolChangeActive=new Observable(!1);e&&(this.id=e.id,this.app=b,this.libraryId=a,this.type=e.type,this.name=new Observable(e.name),this.tooltip=
new Observable(e.tooltip||null),this.hideOnDisable=new Observable(!!e.hideOnDisable),e.libraryId&&d.framework.ui.stringLocalizer.localizeObservables(b,e.libraryId,[this.name,this.tooltip]))}c.prototype.areAllHidden=function(b){for(var a=0;a<b.length();a++)if(!1===b.getAt(a).disabled.get()||!1===b.getAt(a).hideOnDisable.get())return!1;return!0};c.prototype.setHidden=function(){!0===this.disabled.get()&&!0===this.hideOnDisable.get()?this.hidden.set(!0):this.hidden.set(!1)};c.prototype.execute=function(){};
c.prototype.activate=function(){this.isActive.set(!0)};c.prototype.deactivate=function(){this.isActive.set(!1);this.activeTransient.set(!1)};c.prototype.onDestroy=function(){};return c}();g.ToolbarGroupItemBase=h})(h.toolbarGroup||(h.toolbarGroup={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var h=function(){function c(b,a,e){this.libraryId="";this.isActive=new Observable(!1);this.disabled=new Observable(!1);this.cssClass=new Observable;this.app=b;this.libraryId=a;e&&(this.name=new Observable(e.name),this.id=e.id||e.name||d.framework.utils.alphaNumericToken(),this.tooltip=new Observable(e.tooltip||null),this.type=e.type||"toolbarGroup",this.isDefault=!!e.isDefault,this.items=e.items?this.getToolbarGroupItems(e.items):new ObservableCollection,
e.libraryId&&d.framework.ui.stringLocalizer.localizeObservables(b,e.libraryId,[this.name,this.tooltip]))}c.prototype.getToolbarGroupItems=function(b){for(var a=new ObservableCollection,e=0;e<b.length;e++){var f=null;"button"==b[e].type?f=new g.ToolbarButton(this.app,this.libraryId,b[e]):"toggleButton"==b[e].type?f=new g.ToolbarToggleButton(this.app,this.libraryId,b[e]):"region"==b[e].type?f=new g.ToolbarRegion(this.app,this.libraryId,b[e]):"tool"==b[e].type?f=new g.ToolbarTool(this.app,this.libraryId,
b[e]):"toolbarGroup"==b[e].type?f=new g.ToolbarGroup(this.app,this.libraryId,b[e]):"flyout"==b[e].type&&(f=new g.ToolbarFlyout(this.app,this.libraryId,b[e]));a.addItem(f)}return a};return c}();g.ToolbarGroupBase=h})(h.toolbarGroup||(h.toolbarGroup={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var h=function(){function c(b){this.toolbarGroupList=new ObservableCollection;this._toolbarGroupsConfig=[];this.app=b}c.prototype.getToolbarGroupById=function(b){if(0===this.toolbarGroupList.get().length||null===b)return null;for(var a=0;a<this.toolbarGroupList.get().length;a++)if(this.toolbarGroupList.getAt(a).id==b)return this.toolbarGroupList.getAt(a);return null};c.prototype.registerToolbarGroups=function(b,a){if(b)for(var e=0;e<
b.length;e++){var f=b[e],l=new d.essentialsHtmlViewer.mapping.infrastructure.toolbarGroup.ToolbarGroupBase(this.app,a,f);this._toolbarGroupsConfig.push(f);this.unregisterToolbarGroup(f.id);this.toolbarGroupList.addItem(l)}};c.prototype.unregisterToolbarGroup=function(b){b=this.getPosition(b);null!=b&&this.toolbarGroupList.get().splice(b,1)};c.prototype.getPosition=function(b){for(var a=0;a<this.toolbarGroupList.getLength();a++)if(this.toolbarGroupList.getAt(a).id===b)return a;return null};return c}();
g.ToolbarGroupRegistry=h})(h.toolbarGroup||(h.toolbarGroup={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(g){(function(c){c.IDLE="Idle";c.UNDOING="Undoing";c.REDOING="Redoing";c.COMMITTING="Committing";c.ROLLINGBACK="RollingBack"})(g.Status||(g.Status={}));var m=function(){function c(b,a){this.maxOperations=0;this.canUndo=this.canRedo=this.isRedoing=this.isUndoing=this.isSuspended=!1;this.position=this.length=0;this.rootTransaction=null;this._status=d.undo.Status.IDLE;this._historyStack=[];this.app=b;a=a||{};"number"==typeof a.maxOperations&&
this.setMaxOperations(a.maxOperations);this.registerCommands()}c.prototype.registerCommands=function(){var b=this;this.app.command("Undo").register(this,this.undo,function(a){return b.canUndo});this.app.command("Redo").register(this,this.redo,function(a){return b.canRedo})};c.prototype.suspend=function(){this.isSuspended=!0};c.prototype.resume=function(){this.isSuspended=!1};c.prototype.setMaxOperations=function(b){this.maxOperations=b};c.prototype.getCurrentState=function(){return{historyStack:(this._historyStack||
[]).slice(),position:this.position,rootTransaction:this.rootTransaction,status:this._status}};c.prototype.add=function(b){if(!b)throw Error("Undo operation cannot be null");for(;0<this.maxOperations&&this._historyStack.length>=this.maxOperations;){var a=this._historyStack.shift();this.app.event("UndoOperationDiscardedEvent").publish({sender:this,operation:a})}this._historyStack.splice(this.position,0,b);this.position++;this.clearRedo();this.app.event("UndoOperationAddedEvent").publish({sender:this,
operation:b});this._checkAvailability()};c.prototype.undo=function(){var b=this;if(0===this.position)return Promise.resolve();var a=this.peekUndo();this.position--;if(!a||"function"!==typeof a.performUndo)return Promise.resolve();this._updateStatus(d.undo.Status.UNDOING);this.app.event("UndoStartedEvent").publish({sender:this,operation:a});return a.performUndo(a.state).lastly(function(){b._updateStatus(d.undo.Status.IDLE);b.app.event("UndoCompletedEvent").publish({sender:b,operation:a});b._checkAvailability()})};
c.prototype.redo=function(){var b=this;if(this.position===this._historyStack.length)return Promise.resolve();var a=this.peekRedo();this.position++;if(!a||"function"!==typeof a.performRedo)return Promise.resolve();this._updateStatus(d.undo.Status.REDOING);this.app.event("RedoStartedEvent").publish({sender:this,operation:a});return a.performRedo(a.state).lastly(function(){b._updateStatus(d.undo.Status.IDLE);b.app.event("RedoCompletedEvent").publish({sender:b,operation:a});b._checkAvailability()})};
c.prototype.peekUndo=function(){return 0<this._historyStack.length&&0<this.position?this.getAt(this.position-1):null};c.prototype.peekRedo=function(){return 0<this._historyStack.length&&this.position<this._historyStack.length?this.getAt(this.position):null};c.prototype.clearUndo=function(){this._historyStack.splice(0,this.position);this.position=0;this._checkAvailability()};c.prototype.clearRedo=function(){this._historyStack.splice(this.position,this._historyStack.length-this.position);this.position=
this._historyStack.length;this._checkAvailability()};c.prototype.getAt=function(b){return this._historyStack[b]};c.prototype.removeAt=function(b){0<=b&&b<this._historyStack.length&&(this._historyStack.splice(b,1),0<this.position&&this.position>b&&this.position--,this._checkAvailability())};c.prototype.beginTransaction=function(b,a){var e=new g.UndoTransaction(this,b);this.rootTransaction?e.parentTransaction=a||this.rootTransaction:this.rootTransaction=e;return e};c.prototype.commitTransaction=function(b){var a=
this;b=b||this.rootTransaction;if(!b)return Promise.reject(Error("Cannot find the transaction to commit"));if(b.isComplete())return Promise.reject(Error("Transaction has been closed already"));b.transactionStatus=g.TransactionStatus.COMMITTING;if(!b.hasChanges())return b.transactionStatus=g.TransactionStatus.COMMITTED,this._onTransactionCommitted(b),Promise.resolve();var e=function(a){if(a instanceof g.UndoTransaction)return a.isComplete()?Promise.resolve():a.commit();if(a&&"function"==typeof a.performRedo)return a.performRedo(a.state,
b)},f=function(a,b){return b?e(b):null};return e(b.changes[0]).then(function(){return Promise.reduce(b.changes.slice(1),f,null)}).then(function(){b.transactionStatus==g.TransactionStatus.COMMITTING&&(b.transactionStatus=g.TransactionStatus.COMMITTED,a._onTransactionCommitted(b))})};c.prototype.rollbackTransaction=function(b){var a=this;b=b||this.rootTransaction;if(!b)return Promise.reject(Error("Cannot find the transaction to rollback"));if(b.isComplete())return Promise.reject(Error("Transaction has been closed already"));
b.transactionStatus=g.TransactionStatus.ABORTING;return b.hasChanges()?Promise.reduce(b.changes.slice().reverse(),function(a,f){if(f instanceof g.UndoTransaction)return f.isAborted()?Promise.resolve():f.rollback();if(f&&"function"==typeof f.performUndo)return f.performUndo(f.state,b)},null).then(function(){b.isAborted()||(b.transactionStatus=g.TransactionStatus.ABORTED,a._onTransactionAborted(b));if(!b.isTopLevel()&&!b.parentTransaction.isAborted())return a.rollbackTransaction(b.parentTransaction)}):
(b.transactionStatus=g.TransactionStatus.ABORTED,this._onTransactionAborted(b),Promise.resolve())};c.prototype.destroy=function(){this._historyStack=null};c.prototype._onTransactionCommitted=function(b){b&&b.isTopLevel()&&b==this.rootTransaction&&(this.rootTransaction=null,this.add(b))};c.prototype._onTransactionAborted=function(b){if(b){var a=b.parentTransaction;if(a){var e=a.changes.indexOf(b);-1<e&&a.changes.splice(e,1)}b.isTopLevel()&&b==this.rootTransaction&&(this.rootTransaction=null)}};c.prototype._checkAvailability=
function(){this.length=this._historyStack.length;this.isUndoing=this._status==d.undo.Status.UNDOING;this.isRedoing=this._status==d.undo.Status.REDOING;0===this.length?this.canUndo=this.canRedo=!1:0===this.position?(this.canUndo=!1,this.canRedo=!0):this.position===this.length?(this.canUndo=!0,this.canRedo=!1):this.canUndo=this.canRedo=!0;this.app.command("Undo").raiseCanExecuteChanged();this.app.command("Redo").raiseCanExecuteChanged();this.app.event("UndoStackChangedEvent").publish({sender:this})};
c.prototype._updateStatus=function(b){this._status=b||d.undo.Status.IDLE;this.isUndoing=this._status==d.undo.Status.UNDOING;this.isRedoing=this._status==d.undo.Status.REDOING};return c}();g.UndoManager=m})(d.undo||(d.undo={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){(function(d){d.SIMPLE_MARKER="esriSMS";d.SIMPLE_LINE="esriSLS";d.SIMPLE_FILL="esriSFS";d.PICTURE_MARKER="esriPMS";d.PICTURE_FILL="esriPFS";d.TEXT="esriTS"})(d.SymbolType||(d.SymbolType={}));(function(d){d.CIRCLE="esriSMSCircle";d.CROSS="esriSMSCross";d.DIAMOND="esriSMSDiamond";d.SQUARE="esriSMSSquare";d.X="esriSMSX";d.TRIANGLE="esriSMSTriangle";d.PATH="esriSMSPath"})(d.SimpleMarkerStyle||(d.SimpleMarkerStyle={}));(function(d){d.DASH=
"esriSLSDash";d.DASH_DOT="esriSLSDashDot";d.DASH_DOT_DOT="esriSLSDashDotDot";d.DOT="esriSLSDot";d.NONE="esriSLSNull";d.SOLID="esriSLSSolid"})(d.SimpleLineStyle||(d.SimpleLineStyle={}));(function(d){d.BACKWARD_DIAGONAL="esriSFSBackwardDiagonal";d.CROSS="esriSFSCross";d.DIAGONAL_CROSS="esriSFSDiagonalCross";d.FORWARD_DIAGONAL="esriSFSForwardDiagonal";d.HORIZONTAL="esriSFSHorizontal";d.NONE="esriSFSNull";d.SOLID="esriSFSSolid";d.VERTICAL="esriSFSVertical"})(d.SimpleFillStyle||(d.SimpleFillStyle={}));
(function(d){d.BASELINE="baseline";d.TOP="top";d.MIDDLE="middle";d.BOTTOM="bottom"})(d.VerticalAlignment||(d.VerticalAlignment={}));(function(d){d.LEFT="left";d.RIGHT="right";d.CENTER="center";d.JUSTIFY="justify"})(d.HorizontalAlignment||(d.HorizontalAlignment={}));(function(d){d.ITALIC="italic";d.NORMAL="normal";d.OBLIQUE="oblique"})(d.FontStyle||(d.FontStyle={}));(function(d){d.BOLD="bold";d.BOLDER="bolder";d.LIGHTER="lighter";d.NORMAL="normal"})(d.FontWeight||(d.FontWeight={}));(function(d){d.LINE_THROUGH=
"line-through";d.UNDERLINE="underline";d.NONE="none"})(d.TextDecoration||(d.TextDecoration={}))})(d.webMap||(d.webMap={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var m=d.framework.utils.ArrayUtils,c=function(){return function(){}}();g.CONVERSION_TYPE_PROPERTY="__conversionType";var b={type:g.SymbolType.SIMPLE_MARKER,style:g.SimpleMarkerStyle.CIRCLE,size:0,color:[0,0,0,0]},a;(function(a){a.FeatureLayer="ArcGISFeatureLayer";a.MapService="ArcGISMapServiceLayer";a.TiledMapService="ArcGISTiledMapServiceLayer";a.ImageService="ArcGISImageServiceLayer";a.BingAerial="BingMapsAerial";a.BingHybrid="BingMapsHybrid";
a.BingRoad="BingMapsRoad";a.OpenStreetMap="OpenStreetMap";a.WebTiled="WebTiledLayer";a.KML="KML";a.WMS="WMS"})(a||(a={}));var e;(function(a){a.WEB_MAP_SERVICE_LAYER="webMapServiceLayer";a.WEB_MAP_LAYER="webMapLayer";a.WEB_MAP_FEATURE_SET="webMapFeatureSet";a.WEB_MAP_FEATURE="webMapFeature";a.WEB_MAP_GEOMETRY="webMapGeometry";a.WEB_MAP_SYMBOL="webMapSymbol";a.WEB_MAP_RENDERER="webMapRenderer";a.WEB_MAP_SPATIAL_REFERENCE="webMapSpatialReference";a.WEB_MAP_COLOR="webMapColor";a.WEB_MAP_DATA="webMapData";
a.GCX_MAP_SERVICE="gcxMapService";a.GCX_LAYER="gcxLayer";a.GCX_FEATURE_SET="gcxFeatureSet";a.GCX_FEATURE="gcxFeature";a.ESRI_LAYER="esriLayer";a.ESRI_FEATURE_SET="esriFeatureSet";a.ESRI_GRAPHIC="esriGraphic";a.ESRI_GEOMETRY="esriGeometry";a.ESRI_SYMBOL="esriSymbol";a.ESRI_RENDERER="esriRenderer";a.ESRI_SPATIAL_REFERENCE="esriSpatialReference";a.ESRI_COLOR="esriColor";a.OBJECT="object"})(e=g.ConversionType||(g.ConversionType={}));var f=function(){function f(a){this._resultCache={};this._nextSymbolId=
1;this._nestingLevel=0;this._hasReferences=!1;this._converting={};this.app=a}f.prototype.fromGcxMapService=function(a){return this._convert(a,e.WEB_MAP_SERVICE_LAYER,this._fromGcxMapService)};f.prototype.fromGcxLayer=function(a){return this._convert(a,e.WEB_MAP_LAYER,this._fromGcxlayer)};f.prototype.fromGcxFeatureSet=function(a){return this._convert(a,e.WEB_MAP_FEATURE_SET,this._fromGcxFeatureSet)};f.prototype.fromGcxFeature=function(a){return this._convert(a,e.WEB_MAP_FEATURE,this._fromGcxFeature)};
f.prototype.fromEsriLayer=function(a){return this._convert(a,e.WEB_MAP_SERVICE_LAYER,this._fromEsriLayer)};f.prototype.fromEsriFeatureSet=function(a){return this._convert(a,e.WEB_MAP_FEATURE_SET,this._fromEsriFeatureSet)};f.prototype.fromEsriGraphic=function(a){return this._convert(a,e.WEB_MAP_FEATURE,this._fromEsriGraphic)};f.prototype.fromEsriGeometry=function(a){return this._convert(a,e.WEB_MAP_GEOMETRY,this._fromEsriGeometry)};f.prototype.fromEsriSymbol=function(a){return this._convert(a,e.WEB_MAP_SYMBOL,
this._fromEsriSymbol)};f.prototype.fromEsriRenderer=function(a){return this._convert(a,e.WEB_MAP_RENDERER,this._fromEsriRenderer)};f.prototype.fromEsriSpatialReference=function(a){return this._convert(a,e.WEB_MAP_SPATIAL_REFERENCE,this._fromEsriSpatialReference)};f.prototype.fromEsriColor=function(a){return this._convert(a,e.WEB_MAP_COLOR,this._fromEsriColor)};f.prototype.fromObject=function(a){return this._convert(a,e.WEB_MAP_DATA,this._fromObject)};f.prototype.toGcxMapService=function(a){return Promise.resolve(this._convert(a,
e.GCX_MAP_SERVICE,this._toGcxMapService))};f.prototype.toGcxLayer=function(a,b){return Promise.resolve(this._convert(a,e.GCX_LAYER,this._toGcxLayer,[b]))};f.prototype.toGcxFeatureSet=function(a){return Promise.resolve(this._convert(a,e.GCX_FEATURE_SET,this._toGcxFeatureSet))};f.prototype.toGcxFeature=function(a){return Promise.resolve(this._convert(a,e.GCX_FEATURE,this._toGcxFeature))};f.prototype.toEsriLayer=function(a){return Promise.resolve(this._convert(a,e.ESRI_LAYER,this._toEsriLayer))};f.prototype.toEsriFeatureSet=
function(a){return Promise.resolve(this._convert(a,e.ESRI_FEATURE_SET,this._toEsriFeatureSet))};f.prototype.toEsriGraphic=function(a){return Promise.resolve(this._convert(a,e.ESRI_GRAPHIC,this._toEsriGraphic))};f.prototype.toEsriGeometry=function(a){return this._convert(a,e.ESRI_GEOMETRY,this._toEsriGeometry)};f.prototype.toEsriSymbol=function(a){return this._convert(a,e.ESRI_SYMBOL,this._toEsriSymbol)};f.prototype.toEsriRenderer=function(a){return this._convert(a,e.ESRI_RENDERER,this._toEsriRenderer)};
f.prototype.toEsriSpatialReference=function(a){return this._convert(a,e.ESRI_SPATIAL_REFERENCE,this._toEsriSpatialReference)};f.prototype.toEsriColor=function(a){return this._convert(a,e.ESRI_COLOR,this._toEsriColor)};f.prototype.toObject=function(a){return Promise.resolve(this._convert(a,e.OBJECT,this._toObject))};f.prototype.clearCache=function(){this._resultCache={}};f.prototype._convert=function(a,b,e,f){void 0===f&&(f=[]);if(null===a||void 0===a||"string"===typeof a||"number"===typeof a||"boolean"===
typeof a||a instanceof Date)return a;var l=this._resultCache[b];l||(l=this._resultCache[b]=new WeakMap);var d=this._converting[b];d||(d=this._converting[b]=new WeakMap);if(l.has(a))return l.get(a);if(d.has(a)){var g=new c;l.set(a,g);this._hasReferences=!0;return g}b=void 0;0===this._nestingLevel&&(this._hasReferences=!1);this._nestingLevel++;d.set(a,!0);try{b=e.apply(this,[a].concat(f));if(g=l.get(a))g.result=b;l.set(a,b)}catch(h){throw l["delete"](a),h;}finally{this._nestingLevel--,d["delete"](a)}0===
this._nestingLevel&&this._hasReferences&&this._resolveReferences(b);return b};f.prototype._resolveReferences=function(a){if(a){var b=new WeakMap,e=function(a){if(!(a instanceof d.essentials.MapService||a instanceof d.essentials.Layer)){b.set(a,!0);for(var f in a){var l=a[f];"object"===typeof l&&(l instanceof c?a[f]=l.result:l&&!b.has(l)&&e(l))}}};e(a)}};f.prototype._getWebMapLayerDefinitionFromFeatureLayer=function(a){var b={};b.definitionExpression=a.getDefinitionExpression();b.drawingInfo={renderer:this.fromEsriRenderer(a.renderer)};
return b};f.prototype._getWebMapLayerDefinitionFromDynamicLayer=function(a,b){var e={},f=!1;a.layerDefinitions&&a.layerDefinitions[b]&&(f=!0,e.definitionExpression=a.layerDefinitions[b]);if(a.dynamicLayerInfos){var l=m.firstOrDefault(a.dynamicLayerInfos,function(a){return a.id===b});l&&(f=!0,e.minScale=l.minScale,e.maxScale=l.maxScale,e.source=l.source.toJson())}a.layerDrawingOptions&&a.layerDrawingOptions[b]&&(f=!0,e.drawingInfo={renderer:this.fromEsriRenderer(a.layerDrawingOptions[b].renderer),
fixedSymbols:!a.layerDrawingOptions[b].scaleSymbols});return f?e:null};f.prototype._applyWebMapServiceLayerToMapService=function(a,b){var e=this;return Promise["try"](function(){b.setOpacity(a.opacity);b.setVisibility(a.visibility);var f=b.serviceLayer;f instanceof esri.layers.FeatureLayer&&(b.layers[0].setVisibility(a.visibility),a.layerDefinition&&a.layerDefinition.definitionExpression&&f.setDefinitionExpression(a.layerDefinition.definitionExpression));if(e._isFeatureCollection(a)&&a.featureCollection.layers[0].layerDefinition)return e._applyDrawingInfo(a.featureCollection.layers[0].layerDefinition.drawingInfo,
b);if(a.layerDefinition)return e._applyDrawingInfo(a.layerDefinition.drawingInfo,b)})};f.prototype._applyWebMapLayersToGcxLayers=function(a,b){var e=this,f=[];(a.layers||[]).forEach(function(a,l){var n=e._findOrCreateMatchingGcxLayer(a,b).then(function(b){return b?e._applyWebMapLayerToGcxLayer(a,l,b):!1});f.push(n)});return Promise.all(f).then(function(a){return a.some(function(a){return a})})};f.prototype._applyWebMapLayerToGcxLayer=function(a,b,e){var f=this,l=e.mapService.serviceLayer;return a.layerDefinition&&
l instanceof esri.layers.ArcGISDynamicMapServiceLayer?this.app.waitUntilServiceLayerLoaded(l).then(function(){var b=parseInt(e.id),c=!1;a.layerDefinition.definitionExpression&&(c=(l.layerDefinitions||[]).slice(),c[b]=a.layerDefinition.definitionExpression,l.setLayerDefinitions(c,!0),c=!0);if(a.layerDefinition.drawingInfo){e.mapService.convertToDynamicLayers();c=(l.layerDrawingOptions||[]).slice();c[b]=new esri.layers.LayerDrawingOptions;c[b].renderer=f.toEsriRenderer(a.layerDefinition.drawingInfo.renderer);
c[b].scaleSymbols=!a.layerDefinition.drawingInfo.fixedSymbols;a.layerDefinition.drawingInfo.hasOwnProperty("showLabels")&&(c[b].showLabels=a.layerDefinition.drawingInfo.showLabels);if(a.layerDefinition.drawingInfo.hasOwnProperty("labelingInfo")){var d=a.layerDefinition.drawingInfo.labelingInfo;c[b].labelingInfo=c[b].labelingInfo||[];c[b].labelingInfo.length?c[b].labelingInfo[0]=new esri.layers.LabelClass(d[0]):c[b].labelingInfo.push(new esri.layers.LabelClass(d[0]));var r=d[0],d=r.symbol.color,r=
r.symbol.haloColor;d&&c[b].labelingInfo[0].symbol.setColor(new esri.Color([d.r,d.g,d.b,d.a]));r&&c[b].labelingInfo[0].symbol.setHaloColor(new esri.Color([r.r,r.g,r.b,r.a]));d=c[b].labelingInfo[0].symbol;c[b].labelingInfo[0].symbol.font.setSize(0.75*d.font.size);c[b].labelingInfo[0].symbol.setHaloSize(0.75*d.haloSize)}l.setLayerDrawingOptions(c,!0);c=!0}l.dynamicLayerInfos&&(d=m.firstOrDefault(l.dynamicLayerInfos,function(a){return a.id===b}))&&(d.minScale=a.layerDefinition.minScale,d.maxScale=a.layerDefinition.maxScale,
l.setDynamicLayerInfos(l.dynamicLayerInfos,!0),c=!0);return c}):Promise.resolve(!1)};f.prototype._applyDrawingInfo=function(a,b){var e=this;if(!a)return Promise.resolve();var f=b.serviceLayer;return this.app.waitUntilServiceLayerLoaded(f).then(function(){!b.heatMap||!b.heatMap.userCanToggle||b.isUserCreated&&b.heatMap.enabled||e.app.command("RemoveHeatMap").execute({gcxLayer:b.layers[0]});if(a.renderer)if(b.heatMap&&b.heatMap.userCanToggle&&a.renderer.type===g.RendererType.HEATMAP){var l=a.renderer;
if(l){var c=b.heatMap;c.intensity=l.blurRadius;c.field=l.field;c.gradient=[];c.offset=[];(l.colorStops||[]).forEach(function(a,b){c.gradient[b]=a.color;c.offset[b]=a.ratio});e.app.command("AddHeatMap").execute({gcxLayer:b.layers[0]})}}else f instanceof esri.layers.GraphicsLayer&&e._setGraphicsLayerRenderer(f,e.toEsriRenderer(a.renderer))})};f.prototype._setGraphicsLayerRenderer=function(a,b){a.setRenderer(b);a.redraw()};f.prototype._findMatchingGcxMapService=function(a){var b=this.app.site.essentialsMap.findMapServiceById(a.id);
return b=b||m.firstOrDefault(this.app.site.essentialsMap.mapServices,function(b){return b.serviceUrl===a.url})};f.prototype._findMatchingGcxLayer=function(a,b){var e="object"===typeof a?a:null,f=null;e&&(f=b.findLayerByName(e.name));var l=e?e.id.toString():a.toString(),f=(f=f||b.findLayerById(l))||m.firstOrDefault(b.layers,function(a){return a.wmsLayerName===l}),c=void 0;!f&&e&&e.layerDefinition&&e.layerDefinition.source&&"mapLayer"===e.layerDefinition.source.type&&(c=e.layerDefinition.source.mapLayerId);
f||null===c||void 0===c||(f=b.findLayerById(c.toString()));f||b.layers.forEach(function(a){if(a.dynamicDefinition){var b=JSON.parse(a.dynamicDefinition);!b||!b.source||"mapLayerId"!==b.source.type||!b.source.mapLayerId&&0!==b.source.mapLayerId||b.source.mapLayerId.toString()!==l&&b.source.mapLayerId.toString()!==c||(f=a)}});return f};f.prototype._findOrCreateMatchingGcxLayer=function(a,b){var e=this._findMatchingGcxLayer(a,b);return!e&&this._canCreateGcxLayer(a,b)?this._createGcxLayer(a,b):Promise.resolve(e)};
f.prototype._findOrCreateMatchingGcxMapService=function(a){var b=this._findMatchingGcxMapService(a);return!b&&this._canCreateGcxMapService(a)?this._createGcxMapService(a):Promise.resolve(b)};f.prototype._canCreateGcxLayer=function(a,b){return b.serviceLayer instanceof esri.layers.ArcGISDynamicMapServiceLayer};f.prototype._createGcxLayer=function(a,b){if(!this._canCreateGcxLayer(a,b))return Promise.reject(Error("WebMapConverter._createGcxLayer: Unsupported layer type."));var e={source:{type:"mapLayerId",
mapLayerId:a.id}};a.layerDefinition&&a.layerDefinition.drawingInfo&&(e.drawingInfo=a.layerDefinition.drawingInfo);var e={id:a.id.toString(),name:a.name,displayName:a.title||a.name,isDynamic:!0,dynamicDefinition:JSON.stringify(e)},f=new d.essentials.Layer(b.url+"/layers/"+a.id.toString());f.createFromDefinition(e);b.add(f);return Promise.resolve(f)};f.prototype._canCreateGcxMapService=function(a){return this._isFeatureCollection(a)||this._isKmlLayer(a)||this._isLayerCatalogService(a)};f.prototype._createGcxMapService=
function(a){var b=this,e=this._getMapServiceDefinition(a);if(this._isLayerCatalogService(a)){var f=a.gcxMapServiceDefinition.catalogId,l=a.layers.map(function(a){return a.gcxLayerDefinition.catalogId});return new Promise(function(e,c){var d={mapServiceId:a.id,layerLookupIds:l,lookupId:f,callback:function(a){a&&e(a);c(Error("WebMapConverter._createGcxMapService: Unsupported layer catalog id."))},serviceLayer:a};b.app.waitUntilAllLibrariesLoaded().then(function(){b.app.command("LayerCatalogRestoreMapService").execute(d)})})}if(this._isFeatureCollection(a)){var c=
a.featureCollection.layers[0],d=c.featureSet||{},g=d.features||[],m=c.layerDefinition&&c.layerDefinition.drawingInfo&&c.layerDefinition.drawingInfo.renderer?dojo.clone(c.layerDefinition.drawingInfo.renderer):{};d.features=[];e={mapService:h.LayerIntegrationUtils.buildLocalFeatureLayerService(c,e),graphics:Promise.map(g,function(a){return b.toEsriGraphic(a)})};return Promise.props(e).then(function(e){var f=e.mapService;m&&(c.layerDefinition.drawingInfo.renderer=m,a.layerDefinition.drawingInfo.renderer=
m,f.serviceLayer.setRenderer(b._toEsriRenderer(m)));e.graphics.forEach(function(a){f.serviceLayer.add(a)});e.graphics.length&&(f.serviceLayer.fullExtent=esri.graphicsExtent(e.graphics));b.app.site.essentialsMap.addMapService(f);return f})}return this._isKmlLayer(a)?h.LayerIntegrationUtils.buildKmlService(a.url,e).then(function(a){b.app.site.essentialsMap.addMapService(a);return a}):Promise.reject(Error("WebMapConverter._createGcxMapService: Unsupported service layer type."))};f.prototype._getMapServiceDefinition=
function(a){return{id:a.id,displayName:a.title}};f.prototype._isFeatureCollection=function(a){return a.featureCollection&&a.featureCollection.layers&&1===a.featureCollection.layers.length&&!!a.featureCollection.layers[0].featureSet};f.prototype._isKmlLayer=function(a){return a.type===g.OperationalLayerType.KML};f.prototype._isGraphicsLayer=function(a){return a.id&&a.id.startsWith("graphics-layer-")};f.prototype._isLayerCatalogService=function(a){return a.gcxMapServiceDefinition&&a.gcxMapServiceDefinition.catalogId};
f.prototype._addSourceType=function(a,b){b[g.CONVERSION_TYPE_PROPERTY]=a;return b};f.prototype._getWebMapLayerType=function(b){if(b instanceof esri.layers.FeatureLayer)return a.FeatureLayer;if(b instanceof esri.layers.ArcGISDynamicMapServiceLayer)return a.MapService;if(b instanceof esri.layers.ArcGISTiledMapServiceLayer)return a.TiledMapService;if(b instanceof esri.layers.ArcGISImageServiceLayer)return a.ImageService;if(b instanceof esri.virtualearth.VETiledLayer)switch(b.mapStyle.toLowerCase()){case esri.virtualearth.VETiledLayer.MAP_STYLE_AERIAL.toLowerCase():return a.BingAerial;
case esri.virtualearth.VETiledLayer.MAP_STYLE_AERIAL_WITH_LABELS.toLowerCase():return a.BingHybrid;case esri.virtualearth.VETiledLayer.MAP_STYLE_ROAD.toLowerCase():return a.BingRoad}else{if(b instanceof esri.layers.WebTiledLayer)return b.url&&0<=b.url.indexOf("tile.openstreetmap.org")?a.OpenStreetMap:a.WebTiled;if(b instanceof esri.layers.KMLLayer)return a.KML;if(b instanceof esri.layers.WMSLayer)return a.WMS;if(b instanceof esri.layers.WMTSLayer)return a.WebTiled}};f.prototype._inferAttributeType=
function(a,b){var e=m.firstOrDefault(a,function(a){return a.attributes&&!d.framework.utils.isNullOrUndefined(a.attributes[b])});if(!e)return d.essentials.EsriFieldTypes.esriFieldTypeString;e=e.attributes[b];return"number"===typeof e?d.essentials.EsriFieldTypes.esriFieldTypeDouble:e instanceof Date?d.essentials.EsriFieldTypes.esriFieldTypeDate:d.essentials.EsriFieldTypes.esriFieldTypeString};f.prototype._setVisibleLayers=function(a,b){var e=this;if(!b.supportsLayerVisibility())return!1;var f=!1,l=
[],c=a.layers||[];(a.visibleLayers||[]).forEach(function(a){var f=void 0;if(c){var n=m.firstOrDefault(c,function(b){return b.id===a});(n=n||m.firstOrDefault(c,function(b){return b.name===a}))&&(f=e._findMatchingGcxLayer(n,b))}f||(f=e._findMatchingGcxLayer(a,b));f&&l.push(f)});b.layers.forEach(function(a){if(a.type!==d.essentials.LayerType.GROUP_LAYER){var b=0<=l.indexOf(a);f=f||b!==a.isVisible();a.setVisibility(b,!0)}});return f};f.prototype._toGcxMapService=function(a){var b=this,e=void 0;return Promise.all([this.app.waitUntilSiteInitialized(),
this.app.waitUntilMapLoaded()]).then(function(){return b._findOrCreateMatchingGcxMapService(a)}).then(function(f){e=f;if(!e)throw Error('No matching Essentials map service was found for service "{0}".'.format(a.id));return b._applyWebMapServiceLayerToMapService(a,e)}).then(function(){return b._applyWebMapLayersToGcxLayers(a,e)}).then(function(f){(f=b._setVisibleLayers(a,e)||f)&&e.refresh();return e})};f.prototype._toGcxLayer=function(a,b){var e=this;if(!b)throw Error('WebMapConverter.toGcxLayer: Parameter "serviceLayer" is required.');
return this.toGcxMapService(b).then(function(f){f=e._findMatchingGcxLayer(a,f);if(!f)throw Error('No matching Essentials layer was found for layer "{0}" for service "{1}".'.format(a.id,b.id));return f})};f.prototype._toGcxFeatureSet=function(a){var b=this;return this.toEsriFeatureSet(a).then(function(a){return new h.FeatureSet({app:b.app,esriFeatureSet:a})})};f.prototype._toEsriLayer=function(b){if(this._isGraphicsLayer(b))return this._toEsriGraphicsLayer(b);if(b.layerType===a.FeatureLayer)return this._toEsriFeatureLayer(b);
throw Error("WebMapConverter.toEsriLayer: Unsupported layer type.");};f.prototype._toEsriGraphicsLayer=function(a){var e=this,f=a.id.slice(15),l=this.app.map.getLayer(f);return!l||l instanceof esri.layers.GraphicsLayer?Promise.all([this.app.waitUntilSiteInitialized(),this.app.waitUntilMapLoaded()]).then(function(){var c=l;c||(c=new esri.layers.GraphicsLayer({id:f}),e.app.map.addLayer(c));c.setVisibility(a.visibility);c.setOpacity(a.opacity);c.clear();var d=[];((a.featureCollection||{}).layers||[]).forEach(function(a){((a.featureSet||
{}).features||[]).forEach(function(a){a.attributes&&(d[a.attributes.__id]=e.toEsriGraphic(a))});!c.renderer&&a.layerDefinition&&a.layerDefinition.drawingInfo&&a.layerDefinition.drawingInfo.renderer&&(a=a.layerDefinition.drawingInfo.renderer,a.uniqueValueInfos&&a.uniqueValueInfos[0]&&JSON.stringify(a.uniqueValueInfos[0].symbol)===JSON.stringify(b)||c.setRenderer(e.toEsriRenderer(a)))});return Promise.all(d).then(function(a){a.forEach(function(a){a&&c.add(a)});return c})}):Promise.resolve(l)};f.prototype._toEsriFeatureLayer=
function(a){var b=this;if(a.url){var e=new esri.layers.FeatureLayer(a.url);e.setVisibility(a.visibility);e.setOpacity(a.opacity);return this.app.waitUntilServiceLayerLoaded(e)["return"](e)}if(this._isFeatureCollection(a)){var f=new esri.layers.FeatureLayer(a.featureCollection.layers[0]);f.setVisibility(a.visibility);f.setOpacity(a.opacity);f.clear();return Promise.map((a.featureCollection.layers[0].featureSet||{}).features||[],function(a){return b.toEsriGraphic(a).then(function(a){return f.add(a)})})["return"](f)}throw Error("WebMapConverter.toEsriLayer: Unsupported layer type.");
};f.prototype._toEsriFeatureSet=function(a){var b=this;return h.PromiseUtils.mapSkipRejected(a.features||[],function(a){return b.toEsriGraphic(a)}).then(function(a){var b=new esri.tasks.FeatureSet;b.features=a;return b})};f.prototype._toGcxFeature=function(a){return this.toEsriGraphic(a).then(function(a){return new h.Feature({graphic:a})})};f.prototype._toEsriGraphic=function(a){var b=this;return this.toObject(a.attributes).then(function(e){var f=b.toEsriGeometry(a.geometry),l,c=!0;e&&(l=e.__symbol,
delete e.__symbol,e.hasOwnProperty("__visible")&&(c=e.__visible,delete e.__visible),delete e.__id);e=new esri.Graphic(f,l,e,null);e.visible=c;return e})};f.prototype._toEsriGeometry=function(a){if(a.hasOwnProperty("x")&&a.hasOwnProperty("y"))return new esri.geometry.Point(a);if(a.hasOwnProperty("points"))return new esri.geometry.Multipoint(a);if(a.hasOwnProperty("paths"))return new esri.geometry.Polyline(a);if(a.hasOwnProperty("rings"))return new esri.geometry.Polygon(a);if(a.hasOwnProperty("xmin")&&
a.hasOwnProperty("xmax")&&a.hasOwnProperty("ymin")&&a.hasOwnProperty("ymax"))return new esri.geometry.Extent(a);throw Error("WebMapConverter.toEsriGeometry: Unrecognized type of geometry object.");};f.prototype._toEsriSymbol=function(a){switch(a.type){case g.SymbolType.SIMPLE_MARKER:var b=new esri.symbol.SimpleMarkerSymbol(a);a.size!==b.size&&(b.size=a.size);return b;case g.SymbolType.SIMPLE_LINE:return new esri.symbol.SimpleLineSymbol(a);case g.SymbolType.SIMPLE_FILL:return new esri.symbol.SimpleFillSymbol(a);
case g.SymbolType.PICTURE_MARKER:return new esri.symbol.PictureMarkerSymbol(a);case g.SymbolType.PICTURE_FILL:return new esri.symbol.PictureFillSymbol(a);case g.SymbolType.TEXT:return new esri.symbol.TextSymbol(a);default:throw Error('WebMapConverter.toEsriSymbol: Unsupported symbol type "{0}".'.format(a.type));}};f.prototype._toEsriRenderer=function(a){var b=this;switch(a.type){case g.RendererType.SIMPLE:var e=new esri.renderer.SimpleRenderer(dojo.clone(a));e.symbol=this.toEsriSymbol(a.symbol);return e;
case g.RendererType.UNIQUE_VALUE:return e=new esri.renderer.UniqueValueRenderer(dojo.clone(a)),e.defaultSymbol=this.toEsriSymbol(a.defaultSymbol),e.infos.forEach(function(e,f){e.symbol=b.toEsriSymbol(a.uniqueValueInfos[f].symbol)}),e;case g.RendererType.CLASS_BREAKS:return e=new esri.renderer.ClassBreaksRenderer(dojo.clone(a)),e.defaultSymbol=this.toEsriSymbol(a.defaultSymbol),e.infos.forEach(function(e,f){e.symbol=b.toEsriSymbol(a.classBreakInfos[f].symbol)}),e;case g.RendererType.HEATMAP:return new esri.renderer.HeatmapRenderer(dojo.clone(a));
default:throw Error('WebMapConverter.toEsriRenderer: Unsupported renderer type "{0}".'.format(a.type));}};f.prototype._toEsriSpatialReference=function(a){return new esri.SpatialReference(a)};f.prototype._toEsriColor=function(a){return new esri.Color(a)};f.prototype._toObject=function(a){var b=this;if("string"===typeof a||"number"===typeof a||"boolean"===typeof a||a instanceof Date||null===a||void 0===a)return Promise.resolve(a);if(a.hasOwnProperty(g.CONVERSION_TYPE_PROPERTY))switch(a[g.CONVERSION_TYPE_PROPERTY]){case e.GCX_MAP_SERVICE:return this.toGcxMapService(a);
case e.GCX_LAYER:return this.toGcxLayer(a,null);case e.GCX_FEATURE_SET:return this.toGcxFeatureSet(a);case e.GCX_FEATURE:return this.toGcxFeature(a);case e.ESRI_LAYER:return this.toEsriLayer(a);case e.ESRI_FEATURE_SET:return this.toEsriFeatureSet(a);case e.ESRI_GRAPHIC:return this.toEsriGraphic(a);case e.ESRI_GEOMETRY:return Promise.resolve(this.toEsriGeometry(a));case e.ESRI_SYMBOL:return Promise.resolve(this.toEsriSymbol(a));case e.ESRI_RENDERER:return Promise.resolve(this.toEsriRenderer(a));case e.ESRI_SPATIAL_REFERENCE:return Promise.resolve(this.toEsriSpatialReference(a))}var f=
{},l=[];Object.keys(a).forEach(function(e){l.push(b.toObject(a[e]).then(function(a){f[e]=a}))});return Promise.all(l)["return"](f)};f.prototype._fromGcxMapService=function(a){var b=this,e=a.serviceLayer,f={id:a.id,url:a.serviceUrl,opacity:a.opacity,visibility:a.isVisible(),layerType:this._getWebMapLayerType(e)};if(a.mapServiceFunction===d.essentials.MapServiceFunction.OPERATIONAL){f.title=a.displayName;f.minScale=Infinity===a.minScale?0:a.minScale;f.maxScale=a.maxScale;if(e instanceof esri.layers.ArcGISDynamicMapServiceLayer){f.capabilities=
e.capabilities;f.visibleLayers=e.visibleLayers.map(function(a){return parseInt(a)});var l=a.layers;e.dynamicLayerInfos&&(l=[],e.dynamicLayerInfos.forEach(function(b,e){var f=a.findLayerById(b.id.toString());f&&l.push(f)}));f.layers=l.map(function(a){return b.fromGcxLayer(a)})}else e instanceof esri.layers.WMSLayer?(f.visibleLayers=e.visibleLayers,f.type=g.OperationalLayerType.WMS):e instanceof esri.layers.KMLLayer?f.type=g.OperationalLayerType.KML:e instanceof esri.layers.FeatureLayer&&(f.layerDefinition=
this._getWebMapLayerDefinitionFromFeatureLayer(e),f.capabilities=e.capabilities,a.isUserCreated&&e.graphics&&e.graphics.length&&(f.featureCollection=this._esriFeatureLayerToFeatureCollection(e),f.featureCollection.showLegend=a.layers[0].includeInLegend));e instanceof esri.layers.GraphicsLayer&&e.renderer instanceof esri.renderer.HeatmapRenderer&&!f.featureCollection&&(f.layerDefinition=f.layerDefinition||{},f.layerDefinition.drawingInfo={renderer:this.fromEsriRenderer(e.renderer)})}else if(e instanceof
esri.virtualearth.VETiledLayer)f.type=f.layerType,delete f.url;else if(e instanceof esri.layers.WebTiledLayer)f.type=f.layerType,f.templateUrl=e.url,delete f.url;else if(e instanceof esri.layers.WMTSLayer){f.type=g.BaseMapType.WEB_TILED;if(!a.tileRestUrl)throw Error('WebMapConverter.fromGcxMapService: WMTS layers are only supported if the "tileRestUrl" property is set.');a.tileRestUrl&&!e.resourceUrls&&(e.resourceUrls=[{template:a.tileRestUrl}]);f.templateUrl=e._getTileUrlTemplate();delete f.url}return f};
f.prototype._esriFeatureLayerToFeatureCollection=function(a){var b=a.toJson().layerDefinition||{};return{layers:[{featureSet:{geometryType:a.geometryType,features:a.graphics.map(this.fromEsriGraphic,this)},layerDefinition:{displayField:b.displayField,fields:b.fields,geometryType:b.geometryType,hasAttachments:b.hasAttachments,minScale:b.minScale,maxScale:b.maxScale,name:b.name,objectIdField:b.objectIdField,templates:b.templates,type:b.type,typeIdField:b.typeIdField,types:b.types,drawingInfo:{renderer:this.fromEsriRenderer(a.renderer)}}}],
showLegend:!0}};f.prototype._fromGcxlayer=function(a){var b={name:a.wmsLayerName,title:a.displayName,layerUrl:a.getLayerUrl(),legendUrl:a.legendUrl},e=parseInt(a.id);isNaN(e)||void 0===e||(b.id=e);a=a.mapService.serviceLayer;a instanceof esri.layers.ArcGISDynamicMapServiceLayer&&(e=this._getWebMapLayerDefinitionFromDynamicLayer(a,e))&&(b.layerDefinition=e);return b};f.prototype._fromGcxFeatureSet=function(a){var b,e=a.esriFeatureSet;e?(b=g.GeometryType.fromEsriGeometryType(e.geometryType),!b&&e.features&&
0<e.features.length&&e.features[0].geometry&&(b=g.GeometryType.fromEsriGeometryType(e.features[0].geometry.type))):a.features.length&&(e=a.features.getAt(0),e.hasGeometry.get()&&(b=g.GeometryType.fromEsriGeometryType(e.esriFeature.get().geometry.type)));return{features:a.features.get().map(this.fromGcxFeature,this),geometryType:b||g.GeometryType.POINT}};f.prototype._fromEsriLayer=function(a){if(a instanceof esri.layers.FeatureLayer)return this._fromEsriFeatureLayer(a);if(a instanceof esri.layers.GraphicsLayer)return this._fromEsriGraphicsLayer(a);
throw Error("WebMapConverter.fromEsriLayer: Unsupported layer type.");};f.prototype._fromEsriGraphicsLayer=function(a){var e=this,f={id:"graphics-layer-"+a.id,title:a.id,visibility:a.visible,opacity:a.opacity,minScale:a.minScale,maxScale:a.maxScale},l={};a.graphics.forEach(function(f,c){var p=f.geometry.type,h=l[p];h||(h={featureSet:{features:[],geometryType:g.GeometryType.fromEsriGeometryType(p)},layerDefinition:{geometryType:g.GeometryType.fromEsriGeometryType(p),objectIdField:"__id",name:e.app.getResource("Mapping.Infrastructure",
"language-webmap-layer-name-"+p),fields:[{name:"__id",alias:"OBJECTID",type:d.essentials.EsriFieldTypes.esriFieldTypeOID,editable:!1,nullable:!1},{name:"__visible",alias:e.app.getResource("Mapping.Infrastructure","language-webmap-field-name-visible"),type:d.essentials.EsriFieldTypes.esriFieldTypeInteger,editable:!0,nullable:!1}],drawingInfo:{renderer:a.renderer?e.fromEsriRenderer(a.renderer):{type:g.RendererType.UNIQUE_VALUE,field1:"__symbolId",uniqueValueInfos:[{value:0,symbol:b}]}}}},l[f.geometry.type]=
h);p=e.fromEsriGraphic(f);p.attributes=p.attributes||{};p.attributes.__id=c;Object.keys(p.attributes).forEach(function(b){if("__symbolId"!==b&&"__symbol"!==b){var f=function(a){return m.firstOrDefault(h.layerDefinition.fields,function(b){return b.name===a})}(b);f||(f=e._inferAttributeType(a.graphics,b),f={name:b,alias:b,type:f,nullable:!0,editable:!0},h.layerDefinition.fields.push(f))}});if(!a.renderer){var k=h.layerDefinition.drawingInfo.renderer,t=p.attributes.__symbolId;t&&!m.firstOrDefault(k.uniqueValueInfos,
function(a){return a.value===t})&&k.uniqueValueInfos.push({value:t,symbol:p.attributes.__symbol})}h.featureSet.features.push(p)});f.featureCollection={layers:[],showLegend:!1};for(var c=0,h=Object.keys(l);c<h.length;c++)f.featureCollection.layers.push(l[h[c]]);return f};f.prototype._fromEsriFeatureLayer=function(b){var e={id:b.id,title:b.id,visibility:b.visible,opacity:b.opacity,minScale:b.minScale,maxScale:b.maxScale,layerType:a.FeatureLayer};b.url?e.url=b.url:e.featureCollection=this._esriFeatureLayerToFeatureCollection(b);
return e};f.prototype._fromEsriFeatureSet=function(a){return{features:a.features.map(this.fromEsriGraphic,this),geometryType:g.GeometryType.fromEsriGeometryType(a.geometryType)}};f.prototype._fromGcxFeature=function(a){var b=this,e={};a.attributes.get().forEach(function(a){e[a.name.get()]=b.fromObject(a.value.get())});return{attributes:e,geometry:this.fromEsriGeometry(a.esriFeature.get().geometry)}};f.prototype._fromEsriGraphic=function(a){var b={attributes:this.fromObject(a.attributes)||{},geometry:this.fromEsriGeometry(a.geometry)};
b.attributes.__visible=a.visible?1:0;a.symbol&&(b.attributes.__symbol=this._addSourceType(e.ESRI_SYMBOL,this.fromEsriSymbol(a.symbol)),a.symbol.__symbolId||(a.symbol.__symbolId=this._nextSymbolId++),b.attributes.__symbolId=a.visible?a.symbol.__symbolId:0);return b};f.prototype._fromEsriGeometry=function(a){var b={spatialReference:this.fromEsriSpatialReference(a.spatialReference)};switch(a.type){case "point":b.x=a.x;b.y=a.y;break;case "multipoint":b.points=a.points;case "polyline":b.paths=a.paths;
break;case "polygon":b.rings=a.rings;break;case "extent":b.xmin=a.xmin,b.xmax=a.xmax,b.ymin=a.ymin,b.ymax=a.ymax}return b};f.prototype._fromEsriSymbol=function(a){var b=a.toJson();a.size!==b.size&&(b.size=a.size);return b};f.prototype._fromEsriRenderer=function(a){var b=this,e=a.toJson();a instanceof esri.renderer.SimpleRenderer?e.symbol=this.fromEsriSymbol(a.symbol):a instanceof esri.renderer.UniqueValueRenderer?(e.defaultSymbol=this.fromEsriSymbol(a.defaultSymbol),e.uniqueValueInfos.forEach(function(e,
f){e.symbol=b.fromEsriSymbol(a.infos[f].symbol)})):a instanceof esri.renderer.ClassBreaksRenderer&&(e.defaultSymbol=this.fromEsriSymbol(a.defaultSymbol),e.classBreakInfos.forEach(function(e,f){e.symbol=b.fromEsriSymbol(a.infos[f].symbol)}));return e};f.prototype._fromEsriSpatialReference=function(a){return a.toJson()};f.prototype._fromEsriColor=function(a){return a.toRgba()};f.prototype._fromObject=function(a){if(a instanceof d.essentials.MapService)return this._addSourceType(e.GCX_MAP_SERVICE,this.fromGcxMapService(a));
if(a instanceof d.essentials.Layer)return this._addSourceType(e.GCX_LAYER,this.fromGcxLayer(a));if(a instanceof h.FeatureSet)return this._addSourceType(e.GCX_FEATURE_SET,this.fromGcxFeatureSet(a));if(a instanceof h.Feature)return this._addSourceType(e.GCX_FEATURE,this.fromGcxFeature(a));if(a instanceof esri.layers.Layer)return this._addSourceType(e.ESRI_LAYER,this.fromEsriLayer(a));if(a instanceof esri.tasks.FeatureSet)return this._addSourceType(e.ESRI_FEATURE_SET,this.fromEsriFeatureSet(a));if(a instanceof
esri.Graphic)return this._addSourceType(e.ESRI_GRAPHIC,this.fromEsriGraphic(a));if(a instanceof esri.geometry.Geometry)return this._addSourceType(e.ESRI_GEOMETRY,this.fromEsriGeometry(a));if(a instanceof esri.symbol.Symbol)return this._addSourceType(e.ESRI_SYMBOL,this.fromEsriSymbol(a));if(a instanceof esri.renderer.Renderer)return this._addSourceType(e.ESRI_RENDERER,this.fromEsriRenderer(a));if(a instanceof esri.SpatialReference)return this._addSourceType(e.ESRI_SPATIAL_REFERENCE,this.fromEsriSpatialReference(a));
var b={},f;for(f in a)a.hasOwnProperty(f)&&"function"!==typeof a[f]&&"__symbolId"!==f&&(b[f]=this.fromObject(a[f]));return b};return f}();g.WebMapConverter=f})(h.webMap||(h.webMap={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var m=d.framework.utils.ArrayUtils;g.PROPERTY_MEASUREMENT_ID="measurementId";g.PROPERTY_HIGHLIGHT_ID="__gcxHlId";var c=function(b){function a(){b.apply(this,arguments);this._exclusionCache={}}__extends(a,b);a.prototype.exclude=function(a,b){var l=this._exclusionCache[b];l||(l=this._exclusionCache[b]=[]);l.push(a)};a.prototype.clearExclusionCache=function(){this._exclusionCache={}};a.prototype.clearCache=function(){b.prototype.clearCache.call(this);
this.clearExclusionCache()};a.prototype.fromGcxMapService=function(a){return b.prototype.fromGcxMapService.call(this,a)};a.prototype.fromGcxLayer=function(a){return b.prototype.fromGcxLayer.call(this,a)};a.prototype.fromGcxFeatureSetCollection=function(a){return this._convert(a,"projectFeatureSetCollection",this._fromGcxFeatureSetCollection)};a.prototype.fromGcxFeatureSet=function(a){return b.prototype.fromGcxFeatureSet.call(this,a)};a.prototype.fromEsriFeatureSet=function(a){return b.prototype.fromEsriFeatureSet.call(this,
a)};a.prototype.fromEsriLayer=function(a){return b.prototype.fromEsriLayer.call(this,a)};a.prototype.fromGcxFeature=function(a){return b.prototype.fromGcxFeature.call(this,a)};a.prototype.fromEsriGraphic=function(a){return b.prototype.fromEsriGraphic.call(this,a)};a.prototype.toGcxFeatureSetCollection=function(a){return Promise.resolve(this._convert(a,"gcxFeatureSetCollection",this._toGcxFeatureSetCollection))};a.prototype._canCreateGcxLayer=function(a,b){return!!a.gcxLayerDefinition};a.prototype._canCreateGcxMapService=
function(a){return!!a.gcxMapServiceDefinition};a.prototype._createGcxMapService=function(a){var f=this;return Promise["try"](function(){if(b.prototype._canCreateGcxMapService.call(f,a))return b.prototype._createGcxMapService.call(f,a);var l=f._getMapServiceDefinition(a);return l?(l.layers=a.layers.map(function(a){return a.gcxLayerDefinition}).filter(function(a){return null!=a}),d.essentials.utilities.ServiceDiscoveryUtilities.buildMapService(f.app.site.essentialsMap,l).then(function(a){f.app.site.essentialsMap.addMapService(a);
return a})):Promise.reject(Error("ProjectConverter._createGcxMapService: Unsupported service layer type."))}).then(function(b){b instanceof h.LayerIntegrationUtils.LocalFeatureLayerService&&a.layers&&a.layers[0]&&a.layers[0].gcxLayerDefinition&&b.layers[0].createFromDefinition(a.layers[0].gcxLayerDefinition);return b})};a.prototype._createGcxLayer=function(a,b){var l=this,c=a.gcxLayerDefinition;if(c&&c.catalogId)return new Promise(function(a,e){var d={catalogId:c.catalogId,callback:function(b){b&&
a(b);e(Error("ProjectConverter._createGcxLayer: Unsupported layer catalog id."))},gcxLayerDefinition:c,mapService:b};l.app.waitUntilAllLibrariesLoaded().then(function(){l.app.command("RestoreDynamicLayer").execute(d)})});var r=new d.essentials.Layer(c.url);r.createFromDefinition(c);b.add(r);r.isUserCreated=!0;return Promise.resolve(r)};a.prototype._getMapServiceDefinition=function(a){return a.gcxMapServiceDefinition};a.prototype._getWebMapLayerDefinitionFromDynamicLayer=function(a,f){var l=b.prototype._getWebMapLayerDefinitionFromDynamicLayer.call(this,
a,f);a.layerDrawingOptions&&a.layerDrawingOptions[f]&&(l.drawingInfo.showLabels=a.layerDrawingOptions[f].showLabels,l.drawingInfo.labelingInfo=a.layerDrawingOptions[f].labelingInfo);return l};a.prototype._applyDynamicLayerInfo=function(a,b,l){var c=l.mapService.serviceLayer,d=parseInt(l.id);l.mapService.convertToDynamicLayers();l=c.dynamicLayerInfos||[];var g=l.filter(function(a){return a.id===d})[0];g?(a=l.indexOf(g),a!=b&&l.splice(b,0,l.splice(a,1)[0])):(g=new esri.layers.DynamicLayerInfo,g.id=
d,g.name=a.name,a.layerDefinition&&(g.minScale=a.layerDefinition.minScale,g.maxScale=a.layerDefinition.maxScale),l.splice(b,0,g));c.setDynamicLayerInfos(l)};a.prototype._applyDrawingInfo=function(a,f){var l=this;return a?b.prototype._applyDrawingInfo.call(this,a,f).then(function(){var b=a.clustering&&(a.clustering.enabled||"undefined"===typeof a.clustering.enabled);l.app.command("RemoveClusterLayer").execute({gcxLayer:f.layers[0]});f.featureClustering&&f.featureClustering.userCanToggle&&a.clustering&&
(f.featureClustering.radius=a.clustering.radius,f.featureClustering.backgroundColor=a.clustering.backgroundColor,f.featureClustering.labelColor=a.clustering.labelColor,f.featureClustering.maximumFeatures=a.clustering.maximumFeatures);b?l.app.command("AddClusterLayer").execute({gcxLayer:f.layers[0]}):(b=f.serviceLayer,b.setRenderer(l.toEsriRenderer(a.renderer)),b.redraw())}):Promise.resolve()};a.prototype._setGraphicsLayerRenderer=function(a,b){};a.prototype._applyWebMapLayerToGcxLayer=function(a,
f,l){var c=this;return b.prototype._applyWebMapLayerToGcxLayer.call(this,a,f,l).then(function(b){for(var g=l.mapService.serviceLayer,h=0,m=l.styles;h<m.length;h++){var k=m[h];k.enabled=!1}a.layerStyleId&&(k=l.styles.filter(function(b){return b.id===a.layerStyleId})[0],h=void 0,g instanceof esri.layers.ArcGISDynamicMapServiceLayer?h=JSON.stringify(c.toEsriRenderer(a.layerDefinition.drawingInfo.renderer).toJson()):g instanceof esri.layers.FeatureLayer&&(h=JSON.stringify(c.toEsriRenderer(a.serviceLayer.layerDefinition.drawingInfo.renderer).toJson())),
k?(h&&k.setRenderer(h),k.enabled=!0):h&&l.styles.push(new d.essentials.LayerStyle(h,a.layerStyleId,a.layerStyleId,!0)));return a.isDynamic&&g instanceof esri.layers.ArcGISDynamicMapServiceLayer?c.app.waitUntilServiceLayerLoaded(g).then(function(){c._applyDynamicLayerInfo(a,f,l);return b}):b})};a.prototype._toGcxLayer=function(a,f){f||(f=a.serviceLayer);return b.prototype._toGcxLayer.call(this,a,f)};a.prototype._toGcxFeatureSetCollection=function(a){var b=this,l=this.app.featureSetManager.featureSetCollections.get().filter(function(b){return b.id===
a.id})[0];l||(l=new h.FeatureSetCollection,l.id=a.id,this.app.featureSetManager.addCollection(l));l.displayName.set(a.displayName);l.sourceName=a.sourceName;var c='feature set collection "{0}"'.format(a.id);return h.PromiseUtils.mapSkipRejected(a.featureSets,function(a){return h.PromiseUtils.warnOnReject(b.toGcxFeatureSet(a),b.app,'Unable to restore feature set "{0}" for {1}: {{0}}'.format(a.id,c))}).then(function(a){l.clear();l.featureSets.addItems(a)}).then(function(){return h.PromiseUtils.warnOnReject(b.toObject(a.tag),
b.app,"Unable to restore tag for {0}: {{0}}".format(c))}).then(function(a){l.tag=a}).then(function(){return b._toGcxExtendedProperties(a.extendedProperties,c)}).then(function(a){l.extendedProperties.addItems(a)}).then(function(){return l})};a.prototype._toGcxFeatureSet=function(a){var b=this,l,c=a.layer,d=a.features||[],g={gcxLayer:this.toGcxLayer(c,c?c.serviceLayer:null),esriFeatureSet:this.toEsriFeatureSet(a),extendedProperties:this._toGcxExtendedProperties(a.extendedProperties,"feature set")};
return Promise.props(g).then(function(d){l=new h.FeatureSet({app:b.app,layer:d.gcxLayer,esriFeatureSet:d.esriFeatureSet,allowUnsafeContent:b.app.configuration&&b.app.configuration.allowUnsafeContent&&a.allowUnsafeContent});c||(l.loadAttributes(),l.displayName.set(a.displayName),l.iconUri.set(a.iconUri));l.id=a.id;l.extendedProperties.addItems(d.extendedProperties)}).then(function(){return h.PromiseUtils.mapSkipRejected(d,function(a){return b._findMatchingGcxFeature(a,l).then(function(e){return b._applyFeatureToGcxFeature(a,
e)})})}).then(function(){b.app.waitUntilAllLibrariesLoaded().then(function(){l.dataLinksState===h.DataLinksState.Unresolved&&l.resolveDataLinks(function(a){b.app.event("FeatureChangedEvent").publish(a)})})}).then(function(){return l})};a.prototype._toGcxFeature=function(a){var b=this;return a.featureSet?this.toGcxFeatureSet(a.featureSet).then(function(l){return b._findMatchingGcxFeature(a,l)}).then(function(b){if(!b)throw Error('Unable to restore feature with ID "{0}": feature no longer exists.'.format(a.id));
return b}):this._createGcxFeature(a)};a.prototype._createGcxFeature=function(a){var b=this,l=a.layer,l={gcxLayer:this.toGcxLayer(l,l?l.serviceLayer:null),featureLayer:l?null:this.toEsriLayer(a.featureLayer),graphic:this.toEsriGraphic(a),extendedProperties:this._toGcxExtendedProperties(a.extendedProperties,"feature")};return Promise.props(l).then(function(l){var c={layer:l.gcxLayer,featureLayer:l.featureLayer,graphic:l.graphic,allowUnsafeContent:b.app.configuration&&b.app.configuration.allowUnsafeContent&&
a.allowUnsafeContent},c=a[h.isKmlProperty]?new h.KmlFeature(c):new h.Feature(c);c.defaultDateFormat=a.defaultDateFormat||h.DateFormat.DEFAULT;c.defaultNumberFormat=a.defaultNumberFormat||h.NumberFormat.DEFAULT;c.timeZoneId=a.timeZoneId;c.displayTimeZoneId=a.displayTimeZoneId;c.borderColor.set(a.borderColor);c.fillColor.set(a.fillColor);c.borderWidth.set(a.borderWidth);c.extendedProperties.addItems(l.extendedProperties);return c})};a.prototype._applyFeatureToGcxFeature=function(a,b){if(!a||!b)return Promise.resolve();
b.defaultDateFormat=a.defaultDateFormat||h.DateFormat.DEFAULT;b.defaultNumberFormat=a.defaultNumberFormat||h.NumberFormat.DEFAULT;b.timeZoneId=a.timeZoneId;return this._toGcxExtendedProperties(a.extendedProperties,"feature").then(function(a){return b.extendedProperties.addItems(a)})};a.prototype._findMatchingGcxFeature=function(a,b){return a.id?Promise.resolve(b.findFeatureById(a.id)):this.toEsriGraphic(a).then(function(a){return m.firstOrDefault(b.features.get(),function(b){return b.esriFeature.get()===
a})})};a.prototype._queryFeatures=function(a,b){var l=this;return a&&a.length&&b&&b.layer?Promise["try"](function(){for(var c=a.map(function(a){return a.id}),d=[];1E3<c.length;)d.push(c.splice(0,1E3));d.push(c);c=b.layer;return l.toGcxLayer(c,c?c.serviceLayer:null).then(function(a){if(!a||!a.getObjectIdFieldName())throw Error('Cannot restore features for layer "{0}": no primary key field defined.'.format(a?a.name:""));a.getObjectIdFieldName();var b=h.taskUtils.getQueryTask(a);return h.PromiseUtils.mapSkipRejected(d,
function(a){var e=new esri.tasks.Query;e.objectIds=a.map(function(a){return h.FormatUtils.parseNumber(a)});e.returnGeometry=!0;e.outFields=["*"];return b.execute(e).then(function(a){return a.features})},{concurrency:2}).then(function(a){return m.flatten(a)})})}):Promise.resolve([])};a.prototype._toEsriGraphic=function(a){return b.prototype._toEsriGraphic.call(this,a).then(function(b){a.hasOwnProperty(g.PROPERTY_MEASUREMENT_ID)&&(b[g.PROPERTY_MEASUREMENT_ID]=a[g.PROPERTY_MEASUREMENT_ID]);a.hasOwnProperty(h.coordinates.coordinateIdentifierProperty)&&
(b[h.coordinates.coordinateIdentifierProperty]=a[h.coordinates.coordinateIdentifierProperty]);a.hasOwnProperty(h.isKmlProperty)&&(b[h.isKmlProperty]=a[h.isKmlProperty]);a.hasOwnProperty(g.PROPERTY_HIGHLIGHT_ID)&&(b[g.PROPERTY_HIGHLIGHT_ID]=a[g.PROPERTY_HIGHLIGHT_ID]);return b})};a.prototype._toEsriFeatureSet=function(a){var b=this,l=a.layer,c=l?l.serviceLayer:null,r=a.features||[],g=r.filter(function(a){return!d.framework.utils.isNullOrUndefined(a.id)}),r=r.filter(function(a){return d.framework.utils.isNullOrUndefined(a.id)});
a={gcxLayer:this.toGcxLayer(l,c),queryResults:this._queryFeatures(g,a),rehydratedGraphics:h.PromiseUtils.mapSkipRejected(r,function(a){return b.toEsriGraphic(a)})};return Promise.props(a).then(function(a){a=a.queryResults.concat(a.rehydratedGraphics);var b=new esri.tasks.FeatureSet;b.features=a;return b})};a.prototype._fromGcxMapService=function(a){var f=this;if(0<=(this._exclusionCache[h.webMap.ConversionType.GCX_MAP_SERVICE]||[]).indexOf(a))throw Error("ProjectConverter.fromGcxMapService: Services added through layer addition dialog are only supported if they have been whitelisted by your administrator.");
var l;l=a&&a.serviceLayer instanceof esri.layers.WMTSLayer&&!a.tileRestUrl?{id:a.id,url:a.serviceUrl,type:h.webMap.BaseMapType.WEB_TILED,opacity:a.opacity,visibility:a.isVisible(),layers:[]}:b.prototype._fromGcxMapService.call(this,a);a.isUserCreated&&(l.gcxMapServiceDefinition=a.toJson(),l.isUserCreated=a.isUserCreated,l.userLayerType=a.userLayerType);l.layers||(l.layers=h.ArrayUtils.mapWithErrorCallback(a.layers,function(a){return f.fromGcxLayer(a)},function(a,b){console.warn('Unable to convert layer "{0}": {1}'.format(a.id,
b))}));if(a.featureClustering){var c=void 0;this._isFeatureCollection(l)?(l.featureCollection.layers[0].layerDefinition=l.featureCollection.layers[0].layerDefinition||{drawingInfo:{}},c=l.featureCollection.layers[0].layerDefinition):(l.layerDefinition=l.layerDefinition||{drawingInfo:{}},c=l.layerDefinition);c.drawingInfo=c.drawingInfo||{};c.drawingInfo.clustering={radius:a.featureClustering.radius,backgroundColor:a.featureClustering.backgroundColor,labelColor:a.featureClustering.labelColor,maximumFeatures:a.featureClustering.maximumFeatures,
enabled:a.featureClustering.enabled};if(a=this.app.map.getLayer(a.id+"-cluster"))c.drawingInfo.renderer=this.fromEsriRenderer(a.featureLayerRenderer)}return l};a.prototype._fromGcxlayer=function(a){if(0<=(this._exclusionCache[h.webMap.ConversionType.GCX_MAP_SERVICE]||[]).indexOf(a.mapService))throw Error("ProjectConverter.fromGcxLayer: Services added through layer addition dialog are only supported if they have been whitelisted by your administrator.");var f=b.prototype._fromGcxlayer.call(this,a);
f.serviceLayer=this.fromGcxMapService(a.mapService);var l=a.mapService.serviceLayer;f.isDynamic=a.isDynamic;l instanceof esri.layers.ArcGISDynamicMapServiceLayer&&l.supportsDynamicLayers&&(f.isDynamic=f.isDynamic||l.dynamicLayerInfos&&!!l.dynamicLayerInfos[parseInt(a.id)]);a.isUserCreated&&(f.gcxLayerDefinition=a.toJson(),f.isUserCreated=a.isUserCreated,f.userLayerType=a.userLayerType);if(a=a.styles.filter(function(a){return a.enabled})[0])f.layerStyleId=a.id;return f};a.prototype._fromGcxFeatureSetCollection=
function(a){var b={id:a.id,displayName:a.displayName.get(),featureSets:a.featureSets.get().map(this.fromGcxFeatureSet,this),sourceName:a.sourceName,tag:this.fromObject(a.tag)};a.extendedProperties.getLength()&&(b.extendedProperties=this._fromGcxExtendedProperties(a.extendedProperties));return b};a.prototype._fromGcxFeatureSet=function(a){var f=b.prototype._fromGcxFeatureSet.call(this,a);f.id=a.id;f.layer=this.fromGcxLayer(a.layer);f.allowUnsafeContent=a._allowUnsafeContent;a.layer||(f.displayName=
a.displayName.get(),f.iconUri=a.iconUri.get());return f};a.prototype._fromGcxFeature=function(a){var f={};this._canRequeryFeatureData(a)?f={id:a.id.get(),featureSet:this.fromGcxFeatureSet(a.featureSet)}:(f=b.prototype._fromGcxFeature.call(this,a),f.featureSet=this.fromGcxFeatureSet(a.featureSet));f.featureSet||(f.layer=this.fromGcxLayer(a.layer));a.featureLayer&&!a.layer&&(f.featureLayer=this.fromEsriLayer(a.featureLayer));f.allowUnsafeContent=a._allowUnsafeContent;a.borderColor.get()&&(f.borderColor=
a.borderColor.get());a.fillColor.get()&&(f.fillColor=a.fillColor.get());0<=a.borderWidth.get()&&(f.borderWidth=a.borderWidth.get());a.extendedProperties.getLength()&&(f.extendedProperties=this._fromGcxExtendedProperties(a.extendedProperties));a.defaultDateFormat!==h.DateFormat.DEFAULT&&(f.defaultDateFormat=a.defaultDateFormat);a.defaultNumberFormat!==h.NumberFormat.DEFAULT&&(f.defaultNumberFormat=a.defaultNumberFormat);var l=a.esriFeature.get();l&&l.hasOwnProperty(h.isKmlProperty)&&(f[h.isKmlProperty]=
l[h.isKmlProperty]);a.timeZoneId&&(f.timeZoneId=a.timeZoneId);a.displayTimeZoneId&&f.displayTimeZoneId;return f};a.prototype._fromEsriGraphic=function(a){var f=b.prototype._fromEsriGraphic.call(this,a);a.hasOwnProperty(g.PROPERTY_MEASUREMENT_ID)&&(f[g.PROPERTY_MEASUREMENT_ID]=a[g.PROPERTY_MEASUREMENT_ID]);a.hasOwnProperty(h.coordinates.coordinateIdentifierProperty)&&(f[h.coordinates.coordinateIdentifierProperty]=a[h.coordinates.coordinateIdentifierProperty]);a.hasOwnProperty(h.isKmlProperty)&&(f[h.isKmlProperty]=
a[h.isKmlProperty]);a.hasOwnProperty(g.PROPERTY_HIGHLIGHT_ID)&&(f[g.PROPERTY_HIGHLIGHT_ID]=a[g.PROPERTY_HIGHLIGHT_ID]);return f};a.prototype._toGcxExtendedProperties=function(a,b){var l=this;a=a||{};return h.PromiseUtils.mapSkipRejected(Object.keys(a),function(c){var d=l.toObject(a[c]).then(function(a){return{name:c,value:a}});return h.PromiseUtils.warnOnReject(d,l.app,"Unable to restore extended property '{0}' for {1}: {{0}}".format(c,b))})};a.prototype._fromGcxExtendedProperties=function(a){var b=
this,l={};a.get().forEach(function(a){l[a.name]=b.fromObject(a.value)});return l};a.prototype._canRequeryFeatureData=function(a){return a&&!a.isModified&&!d.framework.utils.isNullOrUndefined(a.id.get())&&""!==a.id.get()&&a.featureSet&&a.featureSet.layer&&(a.featureSet.layer.getLayerUrl()&&a.featureSet.layer.supportsQuery||!String.isNullOrEmpty(a.featureSet.layer.catalogId))};return a}(h.webMap.WebMapConverter);g.ProjectConverter=c})(h.project||(h.project={}))})(k.infrastructure||(k.infrastructure=
{}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){var q=k.mapping.infrastructure.FormatUtils,h=function(g){function h(c,b,a,e){g.call(this,c,b,a,e);this.version=d.essentialsHtmlViewer.version;this.markupLayer=new Observable;this.isArcGisWebApp=!1;this._workflowActivityDispatcher=null;this._activityTypeHandlerQueue=[];this._activityIdHandlerQueue=[];this._localeResourcesLoaded=!1;this._initialProjectPromise=null;this._momentLocales="af ar ar-MA ar-SA ar-TN az be bg bn bo br bs ca cs cv cy da de de-AT el en-AU en-CA en-GB eo es et eu fa fi fo fr fr-CA fy gl he hi hr hu hy-AM id is it ja jv ka km ko lb lt lv me mk ml mr ms ms-MY my nb ne nl nn pl pt pt-BR ro ru si sk sl sq sr sr-Cyrl sv ta th tl-PH tr tzl tzm tzm-Latn uk uz vi zh-CN zh-TW".split(" ");
this._globalizeLocales="af ar ar-MA ar-SA ar-TN az be bg bn bo br bs ca cs cy da de de-AT el en en-AU en-CA en-GB eo es et eu fa fi fo fr fr-CA fy gl he hi hr hu hy id is it ja ka km ko lb lt lv mk ml mr ms my nb ne nl nn pl pt ro ru si sk sl sq sr sr-Cyrl sv ta th tr tzm tzm-Latn uk uz vi zh".split(" ");this.___uaIsiPad=!!navigator.userAgent.match(/iPad/i);this.accessibilityManager=new d.essentialsHtmlViewer.mapping.infrastructure.accessibility.AccessibilityManager(this);this.coordinatesManager=
new d.essentialsHtmlViewer.mapping.infrastructure.coordinates.CoordinatesManager(this);this.featureSetManager=new d.essentialsHtmlViewer.mapping.infrastructure.FeatureSetManager(this);this.searchManager=new d.essentialsHtmlViewer.mapping.infrastructure.search.SearchManager(this);this.highlightManager=new d.essentialsHtmlViewer.mapping.infrastructure.HighlightManager(this);this.nativeManager=new k.mapping.infrastructure.nativeIntegration.NativeManager(this);this.offlineManager=new k.mapping.infrastructure.offline.OfflineManager(this,
"Mapping.Infrastructure");this.toolRegistry=new d.essentialsHtmlViewer.mapping.infrastructure.tools.ToolRegistry(this);this.menuRegistry=new d.essentialsHtmlViewer.mapping.infrastructure.menus.MenuRegistry(this);this.toolbarGroupRegistry=new d.essentialsHtmlViewer.mapping.infrastructure.toolbarGroup.ToolbarGroupRegistry(this);this.stateManager=new d.essentialsHtmlViewer.mapping.infrastructure.applicationState.StateManager(this,"Mapping.Infrastructure");this.undoManager=new d.essentialsHtmlViewer.mapping.infrastructure.undo.UndoManager(this);
this.project=new k.mapping.infrastructure.project.ProjectManager(this);this.webMap=new k.mapping.infrastructure.webMap.WebMapManager(this);this.bookmarks=new k.mapping.infrastructure.BookmarkManager(this);this._applicationContentPolicy=new k.mapping.infrastructure.ContentPolicy(this);this._registerApplicationLevelCommands()}__extends(h,g);Object.defineProperty(h.prototype,"defaultContentPolicy",{get:function(){return this._applicationContentPolicy},enumerable:!0,configurable:!0});h.prototype.followNavigationLink=
function(c){var b=c.element;if(this._applicationContentPolicy.tryScreenNavLinkSynchronously({uri:c.url,attribute:"href",tag:"a",type:k.mapping.infrastructure.FilterUtils.UriType.NavigableLink,linkChallengeCallback:function(a,e){if(a){var f="_blank";b&&b.hasAttribute("target")&&(f=b.getAttribute("target"));window.open(e.uri,f)}return!1}}))return!0;this._executeOpenWebPage(c);return!1};h.prototype._registerApplicationLevelCommands=function(){this.command("OpenWebPage").register(this,this._executeOpenWebPage)};
h.prototype._executeOpenWebPage=function(c){var b="string"===typeof c?c:c.url,a="string"===typeof c?null:c.element?c.element:null;("string"===typeof c?0:c.isLink&&c.isLink)||(b=decodeURIComponent(b));c=new dojo._Url(b);if(0>"http https ftp ftps gopher mailto".split(" ").indexOf(c.scheme))this.trace.warning("Could not open '"+b+"': Invalid URI scheme.");else{var e=function(a,b){var e="_blank";b&&b.hasAttribute("target")&&(e=b.getAttribute("target"));window.open(a,e)},b={uri:b,attribute:"href",tag:"a",
type:k.mapping.infrastructure.FilterUtils.UriType.NavigableLink,linkChallengeCallback:function(b,l){b&&e(l.uri,a);return!1}};if(this._applicationContentPolicy.hasFlag(1)||this._applicationContentPolicy.tryScreenNavLinkSynchronously(b))return e(b.uri,a),!1;b.forcePrompt=!0;this._applicationContentPolicy.screenUris([b])}};h.prototype.initialize=function(){var c=this;document.all&&!document.querySelector&&(this.debugMode=!0);var b=this.configUri?this.configUri.split("/"):window.location.href.split("/"),
b=b.slice(0,b.length-1).join("/")+"/";this.configTokens.ViewerConfigUri=b;this.getUrlParameter("gcxLocalServer")&&(this.localServerAddress=this.getUrlParameter("gcxLocalServer"));this.getUrlParameter("gcxLocalServerNamespace")&&(this.localServerNamespace=this.getUrlParameter("gcxLocalServerNamespace"));this.getUrlParameter("gcxLocalServerToken")&&(this.localServerToken=this.getUrlParameter("gcxLocalServerToken"));this.offlineManager.load();g.prototype.initialize.call(this);var a=this.getUrlParameter(k.mapping.infrastructure.project.PROJECT_QUERY_STRING_KEY);
if(a){var e=this.getUrlParameter(d.essentials.documents.LINK_QUERY_STRING_KEY);e&&this.waitUntilSiteInitialized().then(function(){return c.site.documentStore.setGuestLink(e)});this.waitUntilAllLibrariesLoaded().then(function(){return c.event("ProjectLoadingEvent").publish(a)});this._initialProjectPromise=this.project.read(a).then(function(a){return c.project._beginLoad(a)})["catch"](function(a){c.trace.error("Error loading project: {0}".format(a.message),a)});var f=this.initialStateAppliedCallback;
this.initialStateAppliedCallback=function(a){c.project.isLoading&&c.project._finishLoad();f&&f(a)}}};h.prototype.waitUntilSiteInitialized=function(){var c=this;return new Promise(function(b,a){c.site&&c.site.isInitialized?b():(c.event("SiteInitializedEvent").once(c,function(a){b()}),c.event("SiteInitializationFailedEvent").once(c,function(b){a(b)}),c.event("SiteAuthorizationFailedEvent").once(c,function(b){a(b)}))})};h.prototype.waitUntilDocumentStoreInitialized=function(){var c=this;return this.waitUntilSiteInitialized().then(function(){return c.site.documentStore.onInitialized()})};
h.prototype.waitUntilMapLoaded=function(){var c=this;return new Promise(function(b,a){if(c.map&&c.map.loaded)b();else if(c.map)var e=c.map.on("load",function(a){e.remove();b()});else c.event("SiteInitializingEvent").once(c,function(){var a=c.map.on("load",function(e){a.remove();b()})})})};h.prototype.waitUntilServiceLayerLoaded=function(c){return new Promise(function(b,a){if(c.loadError)a(c.loadError);else if(c.loaded)b();else var e=c.on("load",function(a){e.remove();f.remove();b()}),f=c.on("error",
function(b){e.remove();f.remove();a(b.error)})})};h.prototype.waitUntilSiteServiceLayersLoaded=function(){var c=this;return new Promise(function(b,a){c.site&&c.site.serviceLayersLoaded?b():(c.event("SiteServiceLayersLoadedEvent").once(c,function(a){b()}),c.event("SiteInitializationFailedEvent").once(c,function(b){a(b)}),c.event("SiteAuthorizationFailedEvent").once(c,function(b){a(b)}))})};h.prototype.waitUntilAllLibrariesLoaded=function(){var c=this;return new Promise(function(b,a){if(c.allLibrariesLoaded)b();
else c.event("ViewerLibrariesDownloadedEvent").once(c,function(a){b()})})};h.prototype.waitUntilViewInitialized=function(c){var b=this;return new Promise(function(a,e){var f=b.viewManager.getViewById(c);if(f&&f.initiallyBound)a(f);else var l=b.event("ViewInitializedEvent").subscribe(b,function(e){e.id===c&&(a(e),b.event("ViewInitializedEvent").unsubscribe(l))})})};h.prototype.registerActivityTypeHandler=function(c,b){this._workflowActivityDispatcher?this._workflowActivityDispatcher.registerActivityHandler(c,
b):this._activityTypeHandlerQueue.push({typeName:c,handler:b})};h.prototype.registerActivityIdHandler=function(c,b){this._workflowActivityDispatcher?this._workflowActivityDispatcher.registerExternalIdHandler(c,b):this._activityIdHandlerQueue.push({id:c,handler:b})};h.prototype.getWorkflowActivityDispatcher=function(){return this._workflowActivityDispatcher};h.prototype.setWorkflowActivityDispatcher=function(c){this._workflowActivityDispatcher=c;for(c=0;c<this._activityTypeHandlerQueue.length;++c){var b=
this._activityTypeHandlerQueue[c];this._workflowActivityDispatcher.registerActivityHandler(b.typeName,b.handler)}for(c=this._activityTypeHandlerQueue.length=0;c<this._activityIdHandlerQueue.length;++c)b=this._activityIdHandlerQueue[c],this._workflowActivityDispatcher.registerExternalIdHandler(b.id,b.handler);this._activityIdHandlerQueue.length=0};h.prototype.shutdown=function(c){this.toolRegistry.clear();this.undoManager.destroy();g.prototype.shutdown.call(this,c)};h.prototype.onConfigurationLoaded=
function(c){var b=this,a=c.configuration,e=!0;if(a.hasOwnProperty("application")&&a.application.hasOwnProperty("contentPolicy")){var f=a.application.contentPolicy;f.disableSecurityPrompt&&this._applicationContentPolicy.setFlag(1);!1===f.disablePromptOnImages&&(e=!1);!0===f.trustExactUrl&&this._applicationContentPolicy.setFlag(4)}e&&this._applicationContentPolicy.setFlag(2);this._applicationContentPolicy.screenUris([]);a&&a.hasOwnProperty("application")&&a.application.locale&&(this.locale=a.application.locale);
this.urlParameters&&this.getUrlParameter("locale")&&(this.locale=this.getUrlParameter("locale"));document.documentElement.setAttribute("lang",this.locale||"en-US");this._loadThirdPartyLocaleResources().then(function(){if($&&$.timepicker){var e=Object.getPrototypeOf($.timepicker);e._onTimeChange&&(e._base_onTimeChange=e._onTimeChange,e._onTimeChange=function(){this._base_onTimeChange();if(this._defaults&&this._defaults.gcxTimeFormat&&this.$timeObj){var a=q.formatDate($(this.$input).datepicker("getDate"),
this._defaults.gcxTimeFormat);this.$timeObj.text(a)}this._defaults&&!0===this._defaults.gcxTimeStyle&&((a=this.$timeObj?this.$timeObj.prevObject:null)&&1!==$(".info-message",a).length&&a.append("<div class='info-message'></div>"),a=a?$(".info-message",a):null)&&(a.text(this._defaults.timeText+": "+this.$timeObj.text()),this.$timeObj.css("display","none"),$(this.$timeObj.selector+"_label").css("display","none"))})}$&&$.datepicker&&$.datepicker._showDatepicker&&($.datepicker.__base_showDatepicker=$.datepicker._showDatepicker,
$.datepicker._showDatepicker=function(a){this.__base_showDatepicker(a);a=$(a).siblings(".gcxDatepicker");a.length&&a.focus()});a.hasOwnProperty("application")&&a.application.hasOwnProperty("geometryServiceUrl")&&(esri.config.defaults.geometryService=new esri.tasks.GeometryService(a.application.geometryServiceUrl));a.hasOwnProperty("application")&&a.application.hasOwnProperty("datumTransforms")?k.mapping.infrastructure.GeometryUtils.registerDatumTransforms(a.application.datumTransforms):k.mapping.infrastructure.GeometryUtils.registerDefaultDatumTransforms();
c.configuration.application&&c.configuration.application.oAuth2ClientId&&!d.essentials.OAuth2Client.applicationHasImplicitGrant()&&!d.essentials.OAuth2Client.applicationHasImplicitGrantError()?(d.essentials.OAuth2Client.redirectToLogOnPage(c.configuration.application.oAuth2AuthorizeUri||"http://www.arcgisonline.com/sharing/oauth2/authorize",c.configuration.application.oAuth2ClientId),b.abortInitialization=!0):g.prototype.onConfigurationLoaded.call(b,c)})};h.prototype.getInitialState=function(c,b){var a=
this;return!this._initialProjectPromise||this._initialProjectPromise.isRejected()?Promise.resolve(null):this._initialProjectPromise.then(function(){var b=a.project.current;return b&&b.content&&b.content.moduleState?b.content.moduleState[c]:null})};Object.defineProperty(h.prototype,"locale",{get:function(){return this._locale},set:function(c){this._locale=this._canonicalizeLocale(c);this._localeResourcesLoaded&&(moment.locale(this._getMomentLocaleForLocale(this._locale)),_globalize.locale(this._getGlobalizeLocaleForLocale(this._locale)))},
enumerable:!0,configurable:!0});h.prototype.doWhenMapInitialized=function(c){var b=this;if(this.isArcGisWebApp)c();else if(this.site&&this.site.isInitialized)c();else var a=this.eventRegistry.event("SiteServiceLayersLoadedEvent").subscribe(this,function(){b.eventRegistry.event("SiteServiceLayersLoadedEvent").unsubscribe(a);c()})};h.prototype._loadThirdPartyLocaleResources=function(){var c=this,b;"function"===typeof define&&(b=define.amd,delete define.amd);return Promise.all([this._loadMomentLocaleData(),
this._loadGlobalizeLocaleData()]).then(function(){"function"===typeof define&&(define.amd=b);c._localeResourcesLoaded=!0},function(a){"function"===typeof define&&(define.amd=b)})};h.prototype._loadMomentLocaleData=function(){var c=this,b=this._getMomentLocaleForLocale(this.locale);return moment.localeData(b)?Promise.resolve():new Promise(function(a,e){"en"===b?a():c.includeScript("./Resources/Scripts/moment/locale/"+b+".js",function(e){moment.locale(b);a()},e)})};h.prototype._loadGlobalizeLocaleData=
function(){var c=this._getGlobalizeLocaleForLocale(this.locale);return this.fetchConfigResource({url:"./Resources/Scripts/globalize/locale/"+c+".json"}).then(function(b){b=JSON.parse(b);_globalize.load(b);_globalize.locale(c)})};h.prototype._getMomentLocaleForLocale=function(c){return this._getBestMatchLocale(c,this._momentLocales)};h.prototype._getGlobalizeLocaleForLocale=function(c){return this._getBestMatchLocale(c,this._globalizeLocales)};h.prototype._getBestMatchLocale=function(c,b){c=this._canonicalizeLocale(c);
var a=this._parseLocale(c);if(0<=b.indexOf(c))return c;if(a.script){c=a.language+"-"+a.script;if(0<=b.indexOf(c))return c;c=a.language+"-"+a.territory;if(0<=b.indexOf(c))return c}else if(a.territory&&(c=a.language,0<=b.indexOf(c)))return c;return"en"};h.prototype._parseLocale=function(c){if(!c)throw Error("Invalid locale: {0}".format(c));var b=c.split("-");if(1>b.length||3<b.length||b.some(function(a){return 0===a.length}))throw Error("Invalid locale: {0}".format(c));c={language:b[0].toLowerCase()};
2==b.length?2==b[1].length?c.territory=b[1].toUpperCase():c.script=b[1][0].toUpperCase()+b[1].slice(1).toLowerCase():3===b.length&&(c.script=b[1][0].toUpperCase()+b[1].slice(1).toLowerCase(),c.territory=b[2].toUpperCase());return c};h.prototype._canonicalizeLocale=function(c){c=this._parseLocale(c);var b=c.language;c.script&&(b+="-"+c.script);c.territory&&(b+="-"+c.territory);return b};return h}(d.framework.application.Application);k.ViewerApplication=h})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer=
{}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){function h(a){var b=d.framework.utils.isNullOrUndefined;if(b(a))return!1;switch(a.type){case "point":return!b(a.x)&&!b(a.y);case "multipoint":return(a=a.points)&&0<a.length;case "polyline":return(a=a.paths)&&0<a.length;case "polygon":return(a=a.rings)&&0<a.length;case "extent":return!b(a.xmin)&&!b(a.xmax)&&!b(a.ymin)&&!b(a.ymax);default:return!1}}function c(a,b){var e=b.x-a.x,f=b.y-a.y;return Math.sqrt(e*e+f*f)}function b(a){if(!a||
!a.configuration)return null;if(l&&l.url&&l.url.startsWith(a.configuration.geometryServiceUrl))return l;var b=a.configuration.geometryServiceUrl,e=a.configuration.geometryServiceToken;if(e)var b=b+((-1<b.indexOf("?")?"&token=":"?token=")+encodeURIComponent(e)),f=dojo.subscribe("ServiceTokenRefreshed",function(b){b.serviceUrl===a.configuration.geometryServiceUrl&&(a.configuration.geometryServiceToken=b.token,l=null,dojo.unsubscribe(f))});"https:"!=window.location.protocol||/^(https|\/\/)/.test(b)||
a.trace.warning("Mixed Content Warning: This Viewer was loaded over HTTPS but the geometry service was loaded over HTTP. This may limit functionality. Please configure the geometry service to be served securely.");return l=new esri.tasks.GeometryService(b)}function a(a){a.forEach(function(a){var b=null;a.fromWkid&&0<a.fromWkid?b=new esri.SpatialReference(a.fromWkid):a.fromWkt&&(b=new esri.SpatialReference(a.fromWkt));var e=null;a.toWkid&&0<a.toWkid?e=new esri.SpatialReference(a.toWkid):a.toWkt&&(e=
new esri.SpatialReference(a.toWkt));var l=null;a.transformWkid&&0<a.transformWkid?l=new esri.SpatialReference(a.transformWkid):a.transformWkt&&(l=new esri.SpatialReference(a.transformWkt));if(!b||!e||!l)throw Error("Invalid or missing spatial reference. Cannot register datum transform.");f.push({fromSR:b,toSR:e,transformation:l})})}function e(a,b){if(!a||!b||0==f.length)return null;for(var e=d.essentials.GeometryUtilities.spatialRefsAreEqual,l=0;l<f.length;l++){var c=f[l];if(e(a,c.fromSR)&&e(b,c.toSR))return{transformation:c.transformation,
transformForward:!0};if(e(a,c.toSR)&&e(b,c.fromSR))return{transformation:c.transformation,transformForward:!1}}return null}g.DEFAULT_GEOMETRY_SERVICE_URI="http://sampleserver6.arcgisonline.com/arcgis/rest/services/Utilities/Geometry/GeometryServer";var f=[],l=null;g.isValidGeometry=h;g.getMiddle=function(a){if(!a||!a.type||!h(a))return null;if("point"==a.type)return a;if("multipoint"==a.type)return(a=a.getExtent())?a.getCenter():null;if("polyline"==a.type){for(var b=0,e=0;e<a.paths.length;e++)for(var f=
0;f<a.paths[e].length-1;f++)var l=new esri.geometry.Point(a.paths[e][f]),d=new esri.geometry.Point(a.paths[e][f+1]),b=b+c(l,d);for(var g=0,e=0;e<a.paths.length;e++)for(f=0;f<a.paths[e].length-1;f++){var l=new esri.geometry.Point(a.paths[e][f]),d=new esri.geometry.Point(a.paths[e][f+1]),k=c(l,d);if(g+k>b/2)return b=k/(b/2-g),new esri.geometry.Point(l.x+(d.x-l.x)/b,l.y+(d.y-l.y)/b,a.spatialReference);g+=k}}else{if("polygon"==a.type)return(a=a.getExtent())?a.getCenter():null;if("extent"==a.type)return a.getCenter()}return null};
g.getMidpoint=function(a,b){if(!a||!b)throw Error("The beginning and ending points are required.");return new esri.geometry.Point({x:(a.x+b.x)/2,y:(a.y+b.y)/2,spatialReference:a.spatialReference.toJson()})};g.getEsriGeometryType=function(a,b){if(!a)return null;var e=null;switch(a.toLowerCase()){case "rectangle":e=esri.toolbars.Draw.EXTENT;break;case "freehandpolygon":e=esri.toolbars.Draw.FREEHAND_POLYGON;break;case "freehandpolyline":e=esri.toolbars.Draw.FREEHAND_POLYLINE;break;case "mappoint":e=
esri.toolbars.Draw.POINT;break;case "multipoint":e=esri.toolbars.Draw.MULTI_POINT;break;case "polygon":e=esri.toolbars.Draw.POLYGON;break;case "polyline":e=esri.toolbars.Draw.POLYLINE;break;default:e=b||esri.toolbars.Draw.EXTENT}return e};g._getGeometryService=function(a){return b(a)};g.getGeometryService=b;g.needsProjection=function(a,b){return d.essentials.GeometryUtilities.spatialRefsAreEqual(a.spatialReference,b.map.spatialReference,!1)?!1:!0};g.projectGeometry=function(a,b,e,f,l){if(a&&a.spatialReference)if(a.spatialReference.equals(b))e&&
e(a);else{var c=new esri.tasks.ProjectParameters;c.outSR=b;c.geometries=[a];this.project(c,function(a){a&&0<a.length&&e&&e(a[0])},f,l)}else f&&f(Error("Invalid geometry or spatial reference."))};g.projectGeometryWithTransform=function(a,b,e,f,l,c){if(e)if(a&&a.spatialReference)if(a.spatialReference.equals(b))f&&f(a);else{var d=new esri.tasks.ProjectParameters;d.outSR=b;d.geometries=[a];d.transformation={wkid:e};this.project(d,function(a){a&&0<a.length&&f&&f(a[0])},l,c)}else l&&l(Error("Invalid geometry or spatial reference."));
else this.projectGeometry(a,b,f,l)};g.project=function(a,b,f,l){if(a&&(!esri.tasks.hasOwnProperty("ProjectParameters")||a instanceof esri.tasks.ProjectParameters)&&a.hasOwnProperty("outSR")&&a.hasOwnProperty("geometries"))if(b&&dojo.isFunction(b))if(a.outSR){var c=a.geometries,g=!1;c&&0<c.length&&(d.essentials.GeometryUtilities.spatialRefsAreEqual(c[0].spatialReference,a.outSR,!1)||(g=!0));g?(l=this._getGeometryService(l),a.outSR.isWebMercator()&&4326===c[0].spatialReference.wkid||4326===a.outSR.wkid&&
c[0].spatialReference.isWebMercator()?this._projectLocally(a.geometries,a.outSR,b,f):l?((c=e(c[0].spatialReference,a.outSR))&&!a.transformation&&(a.transformation=c.transformation,a.transformForward=c.transformForward),esri.tasks.hasOwnProperty("ProjectParameters")?l.project(a,b,f):l.project(a.geometries,a.outSR,b,f)):f&&dojo.isFunction(f)&&f(Error("Unable to get the geometry service. Make sure a geometry service url is configured in the application."))):b(c)}else f&&dojo.isFunction(f)&&f(Error("output spatial reference is required."));
else f&&dojo.isFunction(f)&&f(Error("callback required."));else f&&dojo.isFunction(f)&&f(Error("projectParameters required."))};g.simplifyPolygons=function(a,b,e,f){this._getGeometryService(f).simplify(a,b,e)};g.simplifyPolygon=function(a,b,e,f){this.simplifyPolygons([a],function(a){a&&0<a.length?b(a[0]):e()},e,f)};g._projectLocally=function(a,b,e,f){for(var l=[],c=0;c<a.length;c++)a[c].spatialReference.isWebMercator()&&4326===b.wkid?l[c]=esri.geometry.webMercatorToGeographic(a[c]):4326===a[c].spatialReference.wkid&&
b.isWebMercator()?l[c]=esri.geometry.geographicToWebMercator(a[c]):(f&&dojo.isFunction(f)&&f(Error("Unable to get the geometry service. Make sure a geometry service url is configured in the application.")),this.app.trace.error("An operation requiring projection attempted to project while offline, but was not between WebMercator and WGS84"));e(l)};g.createCircle=function(a,b,e,f){var l=[],c=null;f=f||40;a=new esri.geometry.Polygon(a);for(var c=360/f,d=1;d<=f;d++){var g=d*c*Math.PI/180;l.push([b.x+
e*Math.cos(g),b.y+e*Math.sin(g)])}l.push(l[0]);a.addRing(l);return a};g.fixAspectRatio=function(a,b){var e=b.getWidth()/b.getHeight(),f=a.getWidth()/a.getHeight(),l=a.getWidth(),c=a.getHeight();f<e?l=e*c:c=1/e*l;e=a.getCenter();return new esri.geometry.Extent(e.x-l/2,e.y-c/2,e.x+l/2,e.y+c/2,a.spatialReference)};g.extentToPolygon=function(a){var b=new esri.geometry.Polygon(a.spatialReference),e=[];e.push(new esri.geometry.Point(a.getCenter().x-a.getWidth()/2,a.getCenter().y-a.getHeight()/2));e.push(new esri.geometry.Point(a.getCenter().x-
a.getWidth()/2,a.getCenter().y+a.getHeight()/2));e.push(new esri.geometry.Point(a.getCenter().x+a.getWidth()/2,a.getCenter().y+a.getHeight()/2));e.push(new esri.geometry.Point(a.getCenter().x+a.getWidth()/2,a.getCenter().y-a.getHeight()/2));e.push(new esri.geometry.Point(a.getCenter().x-a.getWidth()/2,a.getCenter().y-a.getHeight()/2));b.addRing(e);return b};g.pointsAreEqual=function(a,b){return a&&!b||!a&&b?!1:a?a.x!==b.x||a.y!==b.y||!a.spatialReference&&b.spatialReference||a.spatialReference&&!b.spatialReference||
!a.spatialReference.equals(b.spatialReference)?!1:!0:!0};g.registerDefaultDatumTransforms=function(){var b=[];b.push({transformWkid:108457,fromWkid:28992,toWkid:4326});b.push({transformWkid:1195,fromWkid:27700,toWkid:4326});b.push({transformWkid:1623,fromWkid:102067,toWkid:4326});a(b)};g.registerDatumTransforms=a;g.getDatumTransformParameters=e;g.intersects=function(a,b){return new Promise(function(e,f){require(["esri/geometry/geometryEngine"],function(l){try{e(l.intersects(a,b))}catch(c){f(c)}})})};
g.unionGeometries=function(a){return new Promise(function(b,e){require(["esri/geometry/geometryEngine"],function(f){try{b(f.union(a))}catch(l){e(l)}})})};g.explodeGeometry=function(a){switch(a.type){case "polygon":return a.rings.map(function(b){return(new esri.geometry.Polygon(b)).setSpatialReference(a.spatialReference)});case "polyline":return a.paths.map(function(b){return(new esri.geometry.Polyline(b)).setSpatialReference(a.spatialReference)});case "multipoint":return a.points.map(function(b){return new esri.geometry.Point(b,
a.spatialReference)})}return[a]};g.cutGeometries=function(a,b,e){var f=this;return new Promise(function(l,c){var d=f.getGeometryService(e);if(!d)return Promise.reject(Error("Unable to get the geometry service. Make sure a geometry service url is configured in the application."));try{d.cut(a,b).then(function(a){for(var b=[],e=0;e<a.geometries.length;e++){var f=a.cutIndexes[e];b[f]||(b[f]=[]);b[f].push(a.geometries[e])}l(b)})}catch(g){c(g)}})};g.toRing=function(a){return[[a.xmin,a.ymin],[a.xmin,a.ymax],
[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]}})(h.GeometryUtils||(h.GeometryUtils={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){(function(g){function c(l,c){var d=function(f){var d=null;require(["esri/tasks/BufferParameters"],function(b){d=new esri.tasks.BufferParameters;d.geometries=f;d.unit=a(c.bufferUnit);d.bufferSpatialReference=c.bufferSpatialReference||c.outSpatialReference||c.geometries[0].spatialReference||l.map.spatialReference;d.outSpatialReference=c.outSpatialReference||l.map.spatialReference||c.geometries[0].spatialReference||c.bufferSpatialReference;
d.distances=[c.bufferDistance];d.unionResults=void 0!=c.unionResults?!!c.unionResults:!0;d.geodesic=!!c.geodesic;d.unit==g.GCX_UNIT_YARDS&&(d.unit=esri.tasks.GeometryService.UNIT_FOOT,d.distances=[e(c.bufferDistance,g.GCX_UNIT_YARDS,esri.tasks.GeometryService.UNIT_FOOT)])});return new Promise(function(a,e){b(l,d).then(a,e)})};return new Promise(function(a,b){var e=[];f(c.geometries).forEach(function(a){e.push(d(a))});Promise.all(e).then(function(e){var f=e[0];f.bufferId=c.bufferId;f.sourceCommand=
c.sourceCommand;if(1===e.length)a(f);else{for(var l=1;l<e.length;l++){var d=e[l].geometries;d.length&&(f.geometries=f.geometries.concat(d))}c.unionResults?h.GeometryUtils.unionGeometries(f.geometries).then(function(b){h.GeometryUtils.isValidGeometry(b)&&(f.geometries=[b],f.geometry=b,a(f))},function(a){var e={};e.error=a;e.bufferId=c.bufferId;e.sourceCommand=c.sourceCommand;b(e)}):a(f)}},function(a){a.bufferId=c.bufferId;a.sourceCommand=c.sourceCommand;b(a)})})}function b(a,b){var e=function(a,b){var e=
{};a&&(e.geometries=a);b&&(e.error=b);return e};return new Promise(function(f,l){var c=h.GeometryUtils.getGeometryService(a);if(c){var d=function(){0===b.distances[0]?f(e(b.geometries,null)):c.buffer(b,function(a){return f(e(a,null))},function(a){return l(e(null,a))})};esri.geometry.normalizeCentralMeridian(b.geometries).then(function(a){"polygon"===a[0].type?c.simplify(b.geometries,function(a){b.geometries=a;d()},function(a){l(e(null,a))}):(b.geometries=a,d())})}else a.trace.error("BufferUtils: Buffer operation failed. Could not retrieve geometry service."),
l(e(null,Error("BufferUtils: Buffer operation failed. Could not retrieve geometry service.")))})}function a(a,b){if(!a)return null;var e=null;switch(a){case "feet":case d.essentials.DistanceUnitType.FEET:case esri.tasks.GeometryService.UNIT_FOOT.toString():case esri.Units.FEET:e=esri.tasks.GeometryService.UNIT_FOOT;break;case "kilometer":case d.essentials.DistanceUnitType.KILOMETERS:case esri.tasks.GeometryService.UNIT_KILOMETER.toString():case esri.Units.KILOMETERS:e=esri.tasks.GeometryService.UNIT_KILOMETER;
break;case "meter":case d.essentials.DistanceUnitType.METERS:case esri.tasks.GeometryService.UNIT_METER.toString():case esri.Units.METERS:e=esri.tasks.GeometryService.UNIT_METER;break;case "mile":case d.essentials.DistanceUnitType.MILES:case esri.tasks.GeometryService.UNIT_STATUTE_MILE.toString():case esri.Units.MILES:e=esri.tasks.GeometryService.UNIT_STATUTE_MILE;break;case "nauticalmile":case d.essentials.DistanceUnitType.NAUTICAL_MILES:case esri.tasks.GeometryService.UNIT_NAUTICAL_MILE.toString():case esri.Units.NAUTICAL_MILES:e=
esri.tasks.GeometryService.UNIT_NAUTICAL_MILE;break;case "yard":case d.essentials.DistanceUnitType.YARDS:case esri.Units.YARDS:e=g.GCX_UNIT_YARDS;break;default:e=b||a}return e}function e(a,b,e){var f=0;switch(b){case esri.tasks.GeometryService.UNIT_METER:f=3.280839895013*a;break;case esri.tasks.GeometryService.UNIT_KILOMETER:f=3280.839895013123*a;break;case esri.tasks.GeometryService.UNIT_STATUTE_MILE:f=5280*a;break;case esri.tasks.GeometryService.UNIT_NAUTICAL_MILE:f=6076.12*a;break;case g.GCX_UNIT_YARDS:f=
3*a;break;default:f=a}switch(e){case esri.tasks.GeometryService.UNIT_METER:return f/3.280839895013;case esri.tasks.GeometryService.UNIT_KILOMETER:return f/3280.839895013123;case esri.tasks.GeometryService.UNIT_STATUTE_MILE:return f/5280;case esri.tasks.GeometryService.UNIT_NAUTICAL_MILE:return f/6076.12;case g.GCX_UNIT_YARDS:return f/3;default:return f}}function f(a){var b=[];a.forEach(function(a){for(var e=!1,f=0;f<b.length;f++)if(b[f].length&&b[f][0].type===a.type){b[f].push(a);e=!0;break}e||(e=
b.length,b[e]=[],b[e].push(a))});return b}g.SUPPORTED_BUFFER_UNITS={feet:null,yard:null,meter:null,kilometer:null,mile:null,nauticalmile:null};var l=[3819,3821,3824,3889,3906,5013,5233,5246,5252,5264,5324,5340,5354,5360,5365,5371,5373,5381,5393,5451,5464,5467,5489,5524,5527,5546,5561,37257,104E3,104020,104023,104199,104223,104896],n=[[4001,4999],[5228,5229],[2044,2045],[2081,2083],[2085,2086],[2093,2093],[2096,2098],[2105,2132],[2169,2170],[2176,2180],[2193,2193],[2200,2200],[2206,2212],[2319,2319],
[2320,2462],[2523,2549],[2551,2735],[2738,2758],[2935,2941],[2953,2953],[3006,3030],[3034,3035],[3058,3059],[3068,3068],[3114,3118],[3126,3138],[3300,3301],[3328,3335],[3346,3346],[3350,3352],[3366,3366],[3416,3416],[20004,20032],[20064,20092],[21413,21423],[21473,21483],[21896,21899],[22171,22177],[22181,22187],[22191,22197],[25884,25884],[27205,27232],[27391,27398],[27492,27492],[28402,28432],[28462,28492],[30161,30179],[30800,30800],[31251,31259],[31275,31279],[31281,31290],[31466,31700],[37001,
37008],[37201,37208],[37211,37235],[37237,37243],[37245,37247],[37249,37255],[37259,37260],[104100,104145],[104256,104259],[104260,104261],[104286,104287],[104304,104305],[104700,104786],[104800,104871],[104900,104970],[104990,104992]];g.GCX_UNIT_YARDS=12345;g.bufferGeometry=function(a,b){var e={bufferId:b.bufferId,geometries:[b.geometry],callback:b.callback,geodesic:b.geodesic,bufferSpatialReference:b.bufferSpatialReference,outSpatialReference:b.outSpatialReference,bufferDistance:b.bufferDistance,
bufferUnit:b.bufferUnit,unionResults:b.unionResults,sourceCommand:b.sourceCommand};return new Promise(function(b,f){c(a,e).then(function(a){a.geometry=a.geometries[0]||null;b(a)},function(a){f(a)})})};g.bufferGeometries=c;g.buffer=b;g.isGeographicWkid=function(a){a=parseInt(a,10);if(isNaN(a))return!1;if(-1<l.indexOf(a))return!0;for(var b=0;b<n.length;b++)if(a>=n[b][0]&&a<=n[b][1])return!0;return!1};g.getUnitDescFromConfig=function(a){for(var b in h.buffer.BufferUtils.SUPPORTED_BUFFER_UNITS)if(h.buffer.BufferUtils.SUPPORTED_BUFFER_UNITS.hasOwnProperty(b)&&
g.SUPPORTED_BUFFER_UNITS[b]&&g.SUPPORTED_BUFFER_UNITS[b].config===a)return h.buffer.BufferUtils.SUPPORTED_BUFFER_UNITS[b];return null};g.getGeometryServiceUnitConstant=a;g.convertLength=e})(g.BufferUtils||(g.BufferUtils={}))})(h.buffer||(h.buffer={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){var g=function(g){function c(b,a){var e=this;g.call(this);this.singleFeatureLayer=this.featureLayer=this.gcxLayer=null;this.clusterRadius=new Observable(null);this.maxFeaturesInCluster=new Observable(null);this.renderer=null;this.rendererInformation=[];this.featureLayerRenderer=null;this._featureLayerGraphics=[];this._clusters=[];this._hiddenClusters=[];this._featureSetName=this._clusterBackgroundColor=this._clusterLabelColor=null;this._esriEventHandlers=
[];this._gcxEventHandlers=[];this._fontSize="10pt";this._fontFamily="Segoe UI, sans-serif";this._mapClickHandler=null;if(!(b.mapService.serviceLayer instanceof esri.layers.FeatureLayer))throw Error("ClusterLayers require an Esri FeatureLayer to be passed in as a parameter.");this.app=a;this.id=b.mapService.id+"-cluster";this._featureSetName=this.id+"FeatureSet";this.gcxLayer=b;this.featureLayer=b.mapService.serviceLayer;this.singleFeatureLayer=new esri.layers.GraphicsLayer;this.url=this.featureLayer.url;
this.setVisibility(this.featureLayer.visible&&this.featureLayer.visibleAtMapScale);this.setOpacity(this.featureLayer.opacity);this.featureLayerRenderer=this.featureLayer.renderer;this.featureLayer.setRenderer(null);this.featureLayer.redraw();this.singleFeatureLayer.id=b.mapService.id+"-explodedClusterLayer";this.singleFeatureLayer.setRenderer(this.featureLayerRenderer);this.singleFeatureLayer.setOpacity(this.featureLayer.opacity);this.singleFeatureLayer.url=this.url;this.clusterRadius.set(b.mapService.featureClustering.radius||
50);this.maxFeaturesInCluster.set(b.mapService.featureClustering.maximumFeatures||0);this._clusterLabelColor=new esri.Color(b.mapService.featureClustering.labelColor);this._clusterBackgroundColor=new esri.Color(b.mapService.featureClustering.backgroundColor);for(var f=0;4>f;f++)this.rendererInformation.push({isVisible:new Observable(!1),rangeString:new Observable("")});this.maxFeaturesInCluster.bind(this,function(a){e.gcxLayer.mapService.featureClustering.maximumFeatures=a;e._loadRenderer()});this.clusterRadius.bind(this,
function(a){e.gcxLayer.mapService.featureClustering.radius=a});0<this.maxFeaturesInCluster.get()&&this._loadRenderer();if(this.app.map&&this.app.map.loaded)this._setupEventListeners(this.app.map);else this.app.event("MapLoadedEvent").once(this,function(a){e._setupEventListeners(a)});this.recluster()}__extends(c,g);c.prototype.recluster=function(){0<this.singleFeatureLayer.graphics.length||(this._featureLayerGraphics=this.featureLayer.graphics.slice(0,this.featureLayer.graphics.length),this._generateClusters(),
this.redraw())};c.prototype.destroy=function(){this.app.map.getLayer(this.singleFeatureLayer.id)===this.singleFeatureLayer&&this.app.map.removeLayer(this.singleFeatureLayer);this.app.featureSetManager.getCollectionById(this._featureSetName)&&(this.app.featureSetManager.closeCollection(this._featureSetName),this.app.featureSetManager.removeCollectionById(this._featureSetName));this.app.map.removeLayer(this);this.featureLayer.setRenderer(this.featureLayerRenderer);this.featureLayer.redraw();for(var b=
0;b<this._esriEventHandlers.length;b++)this._esriEventHandlers[b].remove();for(b=0;b<this._gcxEventHandlers.length;b++)this.app.event(this._gcxEventHandlers[b].eventName).unsubscribe(this._gcxEventHandlers[b].token)};c.prototype.onFeatureClicked=function(b){var a=this;if(b.graphic instanceof esri.Graphic&&!this.app.toolRegistry.getActiveTool()){var e=b.graphic;this.singleFeatureLayer.clear();this._hiddenClusters=[];b=[];for(var f=[],l=0;l<this._featureLayerGraphics.length;l++)if(this._featureLayerGraphics[l].attributes.clusterId===
e.attributes.clusterId){var c={graphic:this._featureLayerGraphics[l],layer:this.gcxLayer,resolveLayerFields:!0};c.symbol=this._getRenderedSymbol(this._featureLayerGraphics[l]);b.push(new d.Feature(c));f.push(this._featureLayerGraphics[l]);this.singleFeatureLayer.add(this._featureLayerGraphics[l])}this._hiddenClusters=this.graphics.slice(0,this.graphics.length);this.clear();this.redraw();this.app.map.getLayer(this.singleFeatureLayer.id)||this.app.map.addLayer(this.singleFeatureLayer);this.singleFeatureLayer.redraw();
e=new d.FeatureSet;e.features.set(b);e.layer=this.gcxLayer;e.esriFeatureSet=new esri.tasks.FeatureSet;e.esriFeatureSet.features=f;e.resolveDataLinks(function(b){a.app.event("FeatureChangedEvent").publish(b)});b=new d.FeatureSetCollection;b.featureSets.addItem(e);b.id=this._featureSetName;b.sourceName="ClusterFeatures";this.app.featureSetManager.getCollectionById(this._featureSetName)&&this.app.featureSetManager.removeCollectionById(this._featureSetName);this.app.featureSetManager.addCollection(b);
this.app.featureSetManager.openCollection(this._featureSetName);this.app.featureSetManager.closeCollection(this._featureSetName);this.app.command("DisableMapClick").execute();this._mapClickHandler=this.app.map.on("click",function(b){if(0<a.app.stateManager.getActiveStates().filter(function(a){return"EditorActiveState"===a.stateDefinition.name}).length)a.singleFeatureLayer.redraw();else return a._mapClickHandler.remove(),a._mapClickHandler=null,a.app.command("EnableMapClick").execute(),a.singleFeatureLayer.clear(),
a.recluster(),!1})}};c.prototype._setupEventListeners=function(b){var a=this;this._gcxEventHandlers.push({eventName:"MapClickedEvent",token:this.app.event("MapClickedEvent").subscribe(this,function(b){return a._mapClickedEvent(b)})});this._gcxEventHandlers.push({eventName:"MapExtentChangedEvent",token:this.app.event("MapExtentChangedEvent").subscribe(this,function(b,f){return a._mapExtentChangedEvent(b,f)})});this._gcxEventHandlers.push({eventName:"MapTipClosedEvent",token:this.app.event("MapTipClosedEvent").subscribe(this,
function(){return a._mapTipClosedEvent()})});this._gcxEventHandlers.push({eventName:"ClusterLayerRemovedEvent",token:this.app.event("ClusterLayerRemovedEvent").subscribe(this,function(b){return a._clusterLayerRemovedEvent(b)})});this._gcxEventHandlers.push({eventName:"LayerVisibilityChangedEvent",token:this.app.event("LayerVisibilityChangedEvent").subscribe(this,function(b){return a._layerVisibilityChangedEvent(b)})});this._gcxEventHandlers.push({eventName:"GeometryEditInvokedEvent",token:this.app.event("GeometryEditInvokedEvent").subscribe(this,
function(b){return a.recluster()})});this._gcxEventHandlers.push({eventName:"GeometryEditCompletedEvent",token:this.app.event("GeometryEditCompletedEvent").subscribe(this,function(b){return a._handleGeometryChange()})});this._gcxEventHandlers.push({eventName:"EditorClosedEvent",token:this.app.event("EditorClosedEvent").subscribe(this,function(){return a._handleEditorClosedEvent()})});this._esriEventHandlers.push(this.featureLayer.on("update-end",function(b){a.recluster()}))};c.prototype._handleGeometryChange=
function(){this.recluster();0<this.singleFeatureLayer.graphics.length&&this.singleFeatureLayer.redraw()};c.prototype._handleEditorClosedEvent=function(){this.recluster();0<this.singleFeatureLayer.graphics.length&&this.singleFeatureLayer.redraw()};c.prototype._mapClickedEvent=function(b){if(this.visible){var a=b&&b.graphic?b.graphic:null;if(null===this.app.toolRegistry.getActiveTool())if(a&&a.getLayer()===this&&a.attributes&&a.geometry instanceof esri.geometry.Point)if(a.attributes.clusterId&&a.attributes.clusterCount)this.onFeatureClicked(b);
else this.app.command("ShowMapTip").execute(new d.Feature({graphic:a,layer:this.gcxLayer}));else 0<this.singleFeatureLayer.graphics.length&&(this.singleFeatureLayer.clear(),this.app.command("RemovePushpins").execute()),this.recluster()}};c.prototype._mapExtentChangedEvent=function(b,a){this.featureLayer.visibleAtMapScale&&this.featureLayer.visible?this.setVisibility(!0):this.setVisibility(!1);0===this.singleFeatureLayer.graphics.length&&this.visible&&this.featureLayer.visibleAtMapScale&&this.recluster();
this._loadRenderer()};c.prototype._mapTipClosedEvent=function(){this._mapClickHandler&&(this._mapClickHandler.remove(),this._mapClickHandler=null);this.app.command("EnableMapClick").execute();this.singleFeatureLayer.clear();this.recluster()};c.prototype._clusterLayerRemovedEvent=function(b){b===this&&this.destroy()};c.prototype._layerVisibilityChangedEvent=function(b){var a=this;b.forEach(function(b){b.layer===a.gcxLayer&&(a.setVisibility(b.visibility&&a.featureLayer.visibleAtMapScale),a._loadRenderer())})};
c.prototype._loadRenderer=function(){var b=new esri.renderer.ClassBreaksRenderer(null,"clusterCount"),a=null;if(0<this.maxFeaturesInCluster.get())a=this.maxFeaturesInCluster.get();else for(var e=a=0;e<this._clusters.length;e++)this._clusters[e].attributes.clusterCount>a&&(a=this._clusters[e].attributes.clusterCount);e=Math.ceil(0.309999999999*a);1===e&&e++;var f=Math.ceil(0.31*a);f<=e&&(f=e+1);var l=Math.ceil(0.609999999999*a);l<f&&(l=f);var c=Math.ceil(0.61*a);c<=l&&(c=l+1);var d=Math.ceil(0.909999999999*
a);d<c&&(d=c);var g=Math.ceil(0.91*a);g<=d&&(g=d+1);this._addBreak(b,21,2,e,a,0);this._addBreak(b,28,f,l,a,1);this._addBreak(b,35,c,d,a,2);this._addBreak(b,42,g,Infinity,a,3);this.setRenderer(b)};c.prototype._addBreak=function(b,a,e,f,l,c){l>=e&&this.visible&&this.featureLayer.visibleAtMapScale?(e!==f?Infinity!==f?this.rendererInformation[c].rangeString.set(e+" - "+f):this.rendererInformation[c].rangeString.set(e+"+"):this.rendererInformation[c].rangeString.set(e.toString()),this.rendererInformation[c].isVisible.set(!0)):
this.rendererInformation[c].isVisible.set(!1);l=null;l=8===dojo.isIE?new esri.symbol.SimpleMarkerSymbol({color:this._clusterBackgroundColor.toRgba(),size:a,type:"esriSMS",style:"esriSMSCircle",outline:{color:this._makeTransparent(this._clusterBackgroundColor.toRgba()),width:8,type:"esriSLS",style:"esriSLSSolid"}}):new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,a,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new esri.Color(this._makeTransparent(this._clusterBackgroundColor.toRgba())),
8),this._clusterBackgroundColor);b.addBreak(e,f,l)};c.prototype._makeTransparent=function(b){4===b.length&&(b[3]=0.25);return b};c.prototype._isValidCluster=function(b,a,e){return Math.sqrt(Math.pow(a.x-b.x,2)+Math.pow(a.y-b.y,2))/e<=this.clusterRadius.get()&&this._isClusterFull(a)};c.prototype._isClusterFull=function(b){return b.attributes.clusterCount<this.maxFeaturesInCluster.get()||0==this.maxFeaturesInCluster.get()||""==this.maxFeaturesInCluster.get().toString()};c.prototype._generateClusters=
function(){this.clear();this._clusters=[];this._addGraphicsToClusters(!1);for(var b=[],a=0;a<this._clusters.length;a++)b[a]={x:this._clusters[a].x,y:this._clusters[a].y,attributes:{clusterCount:0,clusterId:this._clusters[a].attributes.clusterId,extent:this._clusters[a].attributes.extent}};this._clusters=b;this._addGraphicsToClusters(!0);this._showAllClusters()};c.prototype._addGraphicsToClusters=function(b){for(var a=this._featureLayerGraphics.length,e=this.app.map.extent.getWidth()/this.app.map.width,
f=0;f<a;f++){var l=null;if(this._featureLayerGraphics[f].geometry instanceof esri.geometry.Point&&this._featureLayerGraphics[f].visible)if(l=this._featureLayerGraphics[f].geometry,this.app.map.extent.contains(l)){for(var c=this._featureLayerGraphics[f],d=[],g=0;g<this._clusters.length;g++){var h=this._clusters[g];this._isValidCluster(l,h,e)&&d.push(h)}if(1===d.length)this._clusterAddPoint(c,l,d[0],b);else if(1<d.length){h=[];for(g=0;g<d.length;g++)h[g]=Math.sqrt(Math.pow(d[g].x-l.x,2)+Math.pow(d[g].y-
l.y,2));for(var m=null,k=null,g=0;g<h.length;g++)if(null===k||k>h[g])k=h[g],m=d[g];this._clusterAddPoint(c,l,m,b)}else this._createCluster(c,l)}else this._featureLayerGraphics[f].attributes.clusterId=-1}};c.prototype._showAllClusters=function(){0!=this.maxFeaturesInCluster.get()&&""!=this.maxFeaturesInCluster.get().toString()||this._loadRenderer();for(var b=0,a=this._clusters.length;b<a;b++)this._showCluster(this._clusters[b])};c.prototype._showCluster=function(b){var a=new esri.geometry.Point(b.x,
b.y,this.app.map.spatialReference),e=new esri.Graphic(a,null,b.attributes);e.setSymbol(this._getRenderedSymbol(e));this.add(e);2>b.attributes.clusterCount||(e=null,8===dojo.isIE?(e=new esri.symbol.TextSymbol({type:"esriTS",color:this._clusterLabelColor.toRgba(),xoffset:0,yoffset:-5,font:{family:this._fontFamily,size:this._fontSize,weight:"bold"}}),e.setText(b.attributes.clusterCount.toString())):(e=new esri.symbol.TextSymbol(b.attributes.clusterCount),e.setColor(this._clusterLabelColor),e.setOffset(0,
-5),e.setFont((new esri.symbol.Font(this._fontSize)).setFamily(this._fontFamily).setWeight(esri.symbol.Font.WEIGHT_BOLD))),b=new esri.Graphic(a,e,b.attributes),this.add(b))};c.prototype._getRenderedSymbol=function(b){if(1!==b.attributes.clusterCount)return null;var a=this.featureLayerRenderer;if(!a)return null;if(a instanceof esri.renderer.SimpleRenderer)return a.getSymbol(b);for(var e=0;e<this._featureLayerGraphics.length;e++){var f=this._featureLayerGraphics[e];if(f.attributes.clusterId===b.attributes.clusterId)return a.getSymbol(f)}};
c.prototype._clusterAddPoint=function(b,a,e,f){var l;f||(l=e.attributes.clusterCount,f=(a.x+e.x*l)/(l+1),l=(a.y+e.y*l)/(l+1),e.x=f,e.y=l);a.x<e.attributes.extent[0]?e.attributes.extent[0]=a.x:a.x>e.attributes.extent[2]&&(e.attributes.extent[2]=a.x);a.y<e.attributes.extent[1]?e.attributes.extent[1]=a.y:a.y>e.attributes.extent[3]&&(e.attributes.extent[3]=a.y);e.attributes.clusterCount++;a.hasOwnProperty("attributes")||(a.attributes={});b.attributes.clusterId=a.attributes.clusterId=e.attributes.clusterId};
c.prototype._createCluster=function(b,a){var e=this._clusters.length+1;b.attributes.clusterId=e;this._clusters.push({x:a.x,y:a.y,attributes:{clusterCount:1,clusterId:e,extent:[a.x,a.y,a.x,a.y]}})};return c}(esri.layers.GraphicsLayer);d.ClusterLayer=g})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var h=d.essentials.documents.GrantKind,c=function(){function b(a){this.grants=[];this.isPublic=this.isGlobal=!1;this.isRevoked=new Observable(!1);this.canWrite=this.canRead=!1;this.enabled=new Observable(!0);if(!a.id&&!a.grant)throw Error('MonikerModel: parameter "id" or "grant" is required.');a.id&&(this.id=a.id);a.name&&(this.name=a.name);a.iconUri&&(this.iconUri=a.iconUri);a.isGlobal&&(this.isGlobal=a.isGlobal);a.isPublic&&(this.isPublic=
a.isPublic);a.grant&&(this.id=a.grant.globalId,a.grant.subject&&(this.name=a.grant.subject.title),this.addGrant(a.grant))}b.prototype.addGrant=function(a){this.grants.push(a);switch(a.kind){case h.READER:this.canRead=!0;break;case h.WRITER:this.canWrite=!0}};return b}();g.MonikerModel=c})(h.documents||(h.documents={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){d=d.essentialsHtmlViewer||(d.essentialsHtmlViewer={});d=d.mapping||(d.mapping={});d=d.infrastructure||(d.infrastructure={});d=d.coordinates||(d.coordinates={});d=d.AngleDirectionSystem||(d.AngleDirectionSystem={});d.POLAR="polar";d.NORTH_AZIMUTH="north_azimuth";d.SOUTH_AZIMUTH="south_azimuth"})(geocortex||(geocortex={}));
(function(d){d=d.essentialsHtmlViewer||(d.essentialsHtmlViewer={});d=d.mapping||(d.mapping={});d=d.infrastructure||(d.infrastructure={});d=d.coordinates||(d.coordinates={});d=d.AngleFormat||(d.AngleFormat={});d.DD="dd";d.DDM="ddm";d.DMS="dms"})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){g.featureSetExtendedProperty="containsCoordinates";g.coordinateIdentifierProperty="coordinateId";var m=function(){function c(b){this._registeredCoordinateModels=[];this.app=b}c.prototype.registerModel=function(b,a){void 0===a&&(a=!1);if(!this._validateModelRegistration(b))return!1;this._processCoordinatesModel(b);if(0===this._registeredCoordinateModels.length||a)this._defaultCoordinatesModel=b;this._registeredCoordinateModels.push(b.id);
return!0};c.prototype.getCoordinate=function(b,a,e){var f=this;if(!this.hasRegisteredCoordinatesModel(e))return Promise.reject(Error("Coordinates Manager: Could not resolve coordinates. Target coordinates model incorrectly configured or not registered."));var l=b instanceof esri.geometry.Point?b:new esri.geometry.Point(b.x,b.y,b.spatialReference);b=this._defaultCoordinatesModel;if(e&&b.id!==e)this.getCoordinatesModel(e).then(function(b){return g.CoordinateUtils.getCoordinate(f.app,l,a||b.currentCoordinateSystem.get(),
b.fractionalDigits,b.defaultGcsWkid)},function(a){return Promise.reject(a)});else return g.CoordinateUtils.getCoordinate(this.app,l,a||b.currentCoordinateSystem.get(),b.fractionalDigits,b.defaultGcsWkid)};c.prototype.getCoordinatesModel=function(b){var a=this;return new Promise(function(e,f){a.app.getFrameworkObjectByIdAsync(b,function(a){a instanceof d.essentialsHtmlViewer.mapping.infrastructure.coordinates.CoordinatesModel?e(a):f(Error("CoordinatesManager: getCoordinatesModel - {0} is not an instance of a Coordinates Model.".format(b)))},
function(a){return f(a)})})};c.prototype.hasRegisteredCoordinatesModel=function(b){return!b&&this._defaultCoordinatesModel&&this._defaultCoordinatesModel.isRegistered?!0:b?-1<this._registeredCoordinateModels.indexOf(b):!1};c.prototype._validateModelRegistration=function(b){if(!(b&&b.id&&b.coordinateSystems.length()&&b.currentCoordinateSystem.get())||this._registeredCoordinateModels.filter(function(a){return b.id===a}).length)return!1;for(var a=0;a<b.coordinateSystems.length();a++){var e=b.coordinateSystems.getAt(a);
if(!this._validateCoordinateSystem(e))return!1}return!0};c.prototype._validateCoordinateSystem=function(b){return null!=b.displayName&&null!=b.output&&(null!=b.wkid||null!=b.wkt)};c.prototype._processCoordinatesModel=function(b){var a=this;this._addModelSubscriptionHooks(b);var e=!1;b.inputStream.bind(this,function(f){e||!b.isActive.get()||a._prevCoord&&a._prevCoord.x==f.x&&a._prevCoord.y==f.y&&a._prevCoord.spatialReference&&f.spatialReference&&(a._prevCoord.spatialReference.wkid===f.spatialReference.wkid||
a._prevCoord.spatialReference.wkt==f.spatialReference.wkt)?a._prevCoord=f:(a._prevCoord=f,f=f instanceof esri.geometry.Point?f:new esri.geometry.Point(f.x,f.y,f.spatialReference),e=!0,h.coordinates.CoordinateUtils.getCoordinate(a.app,f,b.currentCoordinateSystem.get(),b.fractionalDigits,b.defaultGcsWkid).then(function(a){b.outputStream.set(a);e=!1},function(f){a.app.trace.error("CoordinatesManager: An error occurred while attempting to map from input to output coordinate streams for model: {0}".format(b.id));
e=!1}))});b.isRegistered=!0};c.prototype._addModelSubscriptionHooks=function(b){var a=this,e=b.outputStream.bindingEvent;dojo.aspect.after(e,"subscribe",function(f){a._handleModelSubscriptionsChanged(b,e.subscriptions);return f});dojo.aspect.after(e,"unsubscribe",function(f){a._handleModelSubscriptionsChanged(b,e.subscriptions);return f});dojo.aspect.after(e,"clear",function(){return a._handleModelSubscriptionsChanged(b,e.subscriptions)});this._handleModelSubscriptionsChanged(b,e.subscriptions)};
c.prototype._handleModelSubscriptionsChanged=function(b,a){var e=!1,f;for(f in a)if(a.hasOwnProperty(f)){e=!0;break}e!==b.isActive.get()&&b.isActive.set(e)};return c}();g.CoordinatesManager=m})(h.coordinates||(h.coordinates={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var h=function(c){function b(){c.apply(this,arguments);this.isActive=new Observable(!1);this.coordinateSystems=new ObservableCollection([]);this.currentCoordinateSystem=new Observable(null);this.fractionalDigits=5;this.defaultGcsWkid=4326;this.inputStream=new Observable(null);this.outputStream=new Observable(null);this.isRegistered=!1}__extends(b,c);b.prototype.initialize=function(a){this.configuration=a};return b}(d.framework.ui.ViewModelBase);
g.CoordinatesModel=h})(h.coordinates||(h.coordinates={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(g){(function(k){function c(a,b){b=b.startsWith("language-coordinates-")?b:"language-coordinates-"+b;return a.getResource("Mapping.Infrastructure",b)}function b(a){return"number"!==typeof a?NaN:0<a?1:0>a?-1:a}k.getCoordinate=function(a,b,f,l,c){void 0===l&&(l=5);void 0===c&&(c=4326);return new Promise(function(g,p){var k=esri.geometry,m=b.spatialReference,q=(a.map.spatialReference.wkt?f.wkt!==a.map.spatialReference.wkt:f.wkid!==a.map.spatialReference.wkid)||
"xy"===f.output?new esri.SpatialReference(f.wkid||f.wkt):new esri.SpatialReference(c),w=function(b){var e=l;void 0===e&&(e=5);var c={};c.targetCoordinateSystem=f;c.x=b.x;c.y=b.y;c.spatialReference=b.spatialReference;"xy"==f.output?(c.formattedLatitudeOrX=d.FormatUtils.formatNumber(b.x,d.NumberFormat.DEFAULT,{fractionalDigits:e}),c.formattedLongitudeOrY=d.FormatUtils.formatNumber(b.y,d.NumberFormat.DEFAULT,{fractionalDigits:e})):(b=d.coordinates.CoordinateUtils.formatLatLon(b.y,b.x,f.output,a,e),c.formattedLatitudeOrX=
b.latitude,c.formattedLongitudeOrY=b.longitude);g(c)},x=function(){d.GeometryUtils.projectGeometry(b,q,function(a){w(a)},function(a){p(Error("Unable to project geometry for coordinate tracking: {0}".format(a.message)))},a)},u=function(){a.command("NativeHasCapability").execute("project",function(a){a?x():p(Error("Offline Mode. Unable to project geometry for coordinate tracking."))})};k.canProject(m,q)?(k=k.project(b,q),w(k)):a.isOffline.get()?u():x()})};k.convertDmsToDecimalDegrees=function(a,b,f,
l,d){var g=c(a,"west-abbrev").toUpperCase(),h=c(a,"east-abbrev").toUpperCase(),k=c(a,"north-abbrev").toUpperCase();a=c(a,"south-abbrev").toUpperCase();d=d.toUpperCase();b=parseFloat(b);f=parseFloat(f);l=parseFloat(l);if(isNaN(b)||isNaN(f)||isNaN(l)||0>b||180<b||0>f||60<f||0>l||60<l||d!=g&&d!=h&&d!=k&&d!=a)return null;h=b+f/60+l/3600;if(d===a||d===g)h=-h;return h};k.formatAngle=function(a,e,f,l){if(null==l||"undefined"===typeof l)l=4;e||(e=g.AngleFormat.DD);e=e.toLowerCase();switch(e){case g.AngleFormat.DDM:e=
l;l=Math.floor(Math.abs(a));var c=60*(Math.abs(a)-l);return"{0}{1} {2}{3}".format(l*b(a),k.getResource(f,"degrees"),d.FormatUtils.formatNumber(c,d.NumberFormat.NUMBER,{fractionalDigits:e}),k.getResource(f,"minutes"));case g.AngleFormat.DMS:e=l;l=Math.floor(Math.abs(a));var c=Math.floor(60*(Math.abs(a)-l)),r=3600*(Math.abs(a)-l-c/60);return"{0}{1} {2}{3} {4}{5}".format(l*b(a),k.getResource(f,"degrees"),c,k.getResource(f,"minutes"),d.FormatUtils.formatNumber(r,d.NumberFormat.NUMBER,{fractionalDigits:e}),
k.getResource(f,"seconds"));default:return"{0}{1}".format(d.FormatUtils.formatNumber(a,d.NumberFormat.NUMBER,{fractionalDigits:l}),k.getResource(f,"degrees"))}};k.formatLatLon=function(a,b,f,l,c){var d=null,g=null,d=0<a?k.getResource(l,"north-abbrev"):k.getResource(l,"south-abbrev"),g=0<b?k.getResource(l,"east-abbrev"):k.getResource(l,"west-abbrev");return{latitude:"{0} {1}".format(k.formatAngle(Math.abs(a),f,l,c),d),longitude:"{0} {1}".format(k.formatAngle(Math.abs(b),f,l,c),g)}};k.formatXYCoordinate=
function(a,b,f){if(null==f||"undefined"===typeof f)f=4;return d.FormatUtils.formatNumber(a,d.NumberFormat.NUMBER,{fractionalDigits:f})};k.formatBearing=function(a,b,f,l){if(0===a)return k.getResource(f,"north-abbrev");if(90===a)return k.getResource(f,"east-abbrev");if(180===a)return k.getResource(f,"south-abbrev");if(270===a)return k.getResource(f,"west-abbrev");var c=k.getResource(f,"north-abbrev"),d=k.getResource(f,"east-abbrev");90<=a&&180>a?(c=k.getResource(f,"south-abbrev"),a=180-a):180<=a&&
270>a?(c=k.getResource(f,"south-abbrev"),d=k.getResource(f,"west-abbrev"),a-=180):270<=a&&360>a&&(d=k.getResource(f,"west-abbrev"),a=360-a);return"{0} {1} {2}".format(c,k.formatAngle(a,b,f,l),d)};k.getResource=c})(g.CoordinateUtils||(g.CoordinateUtils={}))})(d.coordinates||(d.coordinates={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var h=d.essentials.documents.DocumentField,c=d.essentials.documents.FilterMethod,b=d.essentials.documents.FilterType,a=function(a){function f(b,f,c){a.call(this,b,f);this._pageSize=10;this._queryParams={};this.stopFetching=this.isInitialized=!1;this.items=new ObservableCollection;this.numberOfItems=new Observable(0);this.currIndexStart=new Observable(0);this.currIndexStartFromOne=new Observable(1);this.currIndexEnd=new Observable(0);
this.currPageNumber=new Observable(1);this.firstPageNumber=new Observable(1);this.lastPageNumber=new Observable(1);this.statusFetching=new Observable(!1);this.statusOffline=new Observable(!1);this._mapCallback=c}__extends(f,a);f.prototype.initialize=function(a){var b=this;void 0===a&&(a={});a.pageSize&&(this._pageSize=a.pageSize);a.queryParams&&(this._queryParams=dojo.mixin(this._queryParams,a.queryParams));a.fileType&&this.addFilter({field:h.FILE_TYPE,method:c.VALUES,range:[{string:a.fileType}]});
this.isInitialized=!0;this.currIndexStartFromOne.syncTransform(this.currIndexStart,function(a){return a+1});this.currPageNumber.bind(this,function(){return b._handlePageChanged()});this._populateFromDocStore()};f.prototype.getLength=function(){return this.numberOfItems.get()};f.prototype.nextPage=function(){this.currPageNumber.set(this.currPageNumber.get()+1)};f.prototype.prevPage=function(){this.currPageNumber.set(this.currPageNumber.get()-1)};f.prototype.refresh=function(){this._populateFromDocStore()};
f.prototype.destroy=function(){a.prototype.destroy.call(this);this.items&&this.items.clear()};f.prototype.setQueryParameters=function(a){this._queryParams=a;this.currPageNumber.set(1)};f.prototype.getQueryParameters=function(){return this._queryParams};f.prototype.addFilter=function(a,e){void 0===e&&(e=b.REQUIRE);this._queryParams.filters||(this._queryParams.filters={});this._queryParams.filters[e]||(this._queryParams.filters[e]=[]);this._queryParams.filters[e]=this._queryParams.filters[e].filter(function(b){return b.field!==
a.field});this._queryParams.filters[e].push(a);this.currPageNumber.set(1)};f.prototype.removeFilter=function(a,e){void 0===e&&(e=b.REQUIRE);this._queryParams.filters&&this._queryParams.filters[e]&&(this._queryParams.filters[e]=this._queryParams.filters[e].filter(function(b){return b.field!==a}),0===this._queryParams.filters[e].length&&delete this._queryParams.filters[e],this.currPageNumber.set(1))};f.prototype.sortBy=function(a){a.fields&&0!==a.fields.length&&(a.descending?(delete this._queryParams.sort,
this._queryParams.sortDescending=a.fields):(delete this._queryParams.sortDescending,this._queryParams.sort=a.fields),this.currPageNumber.set(1))};f.prototype._handlePageChanged=function(){this.currPageNumber.value=Math.max(1,Number(this.currPageNumber.get()));this.currPageNumber.get()>this.lastPageNumber.get()&&0<this.lastPageNumber.get()?this.currPageNumber.set(this.lastPageNumber.get()):(this.currIndexStart.set((this.currPageNumber.get()-1)*this._pageSize),this.currIndexEnd.set(Math.min(this.numberOfItems.get(),
this.currIndexStart.get()+this._pageSize)),this._populateFromDocStore())};f.prototype._populateFromDocStore=function(){var a=this;if(this.app.site.documentStore.supported&&this.isInitialized&&!this.stopFetching){this.statusFetching.set(!0);var b=this._buildQueryParams();this.app.waitUntilSiteInitialized().then(function(){return a.statusOffline.set(!1)}).then(function(){return a.app.site.documentStore.query(b)}).then(function(b){return a._handleQueryResult(b)})["catch"](function(b){a.items.clear();
a.numberOfItems.set(0);a.statusOffline.set(!0);a.app.trace.error("Error fetching documents: {0}".format(b),b)})["finally"](function(){return a.statusFetching.set(!1)})}};f.prototype._buildQueryParams=function(){var a=dojo.mixin({},this._queryParams);a.start=this.currIndexStart.get();a.limit=this._pageSize;return a};f.prototype._handleQueryResult=function(a){this.items.set(a.results.map(this._mapCallback));a=a.total?a.total:0;this.numberOfItems.set(a);a=Math.ceil(a/this._pageSize);this.lastPageNumber.set(a);
this.firstPageNumber.set(1);this.currIndexStart.set((this.currPageNumber.get()-1)*this._pageSize);this.currIndexEnd.set(Math.min(this.numberOfItems.get(),this.currIndexStart.get()+this._pageSize))};return f}(d.framework.FrameworkObject);g.DocumentCollection=a})(h.documents||(h.documents={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var h=function(c){function b(){c.apply(this,arguments);this.autoCompleteMinLength=0;this.autoCompleteMaxEntries=10}__extends(b,c);b.prototype.added=function(a){c.prototype.added.call(this,a);this._setupJQueryAutocomplete()};b.prototype.handleInputChanged=function(a,b,f){this.viewModel.validateSearchInput()};b.prototype.handleAddMonikerButtonClick=function(a,b,f){this.viewModel.addMoniker();this.viewModel.resetOptions()};b.prototype.handleUpdateMoniker=
function(a,b,f){this.viewModel.updateMoniker(f,b.value);return!0};b.prototype.handleAutoCompleteBlur=function(a,b,f){$(b).autocomplete("widget").hide()};b.prototype.getSuggestions=function(a,b){var f=this;this.viewModel.searchMonikers(a.term).then(function(a){return f._processMonikers(a)}).then(function(a){return b(a)})["catch"](function(a){return b([])})};b.prototype._processMonikers=function(a){var b=[];0<a.length&&(b=a.slice(0,this.autoCompleteMaxEntries).map(function(a){return{label:a.title,moniker:a}}));
return Promise.resolve(b)};b.prototype._setupJQueryAutocomplete=function(){var a=this,b={minLength:this.autoCompleteMinLength,source:function(b,e){a.getSuggestions(b,e)},select:function(b,e){a._handleAutoCompleteSelect(b,e);return!1}};$(this.autoCompleteInput).autocomplete(b)};b.prototype._handleAutoCompleteSelect=function(a,b){this.viewModel.searchText.set(b.item.label);this.viewModel.selectedMoniker.set(b.item.moniker)};return b}(d.framework.ui.ViewBase);g.GrantEditorView=h})(h.documents||(h.documents=
{}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var h=d.framework.utils.ArrayUtils,c=d.essentials.documents.BatchRequestBuilder,b=d.essentials.documents.GrantID,a=d.essentials.documents.GrantKind,e=d.essentials.documents.MonikerKind,f=function(f){function d(e,c){var n=this;f.call(this,e,c);this._supportedGrantKinds=[a.READER,a.WRITER];this._globalGrantIds=[b.PUBLIC,b.USER];this._allowPublicAccess=!1;this._lastSearchResults=[];this.defaultGrantKind=a.READER;this.userIconUri="Resources/Images/Icons/user-24.png";
this.roleIconUri="Resources/Images/Icons/team-24.png";this.document=null;this.grants=[];this.monikers=new ObservableCollection;this.isValidMoniker=new Observable(!1);this.monikerKinds=new ObservableCollection;this.selectedMonikerKind=new Observable;this.selectedMoniker=new Observable;this.searchText=new Observable;this.enabled=new Observable(!0);this.searchText.syncTransform(this.selectedMonikerKind,function(){return""});this.isValidMoniker.syncTransform(this.selectedMoniker,function(a){return!!a});
this.enabled.bind(this,function(){return n._setMonikerEnableds()});this._setMonikerKinds();if(this.app.site&&this.app.site.isInitialized)this.onSiteInitialized();else this.app.event("SiteInitializedEvent").once(this,this.onSiteInitialized)}__extends(d,f);d.prototype.onSiteInitialized=function(){var e=this;this.app.site.documentStore.onInitialized().then(function(){e._allowPublicAccess=e.app.site.documentStore.hasPolicyGrant(function(e){return e.globalId===b.PUBLIC&&e.kind===a.GLOBAL_READER})})};d.prototype.loadById=
function(a){var b=this;return this.app.waitUntilSiteInitialized().then(function(){return b.app.site.documentStore.getById(a)}).then(function(a){return b._updateModel(a)})["catch"](function(a){b.app.trace.error("Error loading document: {0}".format(a),a);b.reset()})};d.prototype.addMoniker=function(){var a=this._getSelectedMoniker();if(a)if(this._monikerExists(a))this.app.trace.warning("GrantEditorViewModel: Could not add the grant as it already exists.");else{var b=this.addGrant(a.globalId,this.defaultGrantKind);
this.monikers.addItem(new g.MonikerModel({grant:b,name:a.title,iconUri:this._isUserKind(this.selectedMonikerKind.get())?this.userIconUri:this.roleIconUri}));this._setMonikerEnableds()}else this.app.trace.error("GrantEditorViewModel: Could not find moniker with title {0}.".format(this.searchText.get()))};d.prototype.addGrant=function(a,b){var e={globalId:a,kind:b,assert:!0};this.grants.push(e);return e};d.prototype.updateMoniker=function(b,e){b.grants.forEach(function(a){a.assert=!1;a.revoke=!0});
switch(e){case a.READER:case a.WRITER:var f=h.firstOrDefault(b.grants,function(a){return a.kind===e});f||(f=this.addGrant(b.id,e),b.addGrant(f));f.assert=!0;f.revoke=!1;this._globalGrantIds.some(function(a){return a===b.id})||b.isRevoked.set(!1);break;default:this._globalGrantIds.some(function(a){return a===b.id})||b.isRevoked.set(!0)}};d.prototype.searchMonikers=function(a){var b=this,e;e=this._isUserKind(this.selectedMonikerKind.get())?c.searchUsers(a):c.searchRoles(a);return this.app.waitUntilSiteInitialized().then(function(){return b.app.site.documentStore.perform(e)}).then(function(a){return b._lastSearchResults=
a.monikers})};d.prototype.validateSearchInput=function(){var a=this;this.selectedMoniker.get()&&this.searchText.get()&&this.isValidMoniker.set(this._lastSearchResults.some(function(b){return b.title===a.searchText.get()}))};d.prototype.resetOptions=function(){this.searchText.set(null);this.selectedMoniker.set(null)};d.prototype.reset=function(){this._updateModel(null)};d.prototype._getSelectedMoniker=function(){var a=this;return this.selectedMoniker.get().title===this.searchText.get()?this.selectedMoniker.get():
this._lastSearchResults.filter(function(b){return b.title===a.searchText.get()})[0]};d.prototype._isUserKind=function(a){return a===e.USER};d.prototype._updateModel=function(a){this.grants=(this.document=a)&&a.grants?a.grants:[];this.resetOptions();this._updateMonikers(this.grants)};d.prototype._updateMonikers=function(a){this.monikers.clear();for(var e=[],f=0;f<this._globalGrantIds.length;f++){var l=this._globalGrantIds[f];e.push(new g.MonikerModel({id:l,name:this.app.getResource(this.libraryId,
"language-grant-editor-global-grant-name-{0}".format(l)),iconUri:this.roleIconUri,isGlobal:!0,isPublic:l===b.PUBLIC}))}for(f=0;f<this._supportedGrantKinds.length;f++)for(l=0;l<a.length;l++){var c=a[l];if(c.kind===this._supportedGrantKinds[f]){var d=h.firstOrDefault(e,function(a){return a.id===c.globalId});d?d.addGrant(c):e.push(new g.MonikerModel({grant:c,iconUri:this._isUserKind(c.subject.kind)?this.userIconUri:this.roleIconUri}))}}this._allowPublicAccess||(e=e.filter(function(a){return!a.isPublic}));
this.monikers.addItems(e);this._setMonikerEnableds()};d.prototype._monikerExists=function(a){if(!a)return!1;var b=this.monikers.getItems();if(b.some(function(b){return b.id===a.globalId}))return!0;if(a.aliases)for(var e=0;e<a.aliases.length;e++){var f=a.aliases[e];if(b.some(function(a){return a.id===f}))return!0}return!1};d.prototype._setMonikerKinds=function(){this.monikerKinds.addItems([{kind:e.USER,displayName:this.app.getResource(this.libraryId,"language-grant-editor-moniker-type-user")},{kind:e.ROLE,
displayName:this.app.getResource(this.libraryId,"language-grant-editor-moniker-type-role")}]);this.selectedMonikerKind.set(this.monikerKinds.getAt(0).kind)};d.prototype._setMonikerEnableds=function(){for(var a=this.enabled.get(),b=0,e=this.monikers.length();b<e;b++)this.monikers.getAt(b).enabled.set(a)};return d}(d.framework.ui.ViewModelBase);g.GrantEditorViewModel=f})(h.documents||(h.documents={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||
(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(){function c(b){this.name=new Observable;this.linkUrl=new Observable;b.kind&&(this.kind=b.kind);b.name&&this.name.set(b.name)}c.prototype.reset=function(){this.link=this.grant=null;this.linkUrl.set(null)};return c}();d.GuestLinkModel=h})(d.documents||(d.documents={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){function h(a,b,c){var d=a+"/"+b;e.hasOwnProperty(a)&&(d+="/submitjob");return esri.request({callbackParamName:"callback",content:dojo.mixin({f:"json"},c),handleAs:"json",url:d}).then(function(d){return!d.jobStatus&&d.executionType&&d.parameters?(e[a]=!0,h(a,b,c)):d})}function c(b,e,d,g){void 0===g&&(g=1E3);switch(d.jobStatus){case esri.tasks.JobInfo.STATUS_CANCELLED:case esri.tasks.JobInfo.STATUS_DELETED:case esri.tasks.JobInfo.STATUS_FAILED:case esri.tasks.JobInfo.STATUS_TIMED_OUT:return Promise.reject(a(d));
case esri.tasks.JobInfo.STATUS_SUCCEEDED:return Promise.resolve(d);default:return Promise.delay(g).then(function(){return esri.request({callbackParamName:"callback",content:{f:"json"},handleAs:"json",url:b+"/"+e+"/jobs/"+d.jobId})}).then(function(a){return c(b,e,a,Math.min(2*g,6E4))})}}function b(a,b,e,c){return esri.request({callbackParamName:"callback",content:{f:"json"},handleAs:"json",url:a+"/"+b+"/jobs/"+e+"/"+c})}function a(a){if(!a||!a.messages)return"";a=a.messages.filter(function(a){return a.type===
esri.tasks.GPMessage.TYPE_ERROR});var b=a.filter(function(a){return/^ERROR \d+:/.test(a.description)});0<b.length&&(a=b);return a.reduce(function(a,b){return b.description.length>a.length?b.description:a},"")}var e={};d.exportTiles=function(a,e){for(var d="string"===typeof a?a:a.url;"/"===d[d.length-1];)d=d.substring(0,d.length-1);return h(d,"exportTiles",e).then(function(a){return c(d,"exportTiles",a)}).then(function(a){return b(d,"exportTiles",a.jobId,a.results.out_service_url.paramUrl)}).then(function(a){return esri.request({callbackParamName:"callback",
content:{f:"json"},handleAs:"json",url:a.value})}).then(function(a){return a.files})};d.estimateExportTilesSize=function(a,e){for(var d="string"===typeof a?a:a.url;"/"===d[d.length-1];)d=d.substring(0,d.length-1);return h(d,"estimateExportTilesSize",e).then(function(a){return c(d,"estimateExportTilesSize",a)}).then(function(a){return b(d,"estimateExportTilesSize",a.jobId,a.results.out_service_url.paramUrl)}).then(function(a){return"string"===typeof a.value?{totalSize:+a.value,totalTilesToExport:null}:
a.value})}})(d.ExportTilesUtils||(d.ExportTilesUtils={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){function h(a,b){void 0===b&&(b={});html4.ATTRIBS["*::aria-label"]=0;html4.ATTRIBS["*::data-replacement-token"]=0;html4.ATTRIBS["a::target"]=0;b.allowFrames&&(html4.ATTRIBS["iframe::src"]=1);return html.sanitize(a,function(a,l,d,g){if(b.uriTransformer){a=a.toString();l=void 0;if("MARKUP"===g.TYPE)l={uri:a,type:"a"===g.XML_TAG&&"href"===g.XML_ATTR?c.NavigableLink:c.Markup,tag:g.XML_TAG,attribute:g.XML_ATTR};else if("CSS"===g.TYPE)l={uri:a,
type:c.Css,property:g.CSS_PROP};else throw Error("Unknown URI hint type: '"+g.TYPE+"'");return b.uriTransformer(a,l)}return""})}d.sanitize=h;d.stripHtml=function(a){a=String.unescapeHtml(a);a=h(a);var b=document.createElement("div");b.innerHTML=a;return b.innerText||b.textContent};(function(a){a[a.Markup=0]="Markup";a[a.Css=1]="Css";a[a.NavigableLink=2]="NavigableLink"})(d.UriType||(d.UriType={}));var c=d.UriType,b=function(){function a(a,b){void 0===b&&(b={});this.sanitize(a,b)}a.prototype.sanitize=
function(a,b){void 0===b&&(b={});this._unsafeHtml=a;this._safeHtml=h(this._unsafeHtml,b)};Object.defineProperty(a.prototype,"unsafeHtml",{get:function(){return this._unsafeHtml},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"safeHtml",{get:function(){return this._safeHtml},enumerable:!0,configurable:!0});return a}();d.UnsafeHtml=b;(function(a){function b(a){var e=a.match(/^\s*data:(.*?),.+/i);if(!e)return null;for(var e=e[1],c,d,g,h=0,k=e.split(";");h<k.length;h++){var m=k[h];
if(/^charset=(.+)$/i.test(m)){if(d)return null;d=m}else if(/^base64$/i.test(m)){if(g)return null;g=m}else if(/^.+$/i.test(m)){if(c)return null;c=m}}h=a.indexOf(",")+1;return{uri:a,meta:e,mediaType:c,charset:d,extension:g,payloadIndex:h}}a.dataUriMediaTypeWhitelist=["image/jpeg","image/png","image/gif","image/svg+xml"];a.parseDataUri=b;a.isDataUriSafe=function(f){f=b(f);if(!f)return!1;var c=f.mediaType;c||(c="text/plain");return a.dataUriMediaTypeWhitelist.some(function(a){return c.toLowerCase()===
a.toLowerCase()})?!0:!1}})(d.DataUri||(d.DataUri={}))})(d.FilterUtils||(d.FilterUtils={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(g){(function(b){b[b.BOTTOM_LEFT=0]="BOTTOM_LEFT";b[b.MIDDLE=1]="MIDDLE";b[b.CALLOUT=2]="CALLOUT"})(g.HighlightedLabelAnchor||(g.HighlightedLabelAnchor={}));var k=g.HighlightedLabelAnchor,c=function(){function b(a,b){this.textGraphics=[];this.textSymbols=[];this._padding=this._width=this._height=0;this._calloutSizeWidthFraction=5;this._tagHeightPercentage=0.6;if(!b||!this._processConfig(a))throw Error("HighlightedLabelGraphic: Initialization failed.");
this.app=b;this.graphicsLayer=d.GraphicUtils.getGraphicsLayer(this._config.layerId,!0,this.app);a._isRestoringState||this._executeSetupRoutine()}b.prototype.getTextFontFamily=function(){return this.textSymbols&&0<this.textSymbols.length?this.textSymbols[0].font.family:this._config.fontFamily};b.prototype.getTextFontSize=function(){return this.textSymbols&&0<this.textSymbols.length?this.textSymbols[0].font.size+"px":this._config.fontSize};b.prototype.getWidth=function(){return this._width};b.prototype.getTotalWidth=
function(){return this._width+this._padding};b.prototype.getHeight=function(){return this._height};b.prototype.getTotalHeight=function(){return this._height+this._padding};b.prototype.getMapPoint=function(){return this._config.mapPoint};b.prototype.getConfig=function(){return this._config};b.prototype.addToLayer=function(a){var b=this;void 0===a&&(a=!0);d.GraphicUtils.addGraphicToLayer(this.highlightGraphic,this._config.layerId,this.app);d.GraphicUtils.addGraphicToLayer(this.highlightIdTagGraphic,
this._config.layerId,this.app);this.textGraphics.forEach(function(a){d.GraphicUtils.addGraphicToLayer(a,b._config.layerId,b.app)});a?this.show():this.hide()};b.prototype.removeFromLayer=function(a){this.hide();var b=function(a){var b=a.getLayer();b&&b.remove(a)};this.textGraphics&&0<this.textGraphics.length&&(this.textGraphics.forEach(function(a){return b(a)}),a&&(this.textGraphics.length=0,this.textSymbols.length=0));this.highlightIdTagGraphic&&(b(this.highlightIdTagGraphic),a&&(this.highlightIdTagSymbol=
this.highlightIdTagGraphic=null));this.highlightGraphic&&(b(this.highlightGraphic),a&&(this.highlightIdTagSymbol=this.highlightGraphic=null))};b.prototype.isVisible=function(){return this.highlightGraphic?this.highlightGraphic.visible&&(!this._config.calloutWithIdTag||this.highlightIdTagGraphic.visible)&&0<this.textGraphics.filter(function(a){return a.visible}).length:!1};b.prototype.show=function(){this.highlightGraphic&&this.highlightGraphic.show();this.highlightIdTagGraphic&&this.highlightIdTagGraphic.show();
this.textGraphics&&0<this.textGraphics.length&&this.textGraphics.forEach(function(a){a.show()});return this};b.prototype.hide=function(){this.textGraphics&&0<this.textGraphics.length&&this.textGraphics.forEach(function(a){a.hide()});this.highlightIdTagGraphic&&this.highlightIdTagGraphic.hide();this.highlightGraphic&&this.highlightGraphic.hide();return this};b.prototype.update=function(a,b){if(this.highlightGraphic&&this.textGraphics.length){var f=this.isVisible(),c=this._key?this.highlightGraphic[this._key]:
null;this._config.text=b||"";this._config.mapPoint=a&&a instanceof esri.geometry.Point?a:this._config.mapPoint;this.removeFromLayer(!0);this._executeSetupRoutine();this.addToLayer(f);c&&this.assignGraphicIdentifierKey(this._key,c)}};b.prototype.refresh=function(a){if(this.highlightGraphic&&this.textGraphics.length){var b=this.isVisible(),f=this._key?this.highlightGraphic[this._key]:null;this._config.text=a||"";this.removeFromLayer(!0);this._executeSetupRoutine();this.addToLayer(b);f&&this.assignGraphicIdentifierKey(this._key,
f)}};b.prototype.moveToTop=function(){var a=this.highlightGraphic.getDojoShape();a&&a.moveToFront();this.highlightIdTagGraphic&&(a=this.highlightIdTagGraphic.getDojoShape())&&a.moveToFront();for(var b=0;b<this.textGraphics.length;b++)(a=this.textGraphics[b].getDojoShape())&&a.moveToFront()};b.prototype.assignGraphicIdentifierKey=function(a,b){this._key=a;this.highlightGraphic[a]=b;this.highlightIdTagGraphic&&(this.highlightIdTagGraphic[a]=b);this.textGraphics.forEach(function(f){f[a]=b})};b.prototype.updateIdTagText=
function(a){if(a&&this._config.calloutWithIdTag){this._config.idTagText=a;var b=this.textGraphics[this.textGraphics.length-1];b&&b.symbol&&(b.symbol.setText(a),b.setSymbol(b.symbol))}};b.prototype.setHighlightColor=function(a){a&&a instanceof esri.Color&&this.highlightSymbol&&(this._config.highlightColor=a,this.highlightSymbol&&this.highlightGraphic&&(this.highlightSymbol.setColor(a),this.highlightGraphic.setSymbol(this.highlightSymbol)));if(this._config.calloutWithIdTag){var b=this.textGraphics[this.textGraphics.length-
1];this.highlightIdTagSymbol&&this.highlightIdTagGraphic&&(this.highlightIdTagSymbol.outline.setColor(a),this.highlightIdTagGraphic.setSymbol(this.highlightIdTagSymbol));b&&(b.symbol.setColor(a),b.setSymbol(b.symbol))}};b.prototype.setTextColor=function(a){if(a&&a instanceof esri.Color){this._config.textColor=a;var b=this.textGraphics.length;this._config.calloutWithIdTag&&(this.highlightIdTagSymbol&&this.highlightIdTagGraphic&&(this.highlightIdTagSymbol.setColor(a),this.highlightIdTagGraphic.setSymbol(this.highlightIdTagSymbol)),
b--);for(var f=0;f<b;f++){var c=this.textGraphics[f];c&&(c.symbol.setColor(a),c.setSymbol(c.symbol))}}};b.prototype.exportState=function(a){var b=a.project.convert;a=this.getConfig();return{highlightGraphic:b.fromEsriGraphic(this.highlightGraphic),highlightSymbol:b.fromEsriSymbol(this.highlightSymbol),textGraphics:this.textGraphics.map(function(a){return b.fromEsriGraphic(a)}),textSymbols:this.textSymbols.map(function(a){return b.fromEsriSymbol(a)}),layerId:a.layerId,mapPoint:b.fromEsriGeometry(this.getMapPoint()),
labelXoffset:a.labelXoffset,labelYoffset:a.labelYoffset,text:a.text,fontFamily:a.fontFamily,fontSize:a.fontSize,cornerRadius:a.cornerRadius,angle:a.angle,anchor:a.anchor,textColor:b.fromEsriColor(a.textColor),highlightColor:b.fromEsriColor(a.highlightColor),highlightOutlineSymbol:b.fromEsriSymbol(a.highlightOutlineSymbol)}};b.fromExportedState=function(a,e,f){return Promise["try"](function(){if(!a||!a.highlightGraphic)throw Error("HighlightedLabelGraphic.fromExportedState: Invalid state.");if(!e)throw Error('HighlightedLabelGraphic.fromExportedState: Parameter "app" is required.');
var c=e.project.convert,d={highlightGraphic:c.toEsriGraphic(a.highlightGraphic),textGraphics:Promise.map(a.textGraphics,function(a){return c.toEsriGraphic(a)})};return Promise.props(d).then(function(d){var n={layerId:a.layerId,mapPoint:c.toEsriGeometry(a.mapPoint),text:a.text,labelXoffset:a.labelXoffset,labelYoffset:a.labelYoffset,fontFamily:a.fontFamily,fontSize:a.fontSize,cornerRadius:a.cornerRadius,angle:a.angle,anchor:a.anchor,textColor:c.toEsriColor(a.textColor),highlightColor:c.toEsriColor(a.highlightColor),
highlightOutlineSymbol:c.toEsriSymbol(a.highlightOutlineSymbol),_isRestoringState:!0};f=f||b.prototype;var g=Object.create(f);g.constructor.call(g,n,e);g.initializeHighlightDimensions();g.highlightGraphic=d.highlightGraphic;g.highlightSymbol=c.toEsriSymbol(a.highlightSymbol);g.textGraphics=d.textGraphics;g.textSymbols=a.textSymbols.map(function(a){return c.toEsriSymbol(a)});return g})})};b.prototype._executeSetupRoutine=function(){this.initializeHighlightDimensions();this.initializeHighlightGraphic();
this.initializeHighlighteIdTagGraphic();this.initializeTextGraphicsAndSymbols()};b.prototype.setHighlightAnchor=function(){switch(this._config.anchor){case k.BOTTOM_LEFT:this.highlightSymbol.setOffset(this.getTotalWidth()/2,this.getTotalHeight()/2);break;case k.CALLOUT:this.highlightSymbol.setOffset(0,this.getTotalHeight()/2+this._config.calloutPixelSize/4);break;default:this.highlightSymbol.setOffset(0,0)}this.highlightSymbol.setOffset(this.highlightSymbol.xoffset+this._config.labelXoffset,this.highlightSymbol.yoffset+
this._config.labelYoffset)};b.prototype.setTextAnchor=function(a,b){switch(this._config.anchor){case k.MIDDLE:this.textSymbols[a].setOffset(0,b);break;case k.BOTTOM_LEFT:this.textSymbols[a].setOffset(this.getTotalWidth()/2,b+this.getTotalHeight()/2);break;case k.CALLOUT:this.textSymbols[a].setOffset(0,b+this.getTotalHeight()/2+this._config.calloutPixelSize/2)}};b.prototype.initializeHighlightDimensions=function(){var a=d.highlightedLabel.HighlightedLabelUtils.getLabelSize(this._config.text,this._config.fontFamily,
this._config.fontSize,this._config.layerId),b=0.5*a.height,f=this._config.calloutWithIdTag?a.height+b:0;this._height=a.height;this._width=a.width+f;this._padding=b;this._config.calloutPixelSize=this._config.calloutPixelSize||Math.floor(this._width/this._calloutSizeWidthFraction)};b.prototype.initializeHighlightGraphic=function(){this.highlightGraphic=new esri.Graphic;this.highlightGraphic.highlightedTextLabel=!0;this.highlightSymbol=new esri.symbol.SimpleMarkerSymbol;this.highlightGraphic.setGeometry(this._config.mapPoint);
this.configureHighlightSymbol(this._config.highlightColor,this._config.highlightOutlineSymbol,this._config.fontSize)};b.prototype.initializeHighlighteIdTagGraphic=function(){this._config.calloutWithIdTag&&(this.highlightIdTagGraphic=new esri.Graphic,this.highlightIdTagSymbol=new esri.symbol.SimpleMarkerSymbol,this.highlightIdTagGraphic.setGeometry(this._config.mapPoint),this.configureHighlightIdTagSymbol(this._config.textColor,this._config.fontSize))};b.prototype.configureHighlightSymbol=function(a,
b,f){this.setHighlightAnchor();this.highlightSymbol.setStyle("STYLE_PATH");var c=d.highlightedLabel.HighlightedLabelUtils.generateSvgHighlightLabelPath(this.getTotalWidth(),this.getTotalHeight(),this._config.cornerRadius,this._config.calloutWithIdTag,this._config.calloutPixelSize);this.highlightSymbol.setPath(c);this.highlightSymbol.setColor(a);this.highlightSymbol.setOutline(b);this.highlightSymbol.setAngle(this._config.angle);this.highlightSymbol.setSize(f);this.highlightGraphic.setSymbol(this.highlightSymbol)};
b.prototype.configureHighlightIdTagSymbol=function(a,b){var f=-(this.getTotalWidth()/2-this.getTotalHeight()/2),c=this.getTotalHeight()/2+this._config.calloutPixelSize/2;this.highlightIdTagSymbol.setStyle("STYLE_PATH");this.highlightIdTagSymbol.setPath(g.HighlightedLabelUtils.generateSvgCirclePath(this.getTotalHeight()*this._tagHeightPercentage/2));this.highlightIdTagSymbol.setColor(a);this.highlightIdTagSymbol.outline&&this.highlightIdTagSymbol.outline.setColor(a);this.highlightIdTagSymbol.setOffset(f+
this._config.labelXoffset,c+this._config.labelYoffset);this.highlightIdTagSymbol.setSize(this.getTotalHeight()*this._tagHeightPercentage);this.highlightIdTagGraphic.setSymbol(this.highlightIdTagSymbol)};b.prototype.initializeTextGraphicsAndSymbols=function(){if(this._config.text){var a=d.highlightedLabel.HighlightedLabelUtils.getTextLines(this._config.text);if(a&&a.length&&0!==a.length){var b=a.length,f=new esri.symbol.Font;f.setSize(this._config.fontSize);f.setFamily(this._config.fontFamily);var c=
this.getHeight()/b,n=Math.abs(f.size-c),g=this.getHeight()/2/c;this.textGraphics=[];this.textSymbols=[];for(var p=0;a&&0<a.length&&p<a.length;p++){this.textGraphics[p]||(this.textGraphics[p]=new esri.Graphic);this.textSymbols[p]||(this.textSymbols[p]=new esri.symbol.TextSymbol(""));this.textGraphics[p].geometry!==this._config.mapPoint&&this.textGraphics[p].setGeometry(this._config.mapPoint);this.configureTextSymbol(p,a[p],this._config.textColor,f,this._config.angle,(g-(p+1))*c+n);if(1===b){this.textSymbols[p].setHorizontalAlignment(esri.symbol.TextSymbol.ALIGN_MIDDLE);
var k=Math.PI/180*this._config.angle;this.textSymbols[p].setOffset(-(c/2/2*Math.sin(k)),-Math.abs(c/2/2*Math.cos(k)));k={customVerticalAlignment:"middle",numberOfLines:1}}else this.textSymbols[p].setHorizontalAlignment(esri.symbol.TextSymbol.ALIGN_START),this.textSymbols[p].setVerticalAlignment(esri.symbol.TextSymbol.ALIGN_START),k={customVerticalAlignment:"middle",numberOfLines:b};this.textGraphics[p].setAttributes(k);k=this._config.calloutWithIdTag?this.getTotalHeight()/2:0;this.textSymbols[p].setOffset(this.textSymbols[p].xoffset+
this._config.labelXoffset+k,this.textSymbols[p].yoffset+this._config.labelYoffset);this.textGraphics[p].setSymbol(this.textSymbols[p])}this._config.calloutWithIdTag&&(a=new esri.symbol.Font,a.setSize(this._config.fontSize),a.setSize(Math.floor(1.25*a.size)),a.setFamily(this._config.fontFamily),a.setWeight(esri.symbol.Font.WEIGHT_BOLD),f=new esri.Graphic,f.setGeometry(this._config.mapPoint),this.textGraphics.push(f),c=new esri.symbol.TextSymbol(this._config.idTagText),this.textSymbols.push(c),this.configureTextSymbol(b,
this._config.idTagText,this._config.highlightColor,a,0,0),b=-(this.getTotalWidth()/2-this.getTotalHeight()/2),c.setOffset(c.xoffset+b,c.yoffset+-(a.size/3)),f.setSymbol(c))}}};b.prototype.configureTextSymbol=function(a,b,f,c,d,g){this.textSymbols&&a<this.textSymbols.length&&(this.textSymbols[a].setText(b),this.textSymbols[a].setFont(c),this.textSymbols[a].setColor(f),this.textSymbols[a].setAngle(d),this.setTextAnchor(a,g))};b.prototype._processConfig=function(a){if(!a||!a.layerId||!a.mapPoint)return!1;
a.calloutWithIdTag=void 0==a.calloutWithIdTag?!1:!!a.calloutWithIdTag;a.idTagText=a.idTagText||"";a.calloutPixelSize=a.calloutPixelSize||0;a.labelXoffset=a.calloutWithIdTag?0:a.labelXoffset||0;a.labelYoffset=a.calloutWithIdTag?0:a.labelYoffset||0;a.layerId=a.layerId;a.mapPoint=a.mapPoint;a.text=a.text||"";a.fontFamily=a.fontFamily||"Arial";a.fontSize=a.fontSize||"12px";a.cornerRadius=void 0==a.cornerRadius?5:a.cornerRadius;a.angle=a.calloutWithIdTag?0:a.angle||0;a.anchor=a.calloutWithIdTag?k.CALLOUT:
void 0!=a.anchor?a.anchor:k.MIDDLE;a.textColor=a.textColor&&a.textColor instanceof esri.Color?a.textColor:new esri.Color("white");a.highlightColor=a.highlightColor&&a.highlightColor instanceof esri.Color?a.highlightColor:new esri.Color("black");a.highlightOutlineSymbol=a.highlightOutlineSymbol&&a.highlightOutlineSymbol instanceof esri.symbol.SimpleLineSymbol?a.highlightOutlineSymbol:new esri.symbol.SimpleLineSymbol;this._config=a;return!0};return b}();g.HighlightedLabelGraphic=c})(d.highlightedLabel||
(d.highlightedLabel={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(){function c(b,a){this.app=b;this.libraryId=a}c.prototype.initialize=function(b){};c.prototype.filter=function(b,a){return Promise.resolve()};return c}();d.LayerCatalogFilterProviderBase=h})(d.layerCatalog||(d.layerCatalog={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){g.discoverFeatureServices=function(a){return new Promise(function(b,f){esri.request({url:a,content:{f:"json"},handleAs:"json"}).then(function(c){if("layers"in c){var d=[],g=0;for(c=c.layers;g<c.length;g++){var h=c[g];h.subLayerIds||d.push(a+"/"+h.id)}b(d)}else"fields"in c?b([a]):f(Error("Unknown response type from url ("+a+")."))},f)})};g.buildFeatureLayerService=function(a){var b=new d.essentials.FeatureLayerService;b._createFrom({id:d.framework.utils.alphaNumericToken(),
displayName:d.framework.utils.alphaNumericToken(),serviceType:d.essentials.MapServiceType.FEATURE,serviceFunction:d.essentials.MapServiceFunction.OPERATIONAL,connectionString:a});b.serviceUrl=a;b.outFields="*";b.isUserCreated=!0;b.userLayerType=d.essentials.UserLayerType.UPLOAD;b._createServiceLayer();return new Promise(function(a,c){b.serviceLayer.on("load",function(c){b.displayName=b.serviceLayer.name;c=new d.essentials.Layer;c._createFrom(b.serviceLayer);c.id=b.serviceLayer.layerId.toString();
c.type=d.essentials.LayerType.FEATURE_LAYER;c.userLayerType=d.essentials.UserLayerType.UPLOAD;c.isUserCreated=!0;var l=b.serviceLayer;"esriGeometryPoint"===l.geometryType&&(c.featureType="Point");"esriGeometryPolyline"===l.geometryType&&(c.featureType="Line");"esriGeometryPolygon"===l.geometryType&&(c.featureType="Polygon");c.mapService=b;b.layers.push(c);a(b)})})};g.buildKmlService=function(a,b){void 0===b&&(b={});var f=new d.essentials.KmlService;b=$.extend({id:d.framework.utils.alphaNumericToken(),
serviceType:d.essentials.MapServiceType.KML,serviceFunction:d.essentials.MapServiceFunction.OPERATIONAL,serviceUrl:a,drawingBehavior:d.essentials.DrawingBehavior.KML_SERVICE,connectionString:a},b);f._createFrom(b);f.isUserCreated=!0;f.userLayerType=d.essentials.UserLayerType.UPLOAD;f._createServiceLayer();return new Promise(function(a,b){f.serviceLayer.on("load",function(b){a(f)})})};g.buildLocalFeatureLayerService=function(a,e){void 0===e&&(e={});var f=new c;e=$.extend({id:d.framework.utils.alphaNumericToken()+
":Local",displayName:a.layerDefinition.name,serviceType:d.essentials.MapServiceType.FEATURE,serviceFunction:d.essentials.MapServiceFunction.OPERATIONAL,connectionString:f.url},e);f._createFrom(e);f.isUserCreated=!0;f.userLayerType=d.essentials.UserLayerType.UPLOAD;var l=f.serviceLayer=new k(a);l.id=f.id;l.layerId=0;l.name=a.layerDefinition.name;l.graphics.length&&(l.fullExtent=esri.graphicsExtent(l.graphics));l.setEditable(!1);var n=new b;n._createFrom(l);n.id=l.layerId.toString();n.primaryKeyField=
n.getFieldByName(l.objectIdField);n.mapService=f;n.type=d.essentials.LayerType.FEATURE_LAYER;n.userLayerType=d.essentials.UserLayerType.UPLOAD;n.isUserCreated=!0;a.layerDefinition&&a.layerDefinition.geometryType&&(l=a.layerDefinition.geometryType.toLowerCase(),-1<l.indexOf("point")?n.featureType="Point":-1<l.indexOf("line")?n.featureType="Line":-1<l.indexOf("polygon")&&(n.featureType="Polygon"));n.queryable=!1;n.supportsQuery=!1;n.supportsIdentify=!0;n.identifiable=!0;n.searchable=!0;n.showMapTips=
!0;n.snappable=!0;n.snappingEnabled=!0;f.layers.push(n);return Promise.resolve(f)};var k=function(a){function b(e){a.call(this,e,{mode:esri.layers.FeatureLayer.MODE_SNAPSHOT})}__extends(b,a);b.prototype.queryFeatures=function(b,e,c){var d=new esri.tasks.Query;b.hasOwnProperty("geometry")&&(d.geometry="extent"!==b.geometry.type?b.geometry.getExtent():b.geometry);for(var g=0,k=["num","objectIds","returnGeometry","spatialRelationship"];g<k.length;g++){var m=k[g];d[m]=b[m]}return a.prototype.queryFeatures.call(this,
d,e,c).then(function(a){return Promise.all(a.features.map(function(a){return h.GeometryUtils.intersects(b.geometry,a.geometry)})).then(function(b){return a.features.filter(function(a,e){return!!b[e]})}).then(function(b){a.features=b;return a})})};return b}(esri.layers.FeatureLayer);g.LocalFeatureLayer=k;var c=function(a){function b(){a.apply(this,arguments)}__extends(b,a);return b}(d.essentials.FeatureLayerService);g.LocalFeatureLayerService=c;var b=function(a){function b(){a.apply(this,arguments)}
__extends(b,a);return b}(d.essentials.Layer);g.LocalLayer=b})(h.LayerIntegrationUtils||(h.LayerIntegrationUtils={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var h=function(c){function b(){c.apply(this,arguments)}__extends(b,c);b.prototype.selectAllLayers=function(a,b,f){this.viewModel.layerSelector.enableAllLayers()};b.prototype.clearAllLayers=function(a,b,f){this.viewModel.layerSelector.disableAllLayers()};b.prototype.handleExpanderClick=function(a,b,f){f.isExpanded.set(!f.isExpanded.get())};return b}(d.framework.ui.ViewBase);g.LayerSelectorViewBase=h})(h.layerSelector||(h.layerSelector=
{}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){var g;(function(k){var c=function(b){function a(a,f){b.call(this,a,f);this._layerSelectorInitialized=new Observable(!1);this.selectAllButtonText=new Observable(this.app.getResource(f,"language-layer-selector-default-select-all-text"));this.clearAllButtonText=new Observable(this.app.getResource(f,"language-layer-selector-default-clear-all-text"));this.selectAllButtonTitle=new Observable(this.app.getResource(f,"language-layer-selector-default-select-all-tooltip"));
this.clearAllButtonTitle=new Observable(this.app.getResource(f,"language-layer-selector-default-clear-all-tooltip"));this.items=new ObservableCollection([])}__extends(a,b);a.prototype.initialize=function(a){b.prototype.initialize.call(this,a);this._subscribeEvents();if(this.app.map&&this.app.site.isInitialized)this._setupLayerSelector();else this.app.event("SiteInitializedEvent").once(this,this._setupLayerSelector)};a.prototype.onInitialized=function(a){};a.prototype.onLayerSelectorFolderItemCreated=
function(a){};a.prototype.onLayerSelectorLayerItemCreated=function(a){};a.prototype.onLayerSelectorServiceLayerItemCreated=function(a){};a.prototype.filter=function(a){return!0};a.prototype.handleLayerStateChange=function(a){};a.prototype.handleAllLayersEnabled=function(){};a.prototype.handleAllLayersDisabled=function(){};a.prototype.getAllItems=function(){return a._expandItems(this.items.get())};a._expandItems=function(b){return b.concat.apply(b,b.map(function(b){return a._expandItems(b.items.get())}))};
a.prototype._setupLayerSelector=function(){var a=this;this.appInfo=h.gis.AppInfo.fromGeocortexApp(this.app);this.layerSelector=new g.LayerSelector(this.appInfo,{onInitializedHandler:function(b){return a.onInitialized(b)},layerFilter:function(b){return a.filter(b)},layerStateChangeHandler:function(b){return a.handleLayerStateChange(b)},enableAllLayersHandler:function(){return a.handleAllLayersEnabled()},disableAllLayersHandler:function(){return a.handleAllLayersDisabled()},onLayerSelectorFolderItemCreated:function(b){return a.onLayerSelectorFolderItemCreated(b)},
onLayerSelectorLayerItemCreated:function(b){return a.onLayerSelectorLayerItemCreated(b)},onLayerSelectorServiceLayerItemCreated:function(b){return a.onLayerSelectorServiceLayerItemCreated(b)}});this._layerSelectorInitialized.set(!0);this.items.sync(this.layerSelector.items);this.items.pulse()};a.prototype._subscribeEvents=function(){this.app.event("MapServiceAddedEvent").subscribe(this,this._handleMapServicesAdded);this.app.event("MapServiceRemovedEvent").subscribe(this,this._handleMapServiceRemoved);
this.app.event("MapServiceLayersChangedWithResultEvent").subscribe(this,this._handleMapServiceLayersChanged)};a.prototype._handleMapServicesAdded=function(a){var b=this;this._waitUntilLayerSelectorInitialized().then(function(){b.layerSelector.addUserAddedServiceLayer(a)})};a.prototype._handleMapServiceRemoved=function(a){var b=this;this._waitUntilLayerSelectorInitialized().then(function(){b.layerSelector.removeServiceLayer(a)})};a.prototype._handleMapServiceLayersChanged=function(a){var b=this;this._waitUntilLayerSelectorInitialized().then(function(){a&&
b.layerSelector.updateServiceLayer(a.mapService,a.newItems,a.oldItems)})};a.prototype._waitUntilLayerSelectorInitialized=function(){var a=this;return new Promise(function(b,c){if(a._layerSelectorInitialized.get())b();else a._layerSelectorInitialized.once(a,function(){return b()})})};return a}(d.framework.ui.ViewModelBase);k.LayerSelectorViewModelBase=c})(g=h.layerSelector||(h.layerSelector={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer=
{}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(){function c(b){this.app=b}c.prototype.message=function(b,a,e,f){var c=this;return new Promise(function(d,g){if(c.app.nativeManager.isNative()){var h;e&&e.register(function(){c.cancel(h)});var k;f&&(k=c.app.event("NativeMessageEvent").subscribe(c,function(a){"JobProgress"===a.type&&a.parameters.jobId===h&&("inProgress"===a.parameters.status?f(a.parameters):"complete"===a.parameters.status?(d(a.parameters.details),c.app.event("NativeMessageEvent").unsubscribe(k)):
"canceled"===a.parameters.status?(a=Error(a.parameters.details.message),a.name="OperationCanceled",g(a),c.app.event("NativeMessageEvent").unsubscribe(k)):"error"===a.parameters.status&&(g(Error(a.parameters.details.message)),c.app.event("NativeMessageEvent").unsubscribe(k)))}));c.app.nativeManager.onNativeInitialized().then(function(){return c.app.nativeManager.xhrPost({url:c.app.localServerAddress+"/message/"+b,postData:JSON.stringify(a),method:"POST"})}).then(function(a){a=JSON.parse(a);h=a.jobId;
e&&e.isCancellationRequested?c.cancel(h):h?c.app.nativeManager.xhrPost({url:c.app.localServerAddress+"/message/JobHandshake",postData:JSON.stringify({jobId:h}),method:"POST"}):d(a.result)})["catch"](function(a){try{var b=JSON.parse(a.response.data);g(Error(b.error.message))}catch(e){g(a)}})}else g(Error("Method not supported in browser."))})};c.prototype.cancel=function(b){if(b)return this.app.nativeManager.xhrPost({url:this.app.localServerAddress+"/message/CancelJob",postData:JSON.stringify({jobId:b}),
method:"POST"})};return c}();d.MessageClient=h})(d.nativeIntegration||(d.nativeIntegration={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){d.formatByteTransferRateString=function(d,c){var b=c/1024;if(1>b)return d.getResource("Mapping.Infrastructure","language-offline-progress-bytes-per-second").format(Math.round(c));var a=c/1048576;return 1>a?d.getResource("Mapping.Infrastructure","language-offline-progress-kilobytes-per-second").format(Math.round(b)):d.getResource("Mapping.Infrastructure","language-offline-progress-megabytes-per-second").format(Math.round(10*a)/10)};d.formatBytesString=
function(d,c){var b=c/1024;if(1>b)return d.getResource("Mapping.Infrastructure","language-offline-progress-bytes").format(c);var a=c/1048576;if(1>a)return d.getResource("Mapping.Infrastructure","language-offline-progress-kilobytes").format(Math.round(b));b=c/1073741824;return 1>b?d.getResource("Mapping.Infrastructure","language-offline-progress-megabytes").format(Math.round(a)):d.getResource("Mapping.Infrastructure","language-offline-progress-gigabytes").format(Math.round(100*b)/100)}})(d.offline||
(d.offline={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var m=function(){function c(b){var a=this;this._numberValidator=new h.validation.NumberValidator;this._xssHtmlValidator=new h.validation.XssHtmlValidator;this.baseMapLayer=function(b){b=a._getUrlValidator(b);return $.extend({},a._webMapFilter.baseMapLayer,a._serviceLayerCommon,{url:b,templateUrl:b,gcxMapServiceDefinition:$.extend({},a._serviceLayerCommon.gcxMapServiceDefinition,{url:b,serviceUrl:b,tileRestUrl:b,mapUrl:b})})};this.layer=
function(b){b=a._getUrlValidator(b);return $.extend({},a._webMapFilter.layer,{serviceLayer:function(){return a.serviceLayer},layerDefinition:a.layerDefinition,featureSet:function(){return a.featureSet},isDynamic:!0,layerStyleId:!0,isUserCreated:!0,userLayerType:!0,layerUrl:b,legendUrl:b,gcxLayerDefinition:{id:!0,name:a._xssHtmlValidator,url:b,defaultVisibility:!0,visible:!0,displayName:a._xssHtmlValidator,description:!0,featureType:!0,featureZoomScale:!0,featureZoomFactor:!0,hasAttachments:!0,nativeID:!0,
parentLayerId:!0,subLayerIds:!0,styleName:!0,legendUrl:b,isDynamic:!0,dynamicDefinition:!0,defaultDateFormat:!0,defaultNumberFormat:!0,timeZoneId:!0,fullExtent:!0,drawIndex:!0,identifiable:!0,includeInLayerList:!0,includeInLegend:!0,isExpanded:!0,featureBorderColor:!0,featureBorderWidth:!0,featureFillColor:!0,minScale:a._numberValidator,maxScale:a._numberValidator,queryable:!0,searchable:!0,snappable:!0,snappingEnabled:!0,showFeatureHyperlinks:!0,canToggleLabels:!0,showLabels:!0,showMapTips:!0,supportsIdentify:!0,
supportsQuery:!0,type:!0,fields:!0,primaryKeyField:!0,displayField:!0,catalogId:a.object,isUserCreated:!0,userLayerType:!0,featureDescription:!1,featureLongDescription:!1,featureLabel:!1,featureHyperlinks:!1,layerHyperlinks:!1,relationships:!1,dataLinks:!1,reports:!1,charts:!1}})};this.operationalLayer=function(b){b=a._getUrlValidator(b);return $.extend({},a._webMapFilter.operationalLayer,a._serviceLayerCommon,{layers:{item:function(){return a.layer}},featureCollection:a.featureCollection,layerDefinition:a.layerDefinition,
url:b,gcxMapServiceDefinition:$.extend({},a._serviceLayerCommon.gcxMapServiceDefinition,{url:b,serviceUrl:b,tileRestUrl:b,mapUrl:b})})};this.serviceLayer=function(b){return $.extend({},a.operationalLayer(b),a.baseMapLayer(b))};this.object=function(b){if(!b||"object"!==typeof b)return!0;switch(b[h.webMap.CONVERSION_TYPE_PROPERTY]){case h.webMap.ConversionType.GCX_MAP_SERVICE:case h.webMap.ConversionType.ESRI_LAYER:return function(){return a.serviceLayer};case h.webMap.ConversionType.GCX_LAYER:return function(){return a.layer};
case h.webMap.ConversionType.GCX_FEATURE_SET:case h.webMap.ConversionType.ESRI_FEATURE_SET:return function(){return a.featureSet};case h.webMap.ConversionType.GCX_FEATURE:case h.webMap.ConversionType.ESRI_GRAPHIC:return function(){return a.feature};case h.webMap.ConversionType.ESRI_GEOMETRY:return a.geometry;case h.webMap.ConversionType.ESRI_SYMBOL:return a.symbol;case h.webMap.ConversionType.ESRI_RENDERER:return a.renderer;case h.webMap.ConversionType.ESRI_SPATIAL_REFERENCE:return a.spatialReference}var f=
{},c=0;for(b=Object.keys(b);c<b.length;c++)f[b[c]]=a.object;return f};this.app=b;this._urlValidator=new h.validation.SiteUrlValidator(b);this._serviceDiscoveryUrlValidator=new h.validation.ServiceDiscoveryUrlValidator(b);this._webMapFilter=new h.webMap.WebMapFilter(b);this._xssHtmlValidator=new h.validation.XssHtmlValidator(b.defaultContentPolicy)}Object.defineProperty(c.prototype,"baseMap",{get:function(){return this._webMapFilter.baseMap},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"bookmark",{get:function(){return this._webMapFilter.bookmark},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"color",{get:function(){return this._webMapFilter.color},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"coordinateSystem",{get:function(){this._coordinateSystem||(this._coordinateSystem={wkid:this._numberValidator,wkt:!0,output:!0});return this._coordinateSystem},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"domain",{get:function(){return this._webMapFilter.domain},
enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"inheritedDomain",{get:function(){return this._webMapFilter.inheritedDomain},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"rangeDomain",{get:function(){return this._webMapFilter.rangeDomain},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"codedValueDomain",{get:function(){return this._webMapFilter.codedValueDomain},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"drawingInfo",
{get:function(){this._drawingInfo||(this._drawingInfo=$.extend({},this._webMapFilter.drawingInfo,{showLabels:!0,clustering:{radius:this._numberValidator,backgroundColor:this.color,labelColor:this.color,maximumFeatures:this._numberValidator,enabled:!0},labelingInfo:{item:{fieldInfos:{item:this.object},labelExpression:!0,labelExpressionInfo:this.object,labelPlacement:!0,maxScale:this._numberValidator,minScale:this._numberValidator,sizeInfo:this.object,symbol:{align:!0,angle:this._numberValidator,color:{a:this._numberValidator,
b:this._numberValidator,g:this._numberValidator,r:this._numberValidator},decoration:!0,font:{decoration:!0,family:!0,size:this._numberValidator,style:!0,variant:!0,weight:!0},haloColor:{a:this._numberValidator,b:this._numberValidator,g:this._numberValidator,r:this._numberValidator},haloSize:!0,horizontalAlignment:!0,kerning:!0,rotated:!0,text:!0,type:!0,verticalAlignment:!0,xoffset:this._numberValidator,yoffset:this._numberValidator},useCodedValues:!0,where:!0}}}));return this._drawingInfo},enumerable:!0,
configurable:!0});Object.defineProperty(c.prototype,"feature",{get:function(){var b=this;this._feature||(this._feature=$.extend({},this._webMapFilter.feature,{id:!0,layer:function(){return b.layer},featureLayer:function(){return b.serviceLayer},featureSet:function(){return b.featureSet},allowUnsafeContent:!0,extendedProperties:this.object,defaultNumberFormat:this._xssHtmlValidator,defaultDateFormat:this._xssHtmlValidator,timeZoneId:!0,displayTimeZoneId:!0,borderColor:this.color,fillColor:this.color,
borderWidth:!0,attributes:this.object}),this._feature[g.PROPERTY_MEASUREMENT_ID]=!0,this._feature[g.PROPERTY_HIGHLIGHT_ID]=!0,this._feature[k.infrastructure.isKmlProperty]=!0);return this._feature},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"featureCollection",{get:function(){this._featureCollection||(this._featureCollection=$.extend({},this._webMapFilter.featureCollection,{layers:{item:this.layer}}));return this._featureCollection},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"featureSet",{get:function(){var b=this;this._featureSet||(this._featureSet=$.extend({},this._webMapFilter.featureSet,{id:!0,features:{item:function(){return b.feature}},allowUnsafeContent:!0,extendedProperties:this.object,layer:function(){return b.layer},displayName:this._xssHtmlValidator,iconUri:this._urlValidator}));return this._featureSet},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"featureSetCollection",{get:function(){var b=this;this._featureSetCollection||(this._featureSetCollection=
{id:!0,displayName:this._xssHtmlValidator,featureSets:{item:function(){return b.featureSet}},sourceName:!0,tag:this.object,extendedProperties:this.object});return this._featureSetCollection},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"field",{get:function(){return this._webMapFilter.field},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"geometry",{get:function(){return this._webMapFilter.geometry},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"graphic",{get:function(){this._graphic||(this._graphic=$.extend({},this._webMapFilter.feature),this._graphic[g.PROPERTY_MEASUREMENT_ID]=!0,this._graphic[g.PROPERTY_HIGHLIGHT_ID]=!0,this._graphic[k.infrastructure.isKmlProperty]=!0);return this._graphic},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"point",{get:function(){return this._webMapFilter.point},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"multiPoint",{get:function(){return this._webMapFilter.multiPoint},
enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"polyline",{get:function(){return this._webMapFilter.polyline},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"polygon",{get:function(){return this._webMapFilter.polygon},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"extent",{get:function(){return this._webMapFilter.extent},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"layerDefinition",{get:function(){this._layerDefinition||
(this._layerDefinition=$.extend({},this._webMapFilter.layerDefinition,{drawingInfo:this.drawingInfo}));return this._layerDefinition},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"renderer",{get:function(){return this._webMapFilter.renderer},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"simpleRenderer",{get:function(){return this._webMapFilter.simpleRenderer},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"uniqueValueRenderer",{get:function(){return this._webMapFilter.uniqueValueRenderer},
enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"classBreaksRenderer",{get:function(){return this._webMapFilter.classBreaksRenderer},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"heatmapRenderer",{get:function(){return this._webMapFilter.heatmapRenderer},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"spatialReference",{get:function(){return this._webMapFilter.spatialReference},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"symbol",{get:function(){return this._webMapFilter.symbol},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"simpleMarkerSymbol",{get:function(){return this._webMapFilter.simpleMarkerSymbol},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"simpleLineSymbol",{get:function(){return this._webMapFilter.simpleLineSymbol},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"simpleFillSymbol",{get:function(){return this._webMapFilter.simpleFillSymbol},enumerable:!0,
configurable:!0});Object.defineProperty(c.prototype,"pictureMarkerSymbol",{get:function(){return this._webMapFilter.pictureMarkerSymbol},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"pictureFillSymbol",{get:function(){return this._webMapFilter.pictureFillSymbol},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"textSymbol",{get:function(){return this._webMapFilter.textSymbol},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"template",{get:function(){return this._webMapFilter.template},
enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"type",{get:function(){return this._webMapFilter.type},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"_serviceLayerCommon",{get:function(){var b=this;return{layers:{item:function(){return b.layer}},isUserCreated:!0,userLayerType:!0,gcxMapServiceDefinition:{id:!0,url:this._urlValidator,serviceUrl:this._urlValidator,tileRestUrl:this._urlValidator,mapUrl:this._urlValidator,subDomains:{item:!0},serviceType:!0,serviceFunction:!0,
displayName:this._xssHtmlValidator,shortDisplayName:!0,baseMapGroup:!0,baseMapGroupIndex:!0,baseMapGroupIsMutuallyExclusive:!0,description:!0,copyright:!0,hasAttributionData:!0,visible:!0,disableClientCaching:!0,opacity:this._numberValidator,instantSearch:!0,format:!0,isExpanded:!0,serverVersion:!0,failureAction:!0,tileMatrixSet:!0,requestEncoding:!0,operationalSpatialReference:!0,minScale:this._numberValidator,maxScale:this._numberValidator,identifiable:!0,includeCatalogItems:!0,includeMosaicDatasetValues:!0,
defaultDateFormat:!0,defaultNumberFormat:!0,tileInfo:!0,includeInLayerList:!0,drawingBehavior:!0,featureClustering:{enabled:!0,userCanToggle:!0,radius:this._numberValidator,maximumFeatures:this._numberValidator,backgroundColor:this.color,labelColor:this.color},featureHeatMap:{enabled:!0,userCanToggle:!0,respectScaleRange:!0,gradient:!0,offset:{item:this._numberValidator},intensity:this._numberValidator,field:!0,defaultRenderer:this.renderer,defaultMinScale:this._numberValidator,defaultMaxScale:this._numberValidator,
includeInLegend:!0},catalogId:this.object,isUserCreated:!0,userLayerType:!0,dataProvider:!0,timeZoneId:!0,startTime:!0,endTime:!0,supportsDynamicLayers:!0,hasLayerCatalog:!0,updateInterval:this._numberValidator,layerOptions:!1,layerHyperlinks:!1,attributionDataUrl:!1}}},enumerable:!0,configurable:!0});c.prototype._getUrlValidator=function(b){var a=this._urlValidator;this._getUserLayerType(b)===d.essentials.UserLayerType.LAYER_ADDITION&&(a=this._serviceDiscoveryUrlValidator);return a};c.prototype._getUserLayerType=
function(b){if(b){if(b.isUserCreated&&void 0!=b.userLayerType)return b.userLayerType;var a=void 0,a=b.serviceLayer?b.serviceLayer:b;if(this._isLayerCatalogService(a))return d.essentials.UserLayerType.LAYER_CATALOG;if(this._isFeatureCollection(a)||this._isKmlLayer(a))return d.essentials.UserLayerType.UPLOAD}return null};c.prototype._isFeatureCollection=function(b){return b&&b.featureCollection&&b.featureCollection.layers&&1===b.featureCollection.layers.length&&!!b.featureCollection.layers[0].featureSet};
c.prototype._isKmlLayer=function(b){return b&&b.type===h.webMap.OperationalLayerType.KML};c.prototype._isLayerCatalogService=function(b){return b&&b.gcxMapServiceDefinition&&b.gcxMapServiceDefinition.catalogId};return c}();g.ProjectFilter=m})(h.project||(h.project={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){function h(c,b,a,e){var f=this;void 0===e&&(e=200);var l=-1,d=[],g=function(){l=setTimeout(function(){l=null;for(var a=d.length-1;0<=a;a--){var e=d[a];c.event(e.eventName).unsubscribe(e.subscriptionToken);d.pop()}b()},e)};a.forEach(function(a){var b=c.event(a).subscribe(f,function(){null!==l&&(clearTimeout(l),g())});d.push({eventName:a,subscriptionToken:b})});g()}d.debounceViewEvents=function(c,b,a){void 0===a&&(a=400);h(c,b,"ViewInitializedEvent ViewActivatedEvent ViewDeactivatedEvent ViewDimensionsChangedEvent ViewHostedEvent ViewUnhostedEvent ApplicationResizeEvent".split(" "),
a)};d.debounceEvents=h})(d.ShellUtils||(d.ShellUtils={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var h=function(){function c(b){this.app=b;this.nativeInitialized=!1;this._messageClient=new g.MessageClient(b)}c.prototype.isNative=function(){return/\bGeocortexApp\b/.test(navigator.userAgent)};c.prototype.xhrGet=function(b){var a=this;return this.onNativeInitialized().then(function(){a.appendAuthorizationHeader(b);return dojo.xhrGet(b)})};c.prototype.xhrPost=function(b){var a=this;return this.onNativeInitialized().then(function(){a.appendAuthorizationHeader(b);
return dojo.xhrPost(b)})};c.prototype.appendAuthorizationHeader=function(b){b||(b={});b.headers||(b.headers={});b.headers.Authorization||(b.headers.Authorization="Token "+this.app.localServerToken)};c.prototype.message=function(b,a,e,f){return this._messageClient.message(b,a,e,f)};c.prototype.onNativeInitialized=function(){var b=this;return this._nativeInitializedPromise?this._nativeInitializedPromise:this._nativeInitializedPromise=new Promise(function(a,e){b._nativeInitializedResolve=a})};c.prototype.signalNativeInitialized=
function(){this.onNativeInitialized();this.nativeInitialized=!0;this._nativeInitializedResolve()};c.prototype.getViewerResourceInfo=function(b){return this.xhrGet({url:this.app.localServerAddress+"/resource/"+this.app.localServerNamespace+"/"+b+"/info"}).then(function(a){a=JSON.parse(a);return{name:a.name,exists:a.exists,length:a.length,lastAccessTime:a.lastAccessTime?new Date(a.lastAccessTime):null,lastWriteTime:a.lastWriteTime?new Date(a.lastWriteTime):null}})};c.prototype.hasNativeCapability=function(b){var a=
this;return new Promise(function(e,f){a._capabilities?e(-1<a._capabilities.indexOf(b)):/\bGeocortexApp\b/.test(navigator.userAgent)?d.GeocortexNativeApp.capabilities(function(f){a._capabilities=f;e(-1<a._capabilities.indexOf(b))},function(a){e(!1)}):e(!1)})};return c}();g.NativeManager=h})(h.nativeIntegration||(h.nativeIntegration={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){function h(c,b){if(!b)return Promise.reject("basemap cannot be null.");if(!b.filename)return Promise.reject("basemap.filename cannot be null.");switch(b.sourceType){case d.OfflineMapBasemap.Type.PREGENERATED:return c.nativeManager.message("RemoveResource",{fileName:b.filename});case d.OfflineMapBasemap.Type.EXPORT_TILES:return c.nativeManager.message("RemoveExportedTiles",{fileName:b.filename})}return null}d.deleteBasemaps=function(c,
b){return Promise.all(b.map(function(a){return h(c,a)})).then(function(){return null})}})(d.offline||(d.offline={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){function h(a,f,l,d,r){if(!l)throw Error("basemap cannot be null.");if(!l.filename)throw Error("basemap.filename cannot be null.");if(!l.url)throw Error("basemap.url cannot be null.");switch(l.sourceType){case g.OfflineMapBasemap.Type.PREGENERATED:return c(a,l,d,r);case g.OfflineMapBasemap.Type.EXPORT_TILES:return b(a,f,l,d,r)}return null}function c(b,f,c,n){var h=b.makeAbsolute(f.url,b.site.url),p=b.site.getTokenFromPrincipal(h,d.essentials.Site)||
b.site.getTokenFromPrincipal(h,esri.IdentityManagerBase);null!=p&&(h+=(-1===h.indexOf("?")?"?":"&")+"token="+p);return b.nativeManager.message("DownloadResource",{url:h,fileName:f.filename,overwrite:"OnNewer"},c,function(c){var l=c.details;switch(l.status){case a.connecting:n&&n({message:b.getResource("Mapping.Infrastructure","language-offline-progress-basemapdownload-connecting").format(f.filename),percentage:0});break;case a.downloading:if(n){c=Math.round(l.bytesDownloaded/l.bytesTotal*100);var d=
g.formatBytesString(b,l.bytesDownloaded),h=g.formatBytesString(b,l.bytesTotal),l=g.formatByteTransferRateString(b,l.bytesPerSecond);n({message:b.getResource("Mapping.Infrastructure","language-offline-progress-basemapdownload-downloading").format(f.filename,d,h,c,l),percentage:c})}break;default:b.trace.error("Unknown ResourceDownloadEvent status "+l.status)}})}function b(b,f,c,d,h){var p=c.url,k=b.site.getTokenFromPrincipal(p,esri.IdentityManagerBase);null!=k&&(p+=(-1===p.indexOf("?")?"?":"&")+"token="+
k);f={url:p,fileName:c.filename,minLevel:c.minLevel,maxLevel:c.maxLevel,areaOfInterest:JSON.stringify({features:[{geometry:f.content.geometry}]}),refreshInterval:c.refreshInterval};return b.nativeManager.message("ExportTiles",f,d,function(f){var d=f.details;switch(d.status){case a.connecting:h&&h({message:b.getResource("Mapping.Infrastructure","language-offline-progress-basemapexport-connecting").format(c.filename),percentage:0});break;case a.processing:h&&h({message:d.message||b.getResource("Mapping.Infrastructure",
"language-offline-progress-basemapexport-processing").format(c.filename),percentage:0});break;case a.downloading:if(h){f=Math.round(d.bytesDownloaded/d.bytesTotal*100);var n=g.formatBytesString(b,d.bytesDownloaded),p=g.formatBytesString(b,d.bytesTotal),d=g.formatByteTransferRateString(b,d.bytesPerSecond);h({message:b.getResource("Mapping.Infrastructure","language-offline-progress-basemapexport-downloading").format(c.filename,n,p,f,d),percentage:f})}break;default:b.trace.error("Unknown ResourceDownloadEvent status "+
d.status)}})}g.downloadBasemaps=function(a,b,c,d){var g=0;return Promise.reduce(b.content.basemaps,function(p,k){if(c.isCancellationRequested)throw Error("Operation cancelled.");return h(a,b,k,c,function(a){var e=(a.percentage+100*g)/b.content.basemaps.length;d&&d({message:a.message,percentage:e})})["catch"](function(b){d&&d({isWarning:!0,message:a.getResource("Mapping.Infrastructure","language-offline-progress-basemapdownload-failed").format(k.filename,b.message||b),percentage:100})})["finally"](function(){g++})},
null)};var a={connecting:"Connecting",processing:"Processing",downloading:"Downloading"}})(h.offline||(h.offline={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){(function(g){function c(a,b){b.resources.push(h("__error_offline_no_endpoint",{error:{code:400,message:"This resource is not available offline.",details:[]}}));b.resources.push(h("__no_features",{objectIdFieldName:"OBJECTID",globalIdFieldName:"GlobalID",features:[]}));b.resources.push(h("__no_search_results",{count:0,features:[],ResponseStatus:{}}));b.resources.push(h("__no_data_links",{results:[]}));b.resources.push(h("__empty_attribution_response",
""));return null}function b(a,b){return new Promise(function(e,f){var c=q(a,a.app.site.url+"/map/layerlist");d.request({url:c,content:{f:"json"},load:function(a){b.resources.push(h("__layerlist_",a));e(null)},error:function(b){a.app.trace.error("Error fetching '"+c+"': "+b.message);f(b)},callbackParamName:"Callback"})})}function a(a,b){return new Promise(function(e,f){var c=q(a,a.app.site.url);d.request({url:c,content:{f:"json",deep:a.app.site.deepInitialize},load:function(a){a&&a.principal&&(a.principal.isAuthenticated=
!1,a.principal.label="Guest",a.principal.expiry=null,a.principal.identities=[],a.principal.tokens={arcgis:{},geocortex:{},site:null});b.resources.push(h("__site_",a));e(null)},error:function(b){a.app.trace.error("Error fetching '"+c+"'. "+b.message);f(b)},callbackParamName:"Callback"})})}function e(a,b){var e=[],c=a.app.site.essentialsMap.mapServices;a.app.site.overviewMap&&(c=c.concat(a.app.site.overviewMap.mapServices));c=c.map(function(c){if(-1!=e.indexOf(c.url))return null;e.push(c.url);return c.mapServiceType===
d.essentials.MapServiceType.BING||c.mapServiceType===d.essentials.MapServiceType.WMS||c.mapServiceType===d.essentials.MapServiceType.WEBTILED?null:c.mapServiceType===d.essentials.MapServiceType.GEORSS||c.mapServiceType===d.essentials.MapServiceType.KML?n(a,b,c):c instanceof d.essentials.FeatureLayerService?f(a,b,c):l(a,b,c)});return Promise.all(c)}function f(a,b,e){var f=[],c=/^(.*)(\/[0-9]+\/?)$/.exec(e.serviceUrl)[1],d=null;e.layers[0]?d=e.layers[0].relationships:e.serviceLayer&&(d=e.serviceLayer.relationships);
d&&(f=f.concat(d.map(function(f){return new Promise(function(l,d){var n=c+"/"+f.relatedTableId,g={f:"json"},p=e.findServiceToken();p&&(g.token=p);esri.request({url:n,handleAs:"json",content:g,callbackParamName:"Callback"}).then(function(a){b.resources.push(h(y(n),a));l(null)},function(b){a.app.trace.error("Error fetching '"+n+"'. "+b.message);d(b)})})})));f.push(l(a,b,e));return Promise.all(f)}function l(a,b,e){return new Promise(function(f,c){var l=k(a,e),d={f:"json"},n=e.findServiceToken();n&&(d.token=
n);esri.request({url:l,handleAs:"json",content:d,callbackParamName:"Callback"}).then(function(a){b.resources.push(h(y(l),a));f(null)},function(b){a.app.trace.error("Error fetching '"+l+"'. "+b.message);c(b)})})}function n(a,b,e){return new Promise(function(f,c){var l=k(a,e);esri.request({url:l,handleAs:"xml",content:{},callbackParamName:"Callback"}).then(function(a){b.resources.push(p(y(l),(new XMLSerializer).serializeToString(a)));f(null)},function(b){a.app.trace.error("Error fetching '"+l+"'. "+
b.message);c(b)})})}function h(a,b,e){void 0===e&&(e=!1);return p(a,JSON.stringify(b),e)}function p(a,b,e){void 0===e&&(e=!1);return{isEncoded:e,isJson:!0,key:a,value:e?d.framework.utils.base64Encode(b):b}}function k(a,b){var e=b.serviceUrl;!e&&b.serviceLayer&&(e=b.serviceLayer.url);e&&(e=q(a,e));return e}function q(a,b){b=a.app.makeAbsolute(b);var e=document.createElement("a");e.href=b;var e=e.href,f=e.charAt(e.length-1);if("/"===f||"\\"===f)e=e.substr(0,e.length-1);return e}function y(a){var b=
/^[a-z]+:\/\/(.*)/.exec(a);b&&(a=b[1]);(b=/^(services|server)\.arcgisonline\.(.*)/.exec(a))&&(a="(services|server).arcgisonline."+b[2]);/^[^/]*virtualearth.net\//.exec(a)&&(a="[^/]*virtualearth.net/");(b=/^([a-zA-Z.]+):(80|443)(.*)/.exec(a))&&(a=b[1]+b[3]);return a=a.replace(/\//g,"/+").replace(/\./g,"\\.")}g.buildBundle=function(f){var l={id:f.bundleId,timestamp:(new Date).getTime(),routingRules:g.buildRoutingRules(f),resources:[]};f=[c(f,l),a(f,l),b(f,l),e(f,l)];return Promise.all(f).then(function(){return l})};
g.cleanUpMapServiceUrl=k;g.cleanUpRestUrl=q;g.urlToPattern=y})(g.bundle||(g.bundle={}))})(h.offline||(h.offline={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){(function(h){var c=function(){function b(a,b){var f=this;this.app=a;this.libraryId=b;this._router=new h.OfflineRouter(this.app);this._esriRequestHacker=new h.EsriRequestHacker(a,function(a,b){return f._router.handle(a,b)});this._esriLayerHacker=new h.EsriLayerHacker(a,function(a){return f._router.rewriteUrl(a)});this._esriLayerHacker.errorReporter=function(a){return f.app.trace.warning(a)};this._serveResourceHandler=new h.offlineHandlers.ServeResourceHandler(this.app,
function(a){return f._appStoreGetPromise(a)},function(a,b){return f._appStoreSetPromise(a,b)},function(a){return f._appStoreRemovePromise(a)});var c=new h.offlineHandlers.PassthroughHandler(this.app,function(a,b){return f._esriRequestHacker.unhackedRequest(a,b)});this._router.setDefaultHandler(c);this._router.addHandler(c);this._router.addHandler(this._serveResourceHandler);this._router.addHandler(new h.offlineHandlers.FailHandler);this._router.addHandler(new h.offlineHandlers.RewriteHandler(this.app,
function(a,b){return f._esriRequestHacker.unhackedRequest(a,b)}));this._router.addHandler(new h.offlineHandlers.SiteHandler(this.app,function(a){return f._serveResourceHandler.getResourceValue(a)},function(a,b){return f._esriRequestHacker.unhackedRequest(a,b)}));this.app.event("ApplicationStorageClearedEvent").subscribe(this,function(){f._serveResourceHandler.clear();f._router.clearRoutingRules()})}b.prototype.createBundle=function(a,b){var f=this;return this._buildBundle(a,b).then(function(a){return f._storeBundle(a)}).then(function(a){})};
b.prototype.deleteBundle=function(a){var b=this;return this._getBundle(a).then(function(a){return a?b._serveResourceHandler.unstoreBundle(a):null}).then(function(a){return a?b._appStoreRemovePromise(b._getBundleKey(a)):null}).then(function(){})};b.prototype.updateBundle=function(a,b){var f=this;return this._buildBundle(a,b).then(function(b){return f.deleteBundle(a)["catch"](function(a){f.app.trace.warning("Unable to delete old bundle before replacing it. "+(a.message||a)+" Attempting to continue.");
return null}).then(function(){return b})}).then(function(a){return f._storeBundle(a)}).then(function(a){return f._router.setRoutingRules(a.routingRules)}).then(function(){})};b.prototype.loadBundle=function(a){var b=this;return a?this._getBundle(a).then(function(a){if(!a)throw Error(b.getResource("language-offline-errors-bundlenotfound"));b._serveResourceHandler.loadBundle(a);b._router.setRoutingRules(a.routingRules)}):Promise.reject(Error("Bundle ID cannot be null."))};b.prototype.unloadBundle=function(){this._serveResourceHandler.clear();
this._router.clearRoutingRules();return Promise.resolve()};b.prototype._buildBundle=function(a,b){var f=this;return d.SyncEngine.getSyncInfo(this.app,a).then(function(c){c={app:f.app,bundleId:a,basemaps:b,featureLayerSyncInfo:c};f._esriRequestHacker.disable();return h.buildBundle(c)["finally"](function(){f._esriRequestHacker.enable()})})};b.prototype._storeBundle=function(a){var b=this;return null==a?Promise.reject(Error("Bundle is null.")):null==a.id?Promise.reject(Error("Bundle ID is null.")):this._serveResourceHandler.stripAndStoreBundle(a).then(function(){b._appStoreSetPromise(b._getBundleKey(a),
JSON.stringify(a));return a},function(f){b.app.trace.warning("Failed to save offline bundle '"+a.id+"'. "+(f.message||f));22==f.code&&window.localStorage&&window.localStorage.remainingSpace&&b.app.trace.warning("Local storage has "+window.localStorage.remainingSpace+" bytes remaining.");throw f;})};b.prototype._getBundle=function(a){return a?this._appStoreGetPromise(this._getBundleKey(a)).then(function(a){return a?JSON.parse(a):null}):Promise.reject(Error("Bundle ID is null."))};b.prototype._getBundleKey=
function(a){return"__bundle-"+("string"===typeof a?a:a.id)};b.prototype._appStoreGetPromise=function(a){var b=this;return new Promise(function(f,c){return b.app.store.get(a,f,c)})};b.prototype._appStoreSetPromise=function(a,b){var f=this;return new Promise(function(c,d){return f.app.store.set(a,b,function(){return c()},d)})};b.prototype._appStoreRemovePromise=function(a){var b=this;return new Promise(function(f,c){return b.app.store.remove(a,function(){return f()},c)})};b.prototype.getResource=function(a){return this.app.getResource(this.libraryId,
a)};return b}();h.BundleManager=c})(d.bundle||(d.bundle={}))})(d.offline||(d.offline={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){(function(d){var c=function(){return function(b){b?dojo.safeMixin(this,b):this.key=""}}();d.BundleResourceEntry=c})(d.bundle||(d.bundle={}))})(d.offline||(d.offline={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){(function(d){var c=function(){function b(a,b){this.app=a;this.urlRewriter=b;this.errorReporter=function(a){};this._captureHooks();this._extendEsriLayers()}b.prototype._captureHooks=function(){this._hooked_esri_getTileUrl=esri.layers.ArcGISTiledMapServiceLayer._meta.hidden.getTileUrl;this._hooked_ogc_getWMTSTileUrl=esri.layers.WMTSLayer._meta.hidden.getTileUrl;this._ogc__tileLoadHandler=esri.layers.WMTSLayer.superclass._tileLoadHandler;
this._hooked_BingMaps_getTileUrl=esri.virtualearth.VETiledLayer._meta.hidden.getTileUrl;this._bingMaps__tileLoadHandler=esri.virtualearth.VETiledLayer.superclass._tileLoadHandler;this._hooked_WebTiledLayer_getTileUrl=esri.layers.WebTiledLayer._meta.hidden.getTileUrl;this._webTiledLayer__tileLoadHandler=esri.layers.WebTiledLayer.superclass._tileLoadHandler;this._hooked_esri_getImageUrl=esri.layers.ArcGISDynamicMapServiceLayer._meta.hidden.getImageUrl;this._hooked_ogc_getImageUrl=esri.layers.WMSLayer._meta.hidden.getImageUrl};
b.prototype._extendEsriLayers=function(){var a=this;esri.virtualearth.VETiledLayer.extend({getTileUrl:function(b,f,c){b=a._hooked_BingMaps_getTileUrl.apply(this,[b,f,c]);return a.app.offlineManager.isOfflineMapActive.get()?a.urlRewriter(b)||b:b},_tileLoadHandler:function(b){a._bingMaps__tileLoadHandler.apply(this,[b])}});esri.layers.WMTSLayer.extend({getTileUrl:function(b,f,c){b=a._hooked_ogc_getWMTSTileUrl.apply(this,[b,f,c]);return a.app.offlineManager.isOfflineMapActive.get()?a.urlRewriter(b)||
b:b},_tileLoadHandler:function(b){a._ogc__tileLoadHandler.apply(this,[b])}});esri.layers.WebTiledLayer.extend({getTileUrl:function(b,f,c){b=a._hooked_WebTiledLayer_getTileUrl.apply(this,[b,f,c]);return a.app.offlineManager.isOfflineMapActive.get()?a.urlRewriter(b)||b:b},_tileLoadHandler:function(b){a._webTiledLayer__tileLoadHandler.apply(this,[b])}});esri.layers.ArcGISTiledMapServiceLayer.extend({getTileUrl:function(b,f,c){b=a._hooked_esri_getTileUrl.apply(this,[b,f,c]);return a.app.offlineManager.isOfflineMapActive.get()?
a.urlRewriter(b)||b:b}});esri.layers.WMSLayer.extend({getImageUrl:function(b,f,c,d){a.app.offlineManager.isOfflineMapActive.get()?a._hooked_ogc_getImageUrl.apply(this,[b,f,c,function(b){b=a.urlRewriter(b)||b;d&&d(b)}]):(f&&c||a.errorReporter("Invalid dimensions on requested map image. This is usually due to an invalid map resize event."),a._hooked_ogc_getImageUrl.apply(this,arguments))}});esri.layers.ArcGISDynamicMapServiceLayer.extend({getImageUrl:function(b,f,c,d){a.app.offlineManager.isOfflineMapActive.get()?
a._hooked_esri_getImageUrl.apply(this,[b,f,c,function(b){b=a.urlRewriter(b)||b;d&&d(b)}]):(f&&c||a.errorReporter("Invalid dimensions on requested map image. This is usually due to an invalid map resize event."),a._hooked_esri_getImageUrl.apply(this,arguments))}})};return b}();d.EsriLayerHacker=c})(d.bundle||(d.bundle={}))})(d.offline||(d.offline={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex=
{}));
(function(d){(function(d){(function(d){(function(d){(function(d){(function(d){var c=function(){function b(a,b){this.app=a;this.requestHandler=b;this._isEnabled=!0;this._setupEsriRequestHooks()}b.prototype.unhackedRequest=function(a,b){return this._hooked_esri_request.call(esri,a,b)};b.prototype.disable=function(){this._isEnabled=!1};b.prototype.enable=function(){this._isEnabled=!0};b.prototype._setupEsriRequestHooks=function(){var a=this;if(esri.request){this._hooked_esri_request=esri.request;esri.request=
function(b,e){return a.app.offlineManager.getActiveOfflineMap()&&a._isEnabled?a.requestHandler(b,e):a._hooked_esri_request.call(esri,b,e)};var b=null;esri.request.setRequestPreCallback=function(a){b=a};this._hooked_esri_request.setRequestPreCallback(function(a){/GeocortexApp/.test(navigator.userAgent)&&/^https:\/\/(localhost|127\.0\.0\.1)(:\d+)?\//.test(a.url)&&(a.url="http"+a.url.substring(5));b&&(a=b(a));return a})}else this.app.trace.error("Offline module could not hook into ESRI API.")};return b}();
d.EsriRequestHacker=c})(d.bundle||(d.bundle={}))})(d.offline||(d.offline={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){(function(d){(function(c){var b=function(){function a(a,b){this.app=a;this.unhackedRequesthandler=b;this.name="Passthrough"}a.prototype.handle=function(a,b,c,d){this.unhackedRequesthandler(a,a.options).then(function(b){return a.dfd.resolve(b)},function(b){return a.dfd.errback(b)});return!0};return a}();c.PassthroughHandler=b})(d.offlineHandlers||(d.offlineHandlers={}))})(d.bundle||(d.bundle={}))})(d.offline||(d.offline={}))})(d.infrastructure||
(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){(function(d){(function(c){var b=function(){function a(){this.name="Fail"}a.prototype.handle=function(a,b,l,d){a.dfd.reject();c.hookDeferredCallbacks(a);return!0};return a}();c.FailHandler=b})(d.offlineHandlers||(d.offlineHandlers={}))})(d.bundle||(d.bundle={}))})(d.offline||(d.offline={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex=
{}));
(function(d){(function(d){(function(d){(function(d){(function(d){(function(d){(function(c){c.hookDeferredCallbacks=function(b){var a=b.dfd,e=b.load;e&&a.addCallback(function(b){var f=a._pendingDfd,f=f&&f.ioArgs;return e.call(f&&f.args,b,f)});var f=b.error;f&&a.addErrback(function(b){var e=a._pendingDfd,e=e&&e.ioArgs;return f.call(e&&e.args,b,e)})}})(d.offlineHandlers||(d.offlineHandlers={}))})(d.bundle||(d.bundle={}))})(d.offline||(d.offline={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping=
{}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){(function(d){(function(c){var b=function(){function a(a,b){this.app=a;this.unhackedRequesthandler=b;this.name="Rewrite"}a.prototype.handle=function(a,b,c,d){a.url=this.rewriteRequest(a,b,c);!require.has("esri-cors")&&Modernizr.cors&&(delete require.has.cache["esri-cors"],require.has.add("esri-cors",function(){return!0}));var g=null;d.register(function(){g&&g.cancel("Pass through from ESRI cancellation.")});g=this.unhackedRequesthandler(a,
a.options).then(function(b){return a.dfd.resolve(b)},function(b){return a.dfd.errback(b)});return!0};a.prototype.rewriteRequest=function(a,b,c){if(!b||!b.parameters||!b.parameters.newUrl)throw Error("Not a rewrite rule.");a=b.parameters.newUrl;a=a.format.apply(a,c);a=a.replace("{localserver}",this.app.localServerAddress);this.app.localServerAddress&&0<this.app.localServerAddress.length&&a.startsWith(this.app.localServerAddress)&&(a=this._appendLocalServerToken(a));return a};a.prototype._appendLocalServerToken=
function(a){this.app.localServerToken&&(a.endsWith("?")||(a+=0<a.indexOf("?")?"&":"?"),a+="localServerToken="+this.app.localServerToken);return a};return a}();c.RewriteHandler=b})(d.offlineHandlers||(d.offlineHandlers={}))})(d.bundle||(d.bundle={}))})(d.offline||(d.offline={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){(function(g){(function(c){var b=function(){function a(a,b,c,d){this.app=a;this.resourceGetter=b;this.resourceSetter=c;this.resourceRemover=d;this.name="ServeResource";this.isReady=new Observable(!1)}a.prototype.handle=function(a,b,l,d){var g=this;if(!this._bundle||!b.parameters||!b.parameters.key)return!1;b=b.parameters.key;b=b.format.apply(b,l);l=0;for(d=this._bundle.resources.length;l<d;l++)if(this._bundle.resources[l].key===b)return c.hookDeferredCallbacks(a),
this._getResourceValue(this._bundle.resources[l]).then(function(b){a.dfd.resolve(b)})["catch"](function(b){g.app.trace.error(b.message);a.dfd.reject(b.message)}),!0;return!1};a.prototype.loadBundle=function(a){this.isReady.set(!0);this._bundle=a};a.prototype.clear=function(){this.isReady.set(!1);this._bundle=null};a.prototype.stripAndStoreBundle=function(b){var f=this;if(!b)return Promise.reject(Error("Bundle cannot be null."));var c=b.resources.map(function(c){return null==c.value?Promise.reject(Error("Bundle resoure entry value is already null: "+
c.key)):c.value&&c.value.length>a._resourceCachingLength?f.resourceSetter(a._getResourceStorageKey(b,c),c.value).then(function(){c.value=null},function(a){f.app.trace.error("Unable to strip '"+c.key+"' out of the bundle and store it separately. "+a)}):null});return Promise.all(c).then(function(){return b})};a.prototype.unstoreBundle=function(b){var f=this;if(!b)return Promise.reject(Error("Bundle cannot be null."));var c=b.resources.map(function(c){return null==c.value?f.resourceRemover(a._getResourceStorageKey(b,
c)):null});return Promise.all(c).then(function(){return b})};a.prototype.getResourceValue=function(a){for(var b=0,c=this._bundle.resources.length;b<c;b++)if(this._bundle.resources[b].key===a)return this._getResourceValue(this._bundle.resources[b]);return Promise.reject(Error("No such entry found."))};a.prototype._getResourceValue=function(b){var f=this;return Promise.resolve(b.value).then(function(c){return null==c?f.resourceGetter(a._getResourceStorageKey(f._bundle,b)):c}).then(function(a){if(!a)throw Error("Resource entry missing for: "+
b.key);return a}).then(function(a){!0===b.isEncoded&&(a=d.framework.utils.base64Decode(a));!0===b.isJson&&(a=JSON.parse(a));return a})};a._getResourceStorageKey=function(a,b){return a.id+"-"+b.key};a._resourceCachingLength=200;return a}();c.ServeResourceHandler=b})(g.offlineHandlers||(g.offlineHandlers={}))})(g.bundle||(g.bundle={}))})(h.offline||(h.offline={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||
(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){(function(d){(function(c){var b=function(){function a(a,b,c){this.app=a;this.siteJsonGetter=b;this.unhackedRequesthandler=c;this.name="Site"}a.prototype.handle=function(a,b,l,d){var g=this;c.hookDeferredCallbacks(a);this.siteJsonGetter(b.parameters.key).then(function(b){return g._hasToken(a)?g._getOnlineSitePrincipal(a).then(function(a){b.principal=a;return b},function(a){return g._getGmafPrincipal(b.principal).then(function(a){b.principal=a;
return b},function(a){return b})}):b}).then(function(b){a.dfd.resolve(b)},function(b){a.dfd.errback(b)});return!0};a.prototype._hasToken=function(a){return/[?&]token=/.test(a.url)||a.content&&a.content.token};a.prototype._getOnlineSitePrincipal=function(a){var b=this,c=new d.RequestContext({callbackParamName:a.callbackParamName,content:a.content,form:a.form,handleAs:a.handleAs,timeOut:1E4,url:a.url},null,a.options);return(new Promise(function(a,e){return b.unhackedRequesthandler(c,c.options).then(a,
e)})).then(function(a){if(!a||a.error||!a.principal)throw Error("Site JSON looks malformed.");return a.principal})};a.prototype._getGmafPrincipal=function(a){return this.app.nativeManager.nativeInitialized?this.app.nativeManager.xhrGet({url:this.app.localServerAddress+"/account/userinfo",handleAs:"json"}).then(function(b){if(!b||!b.token)throw Error("GMAF has no login info.");return dojo.mixin(a,{isAuthenticated:!0,label:b.userName,expiry:(new Date).toISOString(),tokens:{site:b.token}})}):Promise.reject(Error("Not a native app."))};
return a}();c.SiteHandler=b})(d.offlineHandlers||(d.offlineHandlers={}))})(d.bundle||(d.bundle={}))})(d.offline||(d.offline={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(g){(function(g){var c=function(){function b(a){var b=this;this.app=a;this.isReady=new Observable(!1);this._handlers={};this._rules=[];this.app.command("RewriteUrlForOffline").register(this,function(a,c){c(b.rewriteUrl(a))})}b.prototype.addHandler=function(a){this._handlers[a.name]=a};b.prototype.removeHandler=function(a){return this._handlers.hasOwnProperty(a)?(delete this._handlers[a],!0):!1};b.prototype.setDefaultHandler=function(a){this._defaultHandler=
a};b.prototype.setRoutingRules=function(a){this._rules=a.concat();this.isReady.set(!0)};b.prototype.setRoutingRulesFromPromise=function(a){var b=this;this._rules.length=0;this.isReady.set(!1);a.then(function(a){if(a)try{b.setRoutingRules(JSON.parse(a))}catch(c){b.app.trace.error("Unable to parse routing rules: {0}".format(c))}else b.app.trace.debug("No offline request routing table was found.")},function(a){b.app.trace.warning("An error occurred while attempting to fetch offline request routing rules: {0}".format(a))})};
b.prototype.clearRoutingRules=function(){this._rules.length=0;this.isReady.set(!1)};b.prototype.rewriteUrl=function(a){var b=this._handlers.Rewrite;if(!b)return a;a=this._stripOutProxy(a);for(var f=0;f<this._rules.length;++f){var c=this._rules[f];if("Rewrite"===c.handlerName){var d=RegExp(c.pattern).exec(a);if(d&&d.length&&0<d.length)return b.rewriteRequest(null,c,d)}}return null};b.prototype.handle=function(a,b){var f=this,c=new d.CancellationTokenSource,n=new dojo.Deferred(function(a){c.cancel()});
this._whenReady(function(){for(var d=new g.RequestContext(a,n,b),h=f._stripOutProxy(d.url),k=!1,q=0;q<f._rules.length;++q){var y=f._rules[q],w=RegExp(y.pattern).exec(h),x=!0;if(w&&y.queryParameterPatterns)for(var u in y.queryParameterPatterns)var z=RegExp(y.queryParameterPatterns[u].pattern).exec(a.content?a.content[u]:null),x=x&&!!z;if(w&&w.length&&0<w.length&&x)if(x=f._handlers[y.handlerName]){k=!0;try{if(!1===x.handle(d,y,w,c.token()))k=!1;else break}catch(B){f.app.trace.warning("Offline request failed for resource '"+
a.url+"'. "+B);n.errback(Error("Offline request failed"));break}}else f.app.trace.warning("Offline request failed for resource '"+a.url+"'. Matching rule found without handler.")}k||f._defaultHandler.handle(d,null,null,c.token())});n.then(function(){return c.dispose()},function(){return c.dispose()});return n};b.prototype._whenReady=function(a){if(this.isReady.get())a();else this.isReady.once(this,a)};b.prototype._stripOutProxy=function(a){if(!a)return null;var b=this.app.configuration.proxyUri;if(0<=
a.indexOf(b)){if(a.replace)return a.replace(b,"")}else return a;return null};return b}();g.OfflineRouter=c})(g.bundle||(g.bundle={}))})(d.offline||(d.offline={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){(function(d){var c=function(){return function(b,a,e){this.url=this.timeOut=this.handleAs=this.content=this.options=null;b&&dojo.mixin(this,b);this.dfd=a||new dojo.Deferred;this.options=e||null}}();d.RequestContext=c})(d.bundle||(d.bundle={}))})(d.offline||(d.offline={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){(function(g){function c(a){return[{handlerName:"Rewrite",pattern:a,parameters:{newUrl:"Resources/Images/blank-tile.png"}}]}function b(a,b,e){var f=[],c=-1!==b.serviceLayer.url.indexOf("?")?b.serviceLayer.url.substr(0,b.serviceLayer.url.indexOf("?")):b.serviceLayer.url,c=c.toLowerCase();(b=e.featureLayerSyncInfo.servers.filter(function(a){return!!a.layers.filter(function(b){return a.featureServiceUrl.toLowerCase()===c})[0]})[0])?f.push({handlerName:"Rewrite",
pattern:a+"/+(.+)",parameters:{newUrl:b.localServerUrl.replace("FeatureServer","MapServer")+"/{1}"}}):f=f.concat(n(a));return f}function a(a){a=decodeURI(a).replace(/%24/g,"$");return[{handlerName:"Rewrite",pattern:a.replace(/\$?{subDomain}/ig,"(?:.*)").replace(/\$?{level}/ig,"[0-9]*").replace(/\$?{row}/ig,"[0-9]*").replace(/\$?{col}/ig,"[0-9]*"),parameters:{newUrl:"Resources/Images/blank-tile.png"}}]}function e(a,b,e){var c=[],d=/^(.*)(\/\+?[0-9]+\/?\+?)$/.exec(a)[1],l=/^(.*)\/([0-9]+\/?)$/.exec(b.serviceUrl),
n=l[1],l=parseInt(l[2]);c.push({handlerName:"ServeResource",pattern:d+"/*$",parameters:{key:d}});var g=-1!==b.serviceLayer.url.indexOf("?")?b.serviceLayer.url.substr(0,b.serviceLayer.url.indexOf("?")):b.serviceLayer.url,g=g.toLowerCase(),p=e.featureLayerSyncInfo.servers.filter(function(a){return!!a.layers.filter(function(b){return(a.featureServiceUrl+"/"+b.id).toLowerCase()===g})[0]})[0];p?c.push({handlerName:"Rewrite",pattern:a+"/+(.+)",parameters:{newUrl:p.localServerUrl+"/"+l+"/{1}"}}):c=c.concat(h(d,
l));a=b.serviceLayer.relationships.map(function(a){return f(d,n,p?p.localServerUrl:null,a,e)});return c=c.concat.apply(c,a)}function f(a,b,e,f,c){var d=[{handlerName:"ServeResource",pattern:a+"/+"+f.relatedTableId+"/*$",parameters:{key:a+"/+"+f.relatedTableId}}];e&&c.featureLayerSyncInfo.servers.filter(function(a){return a.featureServiceUrl===b}).some(function(a){return a.layers&&a.layers.some(function(a){return a.id===f.relatedTableId})})?d.push({handlerName:"Rewrite",pattern:a+"/+"+f.relatedTableId+
"/+(.+)",parameters:{newUrl:e+"/"+f.relatedTableId+"/{1}"}}):d=d.concat(h(a,f.relatedTableId));return d}function l(a,b,e){if(e=e.basemaps.filter(function(a){return a.url===b.url||a.url===b.serviceUrl})[0]){var f=p(a);return[{handlerName:"Rewrite",pattern:a+"/+tile/+([0-9]*)/+([0-9]*)/+([0-9]*)",parameters:{newUrl:"{localserver}/"+e.localServicePath+"/{{{0}}}/{{{1}}}/{{{2}}}".format(f+1,f+2,f+3)}}].concat(n(a))}return c(a+"/+(tile|tilemap)").concat(n(a))}function n(a){return[{handlerName:"ServeResource",
pattern:a+"/+([^/]*/+)?(query|queryRelatedRecords|identify|find)",parameters:{key:"__no_features"}}]}function h(a,b){return[{handlerName:"ServeResource",pattern:a+"/+"+b+"/+(query|queryRelatedRecords|applyEdits)",parameters:{key:"__no_features"}}]}function p(a){a instanceof RegExp?(a=a.toString(),a=a.substring(1,a.length-2),a=RegExp(a+"|")):a=RegExp(a.toString()+"|");return a.exec("").length-1}g.buildRoutingRules=function(f){var h=[{handlerName:"Rewrite",pattern:"/arcgis/+rest/+services/+Utilities/+Geometry/+GeometryServer/+(.*)",
parameters:{newUrl:"{localserver}/GeometryServer/{1}"}},{handlerName:"ServeResource",pattern:"/map/+layerlist$",parameters:{key:"__layerlist_"}},{handlerName:"ServeResource",pattern:"/search$",parameters:{key:"__no_search_results"}},{handlerName:"Site",pattern:g.urlToPattern(f.app.site.originalUrl)+"/*$",parameters:{key:"__site_"}}],r=[],p=f.app.site.essentialsMap.mapServices;f.app.site.overviewMap&&(p=p.concat(f.app.site.overviewMap.mapServices));p.forEach(function(p){if(-1===r.indexOf(p.url)){r.push(p.url);
var k=p.serviceLayer&&p.serviceLayer.attributionDataUrl||p.attributionDataUrl;k&&h.push({handlerName:"ServeResource",pattern:g.urlToPattern(k),parameters:{key:"__empty_attribution_response"}});k=g.urlToPattern(g.cleanUpMapServiceUrl(f,p));p.mapServiceType===d.essentials.MapServiceType.BING||p.mapServiceType===d.essentials.MapServiceType.WMS?h=h.concat(c(k)):p.mapServiceType===d.essentials.MapServiceType.WMTS||p.mapServiceType===d.essentials.MapServiceType.WEBTILED?h=h.concat(a(k)):(h=p instanceof
d.essentials.FeatureLayerService?h.concat(e(k,p,f)):h.concat(b(k,p,f)),p.mapServiceType===d.essentials.MapServiceType.TILED&&(h=h.concat(l(k,p,f))),p.mapServiceFunction===d.essentials.MapServiceFunction.BASE||p instanceof d.essentials.FeatureLayerService||(h=h.concat(n(k))),h.push({handlerName:"ServeResource",pattern:k+"/*$",parameters:{key:k}}))}});h.push({handlerName:"ServeResource",pattern:"/+map/+mapservices/+[0-9]+/+layers/+[0-9]+/+datalinks/+[^/]+/+link$",parameters:{key:"__no_data_links"}});
return h}})(g.bundle||(g.bundle={}))})(h.offline||(h.offline={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){var g=function(){function g(c,b){this.app=c;this._enabled=!0;this.matchMapBackground=!1;this.fillColor=null;this.boundaryColor=new esri.Color("red");this.boundaryWidth=2;this.boundaryStyle=esri.symbol.SimpleLineSymbol.STYLE_SOLID;this.layerId="AreaOfInterestMask"}g.prototype.show=function(c){var b=this;this._aoi=c;this.app.waitUntilSiteServiceLayersLoaded().then(function(){if(b._enabled){var a=b._getLayer();a.clear();(b.fillColor||b.boundaryStyle!==
esri.symbol.SimpleFillSymbol.STYLE_NULL)&&a.show();if(b.fillColor){for(var e=new esri.geometry.Polygon(c.spatialReference),f=b.app.map.getLayer(b.app.map.layerIds[0]),f=h.GeometryUtils.toRing(f.fullExtent.expand(1.5)),d=0;d<c.rings.length;d++)e.rings.push(dojo.clone(c.rings[d]).reverse());e.rings.push(f);f=new esri.symbol.SimpleFillSymbol(esri.symbol.SimpleFillSymbol.STYLE_SOLID,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_NULL),b.fillColor);e=new esri.Graphic({geometry:e});
e.setSymbol(f);b.app.map.graphics.add(e)}b.boundaryStyle!==esri.symbol.SimpleFillSymbol.STYLE_NULL&&(e=new esri.symbol.SimpleFillSymbol(esri.symbol.SimpleFillSymbol.STYLE_NULL,new esri.symbol.SimpleLineSymbol(b.boundaryStyle,b.boundaryColor,b.boundaryWidth),new esri.Color("white")),f=new esri.Graphic({geometry:c}),f.setSymbol(e),a.add(f));b.matchMapBackground&&b.fillColor&&(a=b._getMapNode(),b._originalMapBackground=a.css("background-color"),a.css("background-color","rgba("+b.fillColor.r+","+b.fillColor.g+
","+b.fillColor.b+","+b.fillColor.a+")"))}})};g.prototype.hide=function(){this._aoi=null;var c=this.app.map.getLayer(this.layerId);c&&this.app.map.removeLayer(c);this.matchMapBackground&&this._getMapNode().css("background-color",this._originalMapBackground)};g.prototype.enable=function(){this._enabled=!0;this._aoi&&this.show(this._aoi)};g.prototype.disable=function(){this._enabled=!1};g.prototype.configure=function(c){c&&(d.framework.utils.isNullOrUndefined(c.boundaryColor)||(this.boundaryColor=new esri.Color(c.boundaryColor)),
d.framework.utils.isNullOrUndefined(c.boundaryWidth)||(this.boundaryWidth=c.boundaryWidth),d.framework.utils.isNullOrUndefined(c.boundaryStyle)||("null"==c.boundaryStyle?this.boundaryStyle=esri.symbol.SimpleLineSymbol.STYLE_NULL:"solid"==c.boundaryStyle?this.boundaryStyle=esri.symbol.SimpleLineSymbol.STYLE_SOLID:"dash"==c.boundaryStyle?this.boundaryStyle=esri.symbol.SimpleLineSymbol.STYLE_DASH:"dot"==c.boundaryStyle&&(this.boundaryStyle=esri.symbol.SimpleLineSymbol.STYLE_DOT)),d.framework.utils.isNullOrUndefined(c.enabled)||
(c.enabled?this.enable():this.disable()),d.framework.utils.isNullOrUndefined(c.fillColor)||(this.fillColor=new esri.Color(c.fillColor)),d.framework.utils.isNullOrUndefined(c.layerId)||(this.layerId=c.layerId),d.framework.utils.isNullOrUndefined(c.matchMapBackground)||(this.matchMapBackground=c.matchMapBackground))};g.prototype._getLayer=function(){var c=this.app.map.getLayer(this.layerId);c||(c=new esri.layers.GraphicsLayer({id:this.layerId}),this.app.map.addLayer(c));return c};g.prototype._getMapNode=
function(){return $(".esriMapContainer").first().parent()};return g}();h.AreaOfInterestMask=g})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var k=function(){function c(b,a){this.app=b;this.libraryId=a;this._previousActiveOfflineMapId=this._activeOfflineMapId=null;this._offlineMaps=[];this.canCancel=new Observable(!1);this.isOfflineMapActive=new Observable(!1);this._bundleManager=new g.bundle.BundleManager(b,a);this.aoiMask=new h.AreaOfInterestMask(b,{enabled:!1})}c.prototype.addOfflineMap=function(b,a){var e=this;return this._lastOperation=this._waitForLast()["finally"](function(){g.OfflineMap.verify(b);
e._throwIfNotNativeInitialized();e.canCancel.set(!0);e._cancellationTokenSource=new h.CancellationTokenSource;a||(a=function(){});var f=g.WorkCalculator.calculateFirstDownloadWork(b),c=g.WorkCalculator.noWork(),d=function(){return g.WorkCalculator.calculatePercentageComplete(c,f)};return Promise.resolve(e.app.site.updateServiceTokensIfStale()).then(function(){return e._appStoreSetPromise(e._getOfflineMapKey(b),JSON.stringify(b))}).then(function(){a({message:e.getResource("language-offline-progress-savingofflinemap"),
percentage:d()});e._offlineMaps.push(b);return e._save()}).then(function(){e._throwIfCanceled();c.saveProfileWork=f.saveProfileWork;a({message:e.getResource("language-offline-progress-starting-sync"),percentage:d()});var h=g.SyncParameters.buildSyncParameters(e.app,b);return g.SyncEngine.sync(e.app,h,e._cancellationTokenSource.token(),function(b){c.featureLayerWork=b.overallProgress/100*f.featureLayerWork;a({message:b.text,percentage:d()})})}).then(function(){e._throwIfCanceled();c.featureLayerWork=
f.featureLayerWork;a({message:e.getResource("language-offline-progress-starting-basemap-download"),percentage:d()});return g.downloadBasemaps(e.app,b,e._cancellationTokenSource.token(),function(b){c.basemapWork=b.percentage/100*f.basemapWork;a({message:b.message,percentage:d(),isWarning:b.isWarning})})}).then(function(){e._throwIfCanceled();c.basemapWork=f.basemapWork;a({message:e.getResource("language-offline-progress-downloadingsite"),percentage:d()});return e._bundleManager.createBundle(b.id,e._getOfflineMapBasemapMapping(b))}).then(function(){e._throwIfCanceled();
c.bundleWork=f.bundleWork;a({message:e.getResource("language-offline-progress-complete"),percentage:d()});e.app.event("OfflineMapAddedEvent").publish({offlineMap:b})})["catch"](function(a){e._removeOfflineMapNow(b,function(){});throw Error(a);})["finally"](function(){e._cancellationTokenSource.dispose();e._cancellationTokenSource=null;e.canCancel.set(!1)})})};c.prototype.removeOfflineMap=function(b,a){var e=this;return this._lastOperation=this._waitForLast()["finally"](function(){return e._removeOfflineMapNow(b,
a)})};c.prototype._removeOfflineMapNow=function(b,a){var e=this;if(!b)throw Error(this.getResource("language-offline-errors-offlinemapnull"));this._throwIfNotNativeInitialized();var f=this._getOfflineMapIx(b);if(-1===f)throw Error(this.getResource("language-offline-errors-notfound"));if(this._offlineMaps[f].id===this._activeOfflineMapId)throw Error(this.getResource("language-offline-errors-isactive"));return g.SyncEngine.deleteData(this.app,this._offlineMaps[f].id)["catch"](function(a){e.app.trace.error("Error deleting feature data: "+
a)}).then(function(){a&&a(e.getResource("language-offline-progress-unregisteringreplica"));return e._bundleManager.deleteBundle(e._offlineMaps[f].id)})["catch"](function(a){e.app.trace.error("Error deleting bundle: "+a)}).then(function(){a&&a(e.getResource("language-offline-progress-removingofflinemap"));var c=e._offlineMaps[f].content.basemaps.filter(function(a){return a.sourceType===g.OfflineMapBasemap.Type.EXPORT_TILES});g.deleteBasemaps(e.app,c).then(null,function(a){e.app.trace.error("Error deleting offline map. "+
a)});return e._appStoreRemovePromise(e._getOfflineMapKey(b))})["catch"](function(a){e.app.trace.error("Error deleting offline map. "+a)}).then(function(){e._offlineMaps[f].id===e._previousActiveOfflineMapId&&(e._previousActiveOfflineMapId=null);e._offlineMaps.splice(f,1);return e._save()})["finally"](function(){e.app.event("OfflineMapRemovedEvent").publish({offlineMap:b})})};c.prototype.syncOfflineMap=function(b,a){var e=this;return this._lastOperation=this._waitForLast()["finally"](function(){if(!b)throw Error(e.getResource("language-offline-errors-offlinemapnull"));
var f=e._getOfflineMapIx(b);if(-1===f)throw Error(e.getResource("language-offline-errors-notfound"));e._throwIfNotNativeInitialized();if("string"===typeof b||b instanceof String)b=e._offlineMaps[f];var c=null;b!==e._offlineMaps[f]&&(c=g.OfflineMap.diff(e._offlineMaps[f],b));e.canCancel.set(!0);e._cancellationTokenSource=new h.CancellationTokenSource;var d=g.WorkCalculator.calculateSyncWork(b),r=g.WorkCalculator.noWork(),p=function(){return g.WorkCalculator.calculatePercentageComplete(r,d)};return Promise.resolve(e.app.site.updateServiceTokensIfStale()).then(function(){var f=
g.SyncParameters.buildSyncParameters(e.app,b);return g.SyncEngine.sync(e.app,f,e._cancellationTokenSource.token(),function(b){r.featureLayerWork=b.overallProgress/100*d.featureLayerWork;a({message:b.text,percentage:p()})})}).then(function(){e._throwIfCanceled();r.featureLayerWork=d.featureLayerWork;var a=[];c&&c.content&&c.content.geometry?a=e._offlineMaps[f].content.basemaps.filter(function(a){return a.sourceType===g.OfflineMapBasemap.Type.EXPORT_TILES}):c&&c.content&&c.content.basemaps&&(a=e._offlineMaps[f].content.basemaps.filter(function(a){return a.sourceType===
g.OfflineMapBasemap.Type.EXPORT_TILES}).filter(function(a){return!c.content.basemaps.some(function(b){return b.baseMapId===a.baseMapId&&b.sourceType===a.sourceType&&b.url===a.url&&b.minLevel===a.minLevel&&b.maxLevel===a.maxLevel})}));return 0<a.length?g.deleteBasemaps(e.app,a):null}).then(function(){e._throwIfCanceled();a({message:e.getResource("language-offline-progress-starting-basemap-download"),percentage:p()});return g.downloadBasemaps(e.app,b,e._cancellationTokenSource.token(),function(b){r.basemapWork=
b.percentage/100*d.basemapWork;a({message:b.message,percentage:p(),isWarning:b.isWarning})})}).then(function(){e._throwIfCanceled();e.canCancel.set(!1);r.basemapWork=d.basemapWork;a({message:e.getResource("language-offline-progress-downloadingsite"),percentage:p()});return e._bundleManager.updateBundle(b.id,e._getOfflineMapBasemapMapping(b))}).then(function(){if(!c)return null;a({message:e.getResource("language-offline-progress-savingofflinemap"),percentage:p()});return e._appStoreSetPromise(e._getOfflineMapKey(b),
JSON.stringify(b))}).then(function(){if(!c)return null;e._offlineMaps.splice(f,1,b);return e._save()}).then(function(){r.bundleWork=d.bundleWork;a({message:e.getResource("language-offline-progress-complete"),percentage:p()});e._offlineMaps[f]=b;e.aoiMask.show(new esri.geometry.Polygon(e._offlineMaps[f].content.geometry));e.app.site.essentialsMap.mapServices.forEach(function(a){return a.refresh()});e.app.event("OfflineMapSyncedEvent").publish({offlineMap:b})})["finally"](function(){e._cancellationTokenSource.dispose();
e._cancellationTokenSource=null;e.canCancel.set(!1)})})};c.prototype.updateBundle=function(b){var a=this;return this._lastOperation=this._waitForLast()["finally"](function(){if(!b)throw Error(a.getResource("language-offline-errors-offlinemapnull"));var e=a._getOfflineMapIx(b);if(-1===e)throw Error(a.getResource("language-offline-errors-notfound"));a._throwIfNotNativeInitialized();return a._bundleManager.updateBundle(a._offlineMaps[e].id,a._getOfflineMapBasemapMapping(a._offlineMaps[e]))})};c.prototype.activateOfflineMap=
function(b,a){var e=this;return this._lastOperation=this._waitForLast()["finally"](function(){if(!b)throw Error(e.getResource("language-offline-errors-offlinemapnull"));var f=e._getOfflineMapIx(b);if(-1===f)throw Error(e.getResource("language-offline-errors-notfound"));e._throwIfNotNativeInitialized();var c=e._activeOfflineMapId;e._activeOfflineMapId=e._offlineMaps[f].id;return e._bundleManager.loadBundle(e._activeOfflineMapId).then(function(){return e.refreshSyncInfo()}).then(function(){return e._save()})["catch"](function(a){e._activeOfflineMapId=
c;return Promise.resolve().then(function(){return c?e._bundleManager.loadBundle(e._activeOfflineMapId):e._bundleManager.unloadBundle()}).then(function(){return e.refreshSyncInfo()})["catch"](function(a){e.app.trace.error("Error undoing attempt to activate offline map. "+(a.message||a))}).then(function(){throw a;})}).then(function(){e.app.isOffline.set(!0);e.isOfflineMapActive.set(!0);var b=new esri.geometry.Polygon(e._offlineMaps[f].content.geometry);e.aoiMask.show(b);e._restoreOfflineUserAddedLayers(e._offlineMaps[f]);
e.app.site.essentialsMap.mapServices.forEach(function(a){if(a instanceof d.essentials.FeatureLayerService){var b=a.serviceLayer;b.suspended&&b.resume()}a.refresh()});e.app.event("OfflineMapActivatedEvent").publish({offlineMap:e._offlineMaps[f],userAction:!!a})})})};c.prototype.deactivateOfflineMap=function(b){var a=this;return this._lastOperation=this._waitForLast()["finally"](function(){a._throwIfNotNativeInitialized();if(null==a._activeOfflineMapId)return Promise.resolve();a._previousActiveOfflineMapId=
a._activeOfflineMapId;a._activeOfflineMapId=null;return a._bundleManager.unloadBundle().then(function(){return a.refreshSyncInfo()}).then(function(){return a._save()}).then(function(){a.app.isOffline.set(!1);a.isOfflineMapActive.set(!1);a.aoiMask.hide();a.app.site.updateServiceTokensIfStale().then(function(){a.app.site.essentialsMap.mapServices.forEach(function(a){if(a instanceof d.essentials.FeatureLayerService){var b=a.serviceLayer,c=new esri.tasks.Query;c.objectIds=[0];b.queryIds(c,function(){a.refresh()},
function(){b.suspend()})}else a.refresh()})});a.app.event("OfflineMapActivatedEvent").publish({offlineMap:null,userAction:!!b})})})};c.prototype.cancel=function(){return this.canCancel.get()?(this._cancellationTokenSource.cancel(),this.canCancel.set(!1),this._lastOperation):Promise.reject(this.getResource("language-offline-errors-cancelrejected"))};c.prototype.forgetLast=function(){this._lastOperation=Promise.resolve()};c.prototype.getOfflineMapById=function(b){return this._offlineMaps.filter(function(a){return a.id===
b})[0]};c.prototype.getOfflineMaps=function(){return this._offlineMaps.concat()};c.prototype.getActiveOfflineMap=function(){return this._activeOfflineMapId?this.getOfflineMapById(this._activeOfflineMapId):null};c.prototype.refreshSyncInfo=function(){var b=this;return this._activeOfflineMapId?g.SyncEngine.getSyncInfo(this.app,this._activeOfflineMapId).then(function(a){b.syncInfo=a}):(this.syncInfo=null,Promise.resolve())};c.prototype._save=function(){var b=this,a={offlineMapIds:this._offlineMaps.map(function(a){return a.id}),
activeOfflineMapId:this._activeOfflineMapId,previousActiveOfflineMapId:this._previousActiveOfflineMapId};return this._appStoreSetPromise("__offlineManager",JSON.stringify(a))["catch"](function(a){b.app.trace.error("Error saving offline manager state. "+(a.message||a));a.message=b.getResource("language-offline-errors-savefailed");throw a;})};c.prototype.load=function(){var b=this;this._lastOperation||(this._lastOperation=this._appStoreGetPromise("__offlineManager").then(function(a){if(!a)return null;
var e=JSON.parse(a);a=e.offlineMapIds.map(function(a){return b._loadOfflineMapFromStorage(a)["catch"](function(e){b.app.trace.warning("Unable to restore offline map '"+a+"'. "+(e.message||e));return null})});return Promise.filter(a,function(a){return null!=a}).then(function(a){b._offlineMaps=a;a=b._prioritizeOfflineMaps(e,b._offlineMaps);return b._initializeMap(a)}).then(function(){b.app.event("OfflineMapsLoadedEvent").publish({offlineMaps:b._offlineMaps,activeOfflineMap:b.getActiveOfflineMap()})})})["catch"](function(a){b.app.trace.error("Error loading offline manager state. "+
(a.message||a));a.message=b.getResource("language-offline-errors-loadfailed");throw a;}))};c.prototype._prioritizeOfflineMaps=function(b,a){for(var e=[b.activeOfflineMapId,b.previousActiveOfflineMapId],f=0,c=a.map(function(a){return a.id});f<c.length;f++){var d=c[f];d!==b.activeOfflineMapId&&d!==b.previousActiveOfflineMapId&&e.push(d)}return e};c.prototype._initializeMap=function(b){var a=this;if(0===b.length&&this.app.isOffline.get())return Promise.resolve();var e=b[0];return this.app.isOffline.get()&&
!e?this._initializeMap(b.slice(1)):e?this._bundleManager.loadBundle(e).then(function(){a._activeOfflineMapId=e;a.app.isOffline.set(!!e);a.isOfflineMapActive.set(!!e);var b=a._getOfflineMapIx(e),c=a._offlineMaps[b],b=new esri.geometry.Polygon(a._offlineMaps[b].content.geometry);a.aoiMask.show(b);a._restoreOfflineUserAddedLayers(c);return a.refreshSyncInfo()})["catch"](function(e){return a._initializeMap(b.slice(1))}):Promise.resolve()};c.prototype._waitForLast=function(){return this._lastOperation["catch"](function(b){})};
c.prototype._throwIfCanceled=function(){if(this._cancellationTokenSource.token().isCancellationRequested)throw Error(this.getResource("language-offline-errors-canceled"));};c.prototype._throwIfNotNativeInitialized=function(){if(!this.app.nativeManager.nativeInitialized)throw Error(this.getResource("language-offline-errors-notnativeinitialized"));};c.prototype._loadOfflineMapFromStorage=function(b){var a=this;return this._appStoreGetPromise(this._getOfflineMapKey(b)).then(function(b){if(!b)throw a.app.trace.error("Offline profile '{offlineMapId}' not found."),
Error(a.getResource("language-offline-errors-notfound"));return JSON.parse(b)},function(b){a.app.trace.error("Error loading offline map. "+(b.message||b));b.message=a.getResource("language-offline-errors-loadfailed");throw b;})};c.prototype._restoreOfflineUserAddedLayers=function(b){var a=this;this.app.waitUntilSiteServiceLayersLoaded().then(function(){var e=[],f=h.gis.AppInfo.fromGeocortexApp(a.app);b.content.layers.forEach(function(a){if(a.isUserCreated&&a.serviceInfo){var c=a.serviceInfo.url;if(c){var g=
f.mapInfo.getLayerInfos().filter(function(b){return b.uniqueId===a.layerInfoUniqueId})[0];if(g)g.gcxLayer&&g.gcxLayer.properties.offlineMapId&&(g.gcxLayer.properties.offlineMapId=b.id);else{var h=f.mapInfo.serviceLayers.filter(function(a){return a.serviceLayer.url===c})[0];if(h&&h.gcxMapService){g=new d.essentials.Layer(a.layerJson.url);g.createFromDefinition(a.layerJson);g.isUserCreated=!0;g.catalogId=a.layerJson.catalogId;g.includeInLayerList=!0;g.setInActiveTheme(!0);g.properties.offlineMapId=
b.id;g.parentLayerId=null;h.gcxMapService.add(g);var k=e.filter(function(a){return a.service===h.gcxMapService})[0];k?k.layers.push(g):e.push({service:h.gcxMapService,layers:[g]})}}}}});e.forEach(function(b){a.app.event("MapServiceLayersChangedWithResultEvent").publish({mapService:b.service,newItems:b.layers,oldItems:[]});a.app.event("MapServiceLayersChangedEvent").publish(b.service)})})};c.prototype._getOfflineMapIx=function(b){b="string"===typeof b?b:b.id;for(var a=0;a<this._offlineMaps.length;a++)if(this._offlineMaps[a].id===
b)return a;return-1};c.prototype._getOfflineMapBasemapMapping=function(b){var a=this.app.site.essentialsMap.baseMaps;return b.content.basemaps.map(function(b){var f=a.filter(function(a){return b.baseMapId===a.id})[0];return f?(f=f.services.filter(function(a){return a.mapService.mapServiceType===d.essentials.MapServiceType.TILED}).pop())?{url:d.essentials.utilities.DecomposedUri.removeQueryParameters(f.mapService.serviceLayer.url,"token"),localServicePath:(b.sourceType===g.OfflineMapBasemap.Type.PREGENERATED?
"tile":"viewertile")+"/"+b.filename.replace(" ","_")}:null:null}).filter(function(a){return!!a})};c.prototype._getOfflineMapKey=function(b){return"string"===typeof b?"__offlineMap-"+b:"__offlineMap-"+b.id};c.prototype._appStoreGetPromise=function(b){var a=this;return new Promise(function(e,f){return a.app.store.get(b,e,f)})};c.prototype._appStoreSetPromise=function(b,a){var e=this;return new Promise(function(f,c){return e.app.store.set(b,a,function(){return f()},c)})};c.prototype._appStoreRemovePromise=
function(b){var a=this;return new Promise(function(e,f){return a.app.store.remove(b,function(){return e()},f)})};c.prototype.getResource=function(b){return this.app.getResource(this.libraryId,b)};return c}();g.OfflineManager=k})(h.offline||(h.offline={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){(function(d){function c(b,a){return b===a||JSON.stringify(b)===JSON.stringify(a)}d.verify=function(b){if(!b)throw Error("offlineMap is null or undefined.");if(!b.id)throw Error("offlineMap.id is null or undefined.");if(!b.content)throw Error("offlineMap.content is null or undefined.");if(!b.content.geometry)throw Error("offlineMap.content.geometry is null or undefined.");if(b.content.basemaps)for(var a=0;a<b.content.basemaps.length;a++){if(!b.content.basemaps[a].url)throw Error("offlineMap.content.basemaps["+
a+"].url is null or undefined.");if(!b.content.basemaps[a].baseMapId)throw Error("offlineMap.content.basemaps["+a+"].baseMapId is null or undefined.");if(!b.content.basemaps[a].filename)throw Error("offlineMap.content.basemaps["+a+"].filename is null or undefined.");if(!b.content.basemaps[a].sourceType)throw Error("offlineMap.content.basemaps["+a+"].sourceType is null or undefined.");}else throw Error("offlineMap.content.basemaps is null or undefined.");if(b.content.layers)for(a=0;a<b.content.layers.length;a++){if(!b.content.layers[a].layerInfoUniqueId)throw Error("offlineMap.content.layers["+
a+"].layerInfoUniqueId is null or undefined.");}else throw Error("offlineMap.content.layers is null or undefined.");if(!b.properties.siteId)throw Error("offlineMap.properties.siteId is null or undefined.");if(!b.properties.viewerId)throw Error("offlineMap.properties.viewerId is null or undefined.");};d.diff=function(b,a){var e={};b.description!==a.description&&(e.description=a.description);c(b.grants,a.grants)||(e.grants=a.grants);c(b.properties,a.properties)||(e.properties=a.properties);c(b.shape,
a.shape)||(e.shape=a.shape);c(b.tags||[],a.tags||[])||(e.tags=a.tags);b.title!==a.title&&(e.title=a.title);c(b.thumbnail,a.thumbnail)||(e.thumbnail=a.thumbnail);b.version!==a.version&&(e.version=a.version);null==b.content!==(null==a.content)?e.content=a.content:null==a.content?e.content=null:c(b.content,a.content)||(e.content={},c(b.content.geometry,a.content.geometry)||(e.content.geometry=a.content.geometry),c(b.content.layers,a.content.layers)||(e.content.layers=a.content.layers),c(b.content.basemaps,
a.content.basemaps)||(e.content.basemaps=a.content.basemaps),b.content.includeAttachments!==a.content.includeAttachments&&(e.content.includeAttachments=a.content.includeAttachments));for(var f in e)if(e.hasOwnProperty(f))return e;return null}})(d.OfflineMap||(d.OfflineMap={}));(function(d){d.Type={EXPORT_TILES:"exportTiles",PREGENERATED:"pregenerated"}})(d.OfflineMapBasemap||(d.OfflineMapBasemap={}))})(d.offline||(d.offline={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||
(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var h=function(){function c(b){this.servers=[];for(var a=0;a<b.servers.length;a++)"string"==typeof b.servers[a].lastSyncTime&&(b.servers[a].lastSyncTime=new Date(b.servers[a].lastSyncTime)),this.servers.push(b.servers[a])}c.prototype.isSynced=function(b){return!!this.findLayerOrTable(b)};c.prototype.findLayerOrTable=function(b){var a=d.essentials.utilities.LayerUtilities.decomposeFeatureLayerUrl(b);b=this.servers.filter(function(b){return b.featureServiceUrl==
a.serviceUrl});for(var e=0;e<b.length;e++){var f=b[e],c=f.layers.filter(function(b){return b.id==a.layerId})[0];if(c)return c;if(f=f.layers.filter(function(b){return b.id==a.layerId})[0])return f}return null};return c}();g.SyncInfo=h})(h.offline||(h.offline={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var h=function(){function c(){}c.getSyncInfo=function(b,a){return b.nativeManager.xhrGet({url:b.localServerAddress+"/sync/"+b.localServerNamespace+"/info?profile="+a}).then(function(a){a=JSON.parse(a);return new g.SyncInfo(a)})};c.sync=function(b,a,e,f){var c=this;b.event("FeatureDataSyncStartedEvent").publish(a);return this._unregisterOfflineDeletedReplicas(b).then(function(d){return c._sync(b,a,e,f)}).then(function(a){b.event("FeatureDataSyncCompletedEvent").publish();
return a})};c._sync=function(b,a,e,f){var c=this;e.register(function(){return c._cancel(b)});return new Promise(function(e,d){var g=b.event("NativeMessageEvent").subscribe(c,function(a){"syncStatus"===a.type&&(a.parameters.state===c.STATUS_SUCCESS?(b.event("NativeMessageEvent").unsubscribe(g),f(a.parameters),e(a.parameters)):a.parameters.state===c.STATUS_ERROR?(b.event("NativeMessageEvent").unsubscribe(g),d(a.parameters.text)):a.parameters.state===c.STATUS_IN_PROGRESS&&f(a.parameters))}),h={options:JSON.stringify(a)};
b.nativeManager.xhrPost({url:b.localServerAddress+"/sync/"+b.localServerNamespace+"/execute",content:h,error:function(a){b.event("NativeMessageEvent").unsubscribe(g);d(a.responseText)}})})};c._cancel=function(b){return b.nativeManager.xhrPost({url:b.localServerAddress+"/sync/"+b.localServerNamespace+"/cancel",method:"POST"})};c.deleteData=function(b,a){var e=this._getFeatureServiceTokenInfo(b),f=b.localServerAddress+"/sync/"+b.localServerNamespace+"/delete",e={parameters:JSON.stringify({profile:a,
serviceInfo:e})};return b.nativeManager.xhrPost({url:f,content:e,method:"POST"})};c._unregisterOfflineDeletedReplicas=function(b){var a=this._getFeatureServiceTokenInfo(b),e=b.localServerAddress+"/sync/"+b.localServerNamespace+"/unregisterDeletedReplicas",a={parameters:JSON.stringify({serviceInfo:a})};return b.nativeManager.xhrPost({url:e,content:a})};c._getFeatureServiceTokenInfo=function(b){return b.site.essentialsMap.mapServices.filter(function(a){return a instanceof d.essentials.FeatureLayerService}).map(function(a){return{serviceUrl:d.essentials.utilities.LayerUtilities.decomposeFeatureLayerUrl(a.serviceUrl).serviceUrl,
token:a.serviceToken}})};c.STATUS_IN_PROGRESS="inProgress";c.STATUS_SUCCESS="success";c.STATUS_ERROR="error";return c}();g.SyncEngine=h})(h.offline||(h.offline={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(g){(function(g){g.buildSyncParameters=function(c,b){var a=d.gis.AppInfo.fromGeocortexApp(c).mapInfo.getLayerInfos(),e=[];b.content.layers.forEach(function(b){var c,d,g,h,k,m=a.filter(function(a){return a.uniqueId==b.layerInfoUniqueId})[0];if(m||b.isUserCreated){if(m){d=m.url.substring(0,m.url.lastIndexOf("/"));g=parseInt(m.id);c={id:g,where:b.definitionExpression};if(m.gcxLayer.isDynamic){h=m.serviceLayerInfo.serviceLayer;if(k=h.dynamicLayerInfos.filter(function(a){return a.id===
g})[0])c.dynamicLayerInfo=k.toJson();if(h=h.layerDrawingOptions[g])c.layerDrawingOptions=h.toJson()}k=m.serviceLayerInfo.gcxMapService.serviceToken;h=m.serviceLayerInfo.capabilities}else if(b.isUserCreated&&b.serviceInfo&&b.layerJson)d=b.serviceInfo.url,h=b.serviceInfo.capabilities,g=parseInt(b.layerJson.id),c=JSON.parse(b.layerJson.dynamicDefinition),c={id:g,where:b.definitionExpression,dynamicLayerInfo:c,layerDrawingOptions:c?c.drawingInfo:null};else return;var q=e.filter(function(a){return a.url===
d})[0];q?q.layers.push(c):(q={url:d,layers:[c],capabilities:h,token:k},e.push(q));m&&m.relationships.forEach(function(a){q.layers.some(function(b){return b.id==a.relatedTableId})||q.layers.push({id:a.relatedTableId})})}});return{profile:b.id,featureServices:e,geometry:b.content.geometry,includeAttachments:b.content.includeAttachments,mapSpatialReference:c.map.spatialReference.toJson()}}})(g.SyncParameters||(g.SyncParameters={}))})(d.offline||(d.offline={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||
(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(){function c(){}c.calculateFirstDownloadWork=function(b){return{saveProfileWork:0.25,featureLayerWork:b.content.layers.length+2,basemapWork:4*b.content.basemaps.length,bundleWork:0.5}};c.calculateSyncWork=function(b){return{saveProfileWork:0,featureLayerWork:b.content.layers.length+2,basemapWork:2*b.content.basemaps.length,bundleWork:0.5}};c.noWork=function(){return{saveProfileWork:0,bundleWork:0,featureLayerWork:0,basemapWork:0}};
c.calculatePercentageComplete=function(b,a){return this._calculateTotalWork(b)/this._calculateTotalWork(a)*100};c._calculateTotalWork=function(b){return b.saveProfileWork+b.bundleWork+b.featureLayerWork+b.basemapWork};return c}();d.WorkCalculator=h})(d.offline||(d.offline={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(g){function k(b){return d.SecurityUtils.getIdentity("ags-oauth2",b)}function c(b){b=k(b);return b?(b=d.SecurityUtils.getClaimsByType(b,"http://www.geocortex.com/security/ags/portal")[0])?b.value:null:null}g.getPortalIdentity=k;g.hasAccessToPortal=function(b){return!!k(b)};g.hasCreateContentPrivilege=function(b){return(b=k(b))?d.SecurityUtils.hasPrivilegeClaim(b,"portal:user:createItem"):!1};g.hasPublishFeaturePrivilege=function(b){return(b=
k(b))?d.SecurityUtils.hasPrivilegeClaim(b,"portal:publisher:publishFeatures"):!1};g.getPortalBaseUrl=c;g.getPortalMyContentUrl=function(b){var a=c(b);return a?String.format("{0}{1}",a,b.configuration.portalContentRelUrl||"home/content.html"):null};g.getPortalItemUrl=function(b,a){var e=c(a);return e?String.format("{0}{1}{2}",e,a.configuration.portalItemRelUrl||"home/item.html?id=",b):null}})(d.PortalUtils||(d.PortalUtils={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||
(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){g.PROJECT_TYPE="gvh-project";g.SITE_ID_PROPERTY_NAME="siteID";g.VIEWER_ID_PROPERTY_NAME="viewerID";g.PROJECT_QUERY_STRING_KEY="project";g.VIEWER_QUERY_STRING_KEY="viewer";var k=function(){function c(b){this._serviceDiscovery=null;if(!b)throw Error("ProjectManager: Parameter 'app' is required.");this.app=b;this.convert=new g.ProjectConverter(b);this.filter=new g.ProjectFilter(b)}c.prototype.createEmpty=function(b){var a={};a[g.SITE_ID_PROPERTY_NAME]=
{string:this.app.site.id};a[g.VIEWER_ID_PROPERTY_NAME]={string:this.app.configModel.viewerId};return{title:b,fileType:g.PROJECT_TYPE,contentType:"application/json",content:{moduleState:{}},properties:a}};c.prototype.create=function(b){b=this.createEmpty(b);return this.update(b)["return"](b)};c.prototype.update=function(b){return this._exportState().then(function(a){b.content=a})};c.prototype.remove=function(b){var a=this;if(!b)throw Error('RemoveProject: parameter "project" is required.');var e=this.getProjectID(b);
return this.app.waitUntilSiteInitialized().then(function(){return a.app.event("ProjectDeletingEvent").publish(e)}).then(function(){return a.app.site.documentStore.deleteById(e)}).then(function(){a.current&&a.current.id===e&&(a.current=null)}).then(function(){a.app.event("ProjectDeletedEvent").publish(e)})["catch"](function(b){a.app.event("ProjectErrorEvent").publish(null,b);var e=a._getResource("language-project-error-title"),c=a._getResource("language-project-error-delete");b&&"writer denied"===
b.formalCode&&(c=a._getResource("language-project-error-delete-denied"));a.app.command("Alert").execute(c,e);throw b;})};c.prototype.save=function(b,a){var e=this;void 0===a&&(a=!0);if(!b)throw Error('SaveProject: parameter "project" is required.');return this.app.waitUntilSiteInitialized().then(function(){return e.app.event("ProjectSavingEvent").publish(b)}).then(function(){return a?(new Promise(function(a,b){return h.ShellUtils.debounceViewEvents(e.app,function(){return a()})})).then(function(){return e.update(b)}).then(function(){return h.MapUtils.getThumbnailUri(e.app)}).then(function(a){return b.thumbnail=
{location:a}})["catch"](function(a){e.app.event("ProjectErrorEvent").publish(b,a);var c=e._getResource("language-project-error-title"),d=e._getResource("language-project-error-write");e.app.command("Alert").execute(d,c);throw a;}):Promise.resolve()}).then(function(){return e.write(b)}).then(function(a){return dojo.mixin(b,a)}).then(function(){return e.app.event("ProjectSavedEvent").publish(b)})};c.prototype.load=function(b){var a=this;if(!b)throw Error('LoadProject: parameter "project" is required.');
var e=this.getProjectID(b);this.app.event("ProjectLoadingEvent").publish(e);"object"===typeof b&&void 0===b.content&&(b=e);return this.getProject(b).then(function(b){return a._beginLoad(b)}).then(function(){if(a.current&&a.current.content)return a._applyState(a.current.content)}).then(function(){return a._finishLoad()})["catch"](function(b){a.isLoading=!1})};c.prototype.write=function(b){var a=this;if(!b)throw Error('ProjectManager.write: Parameter "project" is required.');b.content&&b.content.isDecoded&&
this.encodeReferences(b.content);return this.app.waitUntilSiteInitialized().then(function(){return d.framework.utils.isNullOrUndefined(b.id)?a.app.site.documentStore.add(b).then(function(a){b.id=a.id;return a}):a.app.site.documentStore.updateById(b.id,b)})["catch"](function(e){a.app.event("ProjectErrorEvent").publish(b,e);var f=a._getResource("language-project-error-title"),c=a._getResource("language-project-error-write");!e||"writer denied"!==e.formalCode&&"create denied"!==e.formalCode||(c=a._getResource("language-project-error-write-denied"));
a.app.command("Alert").execute(c,f);throw e;})};c.prototype.read=function(b,a){var e=this;void 0===a&&(a=!0);if(!b)throw Error('ProjectManager.read: parameter "id" is required.');return this.app.waitUntilSiteInitialized().then(function(){return e.app.site.documentStore.getById(b,a)}).then(function(a){return a?(e.decodeReferences(a.content),e._filterApplicationState(a.content).then(function(b){a.content=b;return a})):a})["catch"](function(a){e.app.event("ProjectErrorEvent").publish(null,a);var c=e._getResource("language-project-error-title"),
d=e._getResource("language-project-error-read");if(a&&"item missing"===a.formalCode)d=e._getResource("language-project-error-read-not-found").format(b);else if(a&&"reader denied"===a.formalCode){d=e._getResource("language-project-error-read-denied");if(e.app.command("SignIn").canExecute(null))throw d=e._getResource("language-project-error-sign-in-required"),e.app.command("Confirm").execute(d,c,function(a){a?e.app.command("SignIn").execute(null):window.location.assign(h.UrlUtils.removeQueryParameter(window.location.href,
"project"))},{okLabel:e._getResource("language-project-sign-in")}),a;d=e._getResource("language-project-error-read-denied")}e.app.command("Alert").execute(d,c);throw a;})};c.prototype.getProject=function(b,a){void 0===a&&(a=!0);if(!b)throw Error('ProjectManager.getProject: parameter "project" is required.');return"string"===typeof b?this.app.project.read(b,a):Promise.resolve(b)};c.prototype.getProjectID=function(b){if(!b)throw Error('ProjectManager.getProjectID: parameter "project" is required.');
return"string"===typeof b?b:b.id};c.prototype.getProjectUrl=function(b){if(!b||!b.id)return null;var a=this.getSiteID(b);if(!a)throw Error("ProjectManager.getProjectUrl: project siteId is null or undefined.");var e=this.getViewerID(b);if(!e)throw Error("ProjectManager.getProjectUrl: project viewerId is null or undefined.");var f=window.location.href;-1<f.indexOf("?")?f=f.substring(0,f.indexOf("?")):-1<f.indexOf("#")&&(f=f.substring(0,f.indexOf("#")));var c=new h.Dictionary;"unknown"!==e&&(a=encodeURIComponent("{0}.{1}".format(a,
e)),c.set(g.VIEWER_QUERY_STRING_KEY,a));c.set(g.PROJECT_QUERY_STRING_KEY,encodeURIComponent(b.id));return"{0}{1}".format(f,h.UrlUtils.queryStringDictionaryToString(c))};c.prototype.getSiteID=function(b){if(!b)throw Error('ProjectManager.getSiteID: parameter "project" is required.');return b.properties?(b=b.properties[g.SITE_ID_PROPERTY_NAME])?b.string:null:null};c.prototype.getViewerID=function(b){if(!b)throw Error('ProjectManager.getViewerID: parameter "project" is required.');return b.properties?
(b=b.properties[g.VIEWER_ID_PROPERTY_NAME])?b.string:null:null};c.prototype.validateProjectOwnership=function(b){return this.app.site.documentStore.isOwner(b)?Promise.resolve(b):Promise.reject(this._getResource("language-project-error-owner"))};c.prototype._initializeDiscoveryProvider=function(){var b=this;return this._serviceDiscovery?Promise.resolve():this.app.waitUntilSiteInitialized().then(function(){var a=b.app.site,e=new d.essentials.serviceDiscovery.SiteServiceDiscoveryProvider;e.initialize(a);
b._serviceDiscovery=e})};c.prototype._validateAgainstServiceDiscovery=function(b){var a=this,e={mapService:b,trusted:!1};return b.isUserCreated&&b.userLayerType===d.essentials.UserLayerType.LAYER_ADDITION?this._initializeDiscoveryProvider().then(function(){return a._serviceDiscovery.findServices(b.serviceUrl)}).then(function(a){Array.isArray(a)&&a.some(function(a){return!!a.isWhitelisted})?e.trusted=!0:e.trusted=!1;return e})["catch"](function(){e.trusted=!1;return e}):(e.trusted=!0,Promise.resolve(e))};
c.prototype._excludeUnsafeState=function(){var b=this;return Promise.map(this.app.site.essentialsMap.mapServices,function(a){return b._validateAgainstServiceDiscovery(a)}).then(function(a){for(var e=0;e<a.length;e++){var f=a[e];f.trusted||b.convert.exclude(f.mapService,h.webMap.ConversionType.GCX_MAP_SERVICE)}})};c.prototype._exportState=function(){var b=this;this.convert.clearCache();return this._excludeUnsafeState().then(function(){var a=b._getModules(),e={};Object.keys(a).forEach(function(b){e[b]=
Promise["try"](function(){return a[b].exportState()})});return h.PromiseUtils.propsSkipRejected(e)}).then(function(a){for(var e in a)a[e]||delete a[e];a={mapScale:b.app.map.getScale(),mapCenter:b.convert.fromEsriGeometry(b.app.map.extent.getCenter()),moduleState:a};return b._filterApplicationState(a)}).then(function(a){b.encodeReferences(a);return a})};c.prototype._applyState=function(b){var a=this;if(!b)return Promise.resolve();this.decodeReferences(b);var e=b.moduleState||[];return Promise.map(Object.keys(e),
function(b){var c=a._getModules()[b];if(c){var d=e[b];d.serialVersion||(d.serialVersion=1);return Promise["try"](function(){return c.applyState(d)})["catch"](function(e){return a.app.trace.warning('Unable to restore project state for module "{0}": {1}'.format(b,e))})}})["return"]()};c.prototype._applyMapExtent=function(b){this.app.site.essentialsMap.extentManager.setScaleWithPriority(b.content.mapScale,Number.MAX_VALUE);b=this.convert.toEsriGeometry(b.content.mapCenter);this.app.site.essentialsMap.extentManager.centerAtWithPriority(b,
Number.MAX_VALUE)};c.prototype._getResource=function(b){return this.app.getResource("Mapping.Infrastructure",b)};c.prototype._getModules=function(){return this.app.moduleManager._modules};c.prototype._beginLoad=function(b){var a=this;return this.app.waitUntilSiteInitialized().then(function(){if(a.isLoading)throw Error("Cannot load a new project until the current project has finished loading.");var e=a.getSiteID(b);if(a.app.site.id!==e)throw Error('The project "{0}" was created for the Essentials site ID "{1}" and is not compatible with this site.'.format(b.title,
e));a.convert.clearCache();a.isLoading=!0;a.current=b;a._applyMapExtent(b)})};c.prototype._finishLoad=function(){var b=this;setTimeout(function(){return b._applyMapExtent(b.current)},150);this.app.event("ProjectLoadedEvent").publish(this.current);this.isLoading=!1};c.prototype._filterApplicationState=function(b){var a=this,e={mapCenter:this.filter.point,mapScale:!0,moduleState:{},isDecoded:!0},f=this._getModules();return Promise.map(Object.keys(f),function(c){var d=f[c];d&&(d=d.getStateFilter(),b.moduleState[c]&&
!d?a.app.trace.warning('Module "{0}" has project state, but has no defined state filter. A module that participate in projects must implement ModuleBase.getStateFilter().'.format(c)):(d=$.extend({},d,{serialVersion:!0}),e.moduleState[c]=d))}).then(function(){return h.ObjectFilter.filter(b,e,{XssHtmlValidator:{defaultContentPolicy:a.app.defaultContentPolicy}})})};c.prototype.encodeReferences=function(b){if(b){var a=RegExp("~","g"),e=new WeakMap,f=[],c=function(b){Array.isArray(b)||e.set(b,"~"+f.join("~"));
for(var d=0,g=Object.keys(b);d<g.length;d++){var h=g[d],k=b[h];if(k&&"object"===typeof k){var m=e.get(k);m?b[h]=m:(f.push((h+"").replace(a,"\\x7e")),c(k),f.pop())}else k&&"string"===typeof k&&k.startsWith("~")&&(b[h]=k.replace("~","\\x7e"))}};c(b);delete b.isDecoded}};c.prototype.decodeReferences=function(b){if(b&&!b.isDecoded){var a=RegExp("\\x7e".replace("\\","\\\\"),"g"),e=new WeakMap,f=function(c){if(!e.has(c)){e.set(c,!0);for(var d=0,g=Object.keys(c);d<g.length;d++){var h=g[d],k=c[h];if(k&&"string"===
typeof k)if(k.startsWith("~")){for(var k=k.split("~").map(function(b){return b.replace(a,"~")}),m=b,q=1;q<k.length;q++){var w=k[q];w&&m&&(m=m[w])}c[h]=m}else k.startsWith("\\x7e")&&(c[h]=k.replace("\\x7e","~"));else k&&"object"===typeof k&&f(k)}}};f(b);b.isDecoded=!0}};return c}();g.ProjectManager=k})(h.project||(h.project={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){d.allSkipRejected=function(d){var c={};return Promise.resolve(d).then(function(b){b=(b||[]).map(function(a){return Promise.resolve(a)["catch"](function(a){return c})});return Promise.all(b).then(function(a){return a.filter(function(a){return a!==c})})})};d.mapSkipRejected=function(d,c,b){var a={};return Promise.resolve(d).then(function(e){e=(e||[]).map(function(b){return Promise.resolve(b)["catch"](function(b){return a})});return Promise.map(e,
function(b,e,d){return Promise["try"](function(){return c(b,e,d)})["catch"](function(b){return a})},b).then(function(b){return b.filter(function(b){return b!==a})})})};d.propsSkipRejected=function(d){return Promise.resolve(d).then(function(c){var b={};return Promise.map(Object.keys(c),function(a){return Promise.resolve(c[a]).then(function(e){b[a]=e},function(a){})})["return"](b)})};d.warnOnReject=function(d,c,b){return Promise.resolve(d)["catch"](function(a){c.trace.warning(b.format(a));return Promise.reject(a)})}})(d.PromiseUtils||
(d.PromiseUtils={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(g){g.getAllFeaturesFromReportable=function(g){var c=[];g instanceof d.FeatureSetCollection?g.featureSets.get().forEach(function(b){b.features.get().forEach(function(a){c.push(a)})}):g instanceof d.FeatureSet?g.features.get().forEach(function(b){c.push(b)}):g instanceof d.Feature?c.push(g):g&&g.constructor===Array&&(c=g);return c}})(d.reporting||(d.reporting={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||
(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(){return function(){}}();d.ClusterLayerArgs=h})(d.commandArgs||(d.commandArgs={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(){return function(){}}();d.SnappingFeedbackEventArgs=h})(d.eventArgs||(d.eventArgs={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(){function c(){}c.Default="default";c.MutuallyExclusive="mutuallyExclusive";return c}();d.LayerVisibilityType=h})(d.layerList||(d.layerList={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var k=function(){function c(b,a){this.filteredLayerSelectorLayerItems=[];this.unfilteredLayerSelectorLayerItems=[];this.itemTypes={FOLDER:"folder",LAYER:"layer",SERVICELAYER:"serviceLayer"};this._infrastructureLibraryId="Mapping.Infrastructure";this._unfilteredItems=[];this._userAddedLayersFolder=null;this.appInfo=b;a&&(a.layerFilter&&dojo.isFunction(a.layerFilter)&&(this.layerFilter=a.layerFilter),a.layerStateChangeHandler&&dojo.isFunction(a.layerStateChangeHandler)&&
(this.layerStateChangeHandler=a.layerStateChangeHandler),a.enableAllLayersHandler&&dojo.isFunction(a.enableAllLayersHandler)&&(this.enableAllLayersHandler=a.enableAllLayersHandler),a.disableAllLayersHandler&&dojo.isFunction(a.disableAllLayersHandler)&&(this.disableAllLayersHandler=a.disableAllLayersHandler),a.onInitializedHandler&&dojo.isFunction(a.onInitializedHandler)&&(this.onInitializedHandler=a.onInitializedHandler),a.onLayerSelectorFolderItemCreated&&dojo.isFunction(a.onLayerSelectorFolderItemCreated)&&
(this.onLayerSelectorFolderItemCreated=a.onLayerSelectorFolderItemCreated),a.onLayerSelectorLayerItemCreated&&dojo.isFunction(a.onLayerSelectorLayerItemCreated)&&(this.onLayerSelectorLayerItemCreated=a.onLayerSelectorLayerItemCreated),a.onLayerSelectorServiceLayerItemCreated&&dojo.isFunction(a.onLayerSelectorServiceLayerItemCreated)&&(this.onLayerSelectorServiceLayerItemCreated=a.onLayerSelectorServiceLayerItemCreated));this.items=new ObservableCollection;this._suspendLayerStateChangeHandler=this.initialized=
!1;this.initialize()}c.prototype.initialize=function(){this._loadLayerSelectorItems();this.applyFilter(this.layerFilter);this.setLayerStateChangeHandler(this.layerStateChangeHandler);this.setEnableAllLayersHandler(this.enableAllLayersHandler);this.setDisableAllLayersHandler(this.disableAllLayersHandler);if(this.onInitializedHandler&&!this.initialized)this.onInitializedHandler(this);this.initialized=!0};c.prototype.applyFilter=function(b){var a=this;this.layerFilter=b&&dojo.isFunction(b)?b:null;this.items.clear();
this.filteredLayerSelectorLayerItems=[];if(this.layerFilter){var e=function(b){var c=null;b.itemType===a.itemTypes.FOLDER?(c=a._generateItemCloneForFilter(b),b.items.get().forEach(function(a){(a=e(a))&&(!a.isFolder||a.isFolder&&a.items.length())&&c.items.addItem(a)})):b.itemType===a.itemTypes.SERVICELAYER&&0<b.items.getLength()?(a.layerFilter(b)?(c=a._generateItemCloneForFilter(b),a.filteredLayerSelectorLayerItems.push(c)):c=a._creatFolderItemFromServiceLayer(b,!0,!0),b.items.get().forEach(function(a){(a=
e(a))&&(!a.isFolder||a.isFolder&&a.items.length())&&c.items.addItem(a)})):a.layerFilter(b)&&(c=b,a.filteredLayerSelectorLayerItems.push(c));return c};this._unfilteredItems.forEach(function(b){(b=e(b))&&(!b.isFolder||b.isFolder&&b.items.length())&&a.items.addItem(b)})}else this.items.set(this._unfilteredItems),this.filteredLayerSelectorLayerItems=this.unfilteredLayerSelectorLayerItems.slice(0)};c.prototype.reapplyFilter=function(){this.applyFilter(this.layerFilter)};c.prototype.setLayerStateChangeHandler=
function(b){var a=this;(function(){a.unfilteredLayerSelectorLayerItems.forEach(function(a){a._isEnabledBindingToken&&(a.isEnabled.unbind(a._isEnabledBindingToken),delete a._isEnabledBindingToken)})})();(this.layerStateChangeHandler=b&&dojo.isFunction(b)?b:null)&&this.unfilteredLayerSelectorLayerItems.forEach(function(b){b._isEnabledBindingToken=b.isEnabled.bind(a,function(){a._suspendLayerStateChangeHandler||a.layerStateChangeHandler(b)})})};c.prototype.setEnableAllLayersHandler=function(b){this.enableAllLayersHandler=
b&&dojo.isFunction(b)?b:null};c.prototype.setDisableAllLayersHandler=function(b){this.disableAllLayersHandler=b&&dojo.isFunction(b)?b:null};c.prototype.enableAllLayers=function(){this._suspendLayerStateChangeHandler=!0;this.filteredLayerSelectorLayerItems.forEach(function(b){return b.isEnabled.set(!0)});this._suspendLayerStateChangeHandler=!1;this.enableAllLayersHandler&&this.enableAllLayersHandler()};c.prototype.disableAllLayers=function(){this._suspendLayerStateChangeHandler=!0;this.filteredLayerSelectorLayerItems.forEach(function(b){return b.isEnabled.set(!1)});
this._suspendLayerStateChangeHandler=!1;this.disableAllLayersHandler&&this.disableAllLayersHandler()};c.prototype.addUserAddedServiceLayer=function(b){var a=this;b instanceof h.gis.ServiceLayerInfo&&(b=b.gcxMapService);if(!b||this.unfilteredLayerSelectorLayerItems.filter(function(a){return a.serviceLayer&&a.serviceLayer.gcxMapService===b}).length)return!1;var e=h.gis.ServiceLayerInfo.fromGcxMapService(b),f=this._createServiceLayerItemFromServiceLayer(e,!0,!0);this.unfilteredLayerSelectorLayerItems.push(f);
b.layers.forEach(function(b){if(a.unfilteredLayerSelectorLayerItems.filter(function(a){return a.layer&&a.layer.gcxLayer===b}).length)return!1;var c=e.findLayerById(b.id);c||(c=h.gis.LayerInfo.fromGcxLayer(b),c.serviceLayerInfo=e,e.layers.push(c));if(c=a._createLayerItemFromLayer(c,!0,!0))f.items.addItem(c),a.unfilteredLayerSelectorLayerItems.push(c)});this._unfilteredItems.push(f);this.applyFilter(this.layerFilter);this.setLayerStateChangeHandler(this.layerStateChangeHandler);return!0};c.prototype.removeServiceLayer=
function(b){var a=this;b instanceof h.gis.ServiceLayerInfo&&(b=b.gcxMapService);if(!b)return!1;var e=this.unfilteredLayerSelectorLayerItems.filter(function(a){return a.serviceLayer&&a.serviceLayer.gcxMapService===b});e.length&&e.forEach(function(b){return a._removeItemFromUnfilteredCollections(b)});b.layers.forEach(function(b){var e=a.unfilteredLayerSelectorLayerItems.filter(function(a){return a.layer&&a.layer.gcxLayer===b});if(!e.length)return!1;e.forEach(function(b){return a._removeItemFromUnfilteredCollections(b)})});
this.applyFilter(this.layerFilter);this.setLayerStateChangeHandler(this.layerStateChangeHandler);return!0};c.prototype.updateServiceLayer=function(b,a,e){var f=this;a=a||[];e=e||[];b instanceof h.gis.ServiceLayerInfo&&(b=b.gcxMapService);if(!b)return!1;b=h.gis.ServiceLayerInfo.fromGcxMapService(b);for(var c=0;e&&c<e.length;c++){var g=e[c],r=this.unfilteredLayerSelectorLayerItems.filter(function(a){return a.layer&&a.layer.gcxLayer===g});r.length&&r.forEach(function(a){return f._removeItemFromUnfilteredCollections(a)})}this._userAddedLayersFolder||
(e={id:d.framework.utils.alphaNumericToken()+":UserAdded",name:this.appInfo.gcxApp.getResource(this._infrastructureLibraryId,"language-layerlist-user-added-layers-folder-title"),isExpanded:!0,isVisible:!0,items:[],canToggleVisibility:null,iconUri:null,isVisibleInLayerList:null,layerID:null,mapServiceID:null,layerVisibilityType:null,themeSettings:null,type:null},this._userAddedLayersFolder=this._createFolderItemFromRestItem(e,!0,!0));for(e=0;a&&e<a.length;e++)if(g=a[e],r=this.unfilteredLayerSelectorLayerItems.filter(function(a){return a.layer&&
a.layer.gcxLayer===g}),!r.length&&(r=b.findLayerById(g.id),r||(r=h.gis.LayerInfo.fromGcxLayer(g),r.serviceLayerInfo=b,b.layers.push(r)),r=this._createLayerItemFromLayer(r,!0,!0)))this._userAddedLayersFolder.items.addItem(r),this.unfilteredLayerSelectorLayerItems.push(r);this._userAddedLayersFolder&&0<this._userAddedLayersFolder.items.length()&&0>this._unfilteredItems.indexOf(this._userAddedLayersFolder)&&this._unfilteredItems.unshift(this._userAddedLayersFolder);this.applyFilter(this.layerFilter);
this.setLayerStateChangeHandler(this.layerStateChangeHandler);return!0};c.prototype._removeItemFromUnfilteredCollections=function(b){var a=this;if(b){var e=[],f=function(a,b){var e=a.indexOf(b);-1<e&&a.splice(e,1)},c=function(a,b){for(var d=a.length-1;0<=d;d--){var g=a[d];g===b?a.splice(d,1):g.isFolder&&g.items.length()&&(f(g.items.get(),b),g.items.pulse(),c(g.items.get(),b),0===g.items.length()&&e.push(g))}};b.isFolder||f(this.unfilteredLayerSelectorLayerItems,b);c(this._unfilteredItems,b);e.length&&
e.forEach(function(b){return a._removeItemFromUnfilteredCollections(b)})}};c.prototype._loadLayerSelectorItems=function(){var b=this,a=this.appInfo.gcxApp.site.layerListRestEndpoint,e=this.appInfo.mapInfo;this._unfilteredItems=[];this.unfilteredLayerSelectorLayerItems=[];var f=function(a){var c,d=void 0!=a.isExpanded?a.isExpanded:!0;switch(a.type){case "folder":c=b._createFolderItemFromRestItem(a,!0,d);break;case "mapService":c=e.findMapServiceById(a.mapServiceID);c=b._createServiceLayerItemFromServiceLayer(c,
!0,d);b.unfilteredLayerSelectorLayerItems.push(c);break;case "layer":c=(c=e.findMapServiceById(a.mapServiceID))&&c.findLayerById(a.layerID),c=b._createLayerItemFromLayer(c,!0,d),b.unfilteredLayerSelectorLayerItems.push(c)}if(c&&a.items)for(d=0;d<a.items.length;d++){var g=f(a.items[d]);g&&c.items.addItem(g)}return"folder"===a.type&&c&&0===c.items.getLength()?null:c};a.items&&a.items.length&&a.items.forEach(function(a){(a=f(a))&&b._unfilteredItems.push(a)});this._loadSelectorItemsNotInLayerList()};
c.prototype._loadSelectorItemsNotInLayerList=function(){for(var b=0;b<this.appInfo.mapInfo.serviceLayers.length;b++){var a=null,e=this.appInfo.mapInfo.serviceLayers[b];e&&!e.includeInLayerList&&(a=this._createServiceLayerItemFromServiceLayer(e,!0,!0),this._unfilteredItems.push(a),this.unfilteredLayerSelectorLayerItems.push(a));for(var f=0;f<e.layers.length;f++){var c=e.layers[f];!c||c&&c.includeInLayerList||(c=this._createLayerItemFromLayer(c,!0,!0),a&&c?(a.items.addItem(c),this.unfilteredLayerSelectorLayerItems.push(c)):
null==a&&c&&(this._unfilteredItems.push(c),this.unfilteredLayerSelectorLayerItems.push(c)))}}};c.prototype._createFolderItemFromRestItem=function(b,a,e){if(!b)return null;var f={};f.itemType=this.itemTypes.FOLDER;f.name=new Observable(b.name||"Layers");f.isFolder=!0;f.isEnabled=new Observable(!!a);f.isExpanded=new Observable(!!e);f.iconUri=new Observable("");f.items=new ObservableCollection;this._setTooltips(f);if(this.onLayerSelectorFolderItemCreated)this.onLayerSelectorFolderItemCreated(f);return f};
c.prototype._creatFolderItemFromServiceLayer=function(b,a,e){var f={};f.itemType=this.itemTypes.FOLDER;f.name=new Observable(b.name.get()||"Layers");f.isFolder=!0;f.isEnabled=new Observable(!!a);f.isExpanded=new Observable(!!e);f.iconUri=new Observable(b.iconUri.get()||"");f.items=new ObservableCollection;this._setTooltips(f);if(this.onLayerSelectorFolderItemCreated)this.onLayerSelectorFolderItemCreated(f);return f};c.prototype._createLayerItemFromLayer=function(b,a,e){if(!b)return null;var f={};
f.itemType=this.itemTypes.LAYER;f.isEnabled=new Observable(!!a);f.isExpanded=new Observable(!!e);f.name=new Observable(b.gcxLayer.displayName);f.isFolder=!1;f.iconUri=new Observable(b.gcxLayer.iconUri);f.layer=b;f.items=new ObservableCollection([]);this._setTooltips(f);if(this.onLayerSelectorLayerItemCreated)this.onLayerSelectorLayerItemCreated(f);return f};c.prototype._createServiceLayerItemFromServiceLayer=function(b,a,e){if(!b)return null;var f={};f.itemType=this.itemTypes.SERVICELAYER;f.isEnabled=
new Observable(!!a);f.isExpanded=new Observable(!!e);f.name=new Observable(b.gcxMapService.displayName);f.isFolder=!1;f.iconUri=new Observable(b.gcxMapService.iconUri);f.serviceLayer=b;f.items=new ObservableCollection([]);this._setTooltips(f);if(this.onLayerSelectorServiceLayerItemCreated)this.onLayerSelectorServiceLayerItemCreated(f);return f};c.prototype._generateItemCloneForFilter=function(b){var a=dojo.mixin({},b);a.isEnabled=new Observable(!0);a.items=new ObservableCollection;void 0!=b.serviceLayer&&
(a.serviceLayer=b.serviceLayer);return a};c.prototype._setTooltips=function(b){var a=this.appInfo.gcxApp.getResource(this._infrastructureLibraryId,"language-layerselector-item-expand").format(b.name.get()),e=this.appInfo.gcxApp.getResource(this._infrastructureLibraryId,"language-layerselector-state-toggle").format(b.name.get()),f=this.appInfo.gcxApp.getResource(this._infrastructureLibraryId,"language-layerselector-icon-tooltip").format(b.name.get());b.expanderTooltip=new Observable(a);b.stateToggleTooltip=
new Observable(e);b.iconTooltip=new Observable(f)};return c}();g.LayerSelector=k})(h.layerSelector||(h.layerSelector={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(){return function(c,b,a,e,f,d,g){this.text=c;this.imageUri=b;this.userClosedCallback=a;this.imageClass=e;this.id=f;this.timeoutMS=d||3E4;this.showBusyIcon=!!g}}();d.AddStatusArgs=h})(d.commandArgs||(d.commandArgs={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var k=function(){function c(b,a,e,f){this.destroyContentView=!1;this.delay=0;this.elementID=b||null;this.mapPoint=a||null;this.content=e||null;this.title=f||null}c.prototype.getNode=function(){if(this.content){if(this.contentIsView())return this.content.root;if(this.content.nodeName)return this.content;if("string"===typeof this.content){var b=document.createElement("div");b.innerHTML=(new h.FilterUtils.UnsafeHtml(this.content)).safeHtml;
return b}}return null};c.prototype.getTitleNode=function(){if(this.title){if(this.titleIsView())return this.title.root;if(this.title.nodeName)return this.title;if("string"===typeof this.title){var b=document.createElement("div");b.innerHTML=(new h.FilterUtils.UnsafeHtml(this.title)).safeHtml;return b}}return null};c.prototype.contentIsView=function(){return this.content&&this.content instanceof d.framework.ui.ViewBase};c.prototype.titleIsView=function(){return this.title&&this.title instanceof d.framework.ui.ViewBase};
return c}();g.ShowMapElementArgs=k})(h.commandArgs||(h.commandArgs={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));geocortex.essentialsHtmlViewer.mapping.infrastructure.ShowMapElementArgs=geocortex.essentialsHtmlViewer.mapping.infrastructure.commandArgs.ShowMapElementArgs;geocortex.essentialsHtmlViewer.mapping.infrastructure.AngleFormat=geocortex.essentialsHtmlViewer.mapping.infrastructure.coordinates.AngleFormat;
geocortex.essentialsHtmlViewer.mapping.infrastructure.AngleDirectionSystem=geocortex.essentialsHtmlViewer.mapping.infrastructure.coordinates.AngleDirectionSystem;geocortex.essentialsHtmlViewer.mapping.infrastructure.CoordinateUtils=geocortex.essentialsHtmlViewer.mapping.infrastructure.coordinates.CoordinateUtils;
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(){return function(){this.token=this.username=this.result=null}}();d.AuthenticationEventArgs=h})(d.eventArgs||(d.eventArgs={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));geocortex.essentialsHtmlViewer.mapping.infrastructure.AuthenticationEventArgs=geocortex.essentialsHtmlViewer.mapping.infrastructure.eventArgs.AuthenticationEventArgs;
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(){return function(){this.accuracyThreshold=this.typeOfGeolocation=this.location=this.projectedMapPoint=this.mapPoint=null;this.timedOut=!1}}();d.GeolocationEventArgs=h})(d.eventArgs||(d.eventArgs={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(){return function(){this.currentResolution=this.currentScale=this.centerLatLon=null}}();d.MapExtentEventArgs=h})(d.eventArgs||(d.eventArgs={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(){return function(){this.isCancelled=!1}}();d.UserEventArgs=h})(d.eventArgs||(d.eventArgs={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){var g=function(g){function c(b,a){g.call(this,b,a);this._xssHtmlValidator=new h.validation.XssHtmlValidator({contentPolicy:b.defaultContentPolicy})}__extends(c,g);c.prototype.attach=function(b){var a=this;if(b&&b instanceof h.Feature)return this.descriptionApply(b,this.root).then(function(){return g.prototype.attach.call(a,b)});g.prototype.attach.call(this,b);return Promise.resolve()};c.prototype.descriptionGet=function(b){return this.getDescriptionContent(b)};
c.prototype.getContentFieldFormat=function(b){switch(this.contentField){case "label":return b.labelFormat.get();case "description":return b.descriptionFormat.get();case "longDescription":return b.longDescriptionFormat.get();default:return b.longDescriptionFormat.get()}};c.prototype.getDescriptionContent=function(b,a){var e=this,f=a;f||(f=this.getContentFieldFormat(b));var c=this._extractCommandHyperlinks(f),f=c.html;return this._sanitizeHtml(b.formatTemplateString(f)).then(function(a){c.html=a;a=
e._injectCommandHyperlinks(c);return a=e.insertLinkAndImageBindings(a)})};c.prototype.descriptionApply=function(b,a){return this.applyDescriptiveTemplate(b,a)};c.prototype.applyDescriptiveTemplate=function(b,a){var e=this,f=[],c=this.getContentFieldFormat(b);if(c&&b.hasRelationships){var d=c.match(/{{.[^}]+?\..+?}}|{.[^}]+?\..+?}/g),g=[],h;for(h in d)if(d.hasOwnProperty(h)){var k=d[h],k=k.substr(1,k.length-2);g.push(k.match(/[^.].[^.]*/g))}if(g.length&&b.layer&&b.layer.relationships)for(h in b.layer.relationships)if(b.layer.relationships.hasOwnProperty(h)){var m=
b.layer.relationships[h];-1==g.toString().indexOf(m.name)&&-1==g.toString().indexOf(m.displayName)||f.push(new Promise(function(f,h){e.app.command("GetRelatedFeatures").execute({mapService:b.layer.mapService,currentFeature:b,relationshipId:m.id,objectId:b.id.get(),successCallback:function(h){return function(k){if(0<k.length)for(var p in g){if(g.hasOwnProperty(p)){var m=k[0],s=g[p],q=s[0].trim(),s=s[1].trim();if(-1!==h.indexOf(q)&&void 0!==m.attributes[s])for(p in d)if(d.hasOwnProperty(p)){var t=d[p];
-1!==c.indexOf(t)&&-1!==t.indexOf(q)&&-1!==t.indexOf(s)&&(c=c.replace(t,m.attributes[s]),e.getDescriptionContent(b,c).then(function(b){return a.innerHTML=b}).then(function(){return f()}))}}}else f()}}("{0}-{1}".format(m.name,m.displayName)),errorCallback:function(a){a.message="There was an error retrieving related features: "+a.message;e.app.trace.warning(a.message);f(a)}})}))}}f.push(this.getDescriptionContent(b).then(function(b){return a.innerHTML=b}));return Promise.all(f).then(function(){return null})};
c.prototype._extractCommandHyperlinks=function(b){var a=[];if(!b)return{html:b,commandHyperlinkPlaceholders:a};b=b.replace(/\bhref="#?command:.*?"/ig,function(b){var f='href="mailto:'+d.framework.utils.alphaNumericToken()+'"';a.push({commandHyperlink:b,placeholder:f});return f});return{html:b,commandHyperlinkPlaceholders:a}};c.prototype._injectCommandHyperlinks=function(b){var a=b.html,e=b.commandHyperlinkPlaceholders;return a?a.replace(/\bhref="mailto:.*?"/ig,function(a){for(var b=0;b<e.length;b++){var c=
e[b];if(a===c.placeholder)return c.commandHyperlink}}):""};c.prototype._sanitizeHtml=function(b){return this._xssHtmlValidator.validate(b,{sanitizeOptions:{allowFrames:!0,allowArbitraryHyperlinks:!0,uriTransformer:function(a,b){return b.type!==h.FilterUtils.UriType.NavigableLink?a:/^mailto\:/.test(a)?a:"command:OpenWebPage?"+a}}}).then(function(a){return a.validatedValue})};c.prototype.cleansedFormatForFormat=function(b){return this.insertLinkAndImageBindings(b)};c.prototype.insertLinkAndImageBindings=
function(b){var a=this;if(null===b)return null;if(b in this._descFormats)return this._descFormats[b];var e=/(<a.*?href\s*?=\s*?")(command:.+?)(".*?)(\/?>)/,f=b.replace(/<a[^>]*(\/?>)/g,function(b,f,c,d){return(f=b.match(e))?(c="",(b=b.match(/(title|aria-label)\s*?=\s*?"[^"]*?"/g))&&(c=" "+b.join(" ")),'<a _key="'+a.keyForUri(f[2])+'" href="javascript:void(0)" data-binding="{@event-onclick: handleHyperlinkClick}{@event-mouseup: ignoreEvent}{@event-mousedown: ignoreEvent}"'+c+f[4]):b}),f=f.replace(/<img/g,
'<img data-binding="{@event-load: handleImgLoad}"');return this._descFormats[b]=f};c.prototype.handleImgLoad=function(b){};c.prototype.keyForUri=function(b){var a=dojo.indexOf(this._uris,b);0<=a?a:(a=this._uris.length,this._uris.push(b));return a};c.prototype.parseArguments=function(b,a,e){var f={};if("none"===a)return null;if("string"===a)return this.tryPerformTokenSubstitution(b,e,f)?[f.value]:[b];if("list"===a){var c;try{c=JSON.parse(b)}catch(d){c=b.split("&")}for(var g=0;g<c.length;g++)this.tryPerformTokenSubstitution(c[g],
e,f)&&(c[g]=f.value);return c}try{g=JSON.parse(b)}catch(h){if(0>b.indexOf("=")){if(this.tryPerformTokenSubstitution(b,e,f))return[f.value];this.app.trace.warning("The specified parameter could not be parsed to a valid Object in JSON or Query String format.");return[null]}g=dojo.queryToObject(b)}for(var k in g)g.hasOwnProperty(k)&&"function"!==typeof g[k]&&this.tryPerformTokenSubstitution(g[k],e,f)&&(g[k]=f.value);e=null;"object"!==a&&(a=dojo.getObject(a)(),e=g,g=dojo.safeMixin(a,g));e&&g.spatialReference&&
!e.spatialReference&&(g.spatialReference=null);return[g]};c.prototype.tryPerformTokenSubstitution=function(b,a,e){var f=this;if(null===b||void 0===b||!(a&&a instanceof h.Feature))return e.value=null,!1;var c=a.esriFeature&&a.esriFeature.get&&a.esriFeature.get()||null;if("{$Feature}"===b)return e.value=a,!0;if("{$Graphic}"===b)return e.value=c||null,null===e.value?!1:!0;if("{$Geometry}"===b)return e.value=c&&c.geometry||null,null===e.value?!1:!0;if("string"===typeof b){var g=!1;b=b.replace(/{.+?}/g,
function(b){g=!0;var e=b.substring(1,b.length-1),h=c&&c.attributes[e];if(h)return h;!h&&a.layer&&(h=d.essentials.utilities.StringUtilities.replaceLayerTokens(e,a.layer));!h&&a.layer&&a.layer.mapService&&(h=d.essentials.utilities.StringUtilities.replaceMapServicetokens(e,a.layer.mapService));if(0<h.length)return h;f.app.trace.warning("The token syntax {"+e+"} was detected, but could not be matched to a valid replacement value.");return b});e.value=b;return g}return!1};c.prototype.decodeHtmlQuotes=
function(b){b=b.replace(/&quot;/g,'"');return b=b.replace(/&39;/g,"'")};c.prototype.decodeHtmlAmpersands=function(b){return b=b.replace(/&amp;/g,"&")};c.prototype.handleHyperlinkClick=function(b,a,e){b=a.getAttribute("_key");if(b=this._uris[b])b=new dojo._Url(b),"command"===b.scheme&&this.runCommand(b.path,b.query,e);return!1};c.prototype.ignoreEvent=function(b,a,e){return!1};c.prototype.runCommand=function(b,a,e){var f=this.app.command(b),c=d.essentialsHtmlViewer.Commands.metadataForCommandName(b);
if(null===c)this.app.trace.warning('The specified command "{0}" has no associated metadata.'.format(b));else if(c.isHyperlinkable){var g=[];a&&(a=this.decodeHtmlQuotes(a),a=this.decodeHtmlAmpersands(a),g=this.parseArguments(a,c.arguments,e));"OpenWebPage"==b?(b=[],b.push({url:g[0],isLink:!0}),f.execute.apply(f,b)):f.execute.apply(f,g)}else this.app.trace.warning('The specified command "{0}" is not able to be hyperlinked.'.format(b))};return c}(d.framework.ui.ViewBase);h.FeatureDescriptionPresenterView=
g;g.prototype._uris=[];g.prototype._descFormats={};g.prototype.contentField=null})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){function h(c){c&&d.framework.ui.animation.runWhenIdle(function(){try{c!==document.activeElement&&c.focus()}catch(b){}})}g.focusOnFirstInput=function(c){if(c&&c.root&&!(c.app&&c.app.modalRegionSingleton&&c.app.modalRegionSingleton.isActive&&"ModalViewContainerView"!==c.id))try{for(var b=$(c.root).find("input, a, button, select, textarea, [tabindex]").not(".inactive, .bound-invisible, .disabled, .close-16, .back-16, [tabindex=-1], [readonly]:not(.control-readonly)"),
a=0;a<b.length;a++){var e=b[a];if(!(1<=$(e).parentsUntil(c.root,".inactive, .bound-invisible, .disabled, .invisible, .hidden-hoisted-menu").length)){if(-1!==$.inArray(e.tagName.toLowerCase(),["select","input","textarea"])){if(e===document.activeElement)break;$(e).addClass("control-readonly");e.setAttribute("readonly","true");h(e);$(e).one("blur",function(a){e.removeAttribute("readonly");$(e).removeClass("control-readonly")});$(document).off("keypress.focus-control mousedown.focus-control touchstart.focus-control");
$(document).off("keydown.focus-control");$(document).on("keydown.focus-control",function(a){e.getAttribute("readonly")?8===a.keyCode&&a.preventDefault():$(document).off("keydown.focus-control")});$(document).one("keypress.focus-control mousedown.focus-control touchstart.focus-control",function(a){return function(a,b){b.removeAttribute("readonly");$(b).removeClass("control-readonly");if((a.target||a.srcElement)!==b)b.blur();else{b.blur();h(b);var e=b.getAttribute("type");e&&e.toLowerCase&&(e=e.toLowerCase());
("textarea"===b.tagName.toLowerCase()||"true"===b.contentEditable||e&&0<="date datetime datetime-local email month number password search text tel time week".split(" ").indexOf(e))&&"keypress"===a.type&&(0!=a.keyCode&&$(b).val($(b).val()+String.fromCharCode(a.keyCode)),/Edge\/\d+/i.test(navigator.userAgent)&&setTimeout(function(){b.setSelectionRange(1,1)},10))}$(document).off("keypress.focus-control mousedown.focus-control touchstart.focus-control");$(document).off("keydown.focus-control")}(a,e)})}else h(e);
break}}}catch(f){c.app&&c.app.trace.debug("Could not focus: "+f)}};g.focusOnMap=function(c){if(c){var b=function(a){a=a.root;$(a).find("svg").attr("focusable","false");a.tabIndex=0;h(a)};if(c.loaded)b(c);else var a=c.on("load",function(e){a.remove();b(e.map)})}};g.focus=h})(h.FocusUtils||(h.FocusUtils={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(g){function k(a,b){return b&&a&&a.name&&(-1!==a.name.indexOf(".Name()",a.name.length-7)||b.getFieldByName(a.name+".Name()"))?!0:!1}function c(a,e,f,c,d,l,g,n){void 0===d&&(d=!1);void 0===n&&(n="Mapping");var h=[],k=[],m=0,q={},D=function(){for(var a=0;a<h.length;a++)if(h[a].visible)if(d&&!h[a].hasOwnProperty("measurementId"))h.splice(a,1);else{var b=h[a].getLayer();b&&b.remove(h[a])}else h.splice(a,1)};if(a&&e&&e.length&&f){for(var C=0;C<
e.length;C++){var E=f.map.getLayer(e[C]);E&&k.push(E)}if(k.length){for(e=0;e<k.length;e++)(C=b(a,k[e],f))&&C.length&&(h=h.concat(C));for(a=0;a<h.length&&!(k=h[a],k.visible&&(k.hasOwnProperty("measurementId")?q.hasOwnProperty(k.measurementId)||(q[k.measurementId]=!0,m++):d||m++),1<m);a++);0===m?c&&c(h):1!==m&&l?(l=f.getResource(n,l),g=g?f.getResource(n,g):null,f.command("Confirm").execute(l,g,function(a){a?D():h=[];c&&c(h)})):(D(),c&&c(h))}else f.trace.error("Error deleting markup. No graphics layer(s) found."),
c&&c(h)}else f?f.trace.error("Error deleting markup. Required parameters missing."):console.log("Error deleting markup. Required parameters missing."),c&&c(h)}function b(b,c,d,l,g){void 0===g&&(g=6);var n=null,h=[];if(!b||!c||!d)return d?d.trace.error("Error retrieving markup. Required parameters missing."):console.log("Error retrieving markup. Required parameters missing."),h;if(!c.graphics.length)return h;"point"==b.type?n=e(b,g,d).getExtent():"polyline"==b.type?n=b.getExtent():"polygon"==b.type&&
(n=b.getExtent());if(null==n)return d.trace.error("Error retrieving markup. Could not compute extent."),h;for(b=0;b<c.graphics.length;b++)if(n.intersects(c.graphics[b].geometry))h.push(c.graphics[b]);else if(c.graphics[b].symbol instanceof esri.symbol.SimpleMarkerSymbol)if(c.graphics[b].geometry instanceof esri.geometry.Point)g=e(c.graphics[b].geometry,l||c.graphics[b].symbol.size,d),n.intersects(g)&&h.push(c.graphics[b]);else{if(c.graphics[b].geometry instanceof esri.geometry.Multipoint){g=c.graphics[b].symbol;
for(var k=c.graphics[b].geometry,m=0;m<k.points.length;m++){var q=new esri.geometry.Point(k.points[m],k.spatialReference);if(n.intersects(e(q,l||g.size,d))){h.push(c.graphics[b]);break}}}}else if(c.graphics[b].symbol instanceof esri.symbol.TextSymbol){var k=g=c.graphics[b].symbol,m=d.map.toScreen(c.graphics[b].geometry),v=f(k.text,k.font.family,k.font.size,k.font.weight),q=v.height,v=v.width;m.x+=k.xoffset;m.y-=k.yoffset;switch(k.align){case esri.symbol.TextSymbol.ALIGN_START:var A=new esri.geometry.Point(m.x,
m.y-q,null),D=new esri.geometry.Point(m.x+v,m.y-q,null),C=new esri.geometry.Point(m.x,m.y,null),E=new esri.geometry.Point(m.x+v,m.y,null);break;case esri.symbol.TextSymbol.ALIGN_MIDDLE:A=new esri.geometry.Point(m.x-v/2,m.y-q,null);D=new esri.geometry.Point(m.x+v/2,m.y-q,null);C=new esri.geometry.Point(m.x-v/2,m.y,null);E=new esri.geometry.Point(m.x+v/2,m.y,null);break;case esri.symbol.TextSymbol.ALIGN_END:A=new esri.geometry.Point(m.x-v,m.y-q,null),D=new esri.geometry.Point(m.x,m.y-q,null),C=new esri.geometry.Point(m.x-
v,m.y,null),E=new esri.geometry.Point(m.x,m.y,null)}A=d.map.toMap(A);D=d.map.toMap(D);C=d.map.toMap(C);E=d.map.toMap(E);k=new esri.geometry.Polygon({rings:[[[A.x,A.y],[D.x,D.y],[E.x,E.y],[C.x,C.y]]],spatialReference:A.spatialReference});k=a(g.angle,c.graphics[b].geometry,k);n.intersects(k)&&h.push(c.graphics[b])}return h}function a(a,b,e){e=new esri.geometry.Polygon(e.toJson());a=Math.PI/180*(360-(0>a?360+a:a)%360);for(var f=0;f<e.rings.length;f++)for(var c=0;c<e.rings[f].length;c++){var d=e.getPoint(f,
c),l=(d.x-b.x)*Math.cos(a)-(d.y-b.y)*Math.sin(a)+b.x,g=(d.x-b.x)*Math.sin(a)+(d.y-b.y)*Math.cos(a)+b.y;d.setX(l);d.setY(g);e.setPoint(f,c,d)}return e}function e(a,b,e){b=parseFloat(b);a=e.map.toScreen(a);var f=b/Math.sqrt(2)/2;b=new esri.geometry.Point(a.x-f,a.y-f,null);var c=new esri.geometry.Point(a.x+f,a.y-f,null),d=new esri.geometry.Point(a.x-f,a.y+f,null);a=new esri.geometry.Point(a.x+f,a.y+f,null);b=e.map.toMap(b);c=e.map.toMap(c);d=e.map.toMap(d);a=e.map.toMap(a);return new esri.geometry.Polygon({rings:[[[b.x,
b.y],[c.x,c.y],[a.x,a.y],[d.x,d.y],[b.x,b.y]]],spatialReference:b.spatialReference})}function f(a,b,e,f){void 0===f&&(f="normal");var c=document.body,d=document.createElement("div");b={fontFamily:b,fontSize:void 0!=e&&"number"===typeof e?e+"px":e,fontWeight:f,padding:"0",position:"absolute",lineHeight:"1",visibility:"hidden"};for(var l in b)d.style[l]=b[l];d.appendChild(document.createTextNode(a));c.appendChild(d);a={width:d.clientWidth,height:d.clientHeight};c.removeChild(d);return a}function l(a,
b,e){var f=e.map.getLayer(a);!f&&b&&(f=new esri.layers.GraphicsLayer,f.id=a,e.map.addLayer(f));return f}var n={};g.sanitizeAttributeNames=function(a,b){var e=b.mapService?"{0}.{1}".format(b.mapService.id,b.id):null,f;if(e&&n[e])f=n[e];else{f={};for(var c=0;c<b.fields.length;c++){var d=b.fields[c];k(d,b)||(f[d.alias]=d.name)}e&&(n[e]=f)}var e=[],l;for(l in f)f.hasOwnProperty(l)&&a.attributes.hasOwnProperty(l)&&("Null"===a.attributes[l]&&(a.attributes[l]=null),c=a.attributes[l],void 0!==c&&(c={alias:l,
name:f[l],value:c},c.alias!=c.name&&e.push(c)));for(f=0;f<e.length;f++)l=e[f],delete a.attributes[l.alias],a.attributes[l.name]=l.value};g._isSEPCodedDomainField=k;g.deleteMarkupSilently=function(a,b,e,f,d){void 0===d&&(d=!1);c(a,b,e,f,d)};g.deleteMarkup=c;g.getMarkupFromGeometry=b;g.rotatePolygon=a;g.getPolygonFromPoint=e;g.getRenderedTextMarkupSize=f;g.addGraphicToLayer=function(a,b,e){return a?(b=l(b,!0,e),b.add(a),b.visible||b.setVisibility(!0),!0):!1};g.getGraphicsLayer=l;g.getUserGraphicsLayers=
function(a){var b=function(b){return a.site.essentialsMap.mapServices.some(function(a){return a.serviceLayer===b||a.serviceLayer instanceof esri.layers.KMLLayer&&0<=a.serviceLayer.getLayers().indexOf(b)})},e=[],f=["snapping_graphics","snapping_helper_graphics","DefaultPushpinsLayer"],c=a.highlightManager.getHighlightLayers(),l;for(l in c)f.push(c[l].id);a.map.graphicsLayerIds.forEach(function(c){var l=a.map.getLayer(c);b(l)||l instanceof d.ClusterLayer||l.id.endsWith("-explodedClusterLayer")||0<=
f.indexOf(c)||e.push(l)});return e}})(d.GraphicUtils||(d.GraphicUtils={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){function h(c,b,a){return d.framework.utils.ArrayUtils.firstOrDefault(c.claims,function(e){return e.type===b&&e.value===a})}g.getIdentity=function(c,b){var a=b.site;return a&&a.principal&&a.principal.identities?d.framework.utils.ArrayUtils.firstOrDefault(a.principal.identities,function(a){return a.authenticationType===c}):null};g.getClaimsByType=function(c,b){return c.claims.filter(function(a){return a.type===b})};g.getClaimsByValue=
function(c,b){return c.claims.filter(function(a){return a.value===b})};g.getClaimByTypeAndValue=h;g.hasPrivilegeClaim=function(c,b){return!!h(c,"http://www.geocortex.net/security/claims/privilege",b)}})(h.SecurityUtils||(h.SecurityUtils={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){d=d.essentialsHtmlViewer||(d.essentialsHtmlViewer={});d=d.mapping||(d.mapping={});d=d.infrastructure||(d.infrastructure={});d=d.selection||(d.selection={});d=d.CombineMode||(d.CombineMode={});d.REPLACE="replace";d.UNION="union";d.SUBTRACT="subtract";d.INTERSECT="intersect"})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var k=function(){function c(b){this._store=new h.Dictionary;this.app=b}c.prototype.findByName=function(b){b=this.find({name:b});return d.framework.utils.ArrayUtils.firstOrDefault(b)};c.prototype.findByCollectionId=function(b){b=this.find({featureSetCollectionIds:[b]});return d.framework.utils.ArrayUtils.firstOrDefault(b)};c.prototype.findById=function(b){b=this.find({ids:[b]});return d.framework.utils.ArrayUtils.firstOrDefault(b)};c.prototype.findAll=
function(){return this.find()};c.prototype.find=function(b){b=b||{};var a=this._store.values();b.ids&&0<b.ids.length&&(a=a.filter(function(a){return-1<b.ids.indexOf(a.id)}));b.featureSetCollectionIds&&0<b.featureSetCollectionIds.length&&(a=a.filter(function(a){return-1<b.featureSetCollectionIds.indexOf(a.featureSetCollectionId)}));b.name&&(a=a.filter(function(a){return a.name&&a.name==b.name}));if(b.dateCreatedMin&&b.dateCreatedMin instanceof Date)var e=b.dateCreatedMin.getTime(),a=a.filter(function(a){return"undefined"!=
typeof a.timeCreated&&a.timeCreated>=e});if(b.dateCreatedMax&&b.dateCreatedMax instanceof Date)var f=b.dateCreatedMax.getTime(),a=a.filter(function(a){return"undefined"!=typeof a.timeCreated&&a.timeCreated<=f});if(b.dateModifiedMin&&b.dateModifiedMin instanceof Date)var c=b.dateModifiedMin.getTime(),a=a.filter(function(a){return"undefined"!=typeof a.timeModified&&a.timeModified>=c});if(b.dateModifiedMax&&b.dateModifiedMax instanceof Date)var d=b.dateModifiedMax.getTime(),a=a.filter(function(a){return"undefined"!=
typeof a.timeModified&&a.timeModified<=d});if(b.dateExpirationMin&&b.dateExpirationMin instanceof Date)var g=b.dateExpirationMin.getTime(),a=a.filter(function(a){return"undefined"!=typeof a.timeExpiration&&a.timeExpiration>=g});if(b.dateExpirationMax&&b.dateExpirationMax instanceof Date)var h=b.dateExpirationMax.getTime(),a=a.filter(function(a){return"undefined"!=typeof a.timeExpiration&&a.timeExpiration<=h});return a.map(function(a){return dojo.mixin({},a)})};c.prototype.add=function(b){if(!b)throw Error("The selection metadata cannot be null.");
b=dojo.mixin({},b);var a=b.id=this._generateId();this._store.set(a,b);return a};c.prototype.updateById=function(b,a){if(!b)throw Error("The metadata ID must be set.");if(!a)throw Error("The selection metadata cannot be null.");if(!this._store.containsKey(b))throw Error("Selection metadata with ID '{0}' not found.".format(b));var e=this._store.get(b);this._update(e,a)};c.prototype.removeById=function(b){if(!b)throw Error("The metadata ID must be set.");this._store.remove(b)};c.prototype.clear=function(){this._store.clear()};
c.prototype._update=function(b,a){b.name=a.name;b.count=a.count;b.timeCreated=a.timeCreated;b.timeModified=a.timeModified;b.timeExpiration=b.timeExpiration;b.featureSetCollectionId=a.featureSetCollectionId;b.modified=a.modified};c.prototype._generateId=function(){return d.framework.utils.alphaNumericToken()};return c}();g.SelectionMetadataStore=k})(h.selection||(h.selection={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer=
{}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){function h(c){if(!c)return NaN;var b=0;switch(c){case d.essentials.TimeUnits.UNIT_MILLISECONDS:b=1;break;case d.essentials.TimeUnits.UNIT_SECONDS:b=1E3;break;case d.essentials.TimeUnits.UNIT_MINUTES:b=6E4;break;case d.essentials.TimeUnits.UNIT_HOURS:b=36E5;break;case d.essentials.TimeUnits.UNIT_DAYS:b=864E5;break;case d.essentials.TimeUnits.UNIT_WEEKS:b=6048E5;break;case d.essentials.TimeUnits.UNIT_MONTHS:b=Math.round(26784E5);break;
case d.essentials.TimeUnits.UNIT_YEARS:b=31536E6;break;case d.essentials.TimeUnits.UNIT_DECADES:b=31536E7;break;case d.essentials.TimeUnits.UNIT_CENTURIES:b=31536E8;break;default:b=NaN}return b}g.convertTimeUnitToMilliseconds=h;g.computeTimeIntervalInMs=function(c,b){var a=h(b);return isNaN(parseInt(c,10))||isNaN(a)?NaN:a*c}})(h.TimeSliderUtils||(h.TimeSliderUtils={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||
(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){function h(b){if(!b)return null;var a=null,e=null,a=b.timeZoneId;b.essentialsMap&&b.essentialsMap.site&&(e=b.essentialsMap.site.timeZoneId);return d.framework.utils.ArrayUtils.firstOrDefault([a,e],function(a){return!!a})}function c(b,a){if(null===b||void 0===b)return null;if(!a)return b;var e=-moment.tz(b.getTime(),a).utcOffset();return moment(b).add(e,"minutes").toDate()}g.UTC_ZONE_ID="Etc/UTC";g.getTimeZoneFromLayer=function(b){if(!b)return null;
var a=null,e=null,a=b.timeZoneId;b.mapService&&(e=h(b.mapService));return d.framework.utils.ArrayUtils.firstOrDefault([a,e],function(a){return!!a})};g.getTimeZoneFromMapService=h;g.getDisplayTimeZoneFromMapService=function(b){return b?b.essentialsMap&&b.essentialsMap.site?b.essentialsMap.site.displayTimeZoneId:null:null};g.correctDatesForDisplayInDisplayTimeZone=function(b,a,e){if(null===b||void 0===b)return null;a||(a=g.UTC_ZONE_ID);if(!e)return c(b,a);var f=-b.getTimezoneOffset();e=moment.tz(b.getTime(),
e).utcOffset();f=-(f-e);b=c(b,a);return moment(b).add(f,"minutes").toDate()};g.correctDatesForDisplayInLocalTime=c;g.correctDatesToSubmitInDatabaseTime=function(b,a,e){if(null===b||void 0===b)return null;a||(a=g.UTC_ZONE_ID);a=moment.tz(b.getTime(),a).utcOffset();if(!e)return moment(b).add(a,"minutes").toDate();e=moment.tz(b.getTime(),e).utcOffset();e=a-e;a=-b.getTimezoneOffset();return moment(b).add(a+e,"minutes").toDate()};g.correctDatesToQueryInDatabaseTime=function(b,a,e){if(null===b||void 0===
b)return null;a||(a=g.UTC_ZONE_ID);a=moment.tz(b.getTime(),a).utcOffset();if(!e)return e=b.getTimezoneOffset(),moment(b).add(e+a,"minutes").toDate();e=moment.tz(b.getTime(),e).utcOffset();a-=e;return moment(b).add(a,"minutes").toDate()}})(h.TimeZoneUtils||(h.TimeZoneUtils={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){(function(g){(function(c){function b(a){void 0===a&&(a=6);for(var b=[],c=Math.random(),d=0;d<a;d++)b.push(c+1/a*d);return b.map(function(a){var b,e,f;a*=6;var c=0.8*(1-Math.abs(a%2-1)),d=1-0.8;switch(Math.floor(a)%6){case 0:b=0.8+d;e=c+d;f=d;break;case 1:b=c+d;e=0.8+d;f=d;break;case 2:b=d;e=0.8+d;f=c+d;break;case 3:b=d;e=c+d;f=0.8+d;break;case 4:b=c+d;e=d;f=0.8+d;break;case 5:b=0.8+d,e=d,f=c+d}b=("00"+Math.floor(255*b).toString(16)).slice(-2);
e=("00"+Math.floor(255*e).toString(16)).slice(-2);f=("00"+Math.floor(255*f).toString(16)).slice(-2);return"#"+b+f+e})}var a=function(a){function f(){a.apply(this,arguments)}__extends(f,a);f.prototype.getSelectedColorSwatch=function(){for(var a=this.viewModel.colorSwatches.get(),b=0;b<a.length;b++){var e=a[b];if(this.colorSwatchFieldSet.children[b].querySelector("input[type=radio]").checked)return e}};f.prototype.activated=function(){a.prototype.activated.call(this);this.reset()};f.prototype.attach=
function(b){b.initialize(this.configuration);a.prototype.attach.call(this,b)};f.prototype.added=function(b){b.colorPickerWidget=this;a.prototype.added.call(this,b)};f.prototype.reset=function(){var a=this,e=this.viewModel.configuration;this.viewModel.colorSwatches.clear();var f={hex:"#000000",setName:this.viewModel.swatchSetName},c;c=this.viewModel.originalColor.get()?{hex:this.viewModel.originalColor.get().toHex(),setName:this.viewModel.swatchSetName}:{hex:this.viewModel.defaultColor.get().toHex(),
setName:this.viewModel.swatchSetName};this.colorInput.value=c.hex;f.hex!==c.hex&&this.viewModel.colorSwatches.addItem(c);this.viewModel.colorSwatches.addItem(f);this.viewModel.colorSwatches.addItems(b(e.numberOfColorSwatches).map(function(b){return{hex:b,setName:a.viewModel.swatchSetName}}));this.viewModel.colorSwatches.get().forEach(function(b,e){a.colorSwatchFieldSet.children[e].style.backgroundColor=b.hex});this.colorSwatchFieldSet.querySelector(".color-swatch:first-child > input[type=radio]").checked=
!0;this.handleChange()};f.prototype.handleChange=function(){var a=this.viewModel.useColorSwatches.get()?esri.Color.fromHex(this.getSelectedColorSwatch().hex):esri.Color.fromHex(this.colorInput.value);this.viewModel.selectedColor.set(a)};return f}(d.framework.ui.ViewBase);c.ColorPickerView=a})(g.ColorPicker||(g.ColorPicker={}))})(g.components||(g.components={}))})(h.ui||(h.ui={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer=
{}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){(function(g){(function(c){function b(){var a=document.createElement("input");a.setAttribute("type","color");return"text"!==a.type}var a=function(a){function f(b,f,c){a.call(this,b,f);this.useColorSwatches=new Observable(!0);this.colorSwatches=new ObservableCollection;this.selectedColor=new Observable;this.defaultColor=new Observable;this.originalColor=new Observable;this.swatchSetName=c}__extends(f,a);f.prototype.initialize=function(a){void 0===
a&&(a={});this.configuration=a;a.alwaysUseColorSwatches=void 0!=a.alwaysUseColorSwatches?a.alwaysUseColorSwatches:!1;a.numberOfColorSwatches=a.numberOfColorSwatches?6:a.numberOfColorSwatches;this.useColorSwatches.set(a.alwaysUseColorSwatches||!b())};return f}(d.framework.ui.ViewModelBase);c.ColorPickerViewModel=a})(g.ColorPicker||(g.ColorPicker={}))})(g.components||(g.components={}))})(h.ui||(h.ui={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||
(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){(function(g){(function(c){var b=function(a){function b(){a.apply(this,arguments);this.libraryId="Mapping.Infrastructure"}__extends(b,a);b.prototype.attach=function(a){this.viewModel=a};b.prototype.handlePageFirst=function(a,b,e){1<this.viewModel.collectionViewModel.presentableResults.currPageNumber.get()&&this.viewModel.collectionViewModel.presentableResults.currPageNumber.set(1)};b.prototype.handlePagePrev=function(a,b,e){1<this.viewModel.collectionViewModel.presentableResults.currPageNumber.get()&&
(a=this.viewModel.collectionViewModel.presentableResults.currPageNumber.get()-1,this.viewModel.collectionViewModel.presentableResults.currPageNumber.set(a))};b.prototype.handlePageNext=function(a,b,e){this.viewModel.collectionViewModel.presentableResults.lastPageNumber.get()>this.viewModel.collectionViewModel.presentableResults.currPageNumber.get()&&(a=this.viewModel.collectionViewModel.presentableResults.currPageNumber.get()+1,this.viewModel.collectionViewModel.presentableResults.currPageNumber.set(a))};
b.prototype.handlePageLast=function(a,b,e){this.viewModel.collectionViewModel.presentableResults.currPageNumber.get()<this.viewModel.collectionViewModel.presentableResults.lastPageNumber.get()&&(a=this.viewModel.collectionViewModel.presentableResults.lastPageNumber.get(),this.viewModel.collectionViewModel.presentableResults.currPageNumber.set(a))};return b}(d.framework.ui.ViewBase);c.PagingControlsView=b})(g.PagingControls||(g.PagingControls={}))})(g.components||(g.components={}))})(h.ui||(h.ui={}))})(k.infrastructure||
(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){(function(g){(function(c){var b=function(a){function b(e,c){a.call(this,e,"Mapping.Infrastructure");this.libraryId="Mapping.Infrastructure";this.collectionViewModel=c;this.presentableResults=this.collectionViewModel.presentableResults;this.numberOfItems=this.presentableResults.items.length()}__extends(b,a);return b}(d.framework.ui.ViewModelBase);c.PagingControlsViewModel=b})(g.PagingControls||(g.PagingControls={}))})(g.components||(g.components=
{}))})(h.ui||(h.ui={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){(function(g){(function(c){var b=function(a){function b(){a.apply(this,arguments);this.sliderMaxLabelElement=this.sliderMinLabelElement=this.sliderElement=null;this._sliderCurrentRawValues=[];this._sliderCurrentHandlePos=[];this._isEnabledBindingToken=this._maxHandleBindingToken=this._minHandleBindingToken=this._widgetHostElement=null;this._maxHandleLocked=this._minHnadleLocked=this._isAdded=!1;this._minHandleTag="gcx_timeslider_handle0";
this._maxHandleTag="gcx_timeslider_handle1";this._currPosForComputedDirection=[]}__extends(b,a);b.prototype.attach=function(b){b&&(a.prototype.attach.call(this,b),this._isAdded&&this._initializeIfEnabled(this.viewModel.isEnabled.get()))};b.prototype.added=function(b){a.prototype.added.call(this,b);this._isAdded=!0;this._widgetHostElement=b;this._cleanUp(!0);this._isEnabledBindingToken=this.viewModel.isEnabled.bind(this,this._initializeIfEnabled);this._initializeIfEnabled(this.viewModel.isEnabled.get())};
b.prototype.onDestroy=function(){a.prototype.onDestroy.call(this);this._cleanUp(!0)};b.prototype.refreshLabelPositions=function(){this._updateLabelPosition(0);this._updateLabelPosition(1)};b.prototype._setupViewModelBindings=function(){var a=this;this._minHandleBindingToken=this.viewModel.sliderMinHandleCurrentItem.bind(this,function(b){return a._setSliderValueAndUpdateLabels(0,a.viewModel.getRawSliderValueForItem(b))});this.viewModel.range&&(this._maxHandleBindingToken=this.viewModel.sliderMaxHandleCurrentItem.bind(this,
function(b){return a._setSliderValueAndUpdateLabels(1,a.viewModel.getRawSliderValueForItem(b))}))};b.prototype._generateJQuerySlider=function(){var a=this,b=this.viewModel,e={animate:b.animate,min:b.isNumeric?b.numericSliderMinVal:0,max:b.isNumeric?b.numericSliderMaxVal:b.items.length()-1,step:b.isNumeric?b.isDateMode||b.disableSnappingForNumericValues?1:b.numericSliderStep:1,orientation:"horizontal",range:b.range,slide:function(b,e){return a._handleSliderRawValueSlide(b,e)},change:function(b,e){return a._handleSliderRawValueChange(b,
e)}};this.viewModel.isDateMode&&(e.slide=function(b,e){return a._dateModeRawValueSlide(b,e)});var c=function(){e.range?e.values=[e.min,e.min+e.step]:e.value=e.min},d=function(){if(e.values[0]===e.values[1]){var a=e.values[0]+e.step,b=e.values[0]-e.step;a<=e.max?e.values[1]=a:e.values[0]=b}};if(b.isNumeric&&b.numericSliderHandleStartValues.length)!e.range||isNaN(b.numericSliderHandleStartValues[0])||isNaN(b.numericSliderHandleStartValues[1])?e.range||isNaN(b.numericSliderHandleStartValues[0])?c():
e.value=b.numericSliderHandleStartValues[0]:(e.values=b.numericSliderHandleStartValues.slice(0,2),b.lockMinSliderHandleAtMinVal&&(e.values[0]=e.min),d());else if(!b.isNumeric&&b.sliderHandleStartLabels.length){var g=b.getSliderItemByItemLabel(b.sliderHandleStartLabels[0]),h=b.getSliderItemByItemLabel(b.sliderHandleStartLabels[1]);e.range&&g&&h?(e.values=[b.items.indexOf(g)-1,b.items.indexOf(h)-1],b.lockMinSliderHandleAtMinVal&&(e.values[0]=e.min),d()):!e.range&&g?e.value=b.items.indexOf(g)-1:c()}else c();
e.range?this._sliderCurrentRawValues=e.values.slice(0):this._sliderCurrentRawValues[0]=e.value;$(this.sliderElement).slider(e);this._wireInKeyboardSupport();var k=this._widgetHostElement?this._widgetHostElement:this;if(k.isActive)this._applyInitViewModelState(e);else var m=this.app.event("ViewActivatedEvent").subscribe(this,function(b){b===k&&(a.app.event("ViewActivatedEvent").unsubscribe(m),m=null,a._applyInitViewModelState(e))})};b.prototype._applyInitViewModelState=function(a){a.range?(this.viewModel.setSelectedSliderItem(0,
this.viewModel.getSliderItemByRawSliderValue(a.values[0])),this.viewModel.setSelectedSliderItem(1,this.viewModel.getSliderItemByRawSliderValue(a.values[1]))):this.viewModel.setSelectedSliderItem(0,this.viewModel.getSliderItemByRawSliderValue(a.value))};b.prototype._handleSliderRawValueChange=function(a,b){var e=this._getSliderHandleIndex(b);this._sliderCurrentRawValues[e]=b.value;this._maxHandleLocked=this._minHnadleLocked=!1;return!0};b.prototype._dateModeRawValueSlide=function(a,b){if(!a||37===
a.which||39===a.which||!a.originalEvent||!$(a.originalEvent.target).hasClass("ui-slider-handle"))return this._handleSliderRawValueSlide(a,b);var e=this._getSliderHandleIndex(b);if(void 0!==this._currPosForComputedDirection[e]&&this._currPosForComputedDirection[e]!==b.value){var c=b.value>this._currPosForComputedDirection[e];if(c&&void 0!==this._sliderCurrentRawValues[e]&&b.value>this._sliderCurrentRawValues[e]||!c&&void 0!==this._sliderCurrentRawValues[e]&&b.value<this._sliderCurrentRawValues[e])return this._currPosForComputedDirection.length=
0,this._handleSliderRawValueSlide(a,b,c)}this._currPosForComputedDirection[e]=b.value;return!1};b.prototype._handleSliderRawValueSlide=function(a,b,e){if(!b||!b.handle||void 0===b.value)return!1;var c=this._getSliderHandleIndex(b);this._currPosForComputedDirection.length=0;this.viewModel.range&&this.viewModel.lockMinSliderHandleAtMinVal&&0===c&&(c=1);if(!this.viewModel.range&&1===c||0===c&&this._minHnadleLocked||1===c&&this._maxHandleLocked)return!1;0===c?this._maxHandleLocked=!0:this._minHnadleLocked=
!0;var d=this.viewModel.getSliderItemByRawSliderValue(b.value),g=this._sliderCurrentRawValues[c];b=void 0===e?void 0===g||b.value>g:e;this.viewModel.isDateMode&&!this.viewModel.disableSnappingForNumericValues&&(d=b?this.viewModel.getClosestDateItemSnappedToInterval(d,"next",37===a.which||39===a.which):this.viewModel.getClosestDateItemSnappedToInterval(d,"prev",37===a.which||39===a.which),this.viewModel.getRawSliderValueForItem(d));d&&!d.active&&(d=b?this.viewModel.getNextActiveSliderItem(d):this.viewModel.getPreviousActiveSliderItem(d),
this.viewModel.getRawSliderValueForItem(d));if(d&&this.viewModel.range&&(a=0===c?this.viewModel.sliderMaxHandleCurrentItem.get():this.viewModel.sliderMinHandleCurrentItem.get(),b=0===c?d.value>a.value:d.value<a.value,a&&(b||d.value===a.value||this.viewModel.isDateMode&&d.label===a.label))){if(this.viewModel.isDateMode){if(this.viewModel.disableSnappingForNumericValues)return!1;d=0===c?this.viewModel.getClosestDateItemSnappedToInterval(d,"prev",!0):this.viewModel.getClosestDateItemSnappedToInterval(d,
"next",!0)}else d=0===c?this.viewModel.getPreviousActiveSliderItem(d):this.viewModel.getNextActiveSliderItem(d);this.viewModel.getRawSliderValueForItem(d)}if(!d)return!1;(a=0===c?this.viewModel.sliderMinHandleCurrentItem.get():this.viewModel.sliderMaxHandleCurrentItem.get())&&d.value===a.value&&(this._maxHandleLocked=this._minHnadleLocked=!1);this.viewModel.setSelectedSliderItem(c,d);return!1};b.prototype._getSliderHandleIndex=function(a){if($(a.handle).hasClass(this._minHandleTag))return 0;if($(a.handle).hasClass(this._maxHandleTag))return 1;
var b=0;this.viewModel.range&&(b=null===a.handle.nextElementSibling||void 0===a.handle.nextElementSibling?1:0);$(a.handle).addClass(0===b?this._minHandleTag:this._maxHandleTag);return b};b.prototype._setSliderValueAndUpdateLabels=function(a,b){null!==b&&(0!==a&&1!==a||isNaN(parseInt(b,10))?this.app.trace.error("SliderViewBase: Could not set slider values and update UI. Required arguments invalid."):(this._setSliderRawValue(a,b),this._updateLabelPosition(a)))};b.prototype._setSliderRawValue=function(a,
b){this.viewModel.range?$(this.sliderElement).slider("values")[a]!==b&&$(this.sliderElement).slider("values",a,b):$(this.sliderElement).slider("value")!==b&&$(this.sliderElement).slider("value",b)};b.prototype._updateSliderHandleAttributes=function(a){var b=0===a?this.viewModel.sliderMinHandleCurrentItem.get():this.viewModel.sliderMaxHandleCurrentItem.get(),e=$(".ui-slider-handle",this.sliderElement).toArray()[a];e&&b&&b.label&&(a=0===a?this.viewModel.range?this.viewModel.sliderMinHandleAriaLabel||
"":this.viewModel.sliderSingleHandleAriaLabel||"":this.viewModel.sliderMaxHandleAriaLabel||"",void 0==$(e).attr("tabindex")&&$(e).attr("tabindex",0),void 0==$(e).attr("role")&&$(e).attr("role","slider"),$(e).attr("aria-label",a||b.label),$(e).attr("aria-valuenow",b.label),$(e).attr("aria-valuetext",b.label),$(e).attr("title",b.label))};b.prototype._updateLabelPosition=function(a){var b=this;this._updateLabelPositionImpl(a);setTimeout(function(){return b._updateLabelPositionImpl(a)},this.viewModel.animate?
400:100)};b.prototype._updateLabelPositionImpl=function(a){if(null!==a&&void 0!==a&&(0===a||1===a)&&(this.viewModel.range||1!==a)){var b=$(".ui-slider-handle",this.sliderElement).toArray();if(0!==b.length){var e=0===a?$(this.sliderMinLabelElement).width()+5:$(this.sliderMaxLabelElement).width(),c=$(this.sliderElement).width(),d=$(b[a]).width(),b=$(b[a]).position().left+$(this.sliderElement).position().left+0.5*d-0.5*e,b=Math.max($(this.sliderElement).position().left-0.5*d,b),b=Math.min(c+$(this.sliderElement).position().left+
0.5*d-e,b),g=this._sliderCurrentHandlePos[(a+1)%2],h=(0===a?$(this.sliderMaxLabelElement).width()+5:$(this.sliderMinLabelElement).width())+5,h=h<0.5*e?e:h,g=isNaN(g)&&this.viewModel.range?c+$(this.sliderElement).position().left+0.5*d-h:g;isNaN(g)||(0===a?(b=g>=e?Math.min(g-e,b):b,b=Math.min(c+$(this.sliderElement).position().left+0.5*d-(h+e-5),b)):1===a&&(b=Math.max(g+h+0.5*d,b)));this._sliderCurrentHandlePos[a]=b;0===a?this.sliderMinLabelElement.style.left=b+"px":this.sliderMaxLabelElement.style.left=
b+"px";this._updateSliderHandleAttributes(a)}}};b.prototype._processInitRoutine=function(){this._cleanUp();this._setupViewModelBindings();this._generateJQuerySlider()};b.prototype._initializeIfEnabled=function(a){a&&this._processInitRoutine()};b.prototype._cleanUp=function(a){void 0===a&&(a=!1);this.sliderElement&&$(this.sliderElement).hasClass("ui-slider")&&$(this.sliderElement).slider("destroy");this.viewModel&&(this._isEnabledBindingToken&&a&&(this.viewModel.isEnabled.unbind(this._isEnabledBindingToken),
this._isEnabledBindingToken=null),this._minHandleBindingToken&&this.viewModel.sliderMinHandleCurrentItem.unbind(this._minHandleBindingToken),this._maxHandleBindingToken&&this.viewModel.sliderMaxHandleCurrentItem.unbind(this._maxHandleBindingToken));this._sliderCurrentHandlePos=[];this._sliderCurrentRawValues=[];this._currPosForComputedDirection=[];this._maxHandleBindingToken=this._minHandleBindingToken=null};b.prototype._wireInKeyboardSupport=function(){var a=this,b=$(".ui-slider-handle",this.sliderElement).toArray();
if(0!==b.length){var e=function(e,c,d){a._handleSliderRawValueSlide({which:d},{handle:b[c],value:"prev"===e?a._sliderCurrentRawValues[c]-1:a._sliderCurrentRawValues[c]+1})};b.forEach(function(b,c){$(b).unbind("keydown");$(b).keydown(function(b){var d=!1;switch(b.which){case 38:case 39:case 33:e("next",c,39);break;case 37:case 40:case 34:e("prev",c,37);break;default:d=!0}a.refreshLabelPositions();d||(b.preventDefault(),b.stopPropagation())})})}};return b}(d.framework.ui.ViewBase);c.SliderViewBase=
b})(g.Slider||(g.Slider={}))})(g.components||(g.components={}))})(h.ui||(h.ui={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){(function(g){(function(c){var b=function(a){function b(e,c,d){a.call(this,e,c);this.items=new ObservableCollection([]);this.sliderMinLabel=new Observable("");this.sliderMaxLabel=new Observable("");this.sliderMinHandleLabel=new Observable("");this.sliderMaxHandleLabel=new Observable("");this.sliderMinHandleCurrentItem=new Observable(null);this.sliderMaxHandleCurrentItem=new Observable(null);this.range=!1;this.disableSnappingForNumericValues=
!0;this.animate=this.lockMinSliderHandleAtMinVal=!1;this.itemActivePredicate=this.labelGenerator=this.numericSliderMaxVal=this.numericSliderMinVal=this.numericSliderStep=this.isDateMode=this.isNumeric=null;this.sliderHandleStartLabels=[];this.numericSliderHandleStartValues=[];this.sliderTicks=new ObservableCollection;this.isEnabled=new Observable(!1);this._config=this._underlyingCollectionBindingToken=this._underlyingCollection=this.sliderSingleHandleAriaLabel=this.sliderMaxHandleAriaLabel=this.sliderMinHandleAriaLabel=
null;this._defaultNumericLabelGenerator=function(a,b){return a+""};this._defaultItemActivePredicate=function(a,b){return!0};this._numericSliderItemCache={};this._maxSliderTicks=50;this._defaultSliderDivisions=5;this._snappableDatePoints=[];this.itemActivePredicate=this._defaultItemActivePredicate;d&&this.initialize(d)}__extends(b,a);b.prototype.initialize=function(a){this._applyConfig(a)};b.prototype.sliderHandleSlide=function(a,b){};b.prototype.setNextSliderItem=function(a){return this._setNextOrPreviousSliderItem(a,
"next")};b.prototype.setPreviousSliderItem=function(a){return this._setNextOrPreviousSliderItem(a,"previous")};b.prototype.setSelectedSliderItem=function(a,b){if(0!==a&&1!==a||!b)throw Error("SliderViewModelBase: Could not set selected slider item.");var e=0===a?this.sliderMinHandleCurrentItem.get():this.sliderMaxHandleCurrentItem.get();e&&e.value===b.value||(0===a?(this.sliderMinHandleLabel.set(b.label),this.sliderMinHandleCurrentItem.set(b)):(this.sliderMaxHandleLabel.set(b.label),this.sliderMaxHandleCurrentItem.set(b)),
this.sliderHandleSlide(b,a))};b.prototype.attachToCollection=function(a,b,e,c){var d=this;this.cleanUp();this.isNumeric=!1;if(!(a&&a instanceof ObservableCollection))throw Error("SliderViewModelBase: Could not attach to collection.");b&&dojo.isFunction(b)&&(this.labelGenerator=b);c&&c.length&&(this.sliderHandleStartLabels=c.slice(0));this.itemActivePredicate=e&&dojo.isFunction(e)?e:this._defaultItemActivePredicate;this._underlyingCollection=a;this.items.set(this._underlyingCollection.get().map(function(a,
b){return d._createSliderItem(a,b)}));this._underlyingCollectionBindingToken=this._underlyingCollection.bind(this,this._handleUnderlyingCollectionChanges);this._initializeUIObservables()};b.prototype.setupNumericSlider=function(a,b,e,c,d,g){this.cleanUp();this.isNumeric=!0;a=parseFloat(a);b=parseFloat(b);e=parseFloat(e);if(isNaN(a)||isNaN(b))throw Error("SliderViewModelBase: Could not set numeric slider range. Minimum and/or maximum values invalid.");g&&g.length&&(this.numericSliderHandleStartValues=
g.slice(0));this.numericSliderMinVal=a;this.numericSliderMaxVal=b;this.labelGenerator=c&&dojo.isFunction(c)?c:this._defaultNumericLabelGenerator;this.itemActivePredicate=d&&dojo.isFunction(d)?d:this._defaultItemActivePredicate;this.numericSliderStep=e&&!isNaN(e)&&e<b-a?e:null;null===this.numericSliderStep&&(a=b-a)&&(this.numericSliderStep=1>=a?a/this._defaultSliderDivisions:Math.round(a/this._defaultSliderDivisions),this.isDateMode&&this._resetTimeIntervalBasedOnSliderStep());this._initializeUIObservables()};
b.prototype.setupDateSlider=function(a,b,e,c,d,g,k){this.isDateMode=!0;this.dateModeTimeInterval=e;this.dateModeTimeIntervalUnit=c;this.setupNumericSlider(a,b,h.TimeSliderUtils.computeTimeIntervalInMs(e,c),d,g,k);this.disableSnappingForNumericValues||this._generateDateModeSnappablePoints()};b.prototype.getSliderItemByRawSliderValue=function(a,b){void 0===b&&(b=!1);if(void 0===a||null===a)return null;var e=null,c=this.isNumeric?a-this.numericSliderMinVal:a;this.isNumeric?(b&&(a=a>this.numericSliderMaxVal?
this.numericSliderMaxVal:a,a=a<this.numericSliderMinVal?this.numericSliderMinVal:a),a>=this.numericSliderMinVal&&a<=this.numericSliderMaxVal&&(e=this._getUpdatedNumericItemAndUpdateCache(a,c))):-1<c&&c<this.items.length()&&(e=this.items.getAt(c),this._updateSliderItem(e,c));return e};b.prototype.getSliderItemByItemLabel=function(a){if(!a)return null;var b=null;if(this.isNumeric){if(this.labelGenerator)for(var e=this.numericSliderMinVal,c=0;e<=this.numericSliderMaxVal;e+=this.numericSliderStep,c++)if(this.labelGenerator(e,
c)===a){b=this._getUpdatedNumericItemAndUpdateCache(e,c);break}}else for(e=0,c=this.items.length();e<c;e++){var d=this.items.getAt(e);this._updateSliderItem(d,e);if(d.label===a){b=d;break}}return b};b.prototype.getSliderItemByItemValue=function(a){var b=this;if(void 0===a||null===a||this.isNumeric&&"number"!==typeof a)return null;var e=null;e=this.isNumeric?this._getUpdatedNumericItemAndUpdateCache(a,a-this.numericSliderMinVal):(e=this.items.get().filter(function(e,c){if(e.value!==a)return!1;b._updateSliderItem(e,
c);return!0})[0])||null;return e};b.prototype.getNextSliderItem=function(a){return this._getAdjacentSliderItem(a,"next")};b.prototype.getNextActiveSliderItem=function(a){return this._getAdjacentSliderItem(a,"next","active")};b.prototype.getNextInactiveSliderItem=function(a){return this._getAdjacentSliderItem(a,"next","inactive")};b.prototype.getPreviousSliderItem=function(a){return this._getAdjacentSliderItem(a,"prev")};b.prototype.getPreviousActiveSliderItem=function(a){return this._getAdjacentSliderItem(a,
"prev","active")};b.prototype.getPreviousInactiveSliderItem=function(a){return this._getAdjacentSliderItem(a,"prev","inactive")};b.prototype.getClosestDateItemSnappedToInterval=function(a,b,e){void 0===b&&(b="next");void 0===e&&(e=!1);a=this.getRawSliderValueForItem(a);a=this._getClosestDateItemRawValueSnappedToInterval(a,b,e);return null===a?null:this.getSliderItemByRawSliderValue(a,!0)};b.prototype.getRawSliderValueForItem=function(a){var b=null;a&&(this.isNumeric?(a=a.value,a>=this.numericSliderMinVal&&
a<=this.numericSliderMaxVal&&(b=a)):(a=this.items.get().map(function(a){return a.value}).indexOf(a.value),-1<a&&a<this.items.length()&&(b=a)));return b};b.prototype.cleanUp=function(){this.isEnabled.set(!1);this.labelGenerator=null;this.items.clear();this.isNumeric=null;this.sliderMaxHandleCurrentItem.set(null);this.sliderMinHandleCurrentItem.set(null);this.sliderMinHandleLabel.set("");this.sliderMaxHandleLabel.set("");this.sliderMaxLabel.set("");this.sliderMinLabel.set("");this.numericSliderMaxVal=
this.numericSliderMinVal=this.numericSliderStep=null;this._numericSliderItemCache={};this.numericSliderHandleStartValues.length=0;this.sliderHandleStartLabels.length=0;this._snappableDatePoints.length=0;this.itemActivePredicate=this._defaultItemActivePredicate;this.sliderTicks.clear();this._underlyingCollection&&(this._underlyingCollectionBindingToken&&(this._underlyingCollection.unbind(this._underlyingCollectionBindingToken),this._underlyingCollectionBindingToken=null),this._underlyingCollection=
null)};b.prototype._setNextOrPreviousSliderItem=function(a,b){if(0!==a&&1!==a)return this.app.trace.error("SliderViewModelBase: Could not set "+b+" slider item. Invalid handle index.Handle index must be 0 or 1."),!1;var e=0===a?this.sliderMinHandleCurrentItem.get():this.sliderMaxHandleCurrentItem.get(),c=0===a?this.sliderMaxHandleCurrentItem.get():this.sliderMinHandleCurrentItem.get();if(!e)return this.app.trace.error("SliderViewModelBase: Could not set "+b+" slider item. Please set current item first."),
!1;var d="next"===b?this.getNextActiveSliderItem(e):this.getPreviousActiveSliderItem(e);if(d&&(!c||c&&c.value!==d.value)&&d.value!==e.value){if(c&&0===a&&"next"===b&&d.value>=c.value||c&&1===a&&"next"!==b&&d.value<=c.value||this.range&&this.lockMinSliderHandleAtMinVal&&0===a)return!1;this.setSelectedSliderItem(a,d);return!0}return!1};b.prototype._initializeUIObservables=function(){this._setupSliderTicks();this._setupSliderMinMaxLabels();this.isEnabled.set(!0)};b.prototype._setupSliderTicks=function(){this.sliderTicks.clear();
for(var a=this.isNumeric?(this.numericSliderMaxVal-this.numericSliderMinVal)/this.numericSliderStep:this.items.length(),a=a>this._maxSliderTicks?this._maxSliderTicks:a,b=100/a,e=0,c=0;c<a;c++)100>=e&&(this.sliderTicks.addItem({position:e+"%"}),e+=b)};b.prototype._setupSliderMinMaxLabels=function(){var a=this.isNumeric?this.getSliderItemByItemValue(this.numericSliderMinVal):this.items.getAt(0),b=this.isNumeric?this.getSliderItemByItemValue(this.numericSliderMaxVal):this.items.getAt(this.items.length()-
1);this.sliderMinLabel.set(a?a.label:"");this.sliderMaxLabel.set(b?b.label:"")};b.prototype._getAdjacentSliderItem=function(a,b,e){void 0===b&&(b="next");void 0===e&&(e="any");a=this.getRawSliderValueForItem(a);if(null===a)return null;var c=null,d=null;do if(a=this.isNumeric?this._getAdjacentNumericItemRawValue(a,b):"prev"===b?a-1:a+1,d=this.getSliderItemByRawSliderValue(a,this.isNumeric))switch(e){case "active":c=d.active?d:null;break;case "inactive":c=d.active?null:d;break;default:c=d}while(d&&
!c);return c};b.prototype._getAdjacentNumericItemRawValue=function(a,b,e){var c=this;void 0===b&&(b="next");void 0===e&&(e=!1);var g=null,h=function(a){a&&!isNaN(a)&&e&&(a=a>c.numericSliderMaxVal?c.numericSliderMaxVal:a,a=a<c.numericSliderMinVal?c.numericSliderMinVal:a);return a};if(!this.isDateMode||!this.dateModeTimeInterval||!this.dateModeTimeIntervalUnit)return h("prev"===b?a-c.numericSliderStep:a+c.numericSliderStep);var k=function(a){return"next"===b?a:-1*a};switch(this.dateModeTimeIntervalUnit){case d.essentials.TimeUnits.UNIT_MILLISECONDS:return a+
k(this.dateModeTimeInterval);case d.essentials.TimeUnits.UNIT_SECONDS:return a+k(1E3*this.dateModeTimeInterval);case d.essentials.TimeUnits.UNIT_MINUTES:return a+k(6E4*this.dateModeTimeInterval);case d.essentials.TimeUnits.UNIT_HOURS:return a+k(36E5*this.dateModeTimeInterval);case d.essentials.TimeUnits.UNIT_DAYS:return a+k(864E5*this.dateModeTimeInterval);case d.essentials.TimeUnits.UNIT_WEEKS:return a+k(6048E5*this.dateModeTimeInterval);case d.essentials.TimeUnits.UNIT_MONTHS:g=new Date(a);g.setUTCMonth(g.getUTCMonth()+
k(this.dateModeTimeInterval));break;case d.essentials.TimeUnits.UNIT_YEARS:g=new Date(a);g.setUTCFullYear(g.getUTCFullYear()+k(this.dateModeTimeInterval));break;case d.essentials.TimeUnits.UNIT_DECADES:g=new Date(a);g.setUTCFullYear(g.getUTCFullYear()+k(10*this.dateModeTimeInterval));break;case d.essentials.TimeUnits.UNIT_CENTURIES:g=new Date(a),g.setUTCFullYear(g.getUTCFullYear()+k(100*this.dateModeTimeInterval))}a=g&&!isNaN(g.getTime())?g.getTime():"prev"===b?a-c.numericSliderStep:a+c.numericSliderStep;
return h(a)};b.prototype._resetTimeIntervalBasedOnSliderStep=function(){if(this.dateModeTimeInterval&&this.dateModeTimeIntervalUnit&&this.numericSliderStep&&!(isNaN(this.numericSliderStep)||0>=this.numericSliderStep)){var a=new Date(this.numericSliderStep);if(!isNaN(a.getTime()))for(var a=[a.getUTCFullYear()-1970,a.getUTCMonth(),a.getUTCDate()-1,a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds()],b=[d.essentials.TimeUnits.UNIT_YEARS,d.essentials.TimeUnits.UNIT_MONTHS,d.essentials.TimeUnits.UNIT_DAYS,
d.essentials.TimeUnits.UNIT_HOURS,d.essentials.TimeUnits.UNIT_MINUTES,d.essentials.TimeUnits.UNIT_SECONDS,d.essentials.TimeUnits.UNIT_MILLISECONDS],e=0;e<a.length;e++)if(0<a[e]){this.dateModeTimeIntervalUnit=b[e];this.dateModeTimeInterval=a[e];this.numericSliderStep=h.TimeSliderUtils.computeTimeIntervalInMs(this.dateModeTimeInterval,this.dateModeTimeIntervalUnit);break}}};b.prototype._getClosestDateItemRawValueSnappedToInterval=function(a,b,e){void 0===b&&(b="next");void 0===e&&(e=!1);if(!this._snappableDatePoints.length)return e?
this._getAdjacentNumericItemRawValue(a,b):a;for(var c=0,d=this._snappableDatePoints.length-1,g,h,k;c<=d;){g=Math.floor((c+d)/2);h=this._snappableDatePoints[g];if(h===a)return e?this._getAdjacentNumericItemRawValue(a,b):a;if("next"===b?a>h&&a<this._snappableDatePoints[g+1]:a<h&&a>this._snappableDatePoints[g-1]){k=h;break}h<a?c=g+1:h>a&&(d=g-1)}return k?this._getAdjacentNumericItemRawValue(k,b):null};b.prototype._generateDateModeSnappablePoints=function(){if(this.isDateMode&&this.dateModeTimeInterval&&
this.dateModeTimeIntervalUnit&&this.numericSliderMinVal&&this.numericSliderMaxVal){this._snappableDatePoints.length=0;var a=this.numericSliderMinVal;if(this.dateModeTimeIntervalUnit===d.essentials.TimeUnits.UNIT_WEEKS||this.dateModeTimeIntervalUnit===d.essentials.TimeUnits.UNIT_MONTHS||this.dateModeTimeIntervalUnit===d.essentials.TimeUnits.UNIT_YEARS||this.dateModeTimeIntervalUnit===d.essentials.TimeUnits.UNIT_DECADES||this.dateModeTimeIntervalUnit===d.essentials.TimeUnits.UNIT_CENTURIES){this._snappableDatePoints.push(a);
do a=this._getAdjacentNumericItemRawValue(a,"next"),this._snappableDatePoints.push(a);while(a<this.numericSliderMaxVal);this._snappableDatePoints.push(this.numericSliderMaxVal)}}};b.prototype._applyConfig=function(a){this._config=a||{};this.range=void 0===this._config.range?!1:!!this._config.range;this.animate=void 0===this._config.animate?!1:!!this._config.animate;this.disableSnappingForNumericValues=void 0===this._config.disableSnappingForNumericValues?!0:!!this._config.disableSnappingForNumericValues;
this.lockMinSliderHandleAtMinVal=void 0===this._config.lockMinSliderHandleAtMinVal?!1:!!this._config.lockMinSliderHandleAtMinVal;this.sliderMinHandleAriaLabel=a.sliderMinHandleAriaLabel||null;this.sliderMaxHandleAriaLabel=a.sliderMaxHandleAriaLabel||null;this.sliderSingleHandleAriaLabel=a.sliderSingleHandleAriaLabel||null};b.prototype._handleUnderlyingCollectionChanges=function(a){var b=this,e;switch(a.type){case "clear":this.items.clear();break;case "insert":e=a.sender.getRange(a.rangeStart,a.rangeEnd);
this.items.insertItems(a.rangeStart,e.map(function(e,c){return b._createSliderItem(e,a.rangeStart+c)}));break;case "append":e=a.sender.getRange(a.rangeStart,a.rangeEnd);this.items.addItems(e.map(function(e,c){return b._createSliderItem(e,a.rangeStart+c)}));break;case "remove":this.items.removeRange(a.rangeStart,a.rangeEnd)}this._initializeUIObservables()};b.prototype._createSliderItem=function(a,b){return{value:a,label:this._getItemLabel(a,b),active:this.itemActivePredicate(a,b)}};b.prototype._getItemLabel=
function(a,b){var e="";this.labelGenerator&&(e=this.labelGenerator(a,b),e=null===e||void 0===e?"":e+"");return e};b.prototype._updateSliderItem=function(a,b){a.label=this._getItemLabel(a.value,b);a.active=this.itemActivePredicate(a.value,b);return a};b.prototype._getUpdatedNumericItemAndUpdateCache=function(a,b){if(null===a||void 0===a||null===b||void 0===b)return null;var e=this._numericSliderItemCache[a+""];e?this._updateSliderItem(e,b):e=this._createSliderItem(a,b);return this._numericSliderItemCache[a+
""]=e};return b}(d.framework.ui.ViewModelBase);c.SliderViewModelBase=b})(g.Slider||(g.Slider={}))})(g.components||(g.components={}))})(h.ui||(h.ui={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){d=d.essentialsHtmlViewer||(d.essentialsHtmlViewer={});d=d.mapping||(d.mapping={});d=d.infrastructure||(d.infrastructure={});d=d.ui||(d.ui={});d=d.components||(d.components={});d=d.Table||(d.Table={});d=d.SortState||(d.SortState={});d[d.UNSORTED=0]="UNSORTED";d[d.ASCENDING=1]="ASCENDING";d[d.DESCENDING=2]="DESCENDING"})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){(function(g){(function(c){var b=function(a){function b(e,c){a.call(this,e,c)}__extends(b,a);b.prototype.attach=function(b){var e=this;a.prototype.attach.call(this,b);this._viewContainerActivatedEventToken||(this._viewContainerActivatedEventToken=this.app.event("ViewContainerActivatedEvent").subscribe(this,function(a){null==e.parentContainer&&e._isViewHostedInContainer(a)&&(e.parentContainer=a)}))};b.prototype._isViewHostedInContainer=
function(a){if(a instanceof d.framework.ui.ViewContainer.ViewContainerView){a=a.viewModel.regionName.get();var b=this.app.viewManager.getRegionForViewId(this.id);if(b&&b.name===a)return!0}return!1};b.prototype.finishWizard=function(){this.parentContainer&&this.parentContainer.finish()};b.prototype.cancelWizard=function(){this.parentContainer&&this.parentContainer.cancel()};b.prototype.destroy=function(){a.prototype.destroy.call(this);this._viewContainerActivatedEventToken&&(this.app.event("ViewContainerActivatedEvent").unsubscribe(this._viewContainerActivatedEventToken),
this._viewContainerActivatedEventToken=null);this.parentContainer&&(this.parentContainer=null)};b.prototype._validator=function(){return[]};b.prototype.validate=function(a){this.validationProblems=this._validator();return 1>this.validationProblems.length};b.prototype.reset=function(){this.viewModel.reset()};b.prototype.loadState=function(){};b.prototype.saveState=function(){for(var a=0;a<arguments.length;a++);};b.prototype.goNext=function(){for(var a=0;a<arguments.length;a++);throw Error("This method is abstract");
};b.prototype.goBack=function(){for(var a=0;a<arguments.length;a++);throw Error("This method is abstract");};return b}(d.framework.ui.ViewBase);c.WizardFragmentView=b})(g.WizardPanel||(g.WizardPanel={}))})(g.components||(g.components={}))})(h.ui||(h.ui={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){(function(g){(function(c){var b=function(a){function b(){a.apply(this,arguments);this.resizeX=this.resizeY=!1;this._menuViews={};this._menuItemInvokedSubscriptionToken=null}__extends(b,a);b.prototype.attach=function(b){var e=this;a.prototype.attach.call(this,b);if(this.configuration.resizableParentRegion)if(this.app.site&&this.app.site.isInitialized)b=this.app.viewManager.getExistingRegionByName(this.configuration.resizableParentRegion),
this.resizableRegion=b.domElement;else this.app.event("SiteInitializedEvent").once(this,function(){var a=e.app.viewManager.getExistingRegionByName(e.configuration.resizableParentRegion);e.resizableRegion=a.domElement});else if(this.app.site&&this.app.site.isInitialized)b=this.app.viewManager.getExistingRegionByName(this.regionName),this.resizableRegion=b.domElement;else this.app.event("SiteInitializedEvent").once(this,function(){var a=e.app.viewManager.getExistingRegionByName(e.regionName);e.resizableRegion=
a.domElement});this.viewModel.resizeX?this.resizeX=this.viewModel.resizeX:this.configuration.resizeX&&(this.resizeX=this.configuration.resizeX);this.viewModel.resizeY?this.resizeY=this.viewModel.resizeY:this.configuration.resizeY&&(this.resizeY=this.configuration.resizeY);$(this.app.getHostElement()).on("onclick.handle-resize-error",function(a){$(e.app.getHostElement()).off("mousemove.header-resize touchmove.header-resize");null!=e.resizePreviewElement.parentNode&&e.resizableRegion.parentNode.removeChild(e.resizePreviewElement)});
this.viewModel.panelMaximized.bind(this,function(a){a?$(e.resizableRegion).attr("data-maximized","true"):$(e.resizableRegion).attr("data-maximized","false")});this.viewModel.statusRegion?($(this.statusRegionElement).attr("data-region-name",this.viewModel.statusRegion),$(this.statusRegionElement).attr("data-region-adapter",this.viewModel.statusRegionType)):this.statusRegionElement&&this.statusRegionElement.parentNode&&(this.statusRegionElement.parentNode.removeChild(this.statusRegionElement),this.statusRegionElement=
null);this._initializeEvents();this.app.command("MaximizePanel").register(this,function(a){return e._togglePanelMaximized(a,"maximize")},this._canExecuteMaximizeRestoreOperations);this.app.command("RestorePanel").register(this,function(a){return e._togglePanelMaximized(a,"restore")},this._canExecuteMaximizeRestoreOperations)};b.prototype._initializeEvents=function(){var a=this,b=this.app.event("PanelRegionRestoredEvent").subscribe(this,function(b){b===a.resizableRegion&&a.viewModel.panelMaximized.set(!1)}),
e=this.app.event("PanelRegionMaximizedEvent").subscribe(this,function(b){b===a.resizableRegion&&a.viewModel.panelMaximized.set(!0)});this.trackSubscription(this.app.event("PanelRegionRestoredEvent"),b);this.trackSubscription(this.app.event("PanelRegionMaximizedEvent"),e);this.viewModel.statusRegion&&(b=this.app.event("RegionActivatedEvent").subscribe(this,this._handleRegionActivatedOrDeactivated),e=this.app.event("RegionDeactivatedEvent").subscribe(this,this._handleRegionActivatedOrDeactivated),this.trackSubscription(this.app.event("RegionActivatedEvent"),
b),this.trackSubscription(this.app.event("RegionDeactivatedEvent"),e))};b.prototype._handleRegionActivatedOrDeactivated=function(a){var b=this.viewModel?this.viewModel.statusRegion:null;a&&a.name===b&&this.delayedResize()};b.prototype._togglePanelMaximized=function(a,b){a===this.id&&"maximize"===b&&this.maximizePanel();a===this.id&&"restore"===b&&this.minimizePanel()};b.prototype._canExecuteMaximizeRestoreOperations=function(){return this.viewModel.showingMaximizeButton.get()?!0:!1};b.prototype._handleViewActivatedInContainerEvent=
function(f){a.prototype._handleViewActivatedInContainerEvent.call(this,f);if(this.viewModel&&this.viewModel.getDescriptorForActiveView(f))if(!0===f instanceof b)f.setParentPanel(this),(f=f.viewModel.currentView)&&f.viewModel&&f.isActive&&this.hoistMenuForView(f);else{for(var c=this._parentPanel,d;c;)c.viewModel.headerIsVisible.get()&&(d=c),c=c._parentPanel;d?d.hoistMenuForView(f):this.hoistMenuForView(f)}};b.prototype.activated=function(){a.prototype.activated.call(this)};b.prototype.deactivated=
function(){a.prototype.deactivated.call(this)};b.prototype.destroy=function(){a.prototype.destroy.call(this);this._unsubscribeMenuItemInvokedSubscription();for(var b in this._menuViews)this._menuViews.hasOwnProperty(b)&&this.app.viewManager.destroyView(this._menuViews[b]);this._parentPanel=this._menuViews=null};b.prototype.openHoistedMenuInRegion=function(a){this._destroyHoistedMenuOwnerViewIfExists();this.hoistedMenuOwnerView=this.createMenuView(this.viewModel.hoistedMenuViewModel.get());this.hoistedMenuOwnerView.regionName=
a;this.app.viewManager.activateView(this.hoistedMenuOwnerView)};b.prototype.resolveWidget=function(a,b,e){if("SmartPanelHoistedMenu"===a){if(!this.hoistedMenuId)return;this._destroyHoistedMenuOwnerViewIfExists();this.hoistedMenuOwnerView=this.createMenuView(b);return this.viewModel.menuRegion?null:this.hoistedMenuOwnerView}return null};b.prototype.createMenuView=function(a){var b=this,e=this.app.viewManager.createView({markupResource:"Mapping/infrastructure/menus/MenuView.html",typeName:"geocortex.essentialsHtmlViewer.mapping.infrastructure.menus.MenuView",
libraryId:"Mapping.Infrastructure"});e.libraryId=this.libraryId;e.configuration.menuId=this.hoistedMenuId;a&&(e.attach(a),this.auto(a.hasExecutableMenuItems,this,function(a){a||b.viewModel.menuRegion||b.viewModel.inlineMenuIsOpen.set(!1)}));this._menuViews[e.id]=e;this._unsubscribeMenuItemInvokedSubscription();this._menuItemInvokedSubscriptionToken=this.app.event("MenuItemInvokedEvent").subscribe(this,function(a){a.menuView.id in b._menuViews&&(b.viewModel.menuRegion||b.viewModel.inlineMenuIsOpen.set(!1),
b.app.viewManager.deactivateView(a.menuView))});var c=this.app.event("ViewDeactivatedEvent").subscribe(this,function(a){a===e&&(b.app.event("ViewDeactivatedEvent").unsubscribe(c),a.viewModel=null,b.app.viewManager.destroyView(a),delete b._menuViews[e.id])});a.menuContext.pulse();return e};b.prototype.handleTapMenuButton=function(){var a=this;if(this.viewModel.menuRegion)if(this.hoistedMenuOwnerView&&this.hoistedMenuOwnerView.regionName===this.viewModel.menuRegion&&this.hoistedMenuOwnerView.isActive){var b=
this.hoistedMenuOwnerView.viewModel&&this.hoistedMenuOwnerView.viewModel.menuSourceView;this._destroyHoistedMenuOwnerViewIfExists();b&&this.app.viewManager.activateView(b)}else this.openHoistedMenuInRegion(this.viewModel.menuRegion);else this.viewModel.inlineMenuIsOpen.set(!this.viewModel.inlineMenuIsOpen.get()),this.viewModel.inlineMenuIsOpen.get()&&(this.app.event("FlyoutActivated").publish(this),b={view:this.hoistedMenuOwnerView,onOtherInteracted:function(b){a.viewModel.inlineMenuIsOpen.set(!1);
a.app.event("FlyoutDeactivated").publish(a)}},this.app.command("TapToDismiss").execute(b))};b.prototype.hoistMenuForView=function(a){var l=this;if(a!==this.hoistedMenuOwnerView){var g=this.app.menuRegistry.getMenuWidgetsForView(a);g&&(g=g.filter(function(a){return a.hoistMenu}));if(g&&g.length){var h=g[0],g=new d.essentialsHtmlViewer.mapping.infrastructure.menus.MenuViewModel(this.app,this.libraryId);g.menuSourceView=a;h.context&&h.context.isObservable?g.menuContext.sync(h.context):g.menuContext.sync(h.widgetViewModel.menuContext);
this.hoistedMenuId=h.menuId;this.viewModel.hoistedMenuViewModel.set(g);this.viewModel.hasHoistedMenu.set(!0);this.viewModel.hasExecutableMenuItems.sync(g.hasExecutableMenuItems);$(h.domElement).addClass(b.HoistedClassName);var k=this.app.event("ViewUnhostedEvent").subscribe(this,function(b){b.view===a&&(l.app.event("ViewUnhostedEvent").unsubscribe(k),$(h.domElement).removeClass("hidden-hoisted-menu"))})}else this.viewModel.inlineMenuIsOpen.get()&&this.viewModel.inlineMenuIsOpen.set(!1),this.viewModel.hasHoistedMenu.set(!1),
this.viewModel.hoistedMenuViewModel.set(c.SmartPanelViewModel.emptyMenuViewModel),this.viewModel.hasExecutableMenuItems.removeSync(),this.viewModel.hasExecutableMenuItems.set(!1)}};b.prototype.setParentPanel=function(a){this._parentPanel=a};b.prototype.handleMaximizeToggleClick=function(a,b,e){this.viewModel.panelMaximized.get()?this.minimizePanel():this.maximizePanel()};b.prototype.maximizePanel=function(){this.viewModel.panelMaximized.set(!0);this.app.command("ResizeShell").execute();this.app.event("ApplicationResizedEvent").publish();
this.app.event("PanelRegionMaximizedEvent").publish(this.resizableRegion)};b.prototype.minimizePanel=function(){this.viewModel.panelMaximized.set(!1);this.app.command("ResizeShell").execute();this.app.event("ApplicationResizedEvent").publish();this.app.event("PanelRegionRestoredEvent").publish(this.resizableRegion)};b.prototype._unsubscribeMenuItemInvokedSubscription=function(){this._menuItemInvokedSubscriptionToken&&(this.app.event("MenuItemInvokedEvent").unsubscribe(this._menuItemInvokedSubscriptionToken),
this._menuItemInvokedSubscriptionToken=null)};b.prototype.handleHeaderMouseDown=function(a,b,e){var c=this;if(this.viewModel.panelMaximized.get()||a.target!==a.currentTarget)return!0;$(this.app.getHostElement()).off("mouseup.header-click touchend.header-click");var d=!0;$(this.app.getHostElement()).one("mouseup.header-click touchend.header-click",function(){d=!1});setTimeout(function(){d&&c.resizableRegion&&($(c.app.getHostElement()).off("mouseup.header-click touchend.header-click"),c.resizeSmartPanel(a.pageX,
a.pageY),a.preventDefault())},250);a.preventDefault();a.stopImmediatePropagation();return!0};b.prototype.handleHeaderTouchStart=function(a,b,e){var c=this;if(this.viewModel.panelMaximized.get())return!0;for(b=a.target||a.srcElement;b!=this.root;){if($(b).is("button")&&!$(b).hasClass("resize-handle"))return!0;b=b.parentElement}$(this.app.getHostElement()).off("touchend.header-click");var d=!0;$(this.app.getHostElement()).one("touchend.header-click",function(){d=!1});setTimeout(function(){d&&c.resizableRegion&&
(a.preventDefault(),$(c.app.getHostElement()).off("touchend.header-click"),c.resizeSmartPanel(a.targetTouches[0].pageX,a.targetTouches[0].pageY))},250);a.preventDefault();return!0};b.prototype.resize=function(){if(this.headerElement&&this.scrollRegionElement&&this.containerElement){var a=$(this.statusRegionElement),b=$(this.headerElement),e=$(this.footerElement),c=$(this.scrollRegionElement),a=a.length&&"none"!==a.css("display")?a.outerHeight():0,b=b.length&&"none"!==b.css("display")?b.outerHeight():
0,e=e.length&&"none"!==e.css("display")?e.outerHeight():0,b=b+a;"relative"!==c.css("position")&&c.css("top",b+"px");c.css("bottom",e+"px")}};b.prototype.resizeSmartPanel=function(a,b){var e=this;if(this.resizeX||this.resizeY){var c={};c.initialX=a;c.initialY=b;this.app.event("PanelResizeStartEvent").publish({viewId:this.id,resizeInformation:c});if(null===this.resizePreviewElement||void 0===this.resizePreviewElement)this.resizePreviewElement=document.createElement("div"),this.resizePreviewElement.className=
"resize-hint";null===this.resizePreviewElement.parentElement&&(this.app.getHostElement().appendChild(this.resizePreviewElement),$(this.resizePreviewElement).css("left",this.root.getBoundingClientRect().left));c.initialPanelHeight=$(this.resizableRegion).height();c.initialPanelWidth=$(this.resizableRegion).width();if(0===c.initialPanelHeight||c.initialPanelHeight>$(this.resizableRegion.parentElement).height())c.initialPanelHeight=$(this.resizableRegion.parentElement).height();if(0===c.initialPanelWidth||
c.initialPanelWidth>$(this.resizableRegion.parentElement).width())c.initialPanelWidth=$(this.resizableRegion.parentElement).width();this.resizeX?($(this.resizePreviewElement).width(c.initialPanelWidth),$(this.resizePreviewElement).height(c.initialPanelHeight),c.minWidth=parseInt($(this.resizableRegion).css("min-width")),c.maxWidth=parseInt($(this.resizableRegion).css("max-width"))):this.resizeY&&($(this.resizePreviewElement).width(c.initialPanelWidth),$(this.resizePreviewElement).height(c.initialPanelHeight),
c.minHeight=parseInt($(this.resizableRegion).css("min-height")),c.maxHeight=parseInt($(this.resizableRegion).css("max-height")));this._resizeAccordingToSizeConstraints(c,this.resizePreviewElement);$(this.app.getHostElement()).one("mouseup.header-resize touchend.header-resize",function(a){return e._handleResizeEnd(a,c)});$(this.app.getHostElement()).on("mousemove.header-resize ",function(a){e.app.event("PanelResizingEvent").publish({viewId:e.id,resizeInformation:c});c.currentX=a.pageX;c.currentY=a.pageY;
e._resizeAccordingToSizeConstraints(c,e.resizePreviewElement);a.preventDefault();return!1});$(this.app.getHostElement()).on("touchmove.header-resize",function(a){e.app.event("PanelResizingEvent").publish({viewId:e.id,resizeInformation:c});var b=a.originalEvent;c.currentX=b.targetTouches[0].pageX;c.currentY=b.targetTouches[0].pageY;e._resizeAccordingToSizeConstraints(c,e.resizePreviewElement);a.preventDefault();return!1})}else this.app.trace.debug("This panel is not configured to be resizable!")};
b.prototype._handleResizeEnd=function(a,b){$(this.app.getHostElement()).off("mousemove.header-resize touchmove.header-resize");this.resizePreviewElement.parentNode&&this.resizePreviewElement.parentNode.removeChild(this.resizePreviewElement);this._resizeAccordingToSizeConstraints(b,this.resizableRegion);this.app.event("PanelResizeEndEvent").publish({viewId:this.id,resizeInformation:b});this.app.command("ResizeShell").execute();this.app.event("ApplicationResizedEvent").publish()};b.prototype._resizeAccordingToSizeConstraints=
function(a,b){if(this.resizeX){var e=a.initialPanelWidth+(a.currentX-a.initialX);e<a.minWidth?$(b).width(a.minWidth):e>a.maxWidth?$(b).width(a.maxWidth):$(b).width(e)}this.resizeY&&(e=a.initialPanelHeight+(a.initialY-a.currentY),e<a.minHeight?$(b).height(a.minHeight):e>a.maxHeight?$(b).height(a.maxHeight):$(b).height(e))};b.prototype._destroyHoistedMenuOwnerViewIfExists=function(){if(this.hoistedMenuOwnerView){var a=this.hoistedMenuOwnerView;this.hoistedMenuOwnerView=null;a.viewModel=null;this.app.viewManager.destroyView(a);
delete this._menuViews[a.id]}};b.HoistedClassName="hidden-hoisted-menu";return b}(d.framework.ui.ViewContainer.ViewContainerView);c.SmartPanelView=b})(g.SmartPanel||(g.SmartPanel={}))})(g.components||(g.components={}))})(h.ui||(h.ui={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(g){(function(g){(function(c){var b=function(a){function b(){a.apply(this,arguments)}__extends(b,a);b.prototype.finish=function(){this.viewModel.closeAllViews()};b.prototype.cancel=function(){this.viewModel.closeAllViews(!0)};b.prototype.handleClickBack=function(b,e,c){a.prototype.handleClickBack.call(this,b,e,c)};b.prototype.handleClickClose=function(b,e,c){a.prototype.handleClickClose.call(this,b,e,c);this.cancel()};return b}(d.ui.components.SmartPanel.SmartPanelView);
c.WizardPanelView=b})(g.WizardPanel||(g.WizardPanel={}))})(g.components||(g.components={}))})(d.ui||(d.ui={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){(function(g){(function(c){var b=function(a){function b(c,d){a.call(this,c,d);this.hoistedMenuViewModel=new Observable(b.emptyMenuViewModel);this.hasHoistedMenu=new Observable(!1);this.hasExecutableMenuItems=new Observable(!1);this.inlineMenuIsOpen=new Observable(!1);this.panelMaximized=new Observable(!1);this.showingMaximizeButton=new Observable(!1);this.resizeY=this.resizeX=!1;b.emptyMenuViewModel||(b.emptyMenuViewModel=new h.menus.MenuViewModel(c,
d))}__extends(b,a);b.prototype.initialize=function(b){a.prototype.initialize.call(this,b);this.statusRegion=b.statusRegionName;this.statusRegionType=b.statusRegionType||"geocortex.framework.ui.DivRegionAdapter";b.resizeX&&(this.resizeX=b.resizeX);b.resizeY&&(this.resizeY=b.resizeY);this.menuRegion=b.menuRegion||null;void 0!=b.showMaximizeButton&&this.showingMaximizeButton.set(b.showMaximizeButton)};return b}(d.framework.ui.ViewContainer.ViewContainerViewModel);c.SmartPanelViewModel=b})(g.SmartPanel||
(g.SmartPanel={}))})(g.components||(g.components={}))})(h.ui||(h.ui={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(g){(function(g){(function(c){var b=function(a){function b(e,c){a.call(this,e,c)}__extends(b,a);b.prototype.showOrHideCloseButtons=function(){var a=this.viewDescriptors.getAt(0);a&&(this.showingBackButton.set(this.currentView!==a.view),this.showingXButton.set(!0))};b.prototype.closeAllViews=function(a){for(a=0;a<this.viewDescriptors.length();a++){var b=this.viewDescriptors.getAt(a).view,e=b.viewModel;this._isWizardFragment(e)&&e.reset();
this.app.viewManager.deactivateView(b)}};b.prototype._isWizardFragment=function(a){return void 0!==a.reset};return b}(d.ui.components.SmartPanel.SmartPanelViewModel);c.WizardPanelViewModel=b})(g.WizardPanel||(g.WizardPanel={}))})(g.components||(g.components={}))})(d.ui||(d.ui={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){d=d.essentialsHtmlViewer||(d.essentialsHtmlViewer={});d=d.mapping||(d.mapping={});d=d.infrastructure||(d.infrastructure={});d=d.undo||(d.undo={});d=d.TransactionStatus||(d.TransactionStatus={});d.PENDING="pending";d.COMMITTING="committing";d.COMMITTED="committed";d.ABORTING="aborting";d.ABORTED="aborted"})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){(function(c){c[c.SCALE=0]="SCALE";c[c.CENTER=1]="CENTER";c[c.EXTENT=2]="EXTENT"})(d.ExtentLinkPriority||(d.ExtentLinkPriority={}));(function(c){c[c.LAYERTHEME=0]="LAYERTHEME";c[c.LAYERS=1]="LAYERS"})(d.LayerListLinkPriority||(d.LayerListLinkPriority={}));var h=function(){function c(b,a){this.generateParameter=this.acceptParameter=!0;this.app=b;this.libraryId=a}c.prototype.initialize=function(b){};c.prototype.generate=function(){return""};
c.prototype.apply=function(b){};c.prototype.getResource=function(b,a){return this.app.getResource(this.libraryId,b,a)};return c}();d.SharingLinkProviderBase=h})(d.sharing||(d.sharing={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var h=function(c){function b(a,b){c.call(this,a,b);this.menuTitle=new Observable("");this.menuDescription=new Observable("");this.menuItems=new ObservableCollection([]);this.visibleMenuItems=new ObservableCollection([]);this.hasExecutableMenuItems=new Observable(!1);this.menuContext=new Observable(null);this.auto(this.menuContext,this,this._handleContextChanged);this.auto(this.menuItems,this,this._handleMenuItemsChanged)}__extends(b,
c);b.prototype.initialize=function(a){c.prototype.initialize.call(this,a);this.menuId=a&&a.menuId||null;this.libraryId=a&&a.libraryId||this.libraryId};b.prototype.setupMenu=function(a){var b=this;if(this.menuId=a||this.menuId)if(this.menuItems.clear(),a=this.app.menuRegistry.getMenu(this.menuId)){if(a.title&&this.menuTitle.set(a.title),a.description&&this.menuDescription.set(a.description),a.items&&a.items.length){var c=[];a.items.forEach(function(a){a=new g.MenuItemViewModel(b,a);c.push(a);b.auto(a.canExecute,
b,b._computeExecutableMenuItems)});this.menuItems.addItems(c)}}else this.app.trace.error("MenuViewModel: Could not load menu '{0}'. Menu not registered.".format(this.menuId));else this.app.trace.error("MenuViewModel: Could not load menu. Menu id not specified.")};b.prototype.onDestroy=function(){c.prototype.onDestroy.call(this);this.menuItems.get().forEach(function(a){return a.destroy()});this.menuItems.clear();this.visibleMenuItems.clear()};b.prototype._computeExecutableMenuItems=function(){var a=
!1,b=[];this.visibleMenuItems.clear();for(var c=0;c<this.menuItems.length();c++){var d=this.menuItems.getAt(c);d.canExecute.get()?(a=!0,b.push(d)):d.menuItem.hideOnDisable||b.push(d)}this.visibleMenuItems.set(b);this.hasExecutableMenuItems.set(a)};b.prototype._handleContextChanged=function(a){this.menuItems.get().forEach(function(a){return a.refreshCanExecute()})};b.prototype._handleMenuItemsChanged=function(a){if("clear"===a.type)this.visibleMenuItems.clear();else if("append"===a.type)this._computeExecutableMenuItems();
else if("remove"===a.type){a=a.sender.get().slice(a.rangeStart,a.rangeEnd+1);for(var b=0;b<a.length;b++)this.visibleMenuItems.removeItem(a[b])}else"insert"===a.type&&this._computeExecutableMenuItems()};b.DefaultParameterName="context";return b}(d.framework.ui.ViewModelBase);g.MenuViewModel=h})(h.menus||(h.menus={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(){return function(c,b){this.stateDefinition=c;this.activatedBy=b}}();d.ActiveState=h})(d.applicationState||(d.applicationState={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(){function c(b,a){this.registeredStates=[];this.activeStates=[];this.previousModalState=this.modalState=null;this.commandTokens=[];this.eventTokens=[];this.app=b;this.libraryId=a;for(var e=0;e<d.definedStates.length;e++)this.registerState(d.definedStates[e])}c.prototype.registerState=function(b){var a=this;if(this.registeredStates.some(function(a){return a.name===b.name}))this.app.trace.info("States with duplicate names registered! New state ignored. Name is: "+
b.name);else if(this.registeredStates.filter(function(a){return a.hasOwnProperty("parentState")}).some(function(a){return a.name===b.parentState}))this.app.trace.info("Tried to load a state with a parent that references another state that has a parent. Only parent -> child relationships are allowed. State name: "+b.name);else{var e=dojo.connect(this.app,"onLibrariesDownloaded",this,function(){dojo.disconnect(e);a.app.hasLibrary(a.libraryId)&&-1===b.description.search(" ")&&(b.description=a.app.getResource(a.libraryId,
b.description))});b.enterCommands&&b.enterCommands.forEach(function(e){var c=a.app.command(e.name).register(a,function(c){return a._stateEntered(b,e,c)});a.commandTokens.push({instance:e,token:c})});b.exitCommands&&b.exitCommands.forEach(function(e){var c=a.app.command(e.name).register(a,function(c){return a._stateExited(b,e,c)});a.commandTokens.push({instance:e,token:c})});b.enterEvents&&b.enterEvents.forEach(function(e){var c=a.app.event(e.name).subscribe(a,function(c){return a._stateEntered(b,
e,c)});a.eventTokens.push({instance:e,token:c})});b.exitEvents&&b.exitEvents.forEach(function(e){var c=a.app.event(e.name).subscribe(a,function(c){return a._stateExited(b,e,c)});a.eventTokens.push({instance:e,token:c})});this.registeredStates.push(b);"DefaultState"===b.name&&this.activeStates.push(new d.ActiveState(b))}};c.prototype.onDestroy=function(){for(var b=0;b<this.eventTokens.length;b++)this.app.event(this.eventTokens[b].instance.name).unsubscribe(this.eventTokens[b].token);for(b=0;b<this.commandTokens.length;b++)this.app.command(this.commandTokens[b].instance.name).unregister(this.commandTokens[b].token)};
c.prototype.getActiveStates=function(){for(var b=[],a=0;a<this.activeStates.length;a++)b[this.activeStates[a].stateDefinition.name]=this.activeStates[a];return this.activeStates.filter(function(a){return a.stateDefinition.parentState&&b[a.stateDefinition.parentState]||!a.stateDefinition.parentState})};c.prototype.getStateByName=function(b){for(var a=0;a<this.registeredStates.length;a++)if(this.registeredStates[a].name===b)return this.registeredStates[a];return null};c.prototype.getModalState=function(){return this.modalState||
null};c.prototype.isModalStateActive=function(){return null!==this.modalState};c.prototype.isCurrentlyActive=function(b){return this.activeStates.some(function(a){return a.stateDefinition.name===b})};c.prototype.getAllStateNames=function(){for(var b=[],a=0;a<this.registeredStates.length;a++)b.push(this.registeredStates[a].name);return b};c.prototype._stateEntered=function(b,a,e){if(!(b.parentState&&!this.activeStates.some(function(a){return a.stateDefinition.name===b.parentState})||this.isCurrentlyActive(b.name)||
a.parameter&&a.parameter!==e)){var c=null;if("string"===typeof e||e instanceof String)c=e;this.app.trace.debug("State entered: "+b.name);b.isModal&&(null!==this.modalState&&(this.previousModalState=this.modalState,this._exitState(this.modalState,a,c)),this.app.trace.debug("Modal State entered: "+b.name),this.modalState=b);this.activeStates.push(new d.ActiveState(b,a));this.app.event("StateEnteredEvent").publish({stateDefinition:b,activeStates:this.activeStates,modalState:this.modalState,previousModalState:this.modalState})}};
c.prototype._stateExited=function(b,a,e){if(!a.parameter||a.parameter===e){for(var c=!1,d=0;d<this.activeStates.length;d++)this.activeStates[d].stateDefinition===b&&(c=!0);d=!1;b.parentState&&(d=this.activeStates.some(function(a){return a.stateDefinition.name===b.parentState}));if(c&&(!b.parentState||d)){c=null;if("string"===typeof e||e instanceof String)c=e;this._exitState(b,a,c)}}};c.prototype._exitState=function(b,a,e){this._exitChildStates(b,a,e);for(a=this.activeStates.length-1;0<=a;a--)this.activeStates[a].stateDefinition===
b&&(this.activeStates.splice(a,1),this.app.trace.debug("State exited: "+b.name));this.modalState===b&&(this.modalState=null,this.previousModalState=b,this.app.trace.debug("Modal state exited: "+b.name));this.app.event("StateExitedEvent").publish({stateDefinition:b,activeStates:this.activeStates,modalState:this.modalState,previousModalState:this.previousModalState})};c.prototype._exitChildStates=function(b,a,e){for(var c=[],d=0;d<this.activeStates.length;d++)if(this.activeStates[d].stateDefinition.parentState===
b.name){var g=this.activeStates[d].stateDefinition;if(g.exitCommands)for(var h=0;h<g.exitCommands.length;h++)g.exitCommands[h].name!==a.name||g.exitCommands[h].parameter&&g.exitCommands[h].parameter!==e||c.push(g);if(g.exitEvents)for(h=0;h<g.exitEvents.length;h++)g.exitEvents[h].name!==a.name||g.exitEvents[h].parameter&&g.exitEvents[h].parameter!==e||c.push(g)}for(d=0;d<c.length;d++)this._exitState(c[d],a,e)};return c}();d.StateManager=h})(d.applicationState||(d.applicationState={}))})(d.infrastructure||
(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){d=d.essentialsHtmlViewer||(d.essentialsHtmlViewer={});d=d.mapping||(d.mapping={});d=d.infrastructure||(d.infrastructure={});(d.applicationState||(d.applicationState={})).definedStates=[{name:"DefaultState",description:"language-states-default-description",isModal:!1},{name:"TransientActiveState",description:"language-states-transient-active-description",isModal:!1,enterEvents:[{name:"TransientActivatedEvent"}],exitEvents:[{name:"TransientsDeactivatedEvent"}]},{name:"IdentifyState",description:"language-states-identify-state-description",
isModal:!1,enterCommands:[{name:"SetActiveTool",parameter:"PointIdentifyTool-Navigation"},{name:"SetActiveTool",parameter:"IdentifyRectangleTool"},{name:"SetActiveTool",parameter:"RectangleIdentifyTool"}],exitEvents:[{name:"ToolCommandDeactivatedEvent",parameter:"Identify"}]},{name:"IdentifyBufferingState",parentState:"IdentifyState",description:"language-states-buffering-description",isModal:!1,enterEvents:[{name:"BufferingActivatedEvent",parameter:"Identify"}],exitEvents:[{name:"BufferingDeactivatedEvent",
parameter:"Identify"}]},{name:"PlotCoordinatesState",description:"language-states-plotcoordinates-state-description",isModal:!1,enterCommands:[{name:"SetActiveTool",parameter:"PlotCoordinatesTool"}],exitEvents:[{name:"ToolCommandDeactivatedEvent",parameter:"PlotCoordinates"}]},{name:"SnappingState",description:"language-states-snapping-description",isModal:!1,enterCommands:[{name:"ActivateSnapping"}],exitCommands:[{name:"DeactivateSnapping"}]},{name:"FindDataState",description:"language-states-identify-state-description",
isModal:!0,enterEvents:[{name:"ToolCommandActivatedEvent",parameter:"Identify"}],exitEvents:[{name:"ToolCommandDeactivatedEvent",parameter:"Identify"}]},{name:"FindDataBufferingState",parentState:"FindDataState",description:"language-states-buffering-description",isModal:!1,enterEvents:[{name:"BufferingActivatedEvent",parameter:"Identify"}],exitEvents:[{name:"BufferingDeactivatedEvent",parameter:"Identify"}]},{name:"DrawMarkupState",description:"language-states-draw-markup-state-description",isModal:!0,
enterEvents:[{name:"ToolCommandActivatedEvent",parameter:"AddMarkup"},{name:"ToolCommandActivatedEvent",parameter:"AddTextMarkup"}],exitEvents:[{name:"ToolCommandDeactivatedEvent",parameter:"AddMarkup"},{name:"ToolCommandDeactivatedEvent",parameter:"AddTextMarkup"}]},{name:"MeasureState",description:"language-states-measure-state-description",isModal:!0,enterEvents:[{name:"ToolCommandActivatedEvent",parameter:"MeasureDistance"},{name:"ToolCommandActivatedEvent",parameter:"MeasureArea"}],exitEvents:[{name:"ToolCommandDeactivatedEvent",
parameter:"MeasureDistance"},{name:"ToolCommandDeactivatedEvent",parameter:"MeasureArea"}]},{name:"SelectMarkupForEditingState",description:"language-states-edit-state-description",isModal:!0,enterEvents:[{name:"ToolCommandActivatedEvent",parameter:"DeleteMeasurement"},{name:"ToolCommandActivatedEvent",parameter:"DeleteMarkup"},{name:"ToolCommandActivatedEvent",parameter:"EditMarkup"}],exitEvents:[{name:"ToolCommandDeactivatedEvent",parameter:"DeleteMeasurement"},{name:"ToolCommandDeactivatedEvent",
parameter:"DeleteMarkup"},{name:"ToolCommandDeactivatedEvent",parameter:"EditMarkup"}]},{name:"EditorActiveState",description:"language-states-editing-active-state-description",isModal:!1,enterCommands:[{name:"StartEditingFeature"},{name:"StartEditingNewFeature"},{name:"StartEditingNewRelatedRecord"}],exitEvents:[{name:"EditorClosedEvent"}]},{name:"EditingMarkupState",description:"language-states-editing-state-description",isModal:!1,enterEvents:[{name:"MarkupEditingStartedEvent"}],exitEvents:[{name:"MarkupEditingStoppedEvent"}]},
{name:"EditingMeasurementMarkupState",description:"language-states-editing-state-description",isModal:!1,enterEvents:[{name:"MeasurementEditingStartedEvent"}],exitEvents:[{name:"MarkupEditingStoppedEvent"}]},{name:"FeaturePlacementState",description:"language-states-feature-editing-state-description",isModal:!0,enterEvents:[{name:"StartFeaturePlacementEvent"},{name:"ToolCommandActivatedEvent",parameter:"SetEditorFeatureGeometry"}],exitEvents:[{name:"StopFeaturePlacementEvent"},{name:"ToolCommandDeactivatedEvent",
parameter:"SetEditorFeatureGeometry"}]},{name:"FeaturePlacementGraphicState",parentState:"FeaturePlacementState",description:"language-states-feature-editing-state-graphic-description",isModal:!1,enterCommands:[{name:"StartEditingGraphicGeometry"}],enterEvents:[{name:"ToolCommandActivatedEvent",parameter:"SetEditorFeatureGeometry"}],exitEvents:[{name:"StopFeaturePlacementEvent"},{name:"ToolCommandDeactivatedEvent",parameter:"SetEditorFeatureGeometry"}]},{name:"FeaturePlacementPointGraphicState",parentState:"FeaturePlacementState",
description:"language-states-feature-editing-state-point-graphic-description",isModal:!1,enterEvents:[{name:"GeometryEditPointActivatedEvent"}],exitEvents:[{name:"StopFeaturePlacementEvent"},{name:"ToolCommandDeactivatedEvent",parameter:"SetEditorFeatureGeometry"}]}]})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){function k(a){var b=null;a instanceof esri.layers.ArcGISDynamicMapServiceLayer?a.gdbVersion&&(b=a.gdbVersion):a instanceof esri.layers.FeatureLayer&&a.gdbVersion&&(b=a.gdbVersion);return b}function c(a,b){if(!a)return null;if(!b)return a;if(b.mapServiceType===d.essentials.MapServiceType.WMS){var e=d.essentials.RestHelperHTTPService.getTokenForScope(b.url);e&&(a+=-1<a.indexOf("?")?"&token=":"?token=",a+=encodeURIComponent(e))}else b.serviceToken&&
!/.*token=.*/.test(a)&&(a+=-1<a.indexOf("?")?"&token=":"?token=",a+=encodeURIComponent(b.serviceToken));return a}function b(a){return a&&a.identifiable&&a.supportsIdentify?!0:!1}function a(a){return a&&a.queryable&&a.supportsQuery?!0:!1}function e(b){if(!b||!b.serviceLayer)return!1;if(b.mapServiceType===d.essentials.MapServiceType.WMS){for(var e=0;e<b.layers.length;e++)if(a(b.layers[e]))return!0;return!1}b=b.serviceLayer;return b.capabilities?10>b.version?!0:b.capabilities&&0<=b.capabilities.indexOf("Query"):
!1}var f=function(){return function(){}}();g.getQueryTaskUrl=function(a,b){var g=null,h=null,k;a instanceof d.essentials.Layer?(g=a,k=g.mapService,b&&(h=b.serviceLayer)):a instanceof esri.layers.Layer&&(h=a,b&&(k=b));if(h instanceof esri.layers.FeatureLayer&&"table"===h.type||h instanceof esri.layers.FeatureLayer&&!k)return h.url;if(!e(k))return null;k=null;if(h instanceof esri.layers.WMSLayer){if(!g)return null;k=g.url}else g?k=g.mapService.serviceLayer.url:h&&(k=h.url);var m,q=null;if(g)if(g.isDynamic){m=
"dynamicLayer";var q=null,w=g.mapService.getDynamicLayerInfoById(g.id);if(w&&w.source&&(w.source instanceof esri.layers.LayerDataSource||w.source instanceof esri.layers.LayerMapSource)){if(q=new f,q.source=w.source.toJson(),w.id&&(q.id=w.id),g=g.getDefinitionExpression(g.mapService.serviceLayer))q.definitionExpression=g}else throw Error("A dynamic layer must have a DataSource!");}else m=g.id;else h&&(m=h.id);h instanceof esri.layers.FeatureLayer||k.match(/\/\d+(\?.*)?$/)||(h=k.indexOf("?"),g=k.indexOf("#"),
k=-1!=h?k.substring(0,h)+"/"+m+k.substring(h):-1!=g?k.substring(0,g)+"/"+m+k.substring(g):k+("/"+m));k=c(k,b);q&&(k+=-1<k.indexOf("?")?"&layer=":"?layer=",k+=encodeURIComponent(JSON.stringify(q)));return k};g.getQueryTask=function(a,b){var e=null,c=null,f=null,h=null;if(a instanceof esri.layers.Layer)c=a,b&&(f=b);else if(a instanceof d.essentials.Layer&&a.mapService&&a.mapService.serviceLayer)c=a.mapService.serviceLayer,f=a.mapService,h=a;else throw Error("Cannot generate a QueryTask from the given parameters.");
if(c){var q=k(c);q&&(e={gdbVersion:q})}return new esri.tasks.QueryTask(g.getQueryTaskUrl(h?h:c,f),e)};g.getIdentifyTaskUrl=function(a){if(!a||!a.serviceUrl)return null;if(a.mapServiceType===d.essentials.MapServiceType.WMS){for(var f=0;f<a.layers.length;f++)if(b(a.layers[f]))return c(a.url,a);return null}return e(a)?a instanceof d.essentials.FeatureLayerService?a.serviceUrl.substring(0,a.serviceUrl.lastIndexOf("/")).replace(/FeatureServer$/i,"MapServer"):a.mapServiceType==d.essentials.MapServiceType.DYNAMIC||
a.mapServiceType==d.essentials.MapServiceType.TILED?c(a.serviceUrl,a):null:null};g.getIdentifyTask=function(a){var b=null;if(a.serviceLayer){var e=k(a.serviceLayer);e&&(b={gdbVersion:e})}return new esri.tasks.IdentifyTask(g.getIdentifyTaskUrl(a),b)};g.getTokenizedUrl=c;g.canIdentifyLayer=b;g.canQueryLayer=a;g.canQueryMapService=e;g.getSearchTextWhereClause=function(a,b,e,c){if(!a||!b||0==b.length||!e)return"";for(var f=String(e).toLowerCase(),g="",k=0;k<b.length;k++){var m=b[k];if(m.searchable&&"gml:id"!==
m.name)if(m.isCodedValueDomain()||m.hasSubtypeCodedValueDomains()){var q=[],u=m.getCodedValueDomain();u&&u.codedValues.forEach(function(a){return q.push(a)});var u=m.getSubtypeCodedValueDomains(),z;for(z in u)u.hasOwnProperty(z)&&u[z].codedValues.forEach(function(a){return q.push(a)});q.forEach(function(a){-1<a.name.toLowerCase().indexOf(f)&&(0<g.length&&(g+=" OR "),g=m.type===d.essentials.EsriFieldTypes.esriFieldTypeString?g+(encodeURI(m.name)+" = '"+a.code.replace("'","''")+"'"):g+(encodeURI(m.name)+
" = "+a.code))})}else switch(m.type){case d.essentials.EsriFieldTypes.esriFieldTypeString:0<g.length&&(g+=" OR ");g=a.mapService.serviceLayer instanceof esri.layers.WMSLayer?g+(encodeURI(m.name)+" LIKE '%"+e.replace("'","''")+"%'"):g+("LOWER("+m.name+") LIKE '%"+f.replace("'","''")+"%'");break;case d.essentials.EsriFieldTypes.esriFieldTypeSmallInteger:case d.essentials.EsriFieldTypes.esriFieldTypeInteger:case d.essentials.EsriFieldTypes.esriFieldTypeOID:case d.essentials.EsriFieldTypes.esriFieldTypeSingle:case d.essentials.EsriFieldTypes.esriFieldTypeDouble:u=
h.FormatUtils.parseNumber(e,[h.NumberFormat.ACCOUNTING,h.NumberFormat.CURRENCY,h.NumberFormat.FIXED_POINT,h.NumberFormat.NUMBER,h.NumberFormat.PERCENT,h.NumberFormat.ROUND_TRIP]);if(isNaN(u))break;0<g.length&&(g+=" OR ");var B=h.FormatUtils.formatNumber(u,h.NumberFormat.ROUND_TRIP),v;if(B.indexOf(".")){var A=B.length-B.indexOf(".")-1;v=Math.pow(10,-A)}else v=1;0>u?(A=h.FormatUtils.formatNumber(u-v,h.NumberFormat.ROUND_TRIP),u=B):(A=B,u=h.FormatUtils.formatNumber(u+v,h.NumberFormat.ROUND_TRIP));g+=
"("+encodeURI(m.name.toLowerCase())+" <= "+u+" AND "+encodeURI(m.name.toLowerCase())+" >= "+A+")";break;case d.essentials.EsriFieldTypes.esriFieldTypeDate:break;case d.essentials.EsriFieldTypes.esriFieldTypeGlobalID:case d.essentials.EsriFieldTypes.esriFieldTypeBlob:break;default:c&&c.warning("Unhandled layer data type: '{0}'. Field '{1}' in layer '{2}' has been excluded from search.".format(m.type,m.alias,a.displayName))}}(a=a.getDefinitionExpression(a.mapService.serviceLayer))&&(g="("+g+") AND ("+
a+")");return g}})(h.taskUtils||(h.taskUtils={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(g){(function(b){b[b.TOGGLE_BUTTON_OFF=0]="TOGGLE_BUTTON_OFF";b[b.TOGGLE_BUTTON_ON=1]="TOGGLE_BUTTON_ON"})(g.ToggleButtonState||(g.ToggleButtonState={}));var k=g.ToggleButtonState,c=function(b){function a(a,c,l){var g=this;b.call(this,a,c,l);this.state=new Observable(null);this.toggleButtonEntry=l;this.toggleOnCommand=new d.CommandViewModel(this.app,c,l.toggleOn.command,l.toggleOn.commandParameter);this.toggleOffCommand=new d.CommandViewModel(this.app,
c,l.toggleOff.command,l.toggleOff.commandParameter);this.isToggledOn=new Observable(!1);this.iconUri=new Observable(null);this.state.bind(this,function(a){return g.setState(a)});this.toggleButtonEntry.toggleStateName&&""!==this.toggleButtonEntry.toggleStateName?(this.app.event("StateEnteredEvent").subscribe(this,function(a){a.stateDefinition.name===g.toggleButtonEntry.toggleStateName&&g.state.set(k.TOGGLE_BUTTON_ON);g.isToggledOn.get()&&"TransientActiveState"===a.stateDefinition.name&&g.activeTransient.set(!0)}),
this.app.event("StateExitedEvent").subscribe(this,function(a){a.stateDefinition.name===g.toggleButtonEntry.toggleStateName&&g.state.set(k.TOGGLE_BUTTON_OFF);"TransientActiveState"===a.stateDefinition.name&&g.activeTransient.set(!1)})):this._setUpBindings();if(!this.app.site||!this.app.site.isInitialized)this.app.event("SiteInitializedEvent").once(this,function(){g.toggleOffCommand.commandName&&g.app.command(g.toggleOffCommand.commandName).raiseCanExecuteChanged();g.toggleOnCommand.commandName&&g.app.command(g.toggleOnCommand.commandName).raiseCanExecuteChanged();
g.state.get()===k.TOGGLE_BUTTON_OFF?g.disabled.set(!g.toggleOffCommand.canExecute.get()):g.disabled.set(!g.toggleOnCommand.canExecute.get())});l.toggleStateName&&this.app.stateManager.isCurrentlyActive(l.toggleStateName)?this.state.set(k.TOGGLE_BUTTON_ON):this.state.set(k.TOGGLE_BUTTON_OFF)}__extends(a,b);a.prototype.execute=function(){this.command&&this.command.commandName&&(this.command.commandParameter?this.app.commandRegistry.command(this.command.commandName).execute(this.command.commandParameter):
this.app.commandRegistry.command(this.command.commandName).execute())};a.prototype.setState=function(a){if(a===k.TOGGLE_BUTTON_OFF)var b=this.toggleButtonEntry.toggleOn.name||this.toggleButtonEntry.name||"",c=this.toggleButtonEntry.toggleOn.iconUri||this.toggleButtonEntry.iconUri||null,d=this.toggleButtonEntry.toggleOn.tooltip||this.toggleButtonEntry.tooltip||null,g=void 0!=this.toggleButtonEntry.toggleOn.hideOnDisable?!!this.toggleButtonEntry.toggleOn.hideOnDisable:!!this.toggleButtonEntry.hideOnDisable,
h=!1;else b=this.toggleButtonEntry.toggleOff.name||this.toggleButtonEntry.name||"",c=this.toggleButtonEntry.toggleOff.iconUri||this.toggleButtonEntry.iconUri||null,d=this.toggleButtonEntry.toggleOff.tooltip||this.toggleButtonEntry.tooltip||null,g=void 0!=this.toggleButtonEntry.toggleOff.hideOnDisable?!!this.toggleButtonEntry.toggleOff.hideOnDisable:!!this.toggleButtonEntry.hideOnDisable,h=!0;this.name.set(b);this.isToggledOn.set(h);this.iconUri.set(c);this.tooltip.set(d);this.command=a===k.TOGGLE_BUTTON_OFF?
this.toggleOnCommand:this.toggleOffCommand;this.disabled.set(!this.command.canExecute.get());this.hideOnDisable.set(g);this.setHidden();this.app.event("ToggleButtonStateChangedEvent").publish({toggleButtonEntry:this.toggleButtonEntry,state:a})};a.prototype.onDestroy=function(){this._disconnectBindings()};a.prototype._setUpBindings=function(){var a=this;this._toggleOnCommandCanExecuteBindingToken=this.toggleOnCommand.canExecute.bind(this,function(b){return a._handleCommandCanExecuteChanged(a.toggleOnCommand,
b)});this._toggleOnCommandPostExecSubscriptionToken=this.app.command(this.toggleButtonEntry.toggleOn.command).postExecute.subscribe(this,this._handleToggleOnCommandPostExecute);this._toggleOffCommandCanExecuteBindingToken=this.toggleOffCommand.canExecute.bind(this,function(b){return a._handleCommandCanExecuteChanged(a.toggleOffCommand,b)});this._toggleOffCommandPostExecSubscriptionToken=this.app.command(this.toggleButtonEntry.toggleOff.command).postExecute.subscribe(this,this._handleToggleOffCommandPostExecute)};
a.prototype._disconnectBindings=function(){this.toggleOnCommand.canExecute.unbind(this._toggleOnCommandCanExecuteBindingToken);this.app.command(this.toggleButtonEntry.toggleOn.command).postExecute.unsubscribe(this._toggleOnCommandPostExecSubscriptionToken);this.toggleOffCommand.canExecute.unbind(this._toggleOffCommandCanExecuteBindingToken);this.app.command(this.toggleButtonEntry.toggleOff.command).postExecute.unsubscribe(this._toggleOffCommandPostExecSubscriptionToken)};a.prototype._handleToggleOnCommandPostExecute=
function(a){a&&this.command.commandParameter!==a||this.state.get()!==k.TOGGLE_BUTTON_ON&&this.state.set(k.TOGGLE_BUTTON_ON)};a.prototype._handleToggleOffCommandPostExecute=function(a){a&&this.command.commandParameter!==a||this.state.get()!==k.TOGGLE_BUTTON_OFF&&this.state.set(k.TOGGLE_BUTTON_OFF)};a.prototype._handleCommandCanExecuteChanged=function(a,b){this.command===a&&(this.disabled.set(!b),this.setHidden())};return a}(g.ToolbarGroupItemBase);g.ToolbarToggleButton=c})(d.toolbarGroup||(d.toolbarGroup=
{}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var h=function(c){function b(a,b,f){var d=this;c.call(this,a,b,f);f.layout&&"small"===f.layout.toLowerCase()&&this.hasSmallLayout.set(!0);this.items=new ObservableCollection;for(a=0;a<f.items.length;a++)(b=this.getToolbarItemType(f.items[a]))&&this.items.addItem(b);this.disabled.set(this.areAllHidden(this.items));this.setHidden();this.disabled.bind(this,function(a){d.setHidden()})}__extends(b,c);b.prototype.getToolbarItemType=function(a){if("button"==
a.type)return new d.essentialsHtmlViewer.mapping.infrastructure.toolbarGroup.ToolbarButton(this.app,this.libraryId,a);if("toggleButton"==a.type)return new d.essentialsHtmlViewer.mapping.infrastructure.toolbarGroup.ToolbarToggleButton(this.app,this.libraryId,a);if("region"==a.type)return new d.essentialsHtmlViewer.mapping.infrastructure.toolbarGroup.ToolbarRegion(this.app,this.libraryId,a);if("tool"==a.type)return new d.essentialsHtmlViewer.mapping.infrastructure.toolbarGroup.ToolbarTool(this.app,
this.libraryId,a);if("toolbarGroup"==a.type)return new d.essentialsHtmlViewer.mapping.infrastructure.toolbarGroup.ToolbarGroup(this.app,this.libraryId,a);if("flyout"==a.type)return new d.essentialsHtmlViewer.mapping.infrastructure.toolbarGroup.ToolbarFlyout(this.app,this.libraryId,a)};return b}(g.ToolbarGroupItemBase);g.ToolbarGroup=h})(h.toolbarGroup||(h.toolbarGroup={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||
(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var k=function(c){function b(a,b,f){var d=this;c.call(this,a,b,f);this.flyoutButtonDescription=new Observable("");this.selectedTool.set(this.items.getAt(0));this.flyoutButtonDescription.set(this.app.getResource(this.libraryId,"language-toolbar-flyout-description").format(this.name.get()));this.app.event("ActiveToolChangedEvent").subscribe(this,function(a){var b=d.items.get().filter(function(b){return d._seeIfActiveToolIsInFlyout(b,a)});
0<b.length&&d.selectedTool.set(b[0])})}__extends(b,c);b.prototype._seeIfActiveToolIsInFlyout=function(a,b){if(!(a.tool instanceof h.tools.MapTool))return!1;var c=a.tool;if(b.tool instanceof h.tools.MapTool){var d=b.tool;return c.command===d.command&&c.drawMode===d.drawMode}return!1};b.prototype.toggleFlyout=function(){this.toolChangeActive.set(!this.toolChangeActive.get())};b.prototype.switchActiveFlyoutTool=function(a){"tool"===a.type&&this.selectedTool.set(a);a.execute()};b.prototype.getToolbarItemType=
function(a){return"button"==a.type?new d.essentialsHtmlViewer.mapping.infrastructure.toolbarGroup.ToolbarButton(this.app,this.libraryId,a):"toggleButton"==a.type?new d.essentialsHtmlViewer.mapping.infrastructure.toolbarGroup.ToolbarToggleButton(this.app,this.libraryId,a):"region"==a.type?new d.essentialsHtmlViewer.mapping.infrastructure.toolbarGroup.ToolbarRegion(this.app,this.libraryId,a):"tool"==a.type?new d.essentialsHtmlViewer.mapping.infrastructure.toolbarGroup.ToolbarTool(this.app,this.libraryId,
a):"toolbarGroup"==a.type?new d.essentialsHtmlViewer.mapping.infrastructure.toolbarGroup.ToolbarGroup(this.app,this.libraryId,a):null};return b}(g.ToolbarGroup);g.ToolbarFlyout=k})(h.toolbarGroup||(h.toolbarGroup={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(h){(function(g){var h=function(c){function b(a,b,f){var l=this;c.call(this,a,b,f);this.command=new d.modules.command.CommandViewModel(this.app,void 0,f.command,f.commandParameter);this.disabled.set(!this.command.canExecute.get());this.setHidden();this.command.canExecute.bind(this,function(a){l.disabled.set(!a);l.setHidden()});this.iconUri=new Observable(f.iconUri);if(!this.app.site||!this.app.site.isInitialized)this.app.event("SiteInitializedEvent").once(this,
this._raiseCommandCanExecuteChanged)}__extends(b,c);b.prototype.execute=function(){this.command&&this.command.commandName&&(this.command.commandParameter?this.app.commandRegistry.command(this.command.commandName).execute(this.command.commandParameter):this.app.commandRegistry.command(this.command.commandName).execute());var a={commandName:this.command.commandName,commandParameter:this.command.commandParameter,id:this.id,name:this.name.get(),libraryId:this.libraryId};this.app.event("ToolbarButtonClickedEvent").publish(a)};
b.prototype._raiseCommandCanExecuteChanged=function(){this.command.commandName&&this.app.command(this.command.commandName).raiseCanExecuteChanged()};return b}(g.ToolbarGroupItemBase);g.ToolbarButton=h})(h.toolbarGroup||(h.toolbarGroup={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(c){function b(a,b,f){c.call(this,a,b,f);this.regionName=f.regionName}__extends(b,c);return b}(d.ToolbarGroupItemBase);d.ToolbarRegion=h})(d.toolbarGroup||(d.toolbarGroup={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(c){function b(a,b,f){var d=this;c.call(this,a,b,f);if(f){a={};for(var g in f){if(!g)break;a[g]=f[g]}a.name=f.id;var h=[];h.push(a);this.app.allLibrariesLoaded?this._initializeTool(h):(this.disabled.set(!0),this.setHidden(),this.app.event("ViewerLibrariesDownloadedEvent").once(this,function(){d.disabled.set(!1);d.setHidden();d._initializeTool(h)}));this.isActive.set(!1);this.iconUri=new Observable(f.iconUri);this.app.event("StateEnteredEvent").subscribe(this,
function(a){d.isActive.get()&&"TransientActiveState"===a.stateDefinition.name&&d.activeTransient.set(!0)});this.app.event("StateExitedEvent").subscribe(this,function(a){"TransientActiveState"===a.stateDefinition.name&&d.activeTransient.set(!1)})}}__extends(b,c);b.prototype.execute=function(){this.isActive.get()||this.tool.isActive?this.app.commandRegistry.command("ClearActiveTool").execute():this.tool.enabled&&!this.tool.enabled.get()||this.app.commandRegistry.command("SetActiveTool").execute(this.tool.id)};
b.prototype._initializeTool=function(a){var b=this;this.tool=this.app.toolRegistry.createTools(a,!0)[0];this.tool?this.tool.enabled&&(this.disabled.set(!this.tool.enabled.get()),this.setHidden(),this.tool.enabled.bind(this,function(a){b.disabled.set(!a);b.setHidden();a||!b.isActive.get()&&!b.tool.isActive||b.app.commandRegistry.command("ClearActiveTool").execute()})):(this.disabled.set(!0),this.setHidden())};return b}(d.ToolbarGroupItemBase);d.ToolbarTool=h})(d.toolbarGroup||(d.toolbarGroup={}))})(d.infrastructure||
(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var h=function(c){function b(a,b){c.call(this,a,b);this._drawIsActive=!1;this._mapMouseDownToken=this._mapMouseHoverToken=this._inputMethodChangeHandle=this._drawEndHandlerToken=null;this._autoPanPixelTolerance=15;this._autoPanStep=1/3;this._unsupportedAutoPanDrawModes=["FREEHAND_POLYGON","FREEHAND_POLYLINE","POINT","MULTI_POINT"];this._drawEndSuspended=!1}__extends(b,c);b.prototype._createDrawObject=function(){this._drawObject=this.app.accessibilityManager.createComponent("geocortex.accessibility.draw",
this.app.map);this._drawObject.setMarkerSymbol(new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,10,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new esri.Color([0,0,0,0.8]),2),new esri.Color([0,0,0,0.8])));this._drawObject.setFillSymbol(new esri.symbol.SimpleFillSymbol(esri.symbol.SimpleFillSymbol.STYLE_SOLID,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new esri.Color([0,0,0,0.8]),2),new esri.Color([0,0,0,0.25])));
this._drawObject.setLineSymbol(new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new esri.Color([0,0,0,0.8]),2))};b.prototype._activateToolbar=function(){this._drawObject||this._createDrawObject();this._drawEndHandlerToken||(this._drawEndHandlerToken=dojo.aspect.after(this._drawObject,"onDrawEnd",dojo.hitch(this,"onDrawEnd"),!0));this._drawObject instanceof d.essentialsHtmlViewer.mapping.infrastructure.accessibility.Draw&&(this._inputMethodChangeHandle=dojo.aspect.after(this._drawObject,
"onInputMethodChange",dojo.hitch(this,"onInputMethodChange"),!0));this._drawObject.activate(esri.toolbars.Draw[this.drawMode]);this._drawIsActive=!0;this._drawEndSuspended=!1};b.prototype._deactivateToolbar=function(){this._drawEndHandlerToken&&(this._drawEndHandlerToken.remove(),this._drawEndHandlerToken=null);this._inputMethodChangeHandle&&(this._inputMethodChangeHandle.remove(),this._inputMethodChangeHandle=null);this._drawObject&&this._drawIsActive&&(this._drawObject.deactivate(),this._drawEndSuspended=
this._drawIsActive=!1)};b.prototype.onActivated=function(){this._drawObject||this._createDrawObject();this._drawIsActive&&this._deactivateToolbar();if("CURRENT_EXTENT"==this.drawMode)this.onDrawEnd(this.app.map.extent);else{if(!this.app.map.graphics)return;this.app.command("ShowMap").execute();this._activateToolbar()}this._mapMouseDownToken=this.app.event("MapMouseDownEvent").subscribe(this,this.onMapMouseDown);this._mapMouseHoverToken=this.app.event("MapMouseHoverEvent").subscribe(this,this.onMapMouseHover)};
b.prototype.onDeactivated=function(){this._mapMouseHoverToken&&(this.app.event("MapMouseHoverEvent").unsubscribe(this._mapMouseHoverToken),this._mapMouseHoverToken=null);this._mapMouseDownToken&&(this.app.event("MapMouseDownEvent").unsubscribe(this._mapMouseDownToken),this._mapMouseDownToken=null);this._deactivateToolbar();this.app.command("ShowMap").execute()};b.prototype.onDrawEnd=function(a){var b=this;if(!this._drawEndSuspended){if(this.command){var c=this.app.command(this.command);c.canExecute(a)?
(c.execute(a),this.app.command("LogOptimizerEvent").execute(this.name,this.command)):this.app.trace.warning("Could not invoke command '{0}' for tool '{1}'.".format(this.command,this.name))}this.isSticky?(this._drawEndSuspended=!0,setTimeout(function(){return b._drawEndSuspended=!1},100)):this.setActive(!1)}};b.prototype.onInputMethodChange=function(a){a={tool:this,previousMethod:a?a.previousMethod:null,newMethod:a?a.newMethod:null};this.app.event("ToolInputMethodChangedEvent").publish(a)};b.prototype.onMapMouseDown=
function(a){3===a.which&&this._drawObject&&(this.app.command("ClearActiveTool").execute(),this._deactivateToolbar(),this.app.command("RemoveStatus").execute())};b.prototype.onMapMouseHover=function(a){if(null!=this._drawObject&&this._drawIsActive&&!(0<=this._unsupportedAutoPanDrawModes.indexOf(this.drawMode))&&a.hasOwnProperty("clientX")&&a.hasOwnProperty("clientY")){var b=$(this.app.map.root).offset();a.clientX<b.left+this._autoPanPixelTolerance?this.app.command("PanLeft").execute(this._autoPanStep):
b.left+this.app.map.width-this._autoPanPixelTolerance<a.clientX?this.app.command("PanRight").execute(this._autoPanStep):a.clientY<b.top+this._autoPanPixelTolerance?this.app.command("PanUp").execute(this._autoPanStep):b.top+this.app.map.height-this._autoPanPixelTolerance<a.clientY&&this.app.command("PanDown").execute(this._autoPanStep)}};return b}(g.ToolBase);g.MapTool=h;h.prototype.command=null;h.prototype.drawMode=null;h.prototype.isSticky=!1})(h.tools||(h.tools={}))})(k.infrastructure||(k.infrastructure=
{}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(c){function b(a,b){var f=this;c.call(this,a,b);this.enabled=new Observable(!0);if(b.command){var d=a.command(b.command);this.enabled.set(d.canExecute());d.canExecuteChanged.subscribe(this,function(){var a=d.canExecute();!a&&f.isActive&&f.setActive(!1);f.enabled.set(a)})}}__extends(b,c);return b}(d.MapTool);d.DisablingMapTool=h})(d.tools||(d.tools={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping=
{}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var h=function(c){function b(a,b){c.call(this,a,b);this.currentFeature=new Observable(null);this.providerEnabled=new Observable(!1);this.currentFeature.bind(this,this.handleCurrentFeatureChanged)}__extends(b,c);b.prototype.initialize=function(a){};b.prototype.handleCurrentFeatureChanged=function(a){};b.prototype.updateProviderState=function(a){a=!!this.currentFeature.get()&&!!a;this.providerEnabled.get()!==a&&this.providerEnabled.set(a)};
b.prototype.createAttachedViews=function(a,b,c,d){var g=this,h=[];if(a.viewType&&a.markup&&b){var k=function(c,f,k){var m=b[f];null!==m&&(m?(c=g.app.viewManager.createView({viewId:k,markupResource:c,typeName:a.viewType,iconUri:a.iconUri,title:a.title||"",regionName:m,isVisible:!0,libraryId:a.libraryId||g.libraryId,configuration:a.viewConfig}),c.attach(d||g),h.push(c)):g.app.trace.warning("FeatureProviderBase: Could not resolve target region for view mode {0}. Failed to create view with id {1}".format(f,
k)))};if("string"===typeof a.markup)k(a.markup,"default",a.viewId||null);else for(var m in a.markup)if(a.markup.hasOwnProperty(m)){var q=a.viewId?"{0}-{1}".format(a.viewId,m):null;k(a.markup[m],m,q)}c&&"function"===typeof c&&c(h)}else this.app.trace.warning("FeatureProviderBase: View type, markup or region not specified. Cannot create view for {0}".format(a.type))};return b}(d.framework.ui.ViewModelBase);g.FeatureProviderBase=h})(h.featureDetails||(h.featureDetails={}))})(k.infrastructure||(k.infrastructure=
{}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var h=function(){function c(){this.layers=[];this.tables=[];this.isUserCreated=!1;this.isExpanded=this.includeInLayerList=!0;this._delayedRefreshToken=null}c.fromEsriLayer=function(b){var a=new c;a.serviceLayer=b;a.serviceType=g.GisUtils.getServiceLayerType(b);a.id=b.id;if(b instanceof esri.layers.ArcGISDynamicMapServiceLayer||b instanceof esri.layers.ArcGISTiledMapServiceLayer){a.capabilities=b.capabilities.split(",");for(var e=0;e<
b.layerInfos.length;e++){var f=g.LayerInfo.fromEsriLayerInfo(b.layerInfos[e],b);f.serviceLayerInfo=a;a.layers.push(f)}}else b instanceof esri.layers.FeatureLayer&&(a.displayName=b.name,a.capabilities=b.capabilities.split(","),f=g.LayerInfo.fromEsriFeatureLayer(b),f.serviceLayerInfo=a,"Table"===b.type?a.tables.push(f):a.layers.push(f));return a};c.fromGcxMapService=function(b){var a=new c;a.gcxMapService=b;a.serviceType=b.mapServiceType;a.serviceLayerFunction=b.mapServiceFunction;a.serviceLayer=b.serviceLayer;
a.id=b.id;a.isExpanded=b.isExpanded;a.isUserCreated=b.isUserCreated;a.includeInLayerList=b.includeInLayerList;a.displayName=b.displayName;b.serviceLayer.capabilities&&(a.capabilities=b.serviceLayer.capabilities.split(","));for(var e=0;e<b.layers.length;e++){var f=b.layers[e],l=g.LayerInfo.fromGcxLayer(f);l.serviceLayerInfo=a;f.type===d.essentials.LayerType.TABLE_LAYER?a.tables.push(l):a.layers.push(l)}for(e=0;e<b.tables.length;e++)f=g.LayerInfo.fromGcxLayer(b.tables[e]),f.serviceLayerInfo=a,a.tables.push(f);
return a};c.prototype.findLayerById=function(b){for(var a=0,e=this.layers.length;a<e;a++){var c=this.layers[a];if(b===c.id.toString())return c}return null};c.prototype.isVisible=function(){var b=!1;this.serviceLayer&&"boolean"===typeof this.serviceLayer.visible&&(b=this.serviceLayer.visible);return b};c.prototype.setVisibility=function(b){this.gcxMapService?this.gcxMapService.setVisibility(b):null!==this.serviceLayer&&this.serviceLayer.setVisibility(b)};c.prototype.opacity=function(){return this.gcxMapService?
this.gcxMapService.opacity:this.serviceLayer?this.serviceLayer.opacity:null};c.prototype.setOpacity=function(b){if(this.gcxMapService)this.gcxMapService.setOpacity(b);else if(this.serviceLayer){if(null==b||isNaN(b))b=1;b=Math.min(1,Math.max(0,b));this.serviceLayer.setOpacity(b)}};c.prototype.refresh=function(b,a){var e=this,c=this.serviceLayer;if(c&&"function"===typeof c.refresh){var d=function(){e._delayedRefreshToken=null;if(!0===a&&"function"===typeof c.setDisableClientCaching){var a=c.disableClientCaching;
c.setDisableClientCaching(!0);c.refresh();c.setDisableClientCaching(a)}else c.refresh()};this._delayedRefreshToken&&clearTimeout(this._delayedRefreshToken);"number"!==typeof b?d():this._delayedRefreshToken=setTimeout(d,b)}};c.prototype.supportsLayerVisibility=function(){switch(this.serviceType){case d.essentials.MapServiceType.WMS:return!0;case d.essentials.MapServiceType.DYNAMIC:return null!==this.serviceLayer&&!!this.serviceLayer.visibleLayers;default:return!1}};c.prototype.loaded=function(){var b=
this;if(this._loadedDeferred)return this._loadedDeferred;this._loadedDeferred=new dojo.Deferred;if(this.serviceLayer.loaded)this._loadedDeferred.resolve(this.serviceLayer);else if(this.serviceLayer.loadError)this._loadedDeferred.resolve(this.serviceLayer.loadError);else var a=this.serviceLayer.on("load",function(){a.remove();e.remove();b._loadedDeferred.resolve(b.serviceLayer)}),e=this.serviceLayer.on("error",function(c){a.remove();e.remove();b._loadedDeferred.errback(c)});return this._loadedDeferred};
return c}();g.ServiceLayerInfo=h})(h.gis||(h.gis={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(){function c(b,a){this.id=new Observable("");this.parent=this.children=null;b&&this.id.set(b);a&&(this.parent=a)}c.prototype.getRoot=function(){for(var b=this;null!=b.parent;)b=b.parent;return b};c.prototype.getAncestors=function(){var b=null;if(this.parent)for(var b=[],a=this.parent;null!=a;)b.push(a),a=a.parent;return b};c.prototype.getSelfAndAncestors=function(){var b=this.getAncestors(),b=b&&b.length?b:[];b.unshift(this);
return b};c.prototype.getSiblings=function(b){void 0===b&&(b=!1);var a=null;if(this.parent&&this.parent.children&&(a=this.parent.children.get(),!b))for(a=a.slice(0),b=0;b<a.length;b++)if(a[b]===this){a.splice(b,1);break}return a};c.prototype.getDescendants=function(){if(this.children){for(var b=[],a=this.children.get(),e=0;e<a.length;e++){var c=a[e];b.push(c);for(var c=c.getDescendants(),d=0;d<c.length;d++)b.push(c[d])}return b}};c.prototype.getSelfAndDescendants=function(){var b=this.getDescendants(),
b=b&&b.length?b:[];b.unshift(this);return b};return c}();d.LayerListNode=h})(d.layerList||(d.layerList={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var k=function(c){function b(a,b,f,l){var g=this;c.call(this,"GCXLayerListRootNode-".concat(d.framework.utils.alphaNumericToken()));this.layerListInitialized=!1;this.layerListInitializationFailure=null;this.onLayerListInitializationFailed=function(a){};this.onLayerListInitialized=function(a){};this.autoActivateAncestorVisibilities=this.onlyShowSwatchesOnVisibleLayers=this.enableLegendIntegration=!1;this._addedFolderReferences=[];this._handledMapServiceReferences=
[];this._allMapServiceReferences=[];this._outOfFolderMapServiceReferences=[];this._initializing=!1;this._groupByOperationalAndBase=!0;this._layerListRestEndpoint=null;this._suspendMapUpdates=!1;if(!a||!a.mapInfo)throw Error("LayerList: Initialization failed. AppInfo/MapInfo cannot be null");this.appInfo=a;this.mapInfo=a.mapInfo;this.url=b||"";this._libraryId="Mapping.Infrastructure";this._layerListRestEndpoint=f||null;this.enableLegendIntegration=l&&void 0!=l.enableLegendIntegration?l.enableLegendIntegration:
!1;this.onlyShowSwatchesOnVisibleLayers=l&&void 0!=l.onlyShowSwatchesOnVisibleLayers?l.onlyShowSwatchesOnVisibleLayers:!1;this.autoActivateAncestorVisibilities=l&&void 0!=l.autoActivateAncestorVisibilities?l.autoActivateAncestorVisibilities:!1;this._groupByOperationalAndBase=l&&void 0!=l.groupByOperationalAndBase?l.groupByOperationalAndBase:!0;this.enableLayerIcons=l&&void 0!=l.enableLayerIcons?l.enableLayerIcons:!1;this.serviceLoadFailureIconUri=l?l.serviceLoadFailureIconUri||"":"";this.serviceLoadFailureIconTooltip=
l?l.serviceLoadFailureIconTooltip||"":"";this.multiLegendSwatchElement=l?l.multiLegendSwatchElement||"":"";this.singleLegendIconTooltip=l?l.singleLegendIconTooltip||"":"";this.multiLegendIconTooltip=l?l.multiLegendIconTooltip||"":"";dojo.connect(this.mapInfo.gcxMap.layerThemesInfo,"layerThemeChangingEvent",dojo.hitch(this,function(){return g.suspendMapUpdates=!0}));dojo.connect(this.mapInfo.gcxMap.layerThemesInfo,"layerThemeChangedEvent",dojo.hitch(this,function(){return g.suspendMapUpdates=!1}))}
__extends(b,c);Object.defineProperty(b.prototype,"suspendMapUpdates",{get:function(){return this._suspendMapUpdates},set:function(a){a!==this._suspendMapUpdates&&((this._suspendMapUpdates=a)?this._enableDeferredItemVisibilities(this.children.get()):this._applyDeferredItemVisibilities(this.children.get()))},enumerable:!0,configurable:!0});b.prototype.initialize=function(){this.layerListInitialized||this._initializing||(this._initializing=!0,this.children=new g.LayerListItemCollection(null),this.children.layerList=
this,this._layerListRestEndpoint?this._layerListInitializationHandler(this._layerListRestEndpoint):this.url&&this.appInfo.essentialsVersion&&4.02<=this.appInfo.essentialsVersion?d.request({url:this.url,content:{f:"json"},load:dojo.hitch(this,this._layerListInitializationHandler),error:dojo.hitch(this,this._layerListInitializationErrorHandler),callbackParamName:"CallBack"}):this._layerListInitializationHandler(null))};b.prototype.addUserAddedServiceLayer=function(a,b){var c=a;if(!this.layerListInitialized)return!1;
if(!(c instanceof h.gis.ServiceLayerInfo))if(c instanceof d.essentials.MapService)c=h.gis.ServiceLayerInfo.fromGcxMapService(c);else if(c instanceof esri.layers.Layer)c=h.gis.ServiceLayerInfo.fromEsriLayer(c);else return this.appInfo.gcxApp.trace.error("addUserAddedServiceLayer: Could not add layer. Invalid layer type."),!1;c.isUserCreated=!0;return(c=this._generateLayerListItemsFromServiceLayer(c,this,!0))&&c.length?null!==b&&void 0!==b?this._addItemsToUserAddedFolder(c,b):this._addItemsToUserAddedFolder(c):
!1};b.prototype.removeServiceLayer=function(a){if(!this.layerListInitialized)return!1;if(!(a instanceof esri.layers.Layer))if(a instanceof d.essentials.MapService||a instanceof h.gis.ServiceLayerInfo)a=a.serviceLayer;else return this.appInfo.gcxApp.trace.error("removeServiceLayer: Could not remove layer. Invalid layer type."),!1;var b=this.getDescendants();if(b.length){for(var c=0;c<b.length;c++){var l=b[c];if(l.mapService&&l.mapService.serviceLayer===a&&this._isItemSafeToBeRemoved(l,a)){var k=l.parent;
k?(k.children.removeItem(l),k instanceof g.LayerListItem&&k.refreshOnDemandItemCollection()):this.children.removeItem(l)}}return!0}return!1};b.prototype._isItemSafeToBeRemoved=function(a,b){if(a.type===g.LayerListItemType.MAPSERVICE||a.type===g.LayerListItemType.LAYER||a.type===g.LayerListItemType.GRAPHICSLAYER)return!0;if(a.children&&0!=a.children.length()){var c=a.getDescendants();if(c&&0<c.length)for(var d=0;d<c.length;d++)if((c[d].type===g.LayerListItemType.LAYER||c[d].type===g.LayerListItemType.GRAPHICSLAYER||
c[d].type===g.LayerListItemType.MAPSERVICE)&&c[d].mapService&&c[d].mapService.serviceLayer!=b)return!1}return!0};b.prototype.updateServiceLayer=function(a,b,c){if(!this.layerListInitialized||!a)return!1;b=b||[];c=c||[];var l;if(a instanceof d.essentials.MapService)l=h.gis.ServiceLayerInfo.fromGcxMapService(a);else if(a instanceof h.gis.ServiceLayerInfo)l=a;else return this.appInfo.gcxApp.trace.error("updateServiceLayer: Could not update layer. Invalid layer type."),!1;a=this.getDescendants();if(!a.filter(function(a){return a.mapService&&
a.mapService&&a.mapService.gcxMapService===l.gcxMapService}).length)return this.addUserAddedServiceLayer(l);if(c&&c.length){a=this.getDescendants();for(var k=0;k<a.length;k++){var m=a[k];if(m.type===g.LayerListItemType.LAYER){var p=m.layer&&m.layer.gcxLayer?m.layer.gcxLayer:null;p&&p.isUserCreated&&0<=c.indexOf(p)&&((p=m.parent)?(p.children.removeItem(m),p instanceof g.LayerListItem&&p.refreshOnDemandItemCollection()):(this.children.removeItem(m),this.children.pulse()))}}}if(b&&b.length){a=this.getDescendants();
c=[];for(k=0;k<b.length;k++){var m=b[k],q=l.findLayerById(m.id);q||(q=h.gis.LayerInfo.fromGcxLayer(m),q.serviceLayerInfo=l,l.layers.push(q));a.filter(function(a){return a.layer&&a.layer.gcxLayer===q.gcxLayer}).length||(m=new g.LayerListLayerItem(q.id,q,this,g.LayerListItemType.LAYER),c.push(m))}if(c.length)return this._addItemsToUserAddedFolder(c)}return!1};b.prototype.updateServiceLayerLegendSwatch=function(a){if(!this.layerListInitialized)return!1;var b=a.serviceLayer;if(!b)return this.appInfo.gcxApp.trace.error("updateServiceLayerLegendSwatch: Could not update layer swatch. Invalid layer type."),
!1;a=this.getDescendants().filter(function(a){return a.mapService&&a.mapService.serviceLayer.id===b.id});if(0<a.length){for(var c=0;c<a.length;c++){var d=a[c];d&&d instanceof g.LayerListLayerItem&&d.updateLegendItems()}return!0}return!1};b.prototype.getUserAddedLayersFolderIndex=function(a){if(!this.layerListInitialized)return null;if(!(a instanceof esri.layers.Layer))if(a instanceof d.essentials.MapService||a instanceof h.gis.ServiceLayerInfo)a=a.serviceLayer;else return this.appInfo.gcxApp.trace.error("removeServiceLayer: Could not remove layer. Invalid layer type."),
null;var b=this._userAddedLayersFolder||this;if(b.children&&b.children.length)for(var b=b.children.get(),c=0;c<b.length;c++){var l=b[c];if(l.mapService&&l.mapService.serviceLayer===a)return c}return null};b.prototype._applyDeferredItemVisibilities=function(a){var b=this;dojo.forEach(a,function(a){a._applyDeferredInitialVisibility();a.children&&a.children.length()&&b._applyDeferredItemVisibilities(a.children.get())})};b.prototype._enableDeferredItemVisibilities=function(a){var b=this;a.forEach(function(a){d.framework.utils.isNullOrUndefined(a._deferredVisibilitySetting)&&
(a._deferredVisibilitySetting=a.isVisible.get());b._enableDeferredItemVisibilities(a.children.get())})};b.prototype._layerListInitializationErrorHandler=function(a){this.layerListInitializationFailure=a;if(this.onLayerListInitializationFailed)this.onLayerListInitializationFailed(a);this._initializing=!1};b.prototype._layerListInitializationHandler=function(a){var b=this,c=function(){b.layerListInitialized=!0;b._initializing=!1;b._processEligibleSingleMapServiceFolders();b._processUnhandledMapServices();
b._setupOpacityBindingsForParentsOfHiddenItemsWithOpacityBindings();b._applyInitialLayerTheme();b._applyDeferredItemVisibilities(b.children.get());if(b.onLayerListInitialized)b.onLayerListInitialized(b)};a?this._configureLayerListFromRestResponse(a,c,this._layerListInitializationErrorHandler):this._configureLayerListFromMapInfo(this.mapInfo,c,this._layerListInitializationErrorHandler)};b.prototype._configureLayerListFromMapInfo=function(a,b,c){if(a){if(a.gcxMap&&a.serviceLayers.length&&void 0!=a.serviceLayers[0].serviceLayerFunction&&
this._groupByOperationalAndBase)var d=new g.LayerListFolderItem(this.id.get()+":Operational",this.appInfo.gcxApp.getResource(this._libraryId,"language-layerlist-operational-maps-folder-title"),this),h=new g.LayerListFolderItem(this.id.get()+":Base",this.appInfo.gcxApp.getResource(this._libraryId,"language-layerlist-base-maps-folder-title"),this);try{for(var k=0;k<a.serviceLayers.length;k++){var m=a.serviceLayers[k],q=this._generateLayerListItemsFromServiceLayer(m,this);if(q&&q.length)if(this._groupByOperationalAndBase)switch(m.serviceLayerFunction){case "Operational":d.children.addItems(q);
break;case "Base":h.children.addItems(q);break;default:throw Error("ServiceLayerFunction undefined or not recognized: {0}".format(m.serviceLayerFunction));}else this.children.addItems(q)}this._groupByOperationalAndBase&&(d.children.length()&&(this._generateThemeSettingsForCoreFolder(d),this.children.addItem(d),d.isExpanded.set(!0),d.isVisible.set(!0),d.configuredVisible=!0),h.children.length()&&(this._generateThemeSettingsForCoreFolder(h),this.children.addItem(h),h.isExpanded.set(!0),h.isVisible.set(!0),
h.configuredVisible=!0))}catch(t){console.error("Layer List Configuration Error: {0}".format(t&&t.message||"Unknown Error"));c(t);return}b()}else this._layerListInitializationErrorHandler(Error("Error initializing layer list from MapInfo."))};b.prototype._configureLayerListFromRestResponse=function(a,b,c){try{if(!a||!a.items)throw Error("Layer list failed to load (general data failure).");this._userAddedLayersDestinationId=a.userAddedLayersDestinationId;for(var d=0,g=a.items;d<g.length;d++){var h=
this._createLayerListItemFromRestResult(g[d],this);h&&this.children.addItem(h)}}catch(k){k.name="LayerListConfigurationError/"+k.name;this._layerListInitializationErrorHandler(k);c(k);return}b()};b.prototype._generateLayerListItemsFromServiceLayer=function(a,b,c){var d=this;void 0===c&&(c=!1);var h=[],k=null,m=function(b,e){var c=b.subLayerIds||[];if(0<c.length)for(var f=0;f<c.length;f++){var h=a.findLayerById(c[f]);if(h&&(h.processed=!0,h.includeInLayerList)){var k=new g.LayerListLayerItem(h.id,
h,d);q(k);e.children.addItem(k);m(h,k)}}e.isExpanded.set(b.isExpanded&&!(!b.subLayerIds||!b.subLayerIds.length))},q=function(a){a&&c&&(a.unbindFromActiveTheme(),a.inActiveTheme.set(!0))};a.includeInLayerList&&(k=new g.LayerListMapServiceItem(a.id,a,this),q(k));a.serviceLayer instanceof esri.layers.GraphicsLayer&&1===a.layers.length?(k=this._handleGraphicsLayerItem(a,k),q(k&&k.children.length()?k.children.getAt(0):k)):a.layers.length&&(dojo.forEach(a.layers,function(a){if((a.includeInLayerList||a.isUserCreated)&&
!a.processed){var b=new g.LayerListLayerItem(a.id,a,d);q(b);k?k.children.addItem(b):h.push(b);m(a,b)}}),k&&k.isExpanded.set(a.isExpanded&&!!a.layers.length));k&&(h.push(k),b&&(k.parent=b));return h};b.prototype._handleGraphicsLayerItem=function(a,b){var c=b;if(a.layers[0].includeInLayerList||a.layers[0].isUserCreated){var d=a.layers[0],h=new g.LayerListGraphicsLayerItem(d.id,a.layers[0],this);h.isExpanded.set(d.isExpanded&&!(!d.subLayerIds||!d.subLayerIds.length));c?(c.isVisible.set(h.isVisible.get()),
h.isVisible.set(!0),h.canNotAssignVisibility.set(!0),c.children.addItem(h),c.isExpanded.set(a.isExpanded&&!!a.layers.length)):c=h}return c};b.prototype._createLayerListItemFromRestResult=function(a,b){var c=this,d=null,h=function(b){console.error("Layer List Error: {0} with ID: {1} not available. Excluding from layer list. Please check your security settings.".format(b===g.LayerListItemType.MAPSERVICE?"MapService":b===g.LayerListItemType.LAYER?"Map Layer":"Object",a.mapServiceID))};switch(a.type){case "folder":d=
new g.LayerListFolderItem(a.id,a.name,this);a.items&&a.items.length&&this._subItemIncludedInLayerList(a.items)||(d.displayItem.set(!1),d.isExpanded.set(!1));this._userAddedLayersDestinationId&&a.id===this._userAddedLayersDestinationId&&(this._userAddedLayersFolder=d);break;case "mapService":var k=this.mapInfo.findMapServiceById(a.mapServiceID);k||h(g.LayerListItemType.MAPSERVICE);k&&k.includeInLayerList&&(d=new g.LayerListMapServiceItem(a.id,k,this));break;case "layer":(k=this.mapInfo.findMapServiceById(a.mapServiceID))||
h(g.LayerListItemType.MAPSERVICE);if(k){var m=k.findLayerById(a.layerID);m||h(g.LayerListItemType.LAYER);m&&m.includeInLayerList&&(d=k.serviceLayer instanceof esri.layers.GraphicsLayer?new g.LayerListGraphicsLayerItem(a.id,m,this):new g.LayerListLayerItem(a.id,m,this))}break;default:throw Error("Unknown layer list item type. Reported type: {0}".format(a.type));}d&&(b&&(d.parent=b),null!=a.items&&a.items.length&&dojo.forEach(a.items,function(a){(a=c._createLayerListItemFromRestResult(a,d))&&d.children.addItem(a)}),
this._processItem(d,a));return d};b.prototype._subItemIncludedInLayerList=function(a){for(var b=0;b<a.length;b++){var c;c=a[b];if("folder"===c.type)c=c.items&&c.items.length?this._subItemIncludedInLayerList(c.items):!1;else if("mapService"===c.type){var d=this.mapInfo.findMapServiceById(c.mapServiceID);c=d?!!d.includeInLayerList:!1}else"layer"===c.type?(d=this.mapInfo.findMapServiceById(c.mapServiceID),c=(c=d.findLayerById(c.layerID))?!!c.includeInLayerList:!1):c=void 0;if(c)return!0}return!1};b.prototype._processItem=
function(a,b){if(a.type===g.LayerListItemType.FOLDER){if(this.mapInfo.gcxMap&&b.themeSettings&&b.themeSettings.length)for(var c=0;c<b.themeSettings.length;c++){var l=b.themeSettings[c],h=this.mapInfo.gcxMap.layerThemesInfo.getTheme(l.themeID);h&&a.layerThemeSettings.push(new d.essentials.LayerThemeSetting(h,void 0!=l.visible?l.visible:b.isVisible))}if(a.id.get()===this._userAddedLayersDestinationId)for(c=0;c<this.mapInfo.gcxMap.layerThemesInfo.themes.length;c++)a.layerThemeSettings.push(new d.essentials.LayerThemeSetting(this.mapInfo.gcxMap.layerThemesInfo.themes[c],
!0));a._deferredVisibilitySetting=b.isVisible;a.isVisible.set(b.isVisible);a.configuredVisible=b.isVisible;a.isExpanded.set(b.isExpanded&&!(!b.items||!b.items.length));this._disableFolderIfParentTiled(a)}a.type===g.LayerListItemType.MAPSERVICE&&a.isExpanded.set(a.mapService.isExpanded);a.type===g.LayerListItemType.LAYER&&a.isExpanded.set(a.layer.isExpanded&&!(!a.layer.subLayerIds||!a.layer.subLayerIds.length));a.type===g.LayerListItemType.FOLDER&&(c=b.iconUri)&&(this.mapInfo.gcxMap&&this.mapInfo.gcxMap.site&&
(c=d.essentials.RestHelper.processClientSideTokens(this.mapInfo.gcxMap.site,c)),a.iconUri.set(c),a.iconTooltip.set(a.name.get()));a.canDisplayItem.set(!1!==b.isVisibleInLayerList);if(b.layerVisibilityType===g.LayerVisibilityType.MutuallyExclusive&&b.items&&1<b.items.length)for(c=d.framework.utils.alphaNumericToken(32),l=0;l<a.children.length();l++)a.children.getAt(l).isMutuallyExclusive.set(!0),a.children.getAt(l).hasRadioToggle.set(!0),a.children.getAt(l).radioGroup.set(c)};b.prototype._disableFolderIfParentTiled=
function(a){for(var b=a.parent;b&&b.id!==this.id&&(b.type===g.LayerListItemType.MAPSERVICE||b.type===g.LayerListItemType.FOLDER);){if(b.type===g.LayerListItemType.FOLDER&&b.canNotAssignVisibility.get()||b.type===g.LayerListItemType.MAPSERVICE&&b.mapService.serviceType===d.essentials.MapServiceType.TILED){a.canNotAssignVisibility.set(!0);break}b=b.parent}};b.prototype._generateThemeSettingsForCoreFolder=function(a,b){void 0===b&&(b=!1);if(b){if(this.mapInfo.gcxMap&&this.mapInfo.gcxMap.layerThemesInfo.layerThemesConfigured)for(var c=
this.mapInfo.gcxMap.layerThemesInfo.themes,l=0;l<c.length;l++)a.layerThemeSettings.push(new d.essentials.LayerThemeSetting(c[l],!0));a.inActiveTheme.set(!0)}else for(var c={},l=0,h=a.children.length();l<h;l++){var k=a.children.getAt(l),m=null;switch(k.type){case g.LayerListItemType.FOLDER:m=k.layerThemeSettings;break;case g.LayerListItemType.MAPSERVICE:m=k.mapService.gcxMapService?k.mapService.gcxMapService.layerThemeSettings:null;break;case g.LayerListItemType.LAYER:case g.LayerListItemType.GRAPHICSLAYER:m=
k.layer.gcxLayer?k.layer.gcxLayer.layerThemeSettings:null}if(m&&m.length)for(k=0;k<m.length;k++){var q=m[k].theme.id;void 0==c[q]&&(a.layerThemeSettings.push(new d.essentials.LayerThemeSetting(m[k].theme,!0)),c[q]=!0)}}};b.prototype._applyInitialLayerTheme=function(){this.mapInfo.gcxMap&&this.mapInfo.gcxMap.layerThemesInfo.layerThemesConfigured&&this.mapInfo.gcxMap.applyStartupTheme()};b.prototype._processEligibleSingleMapServiceFolders=function(){for(var a=this._handledMapServiceReferences.slice(0),
b=this._getFoldersContainingSingleMapService(),b=this._filterEligibleSingleMsFolders(b),b=this._selectDeepestLevelSingleMapServiceFolders(b),c=0;c<b.length;c++){var d=b[c];d.containedMapServices[0].serviceLayer instanceof esri.layers.GraphicsLayer||-1!==a.indexOf(d.containedMapServices[0])||-1!==this._outOfFolderMapServiceReferences.indexOf(d.containedMapServices[0])||(d.linkWithMapService(d.containedMapServices[0]),a.push(d.containedMapServices[0]))}};b.prototype._setupOpacityBindingsForParentsOfHiddenItemsWithOpacityBindings=
function(){for(var a=this.getDescendants(),a=dojo.filter(a,function(a){return a.canAdjustOpacity.get()}),b=0;b<a.length;b++){var c=a[b];if(!this.isEffectivelyDisplayed(c)){for(c=c.parent;c instanceof g.LayerListItem&&!this.isEffectivelyDisplayed(c);)c=c.parent;c instanceof g.LayerListItem&&c._setupOpacityBindings()}}};b.prototype.isEffectivelyDisplayed=function(a){return a.displayItem.get()?a.parent instanceof g.LayerListItem?this.isEffectivelyDisplayed(a.parent):!0:!1};b.prototype._getFoldersContainingSingleMapService=
function(){for(var a=[],b=0;b<this._addedFolderReferences.length;b++)1===this._addedFolderReferences[b].containedMapServices.length&&a.push(this._addedFolderReferences[b]);return a};b.prototype._filterEligibleSingleMsFolders=function(a){var b=this;if(a){for(var c=[],d=this._filterTopLevelFolders(a),g=0;g<a.length;g++){var h=a[g],k=dojo.filter(this._addedFolderReferences,function(a){return a.id!==h.id&&0<a.containedMapServices.length&&-1!==a.containedMapServices.indexOf(h.containedMapServices[0])})||
[],m=k.filter(function(a){return 1<a.containedMapServices.length})||[];this._noChildItemsWithMapService(h.containedMapServices[0],m)&&this._allFoldersAncestorsOrDescendantsOf(h,k)&&(d.some(function(a){return a.containedMapServices[0]===h.containedMapServices[0]&&!b._allFoldersAncestorsOf(h,[a])&&h.id!==a.id})||c.push(h))}return c}};b.prototype._filterTopLevelFolders=function(a){return this.children.get().filter(function(b){return b.type===h.layerList.LayerListItemType.FOLDER&&-1!==a.indexOf(b)})};
b.prototype._selectDeepestLevelSingleMapServiceFolders=function(a){if(a){for(var b=[],c=[],d=0;d<a.length;d++){var g=a[d];if(-1===c.indexOf(g.containedMapServices[0])){var h=dojo.filter(a,function(a){return a.id!==g.id&&-1!==a.containedMapServices.indexOf(g.containedMapServices[0])})||[];if(h.length){var k=g,m;for(m=0;m<h.length;m++)if(this._onlyFolderItems(k.children.get())&&this._allFoldersDescendantsOf(k,h.slice(m))){if(1<k.children.length())break;k=h[m]}else{k=1<=m?h[m-1]:k;break}this._allFoldersDescendantsOf(k,
h.slice(m))&&(b.push(k),c.push(k.containedMapServices[0]))}else b.push(g),c.push(g.containedMapServices[0])}}return b}};b.prototype._allFoldersDescendantsOf=function(a,b){for(var c=0;c<b.length;c++){var d=b[c].getAncestors();if(!d||-1===d.indexOf(a))return!1}return!0};b.prototype._allFoldersAncestorsOf=function(a,b){var c=a.getAncestors();if(c){for(var d=0;d<b.length;d++)if(-1===c.indexOf(b[d]))return!1;return!0}return!1};b.prototype._allFoldersAncestorsOrDescendantsOf=function(a,b){var c=Array.prototype.concat(a.getAncestors()||
[],a.getDescendants()||[]);if(c){for(var d=0;d<b.length;d++)if(-1===c.indexOf(b[d]))return!1;return!0}return!1};b.prototype._noChildItemsWithMapService=function(a,b){for(var c=0;c<b.length;c++)for(var d=b[c].children.get(),g=0;g<d.length;g++)if(d[g].mapService&&d[g].mapService===a)return!1;return!0};b.prototype._onlyFolderItems=function(a){for(var b=0;b<a.length;b++)if(a[b].type!==h.layerList.LayerListItemType.FOLDER)return!1;return!0};b.prototype._processUnhandledMapServices=function(){var a=this;
dojo.filter(this._allMapServiceReferences,function(b){return-1===a._handledMapServiceReferences.indexOf(b)}).forEach(function(a){if(a.serviceLayer instanceof esri.layers.ArcGISDynamicMapServiceLayer||a.serviceLayer instanceof esri.layers.WMSLayer)a.serviceLayer.on("visibility-change",function(b){b.visible?a._esriLayerStateBackup&&(a.serviceLayer.setVisibleLayers(a._esriLayerStateBackup),a._esriLayerStateBackup=null):a.serviceLayer instanceof esri.layers.ArcGISDynamicMapServiceLayer?(a._esriLayerStateBackup=
a.serviceLayer.visibleLayers?a.serviceLayer.visibleLayers.slice(0):[-1],a.serviceLayer.setVisibleLayers(["-1"])):(a._esriLayerStateBackup=a.serviceLayer.visibleLayers?a.serviceLayer.visibleLayers.slice(0):[],a.serviceLayer.setVisibleLayers([]))})})};b.prototype._addItemsToUserAddedFolder=function(a,b){var c=this._userAddedLayersFolder||this;if(a[0].type===g.LayerListItemType.LAYER&&this.children.getLength()){var d=a[0].layer.gcxLayer;if(d&&d.catalogId)for(var h=this._addedFolderReferences,k=0;k<h.length;k++){var m=
h[k];if(m.canAdjustOpacity&&m.mapService&&m.mapService.gcxMapService===d.mapService){c=m;break}}}var q=b||0,d=a.reduceRight(function(a,b,e){return c.children.validateAndInsertItem(q,b)&&a},!0);c===this._userAddedLayersFolder?(this._userAddedLayersFolder.inActiveTheme.set(!0),this._userAddedLayersFolder.displayItem.set(!0),this._userAddedLayersFolder.isExpanded.set(!0),this._userAddedLayersFolder.isVisible.set(!0),this._userAddedLayersFolder.parent instanceof g.LayerListFolderItem&&this._userAddedLayersFolder.parent.refreshOnDemandItemCollection()):
c instanceof g.LayerListFolderItem&&c.refreshOnDemandItemCollection();this._applyDeferredItemVisibilities(c.children.get());return d};return b}(g.LayerListNode);g.LayerList=k})(h.layerList||(h.layerList={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){(function(b){b[b.FOLDER=0]="FOLDER";b[b.MAPSERVICE=1]="MAPSERVICE";b[b.LAYER=2]="LAYER";b[b.GRAPHICSLAYER=3]="GRAPHICSLAYER";b[b.KMLFOLDER=4]="KMLFOLDER"})(g.LayerListItemType||(g.LayerListItemType={}));var k=g.LayerListItemType,c=function(b){function a(a,c,d){var h=this;b.call(this,a);this._themeChangedHandle=this._themeChangingHandle=this._opacityChangeHandle=this.opacity=this.mapService=null;if(!a)throw Error("LayerListItem: Initialization failed. Layer list item id cannot be null");
if(!d)throw Error("LayerListItem: Initialization failed. LayerList cannot be null");this.type=c;this.layerList=d;this.allAncestorsVisible=!0;this.isVisible=new Observable(!1);this.isEffectivelyVisible=new Observable(!1);this.parentEffectivelyVisible=new Observable(!0);this.inVisibleScaleRange=new Observable(!0);this.isEffectivelyVisible.syncTransform(this.isVisible,function(a){return a&&!!h.allAncestorsVisible});this.name=new Observable("");this.isExpanded=new Observable(!1);this.expandLegend=new Observable(!1);
this.canNotAssignVisibility=new Observable(!1);this.canAdjustOpacity=new Observable(!1);this.inActiveTheme=new Observable(!0);this.canDisplayItem=new Observable(!0);this.displayItem=new Observable(!0);this.hasDisplayedChildren=new Observable(!1);this.children=new g.LayerListItemCollection(this);this.onDemandItemCollection=new ObservableCollection([]);this.legendItems=new ObservableCollection([]);this.legendSwatch=new Observable("");this.legendHasMultipleItems=new Observable(!1);this.enableMapServiceActions=
this.enableLayerActions=!1;this.iconUri=new Observable("");this.iconTooltip=new Observable("");this.legendTooltip=new Observable("");this.layerFolderToggleTooltip=new Observable("");this.layerActionsTooltip=new Observable("");this.layerToggleTooltip=new Observable("");this.mapServiceActionsTooltip=new Observable("");this.isMutuallyExclusive=new Observable(!1);this.hasRadioToggle=new Observable(!1);this.radioGroup=new Observable("");this.isVisible.bind(this,this.setVisibility);this.isExpanded.bind(this,
this.refreshOnDemandItemCollection);this.inActiveTheme.bind(this,this._onActiveThemeChanged);this.canDisplayItem.bind(this,this._updateDisplayItem);this.currentUserClickOriginator=!1;this.legendIsVisible=new Observable(!1);this.layerList.onlyShowSwatchesOnVisibleLayers&&(this.isEffectivelyVisible.bind(this,this._processLegendVisibility),this.inVisibleScaleRange.bind(this,this._processLegendVisibility),this.legendItems.bind(this,this._processLegendVisibility));this.legendSwatch.bind(this,function(a){h.layerList.enableLegendIntegration&&
h._processLegendVisibility()});this.layerList&&this.layerList.mapInfo&&this.layerList.mapInfo.gcxMap&&this.layerList.mapInfo.gcxMap.layerThemesInfo&&(this._themeChangingHandle=dojo.connect(this.layerList.mapInfo.gcxMap.layerThemesInfo,"layerThemeChangingEvent",dojo.hitch(this,this._handleLayerThemeChangingEvent)),this._themeChangedHandle=dojo.connect(this.layerList.mapInfo.gcxMap.layerThemesInfo,"layerThemeChangedEvent",dojo.hitch(this,this._handleLayerThemeChangedEvent)))}__extends(a,b);a.prototype.bindToActiveTheme=
function(){};a.prototype.unbindFromActiveTheme=function(){};a.prototype.cleanUp=function(){this._opacityChangeHandle&&(this._opacityChangeHandle.remove(),this._opacityChangeHandle=null);this._themeChangingHandle&&(dojo.unsubscribe(this._themeChangingHandle),this._themeChangingHandle=null);this._themeChangedHandle&&(dojo.unsubscribe(this._themeChangedHandle),this._themeChangedHandle=null);this.unbindFromActiveTheme()};a.prototype.notifyActiveThemeChanged=function(a){a&&!this.inActiveTheme.get()&&this.inActiveTheme.set(!0);
this.type===k.FOLDER&&!a&&this.inActiveTheme.get()&&this.children&&dojo.every(this.children.get(),function(a){return!a.inActiveTheme.get()})&&this.inActiveTheme.set(!1)};a.prototype.setItemVisibility=function(a){this.currentUserClickOriginator=!0;this.isVisible.set(a)};a.prototype.setVisibility=function(a){if(void 0!==this.allAncestorsVisible)if(void 0!=this._deferredVisibilitySetting)this._deferredVisibilitySetting=a;else if(a&&this.isMutuallyExclusive.get()&&this.parent&&!this.layerList.mapInfo.gcxMap.layerThemesInfo.themeChangeInProgress)for(a=
0;a<this.parent.children.length();a++){var b=this.parent.children.getAt(a);b!==this&&b.isVisible.get()&&b.isVisible.set(!1)}};a.prototype.setAncestorVisibility=function(a){this.allAncestorsVisible=a;this.isVisible.pulse()};a.prototype.refreshOnDemandItemCollection=function(a){a=void 0==a?this.isExpanded.get():a;this.onDemandItemCollection.clear();if(this.children&&this.children.length()&&a){a=0;for(var b=this.children.length();a<b;a++){var c=this.children.getAt(a);this.displayInLayerList(c)&&this.onDemandItemCollection.addItem(c)}}};
a.prototype.populateMapServicesInParentFolders=function(){var a=this;if(this.type!==h.layerList.LayerListItemType.FOLDER&&this.mapService){for(var b=[],c=this.parent,d=!0;c;){if(c.type===h.layerList.LayerListItemType.MAPSERVICE&&c.mapService===this.mapService)return;c.type===h.layerList.LayerListItemType.FOLDER&&(d=!1,-1===c.containedMapServices.indexOf(this.mapService)&&-1===c.id.get().indexOf(this.layerList.id.get())&&b.push(c));c=c.parent}d?this.layerList._outOfFolderMapServiceReferences.push(this.mapService):
dojo.forEach(b,function(b){b.containedMapServices.push(a.mapService)})}};a.prototype.displayInLayerList=function(a){void 0===a&&(a=this);if(!a.inActiveTheme.get())return!1;if(a.type!==h.layerList.LayerListItemType.FOLDER)return a.canDisplayItem.get();var b=!1;if(a.children&&a.children.length())for(var c=0,d=a.children.length();c<d;c++){var g=a.children.getAt(c);if(this.displayInLayerList(g))return!0;if(g.inActiveTheme.get()&&!g.canDisplayItem.get()){b=!0;break}}return b&&a.canDisplayItem.get()};a.prototype._applyDeferredInitialVisibility=
function(){if(void 0!=this._deferredVisibilitySetting&&!this.layerList.suspendMapUpdates){var a=this._deferredVisibilitySetting;delete this._deferredVisibilitySetting;this.setVisibility(a)}};a.prototype._setupOpacityBindings=function(){var a=this;this.type!==h.layerList.LayerListItemType.LAYER&&this.type!==h.layerList.LayerListItemType.GRAPHICSLAYER&&this.mapService&&this.mapService.serviceLayer&&void 0!=this.mapService.serviceLayer.opacity&&void 0!=this.mapService.serviceLayer.setOpacity&&this.mapService.serviceType!==
d.essentials.MapServiceType.FEATURE&&(this.canAdjustOpacity.set(!0),this.opacity=new Observable(this.mapService.serviceLayer.opacity),this.opacity.bind(this,function(b){a.mapService.setOpacity(b)}),this._opacityChangeHandle=this.mapService.serviceLayer.on("opacity-change",function(b){a.mapService.gcxMapService&&b.opacity===a.mapService.gcxMapService.opacity*a.mapService.gcxMapService.opacityFilter||a.opacity.set(b.opacity)}))};a.prototype._handleLayerThemeChangingEvent=function(a){this._processLegendVisibility()};
a.prototype._handleLayerThemeChangedEvent=function(a){this._processLegendVisibility()};a.prototype._updateDisplayItem=function(){this.displayItem.set(this.displayInLayerList());var a=this.getSiblings(!0);if(a&&a.length){for(var b=0,c=0;c<a.length;c++){var d=a[c];d.displayItem.get()&&b++}for(c=0;c<a.length;c++)d=a[c],d.hasRadioToggle.set(d.isMutuallyExclusive.get()&&1!==b)}};a.prototype._onActiveThemeChanged=function(a){this._updateDisplayItem();var b=this.parent;b&&b.id!==this.layerList.id&&b.notifyActiveThemeChanged(a)};
a.prototype._processLegendVisibility=function(){this.layerList.onlyShowSwatchesOnVisibleLayers?this.legendIsVisible.set(this.isEffectivelyVisible.get()&&this.inVisibleScaleRange.get()&&!!this.legendItems.length()&&!!this.legendSwatch.get()):this.legendIsVisible.set(!!this.legendItems.length()&&!!this.legendSwatch.get());1==this.legendItems.length()&&this.expandLegend.set(!1)};a.prototype._setTooltips=function(){var a=this,b=this.layerList.appInfo.gcxApp.getResource(this.layerList._libraryId,"language-layerlist-toggle").format(this.name.get()),
c=this.layerList.appInfo.gcxApp.getResource(this.layerList._libraryId,"language-layer-actions-tooltip").format(this.name.get()),d=this.layerList.appInfo.gcxApp.getResource(this.layerList._libraryId,"language-layerlist-visible-at-extent"),g=this.layerList.appInfo.gcxApp.getResource(this.layerList._libraryId,"language-layerlist-not-visible-at-extent"),h=this.layerList.appInfo.gcxApp.getResource(this.layerList._libraryId,"language-layerlist-expand").format(this.name.get());this.layerActionsTooltip.set(c);
this.layerFolderToggleTooltip.set(h);this.inVisibleScaleRange.get()?this.layerToggleTooltip.set(b+" "+d):this.layerToggleTooltip.set(b+" "+g);this.inVisibleScaleRange.bind(this,function(c){c?a.layerToggleTooltip.set(b+" "+d):a.layerToggleTooltip.set(b+" "+g)})};return a}(g.LayerListNode);g.LayerListItem=c})(h.layerList||(h.layerList={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(c){function b(a,b,f,l){c.call(this,a,d.LayerListItemType.KMLFOLDER,b);if(!f)throw Error("LayerListKmlFolderItem: Initialization failed. KML layer object cannot be null.");if(!l)throw Error("LayerListKmlFolderItem: Initialization failed. KML folder object cannot be null.");this._kmlLayer=f;this._kmlFolder=l;this.name=new Observable(l.name);this._setTooltips();this.isVisible.set(!!l.visibility)}__extends(b,c);b.prototype.setItemVisibility=
function(a){c.prototype.setItemVisibility.call(this,a);this._kmlLayer.setFolderVisibility(this._kmlFolder,a)};return b}(d.LayerListItem);d.LayerListKmlFolderItem=h})(d.layerList||(d.layerList={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){var g=function(){function d(){}d.sortBy=function(c,b){c.sort(function(a,e){var c=b(a),d=b(e);return c==d?0:c<d?-1:1});return c};d.sum=function(c,b){for(var a=0,e=0;e<c.length;e++)a+=b(c[e]);return a};d.max=function(c,b){for(var a=null,e=0;e<c.length;e++){var d=b(c[e]);if(null==a||a<d)a=d}return a};d.mapWithErrorCallback=function(c,b,a,e){if("function"!==typeof b)throw Error("Callback required.");if("function"!==typeof a)throw Error("Error callback required.");
if(!c)return c;for(var d=[],l=0;l<c.length;l++){var g=c[l];try{d.push(b.call(e,g,l,c))}catch(h){a.call(e,g,h,d)}}return d};return d}();d.ArrayUtils=g})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){var g=function(){function d(){this._backingStore={}}d.prototype.containsKey=function(c){return this._backingStore.hasOwnProperty(c)};d.prototype.get=function(c){return this._backingStore[c]};d.prototype.set=function(c,b){this._backingStore[c]=b};d.prototype.remove=function(c){return this.containsKey(c)?(delete this._backingStore[c],!0):!1};d.prototype.clear=function(){this._backingStore={}};d.prototype.values=function(){var c=[],b;for(b in this._backingStore)this._backingStore.hasOwnProperty(b)&&
c.push(this._backingStore[b]);return c};d.prototype.keys=function(){var c=[],b;for(b in this._backingStore)this._backingStore.hasOwnProperty(b)&&c.push(b+"");return c};return d}();d.Dictionary=g})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var k=function(c){function b(a,b){c.call(this,a,b);this._emptyFeatureSetCollection=null;this._watchHandles=new h.Dictionary;this.featureSetCollection=new Observable;this.featureActions=new ObservableCollection;this.currentFeature=new Observable;this.hasFeatureSets=new Observable(!1);this.isBusy=new Observable(!1);this.isModified=new Observable(!1);this.defaultIsPaged=!0;this.defaultPageSize=50;this.headerText=new Observable(this.app.getResource(this.libraryId,
"language-common-results"));this.searchSuggestion=new Observable(this.app.getResource(this.libraryId,"language-common-no-results-desc"));this.featureSetCollection.bind(this,this.handleCollectionChanged);this.registerCommands();this.subscribeEvents()}__extends(b,c);b.prototype.subscribeEvents=function(){this.app.event("FSMCollectionOpenedEvent").subscribe(this,this._openFSC);this.app.event("FSMCollectionClosedEvent").subscribe(this,this._closeFSC);this.app.event("FSMCollectionRemovedEvent").subscribe(this,
this._removeFSC);this.app.event("FSMCollectionChangedEvent").subscribe(this,this._changeFSC);this.app.event("FeatureEditedEvent").subscribe(this,this._pulseFeatureSetsInCollection);this.app.event("FeatureDeletedEvent").subscribe(this,this._pulseFeatureSetsInCollection);this.app.event("RelatedRecordEditedEvent").subscribe(this,this._pulseFeatureSetsInCollection)};b.prototype.handleCollectionChanged=function(a){var b=a&&this.app.featureSetManager.getCollectionById(a.id);!b&&a&&a.featureSets&&(b=a);
b?(this.isBusy.set(this.app.featureSetManager.isCollectionOpen(b.id)),this.updateHeaderText(b.countFeatures()),this.hasFeatureSets.set(this._featureSetsHaveFeatures(b.featureSets)),this._watchDisplayNameChanges(),this._watchIsModifiedChanges()):(this.isBusy.set(!1),this._unwatchDisplayNameChanges(),this._unwatchIsModifiedChanges());null!=this.presentableResults&&this.presentableResults.numberOfItems.bind(this,this.updateHeaderText)};b.prototype.handleFeatureSetsChanged=function(a){a=this._featureSetsHaveFeatures(a.sender);
this.hasFeatureSets.get()!==a&&this.hasFeatureSets.set(a)};b.prototype.updateHeaderText=function(a){var b=null,c="",d=!1;a&&(c=" ("+a+")");this.featureSetCollection.get()&&(b=this.featureSetCollection.get().displayName.get(),d=this.featureSetCollection.get().isModified.get());this._count=a;a="{0}{1}{2}".format(b?b:this.app.getResource(this.libraryId,"language-common-results"),c,d?"*":"");this.headerText.set(a)};b.prototype._featureSetsHaveFeatures=function(a){if(a)for(var b=0;b<a.length();b++)if(a.getAt(b).features&&
0<a.getAt(b).features.length()||a.getAt(b).esriFeatureSet&&a.getAt(b).esriFeatureSet.features&&0<a.getAt(b).esriFeatureSet.features.length)return!0;return!1};b.prototype._openFSC=function(a){this.featureSetCollection.get()&&a&&a.featureSetCollectionId&&a.featureSetCollectionId==this.featureSetCollection.get().id&&(this.isBusy.set(!0),this.hasFeatureSets.set(!1),a=this.app.featureSetManager.getSearchSuggestion(this.featureSetCollection.get().sourceName),this.searchSuggestion.set(a?a:this.app.getResource(this.libraryId,
"language-common-no-results-desc")))};b.prototype._closeFSC=function(a){this.featureSetCollection.get()&&a&&a.featureSetCollectionId&&a.featureSetCollectionId==this.featureSetCollection.get().id&&this.isBusy.set(!1);this.featureSetCollection.pulse()};b.prototype._removeFSC=function(a){this.featureSetCollection.get()&&a&&a.featureSetCollectionId&&a.featureSetCollectionId==this.featureSetCollection.get().id&&this.featureSetCollection.set(this._getEmptyFeatureSetCollection())};b.prototype._changeFSC=
function(a){this.featureSetCollection.get()&&a&&a.featureSetCollectionId&&a.featureSetCollectionId==this.featureSetCollection.get().id&&this.featureSetCollection.pulse()};b.prototype._getEmptyFeatureSetCollection=function(){null==this._emptyFeatureSetCollection?this._emptyFeatureSetCollection=new d.essentialsHtmlViewer.mapping.infrastructure.FeatureSetCollection:this._emptyFeatureSetCollection.clear();return this._emptyFeatureSetCollection};b.prototype.registerCommands=function(){var a=this;this.app.command("ShowResultsListFeatureAction").register(this,
function(b){a.currentFeature.set(b);a.getResultsFeatureActions();a.app.command("ActivateView").execute("ResultsFeatureActionsView")});this.app.command("RemoveUserAddedLayer").register(this,function(b){if(a.featureSetCollection.get()){for(var c=a.featureSetCollection.get().featureSets.get(),d=a.featureSetCollection.get(),g=0;g<c.length;g++)if(c[g].layer===b){d.featureSets.removeItem(c[g]);break}a.featureSetCollection.set(d)}});this.app.command("ClearSelection").register(this,function(){a.app.command("RemoveFeatureSetCollection").execute(a.featureSetCollection.get())})};
b.prototype.getResultsFeatureActions=function(){this.featureActions.clear();var a=this.app.menuRegistry.getMenu("ResultsListFeatureAction");this.app.menuRegistry.getDefaultIconUri("ResultsListFeatureAction");if(a)this.featureActions.addItems(a.items);else throw Error("Results Feature Actions not found");};b.prototype._pulseFeatureSetsInCollection=function(){this.featureSetCollection&&this.featureSetCollection.get()&&this.featureSetCollection.get().featureSets&&0<this.featureSetCollection.get().featureSets.length()&&
this.featureSetCollection.get().featureSets.pulse()};b.prototype._watchDisplayNameChanges=function(){var a=this;this._unwatchDisplayNameChanges();var b=this.featureSetCollection.get()?this.featureSetCollection.get().displayName:null;if(!b)return null;var c=b.bind(this,function(){return a.updateHeaderText(a._count)}),d={remove:function(){return b.unbind(c)}};this._watchHandles.set("displayName",d);return d};b.prototype._unwatchDisplayNameChanges=function(){var a=this._watchHandles.get("displayName");
a&&a.remove();this._watchHandles.remove("displayName")};b.prototype._watchIsModifiedChanges=function(){var a=this;this._unwatchIsModifiedChanges();var b=this.featureSetCollection.get()?this.featureSetCollection.get().isModified:null;if(!b)return null;var c=b.bind(this,function(){return a.updateHeaderText(a._count)}),d={remove:function(){return b.unbind(c)}};this._watchHandles.set("isModified",d);return d};b.prototype._unwatchIsModifiedChanges=function(){var a=this._watchHandles.get("isModified");
a&&a.remove();this._watchHandles.remove("isModified")};return b}(d.framework.ui.ViewModelBase);g.ResultsViewModel=k})(h.results||(h.results={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var k=function(c){function b(a,b){var f=this;c.call(this,a,b);this.pageControlsEnabled=new Observable(!1);this.resultsList=new Observable("results-list");this.pagingControlClassName=new Observable("paging-control no-pages");this.contentField=new Observable("description");this._boundFeatureSetCollection=this._featureSetsBindingToken=null;this._featureViewMap={};this.results=new d.framework.ui.ObservableCollectionAggregator(new ObservableCollection);
this.presentableResults=new d.framework.ui.PresentableCollection(this.results);this.presentableResults.items.useThrottling=!0;this.resultsPage=this.presentableResults.items;this.presentableResults.pageSize.set(this.defaultPageSize);this.defaultIsPaged!=this.presentableResults.isPaginated.get()&&this.presentableResults.isPaginated.set(this.defaultIsPaged);this.resultsPage.bind(this,this.handlePageResultsChange);this.presentableResults.numberOfItems.bind(this,function(a){0<a?f.pagingControlClassName.set("paging-control has-pages"):
f.pagingControlClassName.set("paging-control no-pages");f.updateHeaderText(a)});this.app.command("ShowResultsList").register(this,this.showResultsList);this.app.command("SwitchToTabularResultsView").register(this,this._switchToTabularResultsViewImpl,this._canExecuteSwitchToTabularResultsView)}__extends(b,c);b.prototype.subscribeEvents=function(){c.prototype.subscribeEvents.call(this);this.app.event("FeatureChangedEvent").subscribe(this,this.handleFeatureChanged)};b.prototype.handleCollectionChanged=
function(a){c.prototype.handleCollectionChanged.call(this,a);this._clearResetUnderlyingCollection(!0);if(a&&a.featureSets){this._featureSetsBindingToken=a.featureSets.bind(this,this.handleFeatureSetsChanged);this._boundFeatureSetCollection=a;for(var b=this.results.getCollectionSource(),d=0,g=a.featureSets.length();d<g;d++)b.addItem(a.featureSets.getAt(d).features)}};b.prototype.handleFeatureSetsChanged=function(a){c.prototype.handleFeatureSetsChanged.call(this,a);var b=this.results.getCollectionSource();
if("append"===a.type){var d=a.sender.getRange(a.rangeStart,a.rangeEnd);for(a=0;a<d.length;a++)b.addItem(d[a].features)}else if("remove"===a.type)for(d=a.sender.getRange(a.rangeStart,a.rangeEnd),a=0;a<d.length;a++)b.removeItem(d[a].features);else"clear"===a.type&&(this._clearResetUnderlyingCollection(!1),this.results.bindingEvent.publish(a))};b.prototype.handlePageResultsChange=function(a){var b=this;a=a?a:{type:null};if("clear"===a.type)Object.keys(this._featureViewMap).map(function(a){return b._featureViewMap[a]}).forEach(function(a){return b.app.viewManager.destroyView(a)}),
this._featureViewMap={};else if("remove"===a.type&&a.sender.value.length>a.rangeStart){var c=a.sender.getAt(a.rangeStart);this._destroyViewForToken(c.token);this._destroyViewForToken(c.token+"-label")}a="clear"===a.type||"remove"===a.type&&1>=a.sender.value.length;c=new h.eventArgs.ResultsPageChangedEventArgs;c.featureSetCollection=this.featureSetCollection.get();c.newValue=a?new ObservableCollection:this.resultsPage;this.app.event("ResultsPageChangedEvent").publish(c)};b.prototype.handleFeatureChanged=
function(a){if(a&&this._featureViewMap.hasOwnProperty(a.token)){var b=this._featureViewMap[a.token],c=this._featureViewMap[a.token+"-label"];c.destroyBindings();b.destroyBindings();c.attach(a);b.attach(a)}};b.prototype._destroyViewForToken=function(a){if(a&&this._featureViewMap.hasOwnProperty(a)){var b=this._featureViewMap[a];b&&(this.app.viewManager.destroyView(b),delete this._featureViewMap[a])}};b.prototype.showResultsList=function(a){(a="string"===typeof a?this.app.featureSetManager.getCollectionById(a):
a)&&a!==this.featureSetCollection.get()?(this.unbindFeatureSet(),this.featureSetCollection.set(a)):this.handlePageResultsChange();this.app.command("_setResultMappingCommand").execute(a.sourceName,"ShowResultsList");this.presentableResults.numberOfItems.bind(this,this.updateHeaderText)};b.prototype._switchToTabularResultsViewImpl=function(){this.app.command("ShowResultsTable").execute(this.featureSetCollection.get())};b.prototype._canExecuteSwitchToTabularResultsView=function(){return!!this.featureSetCollection.get()};
b.prototype.getFeatureView=function(a){return this._featureViewMap[a]};b.prototype.setFeatureView=function(a,b){this._featureViewMap[a]=b};b.prototype.unbindFeatureSet=function(){this._featureSetsBindingToken&&this._boundFeatureSetCollection&&(this._boundFeatureSetCollection.featureSets.unbind(this._featureSetsBindingToken),this._boundFeatureSetCollection=this._featureSetsBindingToken=null)};b.prototype.exportState=function(a){var b=this.featureSetCollection.get();a.results=this.app.project.convert.fromGcxFeatureSetCollection(b);
a.page=this.presentableResults.currPageNumber.get();a.viewMode="list"};b.prototype.applyState=function(a){var b=this;a.promises.push(this.app.project.convert.toGcxFeatureSetCollection(a.state.results).then(function(c){c&&(c!==b.featureSetCollection.get()&&(b.unbindFeatureSet(),b.featureSetCollection.set(c)),d.framework.utils.isNullOrUndefined(a.state.page)||b.presentableResults.currPageNumber.set(a.state.page),"list"===a.state.viewMode&&b.app.command("_setResultMappingCommand").execute(c.sourceName,
"ShowResultsList"))}))};b.prototype._pulseFeatureSetsInCollection=function(){var a=this.presentableResults.currPageNumber.get();c.prototype._pulseFeatureSetsInCollection.call(this);this.presentableResults.currPageNumber.set(a)};b.prototype._clearResetUnderlyingCollection=function(a){this.results.getCollectionSource().clear();this.presentableResults.currPageNumber.set(1);a&&(this.unbindFeatureSet(),this._featureViewMap={})};return b}(g.ResultsViewModel);g.FlatResultsViewModel=k})(h.results||(h.results=
{}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var h=function(){function c(b,a,c,d){this.sortState=new Observable(0);this.sortClass=new Observable("");this._reverseSortingPredicate=this._sortingPredicate=null;this.displayName=a.displayName;this._sharedState=b;"DateTime"===c?(this._sortingPredicate=this.buildDateSortingFunction(d),this._reverseSortingPredicate=this.buildReverseDateSortingFunction(d)):(this._sortingPredicate=this.buildSortingFunction(d),this._reverseSortingPredicate=
this.buildReverseSortingFunction(d));this.sortClass.syncTransform(this.sortState,function(a){switch(a){case 1:return b.sortedClass;case 2:return b.reverseSortedClass}return b.unsortedClass});this.sortState.bind(this,this.onSortStateChange)}c.prototype.buildSortingFunction=function(b){return function(a,c){return d.essentialsHtmlViewer.mapping.infrastructure.results.ResultsAttributeHeaderViewModel.collator(a.attributes.getAt(b).presentableValue.get(),c.attributes.getAt(b).presentableValue.get())}};
c.prototype.buildReverseSortingFunction=function(b){return function(a,c){return d.essentialsHtmlViewer.mapping.infrastructure.results.ResultsAttributeHeaderViewModel.collator(c.attributes.getAt(b).presentableValue.get(),a.attributes.getAt(b).presentableValue.get())}};c.prototype.buildDateSortingFunction=function(b){return function(a,c){var f=a.attributes.getAt(b).value.get(),g=c.attributes.getAt(b).value.get(),h=new Date(f),k=new Date(g),m="Invalid Date"!=h;return m!==("Invalid Date"!=k)?m?-1:1:m?
h.getTime()-k.getTime():d.essentialsHtmlViewer.mapping.infrastructure.results.ResultsAttributeHeaderViewModel.collator(f,g)}};c.prototype.buildReverseDateSortingFunction=function(b){return function(a,c){var f=c.attributes.getAt(b).value.get(),g=a.attributes.getAt(b).value.get(),h=new Date(f),k=new Date(g),m="Invalid Date"!=h;return m!==("Invalid Date"!=k)?m?-1:1:m?h.getTime()-k.getTime():d.essentialsHtmlViewer.mapping.infrastructure.results.ResultsAttributeHeaderViewModel.collator(f,g)}};c.prototype.onSortStateChange=
function(b){if(!this._sharedState.ignoreStateChange){if(0>b||2<b)throw Error("Illegal column sort state: "+b);if(0==b){if(this._sharedState.lastSortedColumn!=this)throw Error("Column sort state out of sync");this._sharedState.lastSortedColumn=null;this._sharedState.presentableResults.sortingPredicate=null;this._sharedState.presentableResults.unsortCollection()}else{null!=this._sharedState.lastSortedColumn&&this._sharedState.lastSortedColumn!=this&&(this._sharedState.ignoreStateChange=!0,this._sharedState.lastSortedColumn.sortState.set(0),
this._sharedState.ignoreStateChange=!1);this._sharedState.lastSortedColumn=this;if(1==b)this._sharedState.presentableResults.sortingPredicate=this._sortingPredicate;else if(2==b)this._sharedState.presentableResults.sortingPredicate=this._reverseSortingPredicate;else throw Error("Invalid column sort state.");this._sharedState.presentableResults.sortCollection()}}};return c}();g.ResultsAttributeHeaderViewModel=h;(function(c){c.manualCollator=function(a,b){return isNaN(a)||isNaN(b)?a<b?-1:a>b?1:0:+a-
b};c.collator="object"==typeof Intl&&"function"==typeof Intl.Collator?(new Intl.Collator(void 0,{numeric:!0})).compare:d.essentialsHtmlViewer.mapping.infrastructure.results.ResultsAttributeHeaderViewModel.manualCollator;var b=function(){function a(a,b,c,d){this.lastSortedColumn=null;this.presentableResults=a;this.unsortedClass=b;this.sortedClass=c;this.reverseSortedClass=d;this.reset()}a.prototype.reset=function(){this.ignoreStateChange=!1;this.lastSortedColumn=null};return a}();c.SharedState=b})(h=
g.ResultsAttributeHeaderViewModel||(g.ResultsAttributeHeaderViewModel={}))})(h.results||(h.results={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var h=function(c){function b(){c.apply(this,arguments)}__extends(b,c);b.prototype.handleMenuItemClick=function(a,b,c){c.execute(this.viewModel.currentFeature.get())};b.prototype.handleGetDescription=function(a,b,c){b.title=c.description.get()};return b}(d.framework.ui.ViewBase);g.ResultsFeatureActionsView=h})(h.results||(h.results={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||
(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var h=function(c){function b(a,b){var d=this;c.call(this,a,b);this.isContainerCollapsed=this.isCollapsed=!0;this._pressStartTime=this._longPressTimer=null;this._pressLengthMs=1500;this._ignoreMouseEventFlag=this._firedTouchOrPress=!1;this._lastTouchY=this._pressYStart=null;this._scrollYDeltaThreshold=35;this._firstEvent=null;this.app.event("ViewContainerActivatedEvent").subscribe(this,function(a){!d.isCollapsed&&d._isViewHostedInContainer(a)&&
(d.app.event("ResultsViewOpenedEvent").publish(d),d.isContainerCollapsed=!1)});this.app.event("ViewContainerDeactivatedEvent").subscribe(this,function(a){!d.isCollapsed&&d._isViewHostedInContainer(a)&&(d.app.event("ResultsViewCollapsedEvent").publish(d),d.isContainerCollapsed=!0)});this.app.event("ViewContainerViewClosedEvent").subscribe(this,function(a){a.viewId===d.id&&(d.app.event("ResultsViewClosedEvent").publish(d),d.isContainerCollapsed=!0)})}__extends(b,c);b.prototype.activated=function(){c.prototype.activated.call(this);
this.isCollapsed=!1;this.app.event("ResultsViewOpenedEvent").publish(this)};b.prototype.deactivated=function(){c.prototype.deactivated.call(this);this.isCollapsed=!0;this.app.event("ResultsViewCollapsedEvent").publish(this)};b.prototype.handleTouchStart=function(a,b,c){this._firstEvent||(this._firstEvent="touch start",this._beginLongPress(c));return!0};b.prototype.handleTouchMove=function(a,b,c){"touch start"===this._firstEvent&&(this._firstEvent=null,this._cancelLongPress());return!0};b.prototype.handleTouchEnd=
function(a,b,c){"touch start"===this._firstEvent&&(this._firstEvent=null,this._cancelLongPress());return!0};b.prototype.handleTouchCancel=function(a,b,c){"touch start"===this._firstEvent&&(this._firstEvent=null,this._cancelLongPress());return!0};b.prototype.handleMouseDown=function(a,b,c){this._firstEvent||(this._firstEvent="mouse down",this._beginLongPress(c));return!0};b.prototype.handleClick=function(a,b,c){this._firstEvent&&(this._firstEvent=null,this._cancelLongPress());a=a.target;b=!("IMG"!==
a.tagName||!a.parentElement||"A"!==a.parentElement.tagName||!a.parentElement.href);if("A"===a.tagName||b)return!0;this.app.command("ClearFeatureInformation").execute();this.app.event(this.featureClickedEventName).publish(c);return!1};b.prototype.handleMouseUp=function(a,b,c){"mouse down"===this._firstEvent&&(this._firstEvent=null,this._cancelLongPress());return!0};b.prototype.handleMouseOut=function(a,b,c){"mouse down"===this._firstEvent&&(this._firstEvent=null,this._cancelLongPress())};b.prototype._beginLongPress=
function(a){var b=this;this._longPressTimer&&clearTimeout(this._longPressTimer);this._longPressTimer=setTimeout(function(){b.app.event(b.featurePressedEventName).publish(a)},this._pressLengthMs)};b.prototype._cancelLongPress=function(){this._longPressTimer&&(clearTimeout(this._longPressTimer),this._longPressTimer=null)};b.prototype._isViewHostedInContainer=function(a){if(a instanceof d.framework.ui.ViewContainer.ViewContainerView){a=a.viewModel.regionName.get();var b=this.app.viewManager.getRegionForViewId(this.id);
if(b&&b.name===a)return!0}return!1};b.prototype.scrollView=function(a){this.scrollContainerElement&&(this.scrollContainerElement.scrollTop=a||0)};return b}(d.framework.ui.ViewBase);g.ResultsViewBase=h;h.prototype.featureClickedEventName="ResultsListFeatureClickedEvent";h.prototype.featurePressedEventName="ResultsListFeaturePressedEvent"})(h.results||(h.results={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||
(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(g){var k=function(c){function b(a,b){c.call(this,a,b);this.featureClickedEventName="ResultsListFeatureClickedEvent";this.featurePressedEventName="ResultsListFeaturePressedEvent";this._subscriptions=null;this._scrollTop=0;this.app.command("ShowResultsList").register(this,this.showResultsList);this.app.command("ShowResultsTable").register(this,this._handleShowResultsTable);this.app.command("SwitchToTabularResultsView").register(this,this._switchToTabularResultsViewImpl,
this._canExecuteSwitchToTabularResultsView);this.app.command("_ExportResultsViewState").register(this,this._exportState);this.app.command("_ApplyResultsViewState").register(this,this._applyState)}__extends(b,c);b.prototype.activated=function(){var a=this;c.prototype.activated.call(this);this._unsubscribeFromEvents();if("DataFrameResultsContainerRegion"===this.regionName||"DataRegion"===this.regionName){var b=this.app.event("DataFrameOpenedEvent").subscribe(this,this._dataFrameOpenedEventHandler),
d=this.app.event("DataFrameClosedEvent").subscribe(this,this._dataFrameClosedEventHandler);this._subscriptions=[{eventName:"DataFrameOpenedEvent",token:b},{eventName:"DataFrameClosedEvent",token:d}]}if(this.resultsList){var g=this.resultsList;setTimeout(function(){dojo.style(g,{display:"block"})},1)}this.viewModel.featureSetCollection.bind(this,function(b){a.app.trace.debug("View focused in results list: "+a.id);a.app.command("FocusOnFirstInputInView").execute(a)})};b.prototype.deactivated=function(){c.prototype.deactivated.call(this);
this._unsubscribeFromEvents()};b.prototype.attach=function(a){var b=this;this.title.sync(a.headerText);this.isBusy.sync(a.isBusy);void 0!=this.configuration.isPaged&&a.presentableResults.isPaginated.set(this.configuration.isPaged);this.configuration.pageSize&&a.presentableResults.pageSize.set(this.configuration.pageSize);this.configuration.contentField&&a.contentField.set(this.configuration.contentField);a.presentableResults.currPageNumber.bindingEvent.subscribe(this,function(){b.scrollViewTop()});
this.scrollViewTop(this._scrollTop);c.prototype.attach.call(this,a)};b.prototype.showResultsList=function(a){this.app.viewManager.activateView(this)};b.prototype.handlePageFirst=function(a,b,c){1<this.viewModel.presentableResults.currPageNumber.get()&&this.viewModel.presentableResults.currPageNumber.set(1)};b.prototype.handlePagePrev=function(a,b,c){1<this.viewModel.presentableResults.currPageNumber.get()&&this.viewModel.presentableResults.currPageNumber.set(this.viewModel.presentableResults.currPageNumber.get()-
1)};b.prototype.handlePageNext=function(a,b,c){this.viewModel.presentableResults.lastPageNumber.get()>this.viewModel.presentableResults.currPageNumber.get()&&this.viewModel.presentableResults.currPageNumber.set(this.viewModel.presentableResults.currPageNumber.get()+1)};b.prototype.handlePageLast=function(a,b,c){this.viewModel.presentableResults.currPageNumber.get()<this.viewModel.presentableResults.lastPageNumber.get()&&this.viewModel.presentableResults.currPageNumber.set(this.viewModel.presentableResults.lastPageNumber.get())};
b.prototype.handleScrollChange=function(a,b,c){c&&(this._scrollTop=b.scrollTop)};b.prototype.getDescription=function(a,b,c){b.title=c.description.get()};b.prototype.scrollViewTop=function(a){this.scrollContainerElement&&(this.scrollContainerElement.scrollTop=a||0)};b.prototype.resolveWidget=function(a,b,f){c.prototype.resolveWidget.call(this,a,b);switch(a){case "GetLabel":return a=new d.FeatureDescriptionPresenterView(this.app,this.libraryId),a.contentField="label",a.root=dojo.create("div"),a.root.className=
"feature-label",a.attach(b),this.viewModel.setFeatureView(b.token+"-label",a),a;case "GetDescription":return a=new d.FeatureDescriptionPresenterView(this.app,this.libraryId),a.contentField=this.viewModel.contentField.get(),a.root=dojo.create("div"),a.root.className="feature-description",a.attach(b),this.viewModel.setFeatureView(b.token,a),a;case "ResultsListActionsWidget":if(b=this.app.menuRegistry.createMenuWidget(this,b,f))return b}};b.prototype._handleShowResultsTable=function(){this.app.viewManager.deactivateView(this)};
b.prototype._switchToTabularResultsViewImpl=function(){this.app.command("CloseDataFrame").execute()};b.prototype._canExecuteSwitchToTabularResultsView=function(){return this.isActive&&!this.app.configuration.mobileMode};b.prototype._dataFrameOpenedEventHandler=function(){this.isContainerCollapsed||this.app.event("ResultsViewOpenedEvent").publish(this)};b.prototype._dataFrameClosedEventHandler=function(){this.isContainerCollapsed||this.app.event("ResultsViewCollapsedEvent").publish(this)};b.prototype._unsubscribeFromEvents=
function(){if(this._subscriptions)for(var a=0;a<this._subscriptions.length;a++){var b=this._subscriptions[a];this.app.event(b.eventName).unsubscribe(b.token)}this._subscriptions=null};b.prototype._exportState=function(a){this.isActive&&this.viewModel.exportState(a)};b.prototype._applyState=function(a){this.viewModel.applyState(a)};return b}(g.ResultsViewBase);g.ResultsListView=k})(d.results||(d.results={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||
(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var k=function(){function b(){}b.prototype.toJSONString=function(){return JSON.stringify({name:this.name,featureSet:this.featureSet.toJson()})};return b}(),c=function(b){function a(){b.apply(this,arguments);this._supportedFormats=["csv","xlsx","shp"];this._showInvisibleAttributes=!1}__extends(a,b);a.prototype.initialize=function(a){var c=this;b.prototype.initialize.call(this,a);a&&(this.resultMappings=a.resultMappings,a.customSearchSuggestions&&
this.app.featureSetManager.addSearchSuggestions(a.customSearchSuggestions));a.showInvisibleAttributesOnExport&&(this._showInvisibleAttributes=a.showInvisibleAttributesOnExport);this.wireUpResultMapping();this.app.command("ExportResultsTo").register(this,function(a){var b="csv";a.fsc?(a.format?-1===c._supportedFormats.indexOf(a.format)?c.app.trace.warning("ExportResultsTo: {0} file format not recognized. Defaulting to csv.".format(a.format)):b=a.format:c.app.trace.warning("ExportResultsTo: file format not specified. Defaulting to csv."),
c.exportTo({fsc:a.fsc,format:b})):c.app.trace.error("ExportResultsTo: Cannot export, no feature set collection specified.")},this.exportToCanExecute)};a.prototype.getStateFilter=function(){var a=new h.validation.NumberValidator;return{featureSetCollections:{item:this.app.project.filter.featureSetCollection},results:this.app.project.filter.featureSetCollection,viewMode:!0,page:a,tableOptions:{selectedFeatureSet:this.app.project.filter.featureSet,sortColumn:a,sortDirection:!0}}};a.prototype.exportState=
function(){var a=this,b={featureSetCollections:this.app.featureSetManager.featureSetCollections.get().map(function(b){return a.app.project.convert.fromGcxFeatureSetCollection(b)})};return Promise["try"](function(){a.app.command("_ExportResultsViewState").execute(b);return b})};a.prototype.applyState=function(a){var b=this;return h.PromiseUtils.mapSkipRejected(a.featureSetCollections,function(a){return b.app.project.convert.toGcxFeatureSetCollection(a)}).then(function(){return b.app.waitUntilAllLibrariesLoaded()}).then(function(){var c=
{state:a,promises:[]};b.app.command("_ApplyResultsViewState").execute(c);return Promise.all(c.promises)["return"]()})};a.prototype.wireUpResultMapping=function(){this.app.event("FSMCollectionOpenedEvent").subscribe(this,this.fsmCollectionOpenedHandler);this.app.command("_setResultMappingCommand").register(this,this.fsmCollectionSetCommand);this.app.command("FSMCollectionSetCommand").register(this,this.fsmCollectionSetCommand)};a.prototype.fsmCollectionOpenedHandler=function(a){a=a.featureSetCollection;
if(this.resultMappings){var b=this.resultMappings[a.sourceName];if(b)for(var c=0;c<b.length;c++){var d=b[c];this.app.command(d).execute(a.id);this._lastCommand=d}}};a.prototype.fsmCollectionSetCommand=function(a,b){if(b){var c=null;"ShowResultsList"===b?c="ShowResultsTable":"ShowResultsTable"===b&&(c="ShowResultsList");if(c&&this.resultMappings&&this.resultMappings[a]){var d=this.resultMappings[a],c=d.indexOf(c);-1<c?d[c]=b:-1===d.indexOf(b)&&d.push(b)}}};a.prototype.exportTo=function(a){var b=this,
c=new d.essentialsHtmlViewer.mapping.infrastructure.commandArgs.AddStatusArgs(this.app.getResource(this.libraryId,"language-results-export-to-status-message").format(a.format)),g="exportTo "+a.format+"StatusMessage";c.id=g;c.showBusyIcon=!0;this.app.command("AddStatus").execute(c);c=this.app.site.url;c=c.substring(0,c.toLowerCase().lastIndexOf("/sites/"))+"/Utilities/Extract";d.request({url:c,content:{format:a.format,featureSets:this.fscToJson(a.fsc),f:"json"},load:dojo.hitch(this,function(c){return b.exportToSuccess(c,
a.format)}),error:function(c){b.app.command("RemoveStatus").execute(g);b.app.commandRegistry.command("Alert").execute(c.message,b.app.getResource(b.libraryId,"language-results-export-to-alert-error-message").format(a.format))}})};a.prototype.exportToSuccess=function(a,b){var c=this;if(a&&a.hasOwnProperty("href")){var d=a.href,g=this.app.getResource(this.libraryId,"language-results-export-to-confirm-content").format(b),h=this.app.getResource(this.libraryId,"language-results-export-to-confirm-title").format(b),
k="exportTo "+b+"StatusMessage";this.app.command("RemoveStatus").execute(k);this.app.commandRegistry.command("Confirm").execute(g,h,function(a){a&&(c.app.isNative.get()?window.open(d,"_blank"):window.location.assign(d))})}};a.prototype.exportToCanExecute=function(a){var b=null;a&&(a instanceof h.FeatureSetCollection?b=a:a.fsc&&a.fsc instanceof h.FeatureSetCollection&&(b=a.fsc));return b&&b.featureSets.get()&&0<b.featureSets.get().length};a.prototype.getFields=function(a){var b=[];a.esriFeatureSet&&
a.esriFeatureSet.features&&0<a.esriFeatureSet.features.length&&(b=this.getFieldsFromEsriLayer(a.esriFeatureSet.features[0].getLayer(),a));0===b.length&&(a.layer&&a.layer.fields&&0<a.layer.fields.length?b=this.getFieldsFromEssentialsLayer(a.layer):a.attributes.get()&&0<a.attributes.get().length?b=this.getFieldsFromGcxFeatureSetAttributes(a.attributes.get(),a):a.features.get()&&0<a.features.get().length&&a.features.getAt(0).attributes.get()&&0<a.features.getAt(0).attributes.get().length?b=this.getFieldsFromGcxFeatureAttributes(a.features.getAt(0).attributes.get(),
a):a.esriFeatureSet&&a.esriFeatureSet.features&&0<a.esriFeatureSet.features.length&&a.esriFeatureSet.features[0].attributes&&0<a.esriFeatureSet.features[0].attributes.length?b=this.getFieldsFromEsriFeatureAttributeValues(a.esriFeatureSet.features):a.features.get()&&0<a.features.get().length&&a.features.getAt(0).attributes.get()&&0<a.features.getAt(0).attributes.get().length&&(b=this.getFieldsFromGcxFeatureAttributeValues(a.features.get())));return b};a.prototype.getFieldsFromEsriLayer=function(a,
b){var c=[];if(a&&a.fields&&(c=a.fields.slice(0),b&&b.features.get()&&b.features.getAt(0).attributes.get())){var d=b.features.getAt(0).attributes.get();d.length===c.length&&d.forEach(function(a,b){c[b].alias=a.displayName.get()?a.displayName.get():c[b].alias})}return c};a.prototype.getFieldsFromEssentialsLayer=function(a){var b=[],c=new esri.layers.Field;a.fields.forEach(function(a){c=new esri.layers.Field;c.name=a.name;c.alias=a.displayName;c.type=d.essentials.Field.convertToEsriFieldType(a.dataType);
b.push(c)});return b};a.prototype.getFieldsFromGcxFeatureSetAttributes=function(a,b){var c=this,g=[],h=new esri.layers.Field;a.forEach(function(a,e){h=new esri.layers.Field;h.name=a.name.get();h.alias=a.displayName.get();a.type.get()?h.type=d.essentials.Field.convertToEsriFieldType(a.type.get()):0<b.features.get().length&&b.features.getAt(0).attributes.get()&&0<b.features.getAt(0).attributes.get().length?h.type=c.getTypeFromGcxFeatures(b.features.get(),e):h.type=c.getEsriTypeFromValue(null);g.push(h)});
return g};a.prototype.getFieldsFromGcxFeatureAttributes=function(a,b){var c=this,g=[],h=new esri.layers.Field;a.forEach(function(a,e){h=new esri.layers.Field;h.name=a.name.get();h.alias=a.displayName.get();a.type.get()?h.type=d.essentials.Field.convertToEsriFieldType(a.type.get()):h.type=c.getTypeFromGcxFeatures(b.features.get(),e);g.push(h)});return g};a.prototype.getFieldsFromEsriFeatureAttributeValues=function(a){var b=0,c=[],d=new esri.layers.Field,g=a[0].attributes,h;for(h in g)g.hasOwnProperty(h)&&
(d=new esri.layers.Field,d.name=h,d.alias=h,d.type=this.getTypeFromEsriFeatures(a,b),c.push(d),b++);return c};a.prototype.getFieldsFromGcxFeatureAttributeValues=function(a){var b=0,c=[],d=new esri.layers.Field,g=a[0].attributes.get(),h;for(h in g)g.hasOwnProperty(h)&&(d=new esri.layers.Field,d.name=h,d.alias=h,d.type=this.getTypeFromGcxFeatures(a,b),c.push(d),b++);return c};a.prototype.getTypeFromEsriFeatures=function(a,b){var c=this,d=this.getEsriTypeFromValue(null);a.forEach(function(a){(a=a.attributes[b])&&
(d=c.getEsriTypeFromValue(a))});return d};a.prototype.getTypeFromGcxFeatures=function(a,b){var c=this,d=this.getEsriTypeFromValue(null);a.forEach(function(a){(a=a.attributes.getAt(b).value.get())&&(d=c.getEsriTypeFromValue(a))});return d};a.prototype.getEsriTypeFromValue=function(a){var b="esriFieldTypeString";"number"===typeof a?b="esriFieldTypeDouble":a instanceof Date&&(b="esriFieldTypeDate");return b};a.prototype.getFeatureSets=function(a){var b=this,c=new esri.tasks.FeatureSet,g=new esri.Graphic,
r=[];a.featureSets.get().forEach(function(p,q){var t=b.getFields(p);c=new esri.tasks.FeatureSet;if(p&&p.features.get()&&0<p.features.get().length){var y=[],w=[];p.features.getAt(0).attributes.get().forEach(function(a){a.visible.get()||b._showInvisibleAttributes?y.push(a.name.get()):w.push(a.name.get())});p.features.get().forEach(function(a){var e={},k=a.esriFeature.get().attributes;a.getAttributes().forEach(function(a){if(a.visible.get()||b._showInvisibleAttributes){var c=a.name.get(),g=a.presentableValue.get(),
l,n;for(n in t){var m=t[n];if(m.name===a.name.get()){l=m.type;if((n=t.filter(function(a){return-1!==a.name.indexOf(".Name()",a.name.length-7)&&a.name.substr(0,a.name.length-7)===m.name}))&&0<n.length&&(n=n[0].name)&&k&&k.hasOwnProperty(n)){var p=k[m.name],r=p,p=g,g=r;e[n]=p}break}}g&&c&&(m.domain&&"codedValue"==m.domain.type?(m.type=d.essentials.EsriFieldTypes.esriFieldTypeString,e[c]=a.presentableValue.get()):e[c]=m.type===d.essentials.EsriFieldTypes.esriFieldTypeDouble||m.type===d.essentials.EsriFieldTypes.esriFieldTypeSingle?
h.FormatUtils.parseNumber(a.value.get()):l===d.essentials.EsriFieldTypes.esriFieldTypeInteger||m.type===d.essentials.EsriFieldTypes.esriFieldTypeSmallInteger?Math.floor(h.FormatUtils.parseNumber(a.value.get())):l===d.essentials.EsriFieldTypes.esriFieldTypeDate?h.FormatUtils.parseDate(a.value.get()):g)}});c.displayFieldName=p.esriFeatureSet.displayFieldName;g=new esri.Graphic(a.esriFeature.get().geometry,null,e,null);c.features.push(g)})}else p&&0<p.features.get().length&&p.features.get().forEach(function(a){g=
a.esriFeature.get();c.features.push(g)});if(0<c.features.length){if(t&&0<t.length){var x=[];t.forEach(function(a){-1==$.inArray(a.name,w)&&x.push(a)});c.fields=x}var u=new k;u.name=a.featureSets.getAt(q).displayName.get();u.featureSet=c;var z=0;r.forEach(function(a){u.name===a.name&&(z+=1)});0<z&&(u.name+=z);r.push(u)}});return r};a.prototype.fscToJson=function(a){var b="[";this.getFeatureSets(a).forEach(function(a,c,e){var d=new k;d.featureSet=a.featureSet;d.name=a.name;b+=d.toJSONString();c!==e.length-
1&&(b+=",")});return b+="]"};return a}(d.framework.application.ModuleBase);g.ResultsModule=c})(h.results||(h.results={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var h=function(c){function b(a,b){c.call(this,a,b);this.featureClickedEventName="ResultsTableFeatureClickedEvent";this.featurePressedEventName="ResultsTableFeaturePressedEvent";this._boundFs=this._fsBindingToken=this.scrollTabRightElement=this.scrollTabLeftElement=this.tabElements=this.tabContainerElement=this.scrollContainerElement=null;this.app.command("ShowResultsTable").register(this,this.showResultsTable);this.app.command("ShowResultsList").register(this,
this._handleShowResultsList);this.app.command("SwitchToListResultsView").register(this,this._switchToListResultsViewImpl,this._canExecuteSwitchToListResultsView);this.app.command("_ExportResultsViewState").register(this,this._exportState);this.app.command("_ApplyResultsViewState").register(this,this._applyState)}__extends(b,c);b.prototype.attach=function(a){var b=this;this.title.sync(a.headerText);this.isBusy.sync(a.isBusy);void 0!=this.configuration.isPaged&&a.presentableResults.isPaginated.set(this.configuration.isPaged);
this.configuration.pageSize&&a.presentableResults.pageSize.set(this.configuration.pageSize);a.presentableResults.currPageNumber.bindingEvent.subscribe(this,function(){var a=b.viewModel.curFeatureSet.get();b.scrollView(a?b.viewModel.currScrollPosWithinTab[a.uniqueId]||0:0)});c.prototype.attach.call(this,a)};b.prototype.resolveWidget=function(a,b,f){c.prototype.resolveWidget.call(this,a,b);switch(a){case "ResultsTableActionsWidget":return this.app.menuRegistry.createMenuWidget(this,b,f);case "TableViewWidget":a=
this.viewModel;if(b=this.app.viewManager.createView({typeName:"geocortex.essentialsHtmlViewer.mapping.infrastructure.ui.components.Table.TableView",markupResource:"Mapping/infrastructure/ui/components/Table/TableView.html",libraryId:this.libraryId,isVisible:!0}))f=new d.essentialsHtmlViewer.mapping.infrastructure.ui.components.Table.TableViewModel(this.app,this.libraryId),f.addRecordClickEvents(this.featureClickedEventName),f.addRecordLongPressEvents(this.featurePressedEventName),f.columnHeaders=
this.viewModel.columnHeaders,f.attachToPresentableCollection(a.presentableResults),b.attach(f),this.scrollContainerElement=b.tableContainerElement;return b;default:this.app.trace.warning("ResultsTableView: Unknown Widget")}};b.prototype.showResultsTable=function(a){var b=this;this.app.viewManager.activateView(this);this.viewModel.featureSetCollection.get()&&(this._unbindFromPrevFeatureSet(),this._boundFs=this.viewModel.featureSetCollection.get().featureSets)&&(this._fsBindingToken=this.viewModel.featureSetCollection.get().featureSets.bind(this,
this._refreshTabControlVisibility));var c=null,d=this.app.event("ApplicationResizedEvent").subscribe(this,function(){b.isActive?(c&&(clearTimeout(c),c=null),c=setTimeout(function(){b._refreshTabControlVisibility()},200)):(b.app.event("ApplicationResizedEvent").unsubscribe(d),d=null)});this._refreshTabControlVisibility()};b.prototype._refreshTabControlVisibility=function(){var a=this;setTimeout(function(){a.tabContainerElement&&a.tabElements&&(a.viewModel.tabControlsEnabled.set(a.tabElements.offsetWidth>
a.tabContainerElement.offsetWidth),a._updateScrollTabDisabledStatus())},100)};b.prototype.handleTabClick=function(a,b,c){this.scrollContainerElement&&(this.viewModel.currScrollPosWithinTab[this.viewModel.curFeatureSet.get().uniqueId]=this.scrollContainerElement.scrollTop);(a=dojo.filter(this.viewModel.featureSetCollection.get().featureSets.get(),function(a){return a.uniqueId===c.uniqueId}))&&a[0]&&this.viewModel.curFeatureSet.get()!==a[0]&&(this.viewModel.setCurrentSelectedFeatureSet(a[0]),this.viewModel.setCurrentPageWithinTab(c.uniqueId));
this.app.command("FocusOnFirstInputInView").execute(this)};b.prototype.handlePageFirst=function(a,b,c){1<this.viewModel.presentableResults.currPageNumber.get()&&(this.viewModel.updateCurrentPageAndScrollPosWithinTab(1,0),this.viewModel.presentableResults.currPageNumber.set(1))};b.prototype.handlePagePrev=function(a,b,c){1<this.viewModel.presentableResults.currPageNumber.get()&&(a=this.viewModel.presentableResults.currPageNumber.get()-1,this.viewModel.updateCurrentPageAndScrollPosWithinTab(a,0),this.viewModel.presentableResults.currPageNumber.set(a))};
b.prototype.handlePageNext=function(a,b,c){this.viewModel.presentableResults.lastPageNumber.get()>this.viewModel.presentableResults.currPageNumber.get()&&(a=this.viewModel.presentableResults.currPageNumber.get()+1,this.viewModel.updateCurrentPageAndScrollPosWithinTab(a,0),this.viewModel.presentableResults.currPageNumber.set(a))};b.prototype.handlePageLast=function(a,b,c){this.viewModel.presentableResults.currPageNumber.get()<this.viewModel.presentableResults.lastPageNumber.get()&&(a=this.viewModel.presentableResults.lastPageNumber.get(),
this.viewModel.updateCurrentPageAndScrollPosWithinTab(a,0),this.viewModel.presentableResults.currPageNumber.set(a))};b.prototype.handleTabScrollBack=function(a,b,c){a=$(this.tabContainerElement);b=a.scrollLeft()-2*this.scrollTabLeftElement.offsetWidth;a.scrollLeft(0>b?0:b);this._updateScrollTabDisabledStatus()};b.prototype.handleTabScrollForward=function(a,b,c){a=$(this.tabContainerElement);b=this.tabContainerElement.scrollWidth-this.tabContainerElement.offsetWidth;c=a.scrollLeft()+2*this.scrollTabRightElement.offsetWidth;
a.scrollLeft(c>b?b:c);this._updateScrollTabDisabledStatus()};b.prototype.handleClickFeature=function(a,b,c){this.app.event("ResultsTableFeatureClickedEvent").publish(c)};b.prototype.handleColumnHeadClick=function(a,b,c){c.sortState.set((c.sortState.get()+1)%3)};b.prototype._handleShowResultsList=function(){this.app.viewManager.deactivateView(this)};b.prototype._switchToListResultsViewImpl=function(){this.app.command("CloseBottomRegion").execute()};b.prototype._canExecuteSwitchToListResultsView=function(){return this.isActive&&
!this.app.configuration.mobileMode};b.prototype._updateScrollTabDisabledStatus=function(){if(this.tabContainerElement){var a=this.tabContainerElement.scrollWidth-this.tabContainerElement.offsetWidth;this.viewModel.leftScrollTabDisabled.set(0===this.tabContainerElement.scrollLeft);this.viewModel.rightScrollTabDisabled.set(this.tabContainerElement.scrollLeft>a-1)}};b.prototype._unbindFromPrevFeatureSet=function(){this._fsBindingToken&&this._boundFs&&this._boundFs.unbind(this._fsBindingToken);this._fsBindingToken=
this._boundFs=null};b.prototype._exportState=function(a){this.isActive&&this.viewModel.exportState(a)};b.prototype._applyState=function(a){this.viewModel.applyState(a)};return b}(g.ResultsViewBase);g.ResultsTableView=h})(h.results||(h.results={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var m=d.framework.utils.ArrayUtils,c=k.infrastructure.ui.components.Table.SortState,b=function(a){function b(c,e){a.call(this,c,e);this.curFeatureSet=new Observable(null);this.currPageWithinTab={};this.currScrollPosWithinTab={};this.presentableResults=new d.framework.ui.PresentableCollection;this.pageControlsEnabled=new Observable(!1);this.tabControlsEnabled=new Observable(!1);this.resultsTable=new Observable("results-table");this.columnSharedState=
null;this.columnHeaders=new ObservableCollection([]);this.leftScrollTabDisabled=new Observable(!1);this.rightScrollTabDisabled=new Observable(!1);this._firstVisibleTab=0;this._emptyFeatureSet=new d.essentialsHtmlViewer.mapping.infrastructure.FeatureSet({app:this.app});this._featureSetsBindingToken=this._boundFeatureSets=null;this.presentableResults.items.useThrottling=!0;this.resultsPage=this.presentableResults.items;this.presentableResults.pageSize.set(this.defaultPageSize);this.defaultIsPaged!=
this.presentableResults.isPaginated.get()&&this.presentableResults.isPaginated.set(this.defaultIsPaged);this.curFeatureSet.bind(this,this.handleCurrentFeatureSetChanged);this.presentableResults.numberOfItems.bind(this,this.updateHeaderText);this.resultsPage.bind(this,this._handlePageResultsChange);this.app.command("ShowResultsTable").register(this,this.showResultsTable);this.app.command("SwitchToListResultsView").register(this,this._switchToListResultsViewImpl,this._canExecuteSwitchToListResultsView)}
__extends(b,a);b.prototype.handleCollectionChanged=function(b){a.prototype.handleCollectionChanged.call(this,b);this.unbindFeatureSets();if(b&&b.featureSets){this._featureSetsBindingToken=b.featureSets.bind(this,this.handleFeatureSetsChanged);this._boundFeatureSets=b.featureSets;this._firstVisibleTab=0;for(var c=null,d=0;d<b.featureSets.length();d++)if(b.featureSets.getAt(d).isSelectedInCollection.get()){c=b.featureSets.getAt(d);break}!c&&0<b.featureSets.length()&&(c=b.featureSets.getAt(0));c!==this.curFeatureSet.get()&&
(this.setCurrentSelectedFeatureSet(c),this.currPageWithinTab={},this.currScrollPosWithinTab={})}};b.prototype.handleCurrentFeatureSetChanged=function(a){this.presentableResults.sortingPredicate=null;this.presentableResults.attachToCollection(a.features);this.buildColumnHeaders(a)};b.prototype.handleFeatureSetsChanged=function(b){a.prototype.handleFeatureSetsChanged.call(this,b);var c=b.sender;if("append"===b.type){0===b.rangeStart&&this.setCurrentSelectedFeatureSet(c.getAt(0));for(var d=b.rangeStart;d<=
b.rangeEnd;d++)c.getAt(d).isSelectedInCollection.get()&&this.setCurrentSelectedFeatureSet(c.getAt(d))}else"remove"===b.type&&(d=this.curFeatureSet.get())&&(d=c.indexOf(d),d>=b.rangeStart&&d<=b.rangeEnd&&(b.rangeEnd+1<c.length()?this.setCurrentSelectedFeatureSet(c.getAt(b.rangeEnd+1)):0<b.rangeStart?this.setCurrentSelectedFeatureSet(c.getAt(b.rangeStart-1)):this.setCurrentSelectedFeatureSet(null)))};b.prototype.showResultsTable=function(a){if(a="string"===typeof a?this.app.featureSetManager.getCollectionById(a):
a)a!==this.featureSetCollection.get()?(this.unbindFeatureSets(),this.featureSetCollection.set(a)):this._handlePageResultsChange(),this.app.command("_setResultMappingCommand").execute(a.sourceName,"ShowResultsTable");this.currPageWithinTab={};this.currScrollPosWithinTab={}};b.prototype._switchToListResultsViewImpl=function(){this.app.command("ShowResultsList").execute(this.featureSetCollection.get())};b.prototype._canExecuteSwitchToListResultsView=function(){return!!this.featureSetCollection.get()};
b.prototype.setCurrentSelectedFeatureSet=function(a){for(var b=this.featureSetCollection.get().featureSets,c=0;c<b.length();c++)b.getAt(c).isSelectedInCollection.set(b.getAt(c)===a);a&&this.curFeatureSet.set(a)};b.prototype.unbindFeatureSets=function(){this._featureSetsBindingToken&&this._boundFeatureSets&&this._boundFeatureSets.unbind(this._featureSetsBindingToken);this._featureSetsBindingToken=this._boundFeatureSets=null};b.prototype.buildColumnHeaders=function(a){this.columnHeaders.clear();this.columnSharedState?
this.columnSharedState.reset():this.columnSharedState=new d.essentialsHtmlViewer.mapping.infrastructure.ui.components.Table.TableColumnHeaderViewModel.SharedState(this.presentableResults,"sort","sort-up","sort-down");var b,c={};if(a.layer&&a.layer.fields)for(b=0;b<a.layer.fields.length;b++){var e=a.layer.fields[b];c[e.name]=e.dataType}e=a.attributes.length();e||(a.loadAttributes(),e=a.attributes.length());for(b=0;b<e;b++){var g=a.attributes.getAt(b);g.visible&&!g.visible.get()||this.columnHeaders.addItem(new d.essentialsHtmlViewer.mapping.infrastructure.ui.components.Table.TableColumnHeaderViewModel(this.app,
this.libraryId,this.columnSharedState,g.displayName.get(),c[g.name.get()],b))}};b.prototype.setCurrentPageWithinTab=function(a){this.currPageWithinTab[a]?this.currPageWithinTab[a]!==this.presentableResults.currPageNumber.get()&&this.presentableResults.currPageNumber.set(this.currPageWithinTab[a]):this.currPageWithinTab[a]=this.presentableResults.currPageNumber.get()};b.prototype.updateCurrentPageAndScrollPosWithinTab=function(a,b){this.currScrollPosWithinTab[this.curFeatureSet.get().uniqueId]=b;this.currPageWithinTab[this.curFeatureSet.get().uniqueId]=
a};b.prototype.exportState=function(a){var b=this.featureSetCollection.get();a.results=this.app.project.convert.fromGcxFeatureSetCollection(b);a.viewMode="table";a.page=this.presentableResults.currPageNumber.get();if(b=m.firstOrDefault(b.featureSets.get(),function(a){return a.isSelectedInCollection.get()}))if(a.tableOptions={selectedFeatureSet:this.app.project.convert.fromGcxFeatureSet(b)},b=m.firstOrDefault(this.columnHeaders.get(),function(a){return a.sortState.get()!==c.UNSORTED}))a.tableOptions.sortColumn=
this.columnHeaders.get().indexOf(b),a.tableOptions.sortDirection=b.sortState.get()===c.ASCENDING?"asc":"desc"};b.prototype.applyState=function(a){var b=this,e={results:this.app.project.convert.toGcxFeatureSetCollection(a.state.results),selectedFeatureSet:a.state.tableOptions?this.app.project.convert.toGcxFeatureSet(a.state.tableOptions.selectedFeatureSet)["catch"](function(a){}):null};a.promises.push(Promise.props(e).then(function(e){if(e.results){e.results!==b.featureSetCollection.get()&&(b.unbindFeatureSets(),
b.featureSetCollection.set(e.results));"table"===a.state.viewMode&&b.app.command("_setResultMappingCommand").execute(e.results.sourceName,"ShowResultsTable");var g=m.firstOrDefault(e.results.featureSets.get(),function(a){return a===e.selectedFeatureSet});g&&(b.setCurrentSelectedFeatureSet(g),d.framework.utils.isNullOrUndefined(a.state.page)||(b.updateCurrentPageAndScrollPosWithinTab(b.presentableResults.currPageNumber.get(),0),b.presentableResults.currPageNumber.set(a.state.page)),d.framework.utils.isNullOrUndefined(a.state.tableOptions.sortColumn)||
(g=b.columnHeaders.getAt(a.state.tableOptions.sortColumn))&&g.sortState.set("desc"===a.state.tableOptions.sortDirection?c.DESCENDING:c.ASCENDING))}}))};b.prototype._handlePageResultsChange=function(a){a=a?a:{type:null};a="clear"===a.type||"remove"===a.type&&1>=a.sender.value.length;var b=new h.eventArgs.ResultsPageChangedEventArgs;b.featureSetCollection=this.featureSetCollection.get();b.newValue=a?new ObservableCollection:this.resultsPage;this.app.event("ResultsPageChangedEvent").publish(b)};return b}(g.ResultsViewModel);
g.TabbedResultsViewModel=b})(h.results||(h.results={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(g){var k=function(){function c(b,a){var c=this;this.iconUri=new Observable("");this.text=new Observable(b);this.plainText=new Observable("");this.plainText.syncTransform(this.text,function(a){return d.FilterUtils.stripHtml(a)});this.safeText=new Observable("");this.safeText.syncTransform(this.text,function(a){return c.sanitizeText(a)})}c.prototype.sanitizeText=function(b){var a={allowFrames:!1,uriTransformer:function(a){return a}};return b?
d.FilterUtils.sanitize(b,a):""};c.prototype.toString=function(){return this.plainText.get()};return c}();g.SearchHintItem=k})(d.search||(d.search={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(){function c(){}c.POINT="POINT";c.MULTI_POINT="MULTI_POINT";c.LINE="LINE";c.POLYGON="POLYGON";c.FREEHAND_POLYGON="FREEHAND_POLYGON";c.POLYLINE="POLYLINE";c.FREEHAND_POLYLINE="FREEHAND_POLYLINE";c.RECTANGLE="RECTANGLE";c.TRIANGLE="TRIANGLE";c.CIRCLE="CIRCLE";c.ELLIPSE="ELLIPSE";c.ARROW="ARROW";c.LEFT_ARROW="LEFT_ARROW";c.RIGHT_ARROW="RIGHT_ARROW";c.UP_ARROW="UP_ARROW";c.DOWN_ARROW="DOWN_ARROW";c.EXTENT="EXTENT";return c}();
d.DrawMode=h})(d.tools||(d.tools={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){(function(g){(function(c){var b=function(a){function b(){a.apply(this,arguments);this.paneItems=new ObservableCollection;this.defaultPaneItems=new ObservableCollection;this.displayedPaneItems=new ObservableCollection;this.expanded=new Observable(!1);this.headerIsVisible=new Observable(!0);this.showXButton=new Observable(!0);this.selectorIconUri=new Observable("");this.selectorText=new Observable("")}__extends(b,a);b.prototype.initialize=
function(b){a.prototype.initialize.call(this,b);b&&(b.hasOwnProperty("headerIsVisible")&&this.headerIsVisible.set(!!b.headerIsVisible),b.hasOwnProperty("showXButton")&&this.showXButton.set(!!b.showXButton),b.hasOwnProperty("selectorIconUri")&&this.selectorIconUri.set(b.selectorIconUri),b.hasOwnProperty("selectorText")&&this.selectorText.set(b.selectorText))};b.prototype.findPaneItemById=function(a){return d.framework.utils.ArrayUtils.firstOrDefault(this.paneItems.getItems(),function(b){return b.id&&
b.id===a})};b.prototype.findDisplayedPaneItemById=function(a){return d.framework.utils.ArrayUtils.firstOrDefault(this.displayedPaneItems.getItems(),function(b){return b.id&&b.id===a})};return b}(d.essentialsHtmlViewer.mapping.infrastructure.ui.components.SmartPanel.SmartPanelViewModel);c.MultiPaneViewModel=b})(g.MultiPane||(g.MultiPane={}))})(g.components||(g.components={}))})(h.ui||(h.ui={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer=
{}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){(function(g){(function(c){var b=function(a){function b(){a.apply(this,arguments);this.currentPaneItem=new Observable(null);this.headerIsVisible=new Observable(!0);this.showXButton=new Observable(!0)}__extends(b,a);b.prototype.initialize=function(b){a.prototype.initialize.call(this,b);b&&(b.hasOwnProperty("headerIsVisible")&&this.headerIsVisible.set(!!b.headerIsVisible),b.hasOwnProperty("showXButton")&&this.showXButton.set(!!b.showXButton))};
b.prototype.onDestroy=function(){a.prototype.onDestroy.call(this);this.currentPaneItem.set(null);this.app=this.currentPaneItem=null};return b}(d.framework.ui.ViewModelBase);c.PaneViewModel=b})(g.MultiPane||(g.MultiPane={}))})(g.components||(g.components={}))})(h.ui||(h.ui={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){(function(g){(function(c){var b=function(a){function b(){a.apply(this,arguments);this._isDestroyed=!1}__extends(b,a);b.prototype.destroy=function(){a.prototype.destroy.call(this);this._isDestroyed=!0};b.prototype.onClose=function(a){};b.prototype.handleClickClose=function(a,b,c){if(this.viewModel&&this.onClose)this.onClose(this.viewModel.currentPaneItem.get());this._isDestroyed||this.app.command("DestroyView").execute(this.id)};return b}(d.framework.ui.ViewBase);
c.PaneView=b})(g.MultiPane||(g.MultiPane={}))})(g.components||(g.components={}))})(h.ui||(h.ui={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){(function(g){(function(c){var b=function(a){function b(c,d){a.call(this,c,d);this._panes=[];this.app.event("ApplicationResizedEvent").subscribe(this,this.handleApplicationResizedEvent);this.app.event("ViewDeactivatedEvent").subscribe(this,this.handleViewDeactivatedEvent)}__extends(b,a);b.prototype.activated=function(){var b=this;a.prototype.activated.call(this);this.viewModel&&this.viewModel.expanded.set(!0);setTimeout(function(){b.handleApplicationResizedEvent()},
0)};b.prototype.deactivated=function(){a.prototype.deactivated.call(this);this.viewModel&&this.viewModel.expanded.set(!1)};b.prototype.addDefaultPanes=function(){if(!(0<this.viewModel.displayedPaneItems.getLength()))for(var a=0;a<this.viewModel.defaultPaneItems.getLength();a++){var b=this.viewModel.defaultPaneItems.getAt(a);this.addPaneItem(b)}};b.prototype.addPaneItemById=function(a){a=this.viewModel.findPaneItemById(a);this.addPaneItem(a)};b.prototype.addPaneItem=function(a){throw Error("Not implemented");
};b.prototype.canAddPaneItem=function(a){return a&&this.viewModel?!this.viewModel.displayedPaneItems.contains(a):!1};b.prototype.destroyPaneItemById=function(a){a=this.viewModel.findDisplayedPaneItemById(a);this.destroyPaneItem(a)};b.prototype.destroyPaneItem=function(a){if(a&&this.canDestroyPaneItem(a)){var b=this.findPaneForPaneItem(a);if(!b)return!1;this.viewModel.displayedPaneItems.removeItem(a);this.selector.unselectItem(a);this.app.command("DestroyView").execute(b.id);0!=this.viewModel.displayedPaneItems.length()||
this.viewModel.headerIsVisible.get()||this.app.command("DeactivateView").execute(this.id);return!0}return!1};b.prototype.canDestroyPaneItem=function(a){return a&&this.viewModel?this.viewModel.displayedPaneItems.contains(a):!1};b.prototype.clearPaneItems=function(){for(var a=this.viewModel.displayedPaneItems.getLength();a--;){var b=this.viewModel.displayedPaneItems.getAt(a);this.destroyPaneItem(b)}};b.prototype.handleSelectPane=function(a){this.addPaneItem(a)};b.prototype.handleUnSelectPane=function(a){this.destroyPaneItem(a)};
b.prototype.handleClickClose=function(){this.deactivateContainer()};b.prototype.handleApplicationResizedEvent=function(){if(this.viewModel){var a=-1<this.viewModel.regionType.get().indexOf("Stack"),b=this.scrollRegionElement,c=$(".view .pane",b);a&&0!==c.length&&(a=b.clientWidth/c.length-5,$(c).width(a))}};b.prototype.handleViewDeactivatedEvent=function(a){d.framework.utils.ArrayUtils.firstOrDefault(this._panes,function(b){return a===b})&&(d.framework.utils.ArrayUtils.removeItem(this._panes,a),this.handleApplicationResizedEvent())};
b.prototype.findPaneForPaneItem=function(a){for(var b=0;b<this._panes.length;b++){var c=this._panes[b];if(c.viewModel.currentPaneItem.get()===a)return c}return null};b.prototype._executeShowMultiPaneView=function(){this.app.command("ActivateView").execute(this.id);this.addDefaultPanes();0<this.viewModel.displayedPaneItems.getLength()&&this.handleApplicationResizedEvent()};return b}(d.essentialsHtmlViewer.mapping.infrastructure.ui.components.SmartPanel.SmartPanelView);c.MultiPaneView=b})(g.MultiPane||
(g.MultiPane={}))})(g.components||(g.components={}))})(h.ui||(h.ui={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){(function(g){(function(c){var b=function(){function a(a,b,d,g,h,k){this.visible=new Observable(!0);this.value=new Observable("");this.presentableValue=new Observable("");this.columnDescriptor=new Observable("");this.sortState=new Observable(c.SortState.UNSORTED);this.sortClass=new Observable("");this._reverseSortingPredicate=this._sortingPredicate=null;this.app=a;this.libraryId=b;this.value.set(g);this.presentableValue.set(g);this.columnDescriptor.set(this.app.getResource(this.libraryId,
"language-ui-table-unsorted").format(this.presentableValue.get()));this._sharedState=d;"DateTime"===h?(this._sortingPredicate=this.buildDateSortingFunction(k),this._reverseSortingPredicate=this.buildReverseDateSortingFunction(k)):(this._sortingPredicate=this.buildSortingFunction(k),this._reverseSortingPredicate=this.buildReverseSortingFunction(k));this.sortClass.syncTransform(this.sortState,function(a){switch(a){case 1:return d.sortedClass;case 2:return d.reverseSortedClass}return d.unsortedClass});
this.sortState.bind(this,this.onSortStateChange)}a.prototype.buildSortingFunction=function(a){return function(b,c){return d.essentialsHtmlViewer.mapping.infrastructure.results.ResultsAttributeHeaderViewModel.collator(b.attributes.getAt(a).presentableValue.get(),c.attributes.getAt(a).presentableValue.get())}};a.prototype.buildReverseSortingFunction=function(a){return function(b,c){return d.essentialsHtmlViewer.mapping.infrastructure.results.ResultsAttributeHeaderViewModel.collator(c.attributes.getAt(a).presentableValue.get(),
b.attributes.getAt(a).presentableValue.get())}};a.prototype.buildDateSortingFunction=function(a){return function(b,c){var g=b.attributes.getAt(a).value.get(),k=c.attributes.getAt(a).value.get(),m=h.FormatUtils.parseDate(g),q=h.FormatUtils.parseDate(k),t="Invalid Date"!=m;return t!==("Invalid Date"!=q)?t?-1:1:t?m.getTime()-q.getTime():d.essentialsHtmlViewer.mapping.infrastructure.results.ResultsAttributeHeaderViewModel.collator(g,k)}};a.prototype.buildReverseDateSortingFunction=function(a){return function(b,
c){var g=c.attributes.getAt(a).value.get(),k=b.attributes.getAt(a).value.get(),m=h.FormatUtils.parseDate(g),q=h.FormatUtils.parseDate(k),t="Invalid Date"!=m;return t!==("Invalid Date"!=q)?t?-1:1:t?m.getTime()-q.getTime():d.essentialsHtmlViewer.mapping.infrastructure.results.ResultsAttributeHeaderViewModel.collator(g,k)}};a.prototype.onSortStateChange=function(a){if(!this._sharedState.ignoreStateChange){if(a<c.SortState.UNSORTED||a>c.SortState.DESCENDING)throw Error("Illegal column sort state: "+a);
if(0==a){if(this._sharedState.lastSortedColumn!=this)throw Error("Column sort state out of sync");this._sharedState.lastSortedColumn=null;this._sharedState.presentableResults.sortingPredicate=null;this._sharedState.presentableResults.unsortCollection();this.columnDescriptor.set(this.app.getResource(this.libraryId,"language-ui-table-unsorted").format(this.presentableValue.get()))}else{null!=this._sharedState.lastSortedColumn&&this._sharedState.lastSortedColumn!=this&&(this._sharedState.ignoreStateChange=
!0,this._sharedState.lastSortedColumn.sortState.set(c.SortState.UNSORTED),this._sharedState.ignoreStateChange=!1);this._sharedState.lastSortedColumn=this;if(a==c.SortState.ASCENDING)this._sharedState.presentableResults.sortingPredicate=this._sortingPredicate,this.columnDescriptor.set(this.app.getResource(this.libraryId,"language-ui-table-sorted-ascending").format(this.presentableValue.get()));else if(a==c.SortState.DESCENDING)this._sharedState.presentableResults.sortingPredicate=this._reverseSortingPredicate,
this.columnDescriptor.set(this.app.getResource(this.libraryId,"language-ui-table-sorted-descending").format(this.presentableValue.get()));else throw Error("Invalid column sort state.");this._sharedState.presentableResults.sortCollection()}}};return a}();c.TableColumnHeaderViewModel=b;(function(a){a.manualCollator=function(a,b){return isNaN(a)||isNaN(b)?a<b?-1:a>b?1:0:+a-b};a.collator="object"==typeof Intl&&"function"==typeof Intl.Collator?(new Intl.Collator(void 0,{numeric:!0})).compare:d.essentialsHtmlViewer.mapping.infrastructure.results.ResultsAttributeHeaderViewModel.manualCollator;
var b=function(){function a(b,c,d,e){this.lastSortedColumn=null;this.presentableResults=b;this.unsortedClass=c;this.sortedClass=d;this.reverseSortedClass=e;this.reset()}a.prototype.reset=function(){this.ignoreStateChange=!1;this.lastSortedColumn=null};return a}();a.SharedState=b})(b=c.TableColumnHeaderViewModel||(c.TableColumnHeaderViewModel={}))})(g.Table||(g.Table={}))})(g.components||(g.components={}))})(h.ui||(h.ui={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||
(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));(function(d){(function(d){(function(d){(function(d){(function(d){(function(d){(function(c){var b=function(){return function(){}}();c.TableColumnViewModelInterface=b})(d.Table||(d.Table={}))})(d.components||(d.components={}))})(d.ui||(d.ui={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){(function(d){(function(c){var b=function(a){function b(){a.apply(this,arguments)}__extends(b,a);return b}(c.TableColumnViewModelInterface);c.TableColumnHeaderViewModelInterface=b})(d.Table||(d.Table={}))})(d.components||(d.components={}))})(d.ui||(d.ui={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){(function(g){(function(c){var b=function(a){function b(){a.apply(this,arguments);this._pressStartTime=this._longPressTimer=this.tableContainerElement=null;this._ignoreMouseEventFlag=this._firedTouchOrPress=!1;this._lastTouchY=this._pressYStart=null;this._scrollYDeltaThreshold=35;this._firstEvent=null}__extends(b,a);b.prototype.handleColumnHeadClick=function(a,b,c){c.sortState.set((c.sortState.get()+1)%3)};b.prototype.handleMouseDown=
function(a,b,c){this._beginLongPressIfNoEventsInProgress(c,"mouse-down");return!0};b.prototype.handleMouseUp=function(a,b,c){this._cancelLongPressIfEventInProgress("mouse-down");return!0};b.prototype.handleTouchStart=function(a,b,c){this._beginLongPressIfNoEventsInProgress(c,"touch-start");return!0};b.prototype.handleTouchMove=function(a,b,c){return this.handleTouchEnd(a,b,c)};b.prototype.handleTouchEnd=function(a,b,c){this._cancelLongPressIfEventInProgress("touch-start");return!0};b.prototype.handleClick=
function(a,b,c){var d=this;this.viewModel&&this.viewModel.recordClickEvents.length&&this.viewModel.recordClickEvents.forEach(function(a){return d.app.event(a).publish(c)});return!0};b.prototype.handleClickAttributelink=function(a,b,c){return this.app.followNavigationLink({url:c.value.get(),element:b})};b.prototype._beginLongPressIfNoEventsInProgress=function(a,b){this._firstEvent||(this._firstEvent=b,this._beginLongPress(a))};b.prototype._cancelLongPressIfEventInProgress=function(a){this._firstEvent===
a&&(this._firstEvent=null,this._cancelLongPress())};b.prototype._beginLongPress=function(a){var b=this;this._cancelLongPress();this.viewModel&&this.viewModel.recordLongPressEvents.length&&(this._longPressTimer=setTimeout(function(){b.viewModel.recordLongPressEvents.forEach(function(c){b.app.event(c).publish(a)},b.viewModel.recordLongPressDuration||1E3)}))};b.prototype._cancelLongPress=function(){this._longPressTimer&&(clearTimeout(this._longPressTimer),this._longPressTimer=null)};return b}(d.framework.ui.ViewBase);
c.TableView=b})(g.Table||(g.Table={}))})(g.components||(g.components={}))})(h.ui||(h.ui={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){(function(g){(function(c){var b=function(a){function b(c,d){a.call(this,c,d);this.columnHeaders=new ObservableCollection([]);this.records=new ObservableCollection([]);this.presentableRecordCollection=null;this.recordClickEvents=[];this.recordLongPressEvents=[];this.recordLongPressDuration=1E3}__extends(b,a);b.prototype.attachToPresentableCollection=function(a){a&&a instanceof d.framework.ui.PresentableCollection&&(this.presentableRecordCollection=
a,this.records=this.presentableRecordCollection.items)};b.prototype.addRecordClickEvents=function(a){this._executeAddEvents(a,0)};b.prototype.addRecordLongPressEvents=function(a){this._executeAddEvents(a,1)};b.prototype._executeAddEvents=function(a,b){var c=this,d=function(a){a&&"string"===typeof a&&(0===b?(c.recordClickEvents=c.recordClickEvents.filter(function(b){return b!==a}),c.recordClickEvents.push(a)):1===b&&(c.recordLongPressEvents=c.recordLongPressEvents.filter(function(b){return b!==a}),
c.recordLongPressEvents.push(a)))};a&&dojo.isArray(a)?a.forEach(function(a){return d(a)}):d(a)};return b}(d.framework.ui.ViewModelBase);c.TableViewModel=b})(g.Table||(g.Table={}))})(g.components||(g.components={}))})(h.ui||(h.ui={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(){function c(b,a,c){void 0===a&&(a="[anonymous]");void 0===c&&(c={});if(!b)throw Error("Transaction manager is required");this.owner=b;this.displayName=a;this.state=c;this.transactionStatus=d.TransactionStatus.PENDING;this.changes=[]}c.prototype.isTopLevel=function(){return!this.parentTransaction};c.prototype.isComplete=function(){return this.isCommitted()||this.isAborted()};c.prototype.isAborted=function(){return this.transactionStatus==
d.TransactionStatus.ABORTED};c.prototype.isCommitted=function(){return this.transactionStatus==d.TransactionStatus.COMMITTED};c.prototype.add=function(b,a,d){void 0===d&&(d={});a&&!this.isComplete()&&(b=a instanceof c?a:this._wrapInTransaction(b,a,d),this.changes.push(b))};c.prototype._wrapInTransaction=function(b,a,e){void 0===e&&(e={});a.state=a.state||e;b=new c(this.owner,b);b.transactionStatus=d.TransactionStatus.PENDING;b.parentTransaction=this;b.changes.push(a);return b};c.prototype.hasChanges=
function(){return 0<this.changes.length};c.prototype.commit=function(){return this.owner.commitTransaction(this)};c.prototype.rollback=function(){return this.owner.rollbackTransaction(this)};c.prototype.performUndo=function(b,a){var c=this;return this.hasChanges()?Promise.reduce(this.changes.slice().reverse(),function(a,b){if(b)return b.performUndo(b.state,c)},null):Promise.resolve()};c.prototype.performRedo=function(b,a){var c=this;return this.hasChanges()?Promise.reduce(this.changes,function(a,
b){if(b)return b.performRedo(b.state,c)},null):Promise.resolve()};return c}();d.UndoTransaction=h})(d.undo||(d.undo={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(g){function k(a){var b="";if(!a)return b;for(var c=a.keys(),d=0;d<c.length;d++)0<b.length&&(b+="&"),b+="{0}={1}".format(c[d],a.get(c[d]));return"{0}{1}".format(0<b.length?"?":"",b)}function c(a){var b=new d.Dictionary;if(!a)return b;a.startsWith("?")&&(a=a.slice(1));a.split(/[&;]/g).forEach(function(a){a&&(a=a.split("=",2),b.set(a[0],a[1]))});return b}function b(a){var b=document.createElement("a");b.href=a;return b}g.queryStringDictionaryToString=
k;g.queryStringToDictionary=c;g.parseUrl=b;g.addQueryParameter=function(a,d,f){a=b(a);var g=c(a.search);g.set(d,f);a.search=k(g);return a.toString()};g.removeQueryParameter=function(a,d){var f=b(a),g=c(f.search);g.remove(d);f.search=k(g);return f.toString()};g.getFolder=function(a){a="string"===typeof a?b(a):dojo.clone(a);var c=null==a.pathname?"":a.pathname;if(null==c)return a;c=c.split("/");0<=c[c.length-1].indexOf(".")&&(c.pop(),a.pathname=c.join("/"));a.pathname.endsWith("/")||(a.pathname+="/");
a.search="";a.hash="";a.href=a.href.replace(/[\?#]+$/,"");return a};g.removeParameters=function(a){a="string"===typeof a?b(a):dojo.clone(a);if(null==(null==a.pathname?"":a.pathname))return a;a.pathname.endsWith("/")||(a.pathname+="/");a.search="";a.hash="";a.href=a.href.replace(/[\?#]+$/,"");return a}})(d.UrlUtils||(d.UrlUtils={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var k=function(){function c(){}c.prototype.validate=function(b,a){var c=a&&!!a.invalidNumbersAsNaN,f=h.FormatUtils.parseNumber(b);return d.framework.utils.isNullOrUndefined(b)?Promise.resolve({validatedValue:b}):isNaN(f)&&!c?Promise.reject(Error("Invalid number.")):Promise.resolve({validatedValue:f})};return c}();g.NumberValidator=k})(h.validation||(h.validation={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping=
{}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var k=function(){function c(b){if(!b)throw Error('Argument "app" is required.');this.app=b;this._initializeAllowedUrls();this.app.command("ClearTrustedUrls").register(this,this.executeClearTrustedUrls)}c.prototype.executeClearTrustedUrls=function(){for(var b=Object.keys(window.localStorage),a=0;a<b.length;a++)b[a].match("^uri.markup|^uri.css|^uri.navigablelink")&&window.localStorage.removeItem(b[a])};c.prototype.validate=function(b,
a){var c=this;return b?"string"!==typeof b?Promise.reject(Error("Input is not a URL.")):this._initializeAllowedUrls().then(function(){var a=h.UrlUtils.parseUrl(d.essentials.RestHelper.processClientSideTokens(c.app.site,b));if(c._allowedUrls.some(function(b){return c._isMatch(b,a)}))return Promise.resolve({validatedValue:b});var g="The following URL is not defined by this Essentials site and will be skipped: {0}".format(b);return Promise.reject(g)}):Promise.resolve({validatedValue:b})};c.prototype.tryValidateSynchronously=
function(b){var a=this;if(!this._allowedUrls)return!1;var c=h.UrlUtils.parseUrl(d.essentials.RestHelper.processClientSideTokens(this.app.site,b));return this._allowedUrls.some(function(b){return a._isMatch(b,c)})};c.prototype._isMatch=function(b,a){return"mailto:"===a.protocol?!0:d.framework.utils.isNullOrUndefined(a.pathname)?!1:a.host==b.host&&a.protocol==b.protocol&&(a.pathname.startsWith(b.pathname)||a.pathname+"/"===b.pathname)};c.prototype._initializeAllowedUrls=function(){var b=this;return this._allowedUrls?
Promise.resolve():this.app.waitUntilSiteInitialized().then(function(){var a=b.app.site;b._allowedUrls=[];b._allowUrl(a.url);b._allowUrl("http://localhost:8181");b._allowUrl("http://127.0.0.1:8181");for(var c=0;c<a.trustedUrls.length;c++)b._allowUrl(a.trustedUrls[c].url);a.properties.trustedUrls&&a.properties.trustedUrls.split(",").forEach(function(a){b._allowUrl(a)});a.essentialsMap&&a.essentialsMap.mapServices.filter(function(a){return!a.isUserCreated}).forEach(function(a){b._allowUrl(a.serviceUrl);
b._allowUrl(a.tileRestUrl);b._allowUrl(a.mapUrl);b._allowUrl(a.iconUri);(a.layerHyperlinks||[]).forEach(function(a){b._allowUrl(a.uri);b._allowUrl(a.iconUri)});(a.layers||[]).forEach(function(a){b._allowUrl(a.getLayerUrl());b._allowUrl(a.legendUrl);b._allowUrl(a.iconUri);(a.featureHyperlinks||[]).forEach(function(a){b._allowUrl(a.uri);b._allowUrl(a.iconUri)});(a.layerHyperlinks||[]).forEach(function(a){b._allowUrl(a.uri);b._allowUrl(a.iconUri)});b._extractUrls(a.featureLabel).forEach(function(a){return b._allowUrl(a)});
b._extractUrls(a.featureDescription).forEach(function(a){return b._allowUrl(a)});b._extractUrls(a.featureLongDescription).forEach(function(a){return b._allowUrl(a)})})})})};c.prototype._allowUrl=function(b){if(b)try{this._allowedUrls.push(h.UrlUtils.getFolder(b))}catch(a){}};c.prototype._extractUrls=function(b){return b?(b.match(/(https?:\/\/[A-Za-z0-9\-\._~:\/\?#[\]@!\$&'()*\+,;=%]+)/g)||[]).map(function(a){return 0<=a.indexOf("{")?a.slice(0,a.indexOf("{")):a}):[]};return c}();g.SiteUrlValidator=
k})(h.validation||(h.validation={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var h=function(c){function b(a,b){c.call(this,a);this._serviceDiscovery=null;if(!a)throw Error('Argument "app" is required.');this.app=a;b&&this.setDiscoveryProvider(b)}__extends(b,c);b.prototype.getDiscoveryProvider=function(){return this._serviceDiscovery};b.prototype.setDiscoveryProvider=function(a){this._serviceDiscovery=a};b.prototype.validate=function(a,b){var d=this;return a?"string"!==typeof a?Promise.reject(Error("Input is not a URL.")):
this._initializeDiscoveryProvider().then(function(){return c.prototype.validate.call(d,a,b)})["catch"](function(){return d._validate(a,b)}):Promise.resolve({validatedValue:a})};b.prototype._validate=function(a,b){var c=d.essentials.RestHelper.processClientSideTokens(this.app.site,a),g="The following URL is not allowed by this Essentials service connection whitelist and will be skipped: "+a;return Promise.resolve(this._serviceDiscovery.findServices(c)).then(function(b){if(b&&0<b.length&&b[0].isWhitelisted)return Promise.resolve({validatedValue:a});
throw Error(g);})["catch"](function(){return Promise.reject(Error(g))})};b.prototype._initializeDiscoveryProvider=function(){var a=this;return this._serviceDiscovery?Promise.resolve():this.app.waitUntilSiteInitialized().then(function(){var b=a.app.site,c=new d.essentials.serviceDiscovery.SiteServiceDiscoveryProvider;c.initialize(b);a.setDiscoveryProvider(c)})};return b}(g.SiteUrlValidator);g.ServiceDiscoveryUrlValidator=h})(h.validation||(h.validation={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||
(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(g){var k=function(){function c(b){void 0===b&&(b={});this._tokenLeft="{";this._tokenRight="}";this._tokenLeftEscaped="\\{";this._tokenRightEscaped="\\}";b.contentPolicy&&(this._contentPolicy=b.contentPolicy)}c.prototype.validate=function(b,a){var c=this;void 0===a&&(a={XssHtmlValidator:{}});var d={html:b,uris:[],contentPolicy:this._contentPolicy||a.XssHtmlValidator.defaultContentPolicy};if(!d.contentPolicy)throw Error("XssHtmlValidator cannot perform validation without a ContentPolicy instance.");
var g=a.sanitizeOptions;return Promise.resolve(d).then(function(a){return c._escape(a)}).then(function(a){return c._sanitize(a,g)}).then(function(a){return c._runUrisThroughContentPolicy(a)}).then(function(a){return c._applyUris(a)}).then(function(a){return c._unescape(a)}).then(function(a){return{validatedValue:a.html}})};c.prototype._escape=function(b){b.html=b.html.split(this._tokenLeft).join(this._tokenLeftEscaped);b.html=b.html.split(this._tokenRight).join(this._tokenRightEscaped);return b};
c.prototype._sanitize=function(b,a){var c=this;void 0===a&&(a={});var f=a?a.uriTransformer:null;a.uriTransformer=function(g,k){f&&(g=f(g,k),k.uri=g);if(a.allowArbitraryHyperlinks&&k.type===d.FilterUtils.UriType.NavigableLink)return g;b.uris.push(k);return c._tokenize(b.uris.length-1)};b.html=d.FilterUtils.sanitize(b.html,a);return b};c.prototype._runUrisThroughContentPolicy=function(b){return this._contentPolicy?this._contentPolicy.screenUris(b.uris).then(function(a){return b}):b.contentPolicy.screenUris(b.uris).then(function(a){return b})};
c.prototype._applyUris=function(b){var a=this;b.uris.forEach(function(c,d){var g=a._tokenize(d);b.html=b.html.replace(g,c.uri)});return b};c.prototype._unescape=function(b){b.html=b.html.split(this._tokenLeftEscaped).join(this._tokenLeft);b.html=b.html.split(this._tokenRightEscaped).join(this._tokenRight);return b};c.prototype._tokenize=function(b){return this._tokenLeft+b.toString()+this._tokenRight};return c}();g.XssHtmlValidator=k})(d.validation||(d.validation={}))})(d.infrastructure||(d.infrastructure=
{}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){d.getFeatureHeatMap=function(d){return d&&d.mapService?(d.includeInLegend&&d.mapService.heatMap&&(d.mapService.heatMap.includeInLegend=d.includeInLegend),d.mapService.heatMap):null};d.getHeatMapRenderer=function(d){if(!d||!d.mapService||!d.mapService.serviceLayer)return null;d=d.mapService.serviceLayer.renderer;return d instanceof esri.renderer.HeatmapRenderer?d:null}})(d.VisualizationUtils||(d.VisualizationUtils={}))})(d.infrastructure||
(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){g.WIDGET_ID_BASE="__CLASSWIDGET__";var h=function(c){function b(){c.apply(this,arguments);this.configuring=!1}__extends(b,c);b.prototype.attach=function(a){a.initialize(this.configuration);c.prototype.attach.call(this,a)};b.prototype.added=function(a){a.attributeSettingsWidget=this;c.prototype.added.call(this,a);this._setupJQuerySliders()};b.prototype.applyConfiguration=function(){var a=this;this.configuring=!0;$(this.classBreaksSlider).slider("option",
"value",this.viewModel.numBreaks.get());this.startColorInput.value=this.viewModel.startColors[0].toHex();this.viewModel.startColorSwatches.set(this.viewModel.startColors.map(function(a){return{hex:a.toHex()}}));this.viewModel.startColorSwatches.get().forEach(function(b,c){a.startColorSwatchFieldSet.children[c].style.backgroundColor=b.hex});this.startColorSwatchFieldSet.querySelector(".start-color-swatch:first-child > input[type=radio]").checked=!0;this.endColorInput.value=this.viewModel.endColors[0].toHex();
this.viewModel.endColorSwatches.set(this.viewModel.endColors.map(function(a){return{hex:a.toHex()}}));this.viewModel.endColorSwatches.get().forEach(function(b,c){a.endColorSwatchFieldSet.children[c].style.backgroundColor=b.hex});this.endColorSwatchFieldSet.querySelector(".end-color-swatch:first-child > input[type=radio]").checked=!0;$(this.transparencySlider).slider("option","value",this.viewModel.transparency.get());$(this.markerSizeSlider).slider("option","value",this.viewModel.markerSize.get());
$(this.lineWidthSlider).slider("option","value",this.viewModel.lineWidth.get());this.markerStyleInput.selectedIndex=0<=this.viewModel.markerStyleIndex?this.viewModel.markerStyleIndex:0;for(var b=0,c=this.viewModel.classSymbolWidgets;b<c.length;b++)c[b].applyConfiguration();this.configuring=!1;this.handleChange()};b.prototype.reset=function(){this.viewModel.reset();if(!this.viewModel.currentAttribute.get()){var a=document.createElement("option");a.disabled=!0;a.selected=!0;a.hidden=!0;a.value="";a.text=
this.app.getResource(this.libraryId,"language-symbology-settings-attribute-select");this.attributeInput.add(a,0)}};b.prototype.handleChange=function(){var a=this;if(!this.configuring){var b;(b=this.viewModel.attributes.getLength()<this.attributeInput.length?this.viewModel.attributes.getAt(this.attributeInput.selectedIndex-1):this.viewModel.attributes.getAt(this.attributeInput.selectedIndex))&&(b.displayName!==this.viewModel.currentAttribute.get()||!this.viewModel.symbolizing&&this.viewModel.isNumericAttribute.get()&&
this.viewModel.numBreaks.get()!==this.viewModel.symbologyClasses.getLength())&&(this.app.command("RemoveResultsStatus").execute(),this.viewModel.symbolizing=!0,this.viewModel.getFieldInfo(b).then(function(c){c={field:b,fieldInfo:c};b.dataType===d.essentials.EssentialsFieldTypes.essentialsFieldTypeString||c.fieldInfo.isCodedValueDomain()||c.fieldInfo.hasSubtypeCodedValueDomains()?(a.viewModel.classBreaksMode.set(!1),a.viewModel.isNumericAttribute.set(!1),a.viewModel.createUniqueValues(c)):(a.viewModel.classBreaksMode.set(!0),
a.viewModel.isNumericAttribute.set(!0),a.viewModel.createClassBreaks(c))}),this.viewModel.currentAttribute.set(b.displayName));if(this.viewModel.isNumericAttribute.get()){this.viewModel.selectedStartSwatch=this._getSelectedColorSwatch(this.viewModel.startColorSwatches.getItems(),this.startColorSwatchFieldSet);this.viewModel.selectedEndSwatch=this._getSelectedColorSwatch(this.viewModel.endColorSwatches.getItems(),this.endColorSwatchFieldSet);var c=this.viewModel.useColorSwatches.get()?new g.SymbolColor(this.viewModel.selectedStartSwatch.hex):
new g.SymbolColor(this.startColorInput.value),l=this.viewModel.useColorSwatches.get()?new g.SymbolColor(this.viewModel.selectedEndSwatch.hex):new g.SymbolColor(this.endColorInput.value);this.viewModel.startColors[0].equals(c)||(this.viewModel.startColors[0]=c,this.viewModel.createRendererClasses());this.viewModel.endColors[0].equals(l)||(this.viewModel.endColors[0]=l,this.viewModel.createRendererClasses())}if(!this.viewModel.symbolizing&&this.viewModel.markerStyleIndex!==this.markerStyleInput.selectedIndex)for(this.viewModel.markerStyleIndex=
this.markerStyleInput.selectedIndex,c=0,l=this.viewModel.classSymbolWidgets;c<l.length;c++){var h=l[c];h.viewModel.markerStyleIndex=this.markerStyleInput.selectedIndex;h.applyConfiguration()}}};b.prototype.handleSymbolClassSelected=function(a){var b=this;a=a.currentTarget.children[0];var c=a.textContent||a.innerText;a=this.viewModel.symbologyClasses.getItems().filter(function(a){return a.name===c})[0];var d=this.viewModel.symbologyClasses.indexOf(a);if(c===this.viewModel.selectedClass)this.viewModel.selectedClass=
null,a.selected=!1,a.color=this.viewModel.classSymbolWidgets[d].viewModel.getColor().toHex();else{var g=this.viewModel.symbologyClasses.getItems().filter(function(a){return a.name===b.viewModel.selectedClass})[0],h=this.viewModel.symbologyClasses.indexOf(g),h=this.viewModel.classSymbolWidgets[h];g&&(g.selected=!1,g.color=h.viewModel.getColor().toHex());this.viewModel.selectedClass=c;a.selected=!0}this.viewModel.symbologyClasses.pulse();$(this.viewModel.classSymbolWidgets[d].container).appendTo($("#"+
a.widgetId))};b.prototype._setupJQuerySliders=function(){var a=this,b=this.viewModel.config;$(this.classBreaksSlider).slider({min:2,max:this.viewModel.maxRenderClasses,value:5,step:1,slide:function(b,c){return a._handleSliderValueChanged(b,c,a.viewModel.numBreaks)}});$(this.transparencySlider).slider({min:b.transparency.min,max:b.transparency.max,value:b.transparency.value,step:b.transparency.step,slide:function(b,c){a._handleSliderValueChanged(b,c,a.viewModel.transparency);if(!a.viewModel.symbolizing)for(var d=
0,e=a.viewModel.classSymbolWidgets;d<e.length;d++){var f=e[d];f.viewModel.transparency.set(c.value);f.applyConfiguration()}}});$(this.markerSizeSlider).slider({min:b.markerSize.min,max:b.markerSize.max,value:b.markerSize.value,step:b.markerSize.step,slide:function(b,c){a._handleSliderValueChanged(b,c,a.viewModel.markerSize);if(!a.viewModel.symbolizing)for(var d=0,e=a.viewModel.classSymbolWidgets;d<e.length;d++){var f=e[d];f.viewModel.markerSize.set(c.value);f.applyConfiguration()}}});$(this.lineWidthSlider).slider({min:b.lineWidth.min,
max:b.lineWidth.max,value:b.lineWidth.value,step:b.lineWidth.step,slide:function(b,c){a._handleSliderValueChanged(b,c,a.viewModel.lineWidth);if(!a.viewModel.symbolizing)for(var d=0,e=a.viewModel.classSymbolWidgets;d<e.length;d++){var f=e[d];f.viewModel.lineWidth.set(c.value);f.applyConfiguration()}}});for(var b=0,c=this.viewModel.classSymbolWidgets;b<c.length;b++)c[b].setupJQuerySliders();$(this.classBreaksSlider).add(this.transparencySlider).add(this.markerSizeSlider).add(this.lineWidthSlider).off("slidechange").on("slidechange",
function(b){b=document.createEvent("Event");b.initEvent("change",!0,!0);a.container.dispatchEvent(b)})};b.prototype._handleSliderValueChanged=function(a,b,c){b&&void 0!=b.value&&c.set(b.value)};b.prototype._getSelectedColorSwatch=function(a,b){for(var c=0;c<a.length;c++){var d=a[c];if(b.children[c].querySelector("input[type=radio]").checked)return d}};return b}(d.framework.ui.ViewBase);g.AttributeSymbologySettingsView=h})(h.visualization||(h.visualization={}))})(k.infrastructure||(k.infrastructure=
{}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var m=function(c){function b(){c.apply(this,arguments);this.attributes=new ObservableCollection;this.currentAttribute=new Observable("");this.classBreaksMode=new Observable(!1);this.isNumericAttribute=new Observable(!1);this.symbologyClasses=new ObservableCollection([]);this.classSymbolWidgets=[];this.numBreaks=new Observable(5);this.useColorSwatches=new Observable(!0);this.startColorSwatches=new ObservableCollection;this.endColorSwatches=
new ObservableCollection;this.markerSize=new Observable(10);this.lineWidth=new Observable(2);this.transparency=new Observable(10);this.noMarker=new Observable(!1);this.markerStyles=new ObservableCollection([{style:esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,label:this.getResource("language-symbology-settings-marker-style-circle")},{style:esri.symbol.SimpleMarkerSymbol.STYLE_CROSS,label:this.getResource("language-symbology-settings-marker-style-cross")},{style:esri.symbol.SimpleMarkerSymbol.STYLE_DIAMOND,
label:this.getResource("language-symbology-settings-marker-style-diamond")},{style:esri.symbol.SimpleMarkerSymbol.STYLE_SQUARE,label:this.getResource("language-symbology-settings-marker-style-square")},{style:esri.symbol.SimpleMarkerSymbol.STYLE_X,label:this.getResource("language-symbology-settings-marker-style-x")}]);this.markerStyleIdLookup={circle:"esriSMSCircle",cross:"esriSMSCross",diamond:"esriSMSDiamond",square:"esriSMSSquare",x:"esriSMSX"};this.queryResults=[];this.symbolizing=!1}__extends(b,
c);b.prototype.initialize=function(a){void 0===a&&(a={});this.config=a;this.maxRenderClasses=1<this.config.maxRenderClasses?this.config.maxRenderClasses:12;this.maxSamples=this.config.maxSamples||1E3;a.numberOfColorSwatches=a.numberOfColorSwatches?6:a.numberOfColorSwatches;this.defaultLineSymbol=new esri.symbol.SimpleLineSymbol;this.defaultLineSymbol.setColor(new esri.Color(this.config.defaultLineColor||[75,75,75,1]));this.defaultLineSymbol.setWidth(this.config.defaultLineWidth||2);this.defaultPointSymbol=
new esri.symbol.SimpleMarkerSymbol;this.defaultPointSymbol.setColor(new esri.Color(this.config.defaultPointColor||[150,150,150,0.8]));this.defaultPointSymbol.setSize(this.config.defaultPointSize||12);this.defaultPointSymbol.setOutline(this.defaultLineSymbol);this.defaultPolygonSymbol=new esri.symbol.SimpleFillSymbol;this.defaultPolygonSymbol.setColor(new esri.Color(this.config.defaultFillColor||[150,150,150,0.3]));this.defaultPolygonSymbol.setOutline(this.defaultLineSymbol);for(var b=0;b<this.maxRenderClasses;b++){var c=
void 0,c=this.app.viewManager.createView({markupResource:"Mapping/infrastructure/visualization/SymbologySettings/SymbologySettingsView.html",typeName:"geocortex.essentialsHtmlViewer.mapping.infrastructure.visualization.SymbologySettingsView",isVisible:!0,libraryId:"Mapping.Infrastructure"}),d=new h.visualization.SymbologySettingsViewModel(this.app,"Mapping.Infrastructure");c.attach(d);d.initialize(this.config.defaultSymbologySettingsConfig);c.applyConfiguration();this.classSymbolWidgets.push(c)}this.useColorSwatches.set(a.alwaysUseColorSwatches||
!h.ColorUtils.isColorInputSupported());this.startColors=h.ColorUtils.generateRandomColors(a.numberOfColorSwatches);this.endColors=h.ColorUtils.generateRandomColors(a.numberOfColorSwatches);b=h.ColorUtils.generateRandomColor();this.startColors[0]=b.lighten(0.9);this.endColors[0]=b.darken(0.6);this.config.transparency=a.transparency?a.transparency:{min:0,max:90,value:10,step:5};this.transparency.set(this.config.transparency.value);this.config.markerSize=a.markerSize?a.markerSize:{min:1,max:50,value:10,
step:1};this.markerSize.set(this.config.markerSize.value);this.config.lineWidth=a.lineWidth?a.lineWidth:{min:0,max:5,value:2,step:1};this.lineWidth.set(this.config.lineWidth.value);this.markerStyles.set(this.classSymbolWidgets[0].viewModel.markerStyles.getItems());this.markerStyleIndex=0};b.prototype.reset=function(){this.attributes.set([]);this.currentAttribute.set("");this.classBreaksMode.set(!1);this.isNumericAttribute.set(!1);this.symbologyClasses.set([]);this.selectedClass="";this.transparency.set(this.config.transparency.value);
this.markerSize.set(this.config.markerSize.value);this.lineWidth.set(this.config.lineWidth.value);this.markerStyleIndex=0;this.startColors=h.ColorUtils.generateRandomColors(this.config.numberOfColorSwatches);this.endColors=h.ColorUtils.generateRandomColors(this.config.numberOfColorSwatches);var a=h.ColorUtils.generateRandomColor();this.startColors[0]=a.lighten(0.9);this.endColors[0]=a.darken(0.6);for(var a=0,b=this.classSymbolWidgets;a<b.length;a++)b[a].reset();this.queryResults=[]};b.prototype.getRenderer=
function(){var a=this,b;if(0===this.symbologyClasses.getLength())return"";b="Point"===this.featureType?this.defaultPointSymbol:"Line"===this.featureType?this.defaultLineSymbol:this.defaultPolygonSymbol;var c=this.attributes.getItems().filter(function(b){return b.displayName===a.currentAttribute.get()})[0];if(this.classBreaksMode.get())for(b=new esri.renderer.ClassBreaksRenderer(b,c.name),c=0;c<this.symbologyClasses.getLength();c++){var d=this.symbologyClasses.getAt(c),g=this.classSymbolWidgets[c];
b.addBreak({minValue:d.min,maxValue:d.max,symbol:esri.symbol.fromJson(JSON.parse(g.viewModel.getSymbol())),label:d.name})}else for(b=new esri.renderer.UniqueValueRenderer(b,c.name),c=0;c<this.symbologyClasses.getLength();c++)d=this.symbologyClasses.getAt(c),g=this.classSymbolWidgets[c],b.addValue({value:d.value,symbol:esri.symbol.fromJson(JSON.parse(g.viewModel.getSymbol())),label:d.name});return JSON.stringify(b.toJson())};b.prototype.setFromRenderer=function(a){var b=this,c=a.toJson();this.symbolizing=
!0;var h=this.attributes.getItems().filter(function(a){return a.name===c.field||a.name===c.field1})[0];this.getFieldInfo(h).then(function(a){b.isNumericAttribute.set(h.dataType!==d.essentials.EssentialsFieldTypes.essentialsFieldTypeString&&!b.hasCodedDomain(a));if("classBreaks"===c.type){b.classBreaksMode.set(!0);var k=c.minValue;b.numBreaks.set(c.classBreakInfos.length);for(var m=function(d){var h=c.classBreakInfos[d],l=b.classSymbolWidgets[d],m=new esri.Color(h.symbol.color);l.reset();l.viewModel.noMarker.set("Point"!==
b.featureType);l.viewModel.noFill.set("Polygon"!==b.featureType);l.viewModel.setFromSymbol(esri.symbol.fromJson(h.symbol));l.applyConfiguration();h.classMinValue&&(k=h.classMinValue);b.symbologyClasses.addItem({name:a.formatValue(k)+" - "+a.formatValue(h.classMaxValue),min:k,max:h.classMaxValue,color:m.toHex(),selected:!1,widgetId:g.WIDGET_ID_BASE+d.toString()});k=h.classMaxValue;0===d&&(b.startColors[0]=new g.SymbolColor(m.toHex()),b.transparency.set(Math.floor(Math.ceil((255-h.symbol.color[3])/
255*100)/b.config.transparency.step)*b.config.transparency.step),b.markerSize.set($.isNumeric(h.symbol.size)?Math.floor(h.symbol.size*g.POINTS_TO_PIXELS):b.config.markerSize.value),l=b.markerStyles.getItems().filter(function(a){return b.markerStyleIdLookup[a.style]===h.symbol.style})[0],b.markerStyleIndex=l?b.markerStyles.indexOf(l):0,l="Point"!==b.featureType&&"Polygon"!==b.featureType?h.symbol:h.symbol.outline,b.lineWidth.set($.isNumeric(l.width)?Math.floor(l.width*g.POINTS_TO_PIXELS):b.config.lineWidth.value));
d===c.classBreakInfos.length-1&&(b.endColors[0]=new g.SymbolColor(m.toHex()))},q=0;q<c.classBreakInfos.length;q++)m(q)}else if("uniqueValue"===c.type)for(b.classBreaksMode.set(!1),m=function(d){var h=c.uniqueValueInfos[d],l=b.classSymbolWidgets[d],k=new esri.Color(h.symbol.color);l.reset();l.viewModel.noMarker.set("Point"!==b.featureType);l.viewModel.noFill.set("Polygon"!==b.featureType);l.viewModel.setFromSymbol(esri.symbol.fromJson(h.symbol));l.applyConfiguration();l=void 0;if(a.isCodedValueDomain()||
a.hasSubtypeCodedValueDomains())l=a.esriField.domain.getName(h.value);l||(l=a.formatValue(h.value));b.symbologyClasses.addItem({name:l,value:h.value,color:k.toHex(),selected:!1,widgetId:g.WIDGET_ID_BASE+d.toString()});0===d&&(b.startColors[0]=new g.SymbolColor(k.toHex()),b.transparency.set(Math.floor(Math.ceil((255-h.symbol.color[3])/255*100)/b.config.transparency.step)*b.config.transparency.step),b.markerSize.set($.isNumeric(h.symbol.size)?Math.floor(h.symbol.size*g.POINTS_TO_PIXELS):b.config.markerSize.value),
l=b.markerStyles.getItems().filter(function(a){return b.markerStyleIdLookup[a.style]===h.symbol.style})[0],b.markerStyleIndex=l?b.markerStyles.indexOf(l):0,l="Point"!==b.featureType&&"Polygon"!==b.featureType?h.symbol:h.symbol.outline,b.lineWidth.set($.isNumeric(l.width)?Math.floor(l.width*g.POINTS_TO_PIXELS):b.config.lineWidth.value));d===c.uniqueValueInfos.length-1&&(b.endColors[0]=new g.SymbolColor(k.toHex()))},q=0;q<c.uniqueValueInfos.length;q++)m(q);b.symbolizing=!1;b.symbologyClasses.pulse()})};
b.prototype.createClassBreaks=function(a){var b=this;this.symbologyClasses.set([]);this.executeExtentQuery(a.field,this.app.map.extent).then(function(c){b.executeQuery(a.field,c).then(function(c){if(b._findDistinctValues(c,a.field.name).length<=b.numBreaks.get())b.classBreaksMode.set(!1),b.createUniqueValues(a);else{c=c.features.map(function(b){return b.attributes[a.field.name]});var d=h.DataClassification.findSignificanceFactor(c);c=h.DataClassification.ckmeans(c,b.numBreaks.get());if(0!==d&&1!==
d)for(var f=0;f<c.length;f++)c[f]=c[f].map(function(a){return a/d});for(f=0;f<c.length;f++){var k=void 0,m=void 0;0===f?k=Math.floor(Math.min.apply(Math,c[f])):(k=Math.min.apply(Math,c[f]),k>Math.max.apply(Math,c[f-1])+1?(k=Math.floor(k-(k-Math.max.apply(Math,c[f-1]))/2),1===d&&k++):k=Math.floor(k));if(f===c.length-1)m=Math.ceil(Math.max.apply(Math,c[f]));else var m=Math.max.apply(Math,c[f]),q=Math.min.apply(Math,c[f+1]),m=m<q-1?Math.floor(m+(q-m)/2):1>=d?Math.floor(m):Math.floor(q);0!==d&&1!==d&&
(k*=d,m*=d);q=void 0;q=0===m-k?a.fieldInfo.formatValue(k):a.fieldInfo.formatValue(k)+" - "+a.fieldInfo.formatValue(m);b.symbologyClasses.addItem({name:q,min:k,max:m,count:c[f].length,color:"#FFFFFF",selected:!1,widgetId:g.WIDGET_ID_BASE+b.symbologyClasses.getLength().toString()})}b.createRendererClasses();b.symbolizing=!1}},function(a){a=new k.infrastructure.commandArgs.AddStatusArgs(a.message);a.regionName="VisualizationStatusRegion";b.app.command("AddResultsStatus").execute(a);b.symbolizing=!1})})};
b.prototype.createUniqueValues=function(a){var b=this;this.symbologyClasses.set([]);this.executeExtentQuery(a.field,this.app.map.extent).then(function(c){b.executeQuery(a.field,c).then(function(c){var d=function(c){var d=null!=c.attributes[a.field.name]&&""!==c.attributes[a.field.name].toString().trim()?c.attributes[a.field.name].toString():null;if(d){var f=void 0;b.hasCodedDomain(a.fieldInfo)&&(f=a.fieldInfo.esriField.domain.getName(c.attributes[a.field.name]));f||(f=a.fieldInfo.formatValue(d));
(c=b.symbologyClasses.getItems().filter(function(a){return a.value===d})[0])?c.count++:b.symbologyClasses.addItem({name:f,value:d,count:1,color:"#FFFFFF",selected:!1,widgetId:g.WIDGET_ID_BASE+b.symbologyClasses.getLength().toString()})}},f=0;for(c=c.features;f<c.length;f++)d(c[f]);0===b.symbologyClasses.getLength()?(d=new k.infrastructure.commandArgs.AddStatusArgs(b.app.getResource(b.libraryId,"language-symbology-settings-nodata")),d.regionName="VisualizationStatusRegion",b.app.command("AddResultsStatus").execute(d),
b.symbolizing=!1,b.currentAttribute.set("")):b.constrainToMaxClasses(a.field).then(function(){b.isNumericAttribute.get()?b.symbologyClasses.getItems().sort(function(a,b){return Number(a.value)-Number(b.value)}):b.symbologyClasses.getItems().sort();b.createRendererClasses();b.symbolizing=!1})},function(a){a=new k.infrastructure.commandArgs.AddStatusArgs(a.message);a.regionName="VisualizationStatusRegion";b.app.command("AddResultsStatus").execute(a);b.symbolizing=!1})})};b.prototype.createRendererClasses=
function(){var a=[],b,c=this.symbologyClasses.getLength();if(this.isNumericAttribute.get()){for(var d=0;d<c;d++)a.push(this.startColors[0].blend(1<c?d/(c-1):0.5,this.endColors[0]));b=0.7<=this.startColors[0].value?this.startColors[0].darken(0.6):this.startColors[0].lighten(0.9)}else a=h.ColorUtils.generateRandomColors(c),b=new g.SymbolColor(this.defaultLineSymbol.color.toHex());for(d=0;d<c;d++){this.symbologyClasses.getAt(d).color=a[d].toHex();var k=this.classSymbolWidgets[d];k.viewModel.colors[0]=
a[d];k.viewModel.outlineColors[0]=b;k.viewModel.noMarker.set("Point"!==this.featureType);k.viewModel.noFill.set("Polygon"!==this.featureType);k.applyConfiguration()}this.symbologyClasses.pulse()};b.prototype.executeQuery=function(a,b){var c=this;return new Promise(function(d,g){if(a.layer instanceof k.infrastructure.LayerIntegrationUtils.LocalLayer){var m=a.layer.mapService.serviceLayer.graphics,p=new esri.tasks.FeatureSet;p.features=m;d(p)}else{m=new esri.tasks.Query;p=h.taskUtils.getQueryTask(a.layer);
m.returnGeometry=!1;m.geometry=b;m.outFields=[a.name];var s=c.stringToHash(p.url+a.name+JSON.stringify(b)),t=c.queryResults[s];t?d(t):p.execute(m,function(a){c.queryResults[s]=a;d(a)},function(a){c.app.trace.error(a.message);g(a)})}})};b.prototype.executeExtentQuery=function(a,b){return a.layer instanceof k.infrastructure.LayerIntegrationUtils.LocalLayer?Promise.resolve(b):this.classBreaksMode.get()?this.executeClassBreaksExtentQuery(a,b):this.executeUniqueValueExtentQuery(a,b)};b.prototype.executeUniqueValueExtentQuery=
function(a,b){var c=this;return new Promise(function(d,g){var k=-1,m=function(g){var h=c._findDistinctValues(g,a.name).length,n=c.isNumericAttribute.get()?c.numBreaks.get():c.maxRenderClasses;h>=n||h===k||g.exceededTransferLimit?d(b):(k=h,b=b.expand(2),q())},q=function(){var g=new esri.tasks.Query,k=h.taskUtils.getQueryTask(a.layer);g.returnGeometry=!1;g.geometry=b;g.outFields=[a.name];var n=c.stringToHash(k.url+a.name+JSON.stringify(b)),r=c.queryResults[n];r?m(r):k.execute(g).then(function(a){c.queryResults[n]=
a;m(a)},function(a){d(b)})};q()})};b.prototype.executeClassBreaksExtentQuery=function(a,b){var c=this;return new Promise(function(d,g){var k=-1,m=function(){var g=new esri.tasks.Query,n=h.taskUtils.getQueryTask(a.layer);g.returnGeometry=!1;g.geometry=b;n.executeForCount(g).then(function(a){a>=c.maxSamples||a===k?d(b):(k=a,b=b.expand(2),m())},function(a){d(b)})};m()})};b.prototype.constrainToMaxClasses=function(a){var b=this;return new Promise(function(c,d){if(b.symbologyClasses.getLength()>b.maxRenderClasses||
b.symbologyClasses.getLength()>b.numBreaks.get()||b.isNumericAttribute.get()){if(b.symbologyClasses.getLength()>b.maxRenderClasses&&!b.isNumericAttribute.get()){var g=new k.infrastructure.commandArgs.AddStatusArgs(b.app.getResource(b.libraryId,"language-symbology-settings-exceeded-max-classes").format(b.maxRenderClasses));g.regionName="VisualizationStatusRegion";b.app.command("AddResultsStatus").execute(g)}var m=b.isNumericAttribute.get()?b.numBreaks.get():b.maxRenderClasses;if(a.layer instanceof
k.infrastructure.LayerIntegrationUtils.LocalLayer)g=b.symbologyClasses.getItems().sort(function(a,b){return a.count<b.count?1:a.count>b.count?-1:0}),b.symbologyClasses.set(g.slice(0,m)),c();else{var g=b.app.map.extent,p=new esri.tasks.Query,s=h.taskUtils.getQueryTask(a.layer);p.returnGeometry=!1;p.geometry=g;p.outFields=[a.name];s.execute(p,function(d){var g=b._findDistinctValues(d,a.name);d=b.symbologyClasses.getItems().sort(function(a,b){return-1===g.indexOf(a.name)&&-1<g.indexOf(b.name)?1:-1<g.indexOf(a.name)&&
-1===g.indexOf(b.name)?-1:a.count<b.count?1:a.count>b.count?-1:0});b.symbologyClasses.set(d.slice(0,m));c()},function(a){c()})}}else c()})};b.prototype._findDistinctValues=function(a,b){for(var c={},d=[],g=a.features.map(function(a){return a.attributes[b]}),h=0;h<g.length;h++)c[g[h]]||d.push(g[h]),c[g[h]]=!0;return d};b.prototype.getFieldInfo=function(a){var b;return new Promise(function(c,d){if(a.layer.mapService.serviceLayer instanceof esri.layers.FeatureLayer){var g=a.layer.mapService.serviceLayer;
b=g.getField(a.name);c(h.gis.FieldInfo.fromEsriField(b,g,a))}else a.layer.getFeatureLayer().then(function(d){b=d.getField(a.name);c(h.gis.FieldInfo.fromEsriField(b,d,a))})})};b.prototype.hasCodedDomain=function(a){return a.esriField&&a.esriField.domain?!0:!1};b.prototype.stringToHash=function(a){for(var b=0,c,d=0;d<a.length;d++)c=a.charCodeAt(d),b=(b<<5)-b+c,b|=0;return b};return b}(d.framework.ui.ViewModelBase);g.AttributeSymbologySettingsViewModel=m})(h.visualization||(h.visualization={}))})(k.infrastructure||
(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){d.ckmeans=function(h,c){if(c>h.length)return[];var b=h.slice().sort(function(a,b){return a-b});d.uniqueCountSorted(b);for(var a=d.createMatrix(c,b.length),e=d.createMatrix(c,b.length),f=0;f<c;f++)for(var l=b[0],k=Math.max(f,1);k<b.length;k++)if(0===f){var q=Math.pow(b[k]-l,2);a[f][k]=a[f][k-1]+k/(k+1)*q;l=(k*l+b[k])/(k+1)}else for(var p=q=0,s=k;s>=f;s--)q+=(k-s)/(k-s+1)*Math.pow(b[s]-p,2),p=(b[s]+(k-s)*p)/(k-s+1),s===k?(a[f][k]=q,e[f][k]=
s,0<s&&(a[f][k]+=a[f-1][s-1])):q+a[f-1][s-1]<a[f][k]&&(a[f][k]=q+a[f-1][s-1],e[f][k]=s);a=[];l=e[0].length-1;for(f=e.length-1;0<=f;f--)k=e[f][l],a[f]=b.slice(k,l+1),0<f&&(l=k-1);return a};d.createMatrix=function(d,c){for(var b=[],a=0;a<d;a++){for(var e=[],f=0;f<c;f++)e.push(0);b.push(e)}return b};d.uniqueCountSorted=function(d){for(var c=0,b,a=0;a<d.length;a++)if(0===a||d[a]!=b)b=d[a],c++;return c};d.findSignificanceFactor=function(h){var c=d.getDecimalSeparator(),b=h.filter(function(a){return null!==
a}).map(function(a){return(a=a.toString().split(c)[1])?parseFloat(a)/Math.pow(10,a.length):0}),a=h.filter(function(a){return null!==a}).map(function(a){return Math.floor(a)});h=Math.min.apply(Math,a.filter(function(a){return 0!==a}));var e;e=0===h||Infinity===h?0:Math.floor(Math.log(Math.abs(h))/Math.LN10);var a=Math.max.apply(Math,a),f;0===a?e=0:f=Math.floor(Math.log(Math.abs(a))/Math.LN10);f-=e;e=Math.max.apply(Math,b.filter(function(a){return 0!==a}));if(0===e||Infinity===Math.abs(e))return b=
Math.floor(Math.log(Math.abs(a-h))/Math.LN10),Math.pow(10,0>f-b?0:f-b);h=Math.floor(Math.log(Math.abs(e))/Math.LN10);a=Math.min.apply(Math,b.filter(function(a){return 0!==a}));a=0===a||Infinity===Math.abs(a)?0:Math.floor(Math.log(Math.abs(a))/Math.LN10);return 1>=h-a?(b=b.map(function(a){return(a=a.toString().split(c)[1])?a.length:0}),b=Math.max.apply(Math,b),Math.pow(10,-b)):Math.pow(10,a+f)};d.getDecimalSeparator=function(){return(1.1).toLocaleString().substring(1,2)}})(d.DataClassification||(d.DataClassification=
{}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(){function c(b){this.isHSV(b)?(this.hue=this.clamp(b.h,0,1),this.value=this.clamp(b.v,0,1),this.saturation=this.clamp(b.s,0,1)):(this.isRGB(b)?b=this.fromRGB({r:this.clamp(b.r,0,1),g:this.clamp(b.g,0,1),b:this.clamp(b.b,0,1)}):(b=this.hexToRGB(b),b=this.fromRGB(b)),this.hue=b.h,this.value=b.v,this.saturation=b.s)}c.prototype.toHex=function(){var b=this.toRGB();return this.rgbToHex(b)};c.prototype.darken=function(b){b=
this.clamp(b,0,1);return new c({h:this.hue,v:this.value*(1-b),s:this.saturation})};c.prototype.lighten=function(b){b=this.clamp(b,0,1);return new c({h:this.hue,v:this.value+(1-this.value)*b,s:this.saturation*(1-b)})};c.prototype.blend=function(b,a){b=this.clamp(b,0,1);var d=a.toRGB(),f=this.toRGB();return new c({r:f.r+(d.r-f.r)*b,g:f.g+(d.g-f.g)*b,b:f.b+(d.b-f.b)*b})};c.prototype.toRGB=function(){var b,a,c,d=this.saturation*this.value,g=6*this.hue,h=d*(1-Math.abs(g%2-1)),k=this.value-d;switch(Math.floor(g)%
6){case 0:b=d+k;a=h+k;c=k;break;case 1:b=h+k;a=d+k;c=k;break;case 2:b=k;a=d+k;c=h+k;break;case 3:b=k;a=h+k;c=d+k;break;case 4:b=h+k;a=k;c=d+k;break;case 5:b=d+k,a=k,c=h+k}return{r:b,g:a,b:c}};c.prototype.equals=function(b){return b.hue===this.hue&&b.value===this.value&&b.saturation===this.saturation?!0:!1};c.prototype.fromRGB=function(b){var a=Math.max(b.r,b.g,b.b),c=Math.min(b.r,b.g,b.b),c=a-c;b=(0===c?0:a===b.r?(b.g-b.b)/c:a===b.g?2+(b.b-b.r)/c:4+(b.r-b.g)/c)/6;0>b&&(b+=1);return{h:b,s:0===c?0:
c/a,v:a}};c.prototype.rgbToHex=function(b){var a=("00"+Math.floor(255*b.r).toString(16)).slice(-2),c=("00"+Math.floor(255*b.g).toString(16)).slice(-2);b=("00"+Math.floor(255*b.b).toString(16)).slice(-2);return"#"+a+c+b};c.prototype.hexToRGB=function(b){b=b.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(a,b,c,d){return b+b+c+c+d+d});return(b=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b))?{r:parseInt(b[1],16)/255,g:parseInt(b[2],16)/255,b:parseInt(b[3],16)/255}:null};c.prototype.clamp=function(b,
a,c){return Math.min(Math.max(b,a),c)};c.prototype.isHSV=function(b){return $.isNumeric(b.h)&&$.isNumeric(b.s)&&$.isNumeric(b.v)?!0:!1};c.prototype.isRGB=function(b){return $.isNumeric(b.r)&&$.isNumeric(b.g)&&$.isNumeric(b.b)?!0:!1};return c}();d.SymbolColor=h})(d.visualization||(d.visualization={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var h=function(c){function b(){c.apply(this,arguments)}__extends(b,c);b.prototype.getSelectedColorSwatch=function(){for(var a=this.viewModel.colorSwatches.get(),b=0;b<a.length;b++){var c=a[b];if(this.colorSwatchFieldSet.children[b].querySelector("input[type=radio]").checked)return c}};b.prototype.attach=function(a){a.initialize(this.configuration);c.prototype.attach.call(this,a);this.setupJQuerySliders()};b.prototype.added=function(a){a.symbologySettingsWidget=
this;c.prototype.added.call(this,a)};b.prototype.applyConfiguration=function(){var a=this;this.configuring=!0;this.colorInput.value=this.viewModel.colors[0].toHex();this.markerStyleInput.selectedIndex=0<=this.viewModel.markerStyleIndex?this.viewModel.markerStyleIndex:0;this.lineStyleInput.selectedIndex=0<=this.viewModel.lineStyleIndex?this.viewModel.lineStyleIndex:0;this.fillStyleInput.selectedIndex=0<=this.viewModel.fillStyleIndex?this.viewModel.fillStyleIndex:0;this.viewModel.colorSwatches.set(this.viewModel.colors.map(function(a){return{hex:a.toHex()}}));
this.viewModel.colorSwatches.get().forEach(function(b,c){a.colorSwatchFieldSet.children[c].style.backgroundColor=b.hex});this.colorSwatchFieldSet.querySelector(".color-swatch:first-child > input[type=radio]").checked=!0;$(this.transparencySlider).slider("option","value",this.viewModel.transparency.get());$(this.markerSizeSlider).slider("option","value",this.viewModel.markerSize.get());$(this.lineWidthSlider).slider("option","value",this.viewModel.lineWidth.get());this.configuring=!1;this.handleChange()};
b.prototype.reset=function(){this.viewModel.reset()};b.prototype.handleChange=function(){if(!this.configuring){this.viewModel.transparency.set($(this.transparencySlider).slider("value"));this.viewModel.markerSize.set($(this.markerSizeSlider).slider("value"));this.viewModel.lineWidth.set($(this.lineWidthSlider).slider("value"));var a=this.viewModel.useColorSwatches.get()?esri.Color.fromHex(this.getSelectedColorSwatch().hex):esri.Color.fromHex(this.colorInput.value);this.viewModel.markerStyleIndex=
this.markerStyleInput.selectedIndex;var b=this.viewModel.markerStyles.getAt(this.viewModel.markerStyleIndex).style;this.viewModel.lineStyleIndex=this.lineStyleInput.selectedIndex;var c=this.viewModel.lineStyles.getAt(this.viewModel.lineStyleIndex).style;this.viewModel.fillStyleIndex=this.fillStyleInput.selectedIndex;var d=this.viewModel.fillStyles.getAt(this.viewModel.fillStyleIndex).style,h=this.viewModel.markerSize.get(),k=this.viewModel.lineWidth.get();a.a=this.viewModel.transparency.get()/100*
-1+1;var m=new esri.symbol.SimpleLineSymbol;if(this.viewModel.noFill.get()&&this.viewModel.noMarker.get()||!this.viewModel.noMarker.get()&&("cross"===b||"x"===b))m.setColor(a);else if(this.viewModel.config.selectOutlineColor)m.setColor(esri.Color.fromHex(this.viewModel.outlineColors[0].toHex()));else{var q=new g.SymbolColor(a.toHex());0.7<=q.value?m.setColor(esri.Color.fromHex(q.darken(0.5).toHex())):m.setColor(esri.Color.fromHex(q.lighten(0.9).toHex()))}m.setStyle(c);m.setWidth(k);c=new esri.symbol.SimpleMarkerSymbol;
c.setColor(a);c.setStyle(b);c.setSize(h);c.setOutline(m);b=new esri.symbol.SimpleFillSymbol;b.setColor(a);b.setStyle(d);b.setOutline(m);this.viewModel.symbols={marker:c,line:m,fill:b};this.viewModel.selectedSwatch=this.getSelectedColorSwatch();this.viewModel.colors[0]=new g.SymbolColor(this.colorInput.value)}};b.prototype.setupJQuerySliders=function(){var a=this,b=this.viewModel.config;$(this.transparencySlider).slider({min:b.transparency.min,max:b.transparency.max,value:b.transparency.value,step:b.transparency.step,
slide:function(b,c){return a._handleSliderValueChanged(b,c,a.viewModel.transparency)}});$(this.markerSizeSlider).slider({min:b.markerSize.min,max:b.markerSize.max,value:b.markerSize.value,step:b.markerSize.step,slide:function(b,c){return a._handleSliderValueChanged(b,c,a.viewModel.markerSize)}});$(this.lineWidthSlider).slider({min:b.lineWidth.min,max:b.lineWidth.max,value:b.lineWidth.value,step:b.lineWidth.step,slide:function(b,c){return a._handleSliderValueChanged(b,c,a.viewModel.lineWidth)}});$(this.transparencySlider).add(this.markerSizeSlider).add(this.lineWidthSlider).off("slidechange").on("slidechange",
function(b){b=document.createEvent("Event");b.initEvent("change",!0,!0);a.container.dispatchEvent(b)})};b.prototype._handleSliderValueChanged=function(a,b,c){b&&void 0!=b.value&&c.set(b.value)};return b}(d.framework.ui.ViewBase);g.SymbologySettingsView=h})(h.visualization||(h.visualization={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var k=function(c){function b(){c.apply(this,arguments);this.noMarker=new Observable(!1);this.noFill=new Observable(!1);this.transparency=new Observable(10);this.outlineTransparency=new Observable(0);this.markerSize=new Observable(10);this.lineWidth=new Observable(2);this.useColorSwatches=new Observable(!0);this.colorSwatches=new ObservableCollection;this.markerStyleIdLookup={circle:"esriSMSCircle",cross:"esriSMSCross",diamond:"esriSMSDiamond",
square:"esriSMSSquare",x:"esriSMSX"};this.lineStyleIdLookup={solid:"esriSLSSolid",dash:"esriSLSDash",dashdot:"esriSLSDashDot",dashdotdot:"esriSLSLDashDotDot",dot:"esriSLSDot",longdash:"esriSLSLongDash",longdashdot:"esriSLSLongDashDot",shortdash:"esriSLSShortDash",shortdashdot:"esriSLSShortDashDot",shortdashdotdot:"esriSLSShortDashDotDot",shortdot:"esriSLSShortDot"};this.fillStyleIdLookup={solid:"esriSFSSolid",horizontal:"esriSFSHorizontal",vertical:"esriSFSVertical",cross:"esriSFSCross",diagonalcross:"esriSFSDiagonalCross",
forwarddiagonal:"esriSFSForwardDiagonal",backwarddiagonal:"esriSFSBackwardDiagonal","null":"esriSFSNull"};this.markerStyles=new ObservableCollection([{style:esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,label:this.getResource("language-symbology-settings-marker-style-circle")},{style:esri.symbol.SimpleMarkerSymbol.STYLE_CROSS,label:this.getResource("language-symbology-settings-marker-style-cross")},{style:esri.symbol.SimpleMarkerSymbol.STYLE_DIAMOND,label:this.getResource("language-symbology-settings-marker-style-diamond")},
{style:esri.symbol.SimpleMarkerSymbol.STYLE_SQUARE,label:this.getResource("language-symbology-settings-marker-style-square")},{style:esri.symbol.SimpleMarkerSymbol.STYLE_X,label:this.getResource("language-symbology-settings-marker-style-x")}]);this.lineStyles=new ObservableCollection([{style:esri.symbol.SimpleLineSymbol.STYLE_SOLID,label:this.getResource("language-symbology-settings-line-style-solid"),styleId:"esriSLSSolid"},{style:esri.symbol.SimpleLineSymbol.STYLE_DASH,label:this.getResource("language-symbology-settings-line-style-dash"),
styleId:"esriSLSDash"},{style:esri.symbol.SimpleLineSymbol.STYLE_DASHDOT,label:this.getResource("language-symbology-settings-line-style-dashdot"),styleId:"esriSLSDashDot"},{style:esri.symbol.SimpleLineSymbol.STYLE_DASHDOTDOT,label:this.getResource("language-symbology-settings-line-style-dashdotdot"),styleId:"esriSLSDashDotDot"},{style:esri.symbol.SimpleLineSymbol.STYLE_DOT,label:this.getResource("language-symbology-settings-line-style-dot"),styleId:"esriSLSDot"},{style:esri.symbol.SimpleLineSymbol.STYLE_LONGDASH,
label:this.getResource("language-symbology-settings-line-style-longdash"),styleId:"esriSLSLongDash"},{style:esri.symbol.SimpleLineSymbol.STYLE_LONGDASHDOT,label:this.getResource("language-symbology-settings-line-style-longdashdot"),styleId:"esriSLSLongDashDot"},{style:esri.symbol.SimpleLineSymbol.STYLE_SHORTDASH,label:this.getResource("language-symbology-settings-line-style-shortdash"),styleId:"esriSLSShortDash"},{style:esri.symbol.SimpleLineSymbol.STYLE_SHORTDASHDOT,label:this.getResource("language-symbology-settings-line-style-shortdashdot"),
styleId:"esriSLSShortDashDot"},{style:esri.symbol.SimpleLineSymbol.STYLE_SHORTDASHDOTDOT,label:this.getResource("language-symbology-settings-line-style-shortdashdotdot"),styleId:"esriSLSShortDashDotDot"},{style:esri.symbol.SimpleLineSymbol.STYLE_SHORTDOT,label:this.getResource("language-symbology-settings-line-style-shortdot"),styleId:"esriSLSShortDot"}]);this.fillStyles=new ObservableCollection([{style:esri.symbol.SimpleFillSymbol.STYLE_SOLID,label:this.getResource("language-symbology-settings-fill-style-solid"),
styleId:"esriSFSSolid"},{style:esri.symbol.SimpleFillSymbol.STYLE_HORIZONTAL,label:this.getResource("language-symbology-settings-fill-style-horizontal"),styleId:"esriSFSHorizontal"},{style:esri.symbol.SimpleFillSymbol.STYLE_VERTICAL,label:this.getResource("language-symbology-settings-fill-style-vertical"),styleId:"esriSFSVertical"},{style:esri.symbol.SimpleFillSymbol.STYLE_CROSS,label:this.getResource("language-symbology-settings-fill-style-cross"),styleId:"esriSFSCross"},{style:esri.symbol.SimpleFillSymbol.STYLE_DIAGONAL_CROSS,
label:this.getResource("language-symbology-settings-fill-style-diagonal-cross"),styleId:"esriSFSDiagonalCross"},{style:esri.symbol.SimpleFillSymbol.STYLE_FORWARD_DIAGONAL,label:this.getResource("language-symbology-settings-fill-style-forward-diagonal"),styleId:"esriSFSForwardDiagonal"},{style:esri.symbol.SimpleFillSymbol.STYLE_BACKWARD_DIAGONAL,label:this.getResource("language-symbology-settings-fill-style-backward-diagonal"),styleId:"esriSFSBackwardDiagonal"},{style:esri.symbol.SimpleFillSymbol.STYLE_NULL,
label:this.getResource("language-symbology-settings-fill-style-null"),styleId:"esriSFSNull"}])}__extends(b,c);b.prototype.initialize=function(a){void 0===a&&(a={});this.config=a;a.alwaysUseColorSwatches=void 0!=a.alwaysUseColorSwatches?a.alwaysUseColorSwatches:!1;a.numberOfColorSwatches=a.numberOfColorSwatches?6:a.numberOfColorSwatches;this.config.transparency=a.transparency?a.transparency:{min:0,max:90,value:10,step:5};this.transparency.set(this.config.transparency.value);this.config.markerSize=
a.markerSize?a.markerSize:{min:1,max:25,value:10,step:1};this.markerSize.set(this.config.markerSize.value);this.config.lineWidth=a.lineWidth?a.lineWidth:{min:0,max:5,value:2,step:1};this.lineWidth.set(this.config.lineWidth.value);void 0!==a.markerStyles&&(this.markerStyles.set(a.markerStyles),this.markerStyleIndex=0);void 0!==a.lineStyles&&(this.lineStyles.set(a.lineStyles),this.lineStyleIndex=0);void 0!==a.fillStyles&&(this.fillStyles.set(a.fillStyles),this.fillStyleIndex=0);this.useColorSwatches.set(a.alwaysUseColorSwatches||
!h.ColorUtils.isColorInputSupported());this.colors=h.ColorUtils.generateRandomColors(a.numberOfColorSwatches);var b=0;this.outlineColors=this.colors.map(function(a){b++;return 0===b%2?a.darken(0.6):a.lighten(0.8)})};b.prototype.reset=function(){this.transparency.set(this.config.transparency.value);this.markerSize.set(this.config.markerSize.value);this.lineWidth.set(this.config.lineWidth.value);this.fillStyleIndex=this.lineStyleIndex=this.markerStyleIndex=0;this.colors=h.ColorUtils.generateRandomColors(this.config.numberOfColorSwatches)};
b.prototype.getRenderer=function(){var a=null,a=this.noMarker.get()?this.noFill.get()?new esri.renderer.SimpleRenderer(this.symbols.line):new esri.renderer.SimpleRenderer(this.symbols.fill):new esri.renderer.SimpleRenderer(this.symbols.marker);return JSON.stringify(a.toJson())};b.prototype.getSymbol=function(){var a=null,a=this.noMarker.get()?this.noFill.get()?this.symbols.line:this.symbols.fill:this.symbols.marker;return JSON.stringify(a.toJson())};b.prototype.getColor=function(){return this.useColorSwatches.get()?
new g.SymbolColor(this.selectedSwatch.hex):this.colors[0]};b.prototype.setFromRenderer=function(a){a=a.toJson();"simple"===a.type&&a.symbol&&this._setFromSymbolObject(a.symbol)};b.prototype.setFromSymbol=function(a){a=a.toJson();this._setFromSymbolObject(a)};b.prototype._setFromSymbolObject=function(a){var b=this;this.colors[0]=new g.SymbolColor({r:a.color[0]/255,g:a.color[1]/255,b:a.color[2]/255});var c,d;for(d in this.markerStyleIdLookup)if(this.markerStyleIdLookup.hasOwnProperty(d)&&a.style===
this.markerStyleIdLookup[d]){c=d;break}a.outline&&c!==esri.symbol.SimpleMarkerSymbol.STYLE_CROSS&&c!==esri.symbol.SimpleMarkerSymbol.STYLE_X&&(this.outlineColors[0]=new g.SymbolColor({r:a.outline.color[0]/255,g:a.outline.color[1]/255,b:a.outline.color[2]/255}));this.transparency.set(Math.floor(Math.ceil((255-a.color[3])/255*100)/this.config.transparency.step)*this.config.transparency.step);d=this.markerStyles.getItems().filter(function(a){return a.style===c})[0];this.markerSize.set($.isNumeric(a.size)?
Math.floor(a.size*g.POINTS_TO_PIXELS):this.config.markerSize.value);this.markerStyleIndex=d?this.markerStyles.indexOf(d):0;var h=this.noFill.get()&&this.noMarker.get()?a:a.outline;this.lineWidth.set($.isNumeric(h.width)?Math.floor(h.width*g.POINTS_TO_PIXELS):this.config.lineWidth.value);this.lineStyleIndex=h.style?this.lineStyles.indexOf(this.lineStyles.getItems().filter(function(a){return b.lineStyleIdLookup[a.style]===h.style})[0]):0;this.fillStyleIndex=(d=this.fillStyles.getItems().filter(function(c){return b.fillStyleIdLookup[c.style]===
a.style})[0])?this.fillStyles.indexOf(d):0};return b}(d.framework.ui.ViewModelBase);g.SymbologySettingsViewModel=k;g.POINTS_TO_PIXELS=96/72})(h.visualization||(h.visualization={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(){function c(b,a){this.visualizations=[];this.enabledVisualization=null;this.currentLayer=new Observable(null);this.isEnabled=new Observable(!1);this.isSupported=new Observable(!1);this.app=b;this.libraryId=a;this.currentLayer.bind(this,this.handleCurrentLayerChanged)}c.prototype.initialize=function(b){b.viewId&&(this.viewId=b.viewId);b.displayName&&(this.displayName=b.displayName)};c.prototype.canSupport=function(b){return!1};
c.prototype.handleCurrentLayerChanged=function(b){throw Error("Not implemented");};c.prototype.handleActivate=function(b){throw Error("Not implemented");};c.prototype.handleApply=function(){throw Error("Not implemented");};return c}();d.VisualizationProviderBase=h})(d.visualization||(d.visualization={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){(function(d){function c(a){return a.split(e)}var b=null,a={},e=/\r\n|\r|\n/g;d.getLabelSize=function(d,g,h,k){for(var m=!0,q=null,t=(e.test(d)?d.match(e).length:0)+1,y=c(d),w=0,x=0;y&&x<y.length;x++){for(var u=d.length,z=0,B=0;B<u;B++){var v=y[x].charAt(B),v=" "===v?".":v;if(!a.hasOwnProperty(v)){m?(m=document.getElementById(k+"_layer"),q=document.createElementNS("http://www.w3.org/2000/svg","text"),q.setAttributeNS(null,"font-size",
h),q.setAttributeNS(null,"font-family",g),q.setAttributeNS(null,"visibility","hidden"),q.textContent=v,m.appendChild(q),m=!1):q.textContent=v;var A=q.getBBox();b=null===b?A.height:b;a[v]=q.getComputedTextLength()}v=a[v];z+=v}z>w&&(w=z)}return{width:Math.ceil(w),height:Math.ceil(b*t)}};d.getTextLines=c;d.generateSvgHighlightLabelPath=function(a,b,c,d,e){void 0===d&&(d=!1);void 0===e&&(e=a/5);var g="",g=0===c?"M1,0h"+a+"v"+b:"M1,0h"+(a-c)+"a"+c+","+c+" 0 0 1 "+c+","+c+"v"+(b-2*c)+"a"+c+","+c+" 0 0 1 "+
-c+","+c,g=d?g+("h"+(c-(a-e))/2+"l"+-(e/2)+","+e/2+"l"+-(e/2)+","+-(e/2)+"h"+(c-(a-e))/2):g+("h"+(c-a));return 0===c?g+"z":g+("a"+c+","+c+" 0 0 1 "+-c+","+-c+"v"+(2*c-b)+"a"+c+","+c+" 0 0 1 "+c+","+-c+"z")};d.generateSvgCirclePath=function(a){if(!a)throw Error("HighlightLabelUtils: Cannot generate SVG circle path. Radius cannot be zero or undefined.");return"M0,0a"+a+","+a+" 0 0 1 "+a+","+a+"a"+a+","+a+" 0 0 1 "+-a+","+a+"a"+a+","+a+" 0 0 1 "+-a+","+-a+"a"+a+","+a+" 0 0 1 "+a+","+-a+"z"}})(d.HighlightedLabelUtils||
(d.HighlightedLabelUtils={}))})(d.highlightedLabel||(d.highlightedLabel={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){d=d.essentialsHtmlViewer||(d.essentialsHtmlViewer={});d=d.mapping||(d.mapping={});d=d.infrastructure||(d.infrastructure={});d=d.webMap||(d.webMap={});d=d.BaseMapType||(d.BaseMapType={});d.OPEN_STREET_MAP="OpenStreetMap";d.BING_AERIAL="BingMapsAerial";d.BING_ROAD="BingMapsRoad";d.BING_HYBRID="BingMapsHybrid";d.WEB_TILED="WebTiledLayer"})(geocortex||(geocortex={}));
(function(d){d=d.essentialsHtmlViewer||(d.essentialsHtmlViewer={});d=d.mapping||(d.mapping={});d=d.infrastructure||(d.infrastructure={});d=d.webMap||(d.webMap={});d=d.OperationalLayerType||(d.OperationalLayerType={});d.CSV="CSV";d.WMS="WMS";d.KML="KML"})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){(function(d){d.SIMPLE="simple";d.UNIQUE_VALUE="uniqueValue";d.CLASS_BREAKS="classBreaks";d.HEATMAP="heatmap"})(d.RendererType||(d.RendererType={}));(function(d){d.BY_FIELD="esriNormalizeByField";d.BY_LOG="esriNormalizeByLog";d.BY_PERCENT_OF_TOTAL="esriNormalizeByPercentOfTotal"})(d.NormalizationType||(d.NormalizationType={}));(function(d){d.NATURAL_BREAKS="esriClassifyNaturalBreaks";d.EQUAL_INTERVAL="esriClassifyEqualInterval";d.QUANTILE=
"esriClassifyQuantile";d.STANDARD_DEVIATION="esriClassifyStandardDeviation";d.GEOMETRICAL_INTERVAL="esriClassifyGeometricalInterval"})(d.ClassificationMethod||(d.ClassificationMethod={}))})(d.webMap||(d.webMap={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){d=d.essentialsHtmlViewer||(d.essentialsHtmlViewer={});d=d.mapping||(d.mapping={});d=d.infrastructure||(d.infrastructure={});d=d.webMap||(d.webMap={});d=d.DomainType||(d.DomainType={});d.INHERITED="inherited";d.RANGE="range";d.CODED_VALUE="codedValue"})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){(function(d){d.POINT="esriGeometryPoint";d.MULTIPOINT="esriGeometryMultipoint";d.POLYLINE="esriGeometryPolyline";d.POLYGON="esriGeometryPolygon";d.EXTENT="esriGeometryEnvelope";d.fromEsriGeometryType=function(c){if(c){if(c.startsWith("esriGeometry"))return c;switch(c){case "point":return d.POINT;case "multipoint":return d.MULTIPOINT;case "polyline":return d.POLYLINE;case "polygon":return d.POLYGON;case "extent":return d.EXTENT;default:throw Error("GeometryType.fromEsriGeometryType: Unrecognized geometry type.");
}}}})(d.GeometryType||(d.GeometryType={}))})(d.webMap||(d.webMap={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(g){var k="__conversionType",c=function(){function b(a){var b=this;this._numberValidator=new d.validation.NumberValidator;this.object=function(a){if(!a||"object"!==typeof a)return!0;if(Array.isArray(a))return{item:b.object};switch(a[k]){case g.ConversionType.GCX_MAP_SERVICE:case g.ConversionType.ESRI_LAYER:return b.serviceLayer;case g.ConversionType.GCX_LAYER:return b.layer;case g.ConversionType.GCX_FEATURE_SET:case g.ConversionType.ESRI_FEATURE_SET:return b.featureSet;
case g.ConversionType.GCX_FEATURE:case g.ConversionType.ESRI_GRAPHIC:return b.feature;case g.ConversionType.ESRI_GEOMETRY:return b.geometry;case g.ConversionType.ESRI_SYMBOL:return b.symbol;case g.ConversionType.ESRI_RENDERER:return b.renderer;case g.ConversionType.ESRI_SPATIAL_REFERENCE:return b.spatialReference}var c={},d=0;for(a=Object.keys(a);d<a.length;d++)c[a[d]]=b.object;return c};this.app=a;this._urlValidator=new d.validation.SiteUrlValidator(a)}Object.defineProperty(b.prototype,"baseMap",
{get:function(){this._baseMap||(this._baseMap={baseMapLayers:{item:this.baseMapLayer},title:!0});return this._baseMap},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"baseMapLayer",{get:function(){this._baseMapLayer||(this._baseMapLayer=$.extend({},this._serviceLayerCommon,{type:!0,isReference:!0,templateUrl:this._urlValidator}),this._baseMapLayer[k]=!0);return this._baseMapLayer},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"bookmark",{get:function(){this._bookmark||
(this._bookmark={name:!0,extent:this.extent});return this._bookmark},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"color",{get:function(){this._color||(this._color={item:this._numberValidator});return this._color},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"csvLayer",{get:function(){this._csvLayer||(this._csvLayer=$.extend({},this.operationalLayer,{columnDelimiter:!0,locationInfo:this.locationInfo}));return this._csvLayer},enumerable:!0,configurable:!0});
Object.defineProperty(b.prototype,"domain",{get:function(){var a=this;this._domain||(this._domain=function(b){if(!b)return!1;switch(b.type){case g.DomainType.INHERITED:return a.inheritedDomain;case g.DomainType.RANGE:return a.rangeDomain;case g.DomainType.CODED_VALUE:return a.codedValueDomain;default:return!1}});return this._domain},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"inheritedDomain",{get:function(){this._inheritedDomain||(this._inheritedDomain={type:!0});return this._inheritedDomain},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"rangeDomain",{get:function(){this._rangeDomain||(this._rangeDomain={type:!0,name:!0,range:{item:this._numberValidator}});return this._rangeDomain},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"codedValueDomain",{get:function(){this._codedValueDomain||(this._codedValueDomain={type:!0,name:!0,codedValues:{item:{name:!0,code:!0}}});return this._codedValueDomain},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"drawingInfo",{get:function(){this._drawingInfo||(this._drawingInfo={renderer:this.renderer,fixedSymbols:!0});return this._drawingInfo},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"feature",{get:function(){this._feature||(this._feature={attributes:this.object,geometry:this.geometry},this._feature[k]=!0);return this._feature},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"featureCollection",{get:function(){this._featureCollection||(this._featureCollection=
{layers:{item:this.layer},showLegend:!0});return this._featureCollection},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"featureSet",{get:function(){this._featureSet||(this._featureSet={features:{item:this.feature},geometryType:!0},this._featureSet[k]=!0);return this._featureSet},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"field",{get:function(){this._field||(this._field={alias:!0,domain:this.domain,editable:!0,length:!0,name:!0,nullable:!0,type:!0});return this._field},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"geometry",{get:function(){var a=this;this._geometry||(this._geometry=function(b){return b?b.hasOwnProperty("x")?a.point:b.hasOwnProperty("points")?a.multiPoint:b.hasOwnProperty("paths")?a.polyline:b.hasOwnProperty("rings")?a.polygon:b.hasOwnProperty("xmin")?a.extent:!1:!1});return this._geometry},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"point",{get:function(){this._point||(this._point={spatialReference:this.spatialReference,
x:this._numberValidator,y:this._numberValidator,z:this._numberValidator,m:this._numberValidator},this._point[k]=!0);return this._point},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"multiPoint",{get:function(){this._multipoint||(this._multipoint={spatialReference:this.spatialReference,hasM:!0,hasZ:!0,points:{item:{item:this._numberValidator}}},this._multipoint[k]=!0);return this._multipoint},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"polyline",{get:function(){this._polyline||
(this._polyline={spatialReference:this.spatialReference,hasM:!0,hasZ:!0,paths:{item:{item:{item:this._numberValidator}}}},this._polyline[k]=!0);return this._polyline},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"polygon",{get:function(){this._polygon||(this._polygon={spatialReference:this.spatialReference,hasM:!0,hasZ:!0,rings:{item:{item:{item:this._numberValidator}}}},this._polygon[k]=!0);return this._polygon},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"extent",{get:function(){this._extent||(this._extent={spatialReference:this.spatialReference,xmin:this._numberValidator,xmax:this._numberValidator,ymin:this._numberValidator,ymax:this._numberValidator,zmin:this._numberValidator,zmax:this._numberValidator,mmin:this._numberValidator,mmax:this._numberValidator},this._extent[k]);return this._extent},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"layer",{get:function(){this._layer||(this._layer={featureSet:this.featureSet,id:!0,layerDefinition:this.layerDefinition,
layerUrl:this._urlValidator,legendUrl:this._urlValidator,name:!0,title:!0,popupInfo:this.popupInfo},this._layer[k]=!0);return this._layer},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"layerDefinition",{get:function(){this._layerDefinition||(this._layerDefinition={definitionExpression:!0,displayField:!0,drawingInfo:this.drawingInfo,fields:{item:this.field},geometryType:!0,hasAttachments:!0,maxScale:this._numberValidator,minScale:this._numberValidator,name:!0,objectIdField:!0,
templates:{item:this.template},type:!0,typeIdField:!0,types:{item:this.type},source:{type:!0,mapLayerId:this._numberValidator}});return this._layerDefinition},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"locationInfo",{get:function(){this._locationInfo||(this._locationInfo={locationType:!0,latitudeFieldName:!0,longitudeFieldName:!0});return this._locationInfo},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"operationalLayer",{get:function(){this._operationalLayer||
(this._operationalLayer=$.extend({},this._serviceLayerCommon,{type:!0,capabilities:!0,featureCollection:this.featureCollection,itemId:!0,layerDefinition:this.layerDefinition,layers:{item:this.layer},maxScale:this._numberValidator,minScale:this._numberValidator,mode:this._numberValidator,popupInfo:this.popupInfo,title:!0,visibleLayers:{item:!0}}),this._operationalLayer[k]=!0);return this._operationalLayer},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"popupInfo",{get:function(){return{}},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"renderer",{get:function(){var a=this;this._renderer||(this._renderer=function(b){if(!b)return!1;switch(b.type){case g.RendererType.SIMPLE:return a.simpleRenderer;case g.RendererType.UNIQUE_VALUE:return a.uniqueValueRenderer;case g.RendererType.CLASS_BREAKS:return a.classBreaksRenderer;case g.RendererType.HEATMAP:return a.heatmapRenderer;default:return!1}});return this._renderer},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"serviceLayer",{get:function(){this._serviceLayer||(this._serviceLayer=$.extend({},this.operationalLayer,this.wmsLayer,this.csvLayer,this.baseMapLayer));return this._serviceLayer},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"simpleRenderer",{get:function(){this._simpleRenderer||(this._simpleRenderer={type:!0,symbol:this.symbol,label:!0,description:!0},this._simpleRenderer[k]=!0);return this._simpleRenderer},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"uniqueValueRenderer",
{get:function(){this._uniqueValueRenderer||(this._uniqueValueRenderer={type:!0,field1:!0,field2:!0,field3:!0,fieldDelimiter:!0,defaultSymbol:this.symbol,defaultLabel:!0,uniqueValueInfos:{item:{value:!0,label:!0,description:!0,symbol:this.symbol}}},this._uniqueValueRenderer[k]=!0);return this._uniqueValueRenderer},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"classBreaksRenderer",{get:function(){this._classBreaksRenderer||(this._classBreaksRenderer={type:!0,field:!0,classificationMethod:!0,
normalizationType:!0,normalizationField:!0,normalizationTotal:this._numberValidator,defaultSymbol:this.symbol,defaultLabel:!0,backgroundFillSymbol:this.simpleFillSymbol,minValue:this._numberValidator,classBreakInfos:{item:{classMinValue:this._numberValidator,classMaxValue:this._numberValidator,label:!0,description:!0,symbol:this.symbol}}},this._classBreaksRenderer[k]=!0);return this._classBreaksRenderer},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"heatmapRenderer",{get:function(){this._heatmapRenderer||
(this._heatmapRenderer={type:!0,blurRadius:this._numberValidator,field:!0,maxPixelIntensity:this._numberValidator,minPixelIntensity:this._numberValidator,colorStops:{item:{ratio:!0,color:this.color}}});return this._heatmapRenderer},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"_serviceLayerCommon",{get:function(){return{id:!0,url:this._urlValidator,visibility:!0,opacity:this._numberValidator,layerType:!0}},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"spatialReference",
{get:function(){this._spatialReference||(this._spatialReference={wkid:this._numberValidator,wkt:!0},this._spatialReference[k]=!0);return this._spatialReference},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"symbol",{get:function(){var a=this;this._symbol||(this._symbol=function(b){if(!b)return!1;switch(b.type){case g.SymbolType.SIMPLE_MARKER:return a.simpleMarkerSymbol;case g.SymbolType.SIMPLE_LINE:return a.simpleLineSymbol;case g.SymbolType.SIMPLE_FILL:return a.simpleFillSymbol;
case g.SymbolType.PICTURE_MARKER:return a.pictureMarkerSymbol;case g.SymbolType.PICTURE_FILL:return a.pictureFillSymbol;case g.SymbolType.TEXT:return a.textSymbol;default:return!1}});return this._symbol},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"simpleMarkerSymbol",{get:function(){this._simpleMarkerSymbol||(this._simpleMarkerSymbol={type:!0,style:!0,color:this.color,size:!0,angle:this._numberValidator,path:!0,xoffset:this._numberValidator,yoffset:this._numberValidator,outline:{type:!0,
style:!0,color:this.color,width:this._numberValidator}},this._simpleMarkerSymbol[k]=!0);return this._simpleMarkerSymbol},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"simpleLineSymbol",{get:function(){this._simpleLineSymbol||(this._simpleLineSymbol={type:!0,style:!0,color:this.color,width:this._numberValidator},this._simpleLineSymbol[k]=!0);return this._simpleLineSymbol},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"simpleFillSymbol",{get:function(){this._simpleFillSymbol||
(this._simpleFillSymbol={type:!0,style:!0,color:this.color,outline:this.simpleLineSymbol},this._simpleFillSymbol[k]=!0);return this._simpleFillSymbol},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"pictureMarkerSymbol",{get:function(){this._pictureMarkerSymbol||(this._pictureMarkerSymbol={type:!0,url:this._urlValidator,imageData:!0,contentType:!0,width:this._numberValidator,height:this._numberValidator,angle:this._numberValidator,xoffset:this._numberValidator,yoffset:this._numberValidator},
this._pictureMarkerSymbol[k]=!0);return this._pictureMarkerSymbol},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"pictureFillSymbol",{get:function(){this._pictureFillSymbol||(this._pictureFillSymbol={type:!0,url:this._urlValidator,imageData:!0,contentType:!0,outline:this.simpleLineSymbol,width:this._numberValidator,height:this._numberValidator,angle:this._numberValidator,xoffset:this._numberValidator,yoffset:this._numberValidator,xscale:this._numberValidator,yscale:this._numberValidator},
this._pictureFillSymbol[k]=!0);return this._pictureFillSymbol},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"textSymbol",{get:function(){this._textSymbol||(this._textSymbol={type:!0,color:this.color,backgroundColor:this.color,borderLineSize:this._numberValidator,borderLineColor:this.color,haloSize:this._numberValidator,haloColor:this.color,verticalAlignment:!0,horizontalAlignment:!0,rightToLeft:!0,angle:this._numberValidator,xoffset:this._numberValidator,yoffset:this._numberValidator,
kerning:!0,font:{family:!0,size:this._numberValidator,style:!0,weight:!0,decoration:!0},text:!0},this._textSymbol[k]=!0);return this._textSymbol},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"template",{get:function(){this._template||(this._template={description:!0,drawingTool:!0,name:!0,prototype:this.feature});return this._template},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"type",{get:function(){var a=this;this._type||(this._type={domains:function(b){if(!b)return!0;
var c={},d=0;for(b=Object.keys(b);d<b.length;d++)c[b[d]]=a.domain;return c},id:this._numberValidator,name:!0,templates:{item:this.template}});return this._type},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"webMap",{get:function(){this._webMap||(this._webMap={operationalLayers:{item:this.operationalLayer},baseMap:this.baseMap,bookmarks:{item:this.bookmark},version:!0,applicationProperties:!0});return this._webMap},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"wmsLayer",{get:function(){this.wmsLayer||(this._wmsLayer=$.extend({},this.operationalLayer,{copyright:!0,extent:this.extent,format:!0,mapUrl:this._urlValidator,maxHeight:this._numberValidator,maxWidth:this._numberValidator,spatialReferences:{item:this._numberValidator},version:!0}));return this._wmsLayer},enumerable:!0,configurable:!0});return b}();g.WebMapFilter=c})(d.webMap||(d.webMap={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer=
{}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var m=function(){function c(b){if(!b)throw Error("ProjectManager: Parameter 'app' is required.");this.app=b;this.convert=new g.WebMapConverter(b);this.filter=new g.WebMapFilter(b)}c.prototype.create=function(){var b=this;if(!this.app.site||!this.app.site.isInitialized)throw Error("WebMapConverter.fromCurrentMap: The Essentials site for this application is missing or not yet initialized.");this.convert.clearCache();var a=this.app.site.essentialsMap,
c=function(a,b){console.warn('Unable to convert map service "{0}" to web map format: {1}'.format(a.displayName,b))},f=a.mapServices.filter(function(a){return a.mapServiceFunction===d.essentials.MapServiceFunction.OPERATIONAL}).reverse(),g=k.infrastructure.ArrayUtils.mapWithErrorCallback(f,function(a){return b.convert.fromGcxMapService(a)},c);h.GraphicUtils.getUserGraphicsLayers(this.app).filter(function(a){return 0<a.graphics.length}).forEach(function(a){try{g.push(b.convert.fromEsriLayer(a))}catch(c){console.warn('Unable to convert graphics layer "{0}" to web map format: {1}'.format(a.id,
c))}});var n=a.mapServices.filter(function(a){return a.isVisible()&&a.mapServiceFunction===d.essentials.MapServiceFunction.BASE}).reverse(),m="",p=k.infrastructure.ArrayUtils.mapWithErrorCallback(n,function(a){return b.convert.fromGcxMapService(a)},c);n.length&&(a=a.baseMaps.filter(function(a){return n.every(function(b){return a.services.some(function(a){return a.mapService===b})})}),m=1===a.length?a[0].displayName:n[n.length-1].displayName);p.length||(m="Light Gray Canvas",p[0]={id:"World_Light_Gray_Base_1486",
layerType:"ArcGISTiledMapServiceLayer",opacity:1,visibility:!0,url:"http://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer"});return this.app.bookmarks["export"]().then(function(a){return{operationalLayers:g,baseMap:{title:m,baseMapLayers:p},bookmarks:a,version:"1.7"}})};return c}();g.WebMapManager=m})(h.webMap||(h.webMap={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||
(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(g){function k(b,a,d,f){if("object"===typeof b&&d.has(b))return Promise.resolve(d.get(b));for(;"function"===typeof a;)a=a(b,f);return a&&"function"===typeof a.validate?a.validate(b,f).then(function(a){return a.validatedValue}):"object"===typeof a&&"object"===typeof b?c(b,a,d,f):!0===a?Promise.resolve(b):Promise.reject(g.FILTERED)}function c(b,a,c,f){if(!b)return Promise.resolve(b);if(c.has(b))return c.get(b);for(var g;"function"===typeof a;)a=
a(b,f);if("object"===typeof a)if(Array.isArray(b))g=d.PromiseUtils.mapSkipRejected(b,function(b){return k(b,a.item,c,f)}),c.set(b,g);else{var n={};c.set(b,n);g=d.PromiseUtils.mapSkipRejected(Object.keys(a),function(d){if(d in b)return k(b[d],a[d],c,f).then(function(a){n[d]=a})})["return"](n)}else g=k(b,a,c);return g}g.FILTERED={};g.filter=function(b,a,d){if(!a)return Promise.reject(Error("Filter required."));var f=new WeakMap;return c(b,a,f,d)}})(d.ObjectFilter||(d.ObjectFilter={}))})(d.infrastructure||
(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(){return function(c,b){var a=this;this.esriLayer=c;this.templateType="single-item";this.swatchElement=null;this.label=new Observable("");this.description=new Observable("");this.isVisible=new Observable(!0);this.isVisibleInLayerListLegend=new Observable(!0);this.isCluster=!1;this.expanded=new Observable(!0);this.expanderClass=new Observable;this.children=new ObservableCollection;this.children.useThrottling=!!b;this.expanderClass.syncTransform(this.expanded,
function(a){return a?"tree-expander expanded":"tree-expander collapsed"});this.expanded.pulse();this.isVisibleInLayerListLegend.syncTransform(this.isVisible,function(b){return a.isCluster?b:!0})}}();d.LegendItem=h})(d.legend||(d.legend={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){(function(c){c[c.NotFound=0]="NotFound";c[c.Rendered=1]="Rendered";c[c.Show=2]="Show";c[c.Hide=3]="Hide";c[c.Pending=4]="Pending";c[c.Error=5]="Error"})(d.LegendItemProviderResponseCode||(d.LegendItemProviderResponseCode={}));var h=function(){return function(c,b){this.code=new Observable(c);this.item=b}}();d.LegendItemProviderResponse=h})(d.legend||(d.legend={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||
(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(){return function(c,b){this.identifier=c;this._provider=b}}();d.LegendItemProviderEntry=h})(d.legend||(d.legend={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(g){var k=function(){function c(){}c.registerLegendItemProvider=function(b){var a=this,c=function(b,c){a._legendItemInfos.push({uniqueId:b,legendItem:c});for(var d=0;d<a._legendItemCallbacks.length;d++)if(b===a._legendItemCallbacks[d].uniqueId){a._legendItemCallbacks[d].callback(c);a._legendItemCallbacks.splice(d,1);break}},f=function(a){var b=a.essLayer&&a.essLayer.mapService&&a.essLayer.mapService.id||a.children&&a.children.length()&&
a.children.getAt(0).essLayer&&a.children.getAt(0).essLayer.mapService&&a.children.getAt(0).essLayer.mapService.id||a.esriLayer.id;a=a.essLayer&&a.essLayer.id||a.sublayerId||null;return b+(null!=a?"."+a:"")},k=function(a){if(a){if("group"===a.templateType){var b;if(b=a.children.length())a:{b=a.children.get();if(b.length)for(var d,g=0;g<b.length;g++){var h=b[g].sublayerId||b[g].essLayer&&b[g].essLayer.id;0===g&&(d=h);if(h!==d||"single-item"!==b[g].templateType){b=!1;break a}}b=!0}if(b){d=a.children.getAt(0);
c(f(d),a);return}if(a.children&&a.children.length())for(d=0,b=a.children.length();d<b;d++)g=a.children.getAt(d),k(g)}"single-item"===a.templateType&&c(f(a),a)}};dojo.aspect.after(b,"provide",function(b){var c=b.code.get();if(c===g.LegendItemProviderResponseCode.Pending||c===g.LegendItemProviderResponseCode.Show)if(c===d.legend.LegendItemProviderResponseCode.Show)b.item&&k(b.item);else var e=b.code.bind(a,function(a){b.code.unbind(e);a===g.LegendItemProviderResponseCode.Show&&b.item&&k(b.item)});return b});
this._providers.push(b)};c.getProviders=function(){return this._providers};c.getLegendItemWhenAvailable=function(b,a){this.getLegendItemByIdWhenAvailable(b.uniqueId,a)};c.getLegendItemByIdWhenAvailable=function(b,a){if(b&&a){for(var c=null,d=0,g=this._legendItemInfos.length;d<g;d++){var h=this._legendItemInfos[d];h.uniqueId===b&&(c=h.legendItem)}c?a(c):this._legendItemCallbacks.push({uniqueId:b,callback:a})}};c._providers=[];c._legendItemInfos=[];c._legendItemCallbacks=[];return c}();g.LegendItemProviderFactory=
k})(d.legend||(d.legend={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(){return function(){}}();d.ResultsPageChangedEventArgs=h})(d.eventArgs||(d.eventArgs={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(g){var k=function(){function c(){}c.fromGeocortexApp=function(b){var a=new c;a.gcxApp=b;a.urlParameters=b.urlParameters;b.isArcGisWebApp?a.mapInfo=g.MapInfo.fromEsriMap(b.map):(a.essentialsVersion=b.site.getEssentialsVersion(),a.mapInfo=g.MapInfo.fromViewerApp(b));a.map=a.mapInfo.map;return a};c.prototype.getGeometryService=function(){return this._geometryService?this._geometryService:this.geometryServiceUrl?this._geometryService=new esri.tasks.GeometryService(this.geometryServiceUrl):
this.gcxApp?d.GeometryUtils.getGeometryService(this.gcxApp):null};return c}();g.AppInfo=k})(d.gis||(d.gis={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var m=function(){function c(){this.subtypeDomains={};this.subtypeDomainInfos={};this.isVisible=!0}c.fromEsriField=function(b,a,d){var f=new c;f.name=b.name;f.type=b.type;f.alias=d?d.displayName||b.alias:b.alias;f.isVisible=d?d.visible:!0;f.searchable=d?d.searchable:!0;f.editable=b.editable;f.nullable=b.nullable;f.length=b.length;f.esriField=b;f.isTypeField=a&&a.typeIdField===b.name;if(a){if(f.isTypeField&&!b.domain){var h=new esri.layers.CodedValueDomain;
h.codedValues=[];h.type="codedValue";a.types.forEach(function(a){h.codedValues.push({name:a.name,code:a.id})});f.domainInfo=g.DomainInfo.create(h);f.domain=h}else f.domainInfo=g.DomainInfo.create(b.domain),f.domain=b.domain;a.types&&a.types.forEach(function(a){for(var c in a.domains)if(a.domains.hasOwnProperty(c)&&c===b.name&&null!==a.id){c=a.domains[c];f.subtypeDomains[a.id.toString()]=c;f.subtypeDomainInfos[a.id.toString()]=g.DomainInfo.create(c);break}})}if(d){f.format=d.format;if(!f.format)if(f._isNumericFormat()){if(a=
[d.layer.defaultNumberFormat,d.layer.mapService.defaultNumberFormat].filter(function(a){return!!a})[0])f.format="{0:"+a+"}"}else f.isDate()&&(a=[d.layer.defaultDateFormat,d.layer.mapService.defaultDateFormat].filter(function(a){return!!a})[0])&&(f.format="{0:"+a+"}");f.timeZoneId||(f.timeZoneId=k.infrastructure.TimeZoneUtils.getTimeZoneFromLayer(d.layer));f.displayTimeZoneId||(f.displayTimeZoneId=k.infrastructure.TimeZoneUtils.getDisplayTimeZoneFromMapService(d.layer.mapService))}return f};c.fromGcxField=
function(b){var a=new esri.layers.Field;new c;a.name=b.name;a.type=d.essentials.Field.convertToEsriFieldType(b.dataType);a.alias=b.displayName;a.editable=!1;a.nullable=!0;return c.fromEsriField(a,null,b)};c.prototype.isNumeric=function(){return 0<=dojo.indexOf([d.essentials.EsriFieldTypes.esriFieldTypeOID,d.essentials.EsriFieldTypes.esriFieldTypeSmallInteger,d.essentials.EsriFieldTypes.esriFieldTypeInteger,d.essentials.EsriFieldTypes.esriFieldTypeSingle,d.essentials.EsriFieldTypes.esriFieldTypeDouble],
this.type)?!0:!1};c.prototype.isDate=function(){return 0<=dojo.indexOf([d.essentials.EsriFieldTypes.esriFieldTypeDate],this.type)?!0:!1};c.prototype.isText=function(){return 0<=dojo.indexOf([d.essentials.EsriFieldTypes.esriFieldTypeString],this.type)?!0:!1};c.prototype.isCodedValueDomain=function(){return this.domainInfo&&this.domainInfo.isCodedValueDomain()};c.prototype.hasSubtypeCodedValueDomains=function(){for(var b in this.subtypeDomainInfos)if(this.subtypeDomainInfos.hasOwnProperty(b)&&this.subtypeDomainInfos[b].isCodedValueDomain())return!0;
return!1};c.prototype.getCodedValueDomain=function(){return this.domain};c.prototype.getSubtypeCodedValueDomains=function(){var b={},a;for(a in this.subtypeDomainInfos)this.subtypeDomainInfos.hasOwnProperty(a)&&this.subtypeDomainInfos[a].isCodedValueDomain()&&(b[a]=this.subtypeDomainInfos[a].domain);return b};c.prototype.resolveCodedDomainValue=function(b,a){var c=null;this.domainInfo&&(c=this.domainInfo.getName(b));if(null==c){var d=this.subtypeDomainInfos[a];d&&(c=d.getName(b))}return c};c.prototype.formatValue=
function(b,a){var c=this;if(this.isCodedValueDomain()||this.hasSubtypeCodedValueDomains()){var d=this.resolveCodedDomainValue(b,a);if(null!=d)return d}return this.format?this.format.replace(/\{0(?::([^}]*))?\}/,function(a,d){if(c.isDate()){var f={timeZoneId:c.timeZoneId,displayTimeZoneId:c.displayTimeZoneId};return h.FormatUtils.formatDate(h.FormatUtils.parseDate(b),d,f)}return c._isNumericFormat()?h.FormatUtils.formatNumber(h.FormatUtils.parseNumber(b),d):null===b||void 0===b?b:b.toString()}):this.isDate()?
(d={timeZoneId:this.timeZoneId,displayTimeZoneId:this.displayTimeZoneId},h.FormatUtils.formatDate(h.FormatUtils.parseDate(b),null,d)):this._isNumericFormat()?h.FormatUtils.formatNumber(h.FormatUtils.parseNumber(b)):null===b||void 0===b?b:b.toString()};c.prototype._isNumericFormat=function(){return this.isNumeric()&&this.type!==d.essentials.EsriFieldTypes.esriFieldTypeOID&&(!this.name||"OBJECTID"!==this.name.toUpperCase())};return c}();g.FieldInfo=m})(h.gis||(h.gis={}))})(k.infrastructure||(k.infrastructure=
{}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var h=function(){function c(){this.fields=[];this.isUserCreated=!1;this.isExpanded=this.includeInLayerList=!0;this._fieldsRetrieved=this._visible=!1}c.fromEsriLayerInfo=function(b,a){var e=new c;e.esriLayerInfo=b;e.id=b.id+"";e.name=b.name;e.displayName=b.name;e.parentLayerId=b.parentLayerId?b.parentLayerId.toString():null;e.subLayerIds=b.subLayerIds?dojo.map(b.subLayerIds,function(a){return a.toString()}):null;e.uniqueId=a.id.replace(".",
"..")+"."+b.id;e.url=d.essentials.utilities.DecomposedUri.appendToPath(a.url,"/"+b.id);e.queryable=!0;e.dataProvider="Default";e._visible=b.defaultVisibility;return e};c.fromEsriFeatureLayer=function(b){var a=new c;a.id=b.id+"";a.name=b.name;a.displayName=b.name;a.uniqueId=b.id;a.url=b.url;a.queryable=!0;a.dataProvider="Default";a._featureLayer=b;a._visible=b.defaultVisibility;a.subLayerIds=null;a.parentLayerId=null;a.relationships=b.relationships;return a};c.fromGcxLayer=function(b){var a=new c;
a.gcxLayer=b;a.id=b.id;a.name=b.name;a.displayName=b.displayName||b.name;a.uniqueId=b.mapService.id+"."+b.id;a.dataProvider=b.dataProvider||"Default";a.isExpanded=b.isExpanded;a.isUserCreated=b.isUserCreated;a.relationships=b.relationships;b.mapService.drawingBehavior==d.essentials.DrawingBehavior.FEATURE_LAYER?a.url=b.mapService.serviceLayer.url:b.mapService.mapServiceType==d.essentials.MapServiceType.DYNAMIC||b.mapService.mapServiceType==d.essentials.MapServiceType.TILED?a.url=d.essentials.utilities.DecomposedUri.appendToPath(b.mapService.serviceLayer.url,
"/"+b.id):b.mapService.serviceLayer instanceof esri.layers.WMSLayer&&(a.url=b.url);b.parentLayerId&&(a.parentLayerId=b.parentLayerId);a.subLayerIds=b.subLayerIds?b.subLayerIds:null;a.includeInLayerList=b.includeInLayerList;a.queryable=b.queryable&&0<b.fields.length&&b.supportsQuery;a._visible=b.configuredVisible;return a};c.prototype.getFields=function(){var b=this,a=new dojo.Deferred;this._fieldsRetrieved?a.resolve(this.fields):this.getInitializedFeatureLayer().then(function(c){for(var d=0;d<c.fields.length;d++){var h=
c.fields[d],k=b.gcxLayer?b.gcxLayer.getFieldByName(h.name):null,h=g.FieldInfo.fromEsriField(h,c,k);b.fields.push(h)}b._fieldsRetrieved=!0;a.isCanceled()||a.resolve(b.fields)},function(b){a.errback(b)});return a};c.prototype.getInitializedFeatureLayer=function(){var b=this;return this.gcxLayer?this.gcxLayer.getFeatureLayer():new Promise(function(a,c){b._featureLayer||(b._featureLayer=new esri.layers.FeatureLayer(b.url));if(b._featureLayer.loaded)a(b._featureLayer);else if(b._featureLayer.__attached_error)c(b._featureLayer.__attached_error);
else var f=b._featureLayer.on("load",function(){f.remove();g.remove();if(b.gcxLayer.wmsLayerName)for(var c=b.gcxLayer.fields,e=b._featureLayer.fields.length-1;0<=e;e--){var h=b._featureLayer.fields[e];"gml:id"===h.name&&b._featureLayer.fields.splice(e,1);h.type=d.essentials.Field.convertToEsriFieldType(c[e].dataType)}a(b._featureLayer)}),g=b._featureLayer.on("error",function(a){f.remove();g.remove();b._featureLayer.__attached_error=a;c(a)})})};c.prototype.setDefinitionExpression=function(b){var a=
this.serviceLayerInfo.serviceLayer;if(a instanceof esri.layers.ArcGISDynamicMapServiceLayer){var c=a.layerDefinitions||[];b&&"1 = 1"!=b?c[parseInt(this.id)]=b:delete c[parseInt(this.id)];a.setLayerDefinitions(c)}else a instanceof esri.layers.FeatureLayer&&(b&&"1 = 1"!=b?a.setDefinitionExpression(b):a.setDefinitionExpression(null))};c.prototype.getDefinitionExpression=function(){var b=this.serviceLayerInfo.serviceLayer;return b instanceof esri.layers.ArcGISDynamicMapServiceLayer?(b.layerDefinitions||
[])[parseInt(this.id)]:null};c.prototype.isVisible=function(){return this.gcxLayer?this.gcxLayer.isVisible():this._visible};c.prototype.areAllAncestorsVisible=function(){for(var b=this.serviceLayerInfo.findLayerById(this.parentLayerId);null!==b&&void 0!==b;){if(!b.isVisible())return!1;b=this.serviceLayerInfo.findLayerById(b.parentLayerId)}return!0};c.prototype.setVisibility=function(b,a,c,d){void 0===a&&(a=!1);void 0===c&&(c=!1);void 0===d&&(d=150);var g=!1;c&&this.serviceLayerInfo&&this.serviceLayerInfo.serviceLayer&&
(g=this.serviceLayerInfo.supportsLayerVisibility());this.gcxLayer?this.gcxLayer.setVisibility(b,a||g):this.setEsriLayerVisibility(b,a||g);g&&this.serviceLayerInfo.refresh(d)};c.prototype.setEsriLayerVisibility=function(b,a){var c=this;void 0===a&&(a=!1);if((this._visible=b)||this.serviceLayerInfo.serviceLayer.visible){var f={mapServiceId:this.serviceLayerInfo.id,layerId:this.id,visibility:b},g,h;h=this.serviceLayerInfo.serviceLayer;switch(this.serviceLayerInfo.serviceType){case d.essentials.MapServiceType.DYNAMIC:if(h instanceof
esri.layers.FeatureLayer)b?h.show():h.hide(),dojo.publish("LayerVisibilityChange",[Array(f)]);else if((g=this.serviceLayerInfo.serviceLayer.visibleLayers.slice(0).map(function(a){return a.toString()}))&&g.length||h.layerInfos&&h.layerInfos.length){1===g.length&&"-1"==g[0]&&g.pop();h=g.findIndex(function(a){return a==c.id});if(b){if(-1!==h)break;if(this.subLayerIds&&this.subLayerIds.length)break;g.push(this.id)}else{if(-1===h)break;g.splice(h,1)}g.length||g.push("-1");g.InternallyChangedLayer=f;this.serviceLayerInfo.serviceLayer.setVisibleLayers(g,
a)}else h.setVisibility(b),dojo.publish("LayerVisibilityChange",[Array(f)]);break;case d.essentials.MapServiceType.WMS:if(null!==h){var k=[];k.InternallyChangedLayer=f;for(h=g=0;h<this.serviceLayerInfo.layers.length;h++){var m=this.serviceLayerInfo.layers[h];m.isVisible()&&(null===m.subLayerIds||0===m.subLayerIds.length)&&m.areAllAncestorsVisible()&&(m=m.gcxLayer?m.gcxLayer.wmsLayerName:m.serviceLayerInfo.serviceLayer.id,this.gcxLayer&&this.gcxLayer.wmsLayerName===m||this.serviceLayerInfo.serviceLayer.id===
m||null!==m&&""!==m)&&(k[g]=m,g++)}a?(this.serviceLayerInfo.serviceLayer.visibleLayers=k.slice(0),dojo.publish("LayerVisibilityChange",[Array(f)])):this.serviceLayerInfo.serviceLayer.setVisibleLayers(k)}break;case d.essentials.MapServiceType.FEATURE:case d.essentials.MapServiceType.GEORSS:case d.essentials.MapServiceType.KML:case d.essentials.MapServiceType.BING:case d.essentials.MapServiceType.TILED:case d.essentials.MapServiceType.WMTS:case d.essentials.MapServiceType.IMAGE:case d.essentials.MapServiceType.WEBTILED:if(null!==
h)if(1===this.serviceLayerInfo.layers.length)b?h.show():h.hide(),dojo.publish("LayerVisibilityChange",[Array(f)]);else throw Error("Visibility of individual layers cannot be set for this Map Service: {0}".format(this.displayName));break;default:throw Error("Cannot set layer visibility. Unknown MapService type.");}}};c.prototype.getMinScale=function(){var b;b=this.gcxLayer?this.gcxLayer.minScale:this._featureLayer?this._featureLayer.minScale:this.esriLayerInfo.minScale;return this.serviceLayerInfo&&
this.serviceLayerInfo.serviceLayer.minScale?Math.min(b,this.serviceLayerInfo.serviceLayer.minScale):b};c.prototype.getMaxScale=function(){var b;b=this.gcxLayer?this.gcxLayer.maxScale:this._featureLayer?this._featureLayer.maxScale:this.esriLayerInfo.maxScale;return this.serviceLayerInfo&&this.serviceLayerInfo.serviceLayer.maxScale?Math.max(b,this.serviceLayerInfo.serviceLayer.maxScale):b};return c}();g.LayerInfo=h})(h.gis||(h.gis={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping=
{}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(){function c(){this.serviceLayers=[];this.markupLayer=new Observable}c.fromEsriMap=function(b){var a=new c;a.map=b;a.markupLayer.set(b.graphics);for(var e=b.layerIds.concat(b.graphicsLayerIds),f=0;f<e.length;f++){var h=b.getLayer(e[f]),h=d.ServiceLayerInfo.fromEsriLayer(h);a.serviceLayers.push(h)}return a};c.fromViewerApp=function(b){var a=c.fromEssentialsMap(b.site.essentialsMap);a.markupLayer.sync(b.markupLayer);return a};
c.fromEssentialsMap=function(b){var a=new c;a.gcxMap=b;a.map=b.getMap();a.markupLayer.set(b.getMap().graphics);for(var e=0;e<b.mapServices.length;e++){var f=d.ServiceLayerInfo.fromGcxMapService(b.mapServices[e]);a.serviceLayers.push(f)}return a};c.prototype.getLayerInfos=function(){for(var b=[],a=0;a<this.serviceLayers.length;a++)for(var c=this.serviceLayers[a].layers,d=0;d<c.length;d++)b.push(c[d]);return b};c.prototype.getTableInfos=function(){for(var b=[],a=0;a<this.serviceLayers.length;a++)for(var c=
this.serviceLayers[a].tables,d=0;d<c.length;d++)b.push(c[d]);return b};c.prototype.getGraphicsLayers=function(){var b=[];b.push(this.map.graphics);for(var a=0;a<this.map.graphicsLayerIds.length;a++)b.push(this.map.getLayer(this.map.graphicsLayerIds[a]));return b};c.prototype.findMapServiceById=function(b){for(var a=null,c,d=0,g=this.serviceLayers.length;d<g;d++){var h=this.serviceLayers[d];null==a&&(a=!(!h||!h.gcxMapService));if((c=a?h.gcxMapService:h.serviceLayer)&&c.id===b)return h}return null};
return c}();d.MapInfo=h})(d.gis||(d.gis={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(){function c(){}c.create=function(b){var a=new c;a.domain=b;return a};c.prototype.isCodedValueDomain=function(){return this.domain&&"codedValue"==this.domain.type};c.prototype.getCodedValueDomain=function(){return this.domain};c.prototype.getName=function(b){if(this.isCodedValueDomain())for(var a=0;a<this.getCodedValueDomain().codedValues.length;a++){var c=this.getCodedValueDomain().codedValues[a];if(c.code+""==b+"")return c.name}return null};
return c}();d.DomainInfo=h})(d.gis||(d.gis={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(){function c(b,a){this.app=b;this.libraryId=a}c.prototype.initialize=function(b){};c.prototype.search=function(b,a){};c.prototype.cancelSearch=function(){};c.prototype.getResource=function(b,a){return this.app.getResource(this.libraryId,b,a)};return c}();d.IdentifyProviderBase=h})(d.identify||(d.identify={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer=
{}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(g){var k=function(c){function b(a,b,d){c.call(this,a,g.LayerListItemType.FOLDER,d);this.layerThemeSettings=[];this.containedMapServices=[];this.isUserCreated=this.configuredVisible=!1;this._layerVisibilityHandle=null;this.name=new Observable(b||this.layerList.appInfo.gcxApp.getResource(this.layerList._libraryId,"language-layerlist-default-folder-title"));this._setTooltips();d._addedFolderReferences.push(this)}__extends(b,c);b.prototype.setVisibility=
function(a){c.prototype.setVisibility.call(this,a);void 0==this._deferredVisibilitySetting&&(this.currentUserClickOriginator=!1,this.mapService&&this.mapService.setVisibility(a&&this.allAncestorsVisible&&(this.inActiveTheme.get()||this.mapService.isUserCreated)))};b.prototype.refreshOnDemandItemCollection=function(a){c.prototype.refreshOnDemandItemCollection.call(this,a);this.displayItem.set(this.displayInLayerList())};b.prototype.linkWithMapService=function(a){var b=this;a&&(this.mapService=a,this.layerList._handledMapServiceReferences.push(this.mapService),
-1===this.layerList._allMapServiceReferences.indexOf(this.mapService)&&this.layerList._allMapServiceReferences.push(this.mapService),this._setupOpacityBindings(),this._layerVisibilityHandle=this.mapService.serviceLayer.on("visibility-change",function(a){if(void 0!=b._deferredVisibilitySetting||b.isEffectivelyVisible.get()!==a.visible||b.isEffectivelyVisible.get()&&!b.inActiveTheme.get()&&!b.mapService.isUserCreated)a=a.visible&&(b.inActiveTheme.get()||b.mapService.isUserCreated),b.isVisible.set(a)}))};
b.prototype._setupOpacityBindings=function(){var a=this;1===this.containedMapServices.length?c.prototype._setupOpacityBindings.call(this):1<this.containedMapServices.length&&(this.canAdjustOpacity.set(!0),this.opacity=new Observable(1),this.opacity.bind(this,function(b){for(var c=0;c<a.containedMapServices.length;c++)a.containedMapServices[c].gcxMapService&&a.containedMapServices[c].gcxMapService.setOpacityFilter(b)}))};b.prototype.cleanUp=function(){c.prototype.cleanUp.call(this);this._layerVisibilityHandle&&
(this._layerVisibilityHandle.remove(),this._layerVisibilityHandle=null)};b.prototype._handleLayerThemeChangingEvent=function(a){a.currTheme&&(this.isUserCreated||this.isVisible.get()||this.isVisible.set(!0))};b.prototype._handleLayerThemeChangedEvent=function(a){if(a.currTheme){a=a.currTheme;if(this.isUserCreated)this._setInActiveThemeIfChildrenPresent();else if(a.isDefaultTheme)this.isVisible.get()!==this.configuredVisible&&this.isVisible.set(this.configuredVisible),this._setInActiveThemeIfChildrenPresent();
else{if(this.layerThemeSettings.length)for(var b=0;b<this.layerThemeSettings.length;b++){var c=this.layerThemeSettings[b];if(a.id===c.theme.id){a=void 0==c.visible?this.configuredVisible:c.visible;this.isVisible.get()!==a&&this.isVisible.set(a);this._setInActiveThemeIfChildrenPresent();this._refreshMutuallyExclusiveItemVisibilities();this.refreshOnDemandItemCollection();this._updateDisplayItem();return}}this.isVisible.set(!1);this.inActiveTheme.set(!1)}this._refreshMutuallyExclusiveItemVisibilities();
this.refreshOnDemandItemCollection();this._updateDisplayItem()}};b.prototype._refreshMutuallyExclusiveItemVisibilities=function(){this.children.get().forEach(function(a){a.isMutuallyExclusive.get()&&a.isVisible.get()&&a.isVisible.pulse()})};b.prototype._setInActiveThemeIfChildrenPresent=function(){var a=this._recursivelyConfirmChildrenInActiveTheme(this.children.get());!a&&this.inActiveTheme.get()&&this.inActiveTheme.set(!1);a&&!this.inActiveTheme.get()&&this.inActiveTheme.set(!0)};b.prototype._recursivelyConfirmChildrenInActiveTheme=
function(a){for(var b=0;b<a.length;b++){var c;c=a[b];c=c.type===d.layerList.LayerListItemType.FOLDER?c.children&&c.children.length()?this._recursivelyConfirmChildrenInActiveTheme(c.children.get()):!1:c.inActiveTheme.get();if(c)return!0}return!1};return b}(g.LayerListItem);g.LayerListFolderItem=k})(d.layerList||(d.layerList={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(g){var k=function(c){function b(a,b,f,k){c.call(this,a,k||g.LayerListItemType.LAYER,f);this._zoomEndHandle=this._layerVisibilityHandle=this._themeSyncHandle=null;this._deferRefreshTimeoutMs=200;this._forceSetAncestorVisibilityOperationActive=!1;if(!b)throw Error("LayerListLayerItem Initialization failed. Layer cannot be null");this.isUserCreated=b.isUserCreated;this.layer=b;this._updateVisibilityAtCurrentScale();this._zoomEndHandle=this.layerList.appInfo.mapInfo.map.on("zoom-end",
dojo.hitch(this,this._updateVisibilityAtCurrentScale));this.type===d.layerList.LayerListItemType.LAYER&&(a=b.gcxLayer?b.gcxLayer.isVisible()||b.gcxLayer.configuredVisible:!0,this.canNotAssignVisibility.set(!this.layer.serviceLayerInfo.supportsLayerVisibility()),this._deferredVisibilitySetting=a,this.isVisible.set(a));this.name.set(b.displayName||b.name);this._setTooltips();this.mapService=b.serviceLayerInfo;-1===f._allMapServiceReferences.indexOf(this.mapService)&&f._allMapServiceReferences.push(this.mapService);
this.enableLayerActions=!0;this._subscribeEvents();this._setupGcxBindingsIfAvailable()}__extends(b,c);b.prototype.setVisibility=function(a,b){c.prototype.setVisibility.call(this,a);this._forceSetAncestorVisibilityOperationActive=this._forceSetAncestorVisibilityOperationActive||b;if(!(this.canNotAssignVisibility&&this.canNotAssignVisibility.get()||void 0===this.allAncestorsVisible||void 0!=this._deferredVisibilitySetting)){if((this._forceSetAncestorVisibilityOperationActive||this.layerList.autoActivateAncestorVisibilities&&
this.currentUserClickOriginator)&&!0===a&&!this.allAncestorsVisible){this.isVisible.get()!==a&&this.isVisible.set(a);for(var d=this.parent;d&&d.id!==this.layerList.id&&d.isVisible.get();)d=d.parent;if(d&&d.id!==this.layerList.id){d.isVisible.set(!0);return}}d=!this.currentUserClickOriginator&&this.mapService.supportsLayerVisibility();this._forceSetAncestorVisibilityOperationActive=this.currentUserClickOriginator=!1;var g=a&&this.allAncestorsVisible&&(this.inActiveTheme.get()||this.layer.isUserCreated);
this.layer.isVisible()!==g&&this.layer.setVisibility(g,!1,d,this._deferRefreshTimeoutMs)}};b.prototype.updateLegendItems=function(){var a=this;d.legend.LegendItemProviderFactory.getLegendItemWhenAvailable(this.layer,dojo.hitch(this,function(b){a.legendItems.clear();a._populateLegendItem(b)}))};b.prototype.bindToActiveTheme=function(){var a=this;c.prototype.bindToActiveTheme.call(this);this._themeSyncHandle=dojo.subscribe("LayerInActiveThemeChangedEvent",function(b){b&&b===a.layer.gcxLayer&&a.inActiveTheme.set(b.inActiveTheme)})};
b.prototype.unbindFromActiveTheme=function(){c.prototype.unbindFromActiveTheme.call(this);this._themeSyncHandle&&dojo.unsubscribe(this._themeSyncHandle);this._themeSyncHandle=null};b.prototype.cleanUp=function(){c.prototype.cleanUp.call(this);this._layerVisibilityHandle&&(dojo.unsubscribe(this._layerVisibilityHandle),this._layerVisibilityHandle=null);this._zoomEndHandle&&(this._zoomEndHandle.remove(),this._zoomEndHandle=null)};b.prototype._subscribeEvents=function(){this._layerVisibilityHandle=dojo.subscribe("LayerVisibilityChange",
dojo.hitch(this,this._handleLayerVisibilityChange))};b.prototype._onServiceLayerProcessed=function(){this._setupIconUri();this.layerList.enableLegendIntegration&&!this.layer.serviceLayerInfo.serviceLayer.loadError&&d.legend.LegendItemProviderFactory.getLegendItemWhenAvailable(this.layer,dojo.hitch(this,this._populateLegendItem))};b.prototype._handleLayerVisibilityChange=function(a){if(a&&a.length&&a[0].mapServiceId===this.layer.serviceLayerInfo.id)for(var b=0;b<a.length;b++)if(a[b].layerId===this.layer.id){if(void 0==
this._deferredVisibilitySetting&&this.isEffectivelyVisible.get()===a[b].visibility&&(!this.isEffectivelyVisible.get()||this.inActiveTheme.get()||this.layer.isUserCreated))break;a=a[b].visibility&&(this.inActiveTheme.get()||this.layer.isUserCreated);this.isVisible.set(a);break}};b.prototype._populateLegendItem=function(a){"single-item"===a.templateType?(this.expandLegend.set(!1),this.legendItems.addItem(a),this.legendSwatch.set(a.swatchElement)):(this.legendItems.addItems(a.children.get()),1===this.legendItems.length()?
this.legendSwatch.set(this.legendItems.getAt(0).swatchElement):this.legendItems.length()&&this.legendSwatch.set(this.layerList.multiLegendSwatchElement||this.legendItems.getAt(0).swatchElement));1<this.legendItems.length()?this.legendHasMultipleItems.set(!0):this.legendHasMultipleItems.set(!1);this.legendItems.length()&&(this.iconUri.set(""),this.legendTooltip.set(1===this.legendItems.length()?this.layerList.singleLegendIconTooltip.format(this.name.get()):this.layerList.multiLegendIconTooltip),this.legendTooltip.set(this.legendTooltip.get().format(this.name.get())))};
b.prototype._setupIconUri=function(){var a=this.layer.gcxLayer,b=a?a.mapService:null;this.layer.serviceLayerInfo.serviceLayer.loadError&&this.layerList.serviceLoadFailureIconUri?(this.iconUri.set(this.layerList.serviceLoadFailureIconUri),this.iconTooltip.set(this.layerList.serviceLoadFailureIconTooltip?this.layerList.serviceLoadFailureIconTooltip:"")):this.layerList&&this.layerList.enableLayerIcons&&(a&&a.iconUri||b&&this.type===g.LayerListItemType.GRAPHICSLAYER&&b.iconUri)&&(this.iconUri.set(a.iconUri||
b.iconUri),this.iconTooltip.set(this.name.get()))};b.prototype._setupGcxBindingsIfAvailable=function(){var a=this;if(this.layer.gcxLayer)if(this.bindToActiveTheme(),this.layer.serviceLayerInfo.serviceLayer.loaded||this.layer.serviceLayerInfo.serviceLayer.loadError)this._onServiceLayerProcessed();else var b=null,c=null,d=function(){b&&dojo.disconnect(b);c&&dojo.disconnect(c);b=c=null},b=dojo.connect(this.mapService.serviceLayer,"onLoad",function(){d();a._onServiceLayerProcessed()}),c=dojo.connect(this.mapService.serviceLayer,
"onError",function(){d();a._onServiceLayerProcessed()})};b.prototype._updateVisibilityAtCurrentScale=function(){var a=!1,b=esri.geometry.getScale(this.layerList.appInfo.mapInfo.map);if(0==this.layer.getMaxScale()&&Infinity==this.layer.getMinScale()||isNaN(this.layer.getMaxScale())&&isNaN(this.layer.getMinScale()))a=!0;this.inVisibleScaleRange.set(a||this.layer.getMaxScale()<b&&b<this.layer.getMinScale())};return b}(g.LayerListItem);g.LayerListLayerItem=k})(d.layerList||(d.layerList={}))})(d.infrastructure||
(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(c){function b(a,b,f){c.call(this,a,b,f,d.LayerListItemType.GRAPHICSLAYER);if(!b)throw Error("LayerListGraphicsLayerItem Initialization failed. Layer cannot be null.");a=b.gcxLayer?b.gcxLayer.isVisible()||b.gcxLayer.configuredVisible:b.serviceLayerInfo.serviceLayer.defaultVisibility||b.isVisible();this.canNotAssignVisibility.set(!1);this._deferredVisibilitySetting=a;this.isVisible.set(a)}__extends(b,c);return b}(d.LayerListLayerItem);
d.LayerListGraphicsLayerItem=h})(d.layerList||(d.layerList={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(g){var k=function(c){function b(a,b){void 0===b&&(b=[]);c.call(this,b||[]);this._parent=a}__extends(b,c);b.prototype.addItem=function(a){if(a)this._prepItemForAddition(a),c.prototype.addItem.call(this,a),this._processItemPostAddition(a);else throw Error("Layer list item not defined. Cannot insert in collection.");};b.prototype.validateAndAddItem=function(a){if(!a)return!1;if(this._validateCanAdd(a))return this.addItem(a),!0;console.error("LayerListItemCollection: Cannot add item with id: {0} in collection. Validation failed.".format(a.id.get()));
return!1};b.prototype.addItems=function(a){if(a)this._prepItemsForAddition(a),c.prototype.addItems.call(this,a),this._processItemsPostAddition(a);else throw Error("Layer list items are not defined. Cannot insert in collection.");};b.prototype.validateAndAddItems=function(a){if(!a||!a.length)return!1;for(var b=0;b<a.length;b++)if(!this._validateCanAdd(a[b]))return console.error("LayerListItemCollection: Cannot add items in collection. Validation failed."),!1;this.addItems(a);return!0};b.prototype.insertItem=
function(a,b){if(b)this._prepItemForAddition(b),c.prototype.insertItem.call(this,a,b),this._processItemPostAddition(b);else throw Error("Layer list item not defined. Cannot insert at index "+a+" in collection.");};b.prototype.insertItems=function(a,b){if(b)this._prepItemsForAddition(b),c.prototype.insertItems.call(this,a,b),this._processItemsPostAddition(b);else throw Error("Layer list items are not defined. Cannot insert at index "+a+" in collection.");};b.prototype.validateAndInsertItem=function(a,
b){if(this._validateCanAdd(b))return this.insertItem(a,b),!0;console.error("LayerListItemCollection: Could not insert item with id: {0} in collection. Validation failed.".format(b.id.get()));return!1};b.prototype.validateAndInsertItems=function(a,b){if(!b||!b.length)return!1;for(var c=0;c<b.length;c++)if(!this._validateCanAdd(b[c]))return console.error("Could not insert items in collection. Validation failed."),!1;this.insertItems(a,b);return!0};b.prototype.removeItem=function(a){if(a)this._prepItemForRemoval(a),
c.prototype.removeItem.call(this,a);else throw Error("LayerListItemCollection: Cannot remove item at index from collection.");};b.prototype.removeAt=function(a){var b=this.getAt(a);if(b)this._prepItemForRemoval(b),c.prototype.removeAt.call(this,a);else throw Error("LayerListItemCollection: Cannot remove item at index "+a+" from collection.");};b.prototype.removeRange=function(a,b){a=void 0!=a?Math.max(0,a):0;b=void 0!=b?Math.min(b,this.getLength()-1):this.getLength()-1;this._prepItemsForRemoval(this.get().slice(a,
b+1));c.prototype.removeRange.call(this,a,b)};b.prototype.clear=function(){this._prepItemsForRemoval(this.get());c.prototype.clear.call(this)};b.prototype._prepItemForAddition=function(a){var b=this;this._parent&&(a.parent=this._parent,a.parentEffectivelyVisible.sync(a.parent.isEffectivelyVisible),a.setAncestorVisibility(this._parent.isVisible.get()),a._visibilityBindingToken=this._parent.isVisible.bind(a,function(c){a.setAncestorVisibility(c&&b._parent.allAncestorsVisible)}),this.length()&&this.getAt(0).isMutuallyExclusive.get()&&
(a.isMutuallyExclusive.set(!0),a.hasRadioToggle.set(!0),a.radioGroup.set(this.getAt(0).radioGroup.get())),a._displayItemBindingToken=a.displayItem.bind(a,function(a){if(a)b._parent.hasDisplayedChildren.set(!0);else{a=!1;for(var c=0;c<b.length();c++)if(b.getAt(c).displayItem.get()){a=!0;break}b._parent.hasDisplayedChildren.set(a)}}),a.displayItem.pulse())};b.prototype._processItemPostAddition=function(a){a.type!==d.layerList.LayerListItemType.MAPSERVICE&&a.type!==d.layerList.LayerListItemType.LAYER&&
a.type!==d.layerList.LayerListItemType.GRAPHICSLAYER||a.populateMapServicesInParentFolders()};b.prototype._prepItemForRemoval=function(a){a.parentEffectivelyVisible.removeSync();a.parent=null;a._visibilityBindingToken&&this._parent&&(this._parent.isVisible.unbind(a._visibilityBindingToken),a._visibilityBindingToken=null);if(a._displayItemBindingToken&&this._parent&&(a.displayItem.unbind(a._displayItemBindingToken),a._displayItemBindingToken=null,a.displayItem)){for(var b=!1,c=0;c<this.length();c++)if(this.getAt(c)!==
a&&this.getAt(c).displayItem.get()){b=!0;break}this._parent.hasDisplayedChildren.set(b)}a.cleanUp()};b.prototype._prepItemsForAddition=function(a){var b=this;dojo.forEach(a,function(a){b._prepItemForAddition(a)})};b.prototype._processItemsPostAddition=function(a){var b=this;dojo.forEach(a,function(a){b._processItemPostAddition(a)})};b.prototype._prepItemsForRemoval=function(a){var b=this;dojo.forEach(a,function(a){b._prepItemForRemoval(a)})};b.prototype._validateCanAdd=function(a){var b=this,c=(this.layerList||
this._parent.layerList).getDescendants();return c.filter(function(b){return b===a}).length?!1:a.type===g.LayerListItemType.FOLDER?a.children.getItems().every(function(a){return b._validateCanAdd(a)}):a.type===g.LayerListItemType.MAPSERVICE?a.mapService?!c.some(function(b){return b.mapService&&(b.mapService===a.mapService||b.mapService.serviceLayer===a.mapService.serviceLayer)}):!1:a.type===g.LayerListItemType.LAYER?a.layer?!c.some(function(b){return b.layer&&b.layer===a.layer}):!1:!0};return b}(ObservableCollection);
g.LayerListItemCollection=k})(d.layerList||(d.layerList={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var k=function(c){function b(a,b,d){var h=this;c.call(this,a,g.LayerListItemType.MAPSERVICE,d);this._layerVisibilityHandle=this._themeSyncHandle=null;this._forceSetAncestorVisibilityOperationActive=!1;if(!b)throw Error("LayerListMapServiceItem Initialization failed. MapService cannot be null");a=this.layerList&&this.layerList.mapInfo&&this.layerList.mapInfo.gcxMap&&this.layerList.mapInfo.gcxMap.layerThemesInfo&&this.layerList.mapInfo.gcxMap.layerThemesInfo.layerThemesConfigured?
b.gcxMapService&&b.gcxMapService.serviceLayer?b.gcxMapService.serviceLayer.visible:!0:b.gcxMapService?b.gcxMapService.configuredVisible:!0;this.name.set(b.displayName?b.displayName:"");this._setTooltips();this.mapService=b;d._handledMapServiceReferences.push(b);-1===d._allMapServiceReferences.indexOf(b)&&d._allMapServiceReferences.push(b);this._deferredVisibilitySetting=a;this.isVisible.set(a);this.enableMapServiceActions=this.isUserCreated=b.isUserCreated;this._setupOpacityBindings();this._subscribeEvents();
this._setupBindings();if(b.serviceLayer instanceof esri.layers.KMLLayer)if(b=b.serviceLayer,b.loaded)this._kmlLayerLoadHandler(b);else b.on("load",function(a){return h._kmlLayerLoadHandler(a.layer)})}__extends(b,c);b.prototype.setVisibility=function(a,b){c.prototype.setVisibility.call(this,a);this._forceSetAncestorVisibilityOperationActive=this._forceSetAncestorVisibilityOperationActive||b;this._syncChildVisibilitiesIfApplicable(a);if(void 0!==this.allAncestorsVisible&&void 0==this._deferredVisibilitySetting){if((this._forceSetAncestorVisibilityOperationActive||
this.layerList.autoActivateAncestorVisibilities&&this.currentUserClickOriginator)&&!0===a&&!this.allAncestorsVisible){this.isVisible.get()!==a&&this.isVisible.set(a);for(var d=this.parent;d&&d.id!==this.layerList.id&&d.isVisible.get();)d=d.parent;if(d&&d.id!==this.layerList.id){d.isVisible.set(!0);return}}this._forceSetAncestorVisibilityOperationActive=this.currentUserClickOriginator=!1;this.mapService.setVisibility(a&&this.allAncestorsVisible&&(this.inActiveTheme.get()||this.mapService.isUserCreated))}};
b.prototype.bindToActiveTheme=function(){var a=this;c.prototype.bindToActiveTheme.call(this);this._themeSyncHandle=dojo.subscribe("MapServiceInActiveThemeChangedEvent",function(b){b&&b===a.mapService.gcxMapService&&a.inActiveTheme.set(b.inActiveTheme)})};b.prototype.unbindFromActiveTheme=function(){c.prototype.unbindFromActiveTheme.call(this);this._themeSyncHandle&&dojo.unsubscribe(this._themeSyncHandle);this._themeSyncHandle=null};b.prototype.cleanUp=function(){c.prototype.cleanUp.call(this);this._layerVisibilityHandle&&
(this._layerVisibilityHandle.remove(),this._layerVisibilityHandle=null)};b.prototype._subscribeEvents=function(){var a=this;this._layerVisibilityHandle=this.mapService.serviceLayer.on("visibility-change",function(b){if(void 0!=a._deferredVisibilitySetting||a.isEffectivelyVisible.get()!==b.visible||a.isEffectivelyVisible.get()&&!a.inActiveTheme.get()&&!a.mapService.isUserCreated)b=b.visible&&(a.inActiveTheme.get()||a.mapService.isUserCreated),a.isVisible.set(b)})};b.prototype._setupIconUri=function(){this.mapService.serviceLayer.loadError&&
this.layerList.serviceLoadFailureIconUri?(this.iconUri.set(this.layerList.serviceLoadFailureIconUri),this.iconTooltip.set(this.layerList.serviceLoadFailureIconTooltip?this.layerList.serviceLoadFailureIconTooltip:"")):this.mapService.gcxMapService&&this.mapService.gcxMapService.iconUri&&(this.iconUri.set(this.mapService.gcxMapService.iconUri),this.iconTooltip.set(this.name.get()))};b.prototype._syncChildVisibilitiesIfApplicable=function(a){var b=this;switch(this.mapService.serviceType){case d.essentials.MapServiceType.BING:case d.essentials.MapServiceType.TILED:case d.essentials.MapServiceType.WMTS:case d.essentials.MapServiceType.IMAGE:case d.essentials.MapServiceType.WEBTILED:0<
this.children.length()&&this.getDescendants().forEach(function(c){c.type===h.layerList.LayerListItemType.LAYER&&c.mapService.id===b.mapService.id&&c.isVisible.get()!==a&&c.isVisible.set(a)})}};b.prototype._setupBindings=function(){var a=this;this.mapService.gcxMapService&&this.bindToActiveTheme();if(this.mapService.serviceLayer.loaded||this.mapService.serviceLayer.loadError)this._setupIconUri();else var b=null,c=null,d=function(){b&&dojo.disconnect(b);c&&dojo.disconnect(c);b=c=null},b=dojo.connect(this.mapService.serviceLayer,
"onLoad",function(){d();a._setupIconUri()}),c=dojo.connect(this.mapService.serviceLayer,"onError",function(){d();a._setupIconUri()});if(!this.mapService.serviceLayer.loaded&&!this.mapService.serviceLayer.loadError)var g=this.mapService.serviceLayer.on("load",function(){a._updateVisibilityAtCurrentScale();g.remove()});if(!this.mapService.serviceLayer.getMap())var h=this.layerList.appInfo.map.on("layer-add",function(b){b.layer===a.mapService.serviceLayer&&(a._updateVisibilityAtCurrentScale(),h.remove())});
this._updateVisibilityAtCurrentScale();this.mapService.serviceLayer.on("scale-visibility-change",function(){return a._updateVisibilityAtCurrentScale()})};b.prototype._kmlLayerLoadHandler=function(a){a.folders&&1<a.folders.length&&(this._createKmlFolders(this,a.folders[1],a),this.refreshOnDemandItemCollection())};b.prototype._createKmlFolders=function(a,b,c){for(var d=c.folders,g=0;g<b.subFolderIds.length;g++){for(var k=b.subFolderIds[g],m=null,q=0;q<d.length;q++)if(d[q].id===k){m=d[q];break}if(!m)throw Error("Could not find KML folder with ID '{0}'.".format(k));
k=new h.layerList.LayerListKmlFolderItem(this.mapService.id+k,this.layerList,c,m);this._createKmlFolders(k,m,c);a.children.addItem(k)}};b.prototype._updateVisibilityAtCurrentScale=function(){this.mapService.serviceLayer.loaded&&this.mapService.serviceLayer.getMap()&&this.inVisibleScaleRange.set(this.mapService.serviceLayer.visibleAtMapScale)};b.prototype._setTooltips=function(){c.prototype._setTooltips.call(this);var a=this.layerList.appInfo.gcxApp;a&&(a=a.getResource(this.layerList._libraryId,"language-mapservice-actions-tooltip").format(this.name.get()),
this.mapServiceActionsTooltip.set(a))};return b}(g.LayerListItem);g.LayerListMapServiceItem=k})(h.layerList||(h.layerList={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){(function(g){g.getServiceLayerType=function(c){return c instanceof esri.layers.DynamicMapServiceLayer?c instanceof esri.layers.ArcGISDynamicMapServiceLayer?d.essentials.MapServiceType.DYNAMIC:c instanceof esri.layers.ArcGISImageServiceLayer?d.essentials.MapServiceType.IMAGE:c instanceof esri.layers.WMSLayer?d.essentials.MapServiceType.WMS:d.essentials.MapServiceType.DYNAMIC:c instanceof esri.layers.TiledMapServiceLayer?c instanceof esri.layers.WMTSLayer?
d.essentials.MapServiceType.WMTS:c instanceof esri.layers.WebTiledLayer?d.essentials.MapServiceType.WEBTILED:c instanceof esri.virtualearth.VETiledLayer?d.essentials.MapServiceType.BING:d.essentials.MapServiceType.TILED:c instanceof esri.layers.GraphicsLayer?c instanceof esri.layers.FeatureLayer?esri.layers.StreamLayer&&c instanceof esri.layers.StreamLayer?d.essentials.MapServiceType.STREAM:c instanceof esri.layers.CSVLayer?d.essentials.MapServiceType.CSV:d.essentials.MapServiceType.FEATURE:esri.layers.LabelLayer&&
c instanceof esri.layers.LabelLayer?d.essentials.MapServiceType.LABEL:d.essentials.MapServiceType.GRAPHICS:c instanceof esri.layers.GeoRSSLayer?d.essentials.MapServiceType.GEORSS:c instanceof esri.layers.KMLLayer?d.essentials.MapServiceType.KML:c instanceof esri.layers.MapImageLayer?d.essentials.MapServiceType.MAPIMAGE:d.essentials.MapServiceType.UNKNOWN}})(g.GisUtils||(g.GisUtils={}))})(h.gis||(h.gis={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||
(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){d.defaultSymbolColor=function(d){d||(d={});return new dojo.Color({a:d.a?d.a:1,r:d.r?d.r:204,g:d.g?d.g:51,b:d.b?d.b:51})};d.defaultMarkerSymbol=function(){return new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,14,null,this.defaultSymbolColor())};d.defaultLineSymbol=function(){return new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,this.defaultSymbolColor({a:0.8}),2)};d.defaultFillSymbol=
function(){return new esri.symbol.SimpleFillSymbol(esri.symbol.SimpleFillSymbol.STYLE_SOLID,this.defaultLineSymbol(),this.defaultSymbolColor({a:0.5}))};d.defaultTextSymbol=function(){var d=new esri.symbol.TextSymbol(""),c=new esri.symbol.Font;c.setSize("14pt");c.setFamily("Arial");d.setFont(c);d.setAlign(esri.symbol.TextSymbol.ALIGN_START);return d}})(d.SymbolUtils||(d.SymbolUtils={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer=
{}))})(geocortex||(geocortex={}));
(function(d){(function(d){(function(d){(function(d){(function(d){var h=function(){function c(b,a){this._canExecuteChangedBindingTokens=[];this._contextPropertyBindingTokens={};if(!d.MenuViewModel||!a)throw Error("MenuViewModel: Could not create menu view model. Input arguments cannot be undefined.");this.menuViewModel=b;this.menuItem=a;this.app=a.app;this.text=new Observable(a.text);this.description=new Observable(a.description);this.canExecute=new Observable(this.computeCanExecute());this.iconUri=
new Observable(a.iconUri);this._setupBindings()}c.prototype.execute=function(){var b=this;this.computeCanExecute()&&(this.menuItem.command?this.menuItem.command.execute(c._computeCommandParameter(this,this.menuItem.commandParameter)):this.menuItem.batchItems.forEach(function(a){return a.command.execute(c._computeCommandParameter(b,a.commandParameter))}))};c.prototype.computeCanExecute=function(){if(this.menuItem.batchItems&&this.menuItem.batchItems.length){for(var b=!!this.menuItem.batchItems.length,
a=0;a<this.menuItem.batchItems.length;a++){var d=this.menuItem.batchItems[a];b&&d.abortBatchOnFailure&&(b=d.command&&d.command.canExecute(c._computeCommandParameter(this,d.commandParameter)))}return b}return this.menuItem.command&&this.menuItem.command.canExecute(c._computeCommandParameter(this,this.menuItem.commandParameter))};c.prototype.refreshCanExecute=function(){var b=this.computeCanExecute();this.canExecute.get()!==b&&this.canExecute.set(b)};c.prototype.destroy=function(){for(var b=this._canExecuteChangedBindingTokens.length-
1;0<=b;b--){var a=this._canExecuteChangedBindingTokens[b];a.canExecuteEvent.unsubscribe(a.token);this._canExecuteChangedBindingTokens.pop()}for(var c in this._contextPropertyBindingTokens)this._contextPropertyBindingTokens.hasOwnProperty(c)&&(b=this.menuViewModel.menuContext.get(),b[c]&&b[c].unbind(this._contextPropertyBindingTokens[c]));this._canExecuteChangedBindingTokens=this._contextPropertyBindingTokens=null};c.prototype._setupBindings=function(){var b=this,a=function(a){a&&b._canExecuteChangedBindingTokens.push({canExecuteEvent:a.canExecuteChanged,
token:a.canExecuteChanged.subscribe(b,b.refreshCanExecute)})};this.menuItem.batchItems&&this.menuItem.batchItems.length?this.menuItem.batchItems.forEach(function(b){a(b.command)}):a(this.menuItem.command)};c._computeCommandParameter=function(b,a){var c=b.menuViewModel.menuContext.get(),f=function(a){a=a.trim();if(0===a.indexOf("{{")&&0<a.indexOf("}}")){a=a.replace("{{","").replace("}}","");if(a.toLowerCase()===d.MenuViewModel.DefaultParameterName.toLowerCase())return c;if(c&&"undefined"!==typeof c[a])return c[a].isObservable&&
(b._contextPropertyBindingTokens[a]&&c[a].unbind(b._contextPropertyBindingTokens[a]),b._contextPropertyBindingTokens[a]=c[a].once(b,b.refreshCanExecute)),c[a];b.app.trace.warning("Could not find menu item '{0}'.".format(a));return null}return a};if(null===a||"undefined"===typeof a)return c;if("string"===typeof a)return f(a);if(c&&a&&"object"===typeof a){var h={},k;for(k in a)if(a.hasOwnProperty(k)){var m=a[k];h[k]="string"===typeof m?f(m):m}return h}return a};return c}();d.MenuItemViewModel=h})(d.menus||
(d.menus={}))})(d.infrastructure||(d.infrastructure={}))})(d.mapping||(d.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(d){(function(k){(function(k){(function(h){(function(g){var h=function(c){function b(){c.apply(this,arguments)}__extends(b,c);b.prototype.attach=function(a){var b=this.configuration.libraryId||a.libraryId||this.libraryId;!1===a instanceof g.MenuViewModel&&(b=new g.MenuViewModel(this.app,b),b.menuContext.set(a),a=b);(this.viewModel=a)&&!this.viewModel.menuId&&(this.viewModel.menuId=this.configuration&&this.configuration.menuId||null);this.viewModel.setupMenu();this.viewModel&&this.viewModel.menuId?
(this.title.set(this.getResource("language-menu-default-title")),c.prototype.attach.call(this,a)):this.app.trace.warning("Could not set up menu view '{0}'. View model or 'menuId' option not found.".format(this.id))};b.prototype.handleMenuItemClick=function(a,b,c){c&&(this.app.event("MenuItemInvokedEvent").publish({menuView:this,menuId:this.viewModel.menuId,menuItem:c}),c.execute())};b.prototype.getDescription=function(a,b,c){c.description&&(b.title=c.description.get())};b.prototype.onDestroy=function(){c.prototype.onDestroy.call(this);
this.app.menuRegistry.destroyMenuWidget(this)};return b}(d.framework.ui.ViewBase);g.MenuView=h})(h.menus||(h.menus={}))})(k.infrastructure||(k.infrastructure={}))})(k.mapping||(k.mapping={}))})(d.essentialsHtmlViewer||(d.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));var Feature=null,FeatureSet=null,FeatureSetCollection=null;
dojo.ready(function(){FeatureAttribute=dojo.getObject("geocortex.essentialsHtmlViewer.mapping.infrastructure.FeatureAttribute");Feature=dojo.getObject("geocortex.essentialsHtmlViewer.mapping.infrastructure.Feature");FeatureSet=dojo.getObject("geocortex.essentialsHtmlViewer.mapping.infrastructure.FeatureSet");FeatureSetCollection=dojo.getObject("geocortex.essentialsHtmlViewer.mapping.infrastructure.FeatureSetCollection")});geocortex||(geocortex={});
geocortex.essentialsHtmlViewer||(geocortex.essentialsHtmlViewer={});geocortex.essentialsHtmlViewer.version="2.7.2.0026";geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/documents/GrantEditorView.html","html","PGRpdiBjbGFzcz0iZ3JhbnQtZWRpdG9yIj4gPGRpdiBjbGFzcz0iZ3JhbnQtZWRpdG9yLW9wdGlvbnMiPiA8ZGl2IGNsYXNzPSJncmFudC1lZGl0b3Itc2VhcmNoLW9wdGlvbnMiPiA8c2VsZWN0IGRhdGEtYmluZGluZz0ie0BlbmFibGVkOiBlbmFibGVkfXtAc291cmNlOiBtb25pa2VyS2luZHN9e0B2YWx1ZTogc2VsZWN0ZWRNb25pa2VyS2luZH0iPiA8b3B0aW9uIGRhdGEtYmluZGluZz0ie0B0ZW1wbGF0ZS1mb3I6IG1vbmlrZXJLaW5kc317QHRleHQ6IGRpc3BsYXlOYW1lfXt2YWx1ZToga2luZH0iIC8+IDwvc2VsZWN0PiA8aW5wdXQgY2xhc3M9ImdyYW50LWVkaXRvci1zZWFyY2giIHR5cGU9InRleHQiIGRhdGEtYmluZGluZz0ie0BlbmFibGVkOiBlbmFibGVkfXtAdmFsdWU6IHNlYXJjaFRleHR9e0B2YXI6IGF1dG9Db21wbGV0ZUlucHV0fXtAZXZlbnQtb25pbnB1dDogaGFuZGxlSW5wdXRDaGFuZ2VkfXtwbGFjZWhvbGRlcjogQGxhbmd1YWdlLWdyYW50LWVkaXRvci1zZWFyY2gtcGxhY2Vob2xkZXJ9e3RpdGxlOiBAbGFuZ3VhZ2UtZ3JhbnQtZWRpdG9yLXNlYXJjaC10aXRsZX17QGV2ZW50LWJsdXI6IGhhbmRsZUF1dG9Db21wbGV0ZUJsdXJ9IiAvPiA8L2Rpdj4gPGRpdiBjbGFzcz0iZm9ybS1idG5zIj4gPGJ1dHRvbiBjbGFzcz0iYnV0dG9uIGFkZC1idXR0b24iIGRhdGEtYmluZGluZz0ie0BlbmFibGVkOiBpc1ZhbGlkTW9uaWtlcn17dGl0bGU6IEBsYW5ndWFnZS1ncmFudC1lZGl0b3ItYWRkLWJ1dHRvbi10aXRsZX17QHRleHQ6IEBsYW5ndWFnZS1ncmFudC1lZGl0b3ItYWRkLWJ1dHRvbi10ZXh0fXtAZXZlbnQtb25jbGljazogaGFuZGxlQWRkTW9uaWtlckJ1dHRvbkNsaWNrfSI+PC9idXR0b24+IDwvZGl2PiA8L2Rpdj4gPGRpdiBjbGFzcz0iZ3JhbnQtZWRpdG9yLXRhYmxlIj4gPHRhYmxlPiA8dGhlYWQ+IDx0cj4gPHRoPjwvdGg+IDx0aCBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLWdyYW50LWVkaXRvci10YWJsZS1oZWFkZXItbm9uZX0iPjwvdGg+IDx0aCBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLWdyYW50LWVkaXRvci10YWJsZS1oZWFkZXItdmlld30iPjwvdGg+IDx0aCBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLWdyYW50LWVkaXRvci10YWJsZS1oZWFkZXItZWRpdH0iPjwvdGg+IDwvdHI+IDwvdGhlYWQ+IDx0Ym9keSBkYXRhLWJpbmRpbmc9IntAc291cmNlOiBtb25pa2Vyc30iPiA8dHIgZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLWZvcjogbW9uaWtlcnN9e0BjbGFzcy1nbG9iYWwtZ3JhbnQ6IGlzR2xvYmFsfXtAY2xhc3MtZGlzYWJsZWQtZ3JhbnQ6IGlzUmV2b2tlZH0iPiA8dGQgY2xhc3M9ImdyYW50LW5hbWUtY29sdW1uIj4gPGltZyBkYXRhLWJpbmRpbmc9IntzcmM6IGljb25Vcml9IiAvPiA8c3BhbiBjbGFzcz0iZ3JhbnQtbmFtZS1sYWJlbCIgZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IG5hbWV9Ij48L3NwYW4+IDwvdGQ+IDx0ZD4gPGlucHV0IHR5cGU9InJhZGlvIiBkYXRhLWJpbmRpbmc9IntAZW5hYmxlZDogZW5hYmxlZH17bmFtZTogaWR9e2NoZWNrZWQ6IGlzR2xvYmFsfXtAZXZlbnQtb25jbGljazogaGFuZGxlVXBkYXRlTW9uaWtlcn0iIC8+IDwvdGQ+IDx0ZD4gPGlucHV0IHR5cGU9InJhZGlvIiB2YWx1ZT0icmVhZGVyIiBkYXRhLWJpbmRpbmc9IntAZW5hYmxlZDogZW5hYmxlZH17bmFtZTogaWR9e2NoZWNrZWQ6IGNhblJlYWR9e0BldmVudC1vbmNsaWNrOiBoYW5kbGVVcGRhdGVNb25pa2VyfSIgLz4gPC90ZD4gPHRkPiA8aW5wdXQgdHlwZT0icmFkaW8iIHZhbHVlPSJ3cml0ZXIiIGRhdGEtYmluZGluZz0ie0BlbmFibGVkOiBlbmFibGVkfXtAaGlkZGVuOiBpc1B1YmxpY317bmFtZTogaWR9e2NoZWNrZWQ6IGNhbldyaXRlfXtAZXZlbnQtb25jbGljazogaGFuZGxlVXBkYXRlTW9uaWtlcn0iIC8+IDwvdGQ+IDwvdHI+IDwvdGJvZHk+IDwvdGFibGU+IDwvZGl2PiA8L2Rpdj4g");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/menus/IconMenuView.html","html","PGRpdiBjbGFzcz0ibWVudS1uby1pdGVtcyIgZGF0YS1iaW5kaW5nPSJ7QGhpZGRlbjogdmlzaWJsZU1lbnVJdGVtc317QHRleHQ6IEBsYW5ndWFnZS1tZW51LW5vLWl0ZW1zfSI+PC9kaXY+IDxkaXYgY2xhc3M9Imxpc3QtbWVudSBhY3RpdmUgaGFzLWljb24gaWNvbi1tZW51IiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogdmlzaWJsZU1lbnVJdGVtc317QHNvdXJjZTogdmlzaWJsZU1lbnVJdGVtc30iPiA8ZGl2IGNsYXNzPSJsaXN0LW1lbnUtaXRlbSIgZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLWZvcjogdmlzaWJsZU1lbnVJdGVtc317QGVuYWJsZWQ6IGNhbkV4ZWN1dGV9e0BldmVudC1vbmNsaWNrOiBoYW5kbGVNZW51SXRlbUNsaWNrfSI+IDxidXR0b24gY2xhc3M9Imxpc3QtbWVudS1kZXRhaWxzIiBkYXRhLWJpbmRpbmc9IntAZXZlbnQtb25jbGljazogaGFuZGxlTWVudUl0ZW1DbGlja317dGl0bGU6IGRlc2NyaXB0aW9ufSI+IDxpbWcgY2xhc3M9Imxpc3QtbWVudS1pY29uIiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogaWNvblVyaX17c3JjOiBpY29uVXJpfSIgYWx0PSIgIiAvPiA8c3Ryb25nIGNsYXNzPSJsaXN0LW1lbnUtbmFtZSIgZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IHRleHR9Ij48L3N0cm9uZz4gPC9idXR0b24+IDwvZGl2PiA8L2Rpdj4g");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/menus/MenuHyperlinkView.html","html","PGRpdiBjbGFzcz0ibWVudS1oeXBlcmxpbmtzIj4gPHVsIGNsYXNzPSJsaXN0LW1lbnUgYWN0aXZlIiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogdmlzaWJsZU1lbnVJdGVtc317QHNvdXJjZTogdmlzaWJsZU1lbnVJdGVtc30iPiA8bGkgY2xhc3M9Imxpc3QtbWVudS1pdGVtIiBkYXRhLWJpbmRpbmc9IntAdGVtcGxhdGUtZm9yOiB2aXNpYmxlTWVudUl0ZW1zfSI+IDxidXR0b24gY2xhc3M9Imxpc3QtbWVudS1idXR0b24iIGRhdGEtYmluZGluZz0ie3RpdGxlOiBkZXNjcmlwdGlvbn17QHRleHQ6IHRleHR9e0BldmVudC1vbmNsaWNrOiBoYW5kbGVNZW51SXRlbUNsaWNrfXtAZW5hYmxlZDogY2FuRXhlY3V0ZX0iPjwvYnV0dG9uPiA8L2xpPiA8L3VsPiA8L2Rpdj4g");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/menus/MenuView.html","html","PGRpdiBjbGFzcz0ibWVudS1uby1pdGVtcyIgZGF0YS1iaW5kaW5nPSJ7QGhpZGRlbjogdmlzaWJsZU1lbnVJdGVtc317QHRleHQ6IEBsYW5ndWFnZS1tZW51LW5vLWl0ZW1zfSI+PC9kaXY+IDxkaXYgY2xhc3M9Imxpc3QtbWVudSBhY3RpdmUgaGFzLWljb24iIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiB2aXNpYmxlTWVudUl0ZW1zfXtAc291cmNlOiB2aXNpYmxlTWVudUl0ZW1zfSI+IDxkaXYgY2xhc3M9Imxpc3QtbWVudS1pdGVtIiBkYXRhLWJpbmRpbmc9IntAdGVtcGxhdGUtZm9yOiB2aXNpYmxlTWVudUl0ZW1zfXtAZW5hYmxlZDogY2FuRXhlY3V0ZX17QGV2ZW50LW9uY2xpY2s6IGhhbmRsZU1lbnVJdGVtQ2xpY2t9Ij4gPGltZyBjbGFzcz0ibGlzdC1tZW51LWljb24iIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBpY29uVXJpfXtzcmM6IGljb25Vcml9e2FsdDogdGV4dH0iIC8+IDxidXR0b24gY2xhc3M9Imxpc3QtbWVudS1kZXRhaWxzIiBkYXRhLWJpbmRpbmc9IntAZXZlbnQtb25jbGljazogaGFuZGxlTWVudUl0ZW1DbGlja317dGl0bGU6IGRlc2NyaXB0aW9ufSI+IDxzdHJvbmcgY2xhc3M9Imxpc3QtbWVudS1uYW1lIiBkYXRhLWJpbmRpbmc9IntAdGV4dDogdGV4dH0iPjwvc3Ryb25nPiA8c3BhbiBjbGFzcz0ibGlzdC1tZW51LWRlc2MiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBkZXNjcmlwdGlvbn17QHRleHQ6IGRlc2NyaXB0aW9ufSI+PC9zcGFuPiA8L2J1dHRvbj4gPC9kaXY+IDwvZGl2PiA=");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/results/ResultsFeatureActionsView.html","html","PGRpdiBjbGFzcz0ibGlzdC1tZW51IiBkYXRhLWJpbmRpbmc9IntAc291cmNlOiBmZWF0dXJlQWN0aW9uc30iPiA8ZGl2IGNsYXNzPSJsaXN0LW1lbnUtaXRlbSIgZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLWZvcjogZmVhdHVyZUFjdGlvbnN9e0BldmVudC1vbm1vdXNlb3ZlcjogaGFuZGxlR2V0RGVzY3JpcHRpb259e0BldmVudC1vbmNsaWNrOiBoYW5kbGVNZW51SXRlbUNsaWNrfSI+IDxidXR0b24gY2xhc3M9Imxpc3QtbWVudS1kZXRhaWxzIj4gPHN0cm9uZyBjbGFzcz0ibGlzdC1tZW51LW5hbWUiIGRhdGEtYmluZGluZz0ie0B0ZXh0OiB0ZXh0fSI+PC9zdHJvbmc+IDxzcGFuIGNsYXNzPSJsaXN0LW1lbnUtZGVzYyIgZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IGRlc2NyaXB0aW9ufSI+PC9zcGFuPiA8L2J1dHRvbj4gPC9kaXY+IDwvZGl2PiA=");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/results/ResultsListView.html","html","PGRpdiBjbGFzcz0icmVzdWx0cy1saXN0LWFjdGlvbnMtd2lkZ2V0IiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogZmVhdHVyZVNldENvbGxlY3Rpb259e0B3aWRnZXQ6IFJlc3VsdHNMaXN0QWN0aW9uc1dpZGdldH17QHdpZGdldC1jb250ZXh0OiBmZWF0dXJlU2V0Q29sbGVjdGlvbn17QHdpZGdldC1yZXF1aXJlZDogZmFsc2V9IiBkYXRhLW1lbnUtaWQ9IlJlc3VsdHNMaXN0QWN0aW9ucyIgZGF0YS1tZW51LXRlbXBsYXRlPSJNYXBwaW5nL2luZnJhc3RydWN0dXJlL21lbnVzL01lbnVIeXBlcmxpbmtWaWV3Lmh0bWwiPjwvZGl2PiA8ZGl2IGNsYXNzPSJyZXN1bHRzIj4gIDxkaXYgY2xhc3M9Im5vLXJlc3VsdHMiIGRhdGEtYmluZGluZz0ie0BoaWRkZW46IGhhc0ZlYXR1cmVTZXRzfXtAdGV4dDogc2VhcmNoU3VnZ2VzdGlvbn0iIHRhYmluZGV4PSIwIj48L2Rpdj4gICAgPGRpdiBjbGFzcz0icmVzdWx0cy1saXN0IiBkYXRhLWJpbmRpbmc9IntAdmFyOiBzY3JvbGxDb250YWluZXJFbGVtZW50fXtAZXZlbnQtb25zY3JvbGw6IGhhbmRsZVNjcm9sbENoYW5nZX0iIHRhYmluZGV4PSItMSI+IDxkaXYgY2xhc3M9Imxpc3QtbWVudSBhY3RpdmUgaGFzLWljb24iIGRhdGEtYmluZGluZz0ie0Bzb3VyY2U6IHJlc3VsdHNQYWdlfXtAdmlzaWJsZTogcmVzdWx0c1BhZ2V9e0B2YXI6IHJlc3VsdHNMaXN0fSI+IDxkaXYgY2xhc3M9Imxpc3QtbWVudS1pdGVtIiBkYXRhLWJpbmRpbmc9IntAdGVtcGxhdGUtZm9yOiByZXN1bHRzUGFnZX17QGV2ZW50LW1vdXNlZG93bjogaGFuZGxlTW91c2VEb3dufXtAZXZlbnQtY2xpY2s6IGhhbmRsZUNsaWNrfXtAZXZlbnQtbW91c2VvdXQ6IGhhbmRsZU1vdXNlT3V0fXtAZXZlbnQtbW91c2V1cDogaGFuZGxlTW91c2VVcH17QGV2ZW50LXRvdWNoc3RhcnQ6IGhhbmRsZVRvdWNoU3RhcnR9e0BldmVudC10b3VjaG1vdmU6IGhhbmRsZVRvdWNoTW92ZX17QGV2ZW50LXRvdWNoY2FuY2VsOiBoYW5kbGVUb3VjaENhbmNlbH17QGV2ZW50LXRvdWNoZW5kOiBoYW5kbGVUb3VjaEVuZH0iIHRhYmluZGV4PSIwIj4gPGltZyBjbGFzcz0ibGlzdC1tZW51LWljb24iIGRhdGEtYmluZGluZz0ie3NyYzogaWNvblVyaX17YWx0OiBsYWJlbH17QHZpc2libGU6IGljb25Vcml9IiBhbHQ9IiAiIGFyaWEtaGlkZGVuPSJ0cnVlIiAvPiA8aW1nIGNsYXNzPSJsaXN0LW1lbnUtaWNvbiIgZGF0YS1iaW5kaW5nPSJ7YWx0OiBsYWJlbH17QGhpZGRlbjogaWNvblVyaX0iIHNyYz0iUmVzb3VyY2VzL0ltYWdlcy9JY29ucy9tYXAtZGVmYXVsdC0yNC5wbmciIGFsdD0iICIgYXJpYS1oaWRkZW49InRydWUiIC8+IDxzcGFuIGNsYXNzPSJsaXN0LW1lbnUtZGV0YWlscyI+IDxidXR0b24gY2xhc3M9Imxpc3QtbWVudS1uYW1lIiBkYXRhLWJpbmRpbmc9IntAd2lkZ2V0OiBHZXRMYWJlbH17QHdpZGdldC1jb250ZXh0OiBAY29udGV4dH17QHZpc2libGU6IGxhYmVsfXtAZXZlbnQtbW91c2Vkb3duOiBoYW5kbGVNb3VzZURvd259e0BldmVudC1jbGljazogaGFuZGxlQ2xpY2t9e0BldmVudC1tb3VzZW91dDogaGFuZGxlTW91c2VPdXR9e0BldmVudC1tb3VzZXVwOiBoYW5kbGVNb3VzZVVwfXtAZXZlbnQtdG91Y2hzdGFydDogaGFuZGxlVG91Y2hTdGFydH17QGV2ZW50LXRvdWNobW92ZTogaGFuZGxlVG91Y2hNb3ZlfXtAZXZlbnQtdG91Y2hjYW5jZWw6IGhhbmRsZVRvdWNoQ2FuY2VsfXtAZXZlbnQtdG91Y2hlbmQ6IGhhbmRsZVRvdWNoRW5kfSI+PC9idXR0b24+IDxzcGFuIGNsYXNzPSJsaXN0LW1lbnUtZGVzYyIgZGF0YS1iaW5kaW5nPSJ7QHdpZGdldDogR2V0RGVzY3JpcHRpb259e0B3aWRnZXQtY29udGV4dDogQGNvbnRleHR9Ij48L3NwYW4+IDwvc3Bhbj4gPC9kaXY+IDwvZGl2PiA8L2Rpdj4gICA8ZGl2IGNsYXNzPSJwYWdpbmctY29udHJvbCIgZGF0YS1iaW5kaW5nPSJ7QHNvdXJjZTogcHJlc2VudGFibGVSZXN1bHRzfXtjbGFzc05hbWU6IHBhZ2luZ0NvbnRyb2xDbGFzc05hbWV9Ij4gPGRpdiBjbGFzcz0icGFnaW5nLWNvbnRyb2wtaW5uZXIiIGRhdGEtYmluZGluZz0ie0B0ZW1wbGF0ZS1mb3I6IHByZXNlbnRhYmxlUmVzdWx0c30iPiA8ZGl2IGNsYXNzPSJwYWdpbmctcmVzdWx0LWluZm8iPiA8c3BhbiBjbGFzcz0icGFnaW5nLXJlc3VsdHMtdG90YWwiIGRhdGEtYmluZGluZz0ie0BoaWRkZW46IG51bWJlck9mSXRlbXN9e0B0ZXh0OiBAbGFuZ3VhZ2UtY29tbW9uLW5vLXJlc3VsdHN9Ij48L3NwYW4+IDxzcGFuIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBudW1iZXJPZkl0ZW1zfSI+IDxzcGFuIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBAbGFuZ3VhZ2UtcmVzdWx0cy1kaXNwbGF5aW5nfSI+PC9zcGFuPiZuYnNwOzxzcGFuIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBjdXJySW5kZXhTdGFydEZyb21PbmV9Ij48L3NwYW4+Jm5ic3A7LSZuYnNwOzxzcGFuIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBjdXJySW5kZXhFbmR9Ij48L3NwYW4+Jm5ic3A7KDxzcGFuIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBAbGFuZ3VhZ2UtcmVzdWx0cy10b3RhbH0iPjwvc3Bhbj46Jm5ic3A7PHNwYW4gZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IG51bWJlck9mSXRlbXN9Ij48L3NwYW4+KSA8L3NwYW4+IDwvZGl2PiA8ZGl2IGNsYXNzPSJwYWdpbmctYnV0dG9ucyIgZGF0YS1iaW5kaW5nPSJ7QHZpc2libGU6IG51bWJlck9mSXRlbXN9Ij4gPGJ1dHRvbiBjbGFzcz0iZmlyc3QiIGRhdGEtYmluZGluZz0ie0BldmVudC1vbmNsaWNrOiBoYW5kbGVQYWdlRmlyc3R9e3RpdGxlOiBAbGFuZ3VhZ2UtcGFnZS1maXJzdH0iPjxpbWcgc3JjPSJSZXNvdXJjZXMvSW1hZ2VzL0ljb25zL3BhZ2luZy1jb250cm9sLWZpcnN0LTQ0LnBuZyIgYWx0PSIgIi8+PC9idXR0b24+IDxidXR0b24gY2xhc3M9InByZXYiIGRhdGEtYmluZGluZz0ie0BldmVudC1vbmNsaWNrOiBoYW5kbGVQYWdlUHJldn17dGl0bGU6IEBsYW5ndWFnZS1wYWdlLXByZXZ9Ij48aW1nIHNyYz0iUmVzb3VyY2VzL0ltYWdlcy9JY29ucy9wYWdpbmctY29udHJvbC1wcmV2aW91cy00NC5wbmciIGFsdD0iICIvPjwvYnV0dG9uPiA8c3BhbiBjbGFzcz0icGFnaW5nLWJ1dHRvbnMtaW5mbyIgdGFiaW5kZXg9IjAiPiA8c3BhbiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXJlc3VsdHMtcGFnZX0iPjwvc3Bhbj4mbmJzcDs8c3BhbiBkYXRhLWJpbmRpbmc9IntAdGV4dDogY3VyclBhZ2VOdW1iZXJ9Ij48L3NwYW4+Jm5ic3A7PHNwYW4gZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IEBsYW5ndWFnZS1yZXN1bHRzLXBhZ2Utb2Z9Ij48L3NwYW4+Jm5ic3A7PHNwYW4gZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IGxhc3RQYWdlTnVtYmVyfSI+PC9zcGFuPiA8L3NwYW4+IDxidXR0b24gY2xhc3M9Im5leHQiIGRhdGEtYmluZGluZz0ie0BldmVudC1vbmNsaWNrOiBoYW5kbGVQYWdlTmV4dH17dGl0bGU6IEBsYW5ndWFnZS1wYWdlLW5leHR9Ij48aW1nIHNyYz0iUmVzb3VyY2VzL0ltYWdlcy9JY29ucy9wYWdpbmctY29udHJvbC1uZXh0LTQ0LnBuZyIgYWx0PSIgIiAvPjwvYnV0dG9uPiA8YnV0dG9uIGNsYXNzPSJsYXN0IiBkYXRhLWJpbmRpbmc9IntAZXZlbnQtb25jbGljazogaGFuZGxlUGFnZUxhc3R9e3RpdGxlOiBAbGFuZ3VhZ2UtcGFnZS1sYXN0fSI+PGltZyBzcmM9IlJlc291cmNlcy9JbWFnZXMvSWNvbnMvcGFnaW5nLWNvbnRyb2wtbGFzdC00NC5wbmciIGFsdD0iICIgLz48L2J1dHRvbj4gPC9kaXY+IDwvZGl2PiA8L2Rpdj4gIDwvZGl2PiA=");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/results/ResultsTableView.html","html","PGRpdiBjbGFzcz0icmVzdWx0cy10YWJsZS1hY3Rpb25zLXdpZGdldCIgZGF0YS1iaW5kaW5nPSJ7QHZpc2libGU6IGZlYXR1cmVTZXRDb2xsZWN0aW9ufXtAd2lkZ2V0OiBSZXN1bHRzVGFibGVBY3Rpb25zV2lkZ2V0fXtAd2lkZ2V0LWNvbnRleHQ6IGZlYXR1cmVTZXRDb2xsZWN0aW9ufXtAd2lkZ2V0LXJlcXVpcmVkOiBmYWxzZX0iDQogICAgIGRhdGEtbWVudS1pZD0iUmVzdWx0c1RhYmxlQWN0aW9ucyIgZGF0YS1tZW51LXRlbXBsYXRlPSJNYXBwaW5nL2luZnJhc3RydWN0dXJlL21lbnVzL01lbnVIeXBlcmxpbmtWaWV3Lmh0bWwiPjwvZGl2PiA8ZGl2IGNsYXNzPSJyZXN1bHRzIj4gIDxkaXYgY2xhc3M9Im5vLXJlc3VsdHMiIGRhdGEtYmluZGluZz0ie0BoaWRkZW46IGhhc0ZlYXR1cmVTZXRzfXtAdGV4dDogc2VhcmNoU3VnZ2VzdGlvbn0iPjwvZGl2PiAgIDxkaXYgY2xhc3M9InRhYi1jb250YWluZXIiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBoYXNGZWF0dXJlU2V0c317QHZhcjogc2Nyb2xsaW5nVGFiQ29udGFpbmVyRWxlbWVudH0iPiA8dGFibGU+IDx0cj4gPHRkIGNsYXNzPSJ0YWItbGVmdC1zY3JvbGwiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiB0YWJDb250cm9sc0VuYWJsZWR9e0BjbGFzcy1kaXNhYmxlZDogbGVmdFNjcm9sbFRhYkRpc2FibGVkfXtAdmFyOiBzY3JvbGxUYWJMZWZ0RWxlbWVudH0iPiA8YnV0dG9uIGRhdGEtYmluZGluZz0ie0BldmVudC1vbmNsaWNrOiBoYW5kbGVUYWJTY3JvbGxCYWNrfXt0aXRsZTogQGxhbmd1YWdlLXRhYi1zY3JvbGwtcHJldn0iPiA8aW1nIHNyYz0iUmVzb3VyY2VzL0ltYWdlcy9JY29ucy9jaGV2cm9uLWxlZnQtMTYucG5nIiBhbHQ9IiI+IDwvYnV0dG9uPiA8L3RkPiA8dGQgZGF0YS1iaW5kaW5nPSJ7QHNvdXJjZTogZmVhdHVyZVNldENvbGxlY3Rpb259Ij4gPGRpdiBjbGFzcz0idGFiLWNvbnRhaW5lciIgZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLWZvcjogZmVhdHVyZVNldENvbGxlY3Rpb259e0B2YXI6IHRhYkNvbnRhaW5lckVsZW1lbnR9Ij4gPHVsIGNsYXNzPSJ0YWItY29udHJvbCIgZGF0YS1iaW5kaW5nPSJ7QHNvdXJjZTogZmVhdHVyZVNldHN9e0B2YXI6IHRhYkVsZW1lbnRzfSI+IDxsaSBkYXRhLWJpbmRpbmc9IntAdGVtcGxhdGUtZm9yOiBmZWF0dXJlU2V0c30iPiA8YnV0dG9uIGNsYXNzPSJ0YWIiIGRhdGEtYmluZGluZz0ie0BjbGFzcy10YWItYWN0aXZlOiBpc1NlbGVjdGVkSW5Db2xsZWN0aW9ufXtAbm9jbGFzcy10YWI6IGlzU2VsZWN0ZWRJbkNvbGxlY3Rpb259e0BldmVudC1vbmNsaWNrOiBoYW5kbGVUYWJDbGlja30iPiA8c3Ryb25nIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBkaXNwbGF5TmFtZX17dGl0bGU6IGRpc3BsYXlOYW1lfSI+PC9zdHJvbmc+IDwvYnV0dG9uPiA8L2xpPiA8L3VsPiA8L2Rpdj4gPC90ZD4gPHRkIGNsYXNzPSJ0YWItcmlnaHQtc2Nyb2xsIiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogdGFiQ29udHJvbHNFbmFibGVkfXtAY2xhc3MtZGlzYWJsZWQ6IHJpZ2h0U2Nyb2xsVGFiRGlzYWJsZWR9e0B2YXI6IHNjcm9sbFRhYlJpZ2h0RWxlbWVudH0iPiA8YnV0dG9uIGRhdGEtYmluZGluZz0ie0BldmVudC1vbmNsaWNrOiBoYW5kbGVUYWJTY3JvbGxGb3J3YXJkfXt0aXRsZTogQGxhbmd1YWdlLXRhYi1zY3JvbGwtbmV4dH0iPiA8aW1nIHNyYz0iUmVzb3VyY2VzL0ltYWdlcy9JY29ucy9jaGV2cm9uLXJpZ2h0LTE2LnBuZyI+IDwvYnV0dG9uPiA8L3RkPiA8L3RyPiA8L3RhYmxlPiA8L2Rpdj4gICA8ZGl2IGNsYXNzPSJ3aWRnZXQiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBoYXNGZWF0dXJlU2V0c317QHdpZGdldDogVGFibGVWaWV3V2lkZ2V0fXtAd2lkZ2V0LWNvbnRleHQ6IEBjb250ZXh0fXtAd2lkZ2V0LXJlcXVpcmVkOiBmYWxzZX0iPjwvZGl2PiAgIDxkaXYgY2xhc3M9InBhZ2luZy1jb250cm9sIiBkYXRhLWJpbmRpbmc9IntAc291cmNlOiBwcmVzZW50YWJsZVJlc3VsdHN9Ij4gPGRpdiBjbGFzcz0icGFnaW5nLWNvbnRyb2wtaW5uZXIiIGRhdGEtYmluZGluZz0ie0B0ZW1wbGF0ZS1mb3I6IHByZXNlbnRhYmxlUmVzdWx0c30iPiA8ZGl2IGNsYXNzPSJwYWdpbmctcmVzdWx0LWluZm8iPiA8c3BhbiBkYXRhLWJpbmRpbmc9IntAaGlkZGVuOiBudW1iZXJPZkl0ZW1zfXtAdGV4dDogQGxhbmd1YWdlLWNvbW1vbi1uby1yZXN1bHRzfSI+PC9zcGFuPiA8c3BhbiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogbnVtYmVyT2ZJdGVtc30iPiA8c3BhbiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXJlc3VsdHMtZGlzcGxheWluZ30iPjwvc3Bhbj4mbmJzcDs8c3BhbiBkYXRhLWJpbmRpbmc9IntAdGV4dDogY3VyckluZGV4U3RhcnRGcm9tT25lfSI+PC9zcGFuPiZuYnNwOy0mbmJzcDs8c3BhbiBkYXRhLWJpbmRpbmc9IntAdGV4dDogY3VyckluZGV4RW5kfSI+PC9zcGFuPiZuYnNwOyg8c3BhbiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXJlc3VsdHMtdG90YWx9Ij48L3NwYW4+OiZuYnNwOzxzcGFuIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBudW1iZXJPZkl0ZW1zfSI+PC9zcGFuPikgPC9zcGFuPiA8L2Rpdj4gPGRpdiBjbGFzcz0icGFnaW5nLWJ1dHRvbnMiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBudW1iZXJPZkl0ZW1zfSI+IDxidXR0b24gY2xhc3M9ImZpcnN0IiBkYXRhLWJpbmRpbmc9IntAZXZlbnQtb25jbGljazogaGFuZGxlUGFnZUZpcnN0fXt0aXRsZTogQGxhbmd1YWdlLXJlc3VsdHMtcGFnZS1maXJzdH0iPjxpbWcgc3JjPSJSZXNvdXJjZXMvSW1hZ2VzL0ljb25zL3BhZ2luZy1jb250cm9sLWZpcnN0LTQ0LnBuZyIgYWx0PSIgIi8+PC9idXR0b24+IDxidXR0b24gY2xhc3M9InByZXYiIGRhdGEtYmluZGluZz0ie0BldmVudC1vbmNsaWNrOiBoYW5kbGVQYWdlUHJldn17dGl0bGU6IEBsYW5ndWFnZS1yZXN1bHRzLXBhZ2UtcHJldn0iPjxpbWcgc3JjPSJSZXNvdXJjZXMvSW1hZ2VzL0ljb25zL3BhZ2luZy1jb250cm9sLXByZXZpb3VzLTQ0LnBuZyIgYWx0PSIgIi8+PC9idXR0b24+IDxzcGFuIGNsYXNzPSJwYWdpbmctYnV0dG9ucy1pbmZvIiB0YWJpbmRleD0iMCI+IDxzcGFuIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBAbGFuZ3VhZ2UtcmVzdWx0cy1wYWdlfSI+PC9zcGFuPiZuYnNwOzxzcGFuIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBjdXJyUGFnZU51bWJlcn0iPjwvc3Bhbj4mbmJzcDs8c3BhbiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXJlc3VsdHMtcGFnZS1vZn0iPjwvc3Bhbj4mbmJzcDs8c3BhbiBkYXRhLWJpbmRpbmc9IntAdGV4dDogbGFzdFBhZ2VOdW1iZXJ9Ij48L3NwYW4+IDwvc3Bhbj4gPGJ1dHRvbiBjbGFzcz0ibmV4dCIgZGF0YS1iaW5kaW5nPSJ7QGV2ZW50LW9uY2xpY2s6IGhhbmRsZVBhZ2VOZXh0fXt0aXRsZTogQGxhbmd1YWdlLXJlc3VsdHMtcGFnZS1uZXh0fSI+PGltZyBzcmM9IlJlc291cmNlcy9JbWFnZXMvSWNvbnMvcGFnaW5nLWNvbnRyb2wtbmV4dC00NC5wbmciIGFsdD0iICIvPjwvYnV0dG9uPiA8YnV0dG9uIGNsYXNzPSJsYXN0IiBkYXRhLWJpbmRpbmc9IntAZXZlbnQtb25jbGljazogaGFuZGxlUGFnZUxhc3R9e3RpdGxlOiBAbGFuZ3VhZ2UtcmVzdWx0cy1wYWdlLWxhc3R9Ij48aW1nIHNyYz0iUmVzb3VyY2VzL0ltYWdlcy9JY29ucy9wYWdpbmctY29udHJvbC1sYXN0LTQ0LnBuZyIgYWx0PSIgIi8+PC9idXR0b24+IDwvZGl2PiA8L2Rpdj4gPC9kaXY+ICA8L2Rpdj4g");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/ui/components/ColorPicker/ColorPickerView.html","html","IDxkaXYgY2xhc3M9ImZvcm0tY29udHJvbCIgZGF0YS1iaW5kaW5nPSJ7QGV2ZW50LW9uY2hhbmdlOiBoYW5kbGVDaGFuZ2V9e0BldmVudC1vbmlucHV0OiBoYW5kbGVDaGFuZ2V9Ij4gPGlucHV0IHR5cGU9ImNvbG9yIiBkYXRhLWJpbmRpbmc9IntAdmFyOiBjb2xvcklucHV0fXtAaGlkZGVuOiB1c2VDb2xvclN3YXRjaGVzfSIgLz4gPGRpdiBjbGFzcz0iaW5saW5lIGNvbG9yLXN3YXRjaGVzIiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogdXNlQ29sb3JTd2F0Y2hlc30iPiA8ZmllbGRzZXQgY2xhc3M9InJhZGlvLWNvbnRhaW5lciBpbmxpbmUiIGRhdGEtYmluZGluZz0ie0B2YXI6IGNvbG9yU3dhdGNoRmllbGRTZXR9e0Bzb3VyY2U6IGNvbG9yU3dhdGNoZXN9Ij4gPGxhYmVsIGNsYXNzPSJjb2xvci1zd2F0Y2giIGRhdGEtYmluZGluZz0ie0B0ZW1wbGF0ZS1mb3I6IGNvbG9yU3dhdGNoZXN9Ij4gPGlucHV0IHR5cGU9InJhZGlvIiBkYXRhLWJpbmRpbmc9IntuYW1lOiBzZXROYW1lfSIgLz4gPC9sYWJlbD4gPC9maWVsZHNldD4gPC9kaXY+IDwvZGl2PiA=");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/ui/components/PagingControls/PagingControlsView.html","html","PGRpdiBjbGFzcz0icGFnaW5nLWNvbnRyb2wiIGRhdGEtYmluZGluZz0ie0Bzb3VyY2U6IHByZXNlbnRhYmxlUmVzdWx0c30iPiA8ZGl2IGNsYXNzPSJwYWdpbmctY29udHJvbC1pbm5lciIgZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLWZvcjogcHJlc2VudGFibGVSZXN1bHRzfSI+IDxkaXYgY2xhc3M9InBhZ2luZy1yZXN1bHQtaW5mbyI+IDxzcGFuIGRhdGEtYmluZGluZz0ie0BoaWRkZW46IG51bWJlck9mSXRlbXN9e0B0ZXh0OiBAbGFuZ3VhZ2UtY29tbW9uLW5vLXJlc3VsdHN9Ij48L3NwYW4+IDxzcGFuIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBudW1iZXJPZkl0ZW1zfSI+IDxzcGFuIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBAbGFuZ3VhZ2UtcGFnZS1kaXNwbGF5aW5nfSI+PC9zcGFuPiZuYnNwOzxzcGFuIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBjdXJySW5kZXhTdGFydEZyb21PbmV9Ij48L3NwYW4+Jm5ic3A7LSZuYnNwOzxzcGFuIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBjdXJySW5kZXhFbmR9Ij48L3NwYW4+Jm5ic3A7KDxzcGFuIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBAbGFuZ3VhZ2UtcGFnZS10b3RhbH0iPjwvc3Bhbj46Jm5ic3A7PHNwYW4gZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IG51bWJlck9mSXRlbXN9Ij48L3NwYW4+KSA8L3NwYW4+IDwvZGl2PiA8ZGl2IGNsYXNzPSJwYWdpbmctYnV0dG9ucyIgZGF0YS1iaW5kaW5nPSJ7QHZpc2libGU6IG51bWJlck9mSXRlbXN9Ij4gPGJ1dHRvbiBjbGFzcz0iZmlyc3QiIGRhdGEtYmluZGluZz0ie0BldmVudC1vbmNsaWNrOiBoYW5kbGVQYWdlRmlyc3R9e3RpdGxlOiBAbGFuZ3VhZ2UtcGFnZS1maXJzdH0iPjxpbWcgc3JjPSJSZXNvdXJjZXMvSW1hZ2VzL0ljb25zL3BhZ2luZy1jb250cm9sLWZpcnN0LTQ0LnBuZyIgYWx0PSIgIiAvPjwvYnV0dG9uPiA8YnV0dG9uIGNsYXNzPSJwcmV2IiBkYXRhLWJpbmRpbmc9IntAZXZlbnQtb25jbGljazogaGFuZGxlUGFnZVByZXZ9e3RpdGxlOiBAbGFuZ3VhZ2UtcGFnZS1wcmV2fSI+PGltZyBzcmM9IlJlc291cmNlcy9JbWFnZXMvSWNvbnMvcGFnaW5nLWNvbnRyb2wtcHJldmlvdXMtNDQucG5nIiBhbHQ9IiAiIC8+PC9idXR0b24+IDxzcGFuIGNsYXNzPSJwYWdpbmctYnV0dG9ucy1pbmZvIiB0YWJpbmRleD0iMCI+IDxzcGFuIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBAbGFuZ3VhZ2UtcGFnZS1wYWdlfSI+PC9zcGFuPiZuYnNwOzxzcGFuIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBjdXJyUGFnZU51bWJlcn0iPjwvc3Bhbj4mbmJzcDs8c3BhbiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXBhZ2Utb2Z9Ij48L3NwYW4+Jm5ic3A7PHNwYW4gZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IGxhc3RQYWdlTnVtYmVyfSI+PC9zcGFuPiA8L3NwYW4+IDxidXR0b24gY2xhc3M9Im5leHQiIGRhdGEtYmluZGluZz0ie0BldmVudC1vbmNsaWNrOiBoYW5kbGVQYWdlTmV4dH17dGl0bGU6IEBsYW5ndWFnZS1wYWdlLW5leHR9Ij48aW1nIHNyYz0iUmVzb3VyY2VzL0ltYWdlcy9JY29ucy9wYWdpbmctY29udHJvbC1uZXh0LTQ0LnBuZyIgYWx0PSIgIiAvPjwvYnV0dG9uPiA8YnV0dG9uIGNsYXNzPSJsYXN0IiBkYXRhLWJpbmRpbmc9IntAZXZlbnQtb25jbGljazogaGFuZGxlUGFnZUxhc3R9e3RpdGxlOiBAbGFuZ3VhZ2UtcGFnZS1sYXN0fSI+PGltZyBzcmM9IlJlc291cmNlcy9JbWFnZXMvSWNvbnMvcGFnaW5nLWNvbnRyb2wtbGFzdC00NC5wbmciIGFsdD0iICIgLz48L2J1dHRvbj4gPC9kaXY+IDwvZGl2PiA8L2Rpdj4g");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/ui/components/Slider/SliderView.html","html","PGRpdiBjbGFzcz0iZ2N4LXNsaWRlci1jb250YWluZXIiPiA8ZGl2IGNsYXNzPSJnY3gtc2xpZGVyLWN1cnJlbnQtbGFiZWwtY29udGFpbmVyIj4gPGRpdiBjbGFzcz0iZ2N4LXNsaWRlci1sYWJlbCBnY3gtc2xpZGVyLWxhYmVsLWN1cnJlbnQtbWluIiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogc2xpZGVyTWluSGFuZGxlTGFiZWx9e0B2YXI6IHNsaWRlck1pbkxhYmVsRWxlbWVudH17QHRleHQ6IHNsaWRlck1pbkhhbmRsZUxhYmVsfSI+PC9kaXY+IDxkaXYgY2xhc3M9ImdjeC1zbGlkZXItbGFiZWwgZ2N4LXNsaWRlci1sYWJlbC1jdXJyZW50LW1heCIgZGF0YS1iaW5kaW5nPSJ7QHZpc2libGU6IHNsaWRlck1heEhhbmRsZUxhYmVsfXtAdmFyOiBzbGlkZXJNYXhMYWJlbEVsZW1lbnR9e0B0ZXh0OiBzbGlkZXJNYXhIYW5kbGVMYWJlbH0iPjwvZGl2PiA8L2Rpdj4gPGRpdiBjbGFzcz0iZ2N4LXNsaWRlci1yYW5nZS1jb250YWluZXIiPiA8ZGl2IGNsYXNzPSJnY3gtc2xpZGVyLXRpY2tzIiBkYXRhLWJpbmRpbmc9IntAc291cmNlOiBzbGlkZXJUaWNrc30iPiA8ZGl2IGNsYXNzPSJnY3gtdGljayIgZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLWZvcjogc2xpZGVyVGlja3N9e0BzdHlsZS1sZWZ0OiBwb3NpdGlvbn0iPjwvZGl2PiA8L2Rpdj4gPGRpdiBjbGFzcz0iZ2N4LXNsaWRlciIgZGF0YS1iaW5kaW5nPSJ7QHZhcjogc2xpZGVyRWxlbWVudH0iPjwvZGl2PiA8L2Rpdj4gPGRpdiBjbGFzcz0iZ2N4LXNsaWRlci1sYWJlbC1jb250YWluZXIiPiA8c3BhbiBjbGFzcz0iZ2N4LXNsaWRlci1sYWJlbCBnY3gtc2xpZGVyLWxhYmVsLW1pbiIgZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IHNsaWRlck1pbkxhYmVsfSI+PC9zcGFuPiA8c3BhbiBjbGFzcz0iZ2N4LXNsaWRlci1sYWJlbCBnY3gtc2xpZGVyLWxhYmVsLW1heCIgZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IHNsaWRlck1heExhYmVsfSI+PC9zcGFuPiA8L2Rpdj4gPC9kaXY+IA==");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/ui/components/SmartPanel/SmartPanelView.html","html","PGRpdiBjbGFzcz0idmlldy1jb250YWluZXItdmlldyBzbWFydC1wYW5lbCIgZGF0YS1iaW5kaW5nPSJ7QHZhcjogY29udGFpbmVyRWxlbWVudH0iPiAgPGJ1dHRvbiBjbGFzcz0iYm90dG9tLXBhbmVsLXJlc2l6ZSByZXNpemUtaGFuZGxlIiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogcmVzaXplWX17QGV2ZW50LW1vdXNlZG93bjogaGFuZGxlSGVhZGVyTW91c2VEb3dufXtAZXZlbnQtdG91Y2hzdGFydDogaGFuZGxlSGVhZGVyVG91Y2hTdGFydH17dGl0bGU6IEBsYW5ndWFnZS1zbWFydC1wYW5lbC1yZXNpemV9Ij4gPHNwYW4gY2xhc3M9Imljb24tZHJhZyI+PC9zcGFuPiA8L2J1dHRvbj4gPGRpdiBjbGFzcz0icGFuZWwtaGVhZGVyIGJhbm5lci1ub3NlbGVjdCIgIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBoZWFkZXJJc1Zpc2libGV9e0B2YXI6IGhlYWRlckVsZW1lbnR9e0BldmVudC1tb3VzZWRvd246IGhhbmRsZUhlYWRlck1vdXNlRG93bn0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7QGV2ZW50LXRvdWNoc3RhcnQ6IGhhbmRsZUhlYWRlclRvdWNoU3RhcnR9e0BjbGFzcy1yZXNpemUtaG9yaXpvbnRhbC1oaW50OiByZXNpemVYfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtAY2xhc3MtcmVzaXplLXZlcnRpY2FsLWhpbnQ6IHJlc2l6ZVl9Ij4gPGRpdiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogdGl0bGVCYXJJc1Zpc2libGV9Ij4gPGJ1dHRvbiBjbGFzcz0icGFuZWwtaGVhZGVyLWJ1dHRvbiByaWdodCBjbG9zZS0xNiIgZGF0YS1iaW5kaW5nPSJ7QHZpc2libGU6IHNob3dpbmdYQnV0dG9ufXtAZXZlbnQtb25jbGljazogaGFuZGxlQ2xpY2tDbG9zZX17dGl0bGU6IEBsYW5ndWFnZS1zbWFydC1wYW5lbC1jbG9zZX0iPjwvYnV0dG9uPiA8YnV0dG9uIGNsYXNzPSJwYW5lbC1oZWFkZXItYnV0dG9uIHJpZ2h0IiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogc2hvd2luZ01heGltaXplQnV0dG9ufXtAY2xhc3MtbWluaW1pemUtMTY6IHBhbmVsTWF4aW1pemVkfXtAbm9jbGFzcy1tYXhpbWl6ZS0xNjogcGFuZWxNYXhpbWl6ZWR9e0BldmVudC1vbmNsaWNrOiBoYW5kbGVNYXhpbWl6ZVRvZ2dsZUNsaWNrfXt0aXRsZTogQGxhbmd1YWdlLXNtYXJ0LXBhbmVsLW1heGltaXplLXJlc3RvcmV9Ij48L2J1dHRvbj4gPGJ1dHRvbiBjbGFzcz0icGFuZWwtaGVhZGVyLWJ1dHRvbiBtZW51LWJ1dHRvbiIgZGF0YS1iaW5kaW5nPSJ7QGVuYWJsZWQ6IGhhc0V4ZWN1dGFibGVNZW51SXRlbXN9e0B2aXNpYmxlOiBoYXNIb2lzdGVkTWVudX17QGV2ZW50LW9uY2xpY2s6IGhhbmRsZVRhcE1lbnVCdXR0b259e0B2YXI6IG1lbnVCdXR0b25FbGVtZW50fXt0aXRsZTogQGxhbmd1YWdlLXNtYXJ0LXBhbmVsLW1lbnV9Ij48L2J1dHRvbj4gPGJ1dHRvbiBjbGFzcz0icGFuZWwtaGVhZGVyLWJ1dHRvbiBsZWZ0IGJhY2stMTYiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBzaG93aW5nQmFja0J1dHRvbn17QGV2ZW50LWNsaWNrOiBoYW5kbGVDbGlja0JhY2t9e3RpdGxlOiBAbGFuZ3VhZ2Utc21hcnQtcGFuZWwtYmFja30iPjwvYnV0dG9uPiA8aDIgY2xhc3M9InBhbmVsLXRpdGxlIGJhbm5lci1ub3NlbGVjdCI+IDxpbWcgc3JjPSJSZXNvdXJjZXMvSW1hZ2VzL2xvYWRlci1zbWFsbC5naWYiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBzaG93QnVzeUluZGljYXRvcn0iIGFsdD0iICIgLz4gPHNwYW4gZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IGNvbnRhaW5lclRpdGxlfXtAdmlzaWJsZTogY29udGFpbmVyVGl0bGV9Ij48L3NwYW4+IDxzcGFuIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBjb250YWluZXJUaXRsZX0iPiZuYnNwOy0mbmJzcDs8L3NwYW4+IDxzcGFuIGRhdGEtYmluZGluZz0ie0B0ZXh0OiB2aWV3VGl0bGV9e0B2aXNpYmxlOiB2aWV3VGl0bGV9e3RpdGxlOiB2aWV3VGl0bGV9Ij48L3NwYW4+IDwvaDI+IDwvZGl2PiA8ZGl2IGNsYXNzPSJzbWFydC1wYW5lbC1ob2lzdGVkLW1lbnUtaW5saW5lIiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogaW5saW5lTWVudUlzT3Blbn17QHdpZGdldDogU21hcnRQYW5lbEhvaXN0ZWRNZW51fXtAd2lkZ2V0LXJlcXVpcmVkOiBmYWxzZX17QHdpZGdldC1jb250ZXh0OiBob2lzdGVkTWVudVZpZXdNb2RlbH0iPjwvZGl2PiA8ZGl2IGRhdGEtYmluZGluZz0ie0Bkb206IGhlYWRlckluc2VydERvbUVsZW1lbnR9Ij48L2Rpdj4gPC9kaXY+ICAgPGRpdiBjbGFzcz0icmVnaW9uIHBhbmVsLXN0YXR1cy1yZWdpb24iIGRhdGEtYmluZGluZz0ie0B2YXI6IHN0YXR1c1JlZ2lvbkVsZW1lbnR9Ij48L2Rpdj4gICA8ZGl2IGNsYXNzPSJwYW5lbC1zY3JvbGwtY29udGFpbmVyIiBkYXRhLWJpbmRpbmc9IntkYXRhLXJlZ2lvbi1uYW1lOiByZWdpb25OYW1lfXtkYXRhLXJlZ2lvbi1hZGFwdGVyOiByZWdpb25UeXBlfXtAdmFyOiBzY3JvbGxSZWdpb25FbGVtZW50fXtAZXZlbnQtb25zY3JvbGw6IGhhbmRsZVNjcm9sbENoYW5nZX0iIHRhYmluZGV4PSItMSI+PC9kaXY+ICAgPGRpdiBjbGFzcz0icGFuZWwtZm9vdGVyIiBkYXRhLWJpbmRpbmc9IntAdmFyOiBmb290ZXJFbGVtZW50fXtAdmlzaWJsZTogZm9vdGVySW5zZXJ0RG9tRWxlbWVudH0iIHN0eWxlPSJwb3NpdGlvbjogYWJzb2x1dGUiPiA8ZGl2IGNsYXNzPSJwYW5lbC1mb290ZXItaW5uZXIiIGRhdGEtYmluZGluZz0ie0Bkb206IGZvb3Rlckluc2VydERvbUVsZW1lbnR9Ij48L2Rpdj4gPC9kaXY+ICA8L2Rpdj4g");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/ui/components/Table/TableView.html","html","PGRpdiBjbGFzcz0icmVzdWx0cy10YWJsZSIgZGF0YS1iaW5kaW5nPSJ7QHZhcjogdGFibGVDb250YWluZXJFbGVtZW50fSI+IDx0YWJsZT4gPHRoZWFkPiA8dHIgZGF0YS1iaW5kaW5nPSJ7QHNvdXJjZTogY29sdW1uSGVhZGVyc30iPiA8dGggZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLWZvcjogY29sdW1uSGVhZGVyc317QHZpc2libGU6IHZpc2libGV9e0BldmVudC1vbmNsaWNrOiBoYW5kbGVDb2x1bW5IZWFkQ2xpY2t9IiBzY29wZT0iY29sIj4gPGJ1dHRvbiBkYXRhLWJpbmRpbmc9InthcmlhLWxhYmVsOiBjb2x1bW5EZXNjcmlwdG9yfSI+IDxzcGFuIGRhdGEtYmluZGluZz0ie2NsYXNzOiBzb3J0Q2xhc3N9e3RpdGxlOiBAbGFuZ3VhZ2UtcmVzdWx0cy1zb3J0fSI+PC9zcGFuPiA8c3BhbiBjbGFzcz0icmVzdWx0LWhlYWRpbmciIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBwcmVzZW50YWJsZVZhbHVlfSI+PC9zcGFuPiA8L2J1dHRvbj4gPC90aD4gPC90cj4gPC90aGVhZD4gPHRib2R5IGRhdGEtYmluZGluZz0ie0Bzb3VyY2U6IHJlY29yZHN9Ij4gPHRyIGRhdGEtYmluZGluZz0ie0B0ZW1wbGF0ZS1mb3I6IHJlY29yZHN9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7QHNvdXJjZTogYXR0cmlidXRlc30NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtAZXZlbnQtbW91c2Vkb3duOiBoYW5kbGVNb3VzZURvd259DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7QGV2ZW50LW1vdXNldXA6IGhhbmRsZU1vdXNlVXB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7QGV2ZW50LXRvdWNoc3RhcnQ6IGhhbmRsZVRvdWNoU3RhcnR9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7QGV2ZW50LXRvdWNobW92ZTogaGFuZGxlVG91Y2hNb3ZlfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge0BldmVudC10b3VjaGVuZDogaGFuZGxlVG91Y2hFbmR9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7QGV2ZW50LWNsaWNrOiBoYW5kbGVDbGlja30iPiA8dGQgZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLWZvcjogYXR0cmlidXRlc317QHZpc2libGU6IHZpc2libGV9Ij4gPGEgZGF0YS1iaW5kaW5nPSJ7QHZpc2libGU6IGRpc3BsYXlBc1VybH17QGV2ZW50LW9uY2xpY2s6IGhhbmRsZUNsaWNrQXR0cmlidXRlbGlua317aHJlZjogdmFsdWV9e0B0ZXh0OiBwcmVzZW50YWJsZVZhbHVlfSIgdGFyZ2V0PSJfYmxhbmsiPjwvYT4gPGJ1dHRvbiBkYXRhLWJpbmRpbmc9IntAaGlkZGVuOiBkaXNwbGF5QXNVcmx9e0B0ZXh0OiBwcmVzZW50YWJsZVZhbHVlfSIgdGFiaW5kZXg9IjAiPjwvYnV0dG9uPiA8L3RkPiA8L3RyPiA8L3Rib2R5PiA8L3RhYmxlPiA8L2Rpdj4g");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/visualization/SymbologySettings/AttributeSymbologySettingsView.html","html","PGRpdiBjbGFzcz0iYXR0cmlidXRlLXN5bWJvbG9neS1zZXR0aW5ncyIgZGF0YS1iaW5kaW5nPSJ7QHZhcjogY29udGFpbmVyfXtAZXZlbnQtb25jaGFuZ2U6IGhhbmRsZUNoYW5nZX17QGV2ZW50LW9uaW5wdXQ6IGhhbmRsZUNoYW5nZX0iPiAgPGRpdiBjbGFzcz0ic3ltYm9sb2d5LWRyb3AtZG93biI+IDxsYWJlbCBjbGFzcz0ic3ltYm9sb2d5LWxhYmVsIiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1waWNrLWF0dHJpYnV0ZX0iPjwvbGFiZWw+IDxzZWxlY3QgZGF0YS1iaW5kaW5nPSJ7QHNvdXJjZTogYXR0cmlidXRlc317QHZhcjogYXR0cmlidXRlSW5wdXR9Ij4gPG9wdGlvbiBkYXRhLWJpbmRpbmc9IntAdGVtcGxhdGUtZm9yOiBhdHRyaWJ1dGVzfXtAdGV4dDogZGlzcGxheU5hbWV9e0B2YWx1ZSBuYW1lfSI+PC9vcHRpb24+IDwvc2VsZWN0PiA8L2Rpdj4gIDxkaXYgY2xhc3M9InN5bWJvbG9neS1zbGlkZXJzIiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogaXNOdW1lcmljQXR0cmlidXRlfSI+IDxkaXYgY2xhc3M9InN5bWJvbG9neS1zbGlkZXIiPiA8bGFiZWwgY2xhc3M9InN5bWJvbG9neS1sYWJlbCIgZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IEBsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtYnJlYWtzfSI+PC9sYWJlbD4gPGRpdiBjbGFzcz0ic2xpZGVyIiBkYXRhLWJpbmRpbmc9IntAdmFyOiBjbGFzc0JyZWFrc1NsaWRlcn0iPjwvZGl2PiA8c3BhbiBjbGFzcz0ic3ltYm9sb2d5LXNsaWRlci12YWx1ZSI+IDxzcGFuIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBudW1CcmVha3N9Ij48L3NwYW4+IDwvc3Bhbj4gPC9kaXY+IDwvZGl2PiAgPGRpdiBjbGFzcz0ic3ltYm9sb2d5LWNvbG9ycyIgIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBpc051bWVyaWNBdHRyaWJ1dGV9Ij4gIDxkaXYgY2xhc3M9InN5bWJvbG9neS1jbGFzc2JyZWFrLWNvbG9ycGlja2VyIj4gPGxhYmVsIGNsYXNzPSJzeW1ib2xvZ3ktbGFiZWwiIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBAbGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLXN0YXJ0Y29sb3J9Ij48L2xhYmVsPiA8ZGl2IGNsYXNzPSJpbmxpbmUiIGRhdGEtYmluZGluZz0ie0BoaWRkZW46IHVzZUNvbG9yU3dhdGNoZXN9Ij4gPGlucHV0IHR5cGU9ImNvbG9yIiBkYXRhLWJpbmRpbmc9IntAdmFyOiBzdGFydENvbG9ySW5wdXR9IiAvPiA8L2Rpdj4gPGRpdiBjbGFzcz0iaW5saW5lIGNvbG9yLXN3YXRjaGVzIiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogdXNlQ29sb3JTd2F0Y2hlc30iPiA8ZmllbGRzZXQgY2xhc3M9InJhZGlvLWNvbnRhaW5lciBpbmxpbmUiIGRhdGEtYmluZGluZz0ie0B2YXI6IHN0YXJ0Q29sb3JTd2F0Y2hGaWVsZFNldH17QHNvdXJjZTogc3RhcnRDb2xvclN3YXRjaGVzfSI+IDxsYWJlbCBjbGFzcz0ic3RhcnQtY29sb3Itc3dhdGNoIGNvbG9yLXN3YXRjaCIgZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLWZvcjogc3RhcnRDb2xvclN3YXRjaGVzfSI+IDxpbnB1dCB0eXBlPSJyYWRpbyIgbmFtZT0ic3RhcnQtY29sb3Itc3dhdGNoIiAvPiA8L2xhYmVsPiA8L2ZpZWxkc2V0PiA8L2Rpdj4gPC9kaXY+ICA8ZGl2IGNsYXNzPSJzeW1ib2xvZ3ktY2xhc3NicmVhay1jb2xvcnBpY2tlciI+IDxsYWJlbCBjbGFzcz0ic3ltYm9sb2d5LWxhYmVsIiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1lbmRjb2xvcn0iPjwvbGFiZWw+IDxkaXYgY2xhc3M9ImlubGluZSIgZGF0YS1iaW5kaW5nPSJ7QGhpZGRlbjogdXNlQ29sb3JTd2F0Y2hlc30iPiA8aW5wdXQgdHlwZT0iY29sb3IiIGRhdGEtYmluZGluZz0ie0B2YXI6IGVuZENvbG9ySW5wdXR9IiAvPiA8L2Rpdj4gPGRpdiBjbGFzcz0iaW5saW5lIGNvbG9yLXN3YXRjaGVzIiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogdXNlQ29sb3JTd2F0Y2hlc30iPiA8ZmllbGRzZXQgY2xhc3M9InJhZGlvLWNvbnRhaW5lciBpbmxpbmUiIGRhdGEtYmluZGluZz0ie0B2YXI6IGVuZENvbG9yU3dhdGNoRmllbGRTZXR9e0Bzb3VyY2U6IGVuZENvbG9yU3dhdGNoZXN9Ij4gPGxhYmVsIGNsYXNzPSJlbmQtY29sb3Itc3dhdGNoIGNvbG9yLXN3YXRjaCIgZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLWZvcjogZW5kQ29sb3JTd2F0Y2hlc30iPiA8aW5wdXQgdHlwZT0icmFkaW8iIG5hbWU9ImVuZC1jb2xvci1zd2F0Y2giIC8+IDwvbGFiZWw+IDwvZmllbGRzZXQ+IDwvZGl2PiA8L2Rpdj4gPC9kaXY+ICA8ZGl2IGNsYXNzPSJzeW1ib2xvZ3ktc2xpZGVycyIgZGF0YS1iaW5kaW5nPSJ7QHZpc2libGU6IGN1cnJlbnRBdHRyaWJ1dGV9Ij4gIDxkaXYgY2xhc3M9InN5bWJvbG9neS1zbGlkZXIiPiA8bGFiZWwgY2xhc3M9InN5bWJvbG9neS1sYWJlbCIgZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IEBsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtdHJhbnNwYXJlbmN5fSI+PC9sYWJlbD4gPGRpdiBjbGFzcz0ic2xpZGVyIiBkYXRhLWJpbmRpbmc9IntAdmFyOiB0cmFuc3BhcmVuY3lTbGlkZXJ9Ij48L2Rpdj4gPHNwYW4gY2xhc3M9InN5bWJvbG9neS1zbGlkZXItdmFsdWUiPiA8c3BhbiBkYXRhLWJpbmRpbmc9IntAdGV4dDogdHJhbnNwYXJlbmN5fSI+PC9zcGFuPiA8c3BhbiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy10cmFuc3BhcmVuY3ktc3VmZml4fSI+PC9zcGFuPiA8L3NwYW4+IDwvZGl2PiAgPGRpdiBjbGFzcz0ic3ltYm9sb2d5LXNsaWRlciIgZGF0YS1iaW5kaW5nPSJ7QGhpZGRlbjogbm9NYXJrZXJ9Ij4gPGxhYmVsIGNsYXNzPSJzeW1ib2xvZ3ktbGFiZWwiIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBAbGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLW1hcmtlci1zaXplfSI+PC9sYWJlbD4gPGRpdiBjbGFzcz0ic2xpZGVyIiBkYXRhLWJpbmRpbmc9IntAdmFyOiBtYXJrZXJTaXplU2xpZGVyfXtkaXNhYmxlZDogbm9NYXJrZXJ9Ij48L2Rpdj4gPHNwYW4gY2xhc3M9InN5bWJvbG9neS1zbGlkZXItdmFsdWUiPiA8c3BhbiBkYXRhLWJpbmRpbmc9IntAdGV4dDogbWFya2VyU2l6ZX0iPjwvc3Bhbj4gPHNwYW4gZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IEBsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtbWFya2VyLXNpemUtc3VmZml4fSI+PC9zcGFuPiA8L3NwYW4+IDwvZGl2PiAgPGRpdiBjbGFzcz0ic3ltYm9sb2d5LXNsaWRlciI+IDxsYWJlbCBjbGFzcz0ic3ltYm9sb2d5LWxhYmVsIiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1saW5lLXdpZHRofSI+PC9sYWJlbD4gPGRpdiBjbGFzcz0ic2xpZGVyIiBkYXRhLWJpbmRpbmc9IntAdmFyOiBsaW5lV2lkdGhTbGlkZXJ9Ij48L2Rpdj4gPHNwYW4gY2xhc3M9InN5bWJvbG9neS1zbGlkZXItdmFsdWUiPiA8c3BhbiBkYXRhLWJpbmRpbmc9IntAdGV4dDogbGluZVdpZHRofSI+PC9zcGFuPiA8c3BhbiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1saW5lLXdpZHRoLXN1ZmZpeH0iPjwvc3Bhbj4gPC9zcGFuPiA8L2Rpdj4gIDxkaXYgY2xhc3M9InN5bWJvbG9neS1kcm9wLWRvd24iIGRhdGEtYmluZGluZz0ie0BoaWRkZW46IG5vTWFya2VyfSI+IDxsYWJlbCBjbGFzcz0ic3ltYm9sb2d5LWxhYmVsIiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1tYXJrZXItc3R5bGV9Ij48L2xhYmVsPiA8c2VsZWN0IGRhdGEtYmluZGluZz0ie0Bzb3VyY2U6IG1hcmtlclN0eWxlc317QHZhcjogbWFya2VyU3R5bGVJbnB1dH17ZGlzYWJsZWQ6IG5vTWFya2VyfSI+IDxvcHRpb24gZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLWZvcjogbWFya2VyU3R5bGVzfXtAdGV4dDogbGFiZWx9Ij48L29wdGlvbj4gPC9zZWxlY3Q+IDwvZGl2PiA8L2Rpdj4gIDxkaXYgY2xhc3M9InN5bWJvbG9neS1jbGFzc2VzIiBkYXRhLWJpbmRpbmc9IntAc291cmNlOiBzeW1ib2xvZ3lDbGFzc2VzfSI+IDxkaXYgZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLWZvcjogc3ltYm9sb2d5Q2xhc3Nlc317QHZhcjogc3ltYm9sb2d5Q2xhc3NDb250YWluZXJ9Ij4gPGJ1dHRvbiBjbGFzcz0iYnV0dG9uIHN5bWJvbG9neS1jbGFzcyIgZGF0YS1iaW5kaW5nPSJ7QGNsYXNzLXNlbGVjdGVkOiBzZWxlY3RlZH17QGV2ZW50LW9uY2xpY2s6IGhhbmRsZVN5bWJvbENsYXNzU2VsZWN0ZWR9e3RpdGxlOiBuYW1lfSI+IDxkaXYgY2xhc3M9InN5bWJvbG9neS10ZXh0IiBkYXRhLWJpbmRpbmc9IntAdGV4dDogbmFtZX0iPjwvZGl2PiA8ZGl2IGNsYXNzPSJzeW1ib2xvZ3ktY29sb3IiIGRhdGEtYmluZGluZz0ie0BzdHlsZS1iYWNrZ3JvdW5kLWNvbG9yOiBjb2xvcn0iPjwvZGl2PiA8L2J1dHRvbj4gIDxkaXYgZGF0YS1iaW5kaW5nPSJ7QHZpc2libGU6IHNlbGVjdGVkfXtpZDogd2lkZ2V0SWR9Ij48L2Rpdj4gPC9kaXY+IDwvZGl2PiA8L2Rpdj4g");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Mapping/infrastructure/visualization/SymbologySettings/SymbologySettingsView.html","html","PGRpdiBjbGFzcz0ic3ltYm9sb2d5LXNldHRpbmdzIiBkYXRhLWJpbmRpbmc9IntAdmFyOiBjb250YWluZXJ9e0BldmVudC1vbmNoYW5nZTogaGFuZGxlQ2hhbmdlfXtAZXZlbnQtb25pbnB1dDogaGFuZGxlQ2hhbmdlfSI+ICA8ZGl2IGNsYXNzPSJzeW1ib2xvZ3ktY29sb3JzIj4gIDxkaXY+IDxsYWJlbCBjbGFzcz0ic3ltYm9sb2d5LWxhYmVsIiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1jb2xvcn0iPjwvbGFiZWw+IDxkaXYgY2xhc3M9ImlubGluZSIgZGF0YS1iaW5kaW5nPSJ7QGhpZGRlbjogdXNlQ29sb3JTd2F0Y2hlc30iPiA8aW5wdXQgdHlwZT0iY29sb3IiIGRhdGEtYmluZGluZz0ie0B2YXI6IGNvbG9ySW5wdXR9IiAvPiA8L2Rpdj4gPGRpdiBjbGFzcz0iaW5saW5lIGNvbG9yLXN3YXRjaGVzIiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogdXNlQ29sb3JTd2F0Y2hlc30iPiA8ZmllbGRzZXQgY2xhc3M9InJhZGlvLWNvbnRhaW5lciBpbmxpbmUiIGRhdGEtYmluZGluZz0ie0B2YXI6IGNvbG9yU3dhdGNoRmllbGRTZXR9e0Bzb3VyY2U6IGNvbG9yU3dhdGNoZXN9Ij4gPGxhYmVsIGNsYXNzPSJjb2xvci1zd2F0Y2giIGRhdGEtYmluZGluZz0ie0B0ZW1wbGF0ZS1mb3I6IGNvbG9yU3dhdGNoZXN9Ij4gPGlucHV0IHR5cGU9InJhZGlvIiBuYW1lPSJjb2xvci1zd2F0Y2giIC8+IDwvbGFiZWw+IDwvZmllbGRzZXQ+IDwvZGl2PiA8L2Rpdj4gPC9kaXY+ICA8ZGl2IGNsYXNzPSJzeW1ib2xvZ3ktc2xpZGVycyI+ICA8ZGl2IGNsYXNzPSJzeW1ib2xvZ3ktc2xpZGVyIj4gPGxhYmVsIGNsYXNzPSJzeW1ib2xvZ3ktbGFiZWwiIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBAbGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLXRyYW5zcGFyZW5jeX0iPjwvbGFiZWw+IDxkaXYgY2xhc3M9InNsaWRlciIgZGF0YS1iaW5kaW5nPSJ7QHZhcjogdHJhbnNwYXJlbmN5U2xpZGVyfSI+PC9kaXY+IDxzcGFuIGNsYXNzPSJzeW1ib2xvZ3ktc2xpZGVyLXZhbHVlIj4gPHNwYW4gZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IHRyYW5zcGFyZW5jeX0iPjwvc3Bhbj4gPHNwYW4gZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IEBsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtdHJhbnNwYXJlbmN5LXN1ZmZpeH0iPjwvc3Bhbj4gPC9zcGFuPiA8L2Rpdj4gIDxkaXYgY2xhc3M9InN5bWJvbG9neS1zbGlkZXIiIGRhdGEtYmluZGluZz0ie0BoaWRkZW46IG5vTWFya2VyfSI+IDxsYWJlbCBjbGFzcz0ic3ltYm9sb2d5LWxhYmVsIiBkYXRhLWJpbmRpbmc9IntAdGV4dDogQGxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1tYXJrZXItc2l6ZX0iPjwvbGFiZWw+IDxkaXYgY2xhc3M9InNsaWRlciIgZGF0YS1iaW5kaW5nPSJ7QHZhcjogbWFya2VyU2l6ZVNsaWRlcn17ZGlzYWJsZWQ6IG5vTWFya2VyfSI+PC9kaXY+IDxzcGFuIGNsYXNzPSJzeW1ib2xvZ3ktc2xpZGVyLXZhbHVlIj4gPHNwYW4gZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IG1hcmtlclNpemV9Ij48L3NwYW4+IDxzcGFuIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBAbGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLW1hcmtlci1zaXplLXN1ZmZpeH0iPjwvc3Bhbj4gPC9zcGFuPiA8L2Rpdj4gIDxkaXYgY2xhc3M9InN5bWJvbG9neS1zbGlkZXIiPiA8bGFiZWwgY2xhc3M9InN5bWJvbG9neS1sYWJlbCIgZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IEBsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtbGluZS13aWR0aH0iPjwvbGFiZWw+IDxkaXYgY2xhc3M9InNsaWRlciIgZGF0YS1iaW5kaW5nPSJ7QHZhcjogbGluZVdpZHRoU2xpZGVyfSI+PC9kaXY+IDxzcGFuIGNsYXNzPSJzeW1ib2xvZ3ktc2xpZGVyLXZhbHVlIj4gPHNwYW4gZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IGxpbmVXaWR0aH0iPjwvc3Bhbj4gPHNwYW4gZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IEBsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtbGluZS13aWR0aC1zdWZmaXh9Ij48L3NwYW4+IDwvc3Bhbj4gPC9kaXY+IDwvZGl2PiAgPGRpdiBjbGFzcz0ic3ltYm9sb2d5LWRyb3AtZG93bnMiPiAgPGRpdiBjbGFzcz0ic3ltYm9sb2d5LWRyb3AtZG93biIgZGF0YS1iaW5kaW5nPSJ7QGhpZGRlbjogbm9NYXJrZXJ9Ij4gPGxhYmVsIGNsYXNzPSJzeW1ib2xvZ3ktbGFiZWwiIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBAbGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLW1hcmtlci1zdHlsZX0iPjwvbGFiZWw+IDxzZWxlY3QgZGF0YS1iaW5kaW5nPSJ7QHNvdXJjZTogbWFya2VyU3R5bGVzfXtAdmFyOiBtYXJrZXJTdHlsZUlucHV0fXtkaXNhYmxlZDogbm9NYXJrZXJ9Ij4gPG9wdGlvbiBkYXRhLWJpbmRpbmc9IntAdGVtcGxhdGUtZm9yOiBtYXJrZXJTdHlsZXN9e0B0ZXh0OiBsYWJlbH0iPjwvb3B0aW9uPiA8L3NlbGVjdD4gPC9kaXY+ICA8ZGl2IGNsYXNzPSJzeW1ib2xvZ3ktZHJvcC1kb3duIiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogbm9NYXJrZXJ9Ij4gPGxhYmVsIGNsYXNzPSJzeW1ib2xvZ3ktbGFiZWwiIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBAbGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLWxpbmUtc3R5bGV9Ij48L2xhYmVsPiA8c2VsZWN0IGRhdGEtYmluZGluZz0ie0Bzb3VyY2U6IGxpbmVTdHlsZXN9e0B2YXI6IGxpbmVTdHlsZUlucHV0fSI+IDxvcHRpb24gZGF0YS1iaW5kaW5nPSJ7QHRlbXBsYXRlLWZvcjogbGluZVN0eWxlc317QHRleHQ6IGxhYmVsfSI+PC9vcHRpb24+IDwvc2VsZWN0PiA8L2Rpdj4gIDxkaXYgY2xhc3M9InN5bWJvbG9neS1kcm9wLWRvd24iIGRhdGEtYmluZGluZz0ie0BoaWRkZW46IG5vRmlsbH0iPiA8bGFiZWwgY2xhc3M9InN5bWJvbG9neS1sYWJlbCIgZGF0YS1iaW5kaW5nPSJ7QHRleHQ6IEBsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtZmlsbC1zdHlsZX0iPjwvbGFiZWw+IDxzZWxlY3QgZGF0YS1iaW5kaW5nPSJ7QHNvdXJjZTogZmlsbFN0eWxlc317QHZhcjogZmlsbFN0eWxlSW5wdXR9e2Rpc2FibGVkOiBub0ZpbGx9Ij4gPG9wdGlvbiBkYXRhLWJpbmRpbmc9IntAdGVtcGxhdGUtZm9yOiBmaWxsU3R5bGVzfXtAdGV4dDogbGFiZWx9Ij48L29wdGlvbj4gPC9zZWxlY3Q+IDwvZGl2PiA8L2Rpdj4gPC9kaXY+IA==");
geocortex.resourceManager.register("Mapping.Infrastructure","inv","Invariant","json","eyJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXRvZ2dsZS1sb2ctdmlldyI6IkFjdGl2YXRlcyBvciBkZWFjdGl2YXRlcyBsb2cgdmlldy4iLCJsYW5ndWFnZS10b29sYmFyLWlkZW50aWZ5LWZyZWVoYW5kLXRvb2x0aXAiOiJGaW5kIG91dCBhYm91dCBhbiBhcmVhIG9uIHRoZSBtYXAgZGVmaW5lZCBieSBhIGZyZWVoYW5kIHNoYXBlIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1zdGFydC1lZGl0aW5nLW5ldy1mZWF0dXJlIjoiQmVnaW5zIGVkaXRpbmcgYSBuZXcgZmVhdHVyZS4iLCJsYW5ndWFnZS1zdGF0ZXMtZmVhdHVyZS1lZGl0aW5nLXN0YXRlLWRlc2NyaXB0aW9uIjoiVGhlIGNyZWF0ZSBhIGZlYXR1cmUgdG9vbCBpcyBjdXJyZW50bHkgYWN0aXZlLiIsImxhbmd1YWdlLXRvb2xiYXItaWRlbnRpZnktcG9seWxpbmUtZGVzYy1rZXlib2FyZCI6IlRvIGxlYXJuIHdoYXRcdTIwMTlzIHRoZXJlLCB1c2UgYXJyb3dzIHRvIG1vdmUgdGhlIHBvaW50LiBIaXQgRU5URVIgdG8gcGxvdCBhbmQgYmVnaW4gbW92aW5nIHRoZSBuZXh0IHBvaW50LiBIaXQgRU5URVIgdHdpY2UgdG8gZmluaXNoLiIsImxhbmd1YWdlLWNvbW1vbi1jcmVhdGUiOiJDcmVhdGUiLCJsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtbWFya2VyLXN0eWxlLXgiOiJYIiwibGFuZ3VhZ2UtbWVudS1wcm9qZWN0cy1hY3Rpb25zLXJlZnJlc2gtZGVzYyI6IlJlZnJlc2ggdGhlIGxpc3Qgb2YgcHJvamVjdHMuIiwibGFuZ3VhZ2UtZ3JhbnQtZWRpdG9yLWdsb2JhbC1ncmFudC1uYW1lLXVzZXIiOiJFdmVyeW9uZSAoc2lnbi1pbiByZXF1aXJlZCkiLCJsYW5ndWFnZS1ncmFudC1lZGl0b3Itc2VhcmNoLXBsYWNlaG9sZGVyIjoiU2VhcmNoLi4uIiwibGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLWV4Y2VlZGVkLW1heC1jbGFzc2VzLXRpdGxlIjoiRXhjZWVkZWQgbWF4aW11bSB1bmlxdWUgdmFsdWVzIiwibGFuZ3VhZ2UtbWVudS1vZmZsaW5lLW1hcC1lZGl0b3ItZ2VvbWV0cnktYWN0aW9ucy1wb2x5Z29uLWRlc2MiOiJEcmF3IGEgcG9seWdvbiBmb3IgdGhlIGFyZWEgb2YgaW50ZXJlc3QgZ2VvbWV0cnkuIiwibGFuZ3VhZ2UtbGF5ZXJsaXN0LXZpc2libGUtYXQtZXh0ZW50IjoiQ3VycmVudGx5IHdpdGhpbiB2aXNpYmxlIHNjYWxlLiIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tc2hvdy1tYXAtdGlwLXJlc3VsdHMiOiJTaG93cyBtYXAgdGlwIHJlc3VsdHMgZm9yIGEgRmVhdHVyZVNldENvbGxlY3Rpb24gcHJldmlvdXNseSBhZGRlZCB0byB0aGUgRmVhdHVyZVNldE1hbmFnZXIuIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1vcGVuLXJlc3VsdHMtZnJhbWUiOiJBY3RpdmF0ZXMgdGhlIFJlc3VsdHNSZWdpb24uIiwibGFuZ3VhZ2Utc3RhdGVzLW1lYXN1cmUtc3RhdGUtZGVzY3JpcHRpb24iOiJUaGUgbWVhc3VyaW5nIHRvb2wgaXMgY3VycmVudGx5IGFjdGl2ZS4iLCJsYW5ndWFnZS1tZW51LXNvY2lhbC1saW5rcy1tZW51LWRlc2MiOiJTb2NpYWwgTGlua3MiLCJsYW5ndWFnZS1tZW51LWFkZC1hLWZlYXR1cmUiOiJDcmVhdGUgYSBmZWF0dXJlIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1oaWdobGlnaHQtZmVhdHVyZS1zZXQiOiJIaWdobGlnaHRzIGFsbCBvZiB0aGUgZmVhdHVyZXMgaW4gdGhlIHNwZWNpZmllZCBmZWF0dXJlIHNldCBpbiB0aGUgYWN0aXZlIGhpZ2hsaWdodCBsYXllci4iLCJsYW5ndWFnZS1wcm9qZWN0LWVycm9yLWRlbGV0ZS1kZW5pZWQiOiJZb3UgZG8gbm90IGhhdmUgcGVybWlzc2lvbiB0byBkZWxldGUgdGhpcyBwcm9qZWN0LiIsImxhbmd1YWdlLW1lbnUtZHJhdy1wb2ludCI6IkRyYXcgYSBQb2ludCIsImxhbmd1YWdlLXRvb2xiYXItdGFza3MtdXBsb2FkLWRhdGEiOiJVcGxvYWQgRGF0YSIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tc2hvdy1yZXN1bHRzLWZlYXR1cmUtYWN0aW9uIjoiQ3JlYXRlcyBSZXN1bHRzTGlzdEZlYXR1cmVBY3Rpb25zVmlldyBhbmQgZGlzcGxheXMgdGhlIEZlYXR1cmUgQWN0aW9ucy4iLCJsYW5ndWFnZS1wYWdlLXRvdGFsIjoiVG90YWwiLCJsYW5ndWFnZS10b29sYmFyLW5hdmlnYXRpb24tcGFuLXRvb2x0aXAiOiJDYW5jZWwgYW55IGFjdGl2ZSB0b29scyBhbmQgcHV0IHRoZSBtYXAgaW50byBwYW4gbW9kZSIsImxhbmd1YWdlLXVpLXRhYmxlLXNvcnRlZC1kZXNjZW5kaW5nIjoiQ29sdW1uIGhlYWRlci4gezB9IC0gU29ydGVkIGRlc2NlbmRpbmcuIiwibGFuZ3VhZ2Utb2ZmbGluZS1wcm9ncmVzcy1iYXNlbWFwZXhwb3J0LWRvd25sb2FkaW5nIjoiezB9IC0gezF9IG9mIHsyfSAoezN9JSkgZG93bmxvYWRlZC4gezR9LiIsImxhbmd1YWdlLWNvbW1vbi1mZWF0dXJlLWVkaXRsb2ctZGVzYyI6IkRpc3BsYXlzIGluZm9ybWF0aW9uIGFib3V0IGVkaXRpbmcgaGlzdG9yeSBvZiB0aGUgZmVhdHVyZSBsYXllci4iLCJsYW5ndWFnZS1jb29yZGluYXRlcy1sb25naXR1ZGUtYWJicmV2IjoiTG9uIiwibGFuZ3VhZ2UtdG9vbGJhci1ncm91cC1hZHZhbmNlZC1tZWFzdXJlbWVudCI6IkFkdmFuY2VkIE1lYXN1cmVtZW50IiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi16b29tLXRvLWZlYXR1cmUiOiJab29tcyB0byBhIGZlYXR1cmUuIiwibGFuZ3VhZ2UtbWludXRlcy1hYmJyIjoiTSIsImxhbmd1YWdlLXRvb2xiYXItZ3JvdXAtZmluZC1kYXRhIjoiRmluZCBEYXRhIiwibGFuZ3VhZ2Utd2VibWFwLWxheWVyLW5hbWUtcG9seWdvbiI6IlBvbHlnb25zIiwibGFuZ3VhZ2UtbWVudS1zaG93LXJlc3VsdHMtbGlzdCI6Ikxpc3QgVmlldyIsImxhbmd1YWdlLW1lbnUtY2VudGVyLXRleHRtYXAtZGVzYyI6IkNlbnRlciB0aGUgbWFwIG9uIHRoZSBwb2ludCBzcGVjaWZpZWQuIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1mZWF0dXJlLWxheWVyLW1vZHVsZS1yZWZyZXNoLWRhdGEiOiJSZWZyZXNoZXMgbGF5ZXIgZWRpdCBzdW1tYXJpZXMgYW5kIHRoZSBcInN5bmMgbmVlZGVkXCIgZmxhZy4iLCJsYW5ndWFnZS10b29sYmFyLWdyb3VwLWFuYWx5c2lzIjoiQW5hbHlzaXMiLCJsYW5ndWFnZS1tZW51LXRpdGxlIjoiSSB3YW50IHRvLi4uIiwibGFuZ3VhZ2UtdG9vbGJhci10YWItdG9vbHMiOiJUb29scyIsImxhbmd1YWdlLXRvb2xiYXItaW5mb3JtYXRpb24tYWN0aW9ucyI6IkluZm9ybWF0aW9uICYgQWN0aW9ucyIsImxhbmd1YWdlLW1lbnUtb2ZmbGluZS1tYXAtZWRpdG9yLWdlb21ldHJ5LWFjdGlvbnMtZWxsaXBzZS1kZXNjIjoiRHJhdyBhbiBlbGxpcHNlIGZvciB0aGUgYXJlYSBvZiBpbnRlcmVzdCBnZW9tZXRyeS4iLCJsYW5ndWFnZS1jb21tb24tZmVhdHVyZS1sYXllci1kZXRhaWxzIjoiU3luYyBTZXR0aW5ncyBmb3IgezB9IiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1zaG93LXJlc3VsdHMtdGFibGUiOiJEaXNwbGF5cyB0aGUgbGlzdCBvZiBmZWF0dXJlcyBpbiB0aGUgZ2l2ZW4gZmVhdHVyZSBzZXQgY29sbGVjdGlvbiBpbiBhIHRhYnVsYXIgdmlldy4iLCJsYW5ndWFnZS1tZW51LW9mZmxpbmUtbWFwLWVkaXRvci1nZW9tZXRyeS1hY3Rpb25zLWN1cnJlbnRleHRlbnQiOiJDdXJyZW50IEV4dGVudCIsImxhbmd1YWdlLXRvb2xiYXItaWRlbnRpZnktc25hcHBpbmctdG9vbHRpcCI6IkVuYWJsZS9EaXNhYmxlIHNuYXBwaW5nIHdoaWxlIGlkZW50aWZ5aW5nIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1hZGQtbWFya3VwIjoiQWRkcyB0aGUgZ2l2ZW4gZ2VvbWV0cnkgdG8gdGhlIG1hcmt1cCBsYXllci4iLCJsYW5ndWFnZS1tZW51LXJlbW92ZS11c2VyLWFkZGVkLW1hcHNlcnZpY2UtZGVzYyI6IlJlbW92ZSB0aGlzIHVzZXIgYWRkZWQgc2VydmljZSBmcm9tIHRoZSBtYXAuIiwibGFuZ3VhZ2UtcmVzdWx0cy1leHBvcnQtdG8tY29uZmlybS10aXRsZSI6IkRvd25sb2FkIFwiLnswfVwiIGZpbGUiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWhpZ2hsaWdodC1mZWF0dXJlIjoiSGlnaGxpZ2h0cyB0aGUgZmVhdHVyZSBpbiB0aGUgYWN0aXZlIGhpZ2hsaWdodCBsYXllci4iLCJsYW5ndWFnZS10b29sYmFyLW1hcmt1cC1kcmF3aW5nLXRvb2xzIjoiRHJhdyIsImxhbmd1YWdlLXRvb2xiYXItZ3JvdXAtbWVhc3VyZW1lbnQiOiJNZWFzdXJlIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1zdGVwLXpvb20tb3V0IjoiWm9vbXMgb3V0IGEgc3RlcCIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tY2xlYXItc3RvcmFnZS1mb3ItYXBwbGljYXRpb24iOiJDbGVhcnMgdGhlIG9mZmxpbmUgZGF0YSBmb3IgdGhlIGN1cnJlbnQgYXBwbGljYXRpb24uIiwibGFuZ3VhZ2UtdG9vbGJhci10YXNrcy11cGxvYWQtZGF0YS10b29sdGlwIjoiVXBsb2FkIGxheWVycyBmcm9tIHlvdXIgY29tcHV0ZXIgb250byB0aGUgbWFwIiwibGFuZ3VhZ2UtbWVudS1zaG93LWNoYXJ0aW5nLXZpZXciOiJDaGFydGluZyBWaWV3IiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1jbGVhci1kZWZhdWx0LWhpZ2hsaWdodHMiOiJSZW1vdmVzIHRoZSBoaWdobGlnaHRzIGZyb20gdGhlIGRlZmF1bHQgaGlnaGxpZ2h0IGxheWVyLiIsImxhbmd1YWdlLW1lbnUtem9vbS1vdXQiOiJab29tIG91dCIsImxhbmd1YWdlLW1lbnUtbWFwdGlwLWFjdGlvbnMtZGVzYyI6Ik1hcFRpcCBBY3Rpb25zIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1ydW4td29ya2Zsb3ctd2l0aC1hcmd1bWVudHMiOiJSdW5zIGEgd29ya2Zsb3cgd2l0aCBhIHNldCBvZiBpbnB1dCBhcmd1bWVudHMuIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1jaGFuZ2UtZWRpdC1sb2ctZW50cnkiOiJDaGFuZ2UgYW4gZXhpc3RpbmcgZWRpdCBsb2cgZW50cnkuIiwibGFuZ3VhZ2UtbGF5ZXItYWN0aW9ucy10b29sdGlwIjoiQ2xpY2sgdG8gc2VlIGxheWVyIGFjdGlvbnMgYXZhaWxhYmxlIGZvciB7MH0gbGF5ZXIiLCJsYW5ndWFnZS10b29sYmFyLW1hcmt1cC1yZWN0YW5nbGUtdG9vbHRpcCI6IkRyYXcgYSByZWN0YW5nbGUgb24gdGhlIG1hcCIsImxhbmd1YWdlLXRvb2xiYXItbWFya3VwLWZyZWVoYW5kLWRlc2MiOiJIb2xkIHRoZSBtb3VzZSBidXR0b24gb3IgeW91ciBmaW5nZXJ0aXAgZG93biwgdGhlbiBkcmF3IGEgZnJlZWhhbmQgbGluZS4iLCJsYW5ndWFnZS10b29sYmFyLXNuYXBwaW5nLWRpc2FibGUiOiJEaXNhYmxlIFNuYXBwaW5nIiwibGFuZ3VhZ2UtbGF5ZXJsaXN0LWRlZmF1bHQtZm9sZGVyLXRpdGxlIjoiTGF5ZXIgTGlzdCBGb2xkZXIiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWNvbmZpcm0iOiJEaXNwbGF5cyBhIGNvbmZpcm0uIiwibGFuZ3VhZ2UtdWktdGFibGUtdW5zb3J0ZWQiOiJDb2x1bW4gaGVhZGVyLiB7MH0gLSBVbnNvcnRlZCIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tdXBkYXRlLWZlYXR1cmUiOiJVcGRhdGVzIGVpdGhlciBhIG5ldyBvciBleGlzdGluZyBmZWF0dXJlLiIsImxhbmd1YWdlLW9mZmxpbmUtcHJvZ3Jlc3Mta2lsb2J5dGVzIjoiezB9IGtCIiwibGFuZ3VhZ2UtbWVudS1idWZmZXItaWRlbnRpZnktZmVhdHVyZS1kZXNjIjoiSWRlbnRpZnkgbmVhcmJ5IGZlYXR1cmVzIiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtZWxsaXBzZS10b29sdGlwIjoiRHJhdyBhbiBlbGxpcHNlIG9uIHRoZSBtYXAiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWZzbS1jb2xsZWN0aW9uLXNldC1jb21tYW5kIjoiU2V0IHRoZSBwcmVmZXJyZWQgY29tbWFuZCB0byBvcGVuIHRoZSBmZWF0dXJlIHNldCBjb2xsZWN0aW9uIGZvciB0aGUgZ2l2ZW4gc291cmNlIG5hbWUuIiwibGFuZ3VhZ2UtdG9vbGJhci10YXNrcy1wcmludC1tYXAtdG9vbHRpcCI6IkNyZWF0ZSBhIHByaW50YWJsZSB2ZXJzaW9uIG9mIHRoZSBtYXAiLCJsYW5ndWFnZS10b29sYmFyLWdyb3VwLWFyY2dpcyI6IkFyY0dJUyIsImxhbmd1YWdlLXRvb2xiYXItbWVudS1nbG9iYWwtc2F2ZSI6IlNhdmUiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXRvZ2dsZS1kYXRhLWZyYW1lIjoiQWN0aXZhdGVzIG9yIGRlYWN0aXZhdGVzIGRhdGEgZnJhbWUuIiwibGFuZ3VhZ2Utb2ZmbGluZS1wcm9ncmVzcy1iYXNlbWFwZG93bmxvYWQtY29tcGxldGVkIjoiezB9IGRvd25sb2FkZWQuIiwibGFuZ3VhZ2UtY29tbW9uLWRlbGV0ZSI6IkRlbGV0ZSIsImxhbmd1YWdlLW1lbnUtcmVzdWx0cy1hZGQtZmVhdHVyZS1kZXNjIjoiQWRkIHRoaXMgZmVhdHVyZSB0byB0aGUgY3VycmVudCBzZXQgb2YgcmVzdWx0cyIsImxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1saW5lLXN0eWxlLWRvdCI6IkRvdCIsImxhbmd1YWdlLWNvbW1vbi1kb25lIjoiRG9uZSIsImxhbmd1YWdlLW9mZmxpbmUtcHJvZ3Jlc3MtYnl0ZXMtcGVyLXNlY29uZCI6InswfSBieXRlcy9zIiwibGFuZ3VhZ2UtdG9vbGJhci1zaG93LWxheWVybGlzdC1kZXNjIjoiRGlzcGxheSB0aGUgbGlzdCBvZiBhdmFpbGFibGUgbGF5ZXJzIiwibGFuZ3VhZ2UtbWVudS1nbG9iYWwtc2VhcmNoLWRlc2MiOiJTZWFyY2ggZm9yIGZlYXR1cmVzIG9uIHRoZSBtYXAuIiwibGFuZ3VhZ2UtbWVudS1lbnRlci1vZmZsaW5lIjoiR28gdG8gb2ZmbGluZSBtb2RlIiwibGFuZ3VhZ2UtbWVudS1jb21iaW5lLXJlc3VsdHMtaW50ZXJzZWN0LWRlc2MiOiJPbmx5IHNob3cgcmVzdWx0cyB0aGF0IGFyZSBpbiBib3RoIHlvdXIgY3VycmVudCBsaXN0IGFuZCBhIHNhdmVkIHNldCBvZiByZXN1bHRzIiwibGFuZ3VhZ2UtdG9vbGJhci10YXNrcy1zaGFyZSI6IlNoYXJlIiwibGFuZ3VhZ2UtY29udGVudC1wb2xpY3ktcHJvbXB0LXVyaS1yZWplY3QtYnRuIjoiTm8sIGRvIG5vdCBsb2FkIiwibGFuZ3VhZ2UtdG9vbGJhci1pZGVudGlmeS1wb2x5Z29uLWRlc2Mta2V5Ym9hcmQiOiJUbyBsZWFybiB3aGF0XHUyMDE5cyB0aGVyZSwgdXNlIGFycm93cyB0byBtb3ZlIHRoZSBwb2ludC4gSGl0IEVOVEVSIHRvIHBsb3QgYW5kIGJlZ2luIG1vdmluZyB0aGUgbmV4dCBwb2ludC4gSGl0IEVOVEVSIHR3aWNlIHRvIGZpbmlzaC4iLCJsYW5ndWFnZS1tZW51LXJlc3VsdHMtcmVtb3ZlLWZlYXR1cmUiOiJSZW1vdmUgZnJvbSBSZXN1bHRzIiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtdGV4dCI6IlRleHQiLCJsYW5ndWFnZS1zdGF0ZXMtc25hcHBpbmctZGVzY3JpcHRpb24iOiJTbmFwcGluZyBpcyBlbmFibGVkIGZvciB0aGUgY3VycmVudCB0b29sLiIsImxhbmd1YWdlLXRvb2xiYXItbWFya3VwLXBvaW50LWRlc2Mta2V5Ym9hcmQiOiJVc2UgYXJyb3dzIHRvIG1vdmUgdGhlIHBvaW50LiBIaXQgRU5URVIgdG8gYWRkIGl0IHRvIHRoZSBtYXAuIiwibGFuZ3VhZ2Utb2ZmbGluZS1lcnJvcnMtYnVuZGxlb2ZmaWxpbmUiOiJDYW5ub3QgY3JlYXRlIGEgYnVuZGxlIHdoaWxlIG9mZmxpbmUuIiwibGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLW5vZGF0YSI6Ik5vIHN5bWJvbGl6YWJsZSBkYXRhIHdhcyBmb3VuZCBpbiB0aGUgc2VsZWN0ZWQgYXR0cmlidXRlLiIsImxhbmd1YWdlLW1lbnUtY29tYmluZS1yZXN1bHRzLXN1YnRyYWN0IjoiU3VidHJhY3Qgc2F2ZWQgcmVzdWx0cyIsImxhbmd1YWdlLXRvb2xiYXItZ3JvdXAtZWRpdGluZyI6IkVkaXQgRHJhd2luZ3MiLCJsYW5ndWFnZS1wcm9qZWN0LWVycm9yLXRpdGxlIjoiUHJvamVjdCBFcnJvciIsImxhbmd1YWdlLWNvb3JkaW5hdGVzLXNvdXRoLWFiYnJldiI6IlMiLCJsYW5ndWFnZS1zdGF0ZXMtcGxvdGNvb3JkaW5hdGVzLXN0YXRlLWRlc2NyaXB0aW9uIjoiVGhlIFBsb3QgQ29vcmRpbmF0ZXMgdG9vbCBpcyBjdXJyZW50bHkgYWN0aXZlLiIsImxhbmd1YWdlLXJlc3VsdHMtbWVudS1kZXNjcmlwdGlvbiI6IkZlYXR1cmUgQWN0aW9ucyBmb3IgUmVzdWx0cyBMaXN0IiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1zdGVwLXpvb20taW4iOiJab29tcyBpbiBhIHN0ZXAiLCJsYW5ndWFnZS1tYXBzZXJ2aWNlLWFjdGlvbnMtdGl0bGUiOiJNYXAgU2VydmljZSBBY3Rpb25zIiwibGFuZ3VhZ2UtY29vcmRpbmF0ZXMtbm9ydGgtYWJicmV2IjoiTiIsImxhbmd1YWdlLWNvbW1vbi1zYXZpbmciOiJTYXZpbmcuLi4iLCJsYW5ndWFnZS1tZW51LWFkZC1hLWZlYXR1cmUtZGVzYyI6IkNyZWF0ZSBhIG5ldyBmZWF0dXJlIG9uIHRoaXMgbGF5ZXIuIiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtZWRpdC1kZXNjIjoiQ2xpY2sgb3IgdGFwIGFuIGV4aXN0aW5nIGRyYXdpbmcgdG8gYmVnaW4gZWRpdGluZyBpdC4iLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXRvZ2dsZS12aWV3IjoiQWN0aXZhdGVzIG9yIGRlYWN0aXZhdGVzIGEgdmlldy4iLCJsYW5ndWFnZS10b29sYmFyLWlkZW50aWZ5LWZyZWVoYW5kIjoiRnJlZWhhbmQiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXRha2UtYXBwbGljYXRpb24tb25saW5lIjoiQ29ubmVjdHMgdGhlIGFwcGxpY2F0aW9uIHRvIHRoZSBpbnRlcm5ldC4iLCJsYW5ndWFnZS10b29sYmFyLWlkZW50aWZ5LXBvbHlsaW5lIjoiTGluZSIsImxhbmd1YWdlLWNvbW1vbi1kZWFjdGl2YXRlLXRvb2wiOiJEZWFjdGl2YXRlIFRvb2wiLCJsYW5ndWFnZS10b29sYmFyLW11bHRpdG9vbCI6Ik11bHRpLXRvb2wiLCJsYW5ndWFnZS1tZW51LXNob3ctY2hhcnRpbmctdmlldy1kZXNjIjoiU3dpdGNoIHRvIGNoYXJ0aW5nIHZpZXciLCJsYW5ndWFnZS1tZW51LWxhYmVsLW9wdGlvbnMiOiJDdXN0b21pemUgbGFiZWxzIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1hZGQtdGV4dC1tYXJrdXAiOiJQcm9tcHRzIHRoZSB1c2VyIGZvciB0ZXh0IHRvIGFkZCBhcyBtYXJrdXAuIFdoZW4gY29tcGxldGVkLCB0ZXh0IG1hcmt1cCBpcyBhZGRlZCBhdCB0aGUgcHJvdmlkZWQgZ2VvbWV0cnkuIiwibGFuZ3VhZ2UtdG9vbGJhci10b2dnbGUtYnVmZmVyLW9mZi1uYW1lIjoiQnVmZmVyaW5nIE9uIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi16b29tLW91dC10by1leHRlbnQiOiJab29tcyBvdXQgdG8gdGhlIGdpdmVuIGV4dGVudC4iLCJsYW5ndWFnZS1tZW51LW1hcHRpcC1hY3Rpb25zLXZpZXctZGV0YWlscy1kZXNjIjoiVmlldyBhZGRpdGlvbmFsIGRldGFpbHMgYWJvdXQgdGhpcyBmZWF0dXJlIiwibGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLWZpbGwtc3R5bGUtdmVydGljYWwiOiJWZXJ0aWNhbCIsImxhbmd1YWdlLW1lbnUtcnVuLXdvcmtmbG93IjoiUGVyZm9ybSBhIHRhc2siLCJsYW5ndWFnZS1wYWdlLWRpc3BsYXlpbmciOiJEaXNwbGF5aW5nIiwibGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLWZpbGwtc3R5bGUtY3Jvc3MiOiJDcm9zcyIsImxhbmd1YWdlLWdyYW50LWVkaXRvci10YWJsZS1oZWFkZXItbm9uZSI6Ik5vbmUiLCJsYW5ndWFnZS1vZmZsaW5lLXByb2dyZXNzLW1lZ2FieXRlcy1wZXItc2Vjb25kIjoiezB9IE1CL3MiLCJsYW5ndWFnZS10b29sYmFyLWVkaXRpbmctbWFuYWdlLW9mZmxpbmUtZGF0YSI6Ik1hbmFnZSBPZmZsaW5lIERhdGEiLCJsYW5ndWFnZS10b29sYmFyLXRhc2tzLWFkZC1sYXllcnMtdG9vbHRpcCI6IkFkZCBsYXllcnMgdG8gdGhlIG1hcCIsImxhbmd1YWdlLXBhZ2UtZmlyc3QiOiJGaXJzdCBwYWdlIiwibGFuZ3VhZ2UtdG9vbGJhci1ncm91cC10b29scyI6IlRvb2xzIiwibGFuZ3VhZ2UtdG9vbGJhci1lZGl0aW5nLWNyZWF0ZS1uZXctZmVhdHVyZS1nZW9sb2NhdGlvbiI6IlVzZSBHZW9sb2NhdGlvbiIsImxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1icmVha3MiOiJOdW1iZXIgT2YgQ2xhc3NlczoiLCJsYW5ndWFnZS10b29sYmFyLWVkaXRpbmctZGF0YSI6IkRhdGEiLCJsYW5ndWFnZS1vZmZsaW5lLXByb2dyZXNzLXJlbW92aW5nb2ZmbGluZW1hcCI6IlJlbW92aW5nIG9mZmxpbmUgbWFwLiIsImxhbmd1YWdlLW1lbnUtY2VudGVyLW1hcCI6IkNlbnRlciB0aGUgTWFwIEhlcmUiLCJsYW5ndWFnZS1tZW51LXJlc3VsdHMtdGFibGUtYWN0aW9ucy1kZXNjIjoiUmVzdWx0cyBUYWJsZSBBY3Rpb25zIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1vcGVuLWZlYXR1cmUtc2V0LWNvbGxlY3Rpb24iOiJPcGVucyB0aGUgZmVhdHVyZSBzZXQgY29sbGVjdGlvbi4iLCJsYW5ndWFnZS1jb21tb24tbm90aWZpY2F0aW9uIjoiTm90aWZpY2F0aW9uIiwibGFuZ3VhZ2UtbGF5ZXJzZWxlY3Rvci1pY29uLXRvb2x0aXAiOiJ7MH0gaWNvbiIsImxhbmd1YWdlLXN0YXRlcy1kZWZhdWx0LWRlc2NyaXB0aW9uIjoiVGhlIHZpZXdlciBjdXJyZW50bHkgaGFzIG5vdGhpbmcgYWN0aXZlLiIsImxhbmd1YWdlLXRvb2xiYXItaWRlbnRpZnktcG9pbnQtZGVzYyI6IkNsaWNrIG9yIHRhcCBhIGxvY2F0aW9uIG9uIHRoZSBtYXAgdG8gbGVhcm4gd2hhdFx1MjAxOXMgdGhlcmUuIiwibGFuZ3VhZ2UtdG9vbGJhci1idWZmZXJpbmctZW5hYmxlIjoiRW5hYmxlIGJ1ZmZlcmluZyIsImxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1saW5lLXN0eWxlLXNob3J0ZGFzaGRvdCI6IlNob3J0LWRhc2gtZG90IiwibGFuZ3VhZ2UtdG9vbGJhci1pZGVudGlmeS1wb2x5Z29uLXRvb2x0aXAiOiJEcmF3IGEgY3VzdG9tIHNoYXBlIG9uIHRoZSBtYXAgdG8gZmluZCBvdXQgYWJvdXQgYW4gYXJlYSIsImxhbmd1YWdlLXRvb2xiYXItc2VsZWN0LWxheWVycy10b2dnbGUtb2ZmLW5hbWUiOiJMYXllcnMgYXJlIEZpbHRlcmVkIiwibGFuZ3VhZ2Utb2ZmbGluZS1wcm9ncmVzcy1jb21wbGV0ZSI6IkNvbXBsZXRlLiIsImxhbmd1YWdlLW9mZmxpbmUtcHJvZ3Jlc3Mtc3RhcnRpbmctc3luYyI6IlN0YXJ0aW5nIGZlYXR1cmUgbGF5ZXIgc3luYy4iLCJsYW5ndWFnZS1tZW51LWV4cG9ydC1yZXN1bHRzLXRvLWNzdiI6IkV4cG9ydCB0byBDU1YiLCJsYW5ndWFnZS10b29sYmFyLW1hcmt1cC1jaXJjbGUtdG9vbHRpcCI6IkRyYXcgYSBjaXJjbGUgb24gdGhlIG1hcCIsImxhbmd1YWdlLW1lbnUtb2ZmbGluZS1tYXAtZWRpdG9yLWdlb21ldHJ5LWFjdGlvbnMtcmVjdGFuZ2xlLWRlc2MiOiJEcmF3IGEgcmVjdGFuZ2xlIGZvciB0aGUgYXJlYSBvZiBpbnRlcmVzdCBnZW9tZXRyeS4iLCJsYW5ndWFnZS1tZW51LWdsb2JhbC1vcGVuLWRlc2MiOiJDaG9vc2UgYSBwcmV2aW91c2x5IHNhdmVkIHByb2plY3QgdG8gcmVzdG9yZSB0aGUgc2F2ZWQgc3RhdGUiLCJsYW5ndWFnZS1wcm9qZWN0LWVycm9yLXJlYWQiOiJUaGUgcHJvamVjdCBjb3VsZCBub3QgYmUgb3BlbmVkLiBSZWZlciB0byB0aGUgbG9nIGZvciBtb3JlIGRldGFpbHMuIiwibGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLWNvbG9yIjoiQ29sb3IiLCJsYW5ndWFnZS1jb21tb24tZmVhdHVyZS10ZW1wbGF0ZS1waWNrZXItZGVzYyI6IlNlbGVjdCBhIGZlYXR1cmUgdHlwZS4iLCJsYW5ndWFnZS10b29sYmFyLTNyZC1wYXJ0eS1tYXBzLXNob3ctbWFwcy10b29sdGlwIjoiRGlzcGxheSBsaW5rZWQgbWFwcyBpbiB0aGUgZXh0ZXJuYWwgY29tcG9uZW50IHZpZXciLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWNsZWFyLW1hcmt1cC1xdWlldCI6IkNsZWFycyBhbGwgb2YgdGhlIG1hcmt1cCBmcm9tIHRoZSBtYXJrdXAgbGF5ZXIgd2l0aG91dCBwcm9tcHRpbmcgZm9yIGNvbmZpcm1hdGlvbi4iLCJsYW5ndWFnZS1tZW51LXBsb3QtY29vcmRpbmF0ZS1kZXNjIjoiUGxvdCBhIGNvb3JkaW5hdGUgb24gdGhlIG1hcC4iLCJsYW5ndWFnZS10b29sYmFyLWJ1ZmZlcmluZy1hbHQtZW5hYmxlIjoiRW5hYmxlIGJ1ZmZlcmluZyBmb3IgYWN0aXZlIHRvb2wiLCJsYW5ndWFnZS10b29sYmFyLWlkZW50aWZ5LWxheWVycy1jaGFuZ2UiOiJJZGVudGlmaWFibGUgTGF5ZXJzIiwibGFuZ3VhZ2UtdG9vbGJhci1pZGVudGlmeS1wb2x5bGluZS10b29sdGlwIjoiRmluZCBvdXQgYWJvdXQgYW4gYXJlYSBvbiB0aGUgbWFwIGRlZmluZWQgYnkgYSBsaW5lIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1jbGVhci10ZW1wb3JhcnktbWFya3VwIjoiUmVtb3ZlcyB0ZW1wb3JhcnkgbWFya3VwIGNyZWF0ZWQgYnkgQWRkVGVtcG9yYXJ5TWFya3VwR2VvbWV0cnkuIiwibGFuZ3VhZ2UtbWVudS1jb21iaW5lLXJlc3VsdHMtZGVzYyI6IlBlcmZvcm0gYWR2YW5jZWQgb3BlcmF0aW9ucyB3aXRoIG11bHRpcGxlIGxpc3RzIG9mIHJlc3VsdHMiLCJsYW5ndWFnZS10b29sYmFyLW1hcmt1cC1yZWN0YW5nbGUiOiJSZWN0YW5nbGUiLCJsYW5ndWFnZS1vZmZsaW5lLWVycm9ycy1pc2FjdGl2ZSI6IkNhbm5vdCByZW1vdmUgdGhlIGFjdGl2ZSBvZmZsaW5lIG1hcC4iLCJsYW5ndWFnZS10b29sYmFyLXRhYi1lZGl0aW5nIjoiRWRpdGluZyIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tc2V0LWhpZ2hsaWdodC1maWxsLWNvbG9yIjoiU2V0cyB0aGUgZmlsbCBjb2xvciB1c2VkIGZvciBuZXcgaGlnaGxpZ2h0cywgc3BlY2lmaWVkIGluIDYgb3IgOCBkaWdpdCBoZXggaW4gUkdCIG9yIEFSR0IgZm9ybS4iLCJsYW5ndWFnZS10b29sYmFyLWFuYWx5c2lzLWxvY2F0aW9uLWluZm9ybWF0aW9uIjoiTG9jYXRpb24gSW5mb3JtYXRpb24iLCJsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtbGluZS1zdHlsZS1kYXNoZG90ZG90IjoiRGFzaC1kb3QtZG90IiwibGFuZ3VhZ2UtbWVudS1sYWJlbC1vcHRpb25zLXRvZ2dsZSI6IlRvZ2dsZSBsYWJlbHMiLCJsYW5ndWFnZS1ncmFudC1lZGl0b3ItbW9uaWtlci10eXBlLXJvbGUiOiJHcm91cHMiLCJsYW5ndWFnZS1vZmZsaW5lLXByb2dyZXNzLWJhc2VtYXBleHBvcnQtcHJvY2Vzc2luZyI6InswfSBnZW5lcmF0aW5nLi4uIiwibGFuZ3VhZ2UtdG9vbGJhci1uYXZpZ2F0aW9uLXpvb20taW4iOiJab29tIEluIiwibGFuZ3VhZ2UtbWVudS1yZXN1bHRzLWFkZC1mZWF0dXJlIjoiQWRkIHRvIFJlc3VsdHMiLCJsYW5ndWFnZS10b29sYmFyLWNsZWFyLWFsbCI6IkNsZWFyIiwibGFuZ3VhZ2Utb2ZmbGluZS1wcm9ncmVzcy1iYXNlbWFwZXhwb3J0LWZhaWxlZCI6InswfSBmYWlsZWQuIHsxfSIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tZmVhdHVyZS1sYXllci1jbGVhci1jYWNoZS1zcGVjIjoiU3BlY2lmeSB0aGlzIGxheWVyIGFzIG5vdCB0byBiZSBjYWNoZWQgb24gbmV4dCBzeW5jLiIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tcmVtb3ZlLWhpZ2hsaWdodC1sYXllciI6IlJlbW92ZXMgdGhlIGhpZ2hsaWdodCBsYXllciB3aXRoIHRoZSBzcGVjaWZpZWQgbmFtZSwgaWYgdGhlcmUgaXMgb25lLiIsImxhbmd1YWdlLXRvb2xiYXItYXJjZ2lzLXZpZXctbXktY29udGVudC10b29sdGlwIjoiVmlldyB5b3VyIGNvbnRlbnQgc3RvcmVkIGluIEFyY0dJUyIsImxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1tYXJrZXItc3R5bGUtZGlhbW9uZCI6IkRpYW1vbmQiLCJsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtbGluZS1zdHlsZSI6IkxpbmUgU3R5bGUiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXNob3ctbWFwLWNhbGxvdXQiOiJEaXNwbGF5cyBhIG1hcCBjYWxsb3V0IGFuY2hvcmVkIHRvIGEgZ2l2ZW4gcG9pbnQuIiwibGFuZ3VhZ2UtdG9vbGJhci10YXNrcy1wcmludGluZyI6IlByaW50aW5nIiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtZHJhd2luZyI6IkNyZWF0ZSIsImxhbmd1YWdlLWNvbnRlbnQtcG9saWN5LXByb21wdC11cmktYWNjZXB0LWJ0biI6IlllcyIsImxhbmd1YWdlLXRvb2xiYXItbWFya3VwLWNoYW5nZS1tYXJrdXAtc3R5bGUiOiJTdHlsZXMiLCJsYW5ndWFnZS10b29sYmFyLW5hdmlnYXRpb24tZnVsbC1leHRlbnQtdG9vbHRpcCI6IlJldHVybiB0byB0aGUgZnVsbCBleHRlbnQgb2YgdGhlIG1hcCIsImxhbmd1YWdlLXJlc3VsdHMtZXhwb3J0LXRvLWNvbmZpcm0tY29udGVudCI6IlRoZSBcIi57MH1cIiBmaWxlIGlzIGFib3V0IHRvIGJlIGRvd25sb2FkZWQuIENvbmZpcm0/IiwibGFuZ3VhZ2UtbWVudS1mb290ZXItbWVudS1kZXNjIjoiRm9vdGVyIE1lbnUiLCJsYW5ndWFnZS1tYXBzZXJ2aWNlLWFjdGlvbnMtZGVzYyI6IkRpc3BsYXkgYSBsaXN0IG9mIG1hcCBzZXJ2aWNlIGFjdGlvbnMiLCJsYW5ndWFnZS1tZW51LW1hcC1sYXllcnMtZXhwYW5kIjoiRXhwYW5kIGFuZCBjb2xsYXBzZSB7MH0gbGF5ZXIgZ3JvdXAiLCJsYW5ndWFnZS10b29sYmFyLW1hcmt1cC1mcmVlaGFuZC1wb2x5Z29uLXRvb2x0aXAiOiJEcmF3IGEgZnJlZWhhbmQgc2hhcGUgb24gdGhlIG1hcCIsImxhbmd1YWdlLXRvb2xiYXItbWVudS1nbG9iYWwtc2F2ZS1hcy1kZXNjIjoiU2F2ZSB0aGUgc3RhdGUgb2YgeW91ciB2aWV3ZXIgaW4gYSBuZXcgcHJvamVjdCIsImxhbmd1YWdlLW9mZmxpbmUtcHJvZ3Jlc3MtZ2lnYWJ5dGVzIjoiezB9IEdCIiwibGFuZ3VhZ2UtbWVudS16b29tLXRvLXZpc2libGUtc2NhbGUiOiJab29tIHRvIHZpc2libGUgc2NhbGUiLCJsYW5ndWFnZS1wcm9qZWN0LWVycm9yLXJlYWQtZGVuaWVkIjoiWW91IGRvIG5vdCBoYXZlIHBlcm1pc3Npb24gdG8gb3BlbiB0aGlzIHByb2plY3QuIiwibGFuZ3VhZ2UtbWVudS1hZGQtdGV4dC1kZXNjIjoiQWRkIHNvbWUgdGV4dCB0byB0aGUgbWFwLiIsImxhbmd1YWdlLW1lbnUtY29tYmluZS1yZXN1bHRzIjoiQ29tYmluZSBSZXN1bHRzIiwibGFuZ3VhZ2UtY29vcmRpbmF0ZXMtd2VzdC1hYmJyZXYiOiJXIiwibGFuZ3VhZ2UtbWVudS1ib29rbWFyay1hZGQtZGVzYyI6IkFkZCB0aGUgY3VycmVudCBtYXAgZXh0ZW50IHRvIHRoZSBsaXN0IG9mIGJvb2ttYXJrcywgc28gdGhhdCBJIGNhbiByZXR1cm4gdG8gaXQgbGF0ZXIuIiwibGFuZ3VhZ2UtdG9vbGJhci1lcmFzZSI6IkVyYXNlIiwibGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLW1hcmtlci1zdHlsZSI6Ik1hcmtlciBTdHlsZSIsImxhbmd1YWdlLXRvb2xiYXItbWFya3VwLWVsbGlwc2UtZGVzYyI6IkNsaWNrIGFuZCBkcmFnIHRvIGRyYXcgYW4gZWxsaXBzZSBvbiB0aGUgbWFwLiIsImxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1maWxsLXN0eWxlLW51bGwiOiJOb25lIiwibGFuZ3VhZ2Utc2VhcmNoLWZzYy1kaXNwbGF5LW5hbWUiOiJTZWFyY2ggUmVzdWx0czogezB9IiwibGFuZ3VhZ2Utb2ZmbGluZS1lcnJvcnMtY2FuY2VsZWQiOiJDYW5jZWxlZC4iLCJsYW5ndWFnZS1vZmZsaW5lLXByb2dyZXNzLWJhc2VtYXBkb3dubG9hZC1jb25uZWN0aW5nIjoiezB9IGNvbm5lY3RpbmcuLi4iLCJsYW5ndWFnZS1tZW51LW9mZmxpbmUtbWFwLWVkaXRvci1nZW9tZXRyeS1hY3Rpb25zLWN1cnJlbnRleHRlbnQtZGVzYyI6IlVzZSB0aGUgY3VycmVudCBleHRlbnQgZm9yIHRoZSBhcmVhIG9mIGludGVyZXN0IGdlb21ldHJ5LiIsImxhbmd1YWdlLXRvb2xiYXItc25hcHBpbmctc2VsZWN0LWxheWVycyI6IlNlbGVjdCBTbmFwcGluZyBMYXllcnMiLCJsYW5ndWFnZS1tZW51LXNob3ctcmVzdWx0cy1saXN0LWRlc2MiOiJTd2l0Y2ggdG8gTGlzdCBWaWV3IiwibGFuZ3VhZ2UtdG9vbGJhci1ncm91cC1maW5kLWRhdGEtdG9vbHMiOiJGaW5kIiwibGFuZ3VhZ2UtdG9vbGJhci1uYXZpZ2F0aW9uLXpvb20taW4tdG9vbHRpcCI6IkRyYXcgYW4gYXJlYSBvbiB0aGUgbWFwIHRvIHpvb20gdG8iLCJsYW5ndWFnZS10b29sYmFyLWlkZW50aWZ5LXBvaW50LWRlc2Mta2V5Ym9hcmQiOiJVc2UgYXJyb3dzIHRvIG1vdmUgdGhlIHBvaW50LiBIaXQgRU5URVIgdG8gbGVhcm4gd2hhdFx1MjAxOXMgdGhlcmUuIiwibGFuZ3VhZ2UtdG9vbGJhci1pZGVudGlmeS1mcmVlaGFuZC1wb2x5Z29uIjoiRnJlZWhhbmQgU2hhcGUgSWRlbnRpZnkiLCJsYW5ndWFnZS1yZXN1bHRzLXBhZ2UiOiJQYWdlIiwibGFuZ3VhZ2UtbWVudS1jb21iaW5lLXJlc3VsdHMtdW5pb24tZGVzYyI6IkNvbWJpbmUgYSBzYXZlZCBzZXQgb2YgcmVzdWx0cyB3aXRoIHlvdXIgY3VycmVudCByZXN1bHRzIGxpc3QiLCJsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtbGluZS13aWR0aCI6IkxpbmUgV2lkdGgiLCJsYW5ndWFnZS10b29sYmFyLWdyb3VwLWVkaXQiOiJFZGl0IiwibGFuZ3VhZ2UtbGF5ZXJsaXN0LXVzZXItYWRkZWQtbGF5ZXJzLWZvbGRlci10aXRsZSI6IlVzZXIgQWRkZWQgTGF5ZXJzIiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtcG9seWxpbmUtdG9vbHRpcCI6IkRyYXcgYSBsaW5lIG9uIHRoZSBtYXAiLCJsYW5ndWFnZS1tZW51LXJlbW92ZS11c2VyLWFkZGVkLWxheWVyIjoiUmVtb3ZlIGxheWVyIiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtY2lyY2xlIjoiQ2lyY2xlIiwibGFuZ3VhZ2Utb2ZmbGluZS1wcm9ncmVzcy1tZWdhYnl0ZXMiOiJ7MH0gTUIiLCJsYW5ndWFnZS1zbWFydC1wYW5lbC1tYXhpbWl6ZS1yZXN0b3JlIjoiTWF4aW1pemUvUmVzdG9yZSBQYW5lbCIsImxhbmd1YWdlLXRvb2xiYXItZWRpdGluZy10b29scyI6IkVkaXQgRmVhdHVyZXMiLCJsYW5ndWFnZS1tZW51LXJ1bi1yZXBvcnQiOiJSdW4gYSBSZXBvcnQiLCJsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtdHJhbnNwYXJlbmN5IjoiVHJhbnNwYXJlbmN5IiwibGFuZ3VhZ2UtdG9vbGJhci10aW1lc2xpZGVyLXNob3d0aW1lc2xpZGVyIjoiVGltZSBTbGlkZXIiLCJsYW5ndWFnZS1vZmZsaW5lLXByb2dyZXNzLXNhdmluZ29mZmxpbmVtYXAiOiJTYXZpbmcgb2ZmbGluZSBtYXAuIiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtZGVsZXRlLXRvb2x0aXAiOiJEZWxldGUgYW4gZXhpc3RpbmcgZHJhd2luZyIsImxhbmd1YWdlLWdyYW50LWVkaXRvci10YWJsZS1oZWFkZXItdmlldyI6IlZpZXciLCJsYW5ndWFnZS1jb21tb24tZmVhdHVyZS10ZW1wbGF0ZS1waWNrZXIiOiJDcmVhdGUgTmV3IEZlYXR1cmUiLCJsYW5ndWFnZS1tYXBzZXJ2aWNlLWFjdGlvbnMiOiJQZXJmb3JtIGFuIGFjdGlvbiBvbiB7MH0iLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWluaXRpYWxpemUtc2l0ZSI6IlRlbGxzIHRoZSBHZW9jb3J0ZXggRXNzZW50aWFscyBTaXRlIG9iamVjdCB0byBiZWdpbiBpbml0aWFsaXphdGlvbi4iLCJsYW5ndWFnZS1tZW51LWxhYmVsLW9wdGlvbnMtdG9nZ2xlLWRlc2MiOiJUdXJuIHRoZSBsYXllcidzIGxhYmVscyBvbiBvciBvZmYuIiwibGFuZ3VhZ2UtdG9vbGJhci1pZGVudGlmeS1mcmVlaGFuZC1wb2x5Z29uLXRvb2x0aXAiOiJJZGVudGlmeSB0aGluZ3Mgb24gdGhlIG1hcCBieSBkcmF3aW5nIGEgZnJlZWhhbmQgc2hhcGUiLCJsYW5ndWFnZS10b29sYmFyLW5hdGl2ZS1zaG93b2ZmbGluZW1hcHMiOiJPZmZsaW5lIE1hcHMiLCJsYW5ndWFnZS1tZW51LXJ1bi13b3JrZmxvdy1kZXNjIjoiU2VsZWN0IGZyb20gYSBsaXN0IG9mIGF2YWlsYWJsZSB0YXNrcy4iLCJsYW5ndWFnZS10b29sYmFyLWdyb3VwLWxheWVycyI6IkxheWVycyIsImxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1saW5lLXN0eWxlLXNob3J0ZGFzaGRvdGRvdCI6IlNob3J0LWRhc2gtZG90LWRvdCIsImxhbmd1YWdlLW1lbnUtYnVmZmVyLWlkZW50aWZ5LWZlYXR1cmUiOiJTaG93IEJ1ZmZlciBPcHRpb25zIiwibGFuZ3VhZ2UtcHJvamVjdC1lcnJvci13cml0ZS1kZW5pZWQiOiJZb3UgZG8gbm90IGhhdmUgcGVybWlzc2lvbiB0byBzYXZlIHRoaXMgcHJvamVjdC4iLCJsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtbGluZS1zdHlsZS1zaG9ydGRhc2giOiJTaG9ydC1kYXNoIiwibGFuZ3VhZ2UtdG9vbGJhci1vcGVuLXRvb2xiYXIiOiJPcGVuIHRvb2xiYXIiLCJsYW5ndWFnZS1vZmZsaW5lLWVycm9ycy1sb2FkZmFpbGVkIjoiVW5hYmxlIHRvIGxvYWQuIiwibGFuZ3VhZ2UtdG9vbGJhci10YWItbWFwIjoiTWFwIiwibGFuZ3VhZ2UtdG9vbGJhci1pZGVudGlmeS1mcmVlaGFuZC1kZXNjIjoiQ2xpY2svdGFwIGFuZCBob2xkIGRvd24sIHRoZW4gZHJhdyBhIGZyZWVoYW5kIHNoYXBlIHRvIGxlYXJuIHdoYXRcdTIwMTlzIHRoZXJlLiIsImxhbmd1YWdlLW1lbnUtc3dpdGNoLXRvLWxheWVybGlzdC1kZXNjIjoiRGlzcGxheSB0aGUgbGlzdCBvZiBhdmFpbGFibGUgbGF5ZXJzIiwibGFuZ3VhZ2UtdG9vbGJhci1uYXZpZ2F0aW9uIjoiTmF2aWdhdGlvbiIsImxhbmd1YWdlLXByb2plY3QtZXJyb3ItcmVhZC1ub3QtZm91bmQiOiJDb3VsZCBub3QgZmluZCBhIHByb2plY3Qgd2l0aCBJRCBcInswfVwiLiIsImxhbmd1YWdlLXRvb2xiYXItbWVudS1nbG9iYWwtb3BlbiI6Ik9wZW4iLCJsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtbGluZS1zdHlsZS1sb25nZGFzaGRvdCI6IkxvbmctZGFzaC1kb3QiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWRlbGV0ZS1mZWF0dXJlIjoiRGVsZXRlcyBlaXRoZXIgYSBuZXcgb3IgZXhpc3RpbmcgZmVhdHVyZS4iLCJsYW5ndWFnZS10b29sYmFyLW5hdmlnYXRpb24tZnVsbC1leHRlbnQiOiJGdWxsIEV4dGVudCIsImxhbmd1YWdlLXRvb2xiYXItdGFza3MtcHJpbnQtbWFwIjoiUHJpbnQiLCJsYW5ndWFnZS1zZWNvbmRzLWFiYnIiOiJTIiwibGFuZ3VhZ2UtdG9vbGJhci1ncm91cC1lZGl0LWZlYXR1cmVzIjoiRWRpdCBGZWF0dXJlcyIsImxhbmd1YWdlLWxheWVybGlzdC1vcGVyYXRpb25hbC1tYXBzLWZvbGRlci10aXRsZSI6Ik9wZXJhdGlvbmFsIExheWVycyIsImxhbmd1YWdlLXRvb2xiYXItdGFza3MtaWRlbnRpZnktdG9vbHRpcCI6IkZpbmQgZGF0YSBvbiB0aGUgbWFwIiwibGFuZ3VhZ2UtbWVudS1nbG9iYWwtc2VhcmNoIjoiU2VhcmNoIiwibGFuZ3VhZ2UtdG9vbGJhci1hcmNnaXMtZXhwb3J0LXdlYi1tYXAiOiJTYXZlIHRvIEFyY0dJUyIsImxhbmd1YWdlLWNvbW1vbi1yZXN1bHRzLXVuaW9uLWNvbmZpcm1hdGlvbiI6Iid7MH0nIHVuaW9uZWQgd2l0aCB7MX0iLCJsYW5ndWFnZS1tZW51LXByb2plY3QtYWN0aW9ucy1kZXNjIjoiVmlldyBvcHRpb25zIHJlbGF0ZWQgdG8gdGhlIHByb2plY3QuIiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtcG9seWdvbi1kZXNjIjoiQ2xpY2sgb3IgdGFwIGxvY2F0aW9ucyB0byBkZWZpbmUgYSBwb2x5Z29uLiBEb3VibGUtY2xpY2svdGFwIHRvIGZpbmlzaC4iLCJsYW5ndWFnZS1yZXN1bHRzLXBhZ2Utb2YiOiJvZiIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24taWRlbnRpZnkiOiJFeGVjdXRlcyBhbiBpZGVudGlmeSBvcGVyYXRpb24gb24gYSBnZW9tZXRyeS4iLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWFkZC10ZW1wb3JhcnktbWFya3VwLWdlb21ldHJ5IjoiQWRkcyBhIHRlbXBvcmFyeSBtYXJrdXAgZ3JhcGhpYyB0byB0aGUgbWFwLiBUaGUgQ2xlYXJUZW1wb3JhcnlNYXJrdXAgY29tbWFuZCB3aWxsIGNsZWFyIHRoaXMgbWFya3VwLiIsImxhbmd1YWdlLWNvbW1vbi1jbG9zZSI6IkNsb3NlIiwibGFuZ3VhZ2UtdG9vbGJhci1zbmFwcGluZy1lbmFibGUiOiJFbmFibGUgU25hcHBpbmciLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWNsb3NlLXJlc3VsdHMtZnJhbWUiOiJEZWFjdGl2YXRlcyB0aGUgUmVzdWx0c1JlZ2lvbi4iLCJsYW5ndWFnZS1tZW51LWlkZW50aWZ5LWJ1ZmZlcmVkLWZlYXR1cmUtc2V0LWNvbGxlY3Rpb24tZGVzYyI6IklkZW50aWZ5IGZlYXR1cmVzIG5lYXIgdGhlc2UgcmVzdWx0cyIsImxhbmd1YWdlLXRvb2xiYXItZ3JvdXAtM3JkLXBhcnR5LW1hcHMiOiJMaW5rZWQgTWFwcyIsImxhbmd1YWdlLXN0YXRlcy1mZWF0dXJlLWVkaXRpbmctc3RhdGUtZ3JhcGhpYy1kZXNjcmlwdGlvbiI6IlRoZSBjcmVhdGUgYSBmZWF0dXJlIHRvb2wgaXMgY3VycmVudGx5IGVkaXRpbmcgYSBncmFwaGljLiIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tYWN0aXZhdGUtdmlldyI6IkFjdGl2YXRlcyBhIHZpZXcuIiwibGFuZ3VhZ2UtcmVzdWx0cy10b2dnbGUtdGFibGUtdmlldyI6IlN3aXRjaCB0byBUYWJsZSIsImxhbmd1YWdlLXJlc3VsdHMtdG9nZ2xlLWxpc3Qtdmlldy1kZXNjIjoiVmlldyByZXN1bHRzIGluIGxpc3QgZm9ybWF0IiwibGFuZ3VhZ2UtbWVudS16b29tLXRvLWxheWVyLWRlc2MiOiJab29tIHRoZSBtYXAgdG8gdGhlIGZ1bGwgZXh0ZW50IG9mIHRoZSBsYXllci4iLCJsYW5ndWFnZS10b29sYmFyLXRhYi1vZmZsaW5lIjoiT2ZmbGluZSIsImxhbmd1YWdlLXRvb2xiYXItbWVudS1nbG9iYWwtc2F2ZS1kZXNjIjoiU2F2ZSB0aGUgc3RhdGUgb2YgeW91ciB2aWV3ZXIgaW4gYSBwcm9qZWN0IiwibGFuZ3VhZ2UtbWVudS1zaG93LXJlc3VsdHMtdGFibGUtZGVzYyI6IlN3aXRjaCB0byBUYWJsZSBWaWV3IiwibGFuZ3VhZ2UtdG9vbGJhci1tZW51LWdsb2JhbC1zYXZlLWFzIjoiU2F2ZSBhcyIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tdXBkYXRlLWF0dGFjaG1lbnQiOiJVcGRhdGVzIGEgZmVhdHVyZSBhdHRhY2htZW50LiIsImxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1saW5lLXN0eWxlLWRhc2hkb3QiOiJEYXNoLWRvdCIsImxhbmd1YWdlLWNvbW1vbi1yZXN1bHRzLXJlcGxhY2UtY29uZmlybWF0aW9uIjoiJ3swfScgcmVwbGFjZWQgd2l0aCB7MX0iLCJsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtbWFya2VyLXNpemUiOiJNYXJrZXIgU2l6ZSIsImxhbmd1YWdlLW1lbnUtaWRlbnRpZnktcG9pbnQiOiJJZGVudGlmeSBieSBwb2ludCIsImxhbmd1YWdlLXRvb2xiYXItdGFiLWhvbWUiOiJIb21lIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1yZW1vdmUtc3RhdHVzIjoiUmVtb3ZlcyB0aGUgc3RhdHVzIGluZGljYXRvciBmcm9tIHRoZSBzY3JlZW4gd2l0aCB0aGUgc3BlY2lmaWVkIElELiIsImxhbmd1YWdlLW1lbnUtZXhwb3J0LXJlc3VsdHMtdG8teGxzeC1kZXNjIjoiRXhwb3J0IHJlc3VsdHMgdG8gWExTWCIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tdG9nZ2xlLXJlc3VsdHMtZnJhbWUiOiJBY3RpdmF0ZXMgb3IgZGVhY3RpdmF0ZXMgUmVzdWx0cyBmcmFtZS4iLCJsYW5ndWFnZS10b29sYmFyLW1hcmt1cC1lZGl0LXRvb2x0aXAiOiJFZGl0IGFuIGV4aXN0aW5nIGRyYXdpbmciLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXJlbW92ZS1mZWF0dXJlLXNldC1jb2xsZWN0aW9uLWJ5LWlkIjoiUmVtb3ZlcyB0aGUgc3BlY2lmaWVkIGNvbGxlY3Rpb24gZnJvbSB0aGUgZmVhdHVyZSBzZXQgbWFuYWdlci4iLCJsYW5ndWFnZS1sYXllcnNlbGVjdG9yLXN0YXRlLXRvZ2dsZSI6IlRvZ2dsZSB7MH0gbGF5ZXIgdmlzaWJpbGl0eS4iLCJsYW5ndWFnZS10b29sYmFyLW5hdmlnYXRpb24taG9tZSI6IkhvbWUiLCJsYW5ndWFnZS1tZW51LWlkZW50aWZ5LWRlc2MiOiJDbGljaywgdGFwLCBvciBkcmF3IGEgcmVjdGFuZ2xlIG9uIHRoZSBtYXAgdG8gaWRlbnRpZnkgZmVhdHVyZXMuIiwibGFuZ3VhZ2UtbGF5ZXItYWN0aW9ucy1kZXNjIjoiRGlzcGxheSBhIGxpc3Qgb2YgbGF5ZXIgYWN0aW9ucyIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tcnVuLXdvcmtmbG93LXdpdGgtZ2VvbWV0cnkiOiJSdW5zIGEgd29ya2Zsb3cgd2l0aCBhIGdlb21ldHJ5IHVzZWQgYXMgYW4gaW5wdXQgYXJndW1lbnQuIiwibGFuZ3VhZ2UtdG9vbGJhci1uYXZpZ2F0aW9uLWluaXRpYWwtZXh0ZW50LXRvb2x0aXAiOiJSZXR1cm4gdG8gdGhlIGluaXRpYWwgcG9zaXRpb24gb2YgdGhlIG1hcCIsImxhbmd1YWdlLWNvb3JkaW5hdGVzLWRlZ3JlZXMiOiLCsCIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tc2hvdy1mZWF0dXJlLWxheWVyLW1vZGFsLW1lc3NhZ2UiOiJDcmVhdGVzIGEgTW9kZWxNZXNzYWdlVmlldyB2aWV3IGFuZCBkaXNwbGF5cyB0aGUgZ2l2ZW4gbWVzc2FnZS4iLCJsYW5ndWFnZS1ncmFudC1lZGl0b3ItdGFibGUtaGVhZGVyLWVkaXQiOiJFZGl0IiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtZWRpdCI6IkVkaXQiLCJsYW5ndWFnZS1tZW51LW9mZmxpbmUtbWFwLWVkaXRvci1nZW9tZXRyeS1hY3Rpb25zLWNsZWFyIjoiQ2xlYXIiLCJsYW5ndWFnZS10b29sYmFyLXRhc2tzLXNoYXJlLXRvb2x0aXAiOiJTaGFyZSB0aGUgY3VycmVudCBtYXAgb24gdGhlIG1vc3QgY29tbW9uIHNvY2lhbCBtZWRpYSIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tc2V0LWVkaXRvci1mZWF0dXJlLWdlb21ldHJ5IjoiU2V0cyB0aGUgZ2VvbWV0cnkgb2YgdGhlIGZlYXR1cmUgdGhhdCBpcyBjdXJyZW50bHkgYmVpbmcgZWRpdGVkIGluIHRoZSBBdHRyaWJ1dGUgRWRpdG9yLCBhbmQgYWN0aXZhdGVzIHRoZSBBdHRyaWJ1dGVFZGl0b3IgVmlldy4iLCJsYW5ndWFnZS10b29sYmFyLXRpbWVzbGlkZXItc2hvd3RpbWVzbGlkZXItdG9vbHRpcCI6IkFjdGl2YXRlIHRoZSB0aW1lIHNsaWRlciIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tcGFuLXRvLWZlYXR1cmUiOiJQYW5zIHRvIHRoZSBHZW9jb3J0ZXggZmVhdHVyZS4iLCJsYW5ndWFnZS1tZW51LXZpc3VhbGl6YXRpb24iOiJUdXJuIG9uL29mZiBsYXllciB2aXN1YWxpemF0aW9ucyIsImxhbmd1YWdlLXRvb2xiYXItbWFya3VwLWZyZWVoYW5kLXBvbHlnb24tZGVzYyI6IkhvbGQgdGhlIG1vdXNlIGJ1dHRvbiBvciB5b3VyIGZpbmdlcnRpcCBkb3duLCB0aGVuIGRyYXcgYSBmcmVlaGFuZCBzaGFwZS4iLCJsYW5ndWFnZS1vZmZsaW5lLWVycm9ycy1idW5kbGVub3Rmb3VuZCI6IkJ1bmRsZSBub3QgZm91bmQuIiwibGFuZ3VhZ2UtY29tbW9uLXBhbi1kZXNjcmlwdGlvbiI6IlBhbiB0aGUgbWFwIHRvIGNlbnRlciB0aGlzIGZlYXR1cmUiLCJsYW5ndWFnZS1tZW51LW1hcHRpcC1hY3Rpb25zLXZpZXctZGV0YWlscyI6IlZpZXcgQWRkaXRpb25hbCBEZXRhaWxzIiwibGFuZ3VhZ2UtdG9vbGJhci1uYXZpZ2F0aW9uLXByZXZpb3VzLWV4dGVudCI6IlByZXZpb3VzIEV4dGVudCIsImxhbmd1YWdlLXRvb2xiYXItZ3JvdXAtbWVhc3VyZW1lbnQtdG9vbHMiOiJNZWFzdXJlIiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtcG9seWdvbi10b29sdGlwIjoiRHJhdyBhIGN1c3RvbSBzaGFwZSBvbiB0aGUgbWFwIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1kaXNwbGF5LXdvcmtmbG93LWNvbnRhaW5lci1jb250ZW50IjoiRGlzcGxheXMgYSB2aWV3IGluIGEgd29ya2Zsb3cgY29udGFpbmVyLiIsImxhbmd1YWdlLXRvb2xiYXItbWFya3VwLWVkaXQtZGVzYy1rZXlib2FyZCI6IlVzZSBhcnJvd3MgdG8gbW92ZSB0aGUgcG9pbnQuIEhpdCBFTlRFUiB0byBiZWdpbiBlZGl0aW5nIGFuIGV4aXN0aW5nIGRyYXdpbmcuIiwibGFuZ3VhZ2UtbWVudS1sYXRpdHVkZS1nZW9ncmFwaGljcy1kZXNjIjoiTGF0aXR1ZGUgR2VvZ3JhcGhpY3MgR3JvdXAgTHRkLiIsImxhbmd1YWdlLXRvb2xiYXItbWFya3VwLXBvaW50IjoiUG9pbnQiLCJsYW5ndWFnZS1jb29yZGluYXRlcy1lYXN0LWFiYnJldiI6IkUiLCJsYW5ndWFnZS1vZmZsaW5lLXByb2dyZXNzLWJhc2VtYXBkb3dubG9hZC1jYW5jZWxlZCI6InswfSBjYW5jZWxlZC4iLCJsYW5ndWFnZS1sYXllcnNlbGVjdG9yLWl0ZW0tZXhwYW5kIjoiQ29sbGFwc2Ugb3IgZXhwYW5kIHswfSBsYXllciBncm91cCIsImxhbmd1YWdlLXRvb2xiYXItYnVmZmVyLXRvZ2dsZS10b29sdGlwIjoiQnVmZmVyIGFuIGFyZWEgYXJvdW5kIHlvdXIgc2VsZWN0aW9uIiwibGFuZ3VhZ2UtbWVudS1nbG9iYWwtc2F2ZS1hcyI6IlNhdmUgYXMiLCJsYW5ndWFnZS10b29sYmFyLW1hcmt1cC1jaXJjbGUtZGVzYyI6IkRyYWcgYSBjaXJjbGUgb24gdG8gdGhlIG1hcCIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24taGlkZS1mZWF0dXJlLWxheWVyLW1vZGFsLW1lc3NhZ2UiOiJSZW1vdmVzIGEgbW9kYWwgbWVzc2FnZS4iLCJsYW5ndWFnZS1jb21tb24tc3luYy1jb21wbGV0ZSI6IlN5bmNocm9uaXphdGlvbiBjb21wbGV0ZSIsImxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1saW5lLXdpZHRoLXN1ZmZpeCI6InB4IiwibGFuZ3VhZ2UtbWVudS1pZGVudGlmeS1mcmVlaGFuZC1kZXNjIjoiRHJhdyBhIHNoYXBlIHRvIHZpZXcgaW5mb3JtYXRpb24gYWJvdXQgdGhhdCBhcmVhLiIsImxhbmd1YWdlLXRvb2xiYXItbWFya3VwLXBhbGV0dGUtc21hbGwtZWRpdCI6IkVkaXQiLCJsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtZmlsbC1zdHlsZS1iYWNrd2FyZC1kaWFnb25hbCI6IkJhY2t3YXJkIERpYWdvbmFsIiwibGFuZ3VhZ2UtbWVudS1zaG93LXJlc3VsdHMtdGFibGUiOiJUYWJsZSBWaWV3IiwibGFuZ3VhZ2UtbWVudS1nbG9iYWwtc2F2ZSI6IlNhdmUiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXNob3ctZmVhdHVyZS1kZXRhaWxzIjoiQ3JlYXRlcyBhbmQgZGlzcGxheXMgdGhlIEZlYXR1cmUgRGV0YWlscyBkaWFsb2cgZm9yIHRoZSBmZWF0dXJlIG9yIGZlYXR1cmUgc2V0IGNvbGxlY3Rpb24gc3BlY2lmaWVkLiIsImxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1leGNlZWRlZC1tYXgtY2xhc3NlcyI6Ik1vcmUgdGhhbiB7MH0gdW5pcXVlIHZhbHVlcyBmb3VuZC4gVGhlIHRvcCB7MH0gaGF2ZSBiZWVuIHVzZWQgdG8gY3JlYXRlIHRoZSByZW5kZXJlci4iLCJsYW5ndWFnZS1tZW51LWFkZC10ZXh0IjoiQWRkIFNvbWUgVGV4dCIsImxhbmd1YWdlLW9mZmxpbmUtZXJyb3JzLXNhdmVmYWlsZWQiOiJVbmFibGUgdG8gc2F2ZS4iLCJsYW5ndWFnZS10b29sYmFyLW5hdmlnYXRpb24tbmV4dC1leHRlbnQiOiJOZXh0IEV4dGVudCIsImxhbmd1YWdlLWNvbnRlbnQtcG9saWN5LXByb21wdC11cmktZGVzYyI6IlRoZSBhcHBsaWNhdGlvbiBpcyBhdHRlbXB0aW5nIHRvIGxvYWQgY29udGVudCBmcm9tICd7MH0nLiBEbyB5b3UgcmVjb2duaXplIGFuZCB0cnVzdCB0aGlzIFVSTD8iLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWdlb2xvY2F0ZSI6Ilpvb21zIHRvIHRoZSBjdXJyZW50IGxvY2F0aW9uIG9mIHRoZSBkZXZpY2UuIiwibGFuZ3VhZ2UtdG9vbGJhci1ncm91cC1uYXZpZ2F0aW9uIjoiTmF2aWdhdGlvbiIsImxhbmd1YWdlLXRvb2xiYXItbWFya3VwLWNsZWFyIjoiQ2xlYXIiLCJsYW5ndWFnZS1zdGF0ZXMtaWRlbnRpZnktc3RhdGUtZGVzY3JpcHRpb24iOiJUaGUgaWRlbnRpZnkgdG9vbCBpcyBjdXJyZW50bHkgYWN0aXZlLiIsImxhbmd1YWdlLW1lbnUtZW50ZXItb2ZmbGluZS1kZXNjIjoiR28gdG8gb2ZmbGluZSBtb2RlIGFuZCB2aWV3IGNhY2hlZCBtYXAgZGF0YS4iLCJsYW5ndWFnZS1tZW51LXpvb20taW5pdGlhbC1leHRlbnQtZGVzYyI6IlJldHVybiB0byB0aGUgaW5pdGlhbCBtYXAgcG9zaXRpb24gYW5kIHpvb20gbGV2ZWwuIiwibGFuZ3VhZ2UtY29tbW9uLXF1ZXJ5LXJlc3VsdHMiOiJRdWVyeSBSZXN1bHRzIiwibGFuZ3VhZ2UtdG9vbGJhci10YXNrcy1leHBvcnQtbWFwLXRvb2x0aXAiOiJTYXZlIGEgbWFwIGltYWdlIiwibGFuZ3VhZ2UtZnJhbWV3b3JrLXVpLXZpZXctY29udGFpbmVyLXZpZXctY2xvc2UiOiJDbG9zZSB7MH0iLCJsYW5ndWFnZS10b29sYmFyLW1hcmt1cC1mcmVlaGFuZC10b29sdGlwIjoiRHJhdyBhIGZyZWVoYW5kIGxpbmUgb24gdGhlIG1hcCIsImxhbmd1YWdlLXRvb2xiYXItbWVudS1nbG9iYWwtb3Blbi1kZXNjIjoiQ2hvb3NlIGEgcHJldmlvdXNseSBzYXZlZCBwcm9qZWN0IHRvIHJlc3RvcmUgdGhlIHNhdmVkIHN0YXRlIiwibGFuZ3VhZ2UtdG9vbGJhci1pZGVudGlmeS1sYXllcnMtY2hhbmdlLXRvb2x0aXAiOiJFbmFibGUvRGlzYWJsZSBsYXllcnMgc2VsZWN0ZWQgZm9yIGlkZW50aWZ5IG9wZXJhdGlvbnMiLCJsYW5ndWFnZS1tZW51LW9mZmxpbmUtbWFwLWVkaXRvci1nZW9tZXRyeS1hY3Rpb25zLWNsZWFyLWRlc2MiOiJDbGVhciB0aGUgYXJlYSBvZiBpbnRlcmVzdCBnZW9tZXRyeS4iLCJsYW5ndWFnZS1yZXN1bHRzLWV4cG9ydC10by1hbGVydC1lcnJvci1tZXNzYWdlIjoiRXJyb3IgZXhwb3J0aW5nIHRvIFwiLnswfVwiIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1tYXAtcmVzaXplIjoiVGVsbHMgdGhlIG1hcCBjb250cm9sIHRvIHJlc2l6ZSBpdHNlbGYuIFRoaXMgc2hvdWxkIGJlIGNhbGxlZCBhZnRlciBhbHRlcmluZyB0aGUgbWFwIGNvbnRhaW5lcidzIGRpbWVuc2lvbnMuIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1jbGVhci1zdG9yYWdlLWZvci1kb21haW4iOiJDbGVhcnMgYWxsIG9mZmxpbmUgZGF0YSBmb3IgdGhlIGN1cnJlbnQgZG9tYWluLiBUaGlzIGluY2x1ZGVzIGRhdGEgZm9yIGFsbCBhcHBsaWNhdGlvbnMgbG9hZGVkIGZyb20gdGhlIGN1cnJlbnQgZG9tYWluLiIsImxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy10cmFuc3BhcmVuY3ktc3VmZml4IjoiJSIsImxhbmd1YWdlLWNvbW1vbi1wYW4iOiJQYW4iLCJsYW5ndWFnZS1tZW51LW9mZmxpbmUtbWFwLWVkaXRvci1nZW9tZXRyeS1hY3Rpb25zLWZyZWVoYW5kcG9seWdvbi1kZXNjIjoiRHJhdyBhIGZyZWVoYW5kIHBvbHlnb24gZm9yIHRoZSBhcmVhIG9mIGludGVyZXN0IGdlb21ldHJ5LiIsImxhbmd1YWdlLW9mZmxpbmUtcHJvZ3Jlc3Mtc3RhcnRpbmctYmFzZW1hcC1kb3dubG9hZCI6IlN0YXJ0aW5nIGJhc2VtYXAgZG93bmxvYWRzLiIsImxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1saW5lLXN0eWxlLW51bGwiOiJOb25lIiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtZWRpdC16b29taW4tdG9vbCI6Ilpvb21JblRvb2wiLCJsYW5ndWFnZS1zdGF0ZXMtZHJhdy1tYXJrdXAtc3RhdGUtZGVzY3JpcHRpb24iOiJUaGUgZHJhdyB0b29sIGlzIGN1cnJlbnRseSBhY3RpdmUuIiwibGFuZ3VhZ2UtdG9vbGJhci1pZGVudGlmeS1wb2x5Z29uIjoiUG9seWdvbiIsImxhbmd1YWdlLWNvbW1vbi1kZWJ1Zy1sb2cta2V5cyI6IlRvIHZpZXcgdGhlIGxvZyBvbiBhIGRlc2t0b3AgbWFjaGluZSwgcHJlc3MgQ3RybCArIFNoaWZ0ICsgfi4gT24gYSBtb2JpbGUgZGV2aWNlLCBwcmVzcyBhbmQgaG9sZCB0aGUgdG9vbGJhci4iLCJsYW5ndWFnZS1jb21tb24tdmlldy1sb2ciOiJWaWV3IExvZyIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tYWN0aXZhdGUtY29udGFpbmVycy1mb3Itd29ya2Zsb3ciOiJBY3RpdmF0ZXMgYW55IHdvcmtmbG93IGNvbnRhaW5lciB2aWV3cyBhc3NvY2lhdGVkIHdpdGggYSBnaXZlbiB3b3JrZmxvdy4iLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXNldC1lZGl0LWxvZyI6IlNldHMgdGhlIGVkaXQgbG9nLCBwYXNzaW5nIGl0IGludG8gYSBjYWxsYmFjay4gSWYgYW4gZXJyb3Igb2NjdXJzLCB0aGUgZXJyb3IgaXMgcGFzc2VkIGludG8gdGhlIGNhbGxiYWNrLiIsImxhbmd1YWdlLXRvb2xiYXItbmF2aWdhdGlvbi1pbml0aWFsLWV4dGVudCI6IkluaXRpYWwgVmlldyIsImxhbmd1YWdlLWNvbW1vbi1zaG93IjoiU2hvdyIsImxhbmd1YWdlLWNvbW1vbi1leHRyYWN0LWRhdGEiOiJFeHRyYWN0IERhdGEiLCJsYW5ndWFnZS1yZXN1bHRzLXRvZ2dsZS1saXN0LXZpZXciOiJTd2l0Y2ggdG8gTGlzdCIsImxhbmd1YWdlLXRhYi1zY3JvbGwtcHJldiI6IlByZXZpb3VzIExheWVyIiwibGFuZ3VhZ2UtY29tbW9uLXJlc3VsdHMtaW50ZXJzZWN0LWNvbmZpcm1hdGlvbiI6Iid7MH0nIGludGVyc2VjdGVkIHdpdGggezF9IiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtcG9seWxpbmUiOiJMaW5lIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1zaG93LW1hcC1lbGVtZW50IjoiRGlzcGxheXMgYW4gZWxlbWVudCBhbmNob3JlZCB0byBhIHNwZWNpZmljIHBvaW50IG9uIHRoZSBtYXAuIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1yZWNlbnRlci1tYXAtb24tbmV4dC1tYXAtcmVzaXplIjoiUmVjZW50ZXJzIHRoZSBtYXAgdG8gaXRzIGV4aXN0aW5nIHBvc2l0aW9uIHRoZSBuZXh0IHRpbWUgdGhlIG1hcCBpcyByZXNpemVkLiIsImxhbmd1YWdlLXRvb2xiYXItbWFya3VwLXRleHQtZGVzYyI6IkNsaWNrIGEgbG9jYXRpb24gd2hlcmUgeW91IHdhbnQgdG8gYWRkIHRleHQgb24gdGhlIG1hcC4iLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWNyZWF0ZS1hdHRhY2htZW50IjoiQ3JlYXRlcyBhIGZlYXR1cmUgYXR0YWNobWVudC4iLCJsYW5ndWFnZS10b29sYmFyLWdyb3VwLXRhc2tzIjoiVGFza3MiLCJsYW5ndWFnZS10b29sYmFyLWJ1ZmZlcmluZy1hbHQtZGlzYWJsZSI6IkRpc2FibGUgYnVmZmVyaW5nIGZvciBhY3RpdmUgdG9vbCIsImxhbmd1YWdlLW1lbnUtcG93ZXJlZC1ieS1nZW9jb3J0ZXgiOiJQb3dlcmVkIGJ5IEdlb2NvcnRleCIsImxhbmd1YWdlLW9mZmxpbmUtcHJvZ3Jlc3MtYmFzZW1hcGRvd25sb2FkLWZhaWxlZCI6IkJhc2VtYXAgJ3swfScgZmFpbGVkIHRvIGRvd25sb2FkOiB7MX0iLCJsYW5ndWFnZS1tb250aHMtMTEiOiJEZWNlbWJlciIsImxhbmd1YWdlLW1vbnRocy0xMCI6Ik5vdmVtYmVyIiwibGFuZ3VhZ2UtbGF5ZXJsaXN0LWV4cGFuZCI6IkNvbGxhcHNlIG9yIGV4cGFuZCB7MH0gbGF5ZXIgZ3JvdXAiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWNyZWF0ZS1mZWF0dXJlIjoiQ3JlYXRlcyBhIG5ldyBmZWF0dXJlLiIsImxhbmd1YWdlLWNvbW1vbi1yZXN1bHRzLXJlbW92ZWQtY29uZmlybWF0aW9uIjoiezB9IHJlc3VsdChzKSByZW1vdmVkIGZyb20gJ3sxfSciLCJsYW5ndWFnZS10b29sYmFyLXRhYi1maWxlIjoiRmlsZSIsImxhbmd1YWdlLWNvb3JkaW5hdGVzLXkiOiJZIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1jcmVhdGUtcmVsYXRlZC1yZWNvcmQiOiJDcmVhdGVzIGEgcmVsYXRlZCB0YWJsZSByZWNvcmQuIiwibGFuZ3VhZ2UtdG9vbGJhci1lZGl0aW5nLWVkaXQiOiJFZGl0IiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1wdWxzZS1zdGF0dXMiOiJSZXNldHMgdGhlIHRpbWVyIG9mIHRoZSBzdGF0dXMgdmlld01vZGVsLiIsImxhbmd1YWdlLWNvb3JkaW5hdGVzLXgiOiJYIiwibGFuZ3VhZ2UtbWVudS1zd2l0Y2gtdG8tbGVnZW5kIjoiU2hvdyBMZWdlbmQiLCJsYW5ndWFnZS1tZW51LWNvbWJpbmUtcmVzdWx0cy11bmlvbiI6IkFkZCB0byByZXN1bHRzIiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtcGFsZXR0ZS1zbWFsbC1kZWxldGUiOiJEZWxldGUiLCJsYW5ndWFnZS10b29sYmFyLWdyb3VwLWhvbWUiOiJCYXNpYyBUb29scyIsImxhbmd1YWdlLXRvb2xiYXItYW5hbHlzaXMtbG9jYXRpb24taW5mbyI6IkxvY2F0aW9uIEluZm8iLCJsYW5ndWFnZS1jb21tb24tbm8tcmVzdWx0cy1kZXNjIjoiSXRlbXMgYXBwZWFyIGFmdGVyIHlvdSBwZXJmb3JtIGEgdmFsaWQgc2VhcmNoIG9yIG90aGVyIHRhc2sgdGhhdCByZXR1cm5zIHJlc3VsdHMuIiwibGFuZ3VhZ2UtbWVudS1nbG9iYWwtc2F2ZS1kZXNjIjoiU2F2ZSB0aGUgc3RhdGUgb2YgeW91ciB2aWV3ZXIgaW4gYSBwcm9qZWN0IiwibGFuZ3VhZ2UtY29tbW9uLWVkaXRpbmciOiJFZGl0aW5nIiwibGFuZ3VhZ2UtY29tbW9uLXJlZnJlc2giOiJSZWZyZXNoIiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtcG9seWdvbiI6IlBvbHlnb24iLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWRlc3Ryb3ktdmlldyI6IkRlc3Ryb3lzIGEgdmlldywgd2lwaW5nIG91dCBpdHMgYmluZGluZyBhbmQgRE9NIHN1YnN0cnVjdHVyZXMuIiwibGFuZ3VhZ2UtY29tbW9uLW9rIjoiT0siLCJsYW5ndWFnZS10b29sYmFyLWlkZW50aWZ5LXBvbHlnb24tZGVzYyI6IlRvIGxlYXJuIHdoYXRcdTIwMTlzIHRoZXJlLCBkcmF3IGEgc2hhcGUgb24gdGhlIG1hcC4gRG91YmxlLWNsaWNrL3RhcCB0byBmaW5pc2guIiwibGFuZ3VhZ2UtbWVudS1tYXAtY29udGV4dC1tZW51LXRpdGxlIjoiUG9pbnQgT3B0aW9ucyIsImxhbmd1YWdlLXN0YXRlcy1mZWF0dXJlLWVkaXRpbmctc3RhdGUtcG9pbnQtZ3JhcGhpYy1kZXNjcmlwdGlvbiI6IlRoZSBjcmVhdGUgYSBmZWF0dXJlIHRvb2wgaXMgY3VycmVudGx5IGVkaXRpbmcgYSBwb2ludC1iYXNlZCBncmFwaGljLiIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24taGlkZS1tYXAtZWxlbWVudCI6IlJlbW92ZXMgYW4gZWxlbWVudCBwcmV2aW91c2x5IGFuY2hvcmVkIHRvIHRoZSBtYXAgdXNpbmcgU2hvd01hcEVsZW1lbnQuIiwibGFuZ3VhZ2UtbWVudS1ydW4tYS13b3JrZmxvdyI6IlBlcmZvcm0gYSB0YXNrIiwibGFuZ3VhZ2UtdG9vbGJhci1ub3QtYXZhaWxhYmxlIjoiVG9vbGJhciBpcyBub3QgYXZhaWxhYmxlIiwibGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLWZpbGwtc3R5bGUtZGlhZ29uYWwtY3Jvc3MiOiJEaWFnb25hbCBDcm9zcyIsImxhbmd1YWdlLWdyYW50LWVkaXRvci1yZW1vdmUtYnV0dG9uLXRpdGxlIjoiUmVtb3ZlIHRoZSB1c2VyIG9yIGdyb3VwIiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtdGV4dC10b29sdGlwIjoiQWRkIHlvdXIgb3duIHRleHQgdG8gdGhlIG1hcCIsImxhbmd1YWdlLWV4dHJhY3QtZGF0YS1kZXNjcmlwdGlvbiI6IkV4dHJhY3QgZmVhdHVyZSBkYXRhIGZyb20gdGhlIG1hcC4iLCJsYW5ndWFnZS1jb21tb24tdmFsaWRhdGlvbi1zeW1ib2wiOiIqIiwibGFuZ3VhZ2UtcmVzdWx0cy1zb3J0IjoiU29ydCBSZXN1bHRzIiwibGFuZ3VhZ2UtcmVzdWx0cy1wYWdlLW5leHQiOiJOZXh0IHBhZ2UiLCJsYW5ndWFnZS10b29sYmFyLXRhc2tzLWV4cG9ydC1tYXAiOiJFeHBvcnQiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWdldC1mZWF0dXJlLWRldGFpbHMtcHJvdmlkZXJzIjoiQ3JlYXRlcyB2aWV3IGZvciBhbGwgY29uZmlndXJlZCBmZWF0dXJlIGRldGFpbHMgcHJvdmlkZXJzIGFuZCBlbWJlZHMgdGhlbSBpbnRvIGZlYXR1cmUgZGV0YWlscyBkaWFsb2cuIiwibGFuZ3VhZ2UtY29tbW9uLWZlYXR1cmUtbGF5ZXItZGV0YWlscy1kZXNjIjoiTWFuYWdlIGNhY2hpbmcgb2YgYSBmZWF0dXJlIGxheWVyIGZvciBvZmZsaW5lIHVzZS4iLCJsYW5ndWFnZS10b29sYmFyLWlkZW50aWZ5LXBvaW50LXRvb2x0aXAiOiJGaW5kIG91dCBhYm91dCBhIGxvY2F0aW9uIG9uIHRoZSBtYXAiLCJsYW5ndWFnZS1vZmZsaW5lLXByb2dyZXNzLWtpbG9ieXRlcy1wZXItc2Vjb25kIjoiezB9IGtCL3MiLCJsYW5ndWFnZS1jb250ZW50LXBvbGljeS1wcm9tcHQtdXJpLXRpdGxlIjoiUG90ZW50aWFsbHkgVW50cnVzdGVkIENvbnRlbnQgRW5jb3VudGVyZWQiLCJsYW5ndWFnZS1tZW51LXByb2plY3QtZGVsZXRlLXByb2plY3QtZGVzYyI6IkRlbGV0ZSB0aGUgY3VycmVudCBwcm9qZWN0IiwibGFuZ3VhZ2UtbWVudS1tYXAtbGF5ZXJzLWRlc2MiOiJBbHRlciB2aXNpYmlsaXR5IG9mIG1hcCBsYXllcnMsIHBlcmZvcm0gbGF5ZXIgYWN0aW9ucywgYW5kIHZpZXcgdGhlIGxlZ2VuZC4iLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXJlbW92ZS1mZWF0dXJlLXNldC1jb2xsZWN0aW9uIjoiUmVtb3ZlcyB0aGUgc3BlY2lmaWVkIGNvbGxlY3Rpb24gZnJvbSB0aGUgZmVhdHVyZSBzZXQgbWFuYWdlci4iLCJsYW5ndWFnZS10b29sYmFyLWVkaXRpbmctY3JlYXRlLW5ldy1mZWF0dXJlIjoiQ3JlYXRlIE5ldyBGZWF0dXJlIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1hZGQtc3RhdHVzIjoiQWRkcyBhIHN0YXR1cyBpbmRpY2F0b3IgdG8gdGhlIHNjcmVlbi4iLCJsYW5ndWFnZS10b29sYmFyLXRvZ2dsZS1idWZmZXItb24tbmFtZSI6IkJ1ZmZlciBPcHRpb25zIiwibGFuZ3VhZ2UtbWVudS1hY2Nlc3NpYmlsaXR5LXBhbmVsIjoiVmlldyB0aGUgYWNjZXNzaWJpbGl0eSBwYW5lbCIsImxhbmd1YWdlLXRvb2xiYXItZ3JvdXAtZHJhdyI6IkRyYXciLCJsYW5ndWFnZS1tZW51LW9mZmxpbmUtbWFwLWVkaXRvci1nZW9tZXRyeS1hY3Rpb25zLWZyZWVoYW5kcG9seWdvbiI6IkZyZWVoYW5kIFBvbHlnb24iLCJsYW5ndWFnZS1jb21tb24tc2hhcmUiOiJTaGFyZSIsImxhbmd1YWdlLXRvb2xiYXItaWRlbnRpZnktcG9pbnQiOiJQb2ludCIsImxhbmd1YWdlLXRvb2xiYXItbWFya3VwLWRyYXdpbmctZWRpdC10b29scyI6IkVkaXQiLCJsYW5ndWFnZS13ZWJtYXAtbGF5ZXItbmFtZS1wb2x5bGluZSI6IkxpbmVzIiwibGFuZ3VhZ2UtcGFnZS1uZXh0IjoiTmV4dCBwYWdlIiwibGFuZ3VhZ2UtbWVudS1saXN0LW9mZmxpbmUtbWFwcy1hY3Rpb25zLXJlZnJlc2giOiJSZWZyZXNoIiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtZnJlZWhhbmQtcG9seWdvbiI6IkZyZWVoYW5kIFNoYXBlIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1kZWxldGUtcmVsYXRlZC1yZWNvcmQiOiJEZWxldGVzIGEgcmVsYXRlZCB0YWJsZSByZWNvcmQuIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1vcGVuLWRhdGEtZnJhbWUiOiJPcGVucyB0aGUgRGF0YVJlZ2lvbiwgaWYgcHJlc2VudCBpbiB0aGUgY3VycmVudCBzaGVsbC4iLCJsYW5ndWFnZS1wcm9qZWN0LWVycm9yLXdyaXRlIjoiVGhlIHByb2plY3QgY291bGQgbm90IGJlIHNhdmVkLiBSZWZlciB0byB0aGUgbG9nIGZvciBtb3JlIGRldGFpbHMuIiwibGFuZ3VhZ2UtbWVudS1yZXN1bHRzLXJlbW92ZS1mZWF0dXJlLWRlc2MiOiJSZW1vdmUgdGhpcyBmZWF0dXJlIGZyb20gdGhlIGN1cnJlbnQgc2V0IG9mIHJlc3VsdHMiLCJsYW5ndWFnZS1jb21tb24td2VsY29tZSI6IkhvbWUiLCJsYW5ndWFnZS1jb21tb24tbG9naW4iOiJMb2cgSW4iLCJsYW5ndWFnZS10b29sYmFyLXRpdGxlIjoiVG9vbGJhciIsImxhbmd1YWdlLW1lbnUtbWFwLWNvbnRleHQtbWVudS10aXRsZS1kZXNjIjoiT3B0aW9ucyByZWxhdGVkIHRvIGEgZ2l2ZW4gcG9pbnQgb24gdGhlIG1hcC4iLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXpvb20tdG8taW5pdGlhbC1leHRlbnQiOiJab29tcyB0byB0aGUgaW5pdGlhbCBleHRlbnQgb2YgdGhlIGN1cnJlbnQgU2l0ZS4iLCJsYW5ndWFnZS1tZW51LWlkZW50aWZ5IjoiRmluZCBkYXRhIG9uIHRoZSBtYXAiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWNsZWFyLWFjdGl2ZS10b29sIjoiQ2xlYXJzIHRoZSBhY3RpdmUgdG9vbC4iLCJsYW5ndWFnZS1tZW51LXByb2plY3QtZWRpdC1wcm9qZWN0LWRlc2MiOiJFZGl0IHRoZSBjdXJyZW50IHByb2plY3QiLCJsYW5ndWFnZS1zdGF0ZXMtZWRpdGluZy1zdGF0ZS1kZXNjcmlwdGlvbiI6IkEgZHJhd2luZyBpcyBhY3RpdmVseSBiZWluZyBlZGl0ZWQuIiwibGFuZ3VhZ2UtbWFwc2VydmljZS1hY3Rpb25zLXRvb2x0aXAiOiJDbGljayB0byBzZWUgYWN0aW9ucyBhdmFpbGFibGUgZm9yIG1hcCBzZXJ2aWNlIHswfSIsImxhbmd1YWdlLW1lbnUtbGFiZWwtb3B0aW9ucy1kZXNjIjoiVG9nZ2xlIGFuZCBjdXN0b21pemUgdGhlIGxheWVyJ3MgbGFiZWxzLiIsImxhbmd1YWdlLW1lbnUtYm9va21hcmstYWRkIjoiQm9va21hcmsgY3VycmVudCBtYXAgZXh0ZW50IiwibGFuZ3VhZ2UtbWVudS1wcm9qZWN0cy1hY3Rpb25zLWRlc2MiOiJQcm9qZWN0cyBBY3Rpb25zIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1zdGFydC1lZGl0aW5nLWVkaXQtbG9nLWVudHJ5IjoiQ3JlYXRlcyBhIGF2aWV3IHRvIGNoYW5nZSBhbiBleGlzdGluZyBlZGl0LiIsImxhbmd1YWdlLW1lbnUtem9vbS1pbiI6Ilpvb20gaW4iLCJsYW5ndWFnZS10b29sYmFyLWFyY2dpcy12aWV3LW15LWNvbnRlbnQiOiJWaWV3IE15IENvbnRlbnQiLCJsYW5ndWFnZS10b29sYmFyLW5hdmlnYXRpb24tem9vbS1pbi1kZXNjIjoiQ2xpY2sgb3IgdGFwLCB0aGVuIGRyYWcgYXJlYSBvZiBpbnRlcmVzdCBvbiB0aGUgbWFwLiBNYXAgd2lsbCB6b29tIHRvIHRoYXQgbG9jYXRpb24uIiwibGFuZ3VhZ2UtbWVudS1uby1pdGVtcyI6Ik5vIG1lbnUgb3B0aW9ucy4iLCJsYW5ndWFnZS10b29sYmFyLWhvbWUtc3ViIjoiSG9tZSIsImxhbmd1YWdlLW1lbnUtb2ZmbGluZS1tYXAtZWRpdG9yLWdlb21ldHJ5LWFjdGlvbnMtZGVzYyI6Ikdlb21ldHJ5IEFjdGlvbnMiLCJsYW5ndWFnZS10b29sYmFyLW1hcmt1cC1kZWxldGUiOiJFcmFzZSIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tcmVnaXN0ZXItc2VhcmNoLXByb3ZpZGVyIjoiUmVnaXN0ZXJzIGEgc2VhcmNoIHByb3ZpZGVyIGlmIG5vdCBhbHJlYWR5IHJlZ2lzdGVyZWQuIiwibGFuZ3VhZ2UtY29tbW9uLXNhdmUiOiJTYXZlIiwibGFuZ3VhZ2UtdG9vbGJhci10YXNrcy1sYXllci1jYXRhbG9nIjoiTGF5ZXIgQ2F0YWxvZyIsImxhbmd1YWdlLXJlc3VsdHMtZGlzcGxheWluZyI6IkRpc3BsYXlpbmciLCJsYW5ndWFnZS1vZmZsaW5lLXByb2dyZXNzLWJhc2VtYXBkb3dubG9hZC1kb3dubG9hZGluZyI6InswfSAtIHsxfSBvZiB7Mn0gKHszfSUpIGRvd25sb2FkZWQuIHs0fS4iLCJsYW5ndWFnZS1ncmFudC1lZGl0b3ItYWRkLWJ1dHRvbi10aXRsZSI6IkFkZCB0aGUgdXNlciBvciBncm91cCIsImxhbmd1YWdlLW1lbnUtem9vbS10by1sYXllciI6Ilpvb20gdG8gZnVsbCBleHRlbnQiLCJsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtbGluZS1zdHlsZS1zaG9ydGRvdCI6IlNob3J0LWRvdCIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tem9vbS10by1lc3JpLWZlYXR1cmUtc2V0IjoiWm9vbXMgdG8gdGhlIGV4dGVudCBvZiBhbGwgdGhlIGZlYXR1cmVzIGluIHRoZSBmZWF0dXJlIHNldC4iLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWNsb3NlLWRhdGEtZnJhbWUiOiJDbG9zZXMgdGhlIERhdGFSZWdpb24sIGlmIGl0IGlzIHByZXNlbnQgaW4gdGhlIGN1cnJlbnQgc2hlbGwuIiwibGFuZ3VhZ2UtbWVudS1ydW4tcmVwb3J0LWRlc2MiOiJSdW4gYSBSZXBvcnQgb24gdGhlIHNlbGVjdGVkIHJlc3VsdHMiLCJsYW5ndWFnZS10b29sYmFyLWdyb3VwLW5hdGl2ZSI6Ik5hdGl2ZSIsImxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1tYXJrZXItc3R5bGUtY2lyY2xlIjoiQ2lyY2xlIiwibGFuZ3VhZ2UtdG9vbGJhci1lZGl0aW5nLW1hbmFnZS1vZmZsaW5lLWRhdGEtdG9vbHRpcCI6IlNlbGVjdCwgc3luYywgYW5kIGNsZWFyIG9mZmxpbmUgZGF0YSIsImxhbmd1YWdlLWNvb3JkaW5hdGVzLXNlY29uZHMiOiJcIiIsImxhbmd1YWdlLXRvb2xiYXItdGFza3MtYWRkLWxheWVycyI6IkFkZCBMYXllcnMiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXNob3ctcmVzdWx0cy1saXN0IjoiRGlzcGxheXMgdGhlIGxpc3Qgb2YgZmVhdHVyZXMgaW4gdGhlIGdpdmVuIGZlYXR1cmUgc2V0IGNvbGxlY3Rpb24gYXMgYSBsaXN0LiIsImxhbmd1YWdlLWNvbW1vbi1jYW5jZWwiOiJDYW5jZWwiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXNldC1hY3RpdmUtaGlnaGxpZ2h0LWxheWVyIjoiU2V0cyB0aGUgbGF5ZXIgd2l0aCB0aGUgc3BlY2lmaWVkIG5hbWUgYXMgYWN0aXZlLCBpZiB0aGVyZSBpcyBvbmUuIiwibGFuZ3VhZ2UtbWVudS16b29tLXRvLXZpc2libGUtc2NhbGUtZGVzYyI6Ilpvb20gdGhlIG1hcCB0byBhIHNjYWxlIHdoZXJlIHRoZSBsYXllciBpcyB2aXNpYmxlLiIsImxhbmd1YWdlLXRvb2xiYXItdG9vbGJhciI6IlRvb2xiYXIiLCJsYW5ndWFnZS10b29sYmFyLWlkZW50aWZ5LXBvbHlsaW5lLWRlc2MiOiJUbyBsZWFybiB3aGF0XHUyMDE5cyB0aGVyZSwgZHJhdyBhIGxpbmUgb2YgaW50ZXJlc3QgYWxvbmcgdGhlIG1hcC4gRG91YmxlLWNsaWNrL3RhcCB0byBmaW5pc2guIiwibGFuZ3VhZ2UtbWVudS1zYXZlLXJlc3VsdHMiOiJTYXZlIFJlc3VsdHMiLCJsYW5ndWFnZS1zdGF0ZXMtZWRpdGluZy1hY3RpdmUtc3RhdGUtZGVzY3JpcHRpb24iOiJUaGUgZmVhdHVyZSBlZGl0b3IgaXMgY3VycmVudGx5IGFjdGl2ZS4iLCJsYW5ndWFnZS10b29sYmFyLWZpbmQtZGF0YSI6IkZpbmQgRGF0YSIsImxhbmd1YWdlLXdlYm1hcC1maWVsZC1uYW1lLXZpc2libGUiOiJWaXNpYmxlIiwibGFuZ3VhZ2UtY29tbW9uLXNob3ctZGV0YWlscy1kZXNjcmlwdGlvbiI6IlNlZSBhZGRpdGlvbmFsIGRldGFpbHMgZm9yIHRoaXMgZmVhdHVyZS4iLCJsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtZmlsbC1zdHlsZS1mb3J3YXJkLWRpYWdvbmFsIjoiRm9yd2FyZCBEaWFnb25hbCIsImxhbmd1YWdlLXRvb2xiYXItbWFya3VwLWV4cG9ydCI6IkV4cG9ydCBEcmF3aW5ncyIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tZmVhdHVyZS1sYXllci1jYWNoZS1kYXRhIjoiQ2FjaGVzIHRoZSBkYXRhIGZvciBhIGdpdmVuIG1hcCBzZXJ2aWNlIFVSTC4iLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWFsbG93LWhpZGUtZmVhdHVyZS1sYXllci1tb2RhbC1tZXNzYWdlIjoiU2hvdyB0aGUgY2xvc2UgYnV0dG9uIG9uIHRoZSBNb2RhbE1lc3NhZ2VWaWV3IGFsbG93aW5nIHRoZSB1c2VyIHRvIGNsb3NlIGl0LiIsImxhbmd1YWdlLXRvb2xiYXItbWFya3VwLWRlbGV0ZS1kZXNjIjoiQ2xpY2sgb3IgdGFwIHRvIGltbWVkaWF0ZWx5IGFuZCBwZXJtYW5lbnRseSBkZWxldGUgYSBkcmF3aW5nLiBUaGlzIGNhbm5vdCBiZSB1bmRvbmUuIiwibGFuZ3VhZ2UtbWVudS1tZW51cy1kZXNjcmlwdGlvbiI6IkkgV2FudCBUby4uLiBNZW51cyIsImxhbmd1YWdlLW1lbnUtbGlzdC1vZmZsaW5lLW1hcHMtYWN0aW9ucy1yZWZyZXNoLWRlc2MiOiJSZWZyZXNoIHRoZSBsaXN0IG9mIG9mZmxpbmUgbWFwcy4iLCJsYW5ndWFnZS10b29sYmFyLWVkaXRpbmctY3JlYXRlLW5ldy1mZWF0dXJlLWdlb2xvY2F0aW9uLXRvb2x0aXAiOiJDcmVhdGUgYSBwb2ludC1iYXNlZCBmZWF0dXJlIHVzaW5nIGdlb2xvY2F0aW9uIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1nZXQtZWRpdC1sb2ciOiJHZXRzIHRoZSBlZGl0IGxvZywgcGFzc2luZyBpdCBpbnRvIGEgY2FsbGJhY2suIElmIGFuIGVycm9yIG9jY3VycywgdGhlIGVycm9yIGlzIHBhc3NlZCBpbnRvIHRoZSBjYWxsYmFjay4iLCJsYW5ndWFnZS1leHRyYWN0LWRhdGEiOiJFeHRyYWN0IGRhdGEiLCJsYW5ndWFnZS13ZWJtYXAtbGF5ZXItbmFtZS1wb2ludCI6IlBvaW50cyIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tY2xlYXItbWFya3VwIjoiUHJvbXB0cyB0aGUgdXNlciBmb3IgY29uZmlybWF0aW9uLCBhbmQgaWYgYXBwcm92ZWQsIGNsZWFycyBhbGwgb2YgdGhlIG1hcmt1cCBmcm9tIHRoZSBtYXJrdXAgbGF5ZXIuIiwibGFuZ3VhZ2UtdG9vbGJhci1jaGFydGluZy1zaG93LWNoYXJ0cy10b29sdGlwIjoiTGF1bmNoIHRoZSBjaGFydGluZyB2aWV3IiwibGFuZ3VhZ2UtZ3JhbnQtZWRpdG9yLXNlYXJjaC10aXRsZSI6IlR5cGUgeW91ciBzZWFyY2ggdGVybXMiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWhpZ2hsaWdodC1mZWF0dXJlLWRlZmF1bHQiOiJIaWdobGlnaHRzIHRoZSBmZWF0dXJlIGluIHRoZSBkZWZhdWx0IGhpZ2hsaWdodCBsYXllci4iLCJsYW5ndWFnZS1jb21tb24tc2hvdy1kZXRhaWxzIjoiU2VlIERldGFpbHMiLCJsYW5ndWFnZS10b29sYmFyLWdyb3VwLWdsb2JhbC10YXNrcyI6Ikdsb2JhbCBUYXNrcyIsImxhbmd1YWdlLW1lbnUtc2hvdy1sb2ctZGVzYyI6IkRpc3BsYXkgdGhlIHZpZXdlcidzIGxvZywgaW5jbHVkaW5nIGRpYWdub3N0aWMgZXJyb3JzIGFuZCB0aGUgdmVyc2lvbiBudW1iZXIuIiwibGFuZ3VhZ2UtdG9vbGJhci1lZGl0aW5nLWNyZWF0ZS1uZXctZmVhdHVyZS10b29sdGlwIjoiQ3JlYXRlIGEgbmV3IGZlYXR1cmUgb24gdGhlIG1hcCIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tc2hvdy1mZWF0dXJlLXRlbXBsYXRlLXBpY2tlciI6IlNob3dzIHRoZSBmZWF0dXJlIHRlbXBsYXRlIHBpY2tlciB1c2VkIHRvIGNyZWF0ZSBuZXcgZmVhdHVyZXMuIElmIGEgbGF5ZXIgaXMgc3VwcGxpZWQsIHNob3dzIHRoZSB0ZW1wbGF0ZXMgZm9yIHRoZSBsYXllci4iLCJsYW5ndWFnZS1tZW51LXBsb3QtY29vcmRpbmF0ZSI6IlBsb3QgYSBDb29yZGluYXRlIiwibGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLXRpdGxlIjoiU3ltYm9sb2d5IFNldHRpbmdzIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1kZWxldGUtYXR0YWNobWVudCI6IkRlbGV0ZXMgYSBmZWF0dXJlIGF0dGFjaG1lbnQuIiwibGFuZ3VhZ2Utb2ZmbGluZS1wcm9ncmVzcy1kb3dubG9hZGluZ3NpdGUiOiJEb3dubG9hZGluZyBzaXRlIHJlc291cmNlcy4iLCJsYW5ndWFnZS1jb21tb24tcmVzdWx0cy1hZGRlZC1jb25maXJtYXRpb24iOiJ7MH0gcmVzdWx0KHMpIGFkZGVkIHRvICd7MX0nIiwibGFuZ3VhZ2UtY29vcmRpbmF0ZXMtbGF0aXR1ZGUtYWJicmV2IjoiTGF0IiwibGFuZ3VhZ2Utc3RhdGVzLXRyYW5zaWVudC1hY3RpdmUtZGVzY3JpcHRpb24iOiJBdCBsZWFzdCBvbmUgdHJhbnNpZW50IHRvb2xiYXIgaXMgY3VycmVudGx5IG9wZW4uIiwibGFuZ3VhZ2UtZ3JhbnQtZWRpdG9yLWFkZC1idXR0b24tdGV4dCI6IkFkZCIsImxhbmd1YWdlLXJlc3VsdHMtZXhwb3J0LXRvLXN0YXR1cy1tZXNzYWdlIjoiRXhwb3J0aW5nIHRvIFwiLnswfVwiIiwibGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLW1hcmtlci1zdHlsZS1jcm9zcyI6IkNyb3NzIiwibGFuZ3VhZ2UtbWVudS1ob21lLXBhbmVsLWRlc2MiOiJWaWV3IGluZm9ybWF0aW9uIGFib3V0IHRoaXMgYXBwbGljYXRpb24uIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1hbGVydCI6IkRpc3BsYXlzIGFuIGFsZXJ0LiIsImxhbmd1YWdlLWNvbW1vbi1mZWF0dXJlLWVkaXRpbmctZGVzYyI6IkVkaXQgdGhlIGF0dHJpYnV0ZXMgb2YgdGhlIGZlYXR1cmUgYW5kIHNhdmUgdGhlbS4iLCJsYW5ndWFnZS1tZW51LXBvd2VyZWQtYnktZ2VvY29ydGV4LWRlc2MiOiJQb3dlcmVkIGJ5IEdlb2NvcnRleCIsImxhbmd1YWdlLW1lbnUtYWNjZXNzaWJpbGl0eS1wYW5lbC1kZXNjIjoiVmlldyBpbmZvcm1hdGlvbiBhYm91dCB0aGUgYWNjZXNzaWJpbGl0eSBvZiB0aGlzIGFwcGxpY2F0aW9uLiIsImxhbmd1YWdlLXJlc3VsdHMtcGFnZS1maXJzdCI6IkZpcnN0IHBhZ2UiLCJsYW5ndWFnZS1tZW51LXpvb20taW5pdGlhbC1leHRlbnQiOiJSZXR1cm4gdG8gaW5pdGlhbCBtYXAgZXh0ZW50IiwibGFuZ3VhZ2UtdG9vbGJhci1pZGVudGlmeS1mcmVlaGFuZC1wb2x5Z29uLWRlc2MiOiJEcmF3IGEgZnJlZWhhbmQgc2hhcGUgb24gdGhlIG1hcCB0byBzZWUgd2hhdCdzIHRoZXJlIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1kZWxldGUtZnJvbS1lZGl0LWxvZyI6IlJlbW92ZXMgdGhlIGdpdmVuIGVudHJ5IGZyb20gdGhlIGVkaXQgbG9nLCB0aGVuIHNldHMgdGhlIGVkaXQgbG9nLiIsImxhbmd1YWdlLWxheWVybGlzdC1iYXNlLW1hcHMtZm9sZGVyLXRpdGxlIjoiQmFzZW1hcHMiLCJsYW5ndWFnZS1vZmZsaW5lLXByb2dyZXNzLWJhc2VtYXBleHBvcnQtY29ubmVjdGluZyI6InswfSBjb25uZWN0aW5nIHRvIGdlbmVyYXRlLi4uIiwibGFuZ3VhZ2UtbWVudS1zd2l0Y2gtdG8tbGVnZW5kLWRlc2MiOiJEaXNwbGF5IHRoZSBsZWdlbmQgZm9yIHZpc2libGUgbGF5ZXJzIiwibGFuZ3VhZ2UtdG9vbGJhci1ncm91cC1vZmZsaW5lLW1hbmFnZW1lbnQiOiJPZmZsaW5lIE1hbmFnZW1lbnQiLCJsYW5ndWFnZS1jb21tb24tZWRpdCI6IkVkaXQiLCJsYW5ndWFnZS1jb21tb24tZmVhdHVyZS1zeW5jLXNldHRpbmdzIjoiTWFuYWdlIFN5bmMgU2V0dGluZ3MiLCJsYW5ndWFnZS1tZW51LXNldHRpbmdzLWRlc2NyaXB0aW9uIjoiTW9iaWxlIFNldHRpbmdzIiwibGFuZ3VhZ2Utc3RhdGVzLWVkaXQtc3RhdGUtZGVzY3JpcHRpb24iOiJUaGUgdG9vbCB0byBzZWxlY3QgYW4gaXRlbSBmb3IgZWRpdGluZyBpcyBjdXJyZW50bHkgYWN0aXZlLiIsImxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1zdGFydGNvbG9yIjoiU3RhcnQgQ29sb3IiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXJ1bi13b3JrZmxvdy1ieS1pZCI6IlJ1bnMgYSB3b3JrZmxvdy4iLCJsYW5ndWFnZS1tZW51LXByb2plY3Qtc2hhcmUtcHJvamVjdC1kZXNjIjoiU2hhcmUgdGhlIGN1cnJlbnQgcHJvamVjdCIsImxhbmd1YWdlLWxheWVybGlzdC10b2dnbGUiOiJUb2dnbGUgezB9IGxheWVyIHZpc2liaWxpdHkuIiwibGFuZ3VhZ2UtbWVudS1nbG9iYWwtb3BlbiI6Ik9wZW4iLCJsYW5ndWFnZS1tZW51LWV4cG9ydC1yZXN1bHRzLXRvLWNzdi1kZXNjIjoiRXhwb3J0IHJlc3VsdHMgdG8gQ1NWIiwibGFuZ3VhZ2UtY29tbW9uLWZlYXR1cmUtc3luYy1zZXR0aW5ncy1kZXNjIjoiRGlzcGxheXMgYSBsaXN0IG9mIGZlYXR1cmUgbGF5ZXJzIHRvIGNob29zZSBmcm9tLiIsImxhbmd1YWdlLXRvb2xiYXItdGFiLXRhc2tzIjoiVGFza3MiLCJsYW5ndWFnZS10b29sYmFyLWhvbWUtdG9vbHRpcCI6Ik9wZW4gdGhlIEhvbWUgUGFuZWwiLCJsYW5ndWFnZS1tZW51LWRlc2NyaXB0aW9uIjoiUXVpY2sgYWNjZXNzIHRvIGNvbW1vbiB0YXNrcyIsImxhbmd1YWdlLW1lbnUtem9vbSI6Ilpvb20gdG8gRmVhdHVyZSIsImxhbmd1YWdlLXRvb2xiYXItbWFya3VwLXBvbHlnb24tZGVzYy1rZXlib2FyZCI6IlVzZSBhcnJvd3MgdG8gbW92ZSB0aGUgcG9pbnQuIEhpdCBFTlRFUiB0byBwbG90IGFuZCBiZWdpbiBtb3ZpbmcgdGhlIG5leHQgcG9pbnQuIEhpdCBFTlRFUiB0d2ljZSB0byBmaW5pc2guIiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtcmVjdGFuZ2xlLWRlc2MiOiJDbGljayBhbmQgZHJhZyB0byBkcmF3IGEgcmVjdGFuZ2xlIG9uIHRoZSBtYXAuIiwibGFuZ3VhZ2UtbGF5ZXItYWN0aW9ucyI6IlBlcmZvcm0gYW4gYWN0aW9uIG9uIHswfSIsImxhbmd1YWdlLXByb2plY3QtZXJyb3Itb3duZXIiOiJZb3UgZG8gbm90IG93biB0aGlzIHByb2plY3QuIiwibGFuZ3VhZ2UtY29tbW9uLWNsZWFyIjoiQ2xlYXIiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWZlYXR1cmUtbGF5ZXItbW9kdWxlLXN0YXJ0LXN5bmMiOiJTdGFydHMgc3luY2hyb25pemVzIHRoZSBmZWF0dXJlIGVkaXRzIHRvIHRoZSBzZXJ2ZXIuIiwibGFuZ3VhZ2UtbWVudS1ob21lLXBhbmVsIjoiVmlldyB0aGUgaG9tZSBwYW5lbCIsImxhbmd1YWdlLWNvbW1vbi1mZWF0dXJlLWVkaXRpbmciOiJGZWF0dXJlIEF0dHJpYnV0ZXMiLCJsYW5ndWFnZS10b29sYmFyLW5hdmlnYXRpb24tcGFuIjoiUGFuIiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtZWRpdC1kZXNjLXNob3J0Y3V0cyI6IlVzZSBhcnJvd3MgdG8gbW92ZSwgUiB0byByb3RhdGUsIFMgdG8gc2NhbGUsIFYgdG8gc2VsZWN0IHZlcnRleC4gQ29tYmluZSB3aXRoIEFMVCBmb3IgZmluZXIgY29udHJvbC4gQ29tYmluZSB3aXRoIFNISUZUIHRvIHJldmVyc2UuIiwibGFuZ3VhZ2UtbW9udGhzLTIiOiJNYXJjaCIsImxhbmd1YWdlLW1vbnRocy0xIjoiRmVicnVhcnkiLCJsYW5ndWFnZS1tb250aHMtNCI6Ik1heSIsImxhbmd1YWdlLW9mZmxpbmUtZXJyb3JzLW5vdG5hdGl2ZWluaXRpYWxpemVkIjoiVGhpcyBvcGVyYXRpb24gY2FuIG9ubHkgYmUgcGVyZm9ybWVkIGluIHRoZSBuYXRpdmUgY2xpZW50LiIsImxhbmd1YWdlLW1vbnRocy0zIjoiQXByaWwiLCJsYW5ndWFnZS1tZW51LW9mZmxpbmUtbWFwLWVkaXRvci1nZW9tZXRyeS1hY3Rpb25zLWNpcmNsZSI6IkNpcmNsZSIsImxhbmd1YWdlLXNtYXJ0LXBhbmVsLW1lbnUiOiJQYW5lbCBBY3Rpb25zIE1lbnUuIENsaWNrIHRvIG9wZW4vY2xvc2UuIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1zaG93LW1hcCI6IkFjdGl2YXRlcyBtYXAgdmlldy4iLCJsYW5ndWFnZS1tb250aHMtMCI6IkphbnVhcnkiLCJsYW5ndWFnZS10b29sYmFyLW5hdmlnYXRpb24tem9vbS1vdXQtdG9vbHRpcCI6IkRyYXcgYW4gYXJlYSBvZiBpbnRlcmVzdCBvbiB0aGUgbWFwIGFuZCB6b29tIG91dCwga2VlcGluZyB0aGUgYXJlYSBjZW50ZXJlZCIsImxhbmd1YWdlLXRvb2xiYXItbWFya3VwLXBvaW50LWRlc2MiOiJDbGljayBvciB0YXAgYSBtYXAgbG9jYXRpb24gdG8gYWRkIGEgcG9pbnQuIiwibGFuZ3VhZ2UtdG9vbGJhci1zbmFwcGluZy1hbHQtZGlzYWJsZSI6IkRpc2FibGUgc25hcHBpbmcgZm9yIGFjdGl2ZSB0b29sIiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtcGFsZXR0ZS1zbWFsbC1jaGFuZ2Utc3R5bGUiOiJTdHlsZXMiLCJsYW5ndWFnZS1tb250aHMtOSI6Ik9jdG9iZXIiLCJsYW5ndWFnZS10b29sYmFyLW5hdmlnYXRpb24tbmV4dC1leHRlbnQtdG9vbHRpcCI6Ilpvb20gdG8gdGhlIG5leHQgZXh0ZW50IiwibGFuZ3VhZ2UtbW9udGhzLTYiOiJKdWx5IiwibGFuZ3VhZ2UtbW9udGhzLTUiOiJKdW5lIiwibGFuZ3VhZ2UtbWVudS1zd2l0Y2gtdG8tbGF5ZXJsaXN0IjoiU2hvdyBMYXllciBMaXN0IiwibGFuZ3VhZ2UtcGFnZS1wcmV2IjoiUHJldmlvdXMgcGFnZSIsImxhbmd1YWdlLW1vbnRocy04IjoiU2VwdGVtYmVyIiwibGFuZ3VhZ2UtbW9udGhzLTciOiJBdWd1c3QiLCJsYW5ndWFnZS1tZW51LWV4cG9ydC1yZXN1bHRzLXRvLXNocC1kZXNjIjoiRXhwb3J0IHJlc3VsdHMgdG8gU2hhcGVmaWxlIiwibGFuZ3VhZ2UtbWVudS1pZGVudGlmeS1wb2ludC1kZXNjIjoiRHJhdyBhIHBvaW50IG9uIHRoZSBtYXAgdG8gdmlldyBpbmZvcm1hdGlvbiBhdCB0aGF0IHBvaW50IG9uIHRoZSBtYXAuIiwibGFuZ3VhZ2Utc21hcnQtcGFuZWwtcmVzaXplIjoiRHJhZyB0byByZXNpemUgdGhlIHBhbmVsIiwibGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLW1hcmtlci1zdHlsZS1zcXVhcmUiOiJTcXVhcmUiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWludm9rZS1tYXAtdGlwIjoiRXhlY3V0ZXMgYW4gSWRlbnRpZnkgb3BlcmF0aW9uIG9uIHRoZSBnaXZlbiBnZW9tZXRyeSBhbmQgXCJNYXBUaXBcIiBhcyBpdHMgc291cmNlIHRhZy4iLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWNsb3NlLWZlYXR1cmUtc2V0LWNvbGxlY3Rpb24iOiJDbG9zZXMgdGhlIGZlYXR1cmUgc2V0IGNvbGxlY3Rpb24uIiwibGFuZ3VhZ2UtbWVudS1icm93c2Utc2F2ZWQtcmVzdWx0cy1kZXNjIjoiQ2hvb3NlIGZyb20gYSBsaXN0IG9mIHNhdmVkIHJlc3VsdHMgdG8gdmlldyB0aGVtIiwibGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLWVuZGNvbG9yIjoiRW5kIENvbG9yIiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtcG9seWxpbmUtZGVzYy1rZXlib2FyZCI6IlVzZSBhcnJvd3MgdG8gbW92ZSB0aGUgcG9pbnQuIEhpdCBFTlRFUiB0byBwbG90IGFuZCBiZWdpbiBtb3ZpbmcgdGhlIG5leHQgcG9pbnQuIEhpdCBFTlRFUiB0d2ljZSB0byBmaW5pc2guIiwibGFuZ3VhZ2UtdWktdGFibGUtc29ydGVkLWFzY2VuZGluZyI6IkNvbHVtbiBoZWFkZXIuIHswfSAtIFNvcnRlZCBhc2NlbmRpbmcuIiwibGFuZ3VhZ2UtbWVudS1lbnRlci1vbmxpbmUiOiJHbyB0byBvbmxpbmUgbW9kZSIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tc2VhcmNoIjoiUGVyZm9ybXMgYSBzZWFyY2ggb24gYWxsIGFjdGl2ZSBwcm92aWRlcnMuIiwibGFuZ3VhZ2UtbWVudS1lZGl0LWZlYXR1cmUtZGVzY3JpcHRpb24iOiJFZGl0IHRoZSBkZXRhaWxzIGFib3V0IHRoaXMgZmVhdHVyZS4iLCJsYW5ndWFnZS1tZW51LWlkZW50aWZ5LWZyZWVoYW5kIjoiSWRlbnRpZnkgYnkgZnJlZWhhbmQgc2hhcGUiLCJsYW5ndWFnZS1wcm9qZWN0LXNpZ24taW4iOiJTaWduIGluIiwibGFuZ3VhZ2UtdG9vbGJhci1uYXZpZ2F0aW9uLXpvb20tb3V0LWRlc2MiOiJEcmFnIGEgcmVjdGFuZ2xlIG9uIHRoZSBtYXAgdG8gem9vbSBvdXQgd2hpbGUga2VlcGluZyB0aGF0IGFyZWEgY2VudGVyZWQiLCJsYW5ndWFnZS10b29sYmFyLW5hdGl2ZS1zaG93b2ZmbGluZW1hcHMtdG9vbHRpcCI6Ik9wZW4gdGhlIGxpc3Qgb2Ygb2ZmbGluZSBtYXBzIiwibGFuZ3VhZ2UtbWVudS1pZGVudGlmeS1idWZmZXJlZC1mZWF0dXJlLXNldC1jb2xsZWN0aW9uIjoiU2hvdyBCdWZmZXIgT3B0aW9ucyIsImxhbmd1YWdlLXRvb2xiYXItZ3JvdXAtcGxvdGNvb3JkaW5hdGVzIjoiQ29vcmRpbmF0ZXMiLCJsYW5ndWFnZS10b29sYmFyLW5hdmlnYXRpb24tem9vbS1vdXQiOiJab29tIE91dCIsImxhbmd1YWdlLXRvb2xiYXItc25hcHBpbmctYWx0LWVuYWJsZSI6IkVuYWJsZSBzbmFwcGluZyBmb3IgYWN0aXZlIHRvb2wiLCJsYW5ndWFnZS1vZmZsaW5lLXByb2dyZXNzLXVucmVnaXN0ZXJpbmdyZXBsaWNhIjoiVW5yZWdpc3RlcmluZyByZXBsaWNhLiIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tY2xlYXItaGlnaGxpZ2h0cyI6IlJlbW92ZXMgdGhlIGhpZ2hsaWdodHMgZnJvbSB0aGUgYWN0aXZlIGhpZ2hsaWdodCBsYXllci4iLCJsYW5ndWFnZS1ob3Vycy1hYmJyIjoiSCIsImxhbmd1YWdlLW1lbnUtcmVtb3ZlLXVzZXItYWRkZWQtbWFwc2VydmljZSI6IlJlbW92ZSBzZXJ2aWNlIiwibGFuZ3VhZ2UtdG9vbGJhci1uYXZpZ2F0aW9uLXByZXZpb3VzLWV4dGVudC10b29sdGlwIjoiWm9vbSB0byB0aGUgcHJldmlvdXMgZXh0ZW50IiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtZGVsZXRlLWRlc2Mta2V5Ym9hcmQiOiJVc2UgYXJyb3dzIHRvIG1vdmUgdGhlIHBvaW50LiBIaXQgRU5URVIgdG8gaW1tZWRpYXRlbHkgYW5kIHBlcm1hbmVudGx5IGRlbGV0ZSBhIGRyYXdpbmcuIFRoaXMgY2Fubm90IGJlIHVuZG9uZS4iLCJsYW5ndWFnZS10b29sYmFyLXNlbGVjdC1sYXllcnMtdG9nZ2xlLW9uLW5hbWUiOiJGaWx0ZXIgTGF5ZXJzIiwibGFuZ3VhZ2UtdG9vbGJhci1pZGVudGlmeS1yZWN0YW5nbGUiOiJSZWN0YW5nbGUiLCJsYW5ndWFnZS10b29sYmFyLXNuYXBwaW5nLXNlbGVjdC1sYXllcnMtdG9vbHRpcCI6IkNoYW5nZSB3aGljaCBsYXllcnMgYXJlIHNuYXBwYWJsZSIsImxhbmd1YWdlLW9mZmxpbmUtZXJyb3JzLW5vdGZvdW5kIjoiT2ZmbGluZSBwcm9maWxlIG5vdCBmb3VuZC4iLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLW9wZW4td2ViLXBhZ2UiOiJPcGVucyBhIHdlYiBwYWdlIGluIGFub3RoZXIgdGFiL3dpbmRvdy4iLCJsYW5ndWFnZS1yZXN1bHRzLXBhZ2UtcHJldiI6IlByZXZpb3VzIHBhZ2UiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWNsb3NlLW1vZGFsLXJlZ2lvbiI6IkNsb3NlcyB0aGUgTW9kYWxXaW5kb3dSZWdpb24uIiwibGFuZ3VhZ2UtdG9vbGJhci1uYXZpZ2F0aW9uLWhvbWUtc3ViIjoiSG9tZSIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tY2FuY2VsLXNlYXJjaCI6IkNhbmNlbCB0aGUgc2VhcmNoIG9uIGFsbCBwcm92aWRlcnMuIiwibGFuZ3VhZ2Utb2ZmbGluZS1lcnJvcnMtY2FuY2VscmVqZWN0ZWQiOiJDYW5ub3QgY2FuY2VsIHJpZ2h0IG5vdy4iLCJsYW5ndWFnZS1jb21tb24td29ya2Zsb3ciOiJXb3JrZmxvdyIsImxhbmd1YWdlLW1lbnUtZG9uZSI6IkRvbmUiLCJsYW5ndWFnZS1tZW51LWVkaXQtZmVhdHVyZSI6IkVkaXQgdGhpcyBGZWF0dXJlIiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtcG9pbnQtdG9vbHRpcCI6IkFkZCBhIHBvaW50IHRvIHRoZSBtYXAiLCJsYW5ndWFnZS10b29sYmFyLTNyZC1wYXJ0eS1tYXBzLXNob3ctbWFwcyI6IkxpbmtlZCBNYXBzIiwibGFuZ3VhZ2UtbGF5ZXJsaXN0LW5vdC12aXNpYmxlLWF0LWV4dGVudCI6IkN1cnJlbnRseSBub3Qgd2l0aGluIHZpc2libGUgc2NhbGUuIiwibGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLWxpbmUtc3R5bGUtc29saWQiOiJTb2xpZCIsImxhbmd1YWdlLW1lbnUtem9vbS1kZXNjcmlwdGlvbiI6Ilpvb20gdG8gdGhpcyBmZWF0dXJlIG9uIHRoZSBtYXAiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWdsb2JhbC1zZWFyY2giOiJQZXJmb3JtcyBhIHNlYXJjaCBvbiBhbGwgYWN0aXZlIHByb3ZpZGVycy4iLCJsYW5ndWFnZS1tZW51LXNob3ctbG9nIjoiU2hvdyBMb2ciLCJsYW5ndWFnZS1jb29yZGluYXRlcy1taW51dGVzIjoiJyIsImxhbmd1YWdlLXRvb2xiYXItZ3JvdXAtdGltZS1zbGlkZXIiOiJUaW1lIFNsaWRlciIsImxhbmd1YWdlLXRvb2xiYXItc2VsZWN0LWxheWVycy10b2dnbGUtdG9vbHRpcCI6IkZpbHRlciBsYXllcnMgZm9yIElkZW50aWZ5IHJlc3VsdHMiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXNldC1oaWdobGlnaHQtYm9yZGVyLWNvbG9yIjoiU2V0cyB0aGUgYm9yZGVyIGNvbG9yIHVzZWQgZm9yIG5ldyBoaWdobGlnaHRzLCBzcGVjaWZpZWQgaW4gNiBvciA4IGRpZ2l0IGhleCBpbiBSR0Igb3IgQVJHQiBmb3JtLiIsImxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1maWxsLXN0eWxlLWhvcml6b250YWwiOiJIb3Jpem9udGFsIiwibGFuZ3VhZ2UtbWVudS1tYXAtbGF5ZXJzIjoiQ2hhbmdlIHZpc2libGUgbWFwIGxheWVycyIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24taGlnaGxpZ2h0LWVzcmktZmVhdHVyZS1zZXQiOiJIaWdobGlnaHRzIGFsbCBvZiB0aGUgZmVhdHVyZXMgaW4gdGhlIHNwZWNpZmllZCBmZWF0dXJlIHNldCBpbiB0aGUgYWN0aXZlIGhpZ2hsaWdodCBsYXllci4iLCJsYW5ndWFnZS1ncmFudC1lZGl0b3ItbW9uaWtlci10eXBlLXVzZXIiOiJJbmRpdmlkdWFscyIsImxhbmd1YWdlLXRvb2xiYXItY2hhcnRpbmctc2hvdy1jaGFydHMiOiJWaWV3IENoYXJ0cyIsImxhbmd1YWdlLXRvb2xiYXItbWFya3VwLXBvbHlsaW5lLWRlc2MiOiJDbGljayBvciB0YXAgbG9jYXRpb25zIGFsb25nIHRoZSBtYXAgdG8gY3JlYXRlIGEgbGluZS4gRG91YmxlIGNsaWNrL3RhcCB0byBmaW5pc2guIiwibGFuZ3VhZ2UtdG9vbGJhci10YXNrcy1pZGVudGlmeSI6IklkZW50aWZ5IiwibGFuZ3VhZ2UtbWVudS1jb21iaW5lLXJlc3VsdHMtc3VidHJhY3QtZGVzYyI6IlJlbW92ZSBhIHNhdmVkIHNldCBvZiByZXN1bHRzIGZyb20geW91ciBjdXJyZW50IGxpc3Qgb2YgcmVzdWx0cyIsImxhbmd1YWdlLW1lbnUtaWRlbnRpZnktcmVjdGFuZ2xlLWRlc2MiOiJEcmF3IGEgcmVjdGFuZ2xlIHRvIHZpZXcgaW5mb3JtYXRpb24gYWJvdXQgdGhhdCBhcmVhLiIsImxhbmd1YWdlLXRvb2xiYXItaWRlbnRpZnktcmVjdGFuZ2xlLWRlc2MiOiJUbyBsZWFybiB3aGF0XHUyMDE5cyB0aGVyZSwgY2xpY2sgb3IgdGFwIGFuZCBkcmFnIHRvIGRyYXcgYSByZWN0YW5nbGUgb24gdGhlIG1hcC4iLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLWRlYWN0aXZhdGUtY29udGFpbmVycy1mb3Itd29ya2Zsb3ciOiJEZWFjdGl2YXRlcyBhbnkgd29ya2Zsb3cgdmlld3MgYXNzb2NpYXRlZCB3aXRoIGEgZ2l2ZW4gd29ya2Zsb3cuIiwibGFuZ3VhZ2UtcHJvamVjdC1lcnJvci1kZWxldGUiOiJUaGUgcHJvamVjdCBjb3VsZCBub3QgYmUgZGVsZXRlZC4gUmVmZXIgdG8gdGhlIGxvZyBmb3IgbW9yZSBkZXRhaWxzLiIsImxhbmd1YWdlLXNtYXJ0LXBhbmVsLWJhY2siOiJHbyBCYWNrIGluIFBhbmVsIiwibGFuZ3VhZ2UtbWVudS1saXN0LW9mZmxpbmUtbWFwcy1hY3Rpb25zLWRlc2MiOiJPZmZsaW5lIFByb2ZpbGUgQWN0aW9ucyIsImxhbmd1YWdlLXByb2plY3QtZXJyb3Itc2lnbi1pbi1yZXF1aXJlZCI6IlRoaXMgcHJvamVjdCByZXF1aXJlcyB5b3UgdG8gc2lnbiBpbi4gUGxlYXNlIHNpZ24gaW4gdG8gb3BlbiB0aGUgcHJvamVjdC4iLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXNob3ctbWFwLXRpcCI6IkNyZWF0ZXMgYSBNYXAgVGlwIFZpZXcgYW5kIGRpc3BsYXlzIHRoZSBmZWF0dXJlIGluIGl0LiIsImxhbmd1YWdlLXRvb2xiYXItbWFya3VwLWNsZWFyLXRvb2x0aXAiOiJDbGVhciBhbGwgZHJhd2luZ3MgZnJvbSB0aGUgbWFwIiwibGFuZ3VhZ2Utc3RhdGVzLWJ1ZmZlcmluZy1kZXNjcmlwdGlvbiI6IkJ1ZmZlcmluZyBpcyBlbmFibGVkIGZvciB0aGUgY3VycmVudCB0b29sLiIsImxhbmd1YWdlLWNvbW1vbi1mZWF0dXJlLW9mZmxpbmUtdG9vbHMiOiJNYW5hZ2UgT2ZmbGluZSBEYXRhIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1kZWFjdGl2YXRlLXZpZXciOiJEZWFjdGl2YXRlcyBhIHZpZXcuIiwibGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLXBpY2stYXR0cmlidXRlIjoiUGljayBhbiBhdHRyaWJ1dGUgdG8gc3ltYm9saXplOiIsImxhbmd1YWdlLW1lbnUtcmVtb3ZlLXVzZXItYWRkZWQtbGF5ZXItZGVzYyI6IlJlbW92ZSB0aGlzIHVzZXIgYWRkZWQgbGF5ZXIgZnJvbSB0aGUgbWFwLiIsImxhbmd1YWdlLXRvb2xiYXItZmluZC1kYXRhLXRvb2xzIjoiRmluZCBEYXRhIFRvb2xzIiwibGFuZ3VhZ2UtbWVudS1nbG9iYWwtc2F2ZS1hcy1kZXNjIjoiU2F2ZSB0aGUgc3RhdGUgb2YgeW91ciB2aWV3ZXIgaW4gYSBuZXcgcHJvamVjdCIsImxhbmd1YWdlLW1lbnUtZXhwb3J0LXJlc3VsdHMtdG8tc2hwIjoiRXhwb3J0IHRvIFNoYXBlZmlsZSIsImxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1saW5lLXN0eWxlLWxvbmdkYXNoIjoiTG9uZy1kYXNoIiwibGFuZ3VhZ2Utc2VhcmNoLXdvcmxkLXBsYWNlLW5hbWVzIjoiV29ybGQgUGxhY2UgTmFtZXMiLCJsYW5ndWFnZS1jb21tb24tbm90LWF2YWlsYWJsZS1vZmZsaW5lIjoiVGhpcyBmdW5jdGlvbiBpcyBub3QgYXZhaWxhYmxlIHdoZW4gb2ZmbGluZS4iLCJsYW5ndWFnZS1yZXN1bHRzIjoiUmVzdWx0cyIsImxhbmd1YWdlLXRvb2xiYXItYW5hbHlzaXMtbWVhc3VyZW1lbnQtdG9vbHMiOiJNZWFzdXJlIiwibGFuZ3VhZ2UtdG9vbGJhci1uYXZpZ2F0aW9uLWhvbWUtdG9vbHRpcCI6IlJldHVybnMgdG8gaW50cm9kdWN0b3J5IHBhZ2UiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXNldC1hY3RpdmUtdG9vbCI6IlNldHMgdGhlIGFjdGl2ZSB0b29sLiIsImxhbmd1YWdlLW1lbnUtZXhwb3J0LXJlc3VsdHMtdG8teGxzeCI6IkV4cG9ydCB0byBYTFNYIiwibGFuZ3VhZ2UtbWVudS1vZmZsaW5lLW1hcC1lZGl0b3ItZ2VvbWV0cnktYWN0aW9ucy1yZWN0YW5nbGUiOiJSZWN0YW5nbGUiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXNob3ctbGF5ZXItbGlzdCI6IkFjdGl2YXRlcyB0aGUgTGF5ZXJMaXN0IFZpZXcuIiwibGFuZ3VhZ2Utb2ZmbGluZS1wcm9ncmVzcy1ieXRlcyI6InswfSBieXRlcyIsImxhbmd1YWdlLXRvb2xiYXItc2hvdy1sYXllcmxpc3QiOiJMYXllciBMaXN0IiwibGFuZ3VhZ2UtZ3JhbnQtZWRpdG9yLWdsb2JhbC1ncmFudC1uYW1lLXB1YmxpYyI6IkV2ZXJ5b25lIChzaWduLWluIG5vdCByZXF1aXJlZCkiLCJsYW5ndWFnZS1tZW51LWRyYXctcG9pbnQtZGVzYyI6IkRyYXcgYSBwb2ludCBvbiB0aGUgbWFwLiIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tdXBkYXRlLWZlYXR1cmUtbGF5ZXItbW9kYWwtbWVzc2FnZSI6IlVwZGF0ZSB0aGUgdmlzaWJsZSBNb2RlbE1lc3NhZ2VWaWV3IHRvIGFsc28gaW5jbHVkZSB0aGUgZ2l2ZW4gbWVzc2FnZS4iLCJsYW5ndWFnZS1wYWdlLW9mIjoib2YiLCJsYW5ndWFnZS1yZXN1bHRzLXRvZ2dsZS10YWJsZS12aWV3LWRlc2MiOiJWaWV3IHJlc3VsdHMgaW4gdGFibGUgZm9ybWF0IiwibGFuZ3VhZ2UtY29tbW9uLWZlYXR1cmUtZWRpdGxvZyI6IlZpZXcgRWRpdCBMb2ciLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXRha2UtYXBwbGljYXRpb24tb2ZmbGluZSI6IlB1dHMgdGhlIGFwcGxpY2F0aW9uIGluIGFuIG9mZmxpbmUgc3RhdGUuIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1zdGFydC1lZGl0aW5nLWZlYXR1cmUiOiJCZWdpbnMgZWRpdGluZyBhbiBleGlzdGluZyBmZWF0dXJlLiIsImxhbmd1YWdlLW1lbnUtY29tYmluZS1yZXN1bHRzLWludGVyc2VjdCI6Ik1hdGNoIGludGVyc2VjdGluZyByZXN1bHRzIiwibGFuZ3VhZ2UtbWVudS1kZWZhdWx0LXRpdGxlIjoiT3B0aW9ucyIsImxhbmd1YWdlLW1lbnUtcmVzdWx0cy1saXN0LWFjdGlvbnMtZGVzYyI6IlJlc3VsdHMgTGlzdCBBY3Rpb25zIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi16b29tLXRvLWV4dGVudCI6Ilpvb21zIHRvIHRoZSBnaXZlbiBleHRlbnQuIiwibGFuZ3VhZ2UtcGFnZS1wYWdlIjoiUGFnZSIsImxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1tYXJrZXItc2l6ZS1zdWZmaXgiOiJweCIsImxhbmd1YWdlLW9mZmxpbmUtcHJvZ3Jlc3MtYmFzZW1hcGV4cG9ydC1jb21wbGV0ZWQiOiJ7MH0gZ2VuZXJhdGVkIGFuZCBkb3dubG9hZGVkLiIsImxhbmd1YWdlLWNvbW1vbi1uby1yZXN1bHRzLXNob3J0IjoiTm8gcmVzdWx0cyIsImxhbmd1YWdlLXRvb2xiYXItbWVudS1nbG9iYWwtc2F2ZS1zYXZlLWFzIjoiU2F2ZS9TYXZlIGFzIiwibGFuZ3VhZ2UtcGFnZS1sYXN0IjoiTGFzdCBwYWdlIiwibGFuZ3VhZ2UtbWVudS1vZmZsaW5lLW1hcC1lZGl0b3ItZ2VvbWV0cnktYWN0aW9ucy1lbGxpcHNlIjoiRWxsaXBzZSIsImxhbmd1YWdlLXRvb2xiYXItbWFya3VwLWVkaXQtZGVzYy1zaG9ydGN1dHMtem9vbSI6IlVzZSBhcnJvd3MgdG8gbW92ZSwgUyB0byBzY2FsZS4gQ29tYmluZSB3aXRoIEFMVCBmb3IgZmluZXIgY29udHJvbC4gQ29tYmluZSB3aXRoIFNISUZUIHRvIHJldmVyc2UuIiwibGFuZ3VhZ2UtdG9vbGJhci1pZGVudGlmeS1yZWN0YW5nbGUtdG9vbHRpcCI6IkZpbmQgb3V0IGFib3V0IGFuIGFyZWEgb24gdGhlIG1hcCBkZWZpbmVkIGJ5IGEgcmVjdGFuZ2xlIiwibGFuZ3VhZ2UtY29tbW9uLWhpZGUiOiJIaWRlIiwibGFuZ3VhZ2UtdG9vbGJhci10YWItbmF2aWdhdGlvbiI6Ik5hdmlnYXRpb24iLCJsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtYXR0cmlidXRlLXNlbGVjdCI6IlBsZWFzZSBDaG9vc2UuLi4iLCJsYW5ndWFnZS1jb21tb24tbGF5ZXItZGF0YSI6IkxheWVyIERhdGEiLCJsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3Mtbm9kYXRhLXRpdGxlIjoiTm8gRGF0YSIsImxhbmd1YWdlLW1lbnUtbGF0aXR1ZGUtZ2VvZ3JhcGhpY3MiOiJMYXRpdHVkZSBHZW9ncmFwaGljcyBHcm91cCBMdGQuIiwibGFuZ3VhZ2UtdG9vbGJhci10YXNrcy1sYXllci1jYXRhbG9nLXRvb2x0aXAiOiJBZGQgbGF5ZXJzIHRvIHRoZSBtYXAgZnJvbSBhIGxheWVyIGNhdGFsb2ciLCJsYW5ndWFnZS10YWItc2Nyb2xsLW5leHQiOiJOZXh0IExheWVyIiwibGFuZ3VhZ2UtbGF5ZXItYWN0aW9ucy10aXRsZSI6IkxheWVyIEFjdGlvbnMiLCJsYW5ndWFnZS10b29sYmFyLW1hcmt1cC1lZGl0LXpvb21vdXQtdG9vbCI6Ilpvb21PdXRUb29sIiwibGFuZ3VhZ2UtY29tbW9uLWxvYWQiOiJMb2FkIiwibGFuZ3VhZ2UtY29tbW9uLXJlc3VsdHMiOiJSZXN1bHRzIiwibGFuZ3VhZ2UtbWVudS1icm93c2Utc2F2ZWQtcmVzdWx0cyI6Ik9wZW4gU2F2ZWQgUmVzdWx0cyIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tZ2V0LXJlbGF0ZWQtZmVhdHVyZSI6IkdldHMgZmVhdHVyZXMgcmVsYXRlZCB0byB0aGUgZmVhdHVyZS4iLCJsYW5ndWFnZS10b29sYmFyLW1hcmt1cC1mcmVlaGFuZCI6IkZyZWVoYW5kIiwibGFuZ3VhZ2UtbWVudS1tYXB0aXAtYWN0aW9ucyI6IkFjdGlvbnMiLCJsYW5ndWFnZS10b29sYmFyLW1hcmt1cC1leHBvcnQtdG9vbHRpcCI6IkV4cG9ydCBkcmF3aW5ncyB0byBzaGFwZWZpbGUiLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXByb2plY3QiOiJDYWxscyBhIGdlb21ldHJ5IHNlcnZpY2UgdG8gcHJvamVjdCBnZW9tZXRyaWVzIGJldHdlZW4gZGlmZmVyZW50IGNvb3JkaW5hdGUgc3lzdGVtcy4iLCJsYW5ndWFnZS10b29sYmFyLWdyb3VwLXRpbWVzbGlkZXIiOiJUaW1lIFNsaWRlciIsImxhbmd1YWdlLW1lbnUtb2ZmbGluZS1tYXAtZWRpdG9yLWdlb21ldHJ5LWFjdGlvbnMtcG9seWdvbiI6IlBvbHlnb24iLCJsYW5ndWFnZS1yZXN1bHRzLXBhZ2UtbGFzdCI6Ikxhc3QgcGFnZSIsImxhbmd1YWdlLXJlc3VsdHMtdG90YWwiOiJUb3RhbCIsImxhbmd1YWdlLWNvbW1vbi1iYWNrIjoiQmFjayIsImxhbmd1YWdlLWNvbW1vbi1yZXN1bHRzLXN1YnRyYWN0LWNvbmZpcm1hdGlvbiI6InsxfSBzdWJ0cmFjdGVkIGZyb20gJ3swfSciLCJsYW5ndWFnZS10b29sYmFyLWFyY2dpcy1leHBvcnQtd2ViLW1hcC10b29sdGlwIjoiU2F2ZSB0aGUgY3VycmVudCBtYXAgdG8gQXJjR0lTIiwibGFuZ3VhZ2UtbWVudS1zYXZlLXJlc3VsdHMtZGVzYyI6IlNhdmUgdGhlIGxpc3Qgb2YgcmVzdWx0cyBmb3IgZnV0dXJlIHVzZSIsImxhbmd1YWdlLW1lbnUtZW50ZXItb25saW5lLWRlc2MiOiJHbyB0byBvbmxpbmUgbW9kZSBhbmQgdmlldyBsaXZlIG1hcCBkYXRhIGZyb20gdGhlIHdlYi4iLCJsYW5ndWFnZS1jb21tYW5kLWRlc2NyaXB0aW9uLXByb21wdCI6IkRpc3BsYXlzIGEgcHJvbXB0LiIsImxhbmd1YWdlLWNvbW1vbi1uby1yZXN1bHRzIjoiTm8gcmVzdWx0cyB0byBkaXNwbGF5IiwibGFuZ3VhZ2Utb2ZmbGluZS1wcm9ncmVzcy1iYXNlbWFwZXhwb3J0LWNhbmNlbGVkIjoiezB9IGNhbmNlbGVkLiIsImxhbmd1YWdlLW1lbnUtb2ZmbGluZS1tYXAtZWRpdG9yLWdlb21ldHJ5LWFjdGlvbnMtY2lyY2xlLWRlc2MiOiJEcmF3IGEgY2lyY2xlIGZvciB0aGUgYXJlYSBvZiBpbnRlcmVzdCBnZW9tZXRyeS4iLCJsYW5ndWFnZS10b29sYmFyLW1hcmt1cC1wYWxldHRlLXNtYWxsLWNsZWFyLWFsbCI6IkNsZWFyIEFsbCIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tY3JlYXRlLWhpZ2hsaWdodC1sYXllciI6IkNyZWF0ZXMgYSBuZXcgaGlnaGxpZ2h0IGxheWVyIHdpdGggdGhlIHNwZWNpZmllZCBuYW1lLiIsImxhbmd1YWdlLWNvbW1vbi1sb2FkaW5nIjoiTG9hZGluZy4uLiIsImxhbmd1YWdlLW1lbnUtdmlzdWFsaXphdGlvbi1kZXNjIjoiQ3JlYXRlIGFuZCB2aWV3IGN1c3RvbSBsYXllciB2aXN1YWxpemF0aW9ucyBzdWNoIGFzIGhlYXQgbWFwcywgY2x1c3RlcmluZywgYW5kIGxheWVyIHN0eWxlcy4iLCJsYW5ndWFnZS1tZW51LWlkZW50aWZ5LXJlY3RhbmdsZSI6IklkZW50aWZ5IGJ5IHJlY3RhbmdsZSIsImxhbmd1YWdlLXN5bWJvbG9neS1zZXR0aW5ncy1maWxsLXN0eWxlLXNvbGlkIjoiU29saWQiLCJsYW5ndWFnZS1zeW1ib2xvZ3ktc2V0dGluZ3MtZmlsbC1zdHlsZSI6IkZpbGwgU3R5bGUiLCJsYW5ndWFnZS10b29sYmFyLWJvb2ttYXJrLW9wZW4iOiJPcGVuIHRoZSBib29rbWFya3MgdmlldyIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tcGFuLXRvLXBvaW50IjoiUGFucyB0byBhIHBvaW50IG9yIG90aGVyIHR5cGUgb2YgR2VvbWV0cnkuIiwibGFuZ3VhZ2UtdG9vbGJhci1tYXJrdXAtZWxsaXBzZSI6IkVsbGlwc2UiLCJsYW5ndWFnZS10b29sYmFyLXRhYi1hbmFseXNpcyI6IkFuYWx5c2lzIiwibGFuZ3VhZ2Utc3ltYm9sb2d5LXNldHRpbmdzLWxpbmUtc3R5bGUtZGFzaCI6IkRhc2giLCJsYW5ndWFnZS1zbWFydC1wYW5lbC1jbG9zZSI6IkNsb3NlIFBhbmVsIiwibGFuZ3VhZ2UtY29tbWFuZC1kZXNjcmlwdGlvbi1mZWF0dXJlLWxheWVyLWNsZWFyLWRhdGEiOiJDbGVhcnMgdGhlIGRhdGEgZm9yIGEgZ2l2ZW4gbWFwIHNlcnZpY2UgVVJMLiIsImxhbmd1YWdlLXRvb2xiYXItYnVmZmVyaW5nLWRpc2FibGUiOiJEaXNhYmxlIGJ1ZmZlcmluZyIsImxhbmd1YWdlLWNvbW1hbmQtZGVzY3JpcHRpb24tdXBkYXRlLXJlbGF0ZWQtcmVjb3JkIjoiVXBkYXRlcyBhIHJlbGF0ZWQgdGFibGUgcmVjb3JkLiIsImxhbmd1YWdlLXRvb2xiYXItYm9va21hcmsiOiJCb29rbWFya3MiLCJsYW5ndWFnZS1mcmFtZXdvcmstdWktdmlldy1jb250YWluZXItdmlldy1iYWNrIjoiR28gQmFjayB7MH0ifQ==");
geocortex.framework.notifyLibraryDownload("Mapping.Infrastructure");
