/*
	
	Copyright (c) 2015, Latitude Geographics Group Ltd.
	All rights reserved.
	       
	Redistribution is not permitted. 
	
	Use in binary form, without modification, is permitted provided that neither 
	the name of the organization nor the names of its contributors may be used 
	to endorse or promote products derived from this software without specific 
	prior written permission.
	       
	THIS SOFTWARE IS PROVIDED BY COPYRIGHT HOLDER ''AS IS'' AND ANY
	EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
	WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
	DISCLAIMED. IN NO EVENT SHALL LATITUDE GEOGRAPHICS GROUP LTD. BE LIABLE FOR ANY
	DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
	(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
	LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
	ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
	(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
	SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/

var __extends=this.__extends||function(c,e){function f(){this.constructor=c}for(var g in e)e.hasOwnProperty(g)&&(c[g]=e[g]);f.prototype=e.prototype;c.prototype=new f},geocortex;
(function(c){(function(e){(function(f){(function(f){(function(f){var e=function(c){function b(a,d){c.call(this,a,d);this.infrastructureLibraryId="Charting";this.title=new Observable("");this.headerIsVisible=new Observable(true);this.showXButton=new Observable(true);this.showBusyIndicator=new Observable(false);this.responsiveLegendPositioning=new Observable(false);this.currentChart=new Observable(null);this.autoSize=new Observable(false);this.height=new Observable(0);this.width=new Observable(0);this.currentChart.bind(this,
this._handleCurrentChartChanged)}__extends(b,c);b.prototype.initialize=function(a){c.prototype.initialize.call(this,a);if(a){if(a.hasOwnProperty("infrastructureLibraryId"))this.infrastructureLibraryId=a.infrastructureLibraryId;a.hasOwnProperty("headerIsVisible")&&this.headerIsVisible.set(!!a.headerIsVisible);a.hasOwnProperty("showXButton")&&this.showXButton.set(!!a.showXButton)}};b.prototype.setSize=function(a,d){!isNaN(a)&&!isNaN(d)&&(this.width.set(a),this.height.set(d))};b.prototype.onDestroy=
function(){c.prototype.onDestroy.call(this);this.currentChart.set(null);this.app=this.currentChart=null};b.prototype._handleCurrentChartChanged=function(a){this.title.set(a.displayName.get())};return b}(c.framework.ui.ViewModelBase);f.ChartPaneViewModel=e})(f.charting||(f.charting={}))})(f.modules||(f.modules={}))})(e.mapping||(e.mapping={}))})(c.essentialsHtmlViewer||(c.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(c){(function(e){(function(f){(function(f){(function(f){var e=function(f){function b(a,d){f.call(this,a,d);this._chartView=null;this._isDestroyed=false}__extends(b,f);b.prototype.attach=function(a){var d=this;f.prototype.attach.call(this,a);this.viewModel&&this.containerElement&&(this.auto(this.viewModel.width,this,function(a){return $(d.containerElement).width(a)}),this.auto(this.viewModel.height,this,function(a){return $(d.containerElement).height(a)}))};b.prototype.resolveWidget=function(a,
d){return d&&a==="ChartWidget"?(this._chartView=this.app.viewManager.createView({markup:"Charting/charting/Chart.html",type:"geocortex.charting.Chart",visible:true,libraryId:this.viewModel.infrastructureLibraryId||"Charting"}),this.viewModel&&this.viewModel.responsiveLegendPositioning.get()&&this._overrideLegendPosition(d),this._chartView.attach(d),this.viewModel.showBusyIndicator.sync(this._chartView.isBusy),this._chartView):f.prototype.resolveWidget.call(this,a,d)};b.prototype.refresh=function(){this.viewModel&&
this.viewModel.responsiveLegendPositioning.get()&&this.viewModel.currentChart.get()&&this._overrideLegendPosition(this.viewModel.currentChart.get());this._chartView&&this._chartView.updateLayout()};b.prototype.destroy=function(){f.prototype.destroy.call(this);this._chartView&&this._chartView.destroy();this.viewModel&&(this.viewModel.showBusyIndicator.removeSync(),this.viewModel.destroy());this.app=this.root=this.viewModel=this._chartView=null;this._isDestroyed=true};b.prototype.displayChart=function(a){this.viewModel.currentChart.set(a);
var d=this._chartView;d&&(d.destroyBindings(),d.attach(a),this.app.command("ActivateView").execute(d.id))};b.prototype.onClose=function(){};b.prototype.handleClickClose=function(){if(this.viewModel&&this.onClose)this.onClose(this.viewModel.currentChart.get());this._isDestroyed||this.app.command("DestroyView").execute(this.id)};b.prototype._overrideLegendPosition=function(a){if(this.root&&a){var d=$(this.root).width(),b=$(this.root).height(),d=c.charting.ChartUtils.getResponsiveLegendPosition(a,d>=
b*1.5);a.legendPosition.set(d)}};return b}(c.framework.ui.ViewBase);f.ChartPane=e})(f.charting||(f.charting={}))})(f.modules||(f.modules={}))})(e.mapping||(e.mapping={}))})(c.essentialsHtmlViewer||(c.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));(function(c){c=c.essentialsHtmlViewer||(c.essentialsHtmlViewer={});c=c.mapping||(c.mapping={});c=c.modules||(c.modules={});c.charting||(c.charting={})})(geocortex||(geocortex={}));
(function(c){(function(e){(function(f){(function(e){(function(e){var g=function(j){function b(a,d){j.call(this,a,d);this.infrastructureLibraryId="Charting";this._savedFillColor=this._savedBorderColor=this._behavior=null;this._lookupTable=new f.infrastructure.Dictionary;this._subscribeToEvents()}__extends(b,j);b.prototype.initialize=function(a){var d=this;j.prototype.initialize.call(this,a);this.doWhenLibrariesDownloaded(function(a){if(a&&a.hasOwnProperty("infrastructureLibraryId"))d.infrastructureLibraryId=
a.infrastructureLibraryId;d.initializeChartFactory();d._registerCommands();a&&a.hasOwnProperty("adapters")&&d._loadAdapters(a.adapters);var h=d.app.command("CreateHighlightLayer"),c=b.DEFAULT_HIGHLIGHT_LAYER_NAME;if(h.canExecute(c))h.execute(c);else var f=h.canExecuteChanged.subscribe(d,function(){h.canExecute(c)&&(h.canExecuteChanged.unsubscribe(f),h.execute(c))})},a)};b.prototype.initializeChartFactory=function(){var a=new c.charting.globalization.KendoFormatProvider,d=new c.charting.ChartSeriesProvider(this.app,
this.infrastructureLibraryId),b=new c.essentialsHtmlViewer.mapping.modules.charting.ChartPointCollectionFeatureAggregator;b.formatProvider=a;this.chartFactory=new c.charting.ChartViewModelFactory(this.app,this.infrastructureLibraryId);this.chartFactory.id="ChartViewModelFactory";this.chartFactory.initialize({formatProvider:a,seriesProvider:d,aggregator:b});this.app.registerFrameworkObject(this.chartFactory)};b.prototype.doWhenLibrariesDownloaded=function(a,d){var b=this;if(a)if(this.app.allLibrariesLoaded)a(d);
else var h=this.app.event("ViewerLibrariesDownloadedEvent").subscribe(this,function(){b.app.event("ViewerLibrariesDownloadedEvent").unsubscribe(h);a(d)})};b.prototype._registerCommands=function(){this.app.command("RegisterChartPointAdapter").register(this,this._executeRegisterAdapter);this.app.command("ClearChartHighlights").register(this,this._executeClearChartHighlights,this._canExecuteClearChartHighlights);this.app.command("HighlightChartFeatureSet").register(this,this._executeHighlightChartFeatureSet,
this._canExecuteHighlightChartFeatureSet);this.app.command("RunChartFeatureActions").register(this,this._executeRunChartFeatureActions,this._isValidFeatureSet)};b.prototype._subscribeToEvents=function(){this.app.event("ChartPointMouseHoverBeginEvent").subscribe(this,this._chartPointMouseHoverBeginEventHandler)};b.prototype._executeRegisterAdapter=function(a){if(!a.adapter)throw Error("Cannot register a null chart data adapter.");c.charting.ChartPointAdapterRegistry.registerAdapter(a.adapter,a.sourceType)};
b.prototype._executeClearChartHighlights=function(){this.app.command("SetActiveHighlightLayer").execute(b.DEFAULT_HIGHLIGHT_LAYER_NAME);this.app.command("ClearHighlights").execute();this._savedFillColor&&this.app.command("SetHighlightFillColor").execute(this._savedFillColor);this._savedBorderColor&&this.app.command("SetHighlightBorderColor").execute(this._savedBorderColor)};b.prototype._canExecuteClearChartHighlights=function(){return this.app.command("SetActiveHighlightLayer").canExecute(b.DEFAULT_HIGHLIGHT_LAYER_NAME)&&
this.app.command("ClearHighlights").canExecute()&&this.app.command("SetHighlightFillColor").canExecute(void 0)&&this.app.command("SetHighlightBorderColor").canExecute(void 0)};b.prototype._executeHighlightChartFeatureSet=function(a){a=this._convertParameterToFeatureSet(a);this._savedBorderColor=this.app.highlightManager.getHighlightBorderColor();this._savedFillColor=this.app.highlightManager.getHighlightFillColor();this.app.command("SetActiveHighlightLayer").execute(b.DEFAULT_HIGHLIGHT_LAYER_NAME);
if(this._lookupTable.containsKey(a.uniqueId)){var d=this._lookupTable.get(a.uniqueId);if(d=c.charting.ChartUtils.findSeriesViewModelFromChartPoint(d.chartPoint,d.chartViewModel.seriesViewModels.getItems())){var k=b.DEFAULT_FILL_COLOR,h=b.DEFAULT_BORDER_COLOR;d.distinctColor?(k=d.distinctColor.toString(true),h=c.charting.ColorUtils.generateSelectionColor(d.distinctColor).toString(true)):d.seriesDefinition&&d.seriesDefinition.color&&(k=d.seriesDefinition.color.toString(true),h=c.charting.ColorUtils.generateSelectionColor(d.seriesDefinition.color).toString(true));
this.app.command("SetHighlightFillColor").execute(h);this.app.command("SetHighlightBorderColor").execute(k)}}this.app.command("HighlightFeatureSet").execute(a)};b.prototype._canExecuteHighlightChartFeatureSet=function(a){a=this._convertParameterToFeatureSet(a);return this.app.command("SetActiveHighlightLayer").canExecute(b.DEFAULT_HIGHLIGHT_LAYER_NAME)&&this.app.command("SetHighlightFillColor").canExecute(void 0)&&this.app.command("SetHighlightBorderColor").canExecute(void 0)&&this.app.command("HighlightFeatureSet").canExecute(a)};
b.prototype._convertParameterToFeatureSet=function(a){var d=null;a instanceof c.charting.eventArgs.ChartPointEventArgs?d=e.ChartUtils.getFeaturesFromChartPoint(a.chartPoint):a instanceof f.infrastructure.FeatureSet&&(d=a);return d};b.prototype._executeRunChartFeatureActions=function(a){var d=this._convertParameterToFeatureSet(a);if(this._lookupTable.containsKey(d.uniqueId)){if(a=(a=this._lookupTable.get(d.uniqueId))&&a.chartViewModel?a.chartViewModel.chartDefinition.area:null)if(a.actionZoom?this.app.command("ZoomToAllFeatures").execute(d.features.getItems()):
a.actionPan&&this.app.command("PanToAllFeatures").execute(d.features.getItems()),a.actionFeatureDetails&&(d=d.features.getAt(0),this.app.command("ShowFeatureDetails").execute(d)),a.actionRunCommand)d=a.commandName,a=a.commandParameter?a.commandParameter:null,d&&this.app.command(d).execute(a)}else this.app.trace.warning("Could not execute actions associated with clicking on a chart. Chart configuration not found.")};b.prototype._isValidFeatureSet=function(a){a=this._convertParameterToFeatureSet(a);
return a!==null&&a instanceof f.infrastructure.FeatureSet&&a.features.getLength()>0};b.prototype._chartPointMouseHoverBeginEventHandler=function(a){if(a){var d={chartPoint:a.chartPoint,chartViewModel:a.chartViewModel};(a=e.ChartUtils.getFeaturesFromChartPoint(a.chartPoint))&&this._lookupTable.set(a.uniqueId,d)}};b.prototype._loadAdapters=function(a){for(var d=0;d<a.length;d++){var b=a[d];b&&this._loadAdapter(b)}};b.prototype._loadAdapter=function(a){var d=dojo.getObject(a.type);d&&(d=new d,typeof d.initialize==
"function"&&d.initialize(a.configuration),a={adapter:d,sourceType:a.source||"Field"},this.app.command("RegisterChartPointAdapter").execute(a))};b.DEFAULT_HIGHLIGHT_LAYER_NAME="Charts";b.DEFAULT_FILL_COLOR="#99ECEC3A";b.DEFAULT_BORDER_COLOR="#FFCCCC33";return b}(c.framework.application.ModuleBase);e.ChartingModule=g})(e.charting||(e.charting={}))})(f.modules||(f.modules={}))})(e.mapping||(e.mapping={}))})(c.essentialsHtmlViewer||(c.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(c){(function(e){(function(f){(function(f){(function(f){var e=function(f){function b(a,d){f.call(this,a,d);this._handles={appEvents:[],mapEvents:[],fsEvents:[]};this._chartConfig={animationsEnabled:true,gradientsEnabled:false,interactiveLegendEnabled:false,pieStartAngle:180,renderAs:"svg",chartWidth:0,chartHeight:0};this._chartFactory=null;this.enabled=true;this.featureSetCollection=new Observable;this.charts=new ObservableCollection;this.defaultCharts=new ObservableCollection;this.displayedCharts=
new ObservableCollection;this.expanded=new Observable(false);this.infrastructureLibraryId="Charting";this.headerIsVisible=new Observable(true);this.showXButton=new Observable(true);this.isGenerated=new Observable(false);this.featureSetCollection.bind(this,this._handleCollectionChanged)}__extends(b,f);b.prototype.initialize=function(a){f.prototype.initialize.call(this,a);if(a){if(a.hasOwnProperty("chartingEnabled"))this.enabled=!!a.chartingEnabled;if(a.hasOwnProperty("infrastructureLibraryId"))this.infrastructureLibraryId=
a.infrastructureLibraryId;a.hasOwnProperty("headerIsVisible")&&this.headerIsVisible.set(!!a.headerIsVisible);a.hasOwnProperty("showXButton")&&this.showXButton.set(!!a.showXButton);if(a=a.chartConfiguration){if(a.hasOwnProperty("chartWidth"))this._chartConfig.chartWidth=parseInt(a.chartWidth);if(a.hasOwnProperty("chartHeight"))this._chartConfig.chartHeight=parseInt(a.chartHeight);if(a.hasOwnProperty("renderAs"))this._chartConfig.renderAs=a.renderAs;if(a.hasOwnProperty("animationsEnabled"))this._chartConfig.animationsEnabled=
!!a.animationsEnabled;if(a.hasOwnProperty("gradientsEnabled"))this._chartConfig.gradientsEnabled=!!a.gradientsEnabled;if(a.hasOwnProperty("interactiveLegendEnabled"))this._chartConfig.interactiveLegendEnabled=!!a.interactiveLegendEnabled;if(a.hasOwnProperty("pieStartAngle"))this._chartConfig.pieStartAngle=a.pieStartAngle}}this._registerCommands();this._subscribeEvents()};b.prototype.refresh=function(){this.featureSetCollection.pulse()};b.prototype.getChartFactory=function(){if(this._chartFactory===
null)this._chartFactory=this.app.getFrameworkObjectById("ChartViewModelFactory");return this._chartFactory};b.prototype.doWhenChartGenerationCompleted=function(a){var d=this;if(a)if(this.isGenerated.get())a(this);else var b=this.isGenerated.bind(this,function(h){h&&(d.isGenerated.unbind(b),a(d))})};b.prototype.applyChartOptions=function(a){a&&a.setOptions(this._chartConfig)};b.prototype.findChartById=function(a){return c.framework.utils.ArrayUtils.firstOrDefault(this.charts.getItems(),function(d){return d.chartDefinition.id===
a})};b.prototype.findDisplayedChartById=function(a){return c.framework.utils.ArrayUtils.firstOrDefault(this.displayedCharts.getItems(),function(d){return d.chartDefinition.id===a})};b.prototype.createChart=function(a){a=this.getChartFactory().createInstance(a.chartDefinition,a.chartFeatureType);this.applyChartOptions(a);return a};b.prototype.chartPointCollectionLoadDelegate=function(a,d){var b=this;return function(){return b.getChartFactory()?b.getChartFactory().createChartPointCollection(a.chartDefinition,
d,a.chartFeatureType):null}};b.prototype.initializeCharts=function(a){var d=this;if(a&&!a.features.isEmpty()&&a.layer&&a.layer.charts&&a.layer.charts.length!=0){this.isGenerated.set(false);var b=this.charts.getItems().map(function(a){return a.chartDefinition.id});this.charts.addItems(this._createCharts(a.layer,b));this.cleanup();if(this.charts.getLength()==0)this.defaultCharts.clear();else{for(var b=a.layer.charts.filter(function(a){return a.chartDefinition.visible&&a.defaultChart&&a.chartFeatureType==
1}),h=0;h<b.length;h++){var f=b[h],e=c.framework.utils.ArrayUtils.firstOrDefault(this.charts.getItems(),function(a){return a.chartDefinition.id===f.id});e&&!this.defaultCharts.contains(e)&&this.defaultCharts.addItem(e)}this.defaultCharts.getLength()==0&&this.defaultCharts.addItem(this.charts.getAt(0));a.layer.charts&&a.layer.charts.some(function(a){return c.charting.ChartUtils.containsDataLinks(a.chartDefinition)})?a.doWhenDataLinkingCompleted(function(a){d._buildChartPointCollections(a);d.isGenerated.set(true)}):
(this._buildChartPointCollections(a),this.isGenerated.set(true))}}};b.prototype.cleanup=function(){if(this.featureSetCollection.get())for(var a=this.featureSetCollection.get().featureSets.getItems().map(function(a){return a.layer}),d=this.charts.getLength();d--;){var b=this.charts.getAt(d);if(!this.displayedCharts.contains(b)&&(a==null||!c.framework.utils.ArrayUtils.contains(a,b.tag)))this.defaultCharts.removeItem(b),this.charts.removeAt(d)}};b.prototype.updateDisplayedCharts=function(){this.displayedCharts.get().forEach(function(a){a.chartPointCollection.get()})};
b.prototype._registerCommands=function(){this.app.command("SetCollectionOfInterest").register(this,this._executeChangeCollectionOfInterest)};b.prototype._subscribeEvents=function(){this._disconnectAppEvents();this._connectAppEvent("FSMCollectionChangedEvent",this._fsmCollectionChangedEventHandler);this._connectAppEvent("FSMCollectionRemovedEvent",this._fsmCollectionRemovedEventHandler)};b.prototype._handleCollectionChanged=function(a){this.cleanup();this._disconnectFeatureSetChanges(a);if(a&&a.featureSets.getLength()>
0){for(var d=0;d<a.featureSets.getLength();d++)this.initializeCharts(a.featureSets.getAt(d));this._connectFeatureSetChanges(a)}};b.prototype._fsmCollectionChangedEventHandler=function(a){var d=this;this.featureSetCollection.get()&&a&&a.featureSetCollection&&a.featureSetCollection.id==this.featureSetCollection.get().id&&(a.collectionChangedEventArgs&&(a.collectionChangedEventArgs.type==="clear"||a.collectionChangedEventArgs.type==="remove")?setTimeout(function(){d.featureSetCollection.set(a.featureSetCollection)},
0):this.featureSetCollection.set(a.featureSetCollection))};b.prototype._featureSetChanged=function(){};b.prototype._fsmCollectionRemovedEventHandler=function(a){this.featureSetCollection.get()&&a&&a.featureSetCollectionId&&a.featureSetCollectionId==this.featureSetCollection.get().id&&(this._disconnectFeatureSetChanges(),this.featureSetCollection.set(null))};b.prototype._executeChangeCollectionOfInterest=function(a){if((a=this.app.featureSetManager.getCollectionById(a))&&a!==this.featureSetCollection.get())this._disconnectFeatureSetChanges(),
this.featureSetCollection.set(a)};b.prototype._createCharts=function(a,d){d===void 0&&(d=null);var b=[];if(a&&a.charts)for(var h=0;h<a.charts.length;h++){var c=a.charts[h];if(c&&c.chartDefinition.id&&c.chartDefinition.visible&&c.chartFeatureType==1&&!(d&&d.indexOf(c.chartDefinition.id)>=0))c=this.createChart(c),c.tag=a,b.push(c)}return b};b.prototype._buildChartPointCollections=function(a){for(var d=a.layer.charts.map(function(a){return a.id}),b=0;b<this.charts.getLength();b++){var c=this.charts.getAt(b);
if(c&&d&&!(d.indexOf(c.chartDefinition.id)<0)){var f=this.chartPointCollectionLoadDelegate(c,a),c=c.chartPointCollection;c.clear();c.delegateGetter=f;c.cacheDelegateResults=true}}this.expanded.get()&&this.updateDisplayedCharts()};b.prototype._connectAppEvent=function(a,d){var b=this.app.event(a).subscribe(this,d);this._handles.appEvents.push({eventName:a,token:b})};b.prototype._disconnectAppEvents=function(){if(this._handles.appEvents.length>0)for(var a=0;a<this._handles.appEvents.length;a++){var d=
this._handles.appEvents[a];this.app.event(d.eventName).unsubscribe(d.token)}this._handles.appEvents.length=0};b.prototype._connectFeatureSetChanges=function(a){for(var d=this,b=0;b<a.featureSets.getLength();b++){var c=a.featureSets.getAt(b);if(!this._handles.fsEvents.some(function(a){return a.collection===c.features})){var f=c.features.bind(this,function(b){return d._featureSetChanged(a.id,b)});this._handles.fsEvents.push({collection:c.features,token:f})}}};b.prototype._disconnectFeatureSetChanges=
function(a){for(var a=a?a.featureSets.getRange(0):null,d=0;d<this._handles.fsEvents.length;d++){var b=this._handles.fsEvents[d];if(b.collection&&(!a||!a.some(function(a){return a.features===b.collection})))b.collection.unbind(b.token),this._handles.fsEvents.splice(d,1),d--}};return b}(c.essentialsHtmlViewer.mapping.infrastructure.ui.components.SmartPanel.SmartPanelViewModel);f.ChartingViewModel=e})(f.charting||(f.charting={}))})(f.modules||(f.modules={}))})(e.mapping||(e.mapping={}))})(c.essentialsHtmlViewer||
(c.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(c){(function(e){(function(f){(function(f){(function(f){var e=function(e){function b(a,d){e.call(this,a,d);this._delayedResizeHandle=null;this._panes=[];this._activePanes=[];this._registerCommandsAndEvents()}__extends(b,e);b.prototype._registerCommandsAndEvents=function(){this.app.command("ShowChartingView").register(this,this._executeShowChartingView,this._canExecuteShowChartingView);this.app.command("DisplayChartById").register(this,this.addChartById,this._canExecuteDisplayChartById);this.app.command("RemoveChartById").register(this,
this.destroyChartById,this._canExecuteRemoveChartById);this.app.command("ClearCharts").register(this,this.clearCharts,this._canExecuteClearCharts);this.app.event("ApplicationResizedEvent").subscribe(this,this._resizeContainer);this.app.event("ViewDimensionsChangedEvent").subscribe(this,this.handleViewDimensionsChangedEvent);this.app.event("ViewHostedEvent").subscribe(this,this.handleViewHostedEvent);this.app.event("ViewUnhostedEvent").subscribe(this,this.handleViewUnhostedEvent);this.app.event("ViewActivatedEvent").subscribe(this,
this.handleViewActivatedEvent);this.app.event("ViewDeactivatedEvent").subscribe(this,this.handleViewDeactivatedEvent);this.app.event("FSMCollectionOpenedEvent").subscribe(this,this._enableOrDisableShowChartingView);this.app.event("FSMCollectionChangedEvent").subscribe(this,this._enableOrDisableShowChartingView);this.app.event("FSMCollectionRemovedEvent").subscribe(this,this._enableOrDisableShowChartingView)};b.prototype._enableOrDisableShowChartingView=function(){this.app.command("ShowChartingView").raiseCanExecuteChanged()};
b.prototype.resize=function(){e.prototype.resize.call(this);c.framework.utils.isNullOrUndefined(this.scrollRegionElement)||dojo.style(this.scrollRegionElement,"top","")};b.prototype.activated=function(){e.prototype.activated.call(this);if(this.viewModel&&(this.viewModel.expanded.set(true),this.isActive===false))this._delayedResizeHandle=this._delayedResizeContainer()};b.prototype.deactivated=function(){e.prototype.deactivated.call(this);this.viewModel&&this.viewModel.expanded.set(false)};b.prototype.resolveWidget=
function(a,d){var b=this;return a==="ChartSelector"?(this._selectorView=this.app.viewManager.createView({typeName:"geocortex.framework.ui.Selector.SelectorView",markup:"Framework.UI/geocortex/framework/ui/Selector/SelectorView.html",visible:true,app:this.app,title:this.app.getResource(this.libraryId,"language-feature-charts"),libraryId:"Framework.UI"}),this.selector=new c.framework.ui.Selector.SelectorViewModel(this.app,this.libraryId,!!this.app.configuration.mobileMode),this.selector.setCollection(this.viewModel.charts,
"displayName",null),this.selector.selectorText.set(this.app.getResource(this.libraryId,"language-charting-selector-text")),this.selector.noItemsText.set(this.app.getResource(this.libraryId,"language-charting-no-items")),this.selector.onSelectItem=function(a){return b.handleSelectChart(a.item)},this.selector.onUnselectItem=function(a){return b.handleUnSelectChart(a.item)},this._selectorView.attach(this.selector),this._selectorView):e.prototype.resolveWidget.call(this,a,d,null)};b.prototype.addDefaultCharts=
function(){if(!(this.viewModel.displayedCharts.getLength()>0))for(var a=0;a<this.viewModel.defaultCharts.getLength();a++)this.addChart(this.viewModel.defaultCharts.getAt(a))};b.prototype.addChartById=function(a){this.addChart(this.viewModel.findChartById(a))};b.prototype.addChart=function(a){if(!a||!this.canAddChart(a))return null;this.isActive===false&&this.activateContainer();this.viewModel.displayedCharts.addItem(a);this.app.command("ClearCharts").raiseCanExecuteChanged();this.selector&&this.selector.hasItemViewModelFor(a)&&
this.selector.selectItem(a);this.viewModel.applyChartOptions(a);a.chartPointCollection.get();return this._hostChartInPane(a)};b.prototype.canAddChart=function(a){return a&&this.viewModel?!this.viewModel.displayedCharts.contains(a):false};b.prototype.destroyChartById=function(a){this.destroyChart(this.viewModel.findDisplayedChartById(a))};b.prototype.destroyChart=function(a){if(!a||!this.canDestroyChart(a))return false;this.viewModel.displayedCharts.removeItem(a);this.app.command("ClearCharts").raiseCanExecuteChanged();
this.selector&&this.selector.hasItemViewModelFor(a)&&this.selector.unselectItem(a);a.destroyChartPoints();this.viewModel.cleanup();var d=this.findChartPaneForViewModel(a);return d?(this.app.command("DestroyView").execute(d.id),true):(this.app.trace.warning("Could not destroy chart '{0}': Chart not found.".format(a.chartId.get())),false)};b.prototype.canDestroyChart=function(a){return a&&this.viewModel?this.viewModel.displayedCharts.contains(a):false};b.prototype.clearCharts=function(){for(var a=this.viewModel.displayedCharts.getLength();a--;)this.destroyChart(this.viewModel.displayedCharts.getAt(a))};
b.prototype.handleSelectChart=function(a){this.addChart(a)};b.prototype.handleUnSelectChart=function(a){this.destroyChart(a)};b.prototype.handleClickClose=function(){this.deactivateContainer()};b.prototype.handleViewHostedEvent=function(a){this.viewModel&&a.region.name===this.viewModel.regionName.get()&&!c.framework.utils.ArrayUtils.contains(this._panes,a.view)&&this._panes.push(a.view)};b.prototype.handleViewUnhostedEvent=function(a){this.viewModel&&a.region.name===this.viewModel.regionName.get()&&
c.framework.utils.ArrayUtils.contains(this._panes,a.view)&&(c.framework.utils.ArrayUtils.removeItem(this._panes,a.view),c.framework.utils.ArrayUtils.removeItem(this._activePanes,a.view))};b.prototype.handleViewActivatedEvent=function(a){if(a&&this.viewModel){var d=this.app.viewManager.getRegionForViewId(a.id);if(d&&d.name===this.viewModel.regionName.get()){var d=c.framework.utils.ArrayUtils.contains(this._panes,a),b=c.framework.utils.ArrayUtils.contains(this._activePanes,a);d&&!b&&(this._activePanes.push(a),
this._resizeContainer())}}};b.prototype.handleViewDeactivatedEvent=function(a){if(a&&this.viewModel){var d=this.app.viewManager.getRegionForViewId(a.id);if(d&&d.name===this.viewModel.regionName.get()){var d=c.framework.utils.ArrayUtils.contains(this._panes,a),b=c.framework.utils.ArrayUtils.contains(this._activePanes,a);d&&b&&(c.framework.utils.ArrayUtils.removeItem(this._activePanes,a),this._resizeContainer())}}};b.prototype.handleViewDimensionsChangedEvent=function(a){a.view.id==="ShellView"&&this._resizeContainer()};
b.prototype.handleApplicationResizedEvent=function(){this._resizeContainer()};b.prototype._cancelDelayedResizeContainer=function(){this._delayedResizeHandle&&this._delayedResizeHandle.stop();this._delayedResizeHandle=null};b.prototype._delayedResizeContainer=function(){this._delayedResizeHandle=new c.framework.utils.TimeDelayedAction(0,this._resizeContainer,this);this._delayedResizeHandle.start();return this._delayedResizeHandle};b.prototype._resizeContainer=function(){this._cancelDelayedResizeContainer();
if(this.viewModel&&!(this.isActive===false||this._active===false)){var a=this.viewModel.regionType.get().indexOf("Stack")>-1,d=this.scrollRegionElement,b=$(".view.active .chart-pane",d);if(a&&b.length!==0){a=Math.floor(d.clientWidth/b.length-2);d=d.clientHeight;for(b=0;b<this._panes.length;b++){var c=this._panes[b];c&&c.viewModel&&(c.viewModel.setSize(a,d),c.refresh())}}}};b.prototype.findChartPaneForViewModel=function(a){return c.framework.utils.ArrayUtils.firstOrDefault(this._panes,function(d){return d&&
d.viewModel&&d.viewModel.currentChart.get()===a})};b.prototype._hostChartInPane=function(a){var d=this,b=new f.ChartPaneViewModel(this.app,this.libraryId);b.id="ChartPaneViewModel-"+c.framework.utils.alphaNumericToken();b.currentChart.set(a);b.responsiveLegendPositioning.set(!!this.app.configuration.mobileMode);b.initialize({title:a.chartDefinition.displayName,infrastructureLibraryId:this.viewModel.infrastructureLibraryId,headerIsVisible:this.viewModel.headerIsVisible.get(),showXButton:this.viewModel.showXButton.get()});
a=this.app.viewManager.createView({typeName:"geocortex.essentialsHtmlViewer.mapping.modules.charting.ChartPane",markupResource:"Mapping.Charting/modules/Charting/ChartPane.html",libraryId:this.libraryId||"Mapping.Charting",title:this.app.getResource(this.libraryId,"language-feature-charts"),regionName:this.viewModel.regionName.get(),isVisible:true,viewModel:b});a.onClose=function(a){return d.destroyChart(a)};return a};b.prototype._executeShowChartingView=function(){this.addDefaultCharts();this.viewModel.updateDisplayedCharts();
this.isActive===false&&this.activateContainer()};b.prototype._canExecuteShowChartingView=function(){if(this.viewModel&&this.viewModel.featureSetCollection.get())for(var a=this.viewModel.featureSetCollection.get().featureSets.getLength();a--;){var d=this.viewModel.featureSetCollection.get().featureSets.getAt(a);if(d.features&&d.layer&&d.layer.charts&&d.layer.charts.some(function(a){return a.chartDefinition.visible&&a.chartFeatureType===1}))return true}return false};b.prototype._canExecuteDisplayChartById=
function(a){return this.viewModel&&this.canAddChart(this.viewModel.findChartById(a))};b.prototype._canExecuteRemoveChartById=function(a){return this.viewModel&&this.canDestroyChart(this.viewModel.findDisplayedChartById(a))};b.prototype._canExecuteClearCharts=function(){return this.viewModel&&this.viewModel.displayedCharts.getLength()>0};return b}(c.essentialsHtmlViewer.mapping.infrastructure.ui.components.SmartPanel.SmartPanelView);f.ChartingView=e})(f.charting||(f.charting={}))})(f.modules||(f.modules=
{}))})(e.mapping||(e.mapping={}))})(c.essentialsHtmlViewer||(c.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(c){(function(e){(function(f){(function(e){(function(e){var g=function(c){function b(){c.apply(this,arguments)}__extends(b,c);b.prototype.attachAttributes=function(a,d){c.prototype.attachAttributes.call(this,a,d);if(d&&d.items&&d.items.length>0){for(var b=this._getFeatureFromChartPoint(d.items[0]),h=b?b.layer:null,b=[],e=0;e<d.items.length;e++){var g=this._getFeatureFromChartPoint(d.items[e]);g!==null&&g instanceof f.infrastructure.Feature&&b.push(g)}h=new f.infrastructure.FeatureSet({layer:h});
h.features.addItems(b);a.attributes=a.attributes||{};a.attributes.features=h}};b.prototype._getFeatureFromChartPoint=function(a){return a&&a.attributes&&a.attributes.hasOwnProperty("feature")?a.attributes.feature:null};return b}(c.charting.aggregation.ChartPointCollectionAggregator);e.ChartPointCollectionFeatureAggregator=g})(e.charting||(e.charting={}))})(f.modules||(f.modules={}))})(e.mapping||(e.mapping={}))})(c.essentialsHtmlViewer||(c.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(c){(function(e){(function(f){(function(e){(function(e){var g=function(){function e(){}e.findDataLinkingResultById=function(b,a){return b&&b.dataLinkingResults?c.framework.utils.ArrayUtils.firstOrDefault(b.dataLinkingResults.getItems(),function(d){return d!=null&&d.dataLink.get().id===a}):null};e.getFeaturesFromChartPoint=function(b){var a=null;if(b&&b.attributes)b.attributes.hasOwnProperty("feature")?(b=b.attributes.feature,b!==null&&b instanceof f.infrastructure.Feature&&(a=new f.infrastructure.FeatureSet({layer:b.layer}),
a.features.addItem(b))):b.attributes.hasOwnProperty("features")&&(a=b.attributes.features);return a};e.createCompareFunction=function(b){return function(a,d){var c=b(a),f=b(d);return c===f?0:c>f?1:-1}};e.applyChartOptions=function(b,a){b&&a&&b.setOptions(a)};return e}();e.ChartUtils=g})(e.charting||(e.charting={}))})(f.modules||(f.modules={}))})(e.mapping||(e.mapping={}))})(c.essentialsHtmlViewer||(c.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(c){(function(e){(function(f){(function(e){(function(e){var g=function(g){function b(){g.apply(this,arguments)}__extends(b,g);b.prototype.fill=function(a,d,b){if(b&&b.chartCategory&&b.chartSeries&&d&&d instanceof f.infrastructure.FeatureSet&&d.features.getLength()!=0){a||(a=new c.charting.ChartPointCollection);var h=d.features.getAt(0),i=e.ChartUtils.findDataLinkingResultById(h,b.chartSeries.field.dataLinkId);if(i&&!i.dataLink.get().isOneToOne)switch(b.chartFeatureType){case 0:this._fillFromDataLink(a,
h,i,b);break;case 1:for(var g=0;g<d.features.getLength();g++)h=d.features.getAt(g),(i=e.ChartUtils.findDataLinkingResultById(h,b.chartSeries.field.dataLinkId))&&this._fillFromDataLink(a,h,i,b)}else for(i=0;i<d.features.getLength();i++)h=d.features.getAt(i),(h=this.createChartPoint(h,b,null))&&a.items.push(h)}};b.prototype.createChartPoint=function(a,b,f){f===void 0&&(f=null);if(!b||!b.chartCategory||!b.chartSeries)return null;if(b.chartType==null||typeof b.chartType==="undefined")b.chartType=0;var e=
this.getFieldValue(b.chartSeries.field,a,f),i=null;switch(b.chartType){case 0:i=c.charting.ChartUtils.tryGetFieldValue(b.chartCategory.field,a,f)}return this.createChartPointCore(a,b.chartSeries.title,e,i,b,f)};b.prototype.getFieldValue=function(a,b,c){c===void 0&&(c=null);var h=c?c.dataLink:null,c=c?c.dataLinkRow:null;if(!b||!(b instanceof f.infrastructure.Feature))return null;if(!a||a.sourceType!=1)return null;h||(h=e.ChartUtils.findDataLinkingResultById(b,a.dataLinkId),c=null);if(!h||!h.table.get())return null;
if((b=h.table.get())&&b.rows.length>0)if(c||(c=b.rows[0]),a=b.columns.indexOf(a.name),a>-1)return c.row[a];return null};b.prototype._fillFromDataLink=function(a,b,f,e){if(b&&f){a||(a=new c.charting.ChartPointCollection);var i=f.table.get();if(i&&i.columns.length!=0)for(var g=0;g<i.rows.length;g++){var j=this.createChartPoint(b,e,{dataLink:f,dataLinkRow:i.rows[g]});j&&a.items.push(j)}}};b.prototype.attachAttributes=function(a,b,c,e){e===void 0&&(e=null);g.prototype.attachAttributes.call(this,a,b,c,
e);if(a&&b&&b instanceof f.infrastructure.Feature)a.attributes=a.attributes||{},a.attributes.feature=b};return b}(c.charting.ChartPointAdapterBase);e.DataLinkChartPointAdapter=g})(e.charting||(e.charting={}))})(f.modules||(f.modules={}))})(e.mapping||(e.mapping={}))})(c.essentialsHtmlViewer||(c.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(c){(function(e){(function(f){(function(e){(function(e){var g=function(e){function b(){e.apply(this,arguments)}__extends(b,e);b.prototype.fill=function(a,b,e){if(e&&e.chartCategory&&e.chartSeries&&b&&b instanceof f.infrastructure.FeatureSet){a||(a=new c.charting.ChartPointCollection);for(var h=0;h<b.features.getLength();h++){var g=this.createChartPoint(b.features.getAt(h),e);g&&a.items.push(g)}}};b.prototype.createChartPoint=function(a,b,e){e===void 0&&(e=null);if(!b||!b.chartCategory||!b.chartSeries)return null;
if(b.chartType==null||typeof b.chartType==="undefined")b.chartType=0;var f=this.getFieldValue(b.chartSeries.field,a,e),g=null;switch(b.chartType){case 0:g=c.charting.ChartUtils.tryGetFieldValue(b.chartCategory.field,a,e)}return this.createChartPointCore(a,b.chartSeries.title,f,g,b,e)};b.prototype.getFieldValue=function(a,b){if(!b||!(b instanceof f.infrastructure.Feature))return null;if(!a||a.sourceType!=0)return null;var c;if(b.attributes)for(var e=0;e<b.attributes.getLength();e++){var g=b.attributes.getAt(e);
if(g.name.get()==a.name){c=g;break}}return c?this._normalizeAttribute(c.value.get(),c.type.get()):(c=b.esriFeature.get())&&c.attributes?c.attributes[a.name]:null};b.prototype.attachAttributes=function(a,b,c,h){h===void 0&&(h=null);e.prototype.attachAttributes.call(this,a,b,c,h);if(a&&b&&b instanceof f.infrastructure.Feature)a.attributes=a.attributes||{},a.attributes.feature=b};b.prototype._normalizeAttribute=function(a,b){if(b)if(b.toLowerCase()==="datetime"){if(typeof a==="number"){var c=new Date(a);
c=="Invalid Date"&&(c=new Date(parseInt(a.toString())));return c}if(typeof a==="string"&&(c=Date.parse(a),typeof c==="number"))return new Date(c)}else if(["single","double","float"].indexOf(b.toLowerCase())>-1)return parseFloat(a);else if(["int32","short"].indexOf(b.toLowerCase())>-1)return parseInt(a);return a};return b}(c.charting.ChartPointAdapterBase);e.FeatureChartPointAdapter=g})(e.charting||(e.charting={}))})(f.modules||(f.modules={}))})(e.mapping||(e.mapping={}))})(c.essentialsHtmlViewer||
(c.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(c){(function(e){(function(e){(function(e){(function(e){var f=function(f){function b(a,b){f.call(this,a,b);this._chartPane=null;this.app.event("ApplicationResizedEvent").subscribe(this,this.handleApplicationResizedEvent)}__extends(b,f);b.prototype.attach=function(a){var b=this;f.prototype.attach.call(this,a);if(a)a.currentChart.bind(this,this._onCurrentChartChanged),a.onNewFeatureInitialized=function(){return b._onNewFeatureInitialized()}};b.prototype.activated=function(){f.prototype.activated.call(this);
this._refreshChartPane()};b.prototype.resolveWidget=function(a,b){var e=this;if(a==="ChartSelector")return this._selectorView=this.app.viewManager.createView({typeName:"geocortex.framework.ui.Selector.SelectorView",markup:"Framework.UI/geocortex/framework/ui/Selector/SelectorView.html",visible:true,app:this.app,libraryId:"Framework.UI"}),this.selector=new c.framework.ui.Selector.SelectorViewModel(this.app,this.libraryId,true),this.selector.setCollection(this.viewModel.charts,"displayName",null),this.selector.selectorText.set(this.app.getResource(this.libraryId,
"language-charting-selector-text")),this.selector.noItemsText.set(this.app.getResource(this.libraryId,"language-charting-no-items")),this.selector.onSelectItem=function(a){return e.handleSelectChart(a.item)},this.selector.onUnselectItem=function(a){return e.handleUnSelectChart(a.item)},this._selectorView.attach(this.selector),this._selectorView;else if(b&&a==="ChartPaneWidget")return this._chartPane=this._hostChartInPane(b);return f.prototype.resolveWidget.call(this,a,b)};b.prototype._hostChartInPane=
function(a){var b=this,f=new e.ChartPaneViewModel(this.app,this.libraryId);f.id="ChartPaneViewModel-"+c.framework.utils.alphaNumericToken();f.responsiveLegendPositioning.set(true);f.currentChart.set(a);f.initialize({title:a.chartDefinition.displayName,infrastructureLibraryId:this.viewModel.infrastructureLibraryId,headerIsVisible:true,showXButton:true});a=this.app.viewManager.createView({typeName:"geocortex.essentialsHtmlViewer.mapping.modules.charting.ChartPane",markupResource:"Mapping.Charting/modules/Charting/ChartPane.html",
libraryId:this.libraryId||"Mapping.Charting",isVisible:true,viewModel:f});a.onClose=function(a){return b.destroyChart(a)};return a};b.prototype.handleSelectChart=function(a){this.addChart(a)};b.prototype.handleUnSelectChart=function(a){this.destroyChart(a)};b.prototype.handleApplicationResizedEvent=function(){this.viewModel&&this._chartPane&&this._chartPane.refresh()};b.prototype.addChart=function(a){return a&&this.viewModel.currentChart.get()!==a?(a.chartPointCollection.get(),this.viewModel.currentChart.set(a),
this.selector.selectItem(a),this.handleApplicationResizedEvent(),this._chartPane):null};b.prototype.destroyChart=function(a){if(a&&this.viewModel.currentChart.get()===a){if(!this._chartPane)return this.app.trace.warning("Could not destroy chart '{0}': Chart not found.".format(a.chartId.get())),false;this.viewModel.currentChart.set(null);this.selector.unselectItem(a);a.destroyChartPoints();this.cleanup();return true}return false};b.prototype.cleanup=function(){if(this._chartPane)this._chartPane.destroy(),
this._chartPane=null};b.prototype._onCurrentChartChanged=function(a){a||this.cleanup()};b.prototype._onNewFeatureInitialized=function(){this.viewModel.charts.length()&&(this.addChart(this.viewModel.charts.getAt(0)),this._refreshChartPane())};b.prototype._refreshChartPane=function(){var a=this;setTimeout(function(){return a.handleApplicationResizedEvent()},0)};return b}(c.framework.ui.ViewBase);e.SingleFeatureChartView=f})(e.charting||(e.charting={}))})(e.modules||(e.modules={}))})(e.mapping||(e.mapping=
{}))})(c.essentialsHtmlViewer||(c.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));
(function(c){(function(e){(function(e){(function(g){(function(g){var l=function(g){function b(a,b){g.call(this,a,b);this._chartFactory=null;this._chartConfig={animationsEnabled:true,gradientsEnabled:false,interactiveLegendEnabled:false,interactiveChart:false,pieStartAngle:180,renderAs:"svg",chartWidth:0,chartHeight:0};this._syncSource=this._syncToken=null;this.charts=new ObservableCollection;this.currentChart=new Observable;this.infrastructureLibraryId="Charting";this.containerRegionName=new Observable("")}
__extends(b,g);b.prototype.onNewFeatureInitialized=function(){};b.prototype.getChartFactory=function(){if(this._chartFactory===null)this._chartFactory=this.app.getFrameworkObjectById("ChartViewModelFactory");return this._chartFactory};b.prototype.initialize=function(a){g.prototype.initialize.call(this,a);if(a){if(a.hasOwnProperty("infrastructureLibraryId"))this.infrastructureLibraryId=a.infrastructureLibraryId;a.hasOwnProperty("containerRegionName")&&this.containerRegionName.set(a.containerRegionName);
if(a=a.chartConfiguration){if(a.hasOwnProperty("chartWidth"))this._chartConfig.chartWidth=parseInt(a.chartWidth);if(a.hasOwnProperty("chartHeight"))this._chartConfig.chartHeight=parseInt(a.chartHeight);if(a.hasOwnProperty("renderAs"))this._chartConfig.renderAs=a.renderAs;if(a.hasOwnProperty("animationsEnabled"))this._chartConfig.animationsEnabled=!!a.animationsEnabled;if(a.hasOwnProperty("gradientsEnabled"))this._chartConfig.gradientsEnabled=!!a.gradientsEnabled;if(a.hasOwnProperty("interactiveLegendEnabled"))this._chartConfig.interactiveLegendEnabled=
!!a.interactiveLegendEnabled;if(a.hasOwnProperty("pieStartAngle"))this._chartConfig.pieStartAngle=a.pieStartAngle}}};b.prototype.handleCurrentFeatureChanged=function(a){this.charts.clear();this.currentChart.set(null);if(this._syncToken&&this._syncSource)this._syncSource.unbind(this._syncToken),this._syncToken=this._syncSource=null;var b=this.getChartFactory();if(b&&a&&a.layer&&a.layer.charts){for(var e=[],f=0;f<a.layer.charts.length;f++){var g=a.layer.charts[f];if(g&&g.chartDefinition.visible&&g.chartFeatureType==
0)g=b.createInstance(g.chartDefinition,0),g.tag=a.layer,this.applyChartOptions(g),e.push(g)}this.charts.addItems(e);if(this.charts.getItems().some(function(a){return c.charting.ChartUtils.containsDataLinks(a.chartDefinition)}))this._syncSource=a.dataLinkingResults,this._syncToken=a.dataLinkingResults.bind(this,this._handleDataLinksChanged);this.buildChartPointCollections(a);this.updateDisplayedCharts();this.onNewFeatureInitialized()}this.updateProviderState(!!this.charts.length())};b.prototype.applyChartOptions=
function(a){a&&a.setOptions(this._chartConfig)};b.prototype.updateDisplayedCharts=function(){this.currentChart.get()&&this.currentChart.get().chartPointCollection.get()};b.prototype.chartPointCollectionLoadDelegate=function(a,b){var c=this;return function(){if(c.getChartFactory()){var g=new e.infrastructure.FeatureSet({layer:b.layer,app:c.app});g.addFeature(b);return c.getChartFactory().createChartPointCollection(a.chartDefinition,g,0)}return null}};b.prototype.buildChartPointCollections=function(a){for(var b=
0;b<this.charts.getLength();b++){var c=this.charts.getAt(b),e=this.chartPointCollectionLoadDelegate(c,a),c=c.chartPointCollection;c.clear();c.delegateGetter=e;c.cacheDelegateResults=true}};b.prototype._handleDataLinksChanged=function(){this.buildChartPointCollections(this.currentFeature.get());this.updateDisplayedCharts()};return b}(e.infrastructure.featureDetails.FeatureProviderBase);g.SingleFeatureChartViewModel=l})(g.charting||(g.charting={}))})(e.modules||(e.modules={}))})(e.mapping||(e.mapping=
{}))})(c.essentialsHtmlViewer||(c.essentialsHtmlViewer={}))})(geocortex||(geocortex={}));geocortex.resourceManager.register("Mapping.Charting","inv","Mapping.Charting/modules/Charting/ChartingView.html","html","PGRpdiBjbGFzcz0idmlldy1jb250YWluZXItdmlldyBjaGFydGluZyIgZGF0YS1iaW5kaW5nPSJ7QHZhcjogY29udGFpbmVyRWxlbWVudH17QGNsYXNzLWNoYXJ0aW5nLW1vYmlsZTogbW9iaWxlTW9kZX17QG5vY2xhc3Mtbm8taGVhZGVyOiBoZWFkZXJJc1Zpc2libGV9Ij4gIDxkaXYgY2xhc3M9InBhbmVsLWhlYWRlciBiYW5uZXItbm9zZWxlY3QiIGRhdGEtYmluZGluZz0ie0B2aXNpYmxlOiBoZWFkZXJJc1Zpc2libGV9e0B2YXI6IGhlYWRlckVsZW1lbnR9e0BldmVudC1tb3VzZWRvd246IGhhbmRsZUhlYWRlck1vdXNlRG93bn0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtAZXZlbnQtdG91Y2hzdGFydDogaGFuZGxlSGVhZGVyVG91Y2hTdGFydH17QGNsYXNzLXJlc2l6ZS1ob3Jpem9udGFsLWhpbnQ6IHJlc2l6ZVh9e0BjbGFzcy1yZXNpemUtdmVydGljYWwtaGludDogcmVzaXplWX0iPiA8YnV0dG9uIGNsYXNzPSJwYW5lbC1oZWFkZXItYnV0dG9uIHJpZ2h0IGNsb3NlLTE2IiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogc2hvd1hCdXR0b259e0BldmVudC1vbmNsaWNrOiBoYW5kbGVDbGlja0Nsb3NlfXt0aXRsZTogQGxhbmd1YWdlLWNvbW1vbi1jbG9zZX0iPjwvYnV0dG9uPiA8YnV0dG9uIGNsYXNzPSJwYW5lbC1oZWFkZXItYnV0dG9uIHJpZ2h0IiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogc2hvd2luZ01heGltaXplQnV0dG9ufXtAY2xhc3MtbWluaW1pemUtMTY6IHBhbmVsTWF4aW1pemVkfXtAbm9jbGFzcy1tYXhpbWl6ZS0xNjogcGFuZWxNYXhpbWl6ZWR9e0BldmVudC1vbmNsaWNrOiBoYW5kbGVNYXhpbWl6ZVRvZ2dsZUNsaWNrfXtAZXZlbnQtdG91Y2hzdGFydDogaGFuZGxlTWF4aW1pemVUb2dnbGVDbGlja317dGl0bGU6IEBsYW5ndWFnZS1jaGFydGluZy1zbWFydC1wYW5lbC1tYXhpbWl6ZS1yZXN0b3JlfSI+PC9idXR0b24+IDxpbWcgc3JjPSJSZXNvdXJjZXMvSW1hZ2VzL0ljb25zL2NoYXJ0aW5nLTI0LnBuZyIgYWx0PSIgIiAvPiA8ZGl2IGRhdGEtYmluZGluZz0ie0B3aWRnZXQ6IENoYXJ0U2VsZWN0b3J9e0B3aWRnZXQtcmVwbGFjZTogdHJ1ZX0iPjwvZGl2PiA8L2Rpdj4gPGRpdiBjbGFzcz0icGFuZWwtc2Nyb2xsLWNvbnRhaW5lciIgZGF0YS1iaW5kaW5nPSJ7ZGF0YS1yZWdpb24tbmFtZTogcmVnaW9uTmFtZX17ZGF0YS1yZWdpb24tYWRhcHRlcjogcmVnaW9uVHlwZX17QHZhcjogc2Nyb2xsUmVnaW9uRWxlbWVudH17QGV2ZW50LW9uc2Nyb2xsOiBoYW5kbGVTY3JvbGxDaGFuZ2V9Ij48L2Rpdj4gPC9kaXY+IA==");
geocortex.resourceManager.register("Mapping.Charting","inv","Mapping.Charting/modules/Charting/ChartPane.html","html","PGRpdiBjbGFzcz0iY2hhcnQtcGFuZSIgZGF0YS1iaW5kaW5nPSJ7QHZhcjogY29udGFpbmVyRWxlbWVudH17QGNsYXNzLWF1dG8tc2l6ZTogYXV0b1NpemV9e0Bub2NsYXNzLW5vLWhlYWRlcjogaGVhZGVySXNWaXNpYmxlfSI+IDxkaXYgY2xhc3M9InBhbmVsLWhlYWRlciIgZGF0YS1iaW5kaW5nPSJ7QHZpc2libGU6IGhlYWRlcklzVmlzaWJsZX0iPiA8YnV0dG9uIGNsYXNzPSJwYW5lbC1oZWFkZXItYnV0dG9uIHJpZ2h0IGNsb3NlLTE2IiBkYXRhLWJpbmRpbmc9IntAdmlzaWJsZTogc2hvd1hCdXR0b259e0BldmVudC1vbmNsaWNrOiBoYW5kbGVDbGlja0Nsb3NlfXt0aXRsZTogQGxhbmd1YWdlLWNvbW1vbi1jbG9zZX0iPjwvYnV0dG9uPiA8aDIgY2xhc3M9InBhbmVsLXRpdGxlIj4gPGltZyBzcmM9IlJlc291cmNlcy9JbWFnZXMvbG9hZGVyLXNtYWxsLmdpZiIgZGF0YS1iaW5kaW5nPSJ7QHZpc2libGU6IHNob3dCdXN5SW5kaWNhdG9yfSIgYWx0PSIgIiAvPiA8c3BhbiBkYXRhLWJpbmRpbmc9IntAdGV4dDogdGl0bGV9e0B2aXNpYmxlOiB0aXRsZX0iPjwvc3Bhbj4gPC9oMj4gPC9kaXY+IDxkaXYgY2xhc3M9ImNoYXJ0LXBhbmUtYm9keSI+IDxkaXYgZGF0YS1iaW5kaW5nPSJ7QHdpZGdldDogQ2hhcnRXaWRnZXR9e0B3aWRnZXQtY29udGV4dDogY3VycmVudENoYXJ0fXtAd2lkZ2V0LXJlcXVpcmVkOiB0cnVlfXtAd2lkZ2V0LXJlcGxhY2U6IHRydWV9Ij48L2Rpdj4gPC9kaXY+IDwvZGl2PiA=");
geocortex.resourceManager.register("Mapping.Charting","inv","Mapping.Charting/modules/Charting/SingleFeatureChartView.html","html","PGRpdiBjbGFzcz0icGFuZWwtZ3JvdXAgc2luZ2xlLWZlYXR1cmUtY2hhcnQiIGRhdGEtYmluZGluZz0ie0B2YXI6IGNvbnRhaW5lckVsZW1lbnR9e0B2aXNpYmxlOiBwcm92aWRlckVuYWJsZWR9Ij4gPGgzIGRhdGEtYmluZGluZz0ie0B0ZXh0OiBAbGFuZ3VhZ2UtZmVhdHVyZS1jaGFydHN9Ij48L2gzPiA8ZGl2IGNsYXNzPSJzaW5nbGUtZmVhdHVyZS1jaGFydC1zZWxlY3RvciI+IDxpbWcgc3JjPSJSZXNvdXJjZXMvSW1hZ2VzL0ljb25zL2NoYXJ0aW5nLTI0LnBuZyIgYWx0PSIgIiAvPiA8ZGl2IGRhdGEtYmluZGluZz0ie0B3aWRnZXQ6IENoYXJ0U2VsZWN0b3J9e0B3aWRnZXQtcmVwbGFjZTogdHJ1ZX0iPjwvZGl2PiA8L2Rpdj4gPGRpdiBjbGFzcz0ic2luZ2xlLWZlYXR1cmUtY2hhcnQtd2lkZ2V0IiBkYXRhLWJpbmRpbmc9IntAd2lkZ2V0OiBDaGFydFBhbmVXaWRnZXR9e0B3aWRnZXQtY29udGV4dDogY3VycmVudENoYXJ0fXtAd2lkZ2V0LXJlcXVpcmVkOiBmYWxzZX0iPjwvZGl2PiA8L2Rpdj4g");
geocortex.resourceManager.register("Mapping.Charting","inv","Mapping.Charting/modules/Charting/CSS/common.css","css","LmNoYXJ0LXBhbmV7cG9zaXRpb246cmVsYXRpdmU7cGFkZGluZzowO21hcmdpbjowO292ZXJmbG93OmhpZGRlbjtiYWNrZ3JvdW5kOndoaXRlfS5jaGFydC1wYW5lIC5wYW5lbC1oZWFkZXIgaDJ7Zm9udC1zaXplOjEuMWVtfS5jaGFydC1wYW5lIC5wYW5lbC1oZWFkZXItYnV0dG9ue3dpZHRoOjEuN2VtfS5jaGFydC1wYW5lIC5jaGFydHt3aWR0aDphdXRvO21hcmdpbjphdXRvO2NsZWFyOmJvdGg7cGFkZGluZzowIC41ZW19LnNpbmdsZS1mZWF0dXJlLWNoYXJ0LXNlbGVjdG9ye3Bvc2l0aW9uOnJlbGF0aXZlO2Rpc3BsYXk6aW5saW5lLWJsb2NrO3dpZHRoOjEwMCU7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgI2VlZX0uc2luZ2xlLWZlYXR1cmUtY2hhcnQtc2VsZWN0b3IgaW1ne21hcmdpbjoxZW0gMCAwIDFlbTtsZWZ0OjA7dG9wOjA7cG9zaXRpb246YWJzb2x1dGV9LnNpbmdsZS1mZWF0dXJlLWNoYXJ0LXNlbGVjdG9yIC5mdWktc2VsZWN0b3J7dmVydGljYWwtYWxpZ246bWlkZGxlO3BhZGRpbmc6MWVtIC41ZW0gMWVtIDNlbTt3aWR0aDo4MCU7ZGlzcGxheTppbmxpbmUtYmxvY2s7ZmxvYXQ6bGVmdH0KLnNpbmdsZS1mZWF0dXJlLWNoYXJ0LXNlbGVjdG9yIC5mdWktc2VsZWN0b3ItaGVhZGVye3dpZHRoOjEwMCV9LnNpbmdsZS1mZWF0dXJlLWNoYXJ0LXNlbGVjdG9yIC5mdWktc2VsZWN0b3ItYm9keSBsaSBkaXZ7cGFkZGluZzoxZW19LnNpbmdsZS1mZWF0dXJlLWNoYXJ0LXNlbGVjdG9yIC5zZWxlY3Rvci1pdGVtIHNwYW57d2lkdGg6YXV0b30uc2luZ2xlLWZlYXR1cmUtY2hhcnQtc2VsZWN0b3IgLnNlbGVjdG9yLWl0ZW0gaW5wdXR7dmVydGljYWwtYWxpZ246bWlkZGxlO21hcmdpbi1yaWdodDouNWVtfS5zaW5nbGUtZmVhdHVyZS1jaGFydC13aWRnZXR7Y2xlYXI6Ym90aH0uc2luZ2xlLWZlYXR1cmUtY2hhcnQgLmNoYXJ0LXBhbmV7d2lkdGg6MTAwJTtoZWlnaHQ6MTAwJX0uRmVhdHVyZURldGFpbHNDb21wYWN0VmlldyAuY2hhcnQtcGFuZSAuY2hhcnR7bWluLWhlaWdodDo0MDBweDtoZWlnaHQ6MTAwJX0uQ2hhcnRpbmdWaWV3IC5jaGFydC1wYW5lIC5wYW5lbC1oZWFkZXIsLnNpbmdsZS1mZWF0dXJlLWNoYXJ0IC5jaGFydC1wYW5lIC5wYW5lbC1oZWFkZXJ7Ym9yZGVyOjB9Ci5GZWF0dXJlRGV0YWlsc0V4cGFuZGVkVmlldyAucmVnaW9uLXZpZXctc3dpdGNoZXIuYm91bmQtdmlzaWJsZSsucmVnaW9uIC52aWV3LmFjdGl2ZSAucGFuZWwtZ3JvdXAuc2luZ2xlLWZlYXR1cmUtY2hhcnR7dG9wOjIuMmVtfS5GZWF0dXJlRGV0YWlsc0V4cGFuZGVkVmlldyAuc2luZ2xlLWZlYXR1cmUtY2hhcnR7cG9zaXRpb246YWJzb2x1dGU7d2lkdGg6MTAwJTt0b3A6MDtib3R0b206MH0uRmVhdHVyZURldGFpbHNFeHBhbmRlZFZpZXcgLnNpbmdsZS1mZWF0dXJlLWNoYXJ0LXdpZGdldHtwb3NpdGlvbjphYnNvbHV0ZTttYXJnaW46MDt3aWR0aDoxMDAlO3RvcDozLjRlbTtib3R0b206MDttaW4taGVpZ2h0OjB9LkNoYXJ0aW5nVmlldyAuY2hhcnQtcGFuZSAuY2hhcnQsLkZlYXR1cmVEZXRhaWxzRXhwYW5kZWRWaWV3IC5jaGFydC1wYW5lIC5jaGFydHtoZWlnaHQ6MTAwJX0uQ2hhcnRpbmdWaWV3IC5jaGFydC1wYW5lLWJvZHksLkZlYXR1cmVEZXRhaWxzRXhwYW5kZWRWaWV3IC5jaGFydC1wYW5lLWJvZHl7cG9zaXRpb246YWJzb2x1dGU7d2lkdGg6MTAwJTt0b3A6My43NWVtO2JvdHRvbTowO292ZXJmbG93OmhpZGRlbjtiYWNrZ3JvdW5kOndoaXRlfQoubm8tdG91Y2ggLkNoYXJ0aW5nVmlldyAuY2hhcnQtcGFuZS1ib2R5LC5uby10b3VjaCAuRmVhdHVyZURldGFpbHNFeHBhbmRlZFZpZXcgLmNoYXJ0LXBhbmUtYm9keXt0b3A6M2VtfS5DaGFydGluZ1ZpZXcgLm5vLWhlYWRlciAuY2hhcnQtcGFuZS1ib2R5LC5GZWF0dXJlRGV0YWlsc0V4cGFuZGVkVmlldyAubm8taGVhZGVyIC5jaGFydC1wYW5lLWJvZHl7dG9wOjB9LkNoYXJ0aW5nVmlldyAucGFuZWwtaGVhZGVyIGltZ3tkaXNwbGF5OmlubGluZS1ibG9jazttYXJnaW4tbGVmdDouN2VtO3ZlcnRpY2FsLWFsaWduOm1pZGRsZX0uQ2hhcnRpbmdWaWV3IC5mdWktc2VsZWN0b3J7dmVydGljYWwtYWxpZ246bWlkZGxlO3BhZGRpbmc6MDttYXJnaW46MDt3aWR0aDoxNmVtO2Zsb2F0Om5vbmU7aGVpZ2h0OmF1dG99LkNoYXJ0aW5nVmlldyAuZnVpLXNlbGVjdG9yLWJvZHkgc3Bhbnt2ZXJ0aWNhbC1hbGlnbjp0b3A7bGluZS1oZWlnaHQ6MS42ZW07Zm9udC1zaXplOi45NWVtO2Rpc3BsYXk6aW5saW5lLWJsb2NrO3dpZHRoOjkzJX0KLkNoYXJ0aW5nVmlldyAuY2hhcnRpbmctbW9iaWxlIHVsLmZ1aS1zZWxlY3Rvci1ib2R5e3Bvc2l0aW9uOmZpeGVkO2xlZnQ6MDtyaWdodDowO3RvcDo0NXB4O2JvdHRvbTowO21heC1oZWlnaHQ6aW5pdGlhbDtib3JkZXI6MH0uQ2hhcnRpbmdWaWV3IC5jaGFydGluZy1tb2JpbGUgLmZ1aS1zZWxlY3Rvci1ib2R5LmV4cGFuZGVke2JvcmRlci1yaWdodDoxcHggc29saWQgI2NjY30uQ2hhcnRpbmdWaWV3IC5wYW5lbC1zY3JvbGwtY29udGFpbmVye2JvcmRlcjowO292ZXJmbG93OmhpZGRlbjt0b3A6My43NWVtO21hcmdpbi10b3A6MnB4fS5uby10b3VjaCAuQ2hhcnRpbmdWaWV3IC5wYW5lbC1zY3JvbGwtY29udGFpbmVye3RvcDozZW19LkNoYXJ0aW5nVmlldyAubm8taGVhZGVyIC5wYW5lbC1zY3JvbGwtY29udGFpbmVye3RvcDowO21hcmdpbjowfS5DaGFydGluZ1ZpZXcgLnBhbmVsLXNjcm9sbC1jb250YWluZXI+LnZpZXcuYWN0aXZle2Rpc3BsYXk6aW5saW5lLWJsb2NrO21hcmdpbjowfQouQ2hhcnRpbmdWaWV3IC5jaGFydC1wYW5le2JvcmRlci1sZWZ0OjFweCBzb2xpZCAjZWVlfS5DaGFydGluZ1ZpZXcgLmNoYXJ0aW5nLW1vYmlsZSAuY2hhcnQtcGFuZSAucGFuZWwtaGVhZGVyLWJ1dHRvbntkaXNwbGF5Om5vbmV9LmstY2hhcnQgLmstdG9vbHRpcHt3aGl0ZS1zcGFjZTpub3JtYWw7bWF4LXdpZHRoOjdlbX0uay1jaGFydCAuay10b29sdGlwPmRpdntvdmVyZmxvdzpoaWRkZW47dGV4dC1vdmVyZmxvdzplbGxpcHNpczt0ZXh0LWFsaWduOmxlZnR9");
geocortex.resourceManager.register("Mapping.Charting","inv","Mapping.Charting/modules/Charting/CSS/small.css","css","LmNoYXJ0LXBhbmUgLnBhbmVsLWhlYWRlci1idXR0b24uY2xvc2UtMTZ7ZGlzcGxheTpub25lfS5zaGVsbC1zbWFsbCAuY2hhcnQtcGFuZSAuY2hhcnR7cGFkZGluZzowfS5zaGVsbC1zbWFsbCAuY2hhcnQtcGFuZSAucGFuZWwtaGVhZGVye3BhZGRpbmc6MH0=");geocortex.resourceManager.register("Mapping.Charting","inv","Mapping.Charting/common.css","css","");geocortex.resourceManager.register("Mapping.Charting","inv","Invariant","json","eyJsYW5ndWFnZS1mcmFtZXdvcmstdWktdmlldy1jb250YWluZXItdmlldy1jbG9zZSI6IkNsb3NlIHswfSIsImxhbmd1YWdlLWNoYXJ0aW5nLXNtYXJ0LXBhbmVsLW1heGltaXplLXJlc3RvcmUiOiJNYXhpbWl6ZS9SZXN0b3JlIFBhbmVsIiwibGFuZ3VhZ2UtY29tbW9uLWNsb3NlIjoiQ2xvc2UiLCJsYW5ndWFnZS1jaGFydGluZy1zZWxlY3Rvci10ZXh0IjoiU2VsZWN0IENoYXJ0cyIsImxhbmd1YWdlLWZlYXR1cmUtY2hhcnRzIjoiQ2hhcnRzIiwibGFuZ3VhZ2UtY2hhcnRpbmctbm8taXRlbXMiOiJObyBjaGFydHMgdG8gZGlzcGxheSIsImxhbmd1YWdlLWZyYW1ld29yay11aS12aWV3LWNvbnRhaW5lci12aWV3LWJhY2siOiJHbyBCYWNrIHswfSJ9");
geocortex.framework.notifyLibraryDownload("Mapping.Charting");
