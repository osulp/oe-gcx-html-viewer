require({cache:{"Mapping/modules/SharingLink/SharingLinkModule":function(){var t,o=this&&this.__extends||(t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])})(e,r)},function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)});define(["require","exports","geocortex/framework/application/ModuleBase"],function(e,r,i){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var t,n=(t=i.ModuleBase,o(a,t),a.prototype.initialize=function(e){t.prototype.initialize.call(this,e),e&&(dojo.isArray(e.intrinsicUrlParameters)&&(this._intrinsicUrlParameters=e.intrinsicUrlParameters),dojo.isArray(e.sharingLinkProviders)&&this._loadProviders(e.sharingLinkProviders))},a.prototype.handleGenerateSharingLink=function(e){var r=window.location.href;-1<r.indexOf("?")&&(r=r.substring(0,r.indexOf("?")));for(var i=0;i<this._intrinsicUrlParameters.length;i++)this.app.getUrlParameter(this._intrinsicUrlParameters[i])&&(r+=-1<r.indexOf("?")?"&":"?",r+=encodeURIComponent(this._intrinsicUrlParameters[i])+"=",r+=encodeURIComponent(this.app.getUrlParameter(this._intrinsicUrlParameters[i])));for(i=0;i<this._providers.length;i++){var t=this._providers[i];t.generateParameter&&(r+=-1<r.indexOf("?")?"&":"?",r+=encodeURIComponent(t.name)+"=",r+=encodeURIComponent(t.generate()))}e(r)},a.prototype.handleAppInitialize=function(){if(this.app&&this.app.urlParameters){this._providers.sort(function(e,r){return e.priority-r.priority});for(var e=0;e<this._providers.length;e++)this._applyProvider(this._providers[e]);this._appInitialized=!0}},a.prototype._applyProvider=function(r){if(r.acceptParameter){var i=this.app.getUrlParameter(r.name);try{r.apply(i)}catch(e){this.app.trace.warning("SharingLinkModule: Could not apply the url parameter '{0}={1}'".format(r.name,i))}}},a.prototype._loadProviders=function(e){for(var r=0;r<e.length;r++){var i=e[r];i&&(i.libraryId&&!this.app.allLibrariesLoaded?this._loadProvidersWhenLibrariesDownloaded(i):this._loadProvider(i))}},a.prototype._loadProvidersWhenLibrariesDownloaded=function(r){var i=this;this.app.event("ViewerLibrariesDownloadedEvent").once(this,function(){var e=i._loadProvider(r);i._appInitialized&&i._applyProvider(e)})},a.prototype._loadProvider=function(e){var r=dojo.getObject(e.type);if(r){var i=new r(this.app,e.libraryId||this.libraryId);return i.acceptParameter=!(!1===e.apply),i.generateParameter=!(!1===e.generate),e.name&&(i.name=e.name),i.initialize(e.configuration||{}),this._providers.push(i),i}this.app.trace.error(this.id+" can't find sharing link provider typed "+e.type)},a);function a(e,r){var i=t.call(this,e,r)||this;return i._providers=[],i._intrinsicUrlParameters=["configBase","viewer","viewerConfigUri"],i._appInitialized=!1,i.app.command("HandleGenerateSharingLink").register(i,i.handleGenerateSharingLink),dojo.connect(i.app,"initializationCompleteCallback",function(){return i.handleAppInitialize()}),i}r.SharingLinkModule=n})}}}),require({cache:{}}),define(["Mapping/modules/SharingLink/SharingLinkModule"],function(e){!function(e,r,i){if("string"==typeof e&&(i=r,r=e),void 0!==i)for(var t=r.split("."),n=null,a=window,o=0,p=t.length;o<p;o++)n=t[o],o==p-1?a[n]=i:a[n]||(a[n]={}),a=a[n];else console.warn("Undefined shim for: "+r)}(e,"geocortex.essentialsHtmlViewer.mapping.modules.sharingLink.SharingLinkModule",e.SharingLinkModule)});