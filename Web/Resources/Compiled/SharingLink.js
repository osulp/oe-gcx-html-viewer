!function(){require({cache:{"Mapping/modules/SharingLink/SharingLinkModule":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])};return function(r,i){function n(){this.constructor=r}e(r,i),r.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define(["require","exports","geocortex/framework/application/ModuleBase"],function(r,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var t=function(r){function i(e,i){var n=r.call(this,e,i)||this;return n._providers=[],n._intrinsicUrlParameters=["configBase","viewer","viewerConfigUri"],n._appInitialized=!1,n.app.command("HandleGenerateSharingLink").register(n,n.handleGenerateSharingLink),dojo.connect(n.app,"initializationCompleteCallback",function(){return n.handleAppInitialize()}),n}return e(i,r),i.prototype.initialize=function(e){r.prototype.initialize.call(this,e),e&&(dojo.isArray(e.intrinsicUrlParameters)&&(this._intrinsicUrlParameters=e.intrinsicUrlParameters),dojo.isArray(e.sharingLinkProviders)&&this._loadProviders(e.sharingLinkProviders))},i.prototype.handleGenerateSharingLink=function(e){var r=window.location.href;r.indexOf("?")>-1&&(r=r.substring(0,r.indexOf("?")));for(var i=0;i<this._intrinsicUrlParameters.length;i++)this.app.getUrlParameter(this._intrinsicUrlParameters[i])&&(r+=r.indexOf("?")>-1?"&":"?",r+=encodeURIComponent(this._intrinsicUrlParameters[i])+"=",r+=encodeURIComponent(this.app.getUrlParameter(this._intrinsicUrlParameters[i])));for(i=0;i<this._providers.length;i++){var n=this._providers[i];n.generateParameter&&(r+=r.indexOf("?")>-1?"&":"?",r+=encodeURIComponent(n.name)+"=",r+=encodeURIComponent(n.generate()))}e(r)},i.prototype.handleAppInitialize=function(){if(this.app&&this.app.urlParameters){this._providers.sort(function(e,r){return e.priority-r.priority});for(var e=0;e<this._providers.length;e++)this._applyProvider(this._providers[e]);this._appInitialized=!0}},i.prototype._applyProvider=function(e){if(e.acceptParameter){var r=this.app.getUrlParameter(e.name);try{e.apply(r)}catch(i){this.app.trace.warning("SharingLinkModule: Could not apply the url parameter '{0}={1}'".format(e.name,r))}}},i.prototype._loadProviders=function(e){for(var r=0;r<e.length;r++){var i=e[r];i&&(i.libraryId&&!this.app.allLibrariesLoaded?this._loadProvidersWhenLibrariesDownloaded(i):this._loadProvider(i))}},i.prototype._loadProvidersWhenLibrariesDownloaded=function(e){var r=this;this.app.event("ViewerLibrariesDownloadedEvent").once(this,function(){var i=r._loadProvider(e);r._appInitialized&&r._applyProvider(i)})},i.prototype._loadProvider=function(e){var r=dojo.getObject(e.type);{if(r){var i=new r(this.app,e.libraryId||this.libraryId);return i.acceptParameter=!(!1===e.apply),i.generateParameter=!(!1===e.generate),e.name&&(i.name=e.name),i.initialize(e.configuration||{}),this._providers.push(i),i}this.app.trace.error(this.id+" can't find sharing link provider typed "+e.type)}},i}(n.ModuleBase);i.SharingLinkModule=t})}}}),require({cache:{}}),define(["Mapping/modules/SharingLink/SharingLinkModule"],function(e){!function(e,r,i){if("string"==typeof e&&(i=r,r=e),void 0!==i)for(var n=r.split("."),t=null,a=window,o=0,p=n.length;o<p;o++)t=n[o],o==p-1?a[t]=i:a[t]||(a[t]={}),a=a[t];else console.warn("Undefined shim for: "+r)}(e,"geocortex.essentialsHtmlViewer.mapping.modules.sharingLink.SharingLinkModule",e.SharingLinkModule)})}();