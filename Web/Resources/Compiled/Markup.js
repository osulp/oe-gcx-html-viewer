!function(){function e(e,t,i){if("string"==typeof e&&(i=t,t=e),void 0!==i)for(var o=t.split("."),a=null,r=window,l=0,n=o.length;l<n;l++)a=o[l],l==n-1?r[a]=i:r[a]||(r[a]={}),r=r[a];else console.warn("Undefined shim for: "+t)}var t="<div class='markup-style panel-group-contents gcx-sticky-content has-footer'>    \x3c!-- Markup type selector --\x3e    <div class='markup-type-selector form-item' data-binding='{@visible: showMarkupSelectorMenu}'>        <label class='symbology-label' for='markupStyleSelector' data-binding='{@text: @language-markup-select-style-type}'></label>        <select id='markupStyleSelector' data-binding='{@source: markupSelectors}{@value: currentSelector}{@event-onchange: handleSelectorChange}' class='symbology-select'>            <option data-binding='{@template-for: markupSelectors}{@text: displayName}{@attach: @context}'></option>        </select>    </div>    \x3c!-- BEGIN: Content region --\x3e    <div class='markup-style-selector' data-binding='{data-region-name: regionName}{data-region-adapter: regionType}{@var: scrollRegionElement}{@event-onscroll: handleScrollChange}'></div>    \x3c!-- END: Content region --\x3e</div><div class='form-btns gcx-sticky-footer'>    <button class='button' data-binding='{@event-click: handleDoneButtonClick}{@text: @language-common-done}'></button>    <button class='button' data-binding='{@event-click: handleCustomizeButtonClick}{@text: @language-common-customize}{@visible: showCustomizeButton}'></button>    <button class='button' data-binding='{@event-click: handleRevertButtonClick}{@text: @language-common-revert}{@visible: showRevertButton}'></button></div>",i="\x3c!-- BEGIN: Content region --\x3e<div class='markup-configuration-selector' data-region-name='MarkupStyleConfigurationRegion' data-region-adapter='geocortex.framework.ui.MultiDivRegionAdapter'></div>\x3c!-- END: Content region --\x3e",o="\x3c!-- Symbol Text --\x3e<div class='symbology-textinput' data-binding='{@visible: isText}'>    <div class='form-item' data-binding='{@hidden: noTextLibraries}'>        <label class='symbology-label' data-binding='{@text: @language-common-text}{for: symbologyTextInputId}'></label>        <input type='text' data-binding='{@value: symbolText}{@event-oninput: handleTextChange}{@event-onchange: handleTextChange}{id: symbologyTextInputId}' />    </div></div>\x3c!-- Current Template Name --\x3e<div data-binding='{@source: currentTemplate}'>    <span class='symbol-name' data-binding='{@template-for: currentTemplate}{@text: name}'></span></div>\x3c!-- Point Templates --\x3e<div class='style-selector markup point' data-binding='{@visible: isPoint}'>    \x3c!-- Template Selector --\x3e    <div class='swatch-container template-container' data-binding='{@source: currentPointTemplates}{@hidden: noPointLibraries}'>        <button class='markup-swatch markup-swatch-point' data-binding='{@template-for: currentPointTemplates}{@class-selected: selected}{aria-label: name}'></button>    </div>    \x3c!-- Library Switcher --\x3e    <span class='image-library-selector form-item inline-block' data-binding='{@visible: showLibrarySwitcher}'>        <label class='symbology-label' data-binding='{for: pointLibrarySwitcherId}{@text: @language-common-library}'></label>        <select data-binding='{id: pointLibrarySwitcherId}{@source: pointLibraries}{@value: currentPointLibrary}{@event-oninput: handleLibraryChange}{@event-onchange: handleLibraryChange}'>            <option data-binding='{@template-for: pointLibraries}{@text: @context}{@attach: @context}'></option>        </select>    </span>    <div class='no-symbol-library' data-binding='{@visible: noPointLibraries}'>        <span data-binding='{@text: @language-markup-nolibraries}' />    </div></div>\x3c!-- Polyline Templates --\x3e<div class='style-selector markup polyline' data-binding='{@visible: isLine}'>    \x3c!-- Template Selector --\x3e    <div class='swatch-container template-container' data-binding='{@source: currentLineTemplates}{@hidden: noLineLibraries}'>        <button class='markup-swatch markup-swatch-polyline' data-binding='{@template-for: currentLineTemplates}{@class-selected: selected}{aria-label: name}'></button>    </div>    \x3c!-- Library Switcher --\x3e    <span class='image-library-selector form-item inline-block' data-binding='{@visible: showLibrarySwitcher}'>        <label class='symbology-label' data-binding='{for: lineLibrarySwitcherId}{@text: @language-common-library}'></label>        <select data-binding='{id: lineLibrarySwitcherId}{@source: lineLibraries}{@value: currentLineLibrary}{@event-oninput: handleLibraryChange}{@event-onchange: handleLibraryChange}'>            <option data-binding='{@template-for: lineLibraries}{@text: @context}{@attach: @context}'></option>        </select>    </span>    <div class='no-symbol-library' data-binding='{@visible: noLineLibraries}'>        <span data-binding='{@text:  @language-markup-nolibraries}' />    </div></div>\x3c!-- Polygon Templates --\x3e<div class='style-selector markup polygon' data-binding='{@visible: isPolygon}'>    \x3c!-- Template Selector --\x3e    <div class='swatch-container template-container' data-binding='{@source: currentPolygonTemplates}{@hidden: noPolygonLibraries}'>        <button class='markup-swatch markup-swatch-polygon' data-binding='{@template-for: currentPolygonTemplates}{@class-selected: selected}{aria-label: name}'></button>    </div>    \x3c!-- Library Switcher --\x3e    <span class='image-library-selector form-item inline-block' data-binding='{@visible: showLibrarySwitcher}'>        <label class='symbology-label' data-binding='{for: polygonLibrarySwitcherId}{@text: @language-common-library}'></label>        <select data-binding='{id: polygonLibrarySwitcherId}{@source: polygonLibraries}{@value: currentPolygonLibrary}{@event-oninput: handleLibraryChange}{@event-onchange: handleLibraryChange}'>            <option data-binding='{@template-for: polygonLibraries}{@text: @context}{@attach: @context}'></option>        </select>    </span>    <div class='no-symbol-library' data-binding='{@visible: noPolygonLibraries}'>        <span data-binding='{@text:  @language-markup-nolibraries}' />    </div></div>\x3c!-- Text Templates --\x3e<div class='style-selector markup text' data-binding='{@visible: isText}'>    \x3c!-- Template Selector --\x3e    <div class='swatch-container template-container' data-binding='{@source: currentTextTemplates}{@hidden: noTextLibraries}'>        <button class='markup-swatch markup-swatch-text' data-binding='{@template-for: currentTextTemplates}{@class-selected: selected}'></button>    </div>    \x3c!-- Library Switcher --\x3e    <span class='image-library-selector form-item inline-block' data-binding='{@visible: showLibrarySwitcher}'>        <label class='symbology-label' data-binding='{for: textLibrarySwitcherId}{@text: @language-common-library}'></label>        <select data-binding='{id: textLibrarySwitcherId}{@source: textLibraries}{@value: currentTextLibrary}{@event-oninput: handleLibraryChange}{@event-onchange: handleLibraryChange}'>            <option data-binding='{@template-for: textLibraries}{@text: @context}{@attach: @context}'></option>        </select>    </span>    <div class='no-symbol-library' data-binding='{@visible: noTextLibraries}'>        <span data-binding='{@text:  @language-markup-nolibraries}'/>    </div></div>",a="<div class='toolbar-tool-mode'>    <button class='tbtm-done' data-binding='{@event-onclick: handleClickDone}'>        <span data-binding='{@text: @language-menu-done}'></span>    </button>    <div class='tbtm-list'>        <ul class='two'>            <li>                <button class='tbtm-btn' data-binding='{@event-onclick: handleClickEdit}'>                    <span class='icon icon-draw-edit-24'></span>                </button>                <label data-binding='{@text: @language-toolbar-markup-palette-small-edit}'></label>            </li>            <li>                <button class='tbtm-btn' data-binding='{@event-onclick: handleClickClear}{@disabled: clearDisabled}'>                    <span class='icon icon-clear-24'></span>                </button>                <label data-binding='{@text: @language-toolbar-clear-all}'></label>            </li>        </ul>    </div></div>",r="<ul class='markup-edit'>    <li>        <button class='toolbar-item' data-binding='{@disabled: changeStyleDisabled}{@event-onclick: handleClickChangeStyle}{title: @language-toolbar-markup-change-markup-style-tooltip}'>            <span class='icon icon-swatch-picker-24'></span>            <p data-binding='{@text: @language-toolbar-markup-palette-small-change-style}'></p>        </button>    </li></ul>",l="<div class='toolbar-tool-mode'>    <button class='tbtm-done' data-binding='{@event-onclick: handleClickDone}'>        <span data-binding='{@text: @language-menu-done}'></span>    </button>    <div class='tbtm-list'>        <ul class='three'>            <li>                <button class='tbtm-btn' data-binding='{@event-onclick: handleClickChangeStyle}{@disabled: changeStyleDisabled}'>                    <span class='icon icon-swatch-picker-24'></span>                </button>                <label data-binding='{@text: @language-toolbar-markup-palette-small-change-style}'></label>            </li>            <li>                <button class='tbtm-btn' data-binding='{@event-onclick: handleClickDelete}{@disabled: clearDisabled}'>                    <span class='icon icon-draw-edit-24'></span>                </button>                <label data-binding='{@text: @language-toolbar-markup-palette-small-delete}'></label>            </li>            <li>                <button class='tbtm-btn' data-binding='{@event-onclick: handleClickClear}{@disabled: clearDisabled}'>                    <span class='icon icon-clear-24'></span>                </button>                <label data-binding='{@text: @language-toolbar-clear-all}'></label>            </li>        </ul>    </div></div>",n="<div class='toolbar-tool-mode'>    <div class='tbtm-done' data-binding='{@event-onclick: handleClickDone}'>        <span data-binding='{@text: @language-menu-done}'></span>    </div>    <div class='tbtm-list'>        <ul class='transient-element markup four'>            <li>                <button class='tbtm-btn' data-binding='{@disabled: changeStyleDisabled}{@event-onclick: handleClickChangeStyle}'>                    <span class='icon icon-swatch-picker-24'></span>                    <p data-binding='{@text: @language-toolbar-markup-palette-small-change-style}'></p>                </button>            </li>            <li>                <button class='tbtm-btn' data-binding='{@class-highlight: editToggled}{@event-onclick: handleClickEdit}'>                    <span class='icon icon-draw-edit-24'></span>                    <p data-binding='{@text: @language-toolbar-markup-palette-small-edit}'></p>                </button>            </li>            <li>                <button class='tbtm-btn' data-binding='{@disabled: clearDisabled}{@class-highlight: deleteToggled}{@event-onclick: handleClickDelete}'>                    <span class='icon icon-erase-24'></span>                    <p data-binding='{@text: @language-toolbar-erase}'></p>                </button>            </li>            <li>                <button class='tbtm-btn' data-binding='{@disabled: clearDisabled}{@event-onclick: handleClickClear}'>                    <span class='icon icon-clear-24'></span>                    <p data-binding='{@text: @language-toolbar-clear-all}'></p>                </button>            </li>        </ul>    </div></div>";require({cache:{"Mapping/modules/Markup/MarkupModule":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define(["require","exports","geocortex/framework/application/ModuleBase"],function(t,i,o){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return e(i,t),i}(o.ModuleBase);i.MarkupModule=a})},"Mapping/modules/Markup/MarkupViewModel":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define(["require","exports","geocortex/framework/ui/ViewModelBase","geocortex/infrastructure/SymbolUtils","geocortex/framework/observables","geocortex/infrastructure/ColorUtils","geocortex/essentials/GeometryUtilities","geocortex/infrastructure/FeatureSetCollection","geocortex/infrastructure/FeatureSet","geocortex/infrastructure/symbology/SymbolType","geocortex/infrastructure/tools/MapTool","geocortex/infrastructure/tools/DrawMode","geocortex/infrastructure/coordinates/CoordinatesManager","geocortex/infrastructure/accessibility/Edit","geocortex/infrastructure/GraphicUtils","geocortex/infrastructure/GraphicsLayerUtils","geocortex/infrastructure/GraphicsLayerIds","geocortex/infrastructure/SymbolUtils","geocortex/infrastructure/BrowserUtils"],function(t,i,o,a,r,l,n,s,p,u,c,m,d,y,b,g,h,S,M){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var k=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.markupTools={point:[],polyline:[],polygon:[],text:[]},e.editToolbar=null,e.editToolbarTool=esri.toolbars.Edit.MOVE|esri.toolbars.Edit.EDIT_VERTICES|esri.toolbars.Edit.SCALE|esri.toolbars.Edit.ROTATE,e.markupType=new r.Observable(u.SymbolType.POINT),e.currentSymbol=new r.Observable(a.defaultMarkerSymbol()),e._originalGraphic=null,e._modifiedGraphic=null,e._clearStyleViewTimeout=null,e._editToolbarMoveStartedHandle=null,e._editToolbarMoveStoppedHandle=null,e._editToolbarDeactivatedHandle=null,e._editToolbarRotateHandle=null,e._editToolbarScaleHandle=null,e._editToolbarInputMethodChangeHandle=null,e._isIE9or11=!1,e._markerSymbol=a.defaultMarkerSymbol(),e._lineSymbol=a.defaultLineSymbol(),e._polyFillSymbol=a.defaultFillSymbol(),e._polyBorderSymbol=a.defaultLineSymbol(),e._textSymbol=null,e._fontSymbol=null,e._coordinatesPointBuffer=35,e._coordinatesSmsSymbolBuffer=15,e}return e(i,t),i.prototype.initialize=function(e){var t=this,i=M.isIE();if(this._isIE9or11=9===i||11===i,this._textSymbol=a.defaultTextSymbol(this._isIE9or11),this._fontSymbol=this._textSymbol.font,e.markupLayerName&&h.changeGraphicsLayerIdBase(e.markupLayerName),11===i&&this.app.doWhenMapInitialized(function(){var e=g.getInternalGraphicsLayer(h.MARKUP_LAYER_ID,t.app,g.GraphicsLayerType.Markup,!0);e&&t.app.markupLayer.set(e)}),e.defaultPointMarkup&&(e.defaultPointMarkup.pointStyle&&this._markerSymbol.setStyle(e.defaultPointMarkup.pointStyle.toLowerCase()),e.defaultPointMarkup.pointSize&&this._markerSymbol.setSize(e.defaultPointMarkup.pointSize),e.defaultPointMarkup.pointColor)){var o=l.getColorFromString(e.defaultPointMarkup.pointColor);this._markerSymbol.setColor(o),this._markerSymbol.outline.setColor(o)}S.setDefaultPointMarkup(this._markerSymbol),e.defaultLineMarkup&&(e.defaultLineMarkup.lineStyle&&this._lineSymbol.setStyle(e.defaultLineMarkup.lineStyle.toLowerCase()),e.defaultLineMarkup.lineWidth&&this._lineSymbol.setWidth(e.defaultLineMarkup.lineWidth),e.defaultLineMarkup.lineColor&&this._lineSymbol.setColor(l.getColorFromString(e.defaultLineMarkup.lineColor))),S.setDefaultPolylineMarkup(this._lineSymbol),e.defaultPolygonMarkup&&(e.defaultPolygonMarkup.polygonBorderStyle&&this._polyBorderSymbol.setStyle(e.defaultPolygonMarkup.polygonBorderStyle.toLowerCase()),e.defaultPolygonMarkup.polygonFillStyle&&this._polyFillSymbol.setStyle(e.defaultPolygonMarkup.polygonFillStyle.toLowerCase()),e.defaultPolygonMarkup.polygonBorderWidth&&this._polyBorderSymbol.setWidth(e.defaultPolygonMarkup.polygonBorderWidth),e.defaultPolygonMarkup.polygonFillColor&&this._polyFillSymbol.setColor(l.getColorFromString(e.defaultPolygonMarkup.polygonFillColor)),e.defaultPolygonMarkup.polygonBorderColor&&this._polyBorderSymbol.setColor(l.getColorFromString(e.defaultPolygonMarkup.polygonBorderColor)),this._polyFillSymbol.setOutline(this._polyBorderSymbol)),S.setDefaultPolygonMarkup(this._polyFillSymbol),e.defaultTextMarkup&&(e.defaultTextMarkup.textStyle&&this._fontSymbol.setStyle(e.defaultTextMarkup.textStyle.toLowerCase()),e.defaultTextMarkup.textWeight&&this._fontSymbol.setWeight(e.defaultTextMarkup.textWeight.toLowerCase()),e.defaultTextMarkup.textSize&&this._fontSymbol.setSize(e.defaultTextMarkup.textSize),e.defaultTextMarkup.textColor&&this._textSymbol.setColor(l.getColorFromString(e.defaultTextMarkup.textColor)),e.defaultTextMarkup.textFamily&&this._fontSymbol.setFamily(e.defaultTextMarkup.textFamily),e.defaultTextMarkup.textHaloColor&&!this._isIE9or11&&this._textSymbol.setHaloColor(l.getColorFromString(e.defaultTextMarkup.textHaloColor)),e.defaultTextMarkup.textHaloSize&&!this._isIE9or11&&this._textSymbol.setHaloSize(e.defaultTextMarkup.textHaloSize)),S.setDefaultTextMarkup(this._textSymbol),this.app.toolRegistry.registerToolTypeForCommand("EditMarkup","geocortex.essentialsHtmlViewer.mapping.infrastructure.tools.DisablingMapTool"),this.app.toolRegistry.registerToolTypeForCommand("DeleteMarkup","geocortex.essentialsHtmlViewer.mapping.infrastructure.tools.DisablingMapTool"),this.markupTools.point=this.markupTools.point.concat(e.customMarkupTools.point),this.markupTools.polyline=this.markupTools.polyline.concat(e.customMarkupTools.polyline),this.markupTools.polygon=this.markupTools.polygon.concat(e.customMarkupTools.polygon),this.markupTools.text=this.markupTools.text.concat(e.customMarkupTools.text),this.markupType.bind(this,function(e){e===u.SymbolType.MULTIPOINT&&(e=u.SymbolType.POINT),"extent"===e&&(e=u.SymbolType.POLYGON),t.app.event("MarkupTypeChangedEvent").publish(e)}),this.currentSymbol.bind(this,function(e){t.app.event("MarkupSymbolChangedEvent").publish(e)}),this.currentSymbol.set(this._markerSymbol),this.initializeCommands(),this.initializeEvents()},i.prototype.initializeCommands=function(){var e=this;this.app.command("AddMarkup").register(this,this.executeAddMarkupCommand,this.canExecuteAddMarkupCommand),this.app.command("AddMarkupFeature").register(this,this.executeAddMarkupFeatureCommand,this.canExecuteAddMarkupFeatureCommand),this.app.command("AddMarkupGeometry").register(this,this.executeAddMarkupCommand,this.canExecuteAddMarkupCommand),this.app.command("AddTextMarkup").register(this,this.executeAddTextMarkupCommand,this.canExecuteAddTextMarkupCommand),this.app.command("ClearMarkup").register(this,this.executeClearMarkupCommand,this.canExecuteClearMarkupCommand),this.app.command("ClearMarkupQuiet").register(this,this.executeClearMarkupQuietCommand,this.canExecuteClearMarkupQuietCommand),this.app.command("EditMarkup").register(this,this.executeEditMarkupCommand,this.canExecuteEditMarkupCommand),this.app.command("DeleteMarkup").register(this,this.executeDeleteMarkupCommand,this.canExecuteDeleteMarkupCommand),this.app.command("ExportMarkupLayer").register(this,this.executeExportMarkupLayerCommand,this.canExecuteExportMarkupLayerCommand),this.app.command("ExportGraphicsLayer").register(this,this.executeExportGraphicsLayerCommand),this.app.command("ChangeMarkupStyle").register(this,this.executeChangeMarkupStyleCommand,this.canExecuteChangeMarkupStyleCommand),this.app.command("CreateMarkupStyleView").register(this,this.executeCreateStyleViewCommand,this.canExecuteCreateStyleViewCommand),this.app.command("StopEditingMarkup").register(this,this.executeStopEditingCommand,this.canExecuteStopEditingCommand),this.app.command("_applySymbolToEditedMarkup").register(this,this._applySymbolToEditedMarkup,function(){return!!e.editToolbar}),this._initializeClickableGraphicCommands(),this.app.event("ProjectLoadedEvent").once(this,function(){var t=e.app.map.getLayer(h.MARKUP_LAYER_ID);t&&(g.registerMarkupLayerAsClickable(t,e.app),e.app.command("ExportMarkupLayer").raiseCanExecuteChanged())})},i.prototype._initializeClickableGraphicCommands=function(){this.app.command("StopAndAutoEditClickableFeature").register(this,this.executeStopAndAutoEditClickableFeature,this.canExecuteAutoEditClickableFeature),this.app.command("EditClickableFeature").register(this,this.executeEditClickableFeature,b.isEditableButNotAutoEditableClickableFeature),this.app.command("StopEditingClickableFeature").register(this,this.executeStopEditingClickableFeature,this.canExecuteStopEditingClickableFeature),this.app.command("DeleteClickableFeature").register(this,this.executeDeleteClickableFeature,this.canExecuteDeleteClickableFeature),this.app.command("HighlightFeature").register(this,function(){},this._canHighlightClickableFeature),this.app.command("HighlightFeatures").register(this,function(){},this._canHighlightClickableFeature),this.app.command("ClearAndHighlightFeatures").register(this,function(){},this._canHighlightClickableFeature),this.app.command("HighlightFeatureDefault").register(this,function(){},this._canHighlightClickableFeature)},i.prototype._canHighlightClickableFeature=function(e){var t=e&&e.esriFeature?e.esriFeature.get():null;if(!t)return!0;if(b.isClickableGraphic(this.app,t)){var i=b.getClickableLayerInfo(this.app,t),o=b.getCapabilitiesForGraphic(this.app,t);if(this._hasCapability("edit",o)&&i.autoEditable)return!1}return!0},i.prototype.initializeEvents=function(){var e=this;this.app.event("ActiveToolChangedEvent").subscribe(this,function(t){e.app.command("CreateMarkupStyleView").raiseCanExecuteChanged(),e.app.command("ExportMarkupLayer").raiseCanExecuteChanged(),e.app.command("StopEditingMarkup").execute(),t.tool?(null!==e._clearStyleViewTimeout&&(clearTimeout(e._clearStyleViewTimeout),e._clearStyleViewTimeout=null),e._handleActiveToolChanged(t.tool)):e._clearStyleViewTimeout=setTimeout(function(){e.app.command("HideMarkupStyleView").execute()},250)}),this.app.event("GraphicRemovedEvent").subscribe(this,function(t){return e._onGraphicDeleted(t)})},i.prototype.canExecuteAddMarkupCommand=function(e){return!!e},i.prototype.executeAddMarkupCommand=function(e){this._addMarkup(e)},i.prototype.canExecuteAddMarkupFeatureCommand=function(e){return!!(e&&e.esriFeature&&e.esriFeature.get()&&e.esriFeature.get().geometry)},i.prototype.executeAddMarkupFeatureCommand=function(e){var t=e.esriFeature.get().geometry;this._addMarkup(esri.geometry.fromJson(t.toJson()))},i.prototype.canExecuteClearMarkupCommand=function(){return this._markupExists()},i.prototype.executeClearMarkupCommand=function(){this.clearMarkup()},i.prototype.canExecuteClearMarkupQuietCommand=function(){return this._markupExists()},i.prototype.executeClearMarkupQuietCommand=function(){this.clearMarkupQuiet()},i.prototype.canExecuteAddTextMarkupCommand=function(e){return!!e},i.prototype.executeAddTextMarkupCommand=function(e){this._addTextMarkup(e)},i.prototype.canExecuteDeleteMarkupCommand=function(){return this._markupExists()},i.prototype.executeDeleteMarkupCommand=function(e){this.deleteMarkup(e)},i.prototype.canExecuteExportMarkupLayerCommand=function(){return this._hasExportableMarkup()},i.prototype.executeExportMarkupLayerCommand=function(){var e={format:"shp",graphicLayer:this.app.map.getLayer(h.MARKUP_LAYER_ID)};this.app.command("ExportGraphicsLayer").execute(e)},i.prototype.executeExportGraphicsLayerCommand=function(e){for(var t,i,o,a,r=0,l=e.graphicLayer.graphics;r<l.length;r++){var u=l[r];if(null!=u.geometry)switch(u.geometry.type){case"point":null!=u.symbol&&"textsymbol"!==u.symbol.type&&(null==i&&(i=new esri.tasks.FeatureSet),i.features.push(new esri.Graphic(u.geometry,u.symbol,u.attributes,null)));break;case"polygon":null==o&&(o=new esri.tasks.FeatureSet),o.features.push(new esri.Graphic(u.geometry,u.symbol,u.attributes,null));break;case"extent":null==o&&(o=new esri.tasks.FeatureSet);var c=n.envelopeToPolygon(u.geometry);o.features.push(new esri.Graphic(c,u.symbol,u.attributes,null));break;case"polyline":null==t&&(t=new esri.tasks.FeatureSet),t.features.push(new esri.Graphic(u.geometry,u.symbol,u.attributes,null));break;case"multipoint":null==a&&(a=new esri.tasks.FeatureSet),a.features.push(new esri.Graphic(u.geometry,u.symbol,u.attributes,null))}}var m=new s.FeatureSetCollection;if(null!=i){var d=new p.FeatureSet({esriFeatureSet:i});d.displayName.set("Point"),m.featureSets.addItem(d)}if(null!=o){var y=new p.FeatureSet({esriFeatureSet:o});y.displayName.set("Polygon"),m.featureSets.addItem(y)}if(null!=t){var b=new p.FeatureSet({esriFeatureSet:t});b.displayName.set("Polyline"),m.featureSets.addItem(b)}if(null!=a){var g=new p.FeatureSet({esriFeatureSet:a});g.displayName.set("Multipoint"),m.featureSets.addItem(g)}var h={format:e.format,fsc:m};this.app.command("ExportResultsTo").execute(h)},i.prototype.canExecuteEditMarkupCommand=function(){return this._markupExists()},i.prototype.executeEditMarkupCommand=function(e){this._editMarkup(e)},i.prototype.canExecuteChangeMarkupStyleCommand=function(){return!0},i.prototype.canExecuteCreateStyleViewCommand=function(e){if(!this.markupType||!this.currentSymbol)return!1;var t=e?e.esriFeature.get():null;if(t){var i=b.getCapabilitiesForGraphic(this.app,t);if(!this._hasCapability("style",i))return!1}return!0},i.prototype.executeCreateStyleViewCommand=function(){this.app.command("_showMarkupStyleSelectorView").execute(this.currentEditedSymbol||this.currentSymbol.get())},i.prototype.canExecuteStopEditingCommand=function(){return!!this.editToolbar},i.prototype.executeStopEditingCommand=function(e){if(this.editToolbar){var t=this.editToolbar.getCurrentState().graphic||this._modifiedGraphic;this.app.event("MarkupEditingStoppedEvent").publish(t),this._deactivateToolbar(),this._originalGraphic=this._modifiedGraphic=null,this.currentEditedSymbol=null,this.app.command("ExportMarkupLayer").raiseCanExecuteChanged(),this.app.toolRegistry.getActiveTool()&&e&&"EditMarkupTool"===this.app.toolRegistry.getActiveTool().name&&this.app.command("ClearActiveTool").execute(),this.app.command("HideMarkupStyleView").execute()}},i.prototype._handleActiveToolChanged=function(e){if(e){var t=["AddMarkup","AddMarkupGeometry","AddTextMarkup"],i="";if(e instanceof c.MapTool&&-1!==t.indexOf(e.command))switch(e.drawMode){case m.DrawMode.POINT:i="AddTextMarkup"===e.command?u.SymbolType.TEXT:u.SymbolType.POINT;break;case m.DrawMode.MULTI_POINT:i=u.SymbolType.POINT;break;case m.DrawMode.LINE:case m.DrawMode.POLYLINE:case m.DrawMode.FREEHAND_POLYLINE:i=u.SymbolType.POLYLINE;break;case m.DrawMode.POLYGON:case m.DrawMode.FREEHAND_POLYGON:case m.DrawMode.EXTENT:case m.DrawMode.ARROW:case m.DrawMode.LEFT_ARROW:case m.DrawMode.RIGHT_ARROW:case m.DrawMode.UP_ARROW:case m.DrawMode.DOWN_ARROW:case m.DrawMode.TRIANGLE:case m.DrawMode.CIRCLE:case m.DrawMode.ELLIPSE:case m.DrawMode.RECTANGLE:i=u.SymbolType.POLYGON}else-1!==$.inArray(e.name,this.markupTools.point)?i=u.SymbolType.POINT:-1!==$.inArray(e.name,this.markupTools.polyline)?i=u.SymbolType.POLYLINE:-1!==$.inArray(e.name,this.markupTools.polygon)?i=u.SymbolType.POLYGON:-1!==$.inArray(e.name,this.markupTools.text)&&(i=u.SymbolType.TEXT);i?(this.markupType.set(i),this._setCurrentSymbol(),this.app.command("_updateMarkupStyleSelectorView").execute(this.currentSymbol.get())):this.app.command("HideMarkupStyleView").execute()}},i.prototype.canExecuteAutoEditClickableFeature=function(e){return!0},i.prototype.executeEditClickableFeature=function(e){this._originalGraphic&&this.app.command("StopEditingClickableFeature").execute(),this.app.command("ClearEmphasis").execute(e);var t=e.esriFeature.get();t&&this._moveToFront(t),this._editMarkupGraphic(e.esriFeature.get())},i.prototype.executeStopAndAutoEditClickableFeature=function(e){if(this.app.command("StopEditingClickableFeature").execute(),e&&e.esriFeature){var t=b.getClickableLayerInfo(this.app,e.esriFeature.get()),i=b.getCapabilitiesForGraphic(this.app,e.esriFeature.get(),t),o=this._hasCapability("edit",i),a=t&&t.autoEditable;o&&a&&(this.app.highlightManager.suppressHighlight(e.esriFeature.get()),this.executeEditClickableFeature(e))}},i.prototype.canExecuteStopEditingClickableFeature=function(){return!!this.editToolbar},i.prototype.executeStopEditingClickableFeature=function(){this.app.highlightManager.enableHighlight(this._modifiedGraphic);var e=this._modifiedGraphic?this._modifiedGraphic.getLayer():null;e&&e instanceof esri.layers.GraphicsLayer&&this._restoreDrawingOrder(e),this.app.command("StopEditingMarkup").execute(!0)},i.prototype._getSymbolForGeometryType=function(e){switch(e){case u.SymbolType.POINT:case u.SymbolType.MULTIPOINT:return this._markerSymbol;case u.SymbolType.POLYLINE:return this._lineSymbol;case u.SymbolType.POLYGON:return this._polyFillSymbol;case u.SymbolType.TEXT:var t=this._getStyleSelector(),i=this._getTemplateSelector();if(t&&t.isActive||i&&i.isActive)return this._textSymbol;var o=esri.symbol.fromJson(this._textSymbol.toJson());return o.setText(""),o;default:return null}},i.prototype._setCurrentSymbol=function(){var e=this._getSymbolForGeometryType(this.markupType.get());e&&this.currentSymbol.get()!==e&&this.currentSymbol.set(this._copySymbol(e))},i.prototype._moveToFront=function(e){var t=e?e.getShape():null;t&&"function"==typeof t.moveToFront&&t.moveToFront()},i.prototype._restoreDrawingOrder=function(e){var t=this;e.graphics.forEach(function(e){return t._moveToFront(e)})},i.prototype.canExecuteDeleteClickableFeature=function(e){if(e){var t=b.getCapabilitiesForGraphic(this.app,e.esriFeature.get());return this._hasCapability("delete",t)}return!1},i.prototype.executeDeleteClickableFeature=function(e){this.app.event("_deleteClickableFeatureStarted").publish(e),this.app.command("StopEditingClickableFeature").execute(!1);var t=e.esriFeature.get().getLayer(),i=t.remove(e.esriFeature.get());this.app.command("RemoveFeatureFromStarredSelection").execute(e),this.app.featureSetManager.updateCollectionsOnFeatureDeletion(i),e.selected.set(!1),this.app.highlightManager.clearSelected([e]),this._raiseGraphicRemovedEvent(i,t)},i.prototype._raiseGraphicEditingDoneEvent=function(e){esri.geometry.fromJson(e.geometry.toJson());var t={old:this._originalGraphic,new:e};this.app.event("GraphicEditingDoneEvent").publish(t)},i.prototype._raiseGraphicRemovedEvent=function(e,t){var i={graphic:e,graphicLayer:t};this.app.event("GraphicRemovedEvent").publish(i)},i.prototype._onGraphicDeleted=function(e){var t=e.graphic,i=e.graphicLayer;i&&i.id==h.MARKUP_LAYER_ID&&(this.app.event("MarkupDeletedEvent").publish(t),this.app.command("ClearMarkup").raiseCanExecuteChanged(),this.app.command("EditMarkup").raiseCanExecuteChanged(),this.app.command("DeleteMarkup").raiseCanExecuteChanged(),this.app.command("ExportMarkupLayer").raiseCanExecuteChanged())},i.prototype._closeMapTipView=function(){var e=this.app.viewManager.getViewById("MapTipView");e&&e.isActive?(this.app.viewManager.deactivateView(e),this.app.event("MapTipClosedEvent").publish()):this.app.command("StopEditingMarkup").execute(!0)},i.prototype._deactivateToolbar=function(){this._editToolbarMoveStartedHandle&&(this._editToolbarMoveStartedHandle.remove(),this._editToolbarMoveStartedHandle=null),this._editToolbarMoveStoppedHandle&&(this._editToolbarMoveStoppedHandle.remove(),this._editToolbarMoveStoppedHandle=null),this._editToolbarRotateHandle&&(this._editToolbarRotateHandle.remove(),this._editToolbarRotateHandle=null),this._editToolbarScaleHandle&&(this._editToolbarScaleHandle.remove(),this._editToolbarScaleHandle=null),this._editToolbarInputMethodChangeHandle&&(this._editToolbarInputMethodChangeHandle.remove(),this._editToolbarInputMethodChangeHandle=null),this.editToolbar&&(this.editToolbar.deactivate(),this._editToolbarDeactivatedHandle&&(this._editToolbarDeactivatedHandle.remove(),this._editToolbarDeactivatedHandle=null),this.editToolbar=null)},i.prototype.clearMarkup=function(){var e=this;if(this.editToolbar&&this.app.command("StopEditingMarkup").execute(),this._markupExists()){var t=this.app.getResource(this.libraryId,"language-markup-clear-all-prompt"),i=this.app.getResource(this.libraryId,"language-markup-clear-all-prompt-title");this.app.command("Confirm").execute(t,i,function(t){t&&e.clearMarkupQuiet()})}},i.prototype.clearMarkupQuiet=function(){var e=this;if(this.editToolbar&&setTimeout(function(){e.app.command("StopEditingMarkup").execute()},0),this._markupExists()){var t=this._getGraphicsLayer(!1,h.MARKUP_LAYER_ID),i=this._getGraphicsLayer(!1,h.COORDINATES_LAYER_ID);if(i&&i.graphics&&i.graphics.length)for(;i.graphics.length;){var o=i.graphics[i.graphics.length-1];o.coordinateId&&this.app.command("DeleteCoordinates").execute(o.coordinateId),i.remove(o),this.app.event("MarkupDeletedEvent").publish(o)}if(!t)return;for(var a=t.graphics.length,r=0;r<a;r++)t.graphics[0].measurementId?this.app.event("MarkupDeletedEvent").publish(t.graphics[0]):(this.app.event("MarkupDeletedEvent").publish(t.graphics[0]),t.remove(t.graphics[0]));this._deactivateActiveToolIfNoMarkupExists(),this.app.command("ClearMarkup").raiseCanExecuteChanged(),this.app.command("EditMarkup").raiseCanExecuteChanged(),this.app.command("DeleteMarkup").raiseCanExecuteChanged(),this.app.command("ExportMarkupLayer").raiseCanExecuteChanged(),this.app.event("MarkupClearedEvent").publish()}this.app.command("LogOptimizerEvent").execute("ClearMarkupTool","ClearAllMarkup")},i.prototype.deleteMarkup=function(e){var t=this,i=[h.MARKUP_LAYER_ID,h.MEASUREMENT_LAYER_ID,h.COORDINATES_LAYER_ID];b.deleteMarkup(e,i,this.app,function(e){if(e&&e.length){for(var i=0;i<e.length;i++){var o=e[i];o[d.coordinateIdentifierProperty]&&t.app.command("DeleteCoordinates").execute(o[d.coordinateIdentifierProperty]),t.app.event("MarkupDeletedEvent").publish(o)}t._deactivateActiveToolIfNoMarkupExists(),t.app.command("ClearMarkup").raiseCanExecuteChanged(),t.app.command("EditMarkup").raiseCanExecuteChanged(),t.app.command("DeleteMarkup").raiseCanExecuteChanged(),t.app.command("ExportMarkupLayer").raiseCanExecuteChanged()}t.app.command("ShowMap").execute()},!1,"language-markup-delete-multiple-prompt","language-markup-delete-multiple-prompt-title",this.libraryId)},i.prototype._deactivateActiveToolIfNoMarkupExists=function(){var e=this.app.toolRegistry.getActiveTool();!this._markupExists()&&e instanceof c.MapTool&&("EditMarkup"!==e.command&&"DeleteMarkup"!==e.command||this.app.command("ClearActiveTool").execute())},i.prototype._addMarkup=function(e){if(!e)throw new Error("geometry is null");"extent"===e.type&&(e=n.envelopeToPolygon(e));var t=this._copySymbol(this._getSymbolForGeometryType(e.type));if(t){var i=new esri.Graphic;i.setGeometry(e),i.setSymbol(t),this._addGraphic(i,h.MARKUP_LAYER_ID),this.app.event("MarkupAddedEvent").publish(i)}this.app.command("ClearMarkup").raiseCanExecuteChanged(),this.app.command("EditMarkup").raiseCanExecuteChanged(),this.app.command("DeleteMarkup").raiseCanExecuteChanged(),this.app.command("ExportMarkupLayer").raiseCanExecuteChanged()},i.prototype._addTextMarkup=function(e){var t=this;if(e){var i=this._getStyleSelector(),o=this._getTemplateSelector();if(this.currentSymbol.get().text&&(i&&i.isActive||o&&o.isActive))this._addTextMarkupImpl(this.currentSymbol.get().text,e);else{var a=this.app.getResource(this.libraryId,"language-markup-add-text-title"),r=this.app.getResource(this.libraryId,"language-markup-add-text");this.app.command("Prompt").execute(a,r,"",function(i){i&&t._addTextMarkupImpl(i,e),t.app.command("ShowMap").execute()})}}},i.prototype._editMarkup=function(e){var t=this._getGraphicsLayer(!1,h.COORDINATES_LAYER_ID),i=null;if(t&&(i=b.getMarkupFromGeometry(e,t,this.app,this._coordinatesSmsSymbolBuffer,this._coordinatesPointBuffer)),i&&i[i.length-1]){var o=i[i.length-1];if(o.hasOwnProperty(d.coordinateIdentifierProperty))return this.app.command("StopEditingMarkup").execute(!0),void this.app.command("EditCoordinate").execute(o[d.coordinateIdentifierProperty])}this.editToolbar&&this.app.command("StopEditingMarkup").execute(!1);var a=this._getGraphicsLayer(!1,h.MARKUP_LAYER_ID),r=null;a&&(r=b.getMarkupFromGeometry(e,a,this.app)),r&&r[r.length-1]&&this._editMarkupGraphic(r[r.length-1])},i.prototype._editMarkupGraphic=function(e){var t=this;this.editToolbar&&this.app.command("StopEditingMarkup").execute(!1),this._originalGraphic=new esri.Graphic(e.toJson()),this._modifiedGraphic=e,this.markupType.set(e.symbol instanceof esri.symbol.TextSymbol?u.SymbolType.TEXT:e.geometry.type),this.currentSymbol.set(this._copySymbol(e.symbol)),this.currentEditedSymbol=this.currentSymbol.get(),this.app.event("MarkupEditingStartedEvent").publish(e),this.app.command("ExportMarkupLayer").raiseCanExecuteChanged(),e.hasOwnProperty("measurementId")&&this.app.event("MeasurementEditingStartedEvent").publish({graphic:e}),this.editToolbar=this.app.accessibilityManager.createComponent("geocortex.accessibility.edit",this.app.map),this._editToolbarMoveStartedHandle=dojo.aspect.after(this.editToolbar,"onGraphicFirstMove",function(e){t.app.map.disableMapNavigation()},!0),this._editToolbarMoveStoppedHandle=dojo.aspect.after(this.editToolbar,"onGraphicMoveStop",function(e){t.app.map.enableMapNavigation()},!0),this.markupType.get()===u.SymbolType.TEXT&&(this._editToolbarRotateHandle=dojo.aspect.after(this.editToolbar,"onRotateStop",function(e){t.currentEditedSymbol=t._copySymbol(e.symbol),t.currentEditedSymbol&&t.app.command("_updateMarkupStyleSelectorView").execute(t.currentEditedSymbol)},!0),this._editToolbarScaleHandle=dojo.aspect.after(this.editToolbar,"onScaleStop",function(e){t.currentEditedSymbol=t._copySymbol(e.symbol),t.currentEditedSymbol&&t.app.command("_updateMarkupStyleSelectorView").execute(t.currentEditedSymbol)},!0)),this._editToolbarDeactivatedHandle=dojo.aspect.after(this.editToolbar,"onDeactivate",function(e,i,o){t._raiseGraphicEditingDoneEvent(i)},!0),this.editToolbar instanceof y.Edit&&(this._editToolbarInputMethodChangeHandle=dojo.aspect.after(this.editToolbar,"onInputMethodChange",function(e){var i=t.app.toolRegistry.getActiveTool();if(i instanceof c.MapTool&&"EditMarkup"===i.command){var o={tool:i,previousMethod:e?e.previousMethod:null,newMethod:e?e.newMethod:null};t.app.event("ToolInputMethodChangedEvent").publish(o)}},!0)),this.editToolbar.activate(this.editToolbarTool,e);var i=this.app.toolRegistry.getActiveTool();if(i){if(i instanceof c.MapTool&&"EditMarkup"===i.command)var o=this.app.event("ActiveToolChangedEvent").subscribe(this,function(e){var i=e.previousTool;if(i instanceof c.MapTool&&"EditMarkup"==i.command&&1==i.isSticky)t.app.command("StopEditingMarkup").execute(!1),t.app.event("ActiveToolChangedEvent").unsubscribe(o);else var a=t.app.map.on("click",function(e){t.app.command("StopEditingMarkup").execute(!1),t.app.event("ActiveToolChangedEvent").unsubscribe(o),a.remove()});e.tool&&t.editToolbar&&(t.app.command("StopEditingMarkup").execute(!1),t.app.event("ActiveToolChangedEvent").unsubscribe(o))})}else{var a,r;a=this.app.event("ActiveToolChangingEvent").subscribe(this,function(e){t._closeMapTipView(),a&&t.app.event("ActiveToolChangingEvent").unsubscribe(a),r&&r.remove()}),r=this.app.map.on("click",function(e){t._closeMapTipView(),a&&t.app.event("ActiveToolChangingEvent").unsubscribe(a),r&&r.remove()})}this.app.command("_updateMarkupStyleSelectorView").execute(this.currentSymbol.get())},i.prototype.executeChangeMarkupStyleCommand=function(e){if(e){var t;if(e instanceof esri.symbol.Symbol)t=e;else if(!(t=esri.symbol.fromJson(JSON.parse(e))))return;switch(this.markupType.get()){case u.SymbolType.POINT:case u.SymbolType.MULTIPOINT:t instanceof esri.symbol.PictureMarkerSymbol?this._markerSymbol=t:t instanceof esri.symbol.SimpleMarkerSymbol&&(this._markerSymbol=t);break;case u.SymbolType.POLYLINE:t instanceof esri.symbol.SimpleLineSymbol&&(this._lineSymbol=t);break;case u.SymbolType.POLYGON:t instanceof esri.symbol.SimpleFillSymbol&&(this._polyFillSymbol=t);break;case u.SymbolType.TEXT:t instanceof esri.symbol.TextSymbol&&(this._textSymbol=t)}this.currentEditedSymbol=null,this._setCurrentSymbol(),this.editToolbar&&this._applySymbolToEditedMarkup(t)}},i.prototype._applySymbolToEditedMarkup=function(e){if(this.editToolbar&&e){if(e instanceof esri.symbol.Symbol)e=this._copySymbol(e);else if(!(e=esri.symbol.fromJson(JSON.parse(e))))return;var t=this.editToolbar.getCurrentState().graphic;(t.symbol.type===e.type||t.symbol.type.indexOf("markersymbol")>-1&&e.type.indexOf("markersymbol")>-1)&&(t.setSymbol(e),this.currentEditedSymbol=e,this.app.event("GraphicSymbolChangedEvent").publish(t),this.editToolbar.refresh())}},i.prototype._addTextMarkupImpl=function(e,t){if(t.getExtent){var i=t.getExtent();i&&(t=i.getCenter())}var o=this._copySymbol(this._textSymbol);o.setText(e);var a=new esri.Graphic;a.geometry=t,a.symbol=o,this._addGraphic(a,h.MARKUP_LAYER_ID),this.app.event("MarkupAddedEvent").publish(a),this.app.command("ClearMarkup").raiseCanExecuteChanged(),this.app.command("EditMarkup").raiseCanExecuteChanged(),this.app.command("DeleteMarkup").raiseCanExecuteChanged()},i.prototype._addGraphic=function(e,t){if(e){var i=this._getGraphicsLayer(!0,t);i.add(e),i.visible||i.setVisibility(!0)}},i.prototype._getGraphicsLayer=function(e,t){var i=this.app.map.getLayer(t);return!i&&e&&(i=g.getInternalGraphicsLayer(h.MARKUP_LAYER_ID,this.app,g.GraphicsLayerType.Markup,!0),this.app.markupLayer.set(i)),i},i.prototype._copySymbol=function(e){return esri.symbol.fromJson(e.toJson())},i.prototype._markupExists=function(){var e=!1;if(this.app.map){var t=this._getGraphicsLayer(!1,h.MARKUP_LAYER_ID);t&&t.graphics&&t.graphics.length>0&&(e=!0),(t=this._getGraphicsLayer(!1,h.COORDINATES_LAYER_ID))&&t.graphics&&t.graphics.length>0&&(e=!0)}return e},i.prototype._hasExportableMarkup=function(){var e=!1;if(this.app.map){var t=this._getGraphicsLayer(!1,h.MARKUP_LAYER_ID);if(t&&t.graphics&&t.graphics.length>0){if(this._originalGraphic)return!1;for(var i=t.graphics,o=0;o<i.length;o++)if(null!=i[o].geometry){if("point"!=i[o].geometry.type){e=!0;break}if(null!=i[o].symbol&&"textsymbol"!=i[o].symbol.type){e=!0;break}}}}return e},i.prototype._hasCapability=function(e,t){return t&&t.some(function(t){return t==e})},i.prototype._getStyleSelector=function(){return this._styleSelector||(this._styleSelector=this.app.viewManager.getViewById("MarkupSymbolSelectorView")),this._styleSelector},i.prototype._getTemplateSelector=function(){return this._templateSelector||(this._templateSelector=this.app.viewManager.getViewById("MarkupTemplateSelectorView")),this._templateSelector},i}(o.ViewModelBase);i.MarkupViewModel=k})},"Mapping/modules/Markup/MarkupStyles/MarkupStyleView":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define(["require","exports","geocortex/infrastructure/ui/components/SmartPanel/SmartPanelView","geocortex/infrastructure/SymbolUtils","./MarkupTemplateSelector/MarkupTemplateSelectorViewModel","geocortex/infrastructure/symbology/widgets/PictureSymbolWidgetViewModel","./MarkupSymbolSelector/MarkupSymbolSelectorViewModel","geocortex/infrastructure/symbology/SymbolType"],function(t,i,o,a,r,l,n,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var p=function(t){function i(e,i){var o=t.call(this,e,i)||this;return o._availableWidgets=[],o._initialized=!1,o._lastCustomSymbol={},o._editingMarkup=!1,o._initialUpdatePerformed=!1,o.app.command("_showMarkupStyleSelectorView").register(o,o._executeShowMarkupStyleSelectorView),o.app.command("_updateMarkupStyleSelectorView").register(o,o._executeUpdateMarkupStyleSelectorView),o.app.command("HideMarkupStyleView").register(o,o._executeHideMarkupStyleSelectorView),o.app.event("MarkupEditingStartedEvent").subscribe(o,function(){o._editingMarkup=!0,o._styleSelector&&(o._styleSelector.editingMarkup=!0,o._styleSelector.viewModel&&o._styleSelector.viewModel.textSymbolWidget&&(o._styleSelector.viewModel.textSymbolWidget.editingMarkup=!0)),o._templateSelector&&(o._templateSelector.editingMarkup=!0)}),o.app.event("MarkupEditingStoppedEvent").subscribe(o,function(){o._editingMarkup=!1,o._styleSelector&&(o._styleSelector.editingMarkup=!1,o._styleSelector.viewModel&&o._styleSelector.viewModel.textSymbolWidget&&(o._styleSelector.viewModel.textSymbolWidget.editingMarkup=!1)),o._templateSelector&&(o._templateSelector.editingMarkup=!1)}),o}return e(i,t),i.prototype.attach=function(e){var i=this;t.prototype.attach.call(this,e),this._initialized||(this._initializeStyleSelectors(),this.app.event("MarkupTypeChangedEvent").subscribe(this,function(e){if(i._currentWidget&&"MarkupSymbolSelectorView"===i._currentWidget.id&&(i._lastCustomSymbol[i.viewModel.markupType.get()]=i._lastUpdateSymbol,i._styleSelector.updateSymbol(i._lastCustomSymbol[e]||i._getDefaultSymbol(e),!1)),i._currentWidget&&"MarkupTemplateSelectorView"===i._currentWidget.id&&i._templateSelector.loadCurrentLibrary(),e!==s.SymbolType.POINT&&i._currentWidget&&"MarkupImageSelectorView"===i._currentWidget.id){i.viewModel.templateSelectorItem||i.viewModel.symbolSelectorItem||!i.isActive||i.app.viewManager.deactivateView(i);var t=i.viewModel.templateSelectorItem||i.viewModel.symbolSelectorItem;t&&i.viewModel.currentSelector.set(t),i.isActive&&i._changeMarkupSelector()}i.viewModel.markupType.set(e)}),this.app.event("MarkupSymbolChangedEvent").subscribe(this,function(e){i.viewModel.markupSymbol=e}))},i.prototype.activated=function(){this._lastUpdateSymbol&&!this.isActive&&this._executeUpdateMarkupStyleSelectorView(this._lastUpdateSymbol,!0)},i.prototype.deactivated=function(){this._lastCustomSymbol[this.viewModel.markupType.get()]=this._lastUpdateSymbol,this.app.event("_markupToggleDeactivated").publish(),this._styleSelector&&(this._styleSelector.isActive=!1),this._templateSelector&&(this._templateSelector.isActive=!1)},i.prototype._executeShowMarkupStyleSelectorView=function(e){this._initialized||this._initializeStyleSelectors(),this._originalSymbol=esri.symbol.fromJson(e.toJson()),this._lastUpdateSymbol=e,this._initialUpdatePerformed?this._templateSelector&&this.viewModel.currentSelector.get().id===this._templateSelector.id?this._templateSelector.updateSymbol(e):this._imageSelector&&this.viewModel.currentSelector.get().id===this._imageSelector.id?this._imageSelector.updateSymbol(e):this._styleSelector&&this.viewModel.currentSelector.get().id===this._styleSelector.id&&this._styleSelector.updateSymbol(e):(this._executeUpdateMarkupStyleSelectorView(e,!0),this._initialUpdatePerformed=!0),this.app.command("ActivateView").execute(this.viewModel.currentSelector.get().id)},i.prototype._executeUpdateMarkupStyleSelectorView=function(e,t){var i=this;if(void 0===t&&(t=!1),e&&(this._lastUpdateSymbol=e,this.isActive||t)){var o,a=function(t){i._imageSelector&&e instanceof esri.symbol.PictureMarkerSymbol?(o=i._imageSelector,i._imageSelector.updateSymbol(e)):!i._templateSelector||i._styleSelector&&!t?i._styleSelector?(o=i._styleSelector,i._styleSelector.updateSymbol(e)):i._imageSelector&&i.viewModel.markupType.get()===s.SymbolType.POINT&&(o=i._imageSelector,i._imageSelector.updateSymbol(e)):(o=i._templateSelector,i._templateSelector.updateSymbol(e));var a=i.viewModel.markupSelectors.getItems().filter(function(e){return e.id===o.id})[0];!a||i.viewModel.currentSelector.get()&&a.id===i.viewModel.currentSelector.get().id||(i.viewModel.currentSelector.set(a),i.app.command("ActivateView").execute(i.viewModel.currentSelector.get().id)),a&&a.id===i.viewModel.currentSelector.get().id||i.viewModel.currentSelector.get()&&i.app.command("DeactivateView").execute(i.viewModel.currentSelector.get().id),a||i.app.command("HideMarkupStyleView").execute()};this._templateSelector?this._templateSelector.updateSymbol(e,!1).then(function(e){a(e)}):a(!1)}},i.prototype._executeHideMarkupStyleSelectorView=function(){this.isActive&&(this._currentWidget=null,this.app.command("DeactivateView").execute(this.id))},i.prototype._initializeStyleSelectors=function(){var e=this;if(this.viewModel.enableSymbolSelector){this._styleSelector=this.app.viewManager.createView({viewId:"MarkupSymbolSelectorView",markupResource:"Mapping/modules/Markup/MarkupStyles/MarkupSymbolSelector/MarkupSymbolSelectorView.html",typeName:"geocortex.essentialsHtmlViewer.mapping.modules.markup.MarkupSymbolSelectorView",regionName:"MarkupStyleSelectorRegion",isVisible:!1,libraryId:"Mapping"}),this._styleSelector.onChange=function(t){e._lastUpdateSymbol=esri.symbol.fromJson(JSON.parse(t))};var t=new n.MarkupSymbolSelectorViewModel(this.app,"Mapping"),i=(p=this.app.configModel.moduleConfigs.filter(function(e){return"Markup"===e.moduleName})[0]).viewModelConfigs.filter(function(e){return"MarkupSymbolSelectorViewModel"===e.viewModelId})[0];t.initialize(i),this._styleSelector.attach(t),this._availableWidgets.push(this._styleSelector)}if(this.viewModel.enableImageSelector){this._imageSelector=this.app.viewManager.createView({viewId:"MarkupImageSelectorView",markupResource:"Mapping/infrastructure/symbology/widgets/PictureSymbolWidget.html",typeName:"geocortex.essentialsHtmlViewer.mapping.infrastructure.symbology.PictureSymbolWidget",regionName:"MarkupStyleSelectorRegion",isVisible:!1,libraryId:"Mapping.Infrastructure"}),this._imageSelector.onChange=function(t){e.viewModel.markupSymbol&&JSON.stringify(e.viewModel.markupSymbol.toJson())===t||e.app.command("ChangeMarkupStyle").execute(t)},this._imageSelector.isMarkupView=!0;var o=new l.PictureSymbolWidgetViewModel(this.app,"Mapping.Infrastructure"),a=this.app.configModel.widgetConfigs.filter(function(e){return"PictureSymbolWidget"===e.id})[0];o.initialize(a.configuration),this._imageSelector.attach(o),this._availableWidgets.push(this._imageSelector)}if(this.viewModel.enableTemplateSelector){this._templateSelector=this.app.viewManager.createView({viewId:"MarkupTemplateSelectorView",markupResource:"Mapping/modules/Markup/MarkupStyles/MarkupTemplateSelector/MarkupTemplateSelectorView.html",typeName:"geocortex.essentialsHtmlViewer.mapping.modules.markup.MarkupTemplateSelectorView",regionName:"MarkupStyleSelectorRegion",isVisible:!1,libraryId:"Mapping"});var s=new r.MarkupTemplateSelectorViewModel(this.app,"Mapping");this._templateSelector.onChange=function(t){e._lastUpdateSymbol=esri.symbol.fromJson(JSON.parse(t))};var p=this.app.configModel.moduleConfigs.filter(function(e){return"Markup"===e.moduleName})[0],i=p.viewModelConfigs.filter(function(e){return"MarkupTemplateSelectorViewModel"===e.viewModelId})[0];s.initialize(i.configuration),this._templateSelector.attach(s),this._availableWidgets.push(this._templateSelector)}this._currentWidget=this._getCurrentWidget(),this._initialized=!0},i.prototype.handleSelectorChange=function(){this._changeMarkupSelector()},i.prototype.handleDoneButtonClick=function(){this.app.command("DeactivateView").execute(this.id)},i.prototype.handleRevertButtonClick=function(){this._styleSelector&&(this._lastUpdateSymbol=this._originalSymbol,this._styleSelector.updateSymbol(this._originalSymbol),this._editingMarkup?this.app.command("_applySymbolToEditedMarkup").execute(this._originalSymbol):this.app.command("ChangeMarkupStyle").execute(this._originalSymbol))},i.prototype.handleCustomizeButtonClick=function(){this.viewModel.symbolSelectorItem&&(this._lastCustomSymbol[this.viewModel.markupType.get()]=this._lastUpdateSymbol,this.viewModel.currentSelector.set(this.viewModel.symbolSelectorItem),this._changeMarkupSelector(this._lastUpdateSymbol))},i.prototype._changeMarkupSelector=function(e){var t=this,i=e;i||(i=this._currentWidget&&this._currentWidget.getSymbol()?esri.symbol.fromJson(JSON.parse(this._currentWidget.getSymbol())):this.viewModel.markupSymbol),i&&this._currentWidget&&"MarkupSymbolSelectorView"===this._currentWidget.id&&this._setLastCustomSymbol(i);var o=this.viewModel.currentSelector.get();this._currentWidget=this._getCurrentWidget(),"MarkupSymbolSelectorView"===o.id&&e&&this._styleSelector.updateSymbol(e),"MarkupTemplateSelectorView"===o.id&&(i instanceof esri.symbol.TextSymbol&&i.text&&this._templateSelector.viewModel.symbolText.set(i.text),this._templateSelector.viewModel.executeChangeMarkupFromId(this._templateSelector.viewModel.styleIndex),this._lastUpdateSymbol=esri.symbol.fromJson(JSON.parse(this._templateSelector.getSymbol()))),this.app.command("ActivateView").execute(o.id),this._availableWidgets.forEach(function(e){e.id!==o.id&&t.app.command("DeactivateView").execute(e.id)}),this._originalSymbol=this.viewModel.markupSymbol;var a=this._currentWidget.getSymbol();if(e||a){var r=e||esri.symbol.fromJson(JSON.parse(a));r instanceof esri.symbol.TextSymbol&&i instanceof esri.symbol.TextSymbol&&this._editingMarkup&&(r.setText(i.text),this._currentWidget.updateSymbol(r)),this._editingMarkup?this.app.command("_applySymbolToEditedMarkup").execute(e?JSON.stringify(e.toJson()):JSON.stringify(r.toJson())):this.app.command("ChangeMarkupStyle").execute(e?JSON.stringify(e.toJson()):JSON.stringify(r.toJson()))}},i.prototype._getCurrentWidget=function(){var e=this;return this._availableWidgets.filter(function(t){return t.id===e.viewModel.currentSelector.get().id})[0]},i.prototype._getDefaultSymbol=function(e){switch(e){case s.SymbolType.POINT:case s.SymbolType.MULTIPOINT:return a.defaultPointMarkup;case s.SymbolType.POLYLINE:return a.defaultPolylineMarkup;case s.SymbolType.POLYGON:return a.defaultPolygonMarkup;case s.SymbolType.TEXT:return a.defaultTextMarkup}},i.prototype._setLastCustomSymbol=function(e){e instanceof esri.symbol.PictureMarkerSymbol||e instanceof esri.symbol.SimpleMarkerSymbol?this._lastCustomSymbol[s.SymbolType.POINT]=e:e instanceof esri.symbol.SimpleLineSymbol?this._lastCustomSymbol[s.SymbolType.POLYLINE]=e:e instanceof esri.symbol.SimpleFillSymbol?this._lastCustomSymbol[s.SymbolType.POLYGON]=e:e instanceof esri.symbol.TextSymbol&&(this._lastCustomSymbol[s.SymbolType.TEXT]=e)},i}(o.SmartPanelView);i.MarkupStyleView=p})},"Mapping/modules/Markup/MarkupStyles/MarkupStyleViewModel":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define(["require","exports","geocortex/infrastructure/ui/components/SmartPanel/SmartPanelViewModel","geocortex/framework/observables","geocortex/infrastructure/symbology/SymbolType"],function(t,i,o,a,r){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var l=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.enableImageSelector=!1,e.enableTemplateSelector=!1,e.enableSymbolSelector=!1,e.markupSelectors=new a.ObservableCollection([]),e.currentSelector=new a.Observable(null),e.showMarkupSelectorMenu=new a.Observable(!0),e.markupType=new a.Observable(r.SymbolType.POINT),e.showRevertButton=new a.Observable(!0),e.showCustomizeButton=new a.Observable(!0),e}return e(i,t),i.prototype.initialize=function(e){var i=this;t.prototype.initialize.call(this,e),this.config=e,this.app.command("CreateMarkupStyleView").register(this,function(){},function(){return i.markupType.get()===r.SymbolType.POINT?i.enableSymbolSelector||i.enableTemplateSelector||i.enableImageSelector:i.enableSymbolSelector||i.enableTemplateSelector}),e.enableTemplateSelector&&(this.enableTemplateSelector=e.enableTemplateSelector,this.templateSelectorItem={displayName:this.app.getResource(this.libraryId,"language-markup-selector-template-displayname"),id:"MarkupTemplateSelectorView"},this.markupSelectors.addItem(this.templateSelectorItem)),e.enableImageSelector&&(this.enableImageSelector=e.enableImageSelector,this.imageSelectorItem={displayName:this.app.getResource(this.libraryId,"language-markup-selector-image-displayname"),id:"MarkupImageSelectorView"},this.markupSelectors.addItem(this.imageSelectorItem),this.markupType.bind(this,function(e){e!==r.SymbolType.POINT?i.markupSelectors.removeItem(i.imageSelectorItem):i.markupSelectors.contains(i.imageSelectorItem)||i.markupSelectors.insertItem(1,i.imageSelectorItem),i._setMenuVisibility()})),e.enableSymbolSelector&&(this.enableSymbolSelector=e.enableSymbolSelector,this.symbolSelectorItem={displayName:this.app.getResource(this.libraryId,"language-markup-selector-symbol-displayname"),id:"MarkupSymbolSelectorView"},this.markupSelectors.addItem(this.symbolSelectorItem)),this.currentSelector.bind(this,function(e){i.showRevertButton.set(i.symbolSelectorItem&&e.displayName===i.symbolSelectorItem.displayName),i.showCustomizeButton.set(i.templateSelectorItem&&i.symbolSelectorItem&&e.displayName===i.templateSelectorItem.displayName)}),this.currentSelector.set(this.markupSelectors.getAt(0)),this._setMenuVisibility()},i.prototype._setMenuVisibility=function(){this.markupSelectors.getLength()<=1?this.showMarkupSelectorMenu.set(!1):this.showMarkupSelectorMenu.set(!0)},i}(o.SmartPanelViewModel);i.MarkupStyleViewModel=l})},"Mapping/modules/Markup/ToolPalettes/TransientMarkupPaletteView":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define(["require","exports","geocortex/framework/ui/ViewBase"],function(t,i,o){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return e(i,t),i.prototype.handleClickDone=function(e,t,i){this.viewModel.editToggled.set(!1),this.viewModel.deleteToggled.set(!1),this.app.command("StopEditingMarkup").execute(),this.app.command("ClearActiveTool").execute()},i.prototype.handleClickEdit=function(e,t,i){var o=this;if(this.viewModel.deleteToggled.get()&&this.viewModel.deleteToggled.set(!1),this.viewModel.editToggled.get())this.app.command("ClearActiveTool").execute();else{this.app.command("SetActiveTool").execute("EditMarkupTool"),this.viewModel.editToggled.set(!0);var a=this.app.event("ActiveToolChangedEvent").subscribe(this,function(){o.viewModel.editToggled.set(!1),o.app.event("ActiveToolChangedEvent").unsubscribe(a)})}},i.prototype.handleClickDelete=function(e,t,i){var o=this;if(!this.viewModel.clearDisabled.get())if(this.viewModel.editToggled.get()&&this.viewModel.editToggled.set(!1),this.viewModel.deleteToggled.get())this.app.command("ClearActiveTool").execute();else{this.app.command("SetActiveTool").execute("DeleteMarkupTool"),this.viewModel.deleteToggled.set(!0);var a=this.app.event("ActiveToolChangedEvent").subscribe(this,function(){o.viewModel.deleteToggled.set(!1),o.app.event("ActiveToolChangedEvent").unsubscribe(a)})}},i.prototype.handleClickChangeStyle=function(){this.app.command("CreateMarkupStyleView").execute()},i.prototype.handleClickClear=function(e,t,i){this.app.command("StopEditingMarkup").execute(),this.app.command("ClearMarkup").execute()},i}(o.ViewBase);i.TransientMarkupPaletteView=a})},"Mapping/modules/Markup/ToolPalettes/TransientMarkupPaletteViewModel":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define(["require","exports","geocortex/framework/ui/ViewModelBase","geocortex/framework/observables"],function(t,i,o,a){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.clearDisabled=new a.Observable(!0),e.changeStyleDisabled=new a.Observable(!0),e.markupCounter=new a.Observable(0),e.deleteToggled=new a.Observable(!1),e.editToggled=new a.Observable(!1),e.previousTool=null,e}return e(i,t),i.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.markupCounter.bind(this,this.evaluateMarkupCounter),this.registerEventsClearDisabled(),this.registerEventsChangeStyleDisabled()},i.prototype.registerEventsChangeStyleDisabled=function(){var e=this;this.app.event("ActiveToolChangedEvent").subscribe(this,function(t){var i=null,o=null;t.tool&&(i=t.tool.name),t.previousTool&&(o=t.previousTool.name),e.isMarkupTool(o)&&e.changeStyleDisabled.set(!0),e.isMarkupTool(i)&&e.changeStyleDisabled.set(!1)}),this.app.event("MarkupEditingStartedEvent").subscribe(this,function(){e.changeStyleDisabled.set(!1)}),this.app.event("MarkupEditingStoppedEvent").subscribe(this,function(){e.changeStyleDisabled.set(!0)})},i.prototype.registerEventsClearDisabled=function(){var e=this;this.app.event("MarkupAddedEvent").subscribe(this,function(){e.markupCounter.set(e.markupCounter.get()+1)}),this.app.event("MeasurementMarkupAdded").subscribe(this,function(){e.markupCounter.set(e.markupCounter.get()+1)}),this.app.event("MarkupDeletedEvent").subscribe(this,function(t){t.measurementId||e.markupCounter.set(e.markupCounter.get()-1)}),this.app.event("MeasurementMarkupDeleted").subscribe(this,function(t){t.graphic&&t.graphic.measurementId&&e.markupCounter.set(e.markupCounter.get()-1)}),this.app.event("MarkupClearedEvent").subscribe(this,function(){e.markupCounter.set(0)})},i.prototype.evaluateMarkupCounter=function(){if(this.markupCounter.get()>0)this.clearDisabled.set(!1);else{var e=this.app.toolRegistry.getActiveTool();e&&"DeleteMarkupTool"===e.name&&this.app.command("ClearActiveTool").execute(),this.clearDisabled.set(!0)}},i.prototype.isMarkupTool=function(e){var t=this.app.getFrameworkObjectById("MarkupViewModel").markupTools;return-1!=$.inArray(e,t.point)||(-1!=$.inArray(e,t.polyline)||(-1!=$.inArray(e,t.polygon)||-1!=$.inArray(e,t.text)))},i}(o.ViewModelBase);i.TransientMarkupPaletteViewModel=r})},"Mapping/modules/Markup/MarkupStyles/MarkupSymbolSelector/MarkupSymbolSelectorView":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define(["require","exports","geocortex/framework/ui/ViewBase","geocortex/infrastructure/symbology/SymbolType","geocortex/infrastructure/symbology/widgets/SimpleSymbolWidgetViewModel","geocortex/infrastructure/symbology/widgets/TextSymbolWidgetViewModel","geocortex/infrastructure/SymbolUtils"],function(t,i,o,a,r,l,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=function(t){function i(e,i){var o=t.call(this,e,i)||this;return o.displayName=o.app.getResource(o.libraryId,"language-markup-selector-symbol-displayname"),o.markupType=a.SymbolType.POINT,o.initialized=!1,o.editingMarkup=!1,o.customSymbolCreated={},o}return e(i,t),i.prototype.attach=function(e){var i=this;t.prototype.attach.call(this,e),this.viewModel=e,this.initialized||(this._initializeStyleConfigurationViews(),this.app.event("MarkupTypeChangedEvent").subscribe(this,function(e){i.markupType=e,i._updateStyleConfigurationViews(e)}),this.app.event("MarkupSymbolChangedEvent").subscribe(this,function(e){i.markupSymbol=e}))},i.prototype.activated=function(){this.viewModel.textSymbolWidget&&this.markupType===a.SymbolType.TEXT?this.app.viewManager.activateView(this.viewModel.textSymbolWidget):this.app.viewManager.activateView(this.viewModel.symbolWidget)},i.prototype.updateSymbol=function(e,t){if(void 0===t&&(t=!0),"picturemarkersymbol"===e.type)return Promise.resolve(!1);var i=n.fromEsriSymbolType(e.type);return i?(i===a.SymbolType.TEXT?this.viewModel.textSymbolWidget.setFromSymbol(e,t):(this.viewModel.symbolWidget.setFromSymbol(e,t),this.customSymbolCreated[i]=!0),Promise.resolve(!0)):Promise.resolve(!1)},i.prototype.getSymbol=function(e){void 0===e&&(e=!0);var t;return this.markupType===a.SymbolType.TEXT?(e&&(this.viewModel.textSymbolWidget.activated(),this.viewModel.textSymbolWidget.applySettings()),t=this.viewModel.textSymbolWidget.getSymbol(e)):(this.customSymbolCreated[this.markupType]||(this.viewModel.symbolWidget.setFromSymbol(n.defaultMarkupSymbol(this.markupType)),this.customSymbolCreated[this.markupType]=!0),e&&this.viewModel.symbolWidget.activated(),t=this.viewModel.symbolWidget.getSymbol()),t},i.prototype._initializeStyleConfigurationViews=function(){var e=this,t=function(t){e.onChange&&e.onChange(t),e.editingMarkup?e.app.command("_applySymbolToEditedMarkup").execute(t):e.markupSymbol&&JSON.stringify(e.markupSymbol.toJson())===t||e.app.command("ChangeMarkupStyle").execute(t)};this.viewModel.symbolWidget=this.app.viewManager.createView({viewId:"MarkupSymbolWidget",markupResource:"Mapping/infrastructure/symbology/widgets/SimpleSymbolWidget.html",typeName:"geocortex.essentialsHtmlViewer.mapping.infrastructure.symbology.SimpleSymbolWidget",regionName:"MarkupStyleConfigurationRegion",isVisible:!1,libraryId:"Mapping.Infrastructure"}),this.viewModel.symbolWidget.onChange=t.bind(this);var i=new r.SimpleSymbolWidgetViewModel(this.app,"Mapping.Infrastructure");i.parentSymbologyView=this,i.initialize(this.viewModel.config.configuration.symbologyConfig),this.viewModel.symbolWidget.attach(i),this.viewModel.textSymbolWidget=this.app.viewManager.createView({viewId:"TextMarkupSymbolWidget",markupResource:"Mapping/infrastructure/symbology/widgets/TextSymbolWidget.html",typeName:"geocortex.essentialsHtmlViewer.mapping.infrastructure.symbology.TextSymbolWidget",regionName:"MarkupStyleConfigurationRegion",isVisible:!1,libraryId:"Mapping.Infrastructure"}),this.viewModel.textSymbolWidget.onChange=t.bind(this);var o=new l.TextSymbolWidgetViewModel(this.app,"Mapping.Infrastructure");o.parentSymbologyView=this,o.initialize(this.viewModel.config.configuration.textSymbologyConfig),this.viewModel.textSymbolWidget.attach(o),this.initialized=!0},i.prototype._updateStyleConfigurationViews=function(e){e===a.SymbolType.TEXT?this.app.command("ActivateView").execute("TextMarkupSymbolWidget"):(this.viewModel.symbolWidget.setFeatureType(e),this.app.command("ActivateView").execute("MarkupSymbolWidget"))},i}(o.ViewBase);i.MarkupSymbolSelectorView=s})},"Mapping/modules/Markup/MarkupStyles/MarkupSymbolSelector/MarkupSymbolSelectorViewModel":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define(["require","exports","geocortex/framework/ui/ViewModelBase"],function(t,i,o){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function i(e,i){return t.call(this,e,i)||this}return e(i,t),i.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.config=e},i}(o.ViewModelBase);i.MarkupSymbolSelectorViewModel=a})},"Mapping/modules/Markup/MarkupStyles/MarkupTemplateSelector/MarkupTemplateSelectorView":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define(["require","exports","geocortex/framework/ui/ViewBase","geocortex/infrastructure/symbology/SymbolType","geocortex/infrastructure/SymbolUtils","geocortex/infrastructure/GraphicsLayerIds","geocortex/infrastructure/GraphicsLayerUtils"],function(t,i,o,a,r,l,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.displayName=e.app.getResource(e.libraryId,"language-markup-selector-template-displayname"),e.initialized=!1,e.editingMarkup=!1,e._swatchSize=36,e}return e(i,t),i.prototype.attach=function(e){t.prototype.attach.call(this,e),this.viewModel.createSwatches=this.createSwatches.bind(this)},i.prototype.activated=function(){this.viewModel.loading||this.loadCurrentLibrary()},i.prototype.getSymbol=function(){return this.viewModel._getSymbol()},i.prototype.createSwatches=function(e){for(var t=$(".markup-swatch-{0}".format(e[0].type),this.root),i=0;i<t.length;i++)t[i].id="__{0}__{1}".format(e[i].type,i),t[i].onclick=dojo.hitch(this,this.handleClickStyle),this.viewModel.markupType===a.SymbolType.TEXT?r.createTextSymbolSwatch(t[i],this._swatchSize,e[i].toSymbol(),this._getMarkupLayer()):r.createSymbolSwatch(t[i],this._swatchSize,e[i].toSymbol())},i.prototype.loadTemplates=function(){this.viewModel._loadAllTemplates()},i.prototype.loadCurrentLibrary=function(){this.viewModel.loading||(this.viewModel.markupType||this.app.event("ActiveToolChangedEvent").publish({tool:this.app.toolRegistry.getActiveTool()}),this.app.site.isInitialized&&this.viewModel.currentTemplates[this.viewModel.markupType].get()&&0===this.viewModel.currentTemplates[this.viewModel.markupType].getLength()&&this.viewModel.currentLibraries[this.viewModel.markupType].pulse())},i.prototype.updateSymbol=function(e,t){return void 0===t&&(t=!0),e instanceof esri.symbol.PictureMarkerSymbol?Promise.resolve(!1):(this.loadCurrentLibrary(),this.viewModel._updateSymbol(e,t))},i.prototype.handleClickStyle=function(e){this.viewModel.styleIndex=this._getIdNumber(e||window.event),this.viewModel.currentStyleIndex[this.viewModel.markupType]=this.viewModel.styleIndex,this.viewModel.executeChangeMarkupFromId(this.viewModel.styleIndex),this.onChange&&this.onChange(this.getSymbol())},i.prototype.handleTextChange=function(e){this.viewModel.executeChangeMarkupFromId(this.viewModel.styleIndex),this.onChange&&this.onChange(this.getSymbol())},i.prototype.handleLibraryChange=function(e){this.viewModel.setSymbolOnLibraryChange=!0},i.prototype._getMarkupLayer=function(){var e=n.getInternalGraphicsLayer(l.MARKUP_LAYER_ID,this.app,n.GraphicsLayerType.Markup,!0);return this.app.markupLayer.set(e),e},i.prototype._getIdNumber=function(e){var t=(e=e||window.event).currentTarget?e.currentTarget.id:this._getId(e.target||e.srcElement);return parseInt(t.replace(/^\D+/g,""))},i.prototype._getId=function(e){return null==e?"":"BUTTON"==e.tagName&&e.id?e.id:this._getId(e.parentNode)},i}(o.ViewBase);i.MarkupTemplateSelectorView=s})},"Mapping/modules/Markup/MarkupStyles/MarkupTemplateSelector/MarkupTemplateSelectorViewModel":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define(["require","exports","geocortex/framework/ui/ViewModelBase","geocortex/framework/observables","geocortex/infrastructure/ColorUtils","geocortex/infrastructure/SymbolUtils","geocortex/infrastructure/symbology/SymbolType","geocortex/framework-ui/LazyObservable","geocortex/essentials/utilities/UrlUtilities","geocortex/infrastructure/BrowserUtils","geocortex/framework/utils/utils"],function(t,i,o,a,r,l,n,s,p,u,c){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var m=function(t){function i(e,i){var o=t.call(this,e,i)||this;o.symbologyTextInputId="symbologyTextInput-".concat(c.alphaNumericToken()),o.markupType=null,o.legacyLibraryName=o.app.getResource(o.libraryId,"language-markup-legacy-library-name"),o.pointLibrarySwitcherId="pointLibrarySwitcher-"+c.alphaNumericToken(),o.lineLibrarySwitcherId="lineLibrarySwitcher-"+c.alphaNumericToken(),o.polygonLibrarySwitcherId="polygonLibrarySwitcher-"+c.alphaNumericToken(),o.textLibrarySwitcherId="textLibrarySwitcher-"+c.alphaNumericToken(),o.esriStyleLookup={point:{circle:esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,diamond:esri.symbol.SimpleMarkerSymbol.STYLE_DIAMOND,square:esri.symbol.SimpleMarkerSymbol.STYLE_SQUARE},polyline:{dash:esri.symbol.SimpleLineSymbol.STYLE_DASH,"dash dot":esri.symbol.SimpleLineSymbol.STYLE_DASHDOT,"dash dot dot":esri.symbol.SimpleLineSymbol.STYLE_DASHDOTDOT,dot:esri.symbol.SimpleLineSymbol.STYLE_DOT,solid:esri.symbol.SimpleLineSymbol.STYLE_SOLID},polygon:{solid:esri.symbol.SimpleFillSymbol.STYLE_SOLID,"forward diagonal":esri.symbol.SimpleFillSymbol.STYLE_FORWARD_DIAGONAL,"backward diagonal":esri.symbol.SimpleFillSymbol.STYLE_BACKWARD_DIAGONAL,cross:esri.symbol.SimpleFillSymbol.STYLE_CROSS,"diagonal cross":esri.symbol.SimpleFillSymbol.STYLE_DIAGONAL_CROSS,horizontal:esri.symbol.SimpleFillSymbol.STYLE_HORIZONTAL,vertical:esri.symbol.SimpleFillSymbol.STYLE_VERTICAL},text:{italic:esri.symbol.Font.STYLE_ITALIC,normal:esri.symbol.Font.STYLE_NORMAL,oblique:esri.symbol.Font.STYLE_OBLIQUE,bold:esri.symbol.Font.WEIGHT_BOLD,bolder:esri.symbol.Font.WEIGHT_BOLDER,lighter:esri.symbol.Font.WEIGHT_LIGHTER}},o.isPoint=new a.Observable(!1),o.isLine=new a.Observable(!1),o.isPolygon=new a.Observable(!1),o.isText=new a.Observable(!1),o.styleIndex=0,o.currentStyleIndex={},o.currentTemplate=new a.Observable(null),o.pointLibraries=new a.ObservableCollection([]),o.lineLibraries=new a.ObservableCollection([]),o.polygonLibraries=new a.ObservableCollection([]),o.textLibraries=new a.ObservableCollection([]),o.libraries={},o.currentPointLibrary=new a.Observable(""),o.currentLineLibrary=new a.Observable(""),o.currentPolygonLibrary=new a.Observable(""),o.currentTextLibrary=new a.Observable(""),o.currentLibraries={},o.currentPointTemplates=new a.ObservableCollection,o.currentLineTemplates=new a.ObservableCollection,o.currentPolygonTemplates=new a.ObservableCollection,o.currentTextTemplates=new a.ObservableCollection,o.currentTemplates={},o.pointTemplates={},o.lineTemplates={},o.polygonTemplates={},o.textTemplates={},o.templates={},o.symbolText=new a.Observable(""),o.showLibrarySwitcher=new a.Observable(!1),o.noLibraries={},o.noPointLibraries=new a.Observable(!1),o.noLineLibraries=new a.Observable(!1),o.noPolygonLibraries=new a.Observable(!1),o.noTextLibraries=new a.Observable(!1),o.loading=!1,o.initialized=!1,o.setSymbolOnLibraryChange=!1,o._isIE9or11=!1;var r=u.isIE();return o._isIE9or11=9===r||11===r,o.app.command("ChangeMarkupStyleFromId").register(o,o.executeChangeMarkupFromId),o}return e(i,t),i.prototype.initialize=function(e){var t=this;this.initialized||(void 0!==e.pointLibraries&&dojo.isArray(e.pointLibraries)&&this.pointLibraries.set(e.pointLibraries),void 0!==e.lineLibraries&&dojo.isArray(e.lineLibraries)&&this.lineLibraries.set(e.lineLibraries),void 0!==e.polygonLibraries&&dojo.isArray(e.polygonLibraries)&&this.polygonLibraries.set(e.polygonLibraries),void 0!==e.textLibraries&&dojo.isArray(e.textLibraries)&&this.textLibraries.set(e.textLibraries),e.customPointStyles&&e.customPointStyles.length>0&&this.initializePointStyles(e.customPointStyles),e.customLineStyles&&e.customLineStyles.length>0&&this.initializeLineStyles(e.customLineStyles),e.customPolygonStyles&&e.customPolygonStyles.length>0&&this.initializePolygonStyles(e.customPolygonStyles),e.customTextStyles&&e.customTextStyles.length>0&&this.initializeTextStyles(e.customTextStyles),this.libraries[n.SymbolType.POINT]=this.pointLibraries,this.libraries[n.SymbolType.POLYLINE]=this.lineLibraries,this.libraries[n.SymbolType.POLYGON]=this.polygonLibraries,this.libraries[n.SymbolType.TEXT]=this.textLibraries,this.currentPointLibrary.set(this.libraries[n.SymbolType.POINT].getAt(0)),this.currentLibraries[n.SymbolType.POINT]=this.currentPointLibrary,this.currentLineLibrary.set(this.libraries[n.SymbolType.POLYLINE].getAt(0)),this.currentLibraries[n.SymbolType.POLYLINE]=this.currentLineLibrary,this.currentPolygonLibrary.set(this.libraries[n.SymbolType.POLYGON].getAt(0)),this.currentLibraries[n.SymbolType.POLYGON]=this.currentPolygonLibrary,this.currentTextLibrary.set(this.libraries[n.SymbolType.TEXT].getAt(0)),this.currentLibraries[n.SymbolType.TEXT]=this.currentTextLibrary,this.currentTemplates[n.SymbolType.POINT]=this.currentPointTemplates,this.currentTemplates[n.SymbolType.POLYLINE]=this.currentLineTemplates,this.currentTemplates[n.SymbolType.POLYGON]=this.currentPolygonTemplates,this.currentTemplates[n.SymbolType.TEXT]=this.currentTextTemplates,this.templates[n.SymbolType.POINT]=this.pointTemplates,this.templates[n.SymbolType.POLYLINE]=this.lineTemplates,this.templates[n.SymbolType.POLYGON]=this.polygonTemplates,this.templates[n.SymbolType.TEXT]=this.textTemplates,this.noLibraries[n.SymbolType.POINT]=this.noPointLibraries,this.noLibraries[n.SymbolType.POLYLINE]=this.noLineLibraries,this.noLibraries[n.SymbolType.POLYGON]=this.noPolygonLibraries,this.noLibraries[n.SymbolType.TEXT]=this.noTextLibraries,this.currentPointLibrary.bind(this,function(e){e&&t._setTemplates(t.pointTemplates,e,t.currentPointTemplates)}),this.currentLineLibrary.bind(this,function(e){e&&t._setTemplates(t.lineTemplates,e,t.currentLineTemplates)}),this.currentPolygonLibrary.bind(this,function(e){e&&t._setTemplates(t.polygonTemplates,e,t.currentPolygonTemplates)}),this.currentTextLibrary.bind(this,function(e){e&&t._setTemplates(t.textTemplates,e,t.currentTextTemplates)}),this.currentStyleIndex[n.SymbolType.POINT]=0,this.currentStyleIndex[n.SymbolType.POLYGON]=0,this.currentStyleIndex[n.SymbolType.POLYLINE]=0,this.currentStyleIndex[n.SymbolType.TEXT]=0,this.app.event("MarkupTypeChangedEvent").subscribe(this,function(e){t.markupType!==e&&(t.markupType=e,t.showLibrarySwitcher.set(t.libraries[e]&&t.libraries[e].getLength()>1),t.currentTemplate.set({name:""}),t.isPoint.set(e===n.SymbolType.POINT),t.isLine.set(e===n.SymbolType.POLYLINE),t.isPolygon.set(e===n.SymbolType.POLYGON),t.isText.set(e===n.SymbolType.TEXT),t.styleIndex=t.currentStyleIndex[e]||0)}),this.app.event("MarkupSymbolChangedEvent").subscribe(this,function(e){e instanceof esri.symbol.TextSymbol&&e.text&&!t.symbolText.get()&&t.symbolText.set(e.text),t.markupSymbol=e}),this.initialized=!0)},i.prototype.executeChangeMarkupFromId=function(e){var t=this.currentTemplates[this.markupType].getItems();if(!(e>t.length-1||e<0)&&t.length>0){for(var i=0,o=t;i<o.length;i++)o[i].selected.set(!1);var a=t[e];a.selected.set(!0),this.currentTemplate.set(a);var r=this._getSymbol(),l=esri.symbol.fromJson(JSON.parse(r));l instanceof esri.symbol.TextSymbol&&(l.setText(this.symbolText.get()),r=JSON.stringify(l.toJson())),this.markupSymbol&&JSON.stringify(this.markupSymbol.toJson())===r||this.app.command("ChangeMarkupStyle").execute(r)}},i.prototype._getSymbol=function(){var e;if(this.currentTemplate.get())if(this.markupType===n.SymbolType.TEXT&&this.symbolText.get()){var t=this.currentTemplate.get().toSymbol();t.setText(this.symbolText.get()),e=JSON.stringify(t.toJson())}else e=this.currentTemplate.get().toJsonString();return e},i.prototype._updateSymbol=function(e,t){var i=this;e instanceof esri.symbol.TextSymbol&&e.text&&this.symbolText.set(e.text);var o;return new Promise(function(a,r){if(e instanceof esri.symbol.TextSymbol){(o=new esri.symbol.TextSymbol(e.toJson())).setText("");var n=o.font;n.setFamily(o.font.family.split(",")[0]),n.setDecoration(n.decoration||esri.symbol.TextSymbol.DECORATION_NONE)}else o=e;var s=l.stringToHash(JSON.stringify(o.toJson())),p=null,u=i.libraries[i.markupType].getItems().sort(function(e,t){return e===i.currentLibraries[i.markupType].get()?1:-1}),c=function(){for(var o=0;o<u.length;o++){var r=i.templates[i.markupType][u[o]];if(r&&(p=r.filter(function(e){return e.hash.get()===s})[0]))break}if(p)return i.currentLibraries[i.markupType].set(u[o]),i.styleIndex=i.currentTemplates[i.markupType].indexOf(p),i.currentStyleIndex[i.markupType]=i.styleIndex,e instanceof esri.symbol.TextSymbol&&i.symbolText.set(e.text),t&&i.executeChangeMarkupFromId(i.styleIndex),void a(!0);a(!1)};i.templates[i.markupType][u[0]]?c():i._loadAllTemplates().then(function(){c()})})},i.prototype._setTemplates=function(e,t,i){var o=this;if(e[t]){for(var a=0;a<e[t].length;a++)if(e[t][a].selected.get()){this.currentTemplate.set(e[t][a]),this.styleIndex=a,this.currentStyleIndex[this.markupType]=a;break}i.set(e[t]),this.createSwatches(e[t]),this.setSymbolOnLibraryChange&&(this.executeChangeMarkupFromId(a),this.setSymbolOnLibraryChange=!1)}else this._loadTemplates(e,t).then(function(e){e&&e.length&&(o.currentTemplate.set(e[0]),o.styleIndex=0,o.currentStyleIndex[o.markupType]=0,i.set(e),o.createSwatches(e),o.setSymbolOnLibraryChange&&(o.executeChangeMarkupFromId(0),o.setSymbolOnLibraryChange=!1))})},i.prototype._loadTemplates=function(e,t){var i=this;this.loading=!0;var o=[];return new Promise(function(a,r){if(i.app.site.getEssentialsVersion()<4.07)return i._handleInvalidLibrary(t),i.loading=!1,i.app.trace.debug("Could not load symbol library '{0}'. Essentials 4.7 or newer is required.".format(t)),void a([]);var s=/^(.*?)(\/*)$/.exec(i.app.site.originalUrl)[1],u=p.UrlUtilities.simplify(s+"/../../symbols/{1}/{0}".format(t,function(e){switch(e){case n.SymbolType.POINT:case n.SymbolType.MULTIPOINT:return"point";case n.SymbolType.POLYGON:return"polygon";case n.SymbolType.POLYLINE:return"line";case n.SymbolType.TEXT:return"text";default:return e}}(i.markupType)));l.getEssentialsSymbolLibrary(u).then(function(r){var l=r&&r.symbols;if(!$.isArray(l))throw new Error(i.app.getResource("Mapping.Infrastructure","language-symbology-errors-malformed-library").format(t));for(var s=0;s<l.length;s++)switch(i.markupType){case n.SymbolType.POINT:case n.SymbolType.MULTIPOINT:var p=esri.symbol.fromJson(l[s]);if(p&&p instanceof esri.symbol.SimpleMarkerSymbol){var u=i._createPointTemplate(l[s].name,p.color,p.style,p.size,p.outline.color,p.outline.style,p.outline.width);u.selected.set(!s),o.push(u)}break;case n.SymbolType.POLYLINE:var c=esri.symbol.fromJson(l[s]);if(c&&c instanceof esri.symbol.SimpleLineSymbol){var m=i._createLineTemplate(l[s].name,c.color,c.style,c.width);m.selected.set(!s),o.push(m)}break;case n.SymbolType.POLYGON:var d=esri.symbol.fromJson(l[s]);if(d&&d instanceof esri.symbol.SimpleFillSymbol){var y=i._createPolygonTemplate(l[s].name,d.outline.color,d.color,d.outline.style,d.style,d.outline.width);y.selected.set(!s),o.push(y)}break;case n.SymbolType.TEXT:var b=esri.symbol.fromJson(l[s]);if(b&&b instanceof esri.symbol.TextSymbol){var g=i._createTextTemplate(l[s].name,b.color,b.font.family,b.font.style,b.font.weight,b.font.decoration,b.font.size,b.haloColor,b.haloSize);g.selected.set(!s),o.push(g)}}i.loading=!1,0===o.length?(i._handleInvalidLibrary(t),a([])):(e[t]=o,a(e[t]))},function(e){i._handleInvalidLibrary(t),i.loading=!1,r(e)})})},i.prototype._loadAllTemplates=function(){var e=this;return new Promise(function(t,i){for(var o=[],a=e.libraries[e.markupType].getItems(),r=0;r<a.length;r++){var l=a[r];e.currentTemplates[l]||o.push(e._loadTemplates(e.templates[e.markupType],l))}o.length>0?Promise.all(o).then(function(){t()}):t()})},i.prototype._handleInvalidLibrary=function(e){this.libraries[this.markupType].removeItem(e),1===this.libraries[this.markupType].getLength()&&this.showLibrarySwitcher.set(!1),0===this.libraries[this.markupType].getLength()&&(this.currentLibraries[this.markupType].set(null),this.showLibrarySwitcher.set(!1),this.noLibraries[this.markupType].set(!0),this.currentTemplate.set({name:""}))},i.prototype.initializePointStyles=function(e){this.pointLibraries.addItem(this.legacyLibraryName),this.pointTemplates[this.legacyLibraryName]=[];for(var t=0;t<e.length;t++)if(e[t].length<4)this.app.trace.warning("Point Style "+(t+1)+" in the style selector has an incorrect number of elements.");else{var i=this._createPointTemplate("",r.getColorFromString(e[t][1]),this.esriStyleLookup[n.SymbolType.POINT][e[t][2].toLowerCase()],e[t][3]);i.selected.set(!t),this.pointTemplates[this.legacyLibraryName].push(i)}},i.prototype.initializeLineStyles=function(e){this.lineLibraries.addItem(this.legacyLibraryName),this.lineTemplates[this.legacyLibraryName]=[];for(var t=0;t<e.length;t++)if(e[t].length<4)this.app.trace.warning("Line Style "+(t+1)+" in the style selector has an incorrect number of elements.");else{var i=this._createLineTemplate("",r.getColorFromString(e[t][1]),this.esriStyleLookup[n.SymbolType.POLYLINE][e[t][2].toLowerCase()],e[t][3]);i.selected.set(!t),this.lineTemplates[this.legacyLibraryName].push(i)}},i.prototype.initializePolygonStyles=function(e){this.polygonLibraries.addItem(this.legacyLibraryName),this.polygonTemplates[this.legacyLibraryName]=[];for(var t=0;t<e.length;t++)if(e[t].length<6)this.app.trace.warning("Polygon Style "+(t+1)+" in the style selector has an incorrect number of elements.");else{var i=this._createPolygonTemplate("",r.getColorFromString(e[t][1]),r.getColorFromString(e[t][2]),this.esriStyleLookup[n.SymbolType.POLYLINE][e[t][3].toLowerCase()],this.esriStyleLookup[n.SymbolType.POLYGON][e[t][4].toLowerCase()],e[t][5]);i.selected.set(!t),this.polygonTemplates[this.legacyLibraryName].push(i)}},i.prototype.initializeTextStyles=function(e){this.textLibraries.addItem(this.legacyLibraryName),this.textTemplates[this.legacyLibraryName]=[];for(var t=0;t<e.length;t++)if(e[t].length<6)this.app.trace.warning("Text Style "+(t+1)+" in the style selector has an incorrect number of elements.");else{var i=this._createTextTemplate("",r.getColorFromString(e[t][1]),e[t][5],this.esriStyleLookup[n.SymbolType.TEXT][e[t][2].toLowerCase()],this.esriStyleLookup[n.SymbolType.TEXT][e[t][3].toLowerCase()],esri.symbol.TextSymbol.DECORATION_NONE,e[t][4],r.getColorFromString("#FFFFFF"),0);i.selected.set(!t),this.textTemplates[this.legacyLibraryName].push(i)}},i.prototype._createPointTemplate=function(e,t,i,o,r,p,u){var c=this,m={type:n.SymbolType.POINT,name:e,hash:new s.LazyObservable(null,function(){return l.stringToHash(m.toJsonString())},!0),color:t.toRgba(),style:i,size:o,selected:new a.Observable(!1),outlineColor:r?r.toRgba():null,outlineStyle:p,outlineWidth:u,toSymbol:function(){return c._pointTemplateToSymbol(m)},toJsonString:function(){return JSON.stringify(m.toSymbol().toJson())}};return m},i.prototype._createLineTemplate=function(e,t,i,o){var r=this,p={type:n.SymbolType.POLYLINE,name:e,hash:new s.LazyObservable(null,function(){return l.stringToHash(p.toJsonString())},!0),color:t.toRgba(),style:i,width:o,selected:new a.Observable(!1),toSymbol:function(){return r._lineTemplateToSymbol(p)},toJsonString:function(){return JSON.stringify(p.toSymbol().toJson())}};return p},i.prototype._createPolygonTemplate=function(e,t,i,o,r,p){var u=this,c={type:n.SymbolType.POLYGON,name:e,hash:new s.LazyObservable(null,function(){return l.stringToHash(c.toJsonString())},!0),borderColor:t.toRgba(),fillColor:i.toRgba(),borderStyle:o,fillStyle:r,borderWidth:p,selected:new a.Observable(!1),toSymbol:function(){return u._polygonTemplateToSymbol(c)},toJsonString:function(){return JSON.stringify(c.toSymbol().toJson())}};return c},i.prototype._createTextTemplate=function(e,t,i,o,r,p,u,c,m){var d=this,y={type:n.SymbolType.TEXT,name:e,hash:new s.LazyObservable(null,function(){return l.stringToHash(y.toJsonString())},!0),textFamily:i,style:o,weight:r,decoration:p,size:u,color:t.toRgba(),haloColor:null,haloSize:null,selected:new a.Observable(!1),toSymbol:function(){return d._textTemplateToSymbol(y)},toJsonString:function(){return JSON.stringify(y.toSymbol().toJson())}};return this._isIE9or11||(y.haloColor=c?c.toRgba():null,y.haloSize=m),y},i.prototype._pointTemplateToSymbol=function(e){var t=new esri.symbol.SimpleMarkerSymbol;return t.setStyle(e.style),t.setSize(e.size),t.setColor(new esri.Color(e.color)),t.setOutline(new esri.symbol.SimpleLineSymbol),t.outline.setWidth(e.outlineWidth||0),t.outline.setColor(new esri.Color(e.outlineColor||e.color)),t.outline.setStyle(e.outlineStyle||esri.symbol.SimpleLineSymbol.STYLE_SOLID),t},i.prototype._lineTemplateToSymbol=function(e){var t=new esri.symbol.SimpleLineSymbol;return t.setStyle(e.style),t.setWidth(e.width),t.setColor(new esri.Color(e.color)),t},i.prototype._polygonTemplateToSymbol=function(e){var t=new esri.symbol.SimpleFillSymbol,i=new esri.symbol.SimpleLineSymbol;return i.setStyle(e.borderStyle),i.setWidth(e.borderWidth),i.setColor(new esri.Color(e.borderColor)),t.setOutline(i),t.setStyle(e.fillStyle),t.setColor(new esri.Color(e.fillColor)),t},i.prototype._textTemplateToSymbol=function(e){var t=new esri.symbol.TextSymbol(""),i=new esri.symbol.Font;return i.setFamily(e.textFamily.split(",")[0]),i.setSize(e.size),i.setStyle(e.style||esri.symbol.Font.STYLE_NORMAL),i.setWeight(e.weight||esri.symbol.Font.WEIGHT_NORMAL),t.setFont(i),t.setDecoration(e.decoration||esri.symbol.TextSymbol.DECORATION_NONE),t.setColor(new esri.Color(e.color)),this._isIE9or11||(t.setHaloSize(e.haloSize),t.setHaloColor(new esri.Color(e.haloColor))),t.setAlign(esri.symbol.TextSymbol.ALIGN_START),t},i}(o.ViewModelBase);i.MarkupTemplateSelectorViewModel=m})},"url:/Mapping/modules/Markup/MarkupStyles/MarkupStyleView.html":t,"url:/Mapping/modules/Markup/MarkupStyles/MarkupSymbolSelector/MarkupSymbolSelectorView.html":i,"url:/Mapping/modules/Markup/MarkupStyles/MarkupTemplateSelector/MarkupTemplateSelectorView.html":o,"url:/Mapping/modules/Markup/ToolPalettes/DeletePaletteSmall.html":a,"url:/Mapping/modules/Markup/ToolPalettes/EditPaletteLarge.html":r,"url:/Mapping/modules/Markup/ToolPalettes/EditPaletteSmall.html":l,"url:/Mapping/modules/Markup/ToolPalettes/MarkupPaletteSmall.html":n}}),require(["geocortex/framework/resourceManager"],function(e){e.resourceManager.register("Mapping","inv","Mapping/modules/Markup/CSS/common.css","css","LyogU1RBUlQ6IE1hcmt1cCAtLS0tLS0tLS0tLS0tLS0tKi8NCi5NYXJrdXBTdHlsZVZpZXcgLmZvcm0taXRlbSB7DQogICAgcGFkZGluZzogMDsNCn0NCg0KLk1hcmt1cEltYWdlU2VsZWN0b3JWaWV3IC5pbWFnZS1jb250YWluZXIgew0KICAgIG1heC1oZWlnaHQ6IDIyZW07DQp9DQoNCi5sYXllci1zdHlsZS1pbWFnZS1zZWxlY3RvciAuaW1hZ2UtY29udGFpbmVyIHsNCiAgICBtYXgtaGVpZ2h0OiAyMGVtOw0KICAgIHBhZGRpbmctbGVmdDogMC41ZW07DQp9DQoNCi50ZW1wbGF0ZS1saWJyYXJ5LXNlbGVjdG9yIHsNCiAgICBtYXJnaW4tdG9wOiAxMHB4Ow0KICAgIHdoaXRlLXNwYWNlOiBub3dyYXA7DQogICAgcG9zaXRpb246IGFic29sdXRlOw0KICAgIGJvdHRvbTogMGVtOw0KfQ0KDQouc3R5bGUtc2VsZWN0b3IgLm1hcmt1cC1zd2F0Y2ggew0KICAgIGxpc3Qtc3R5bGU6IG5vbmU7DQogICAgZGlzcGxheTogaW5saW5lLWJsb2NrOw0KICAgIG1hcmdpbjogMC41ZW07DQogICAgYm9yZGVyOiAxcHggc29saWQgI0RERERERDsNCiAgICB3aWR0aDogM2VtOw0KICAgIGhlaWdodDogM2VtOw0KICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgYmFja2dyb3VuZDogI0Y4RjhGODsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQp9DQoNCi5zdHlsZS1zZWxlY3RvciAuZm9ybS1idG5zIHsNCiAgICBjbGVhcjogYm90aDsNCiAgICB0ZXh0LWFsaWduOiByaWdodDsNCn0NCg0KLmljb24tc3dhdGNoLXBpY2tlci0yNCB7DQogICAgd2lkdGg6IDI0cHg7DQogICAgaGVpZ2h0OiAyNHB4Ow0KICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybCgiUmVzb3VyY2VzL0ltYWdlcy9JY29ucy9Ub29sYmFyL3N0eWxlcy0yNC5wbmciKTsNCn0NCg0KLmljb24tZHJhdy1lZGl0LTI0IHsNCiAgICB3aWR0aDogMjRweDsNCiAgICBoZWlnaHQ6IDI0cHg7DQogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKCJSZXNvdXJjZXMvSW1hZ2VzL0ljb25zL1Rvb2xiYXIvZHJhdy1lZGl0LTI0LnBuZyIpOw0KfQ0KDQoubWFya3VwLWVkaXQgew0KICAgIG1hcmdpbi10b3A6IC0wLjRlbTsNCn0NCg0KLnRvb2xiYXItYm9keSAuTWFya3VwRWRpdFZpZXcgIC50b29sYmFyLXNtYWxsLWxheW91dCB7DQogICAgcGFkZGluZzogMC41ZW07DQp9DQoNCi5lc3JpU3ltYm9sRWRpdG9yIHsNCiAgICBkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7DQp9DQovKiBFTkQ6IE1hcmt1cCAtLS0tLS0tLS0tLS0tLS0tKi8="),e.resourceManager.register("Mapping","inv","Mapping/modules/Markup/CSS/small.css","css","LyogU1RBUlQ6IE1hcmt1cCAtLS0tLS0tLS0tLS0tLS0tKi8NCi5UZXh0U3R5bGVWaWV3LA0KLnN0eWxlLXNlbGVjdG9yIHsNCiAgICBoZWlnaHQ6IDEwMCU7ICAgIA0KfQ0KLnN0eWxlLXNlbGVjdG9yIC5mb3JtLWJ0bnMgew0KICAgIG1hcmdpbi10b3A6IDFlbTsNCn0NCi5tYXJrdXAtZWRpdCB7DQogICAgd2lkdGg6IDEwMCU7DQogICAgZmxvYXQ6IGxlZnQ7DQp9DQoubWFya3VwLWVkaXQgLmljb24uaWNvbi1lcmFzZS0xNiB7DQogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKFJlc291cmNlcy9JbWFnZXMvSWNvbnMvVG9vbGJhci9lcmFzZS0yNC5wbmcpOw0KfQ0KLm1hcmt1cC1lZGl0IC5pY29uLmljb24tY2xlYXItMTYgew0KICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChSZXNvdXJjZXMvSW1hZ2VzL0ljb25zL1Rvb2xiYXIvY2xlYXItMjQucG5nKTsNCn0NCg0KLnRidG0tYnRuIHsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBoZWlnaHQ6IDQuNzVlbTsNCn0NCg0KDQpAbWVkaWEgYWxsIGFuZCAobWluLXdpZHRoOiAxMDBweCkgew0KICAgIC5tYXJrdXAtZWRpdCAudG9vbGJhci1pdGVtLmJ1dHRvbiB7DQogICAgICAgIHdpZHRoOiA0OS45JTsgLyogVHdpY2UgdGhlIGRlZmF1bHQgd2lkdGggYmVjYXVzZSB0aGUgbWFya3VwIGVkaXQgZGl2cyBhcmUgNTAlIHdpZGUgaW5zdGVhZCBvZiAxMDAlICovDQogICAgfQ0KICAgIC5tYXJrdXAtZWRpdCAudG9vbGJhci1pdGVtLmJ1dHRvbjpudGgtY2hpbGQoMW4rMSkgeyAvKiBPdmVycmlkZXMgdGhlIHByZXZpb3VzIGNsZWFyICovDQogICAgICAgIGNsZWFyOiBub25lOw0KICAgIH0NCiAgICAubWFya3VwLWVkaXQgLnRvb2xiYXItaXRlbS5idXR0b246bnRoLWNoaWxkKDJuKzEpIHsgLyogQ2xlYXJzIGV2ZXJ5IDNyZCBpdGVtICovDQogICAgICAgIGNsZWFyOiBib3RoOw0KICAgIH0NCn0NCg0KQG1lZGlhIGFsbCBhbmQgKG1pbi13aWR0aDogMjAwcHgpIHsNCiAgICAubWFya3VwLWVkaXQgLnRvb2xiYXItaXRlbS5idXR0b24gew0KICAgICAgICB3aWR0aDogMzMuMyU7DQogICAgfQ0KICAgIC5tYXJrdXAtZWRpdCAudG9vbGJhci1pdGVtLmJ1dHRvbjpudGgtY2hpbGQoMm4rMSkgeyAvKiBPdmVycmlkZXMgdGhlIHByZXZpb3VzIGNsZWFyICovDQogICAgICAgIGNsZWFyOiBub25lOw0KICAgIH0NCiAgICAubWFya3VwLWVkaXQgLnRvb2xiYXItaXRlbS5idXR0b246bnRoLWNoaWxkKDNuKzEpIHsNCiAgICAgICAgY2xlYXI6IGJvdGg7DQogICAgfQ0KfQ0KDQpAbWVkaWEgYWxsIGFuZCAobWluLXdpZHRoOiAzMDBweCkgew0KICAgIC5tYXJrdXAtZWRpdCB7IHdpZHRoOiA1MCU7IH0NCiAgICAubWFya3VwLWVkaXQgLnRvb2xiYXItaXRlbS5idXR0b24gew0KICAgICAgICB3aWR0aDogNDkuOSU7DQogICAgfQ0KICAgIC5tYXJrdXAtZWRpdCAudG9vbGJhci1pdGVtLmJ1dHRvbjpudGgtY2hpbGQoM24rMSkgeyAvKiBPdmVycmlkZXMgdGhlIHByZXZpb3VzIGNsZWFyICovDQogICAgICAgIGNsZWFyOiBub25lOw0KICAgIH0NCiAgICAubWFya3VwLWVkaXQgLnRvb2xiYXItaXRlbS5idXR0b246bnRoLWNoaWxkKDRuKzEpIHsNCiAgICAgICAgY2xlYXI6IGJvdGg7DQogICAgfQ0KfQ0KDQpAbWVkaWEgYWxsIGFuZCAobWluLXdpZHRoOiA0MDBweCkgew0KICAgIC5tYXJrdXAtZWRpdCB7IHdpZHRoOiA0MCU7IH0NCiAgICAubWFya3VwLWVkaXQgLnRvb2xiYXItaXRlbS5idXR0b24gew0KICAgICAgICB3aWR0aDogNDkuOSU7DQogICAgfQ0KICAgIC5tYXJrdXAtZWRpdCAudG9vbGJhci1pdGVtLmJ1dHRvbjpudGgtY2hpbGQoNG4rMSkgeyAvKiBPdmVycmlkZXMgdGhlIHByZXZpb3VzIGNsZWFyICovDQogICAgICAgIGNsZWFyOiBub25lOw0KICAgIH0NCiAgICAubWFya3VwLWVkaXQgLnRvb2xiYXItaXRlbS5idXR0b246bnRoLWNoaWxkKDVuKzEpIHsNCiAgICAgICAgY2xlYXI6IGJvdGg7DQogICAgfQ0KfQ0KDQpAbWVkaWEgYWxsIGFuZCAobWluLXdpZHRoOiA2MDBweCkgew0KICAgIC5tYXJrdXAtZWRpdCB7IHdpZHRoOiAzMy4zJTsgfQ0KICAgIC5tYXJrdXAtZWRpdCAudG9vbGJhci1pdGVtLmJ1dHRvbiB7DQogICAgICAgIHdpZHRoOiA0OS45JTsNCiAgICB9DQogICAgLm1hcmt1cC1lZGl0IC50b29sYmFyLWl0ZW0uYnV0dG9uOm50aC1jaGlsZCg1bisxKSB7IC8qIE92ZXJyaWRlcyB0aGUgcHJldmlvdXMgY2xlYXIgKi8NCiAgICAgICAgY2xlYXI6IG5vbmU7DQogICAgfQ0KICAgIC5tYXJrdXAtZWRpdCAudG9vbGJhci1pdGVtLmJ1dHRvbjpudGgtY2hpbGQoNm4rMSkgew0KICAgICAgICBjbGVhcjogYm90aDsNCiAgICB9DQp9DQoNCkBtZWRpYSBhbGwgYW5kIChtaW4td2lkdGg6IDcwMHB4KSB7DQogICAgLm1hcmt1cC1lZGl0IHsgd2lkdGg6IDI4LjU3JTsgfQ0KICAgIC5tYXJrdXAtZWRpdCAudG9vbGJhci1pdGVtLmJ1dHRvbiB7DQogICAgICAgIHdpZHRoOiA0OS45JTsNCiAgICB9DQogICAgLm1hcmt1cC1lZGl0IC50b29sYmFyLWl0ZW0uYnV0dG9uOm50aC1jaGlsZCg2bisxKSB7IC8qIE92ZXJyaWRlcyB0aGUgcHJldmlvdXMgY2xlYXIgKi8NCiAgICAgICAgY2xlYXI6IG5vbmU7DQogICAgfQ0KICAgIC5tYXJrdXAtZWRpdCAudG9vbGJhci1pdGVtLmJ1dHRvbjpudGgtY2hpbGQoN24rMSkgew0KICAgICAgICBjbGVhcjogYm90aDsNCiAgICB9DQp9DQoNCkBtZWRpYSBhbGwgYW5kIChtaW4td2lkdGg6IDgwMHB4KSB7DQogICAgLm1hcmt1cC1lZGl0IHsgd2lkdGg6IDI0LjklOyB9DQogICAgLm1hcmt1cC1lZGl0IC50b29sYmFyLWl0ZW0uYnV0dG9uIHsNCiAgICAgICAgd2lkdGg6IDQ5LjklOw0KICAgIH0NCiAgICAubWFya3VwLWVkaXQgLnRvb2xiYXItaXRlbS5idXR0b246bnRoLWNoaWxkKDduKzEpIHsgLyogT3ZlcnJpZGVzIHRoZSBwcmV2aW91cyBjbGVhciAqLw0KICAgICAgICBjbGVhcjogbm9uZTsNCiAgICB9DQogICAgLm1hcmt1cC1lZGl0IC50b29sYmFyLWl0ZW0uYnV0dG9uOm50aC1jaGlsZCg4bisxKSB7DQogICAgICAgIGNsZWFyOiBib3RoOw0KICAgIH0NCn0NCg0KQG1lZGlhIGFsbCBhbmQgKG1pbi13aWR0aDogOTAwcHgpIHsNCiAgICAubWFya3VwLWVkaXQgeyB3aWR0aDogMjIuMjIlOyB9DQogICAgLm1hcmt1cC1lZGl0IC50b29sYmFyLWl0ZW0uYnV0dG9uIHsNCiAgICAgICAgd2lkdGg6IDQ5LjklOw0KICAgIH0NCiAgICAubWFya3VwLWVkaXQgLnRvb2xiYXItaXRlbS5idXR0b246bnRoLWNoaWxkKDhuKzEpIHsgLyogT3ZlcnJpZGVzIHRoZSBwcmV2aW91cyBjbGVhciAqLw0KICAgICAgICBjbGVhcjogbm9uZTsNCiAgICB9DQogICAgLm1hcmt1cC1lZGl0IC50b29sYmFyLWl0ZW0uYnV0dG9uOm50aC1jaGlsZCg5bisxKSB7DQogICAgICAgIGNsZWFyOiBib3RoOw0KICAgIH0NCn0NCg0KQG1lZGlhIGFsbCBhbmQgKG1pbi13aWR0aDogMTAwMHB4KSB7DQogICAgLm1hcmt1cC1lZGl0IHsgd2lkdGg6IDIwJTsgfQ0KICAgIC5tYXJrdXAtZWRpdCAudG9vbGJhci1pdGVtLmJ1dHRvbiB7DQogICAgICAgIHdpZHRoOiA0OS45JTsNCiAgICB9DQogICAgLm1hcmt1cC1lZGl0IC50b29sYmFyLWl0ZW0uYnV0dG9uOm50aC1jaGlsZCg5bisxKSB7IC8qIE92ZXJyaWRlcyB0aGUgcHJldmlvdXMgY2xlYXIgKi8NCiAgICAgICAgY2xlYXI6IG5vbmU7DQogICAgfQ0KICAgIC5tYXJrdXAtZWRpdCAudG9vbGJhci1pdGVtLmJ1dHRvbjpudGgtY2hpbGQoMTBuKzEpIHsNCiAgICAgICAgY2xlYXI6IGJvdGg7DQogICAgfQ0KfQ0KDQpAbWVkaWEgYWxsIGFuZCAobWluLXdpZHRoOiAxMTAwcHgpIHsNCiAgICAubWFya3VwLWVkaXQgeyB3aWR0aDogMTguMTglOyB9DQogICAgLm1hcmt1cC1lZGl0IC50b29sYmFyLWl0ZW0uYnV0dG9uIHsNCiAgICAgICAgd2lkdGg6IDQ5LjklOw0KICAgIH0NCiAgICAubWFya3VwLWVkaXQgLnRvb2xiYXItaXRlbS5idXR0b246bnRoLWNoaWxkKDEwbisxKSB7IC8qIE92ZXJyaWRlcyB0aGUgcHJldmlvdXMgY2xlYXIgKi8NCiAgICAgICAgY2xlYXI6IG5vbmU7DQogICAgfQ0KICAgIC5tYXJrdXAtZWRpdCAudG9vbGJhci1pdGVtLmJ1dHRvbjpudGgtY2hpbGQoMTFuKzEpIHsNCiAgICAgICAgY2xlYXI6IGJvdGg7DQogICAgfQ0KfQ0KDQpAbWVkaWEgYWxsIGFuZCAobWluLXdpZHRoOiAxMjAwcHgpIHsNCiAgICAubWFya3VwLWVkaXQgeyB3aWR0aDogMTYuNjY3JTsgfQ0KICAgIC5tYXJrdXAtZWRpdCAudG9vbGJhci1pdGVtLmJ1dHRvbiB7DQogICAgICAgIHdpZHRoOiA0OS45JTsNCiAgICB9DQogICAgLm1hcmt1cC1lZGl0IC50b29sYmFyLWl0ZW0uYnV0dG9uOm50aC1jaGlsZCgxMW4rMSkgeyAvKiBPdmVycmlkZXMgdGhlIHByZXZpb3VzIGNsZWFyICovDQogICAgICAgIGNsZWFyOiBub25lOw0KICAgIH0NCiAgICAubWFya3VwLWVkaXQgLnRvb2xiYXItaXRlbS5idXR0b246bnRoLWNoaWxkKDEybisxKSB7DQogICAgICAgIGNsZWFyOiBib3RoOw0KICAgIH0NCn0NCi8qIEVORDogTWFya3VwIC0tLS0tLS0tLS0tLS0tLS0qLw=="),e.resourceManager.register("Mapping","inv","Mapping/modules/Markup/MarkupStyles/MarkupStyleView.html","html",t),e.resourceManager.register("Mapping","inv","Mapping/modules/Markup/MarkupStyles/MarkupSymbolSelector/MarkupSymbolSelectorView.html","html",i),e.resourceManager.register("Mapping","inv","Mapping/modules/Markup/MarkupStyles/MarkupTemplateSelector/MarkupTemplateSelectorView.html","html",o),e.resourceManager.register("Mapping","inv","Mapping/modules/Markup/ToolPalettes/DeletePaletteSmall.html","html",a),e.resourceManager.register("Mapping","inv","Mapping/modules/Markup/ToolPalettes/EditPaletteLarge.html","html",r),e.resourceManager.register("Mapping","inv","Mapping/modules/Markup/ToolPalettes/EditPaletteSmall.html","html",l),e.resourceManager.register("Mapping","inv","Mapping/modules/Markup/ToolPalettes/MarkupPaletteSmall.html","html",n)}),require({cache:{}}),define(["Mapping/modules/Markup/MarkupModule","Mapping/modules/Markup/MarkupViewModel","Mapping/modules/Markup/ToolPalettes/TransientMarkupPaletteView","Mapping/modules/Markup/ToolPalettes/TransientMarkupPaletteViewModel","Mapping/modules/Markup/MarkupStyles/MarkupSymbolSelector/MarkupSymbolSelectorView","Mapping/modules/Markup/MarkupStyles/MarkupSymbolSelector/MarkupSymbolSelectorViewModel","Mapping/modules/Markup/MarkupStyles/MarkupTemplateSelector/MarkupTemplateSelectorView","Mapping/modules/Markup/MarkupStyles/MarkupTemplateSelector/MarkupTemplateSelectorViewModel"],function(t,i,o,a,r,l,n,s){e(t,"geocortex.essentialsHtmlViewer.mapping.modules.markup.MarkupModule",t.MarkupModule),e(i,"geocortex.essentialsHtmlViewer.mapping.modules.markup.MarkupViewModel",i.MarkupViewModel),e(o,"geocortex.essentialsHtmlViewer.mapping.modules.markup.toolPalettes.TransientMarkupPaletteView",o.TransientMarkupPaletteView),e(a,"geocortex.essentialsHtmlViewer.mapping.modules.markup.toolPalettes.TransientMarkupPaletteViewModel",a.TransientMarkupPaletteViewModel),e(r,"geocortex.essentialsHtmlViewer.mapping.modules.markup.MarkupSymbolSelectorView",r.MarkupSymbolSelectorView),e(l,"geocortex.essentialsHtmlViewer.mapping.modules.markup.MarkupSymbolSelectorViewModel",l.MarkupSymbolSelectorViewModel),e(n,"geocortex.essentialsHtmlViewer.mapping.modules.markup.MarkupTemplateSelectorView",n.MarkupTemplateSelectorView),e(s,"geocortex.essentialsHtmlViewer.mapping.modules.markup.MarkupTemplateSelectorViewModel",s.MarkupTemplateSelectorViewModel)})}();