!function(){var t="<div class='markup-style panel-group-contents gcx-sticky-content has-footer'>    \x3c!-- Markup type selector --\x3e    <div class='markup-type-selector form-item' data-binding='{@visible: showMarkupSelectorMenu}'>        <label class='symbology-label' for='markupStyleSelector' data-binding='{@text: @language-markup-select-style-type}'></label>        <select id='markupStyleSelector' data-binding='{@source: markupSelectors}{@value: currentSelector}{@event-onchange: handleSelectorChange}' class='symbology-select'>            <option data-binding='{@template-for: markupSelectors}{@text: displayName}{@attach: @context}'></option>        </select>    </div>    \x3c!-- BEGIN: Content region --\x3e    <div class='markup-style-selector' data-binding='{data-region-name: regionName}{data-region-adapter: regionType}{@var: scrollRegionElement}{@event-onscroll: handleScrollChange}'></div>    \x3c!-- END: Content region --\x3e</div><div class='form-btns gcx-sticky-footer'>    <button class='button' data-binding='{@event-click: handleDoneButtonClick}{@text: @language-common-done}'></button>    <button class='button' data-binding='{@event-click: handleCustomizeButtonClick}{@text: @language-common-customize}{@visible: showCustomizeButton}'></button>    <button class='button' data-binding='{@event-click: handleRevertButtonClick}{@text: @language-common-revert}{@visible: showRevertButton}'></button></div>",i="\x3c!-- BEGIN: Content region --\x3e<div class='markup-configuration-selector' data-region-name='MarkupStyleConfigurationRegion' data-region-adapter='geocortex.framework.ui.MultiDivRegionAdapter'></div>\x3c!-- END: Content region --\x3e",o="\x3c!-- Symbol Text --\x3e<div class='symbology-textinput' data-binding='{@visible: isText}'>    <div class='form-item' data-binding='{@hidden: noTextLibraries}'>        <label class='symbology-label' data-binding='{@text: @language-common-text}{for: symbologyTextInputId}'></label>        <input type='text' data-binding='{@value: symbolText}{@event-oninput: handleTextChange}{@event-onchange: handleTextChange}{id: symbologyTextInputId}' />    </div></div>\x3c!-- Current Template Name --\x3e<div data-binding='{@source: currentTemplate}'>    <span class='symbol-name' data-binding='{@template-for: currentTemplate}{@text: name}'></span></div>\x3c!-- Point Templates --\x3e<div class='style-selector markup point' data-binding='{@visible: isPoint}'>    \x3c!-- Template Selector --\x3e    <div class='swatch-container template-container' data-binding='{@source: currentPointTemplates}{@hidden: noPointLibraries}'>        <button class='markup-swatch markup-swatch-point' data-binding='{@template-for: currentPointTemplates}{@class-selected: selected}{aria-label: name}'></button>    </div>    \x3c!-- Library Switcher --\x3e    <span class='image-library-selector form-item inline-block' data-binding='{@visible: showLibrarySwitcher}'>        <label class='symbology-label' data-binding='{for: pointLibrarySwitcherId}{@text: @language-common-library}'></label>        <select data-binding='{id: pointLibrarySwitcherId}{@source: pointLibraries}{@value: currentPointLibrary}{@event-oninput: handleLibraryChange}{@event-onchange: handleLibraryChange}'>            <option data-binding='{@template-for: pointLibraries}{@text: @context}{@attach: @context}'></option>        </select>    </span>    <div class='no-symbol-library' data-binding='{@visible: noPointLibraries}'>        <span data-binding='{@text: @language-markup-nolibraries}' />    </div></div>\x3c!-- Polyline Templates --\x3e<div class='style-selector markup polyline' data-binding='{@visible: isLine}'>    \x3c!-- Template Selector --\x3e    <div class='swatch-container template-container' data-binding='{@source: currentLineTemplates}{@hidden: noLineLibraries}'>        <button class='markup-swatch markup-swatch-polyline' data-binding='{@template-for: currentLineTemplates}{@class-selected: selected}{aria-label: name}'></button>    </div>    \x3c!-- Library Switcher --\x3e    <span class='image-library-selector form-item inline-block' data-binding='{@visible: showLibrarySwitcher}'>        <label class='symbology-label' data-binding='{for: lineLibrarySwitcherId}{@text: @language-common-library}'></label>        <select data-binding='{id: lineLibrarySwitcherId}{@source: lineLibraries}{@value: currentLineLibrary}{@event-oninput: handleLibraryChange}{@event-onchange: handleLibraryChange}'>            <option data-binding='{@template-for: lineLibraries}{@text: @context}{@attach: @context}'></option>        </select>    </span>    <div class='no-symbol-library' data-binding='{@visible: noLineLibraries}'>        <span data-binding='{@text:  @language-markup-nolibraries}' />    </div></div>\x3c!-- Polygon Templates --\x3e<div class='style-selector markup polygon' data-binding='{@visible: isPolygon}'>    \x3c!-- Template Selector --\x3e    <div class='swatch-container template-container' data-binding='{@source: currentPolygonTemplates}{@hidden: noPolygonLibraries}'>        <button class='markup-swatch markup-swatch-polygon' data-binding='{@template-for: currentPolygonTemplates}{@class-selected: selected}{aria-label: name}'></button>    </div>    \x3c!-- Library Switcher --\x3e    <span class='image-library-selector form-item inline-block' data-binding='{@visible: showLibrarySwitcher}'>        <label class='symbology-label' data-binding='{for: polygonLibrarySwitcherId}{@text: @language-common-library}'></label>        <select data-binding='{id: polygonLibrarySwitcherId}{@source: polygonLibraries}{@value: currentPolygonLibrary}{@event-oninput: handleLibraryChange}{@event-onchange: handleLibraryChange}'>            <option data-binding='{@template-for: polygonLibraries}{@text: @context}{@attach: @context}'></option>        </select>    </span>    <div class='no-symbol-library' data-binding='{@visible: noPolygonLibraries}'>        <span data-binding='{@text:  @language-markup-nolibraries}' />    </div></div>\x3c!-- Text Templates --\x3e<div class='style-selector markup text' data-binding='{@visible: isText}'>    \x3c!-- Template Selector --\x3e    <div class='swatch-container template-container' data-binding='{@source: currentTextTemplates}{@hidden: noTextLibraries}'>        <button class='markup-swatch markup-swatch-text' data-binding='{@template-for: currentTextTemplates}{@class-selected: selected}'></button>    </div>    \x3c!-- Library Switcher --\x3e    <span class='image-library-selector form-item inline-block' data-binding='{@visible: showLibrarySwitcher}'>        <label class='symbology-label' data-binding='{for: textLibrarySwitcherId}{@text: @language-common-library}'></label>        <select data-binding='{id: textLibrarySwitcherId}{@source: textLibraries}{@value: currentTextLibrary}{@event-oninput: handleLibraryChange}{@event-onchange: handleLibraryChange}'>            <option data-binding='{@template-for: textLibraries}{@text: @context}{@attach: @context}'></option>        </select>    </span>    <div class='no-symbol-library' data-binding='{@visible: noTextLibraries}'>        <span data-binding='{@text:  @language-markup-nolibraries}'/>    </div></div>",a="<div class='toolbar-tool-mode'>    <button class='tbtm-done' data-binding='{@event-onclick: handleClickDone}'>        <span data-binding='{@text: @language-menu-done}'></span>    </button>    <div class='tbtm-list'>        <ul class='two'>            <li>                <button class='tbtm-btn' data-binding='{@event-onclick: handleClickEdit}'>                    <span class='icon icon-draw-edit-24'></span>                </button>                <label data-binding='{@text: @language-toolbar-markup-palette-small-edit}'></label>            </li>            <li>                <button class='tbtm-btn' data-binding='{@event-onclick: handleClickClear}{@disabled: clearDisabled}'>                    <span class='icon icon-clear-24'></span>                </button>                <label data-binding='{@text: @language-toolbar-clear-all}'></label>            </li>        </ul>    </div></div>",r="<ul class='markup-edit'>    <li>        <button class='toolbar-item' data-binding='{@disabled: changeStyleDisabled}{@event-onclick: handleClickChangeStyle}{title: @language-toolbar-markup-change-markup-style-tooltip}'>            <span class='icon icon-swatch-picker-24'></span>            <p data-binding='{@text: @language-toolbar-markup-palette-small-change-style}'></p>        </button>    </li></ul>",l="<div class='toolbar-tool-mode'>    <button class='tbtm-done' data-binding='{@event-onclick: handleClickDone}'>        <span data-binding='{@text: @language-menu-done}'></span>    </button>    <div class='tbtm-list'>        <ul class='three'>            <li>                <button class='tbtm-btn' data-binding='{@event-onclick: handleClickChangeStyle}{@disabled: changeStyleDisabled}'>                    <span class='icon icon-swatch-picker-24'></span>                </button>                <label data-binding='{@text: @language-toolbar-markup-palette-small-change-style}'></label>            </li>            <li>                <button class='tbtm-btn' data-binding='{@event-onclick: handleClickDelete}{@disabled: clearDisabled}'>                    <span class='icon icon-draw-edit-24'></span>                </button>                <label data-binding='{@text: @language-toolbar-markup-palette-small-delete}'></label>            </li>            <li>                <button class='tbtm-btn' data-binding='{@event-onclick: handleClickClear}{@disabled: clearDisabled}'>                    <span class='icon icon-clear-24'></span>                </button>                <label data-binding='{@text: @language-toolbar-clear-all}'></label>            </li>        </ul>    </div></div>",n="<div class='toolbar-tool-mode'>    <div class='tbtm-done' data-binding='{@event-onclick: handleClickDone}'>        <span data-binding='{@text: @language-menu-done}'></span>    </div>    <div class='tbtm-list'>        <ul class='transient-element markup four'>            <li>                <button class='tbtm-btn' data-binding='{@disabled: changeStyleDisabled}{@event-onclick: handleClickChangeStyle}'>                    <span class='icon icon-swatch-picker-24'></span>                    <p data-binding='{@text: @language-toolbar-markup-palette-small-change-style}'></p>                </button>            </li>            <li>                <button class='tbtm-btn' data-binding='{@class-highlight: editToggled}{@event-onclick: handleClickEdit}'>                    <span class='icon icon-draw-edit-24'></span>                    <p data-binding='{@text: @language-toolbar-markup-palette-small-edit}'></p>                </button>            </li>            <li>                <button class='tbtm-btn' data-binding='{@disabled: clearDisabled}{@class-highlight: deleteToggled}{@event-onclick: handleClickDelete}'>                    <span class='icon icon-erase-24'></span>                    <p data-binding='{@text: @language-toolbar-erase}'></p>                </button>            </li>            <li>                <button class='tbtm-btn' data-binding='{@disabled: clearDisabled}{@event-onclick: handleClickClear}'>                    <span class='icon icon-clear-24'></span>                    <p data-binding='{@text: @language-toolbar-clear-all}'></p>                </button>            </li>        </ul>    </div></div>";function s(e,t,i){if("string"==typeof e&&(i=t,t=e),void 0!==i)for(var o=t.split("."),a=null,r=window,l=0,n=o.length;l<n;l++)a=o[l],l==n-1?r[a]=i:r[a]||(r[a]={}),r=r[a];else console.warn("Undefined shim for: "+t)}require({cache:{"Mapping/modules/Markup/MarkupModule":function(){var o,l=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/application/ModuleBase"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,a=(o=i.ModuleBase,l(r,o),r);function r(){return null!==o&&o.apply(this,arguments)||this}t.MarkupModule=a})},"Mapping/modules/Markup/MarkupViewModel":function(){var o,v=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewModelBase","geocortex/infrastructure/SymbolUtils","geocortex/framework/observables","geocortex/infrastructure/ColorUtils","geocortex/essentials/GeometryUtilities","geocortex/infrastructure/FeatureSetCollection","geocortex/infrastructure/FeatureSet","geocortex/infrastructure/symbology/SymbolType","geocortex/infrastructure/tools/MapTool","geocortex/infrastructure/tools/DrawMode","geocortex/infrastructure/coordinates/CoordinatesManager","geocortex/infrastructure/accessibility/Edit","geocortex/infrastructure/GraphicUtils","geocortex/infrastructure/GraphicsLayerUtils","geocortex/infrastructure/GraphicsLayerIds","geocortex/infrastructure/SymbolUtils","geocortex/infrastructure/BrowserUtils"],function(e,t,i,a,o,r,S,M,C,l,n,s,p,u,c,m,d,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h,g=(h=i.ViewModelBase,v(k,h),k.prototype.initialize=function(e){var t=this,i=b.isIE();if(this._isIE9or11=9===i||11===i,this._textSymbol=a.defaultTextSymbol(this._isIE9or11),this._fontSymbol=this._textSymbol.font,e.markupLayerName&&d.changeGraphicsLayerIdBase(e.markupLayerName),11===i&&this.app.doWhenMapInitialized(function(){var e=m.getInternalGraphicsLayer(d.MARKUP_LAYER_ID,t.app,m.GraphicsLayerType.Markup,!0);e&&t.app.markupLayer.set(e)}),e.defaultPointMarkup&&(e.defaultPointMarkup.pointStyle&&this._markerSymbol.setStyle(e.defaultPointMarkup.pointStyle.toLowerCase()),e.defaultPointMarkup.pointSize&&this._markerSymbol.setSize(e.defaultPointMarkup.pointSize),e.defaultPointMarkup.pointColor)){var o=r.getColorFromString(e.defaultPointMarkup.pointColor);this._markerSymbol.setColor(o),this._markerSymbol.outline.setColor(o)}y.setDefaultPointMarkup(this._markerSymbol),e.defaultLineMarkup&&(e.defaultLineMarkup.lineStyle&&this._lineSymbol.setStyle(e.defaultLineMarkup.lineStyle.toLowerCase()),e.defaultLineMarkup.lineWidth&&this._lineSymbol.setWidth(e.defaultLineMarkup.lineWidth),e.defaultLineMarkup.lineColor&&this._lineSymbol.setColor(r.getColorFromString(e.defaultLineMarkup.lineColor))),y.setDefaultPolylineMarkup(this._lineSymbol),e.defaultPolygonMarkup&&(e.defaultPolygonMarkup.polygonBorderStyle&&this._polyBorderSymbol.setStyle(e.defaultPolygonMarkup.polygonBorderStyle.toLowerCase()),e.defaultPolygonMarkup.polygonFillStyle&&this._polyFillSymbol.setStyle(e.defaultPolygonMarkup.polygonFillStyle.toLowerCase()),e.defaultPolygonMarkup.polygonBorderWidth&&this._polyBorderSymbol.setWidth(e.defaultPolygonMarkup.polygonBorderWidth),e.defaultPolygonMarkup.polygonFillColor&&this._polyFillSymbol.setColor(r.getColorFromString(e.defaultPolygonMarkup.polygonFillColor)),e.defaultPolygonMarkup.polygonBorderColor&&this._polyBorderSymbol.setColor(r.getColorFromString(e.defaultPolygonMarkup.polygonBorderColor)),this._polyFillSymbol.setOutline(this._polyBorderSymbol)),y.setDefaultPolygonMarkup(this._polyFillSymbol),e.defaultTextMarkup&&(e.defaultTextMarkup.textStyle&&this._fontSymbol.setStyle(e.defaultTextMarkup.textStyle.toLowerCase()),e.defaultTextMarkup.textWeight&&this._fontSymbol.setWeight(e.defaultTextMarkup.textWeight.toLowerCase()),e.defaultTextMarkup.textSize&&this._fontSymbol.setSize(e.defaultTextMarkup.textSize),e.defaultTextMarkup.textColor&&this._textSymbol.setColor(r.getColorFromString(e.defaultTextMarkup.textColor)),e.defaultTextMarkup.textFamily&&this._fontSymbol.setFamily(e.defaultTextMarkup.textFamily),e.defaultTextMarkup.textHaloColor&&!this._isIE9or11&&this._textSymbol.setHaloColor(r.getColorFromString(e.defaultTextMarkup.textHaloColor)),e.defaultTextMarkup.textHaloSize&&!this._isIE9or11&&this._textSymbol.setHaloSize(e.defaultTextMarkup.textHaloSize)),y.setDefaultTextMarkup(this._textSymbol),this.app.toolRegistry.registerToolTypeForCommand("EditMarkup","geocortex.essentialsHtmlViewer.mapping.infrastructure.tools.DisablingMapTool"),this.app.toolRegistry.registerToolTypeForCommand("DeleteMarkup","geocortex.essentialsHtmlViewer.mapping.infrastructure.tools.DisablingMapTool"),this.markupTools.point=this.markupTools.point.concat(e.customMarkupTools.point),this.markupTools.polyline=this.markupTools.polyline.concat(e.customMarkupTools.polyline),this.markupTools.polygon=this.markupTools.polygon.concat(e.customMarkupTools.polygon),this.markupTools.text=this.markupTools.text.concat(e.customMarkupTools.text),this.markupType.bind(this,function(e){e===l.SymbolType.MULTIPOINT&&(e=l.SymbolType.POINT),"extent"===e&&(e=l.SymbolType.POLYGON),t.app.event("MarkupTypeChangedEvent").publish(e)}),this.currentSymbol.bind(this,function(e){t.app.event("MarkupSymbolChangedEvent").publish(e)}),this.currentSymbol.set(this._markerSymbol),this.initializeCommands(),this.initializeEvents()},k.prototype.initializeCommands=function(){var t=this;this.app.command("AddMarkup").register(this,this.executeAddMarkupCommand,this.canExecuteAddMarkupCommand),this.app.command("AddMarkupFeature").register(this,this.executeAddMarkupFeatureCommand,this.canExecuteAddMarkupFeatureCommand),this.app.command("AddMarkupGeometry").register(this,this.executeAddMarkupCommand,this.canExecuteAddMarkupCommand),this.app.command("AddTextMarkup").register(this,this.executeAddTextMarkupCommand,this.canExecuteAddTextMarkupCommand),this.app.command("ClearMarkup").register(this,this.executeClearMarkupCommand,this.canExecuteClearMarkupCommand),this.app.command("ClearMarkupQuiet").register(this,this.executeClearMarkupQuietCommand,this.canExecuteClearMarkupQuietCommand),this.app.command("ClearCustomGraphics").register(this,this.executeClearCustomGraphicsCommand,this.canExecuteClearCustomGraphicsCommand),this.app.command("EditMarkup").register(this,this.executeEditMarkupCommand,this.canExecuteEditMarkupCommand),this.app.command("DeleteMarkup").register(this,this.executeDeleteMarkupCommand,this.canExecuteDeleteMarkupCommand),this.app.command("ExportMarkupLayer").register(this,this.executeExportMarkupLayerCommand,this.canExecuteExportMarkupLayerCommand),this.app.command("ExportGraphicsLayer").register(this,this.executeExportGraphicsLayerCommand),this.app.command("ChangeMarkupStyle").register(this,this.executeChangeMarkupStyleCommand,this.canExecuteChangeMarkupStyleCommand),this.app.command("CreateMarkupStyleView").register(this,this.executeCreateStyleViewCommand,this.canExecuteCreateStyleViewCommand),this.app.command("StopEditingMarkup").register(this,this.executeStopEditingCommand,this.canExecuteStopEditingCommand),this.app.command("_applySymbolToEditedMarkup").register(this,this._applySymbolToEditedMarkup,function(){return!!t.editToolbar}),this._initializeClickableGraphicCommands(),this.app.event("ProjectLoadedEvent").once(this,function(){var e=t.app.map.getLayer(d.MARKUP_LAYER_ID);e&&(m.registerMarkupLayerAsClickable(e,t.app),t.app.command("ExportMarkupLayer").raiseCanExecuteChanged())})},k.prototype._initializeClickableGraphicCommands=function(){this.app.command("StopAndAutoEditClickableFeature").register(this,this.executeStopAndAutoEditClickableFeature,this.canExecuteAutoEditClickableFeature),this.app.command("EditClickableFeature").register(this,this.executeEditClickableFeature,c.isEditableButNotAutoEditableClickableFeature),this.app.command("StopEditingClickableFeature").register(this,this.executeStopEditingClickableFeature,this.canExecuteStopEditingClickableFeature),this.app.command("DeleteClickableFeature").register(this,this.executeDeleteClickableFeature,this.canExecuteDeleteClickableFeature),this.app.command("HighlightFeature").register(this,function(){},this._canHighlightClickableFeature),this.app.command("HighlightFeatures").register(this,function(){},this._canHighlightClickableFeature),this.app.command("ClearAndHighlightFeatures").register(this,function(){},this._canHighlightClickableFeature),this.app.command("HighlightFeatureDefault").register(this,function(){},this._canHighlightClickableFeature)},k.prototype._canHighlightClickableFeature=function(e){var t=e&&e.esriFeature?e.esriFeature.get():null;if(!t)return!0;if(c.isClickableGraphic(this.app,t)){var i=c.getClickableLayerInfo(this.app,t),o=c.getCapabilitiesForGraphic(this.app,t);if(this._hasCapability("edit",o)&&i.autoEditable)return!1}return!0},k.prototype.initializeEvents=function(){var t=this;this.app.event("ActiveToolChangedEvent").subscribe(this,function(e){t.app.command("CreateMarkupStyleView").raiseCanExecuteChanged(),t.app.command("ExportMarkupLayer").raiseCanExecuteChanged(),t.app.command("StopEditingMarkup").execute(),e.tool?(null!==t._clearStyleViewTimeout&&(clearTimeout(t._clearStyleViewTimeout),t._clearStyleViewTimeout=null),t._handleActiveToolChanged(e.tool)):t._clearStyleViewTimeout=setTimeout(function(){t.app.command("HideMarkupStyleView").execute()},250)}),this.app.event("GraphicRemovedEvent").subscribe(this,function(e){return t._onGraphicDeleted(e)})},k.prototype.canExecuteAddMarkupCommand=function(e){return!!e},k.prototype.executeAddMarkupCommand=function(e){this._addMarkup(e)},k.prototype.canExecuteAddMarkupFeatureCommand=function(e){return!!(e&&e.esriFeature&&e.esriFeature.get()&&e.esriFeature.get().geometry)},k.prototype.executeAddMarkupFeatureCommand=function(e){var t=e.esriFeature.get().geometry;this._addMarkup(esri.geometry.fromJson(t.toJson()))},k.prototype.canExecuteClearMarkupCommand=function(){return this._markupExists(d.MARKUP_LAYER_ID)},k.prototype.executeClearMarkupCommand=function(){this.clearMarkup()},k.prototype.canExecuteClearMarkupQuietCommand=function(){return this._markupExists(d.MARKUP_LAYER_ID)},k.prototype.executeClearMarkupQuietCommand=function(){this.clearMarkupQuiet()},k.prototype.canExecuteClearCustomGraphicsCommand=function(e){return this._markupExists(e)},k.prototype.executeClearCustomGraphicsCommand=function(e){this.clearCustomGraphics(e)},k.prototype.canExecuteAddTextMarkupCommand=function(e){return!!e},k.prototype.executeAddTextMarkupCommand=function(e){this._addTextMarkup(e)},k.prototype.canExecuteDeleteMarkupCommand=function(){return this._markupExists()},k.prototype.executeDeleteMarkupCommand=function(e){this.deleteMarkup(e)},k.prototype.canExecuteExportMarkupLayerCommand=function(){return this._hasExportableMarkup()},k.prototype.executeExportMarkupLayerCommand=function(){var e={format:"shp",graphicLayer:m.getAllMarkupLayers()};this.app.command("ExportGraphicsLayer").execute(e)},k.prototype.executeExportGraphicsLayerCommand=function(e){var t,i,o,a,r=[];e.graphicLayer instanceof Array?r.push.apply(r,e.graphicLayer):r.push(e.graphicLayer);for(var l=0,n=r;l<n.length;l++)for(var s=0,p=n[l].graphics;s<p.length;s++){var u=p[s];if(null!=u.geometry)switch(u.geometry.type){case"point":null!=u.symbol&&"textsymbol"!==u.symbol.type&&(null==i&&(i=new esri.tasks.FeatureSet),i.features.push(new esri.Graphic(u.geometry,u.symbol,u.attributes,null)));break;case"polygon":null==o&&(o=new esri.tasks.FeatureSet),o.features.push(new esri.Graphic(u.geometry,u.symbol,u.attributes,null));break;case"extent":null==o&&(o=new esri.tasks.FeatureSet);var c=S.envelopeToPolygon(u.geometry);o.features.push(new esri.Graphic(c,u.symbol,u.attributes,null));break;case"polyline":null==t&&(t=new esri.tasks.FeatureSet),t.features.push(new esri.Graphic(u.geometry,u.symbol,u.attributes,null));break;case"multipoint":null==a&&(a=new esri.tasks.FeatureSet),a.features.push(new esri.Graphic(u.geometry,u.symbol,u.attributes,null))}}var m=new M.FeatureSetCollection;if(null!=i){var d=new C.FeatureSet({esriFeatureSet:i});d.displayName.set("Point"),m.featureSets.addItem(d)}if(null!=o){var y=new C.FeatureSet({esriFeatureSet:o});y.displayName.set("Polygon"),m.featureSets.addItem(y)}if(null!=t){var b=new C.FeatureSet({esriFeatureSet:t});b.displayName.set("Polyline"),m.featureSets.addItem(b)}if(null!=a){var h=new C.FeatureSet({esriFeatureSet:a});h.displayName.set("Multipoint"),m.featureSets.addItem(h)}var g={format:e.format,fsc:m};this.app.command("ExportResultsTo").execute(g)},k.prototype.canExecuteEditMarkupCommand=function(){return this._markupExists()},k.prototype.executeEditMarkupCommand=function(e){this._editMarkup(e)},k.prototype.canExecuteChangeMarkupStyleCommand=function(){return!0},k.prototype.canExecuteCreateStyleViewCommand=function(e){if(!this.markupType||!this.currentSymbol)return!1;var t=e?e.esriFeature.get():null;if(t){var i=c.getCapabilitiesForGraphic(this.app,t);if(!this._hasCapability("style",i))return!1}return!0},k.prototype.executeCreateStyleViewCommand=function(){this.app.command("_showMarkupStyleSelectorView").execute(this.currentEditedSymbol||this.currentSymbol.get())},k.prototype.canExecuteStopEditingCommand=function(){return!!this.editToolbar},k.prototype.executeStopEditingCommand=function(e){if(this.editToolbar){var t=this.editToolbar.getCurrentState().graphic||this._modifiedGraphic;this.app.event("MarkupEditingStoppedEvent").publish(t),this._deactivateToolbar(),this._originalGraphic=this._modifiedGraphic=null,this.currentEditedSymbol=null,this.app.command("ExportMarkupLayer").raiseCanExecuteChanged(),this.app.toolRegistry.getActiveTool()&&e&&"EditMarkupTool"===this.app.toolRegistry.getActiveTool().name&&this.app.command("ClearActiveTool").execute(),this.app.command("HideMarkupStyleView").execute()}},k.prototype._handleActiveToolChanged=function(e){if(e){var t="";if(e instanceof n.MapTool&&-1!==["AddMarkup","AddMarkupGeometry","AddTextMarkup"].indexOf(e.command))switch(e.drawMode){case s.DrawMode.POINT:t="AddTextMarkup"===e.command?l.SymbolType.TEXT:l.SymbolType.POINT;break;case s.DrawMode.MULTI_POINT:t=l.SymbolType.POINT;break;case s.DrawMode.LINE:case s.DrawMode.POLYLINE:case s.DrawMode.FREEHAND_POLYLINE:t=l.SymbolType.POLYLINE;break;case s.DrawMode.POLYGON:case s.DrawMode.FREEHAND_POLYGON:case s.DrawMode.EXTENT:case s.DrawMode.ARROW:case s.DrawMode.LEFT_ARROW:case s.DrawMode.RIGHT_ARROW:case s.DrawMode.UP_ARROW:case s.DrawMode.DOWN_ARROW:case s.DrawMode.TRIANGLE:case s.DrawMode.CIRCLE:case s.DrawMode.ELLIPSE:case s.DrawMode.RECTANGLE:t=l.SymbolType.POLYGON}else-1!==$.inArray(e.name,this.markupTools.point)?t=l.SymbolType.POINT:-1!==$.inArray(e.name,this.markupTools.polyline)?t=l.SymbolType.POLYLINE:-1!==$.inArray(e.name,this.markupTools.polygon)?t=l.SymbolType.POLYGON:-1!==$.inArray(e.name,this.markupTools.text)&&(t=l.SymbolType.TEXT);t?(this.markupType.set(t),this._setCurrentSymbol(),this.app.command("_updateMarkupStyleSelectorView").execute(this.currentSymbol.get())):this.app.command("HideMarkupStyleView").execute()}},k.prototype.canExecuteAutoEditClickableFeature=function(e){return!0},k.prototype.executeEditClickableFeature=function(e){this._originalGraphic&&this.app.command("StopEditingClickableFeature").execute(),this.app.command("ClearEmphasis").execute(e);var t=e.esriFeature.get();t&&this._moveToFront(t),this._editMarkupGraphic(e.esriFeature.get())},k.prototype.executeStopAndAutoEditClickableFeature=function(e){if(this.app.command("StopEditingClickableFeature").execute(),e&&e.esriFeature){var t=c.getClickableLayerInfo(this.app,e.esriFeature.get()),i=c.getCapabilitiesForGraphic(this.app,e.esriFeature.get(),t),o=this._hasCapability("edit",i),a=t&&t.autoEditable;o&&a&&(this.app.highlightManager.suppressHighlight(e.esriFeature.get()),this.executeEditClickableFeature(e))}},k.prototype.canExecuteStopEditingClickableFeature=function(){return!!this.editToolbar},k.prototype.executeStopEditingClickableFeature=function(){this.app.highlightManager.enableHighlight(this._modifiedGraphic);var e=this._modifiedGraphic?this._modifiedGraphic.getLayer():null;e&&e instanceof esri.layers.GraphicsLayer&&this._restoreDrawingOrder(e),this.app.command("StopEditingMarkup").execute(!0)},k.prototype._getSymbolForGeometryType=function(e){switch(e){case l.SymbolType.POINT:case l.SymbolType.MULTIPOINT:return this._markerSymbol;case l.SymbolType.POLYLINE:return this._lineSymbol;case l.SymbolType.POLYGON:return this._polyFillSymbol;case l.SymbolType.TEXT:var t=this._getStyleSelector(),i=this._getTemplateSelector();if(t&&t.isActive||i&&i.isActive)return this._textSymbol;var o=esri.symbol.fromJson(this._textSymbol.toJson());return o.setText(""),o;default:return null}},k.prototype._setCurrentSymbol=function(){var e=this._getSymbolForGeometryType(this.markupType.get());e&&this.currentSymbol.get()!==e&&this.currentSymbol.set(this._copySymbol(e))},k.prototype._moveToFront=function(e){var t=e?e.getShape():null;t&&"function"==typeof t.moveToFront&&t.moveToFront()},k.prototype._restoreDrawingOrder=function(e){var t=this;e.graphics.forEach(function(e){return t._moveToFront(e)})},k.prototype.canExecuteDeleteClickableFeature=function(e){if(e){var t=c.getCapabilitiesForGraphic(this.app,e.esriFeature.get());return this._hasCapability("delete",t)}return!1},k.prototype.executeDeleteClickableFeature=function(e){this.app.event("_deleteClickableFeatureStarted").publish(e),this.app.command("StopEditingClickableFeature").execute(!1);var t=e.esriFeature.get().getLayer(),i=t.remove(e.esriFeature.get());this.app.command("RemoveFeatureFromStarredSelection").execute(e),this.app.featureSetManager.updateCollectionsOnFeatureDeletion(i),e.selected.set(!1),this.app.highlightManager.clearSelected([e]),this._raiseGraphicRemovedEvent(i,t)},k.prototype._raiseGraphicEditingDoneEvent=function(e){esri.geometry.fromJson(e.geometry.toJson());var t={old:this._originalGraphic,new:e};this.app.event("GraphicEditingDoneEvent").publish(t)},k.prototype._raiseGraphicRemovedEvent=function(e,t){var i={graphic:e,graphicLayer:t};this.app.event("GraphicRemovedEvent").publish(i)},k.prototype._onGraphicDeleted=function(e){var t=e.graphic,i=e.graphicLayer;i&&i.id===d.MARKUP_LAYER_ID&&(this.app.event("MarkupDeletedEvent").publish(t),this.app.command("ClearMarkup").raiseCanExecuteChanged(),this.app.command("EditMarkup").raiseCanExecuteChanged(),this.app.command("DeleteMarkup").raiseCanExecuteChanged(),this.app.command("ExportMarkupLayer").raiseCanExecuteChanged())},k.prototype._closeMapTipView=function(){var e=this.app.viewManager.getViewById("MapTipView");e&&e.isActive?(this.app.viewManager.deactivateView(e),this.app.event("MapTipClosedEvent").publish()):this.app.command("StopEditingMarkup").execute(!0)},k.prototype._deactivateToolbar=function(){this._editToolbarMoveStartedHandle&&(this._editToolbarMoveStartedHandle.remove(),this._editToolbarMoveStartedHandle=null),this._editToolbarMoveStoppedHandle&&(this._editToolbarMoveStoppedHandle.remove(),this._editToolbarMoveStoppedHandle=null),this._editToolbarRotateHandle&&(this._editToolbarRotateHandle.remove(),this._editToolbarRotateHandle=null),this._editToolbarScaleHandle&&(this._editToolbarScaleHandle.remove(),this._editToolbarScaleHandle=null),this._editToolbarInputMethodChangeHandle&&(this._editToolbarInputMethodChangeHandle.remove(),this._editToolbarInputMethodChangeHandle=null),this.editToolbar&&(this.editToolbar.deactivate(),this._editToolbarDeactivatedHandle&&(this._editToolbarDeactivatedHandle.remove(),this._editToolbarDeactivatedHandle=null),this.editToolbar=null)},k.prototype.clearMarkup=function(){var t=this;if(this.editToolbar&&this.app.command("StopEditingMarkup").execute(),this._markupExists()){var e=this.app.getResource(this.libraryId,"language-markup-clear-all-prompt"),i=this.app.getResource(this.libraryId,"language-markup-clear-all-prompt-title");this.app.command("Confirm").execute(e,i,function(e){e&&(t.clearCustomGraphics(d.MARKUP_LAYER_ID),t.clearCoordinatesLayer())})}},k.prototype.clearMarkupQuiet=function(){this.clearCustomGraphics(d.MARKUP_LAYER_ID),this.clearCoordinatesLayer()},k.prototype.clearCoordinatesLayer=function(){var e=this._getGraphicsLayer(!1,d.COORDINATES_LAYER_ID);if(e&&e.graphics&&e.graphics.length)for(;e.graphics.length;){var t=e.graphics[e.graphics.length-1];t.coordinateId&&this.app.command("DeleteCoordinates").execute(t.coordinateId),e.remove(t),this.app.event("MarkupDeletedEvent").publish(t)}},k.prototype.clearCustomGraphics=function(e){var t=this;if(this.editToolbar&&setTimeout(function(){t.app.command("StopEditingMarkup").execute()}),e||this.clearCoordinatesLayer(),this._markupExists()){for(var i=0,o=m.getAllMarkupLayers();i<o.length;i++){var a=o[i];if(!e||e===a.id)for(var r=a.graphics.length,l=0;l<r;l++)a.graphics[0].measurementId?this.app.event("MarkupDeletedEvent").publish(a.graphics[0]):(this.app.event("MarkupDeletedEvent").publish(a.graphics[0]),a.remove(a.graphics[0]))}this._deactivateActiveToolIfNoMarkupExists(),this.app.command("ClearMarkup").raiseCanExecuteChanged(),this.app.command("EditMarkup").raiseCanExecuteChanged(),this.app.command("DeleteMarkup").raiseCanExecuteChanged(),this.app.command("ExportMarkupLayer").raiseCanExecuteChanged(),this.app.event("MarkupClearedEvent").publish()}this.app.command("LogOptimizerEvent").execute("ClearMarkupTool","ClearAllMarkup")},k.prototype.deleteMarkup=function(e){var a=this,t=[d.MARKUP_LAYER_ID,d.MEASUREMENT_LAYER_ID,d.COORDINATES_LAYER_ID];c.deleteMarkup(e,t,this.app,function(e){if(e&&e.length){for(var t=0,i=e;t<i.length;t++){var o=i[t];o[p.coordinateIdentifierProperty]&&a.app.command("DeleteCoordinates").execute(o[p.coordinateIdentifierProperty]),a.app.event("MarkupDeletedEvent").publish(o)}a._deactivateActiveToolIfNoMarkupExists(),a.app.command("ClearMarkup").raiseCanExecuteChanged(),a.app.command("EditMarkup").raiseCanExecuteChanged(),a.app.command("DeleteMarkup").raiseCanExecuteChanged(),a.app.command("ExportMarkupLayer").raiseCanExecuteChanged()}a.app.command("ShowMap").execute()},!1,"language-markup-delete-multiple-prompt","language-markup-delete-multiple-prompt-title",this.libraryId)},k.prototype._deactivateActiveToolIfNoMarkupExists=function(){var e=this.app.toolRegistry.getActiveTool();!this._markupExists()&&e instanceof n.MapTool&&("EditMarkup"!==e.command&&"DeleteMarkup"!==e.command||this.app.command("ClearActiveTool").execute())},k.prototype._addMarkup=function(e){if(!e)throw new Error("geometry is null");"extent"===e.type&&(e=S.envelopeToPolygon(e));var t=this._copySymbol(this._getSymbolForGeometryType(e.type));if(t){var i=new esri.Graphic;i.setGeometry(e),i.setSymbol(t),this._addGraphic(i,d.MARKUP_LAYER_ID),this.app.event("MarkupAddedEvent").publish(i)}this.app.command("ClearMarkup").raiseCanExecuteChanged(),this.app.command("EditMarkup").raiseCanExecuteChanged(),this.app.command("DeleteMarkup").raiseCanExecuteChanged(),this.app.command("ExportMarkupLayer").raiseCanExecuteChanged()},k.prototype._addTextMarkup=function(t){var i=this;if(t){var e=this._getStyleSelector(),o=this._getTemplateSelector();if(this.currentSymbol.get().text&&(e&&e.isActive||o&&o.isActive))this._addTextMarkupImpl(this.currentSymbol.get().text,t);else{var a=this.app.getResource(this.libraryId,"language-markup-add-text-title"),r=this.app.getResource(this.libraryId,"language-markup-add-text");this.app.command("Prompt").execute(a,r,"",function(e){e&&i._addTextMarkupImpl(e,t),i.app.command("ShowMap").execute()})}}},k.prototype._editMarkup=function(e){var t=this._getGraphicsLayer(!1,d.COORDINATES_LAYER_ID),i=null;if(t&&(i=c.getMarkupFromGeometry(e,t,this.app,this._coordinatesSmsSymbolBuffer,this._coordinatesPointBuffer)),i&&i[i.length-1]){var o=i[i.length-1];if(o.hasOwnProperty(p.coordinateIdentifierProperty))return this.app.command("StopEditingMarkup").execute(!0),void this.app.command("EditCoordinate").execute(o[p.coordinateIdentifierProperty])}this.editToolbar&&this.app.command("StopEditingMarkup").execute(!1);var a=this._getGraphicsLayer(!1,d.MARKUP_LAYER_ID),r=null;a&&(r=c.getMarkupFromGeometry(e,a,this.app)),r&&r[r.length-1]&&this._editMarkupGraphic(r[r.length-1])},k.prototype._editMarkupGraphic=function(e){var o=this;this.editToolbar&&this.app.command("StopEditingMarkup").execute(!1),this._originalGraphic=new esri.Graphic(e.toJson()),this._modifiedGraphic=e,this.markupType.set(e.symbol instanceof esri.symbol.TextSymbol?l.SymbolType.TEXT:e.geometry.type),this.currentSymbol.set(this._copySymbol(e.symbol)),this.currentEditedSymbol=this.currentSymbol.get(),this.app.event("MarkupEditingStartedEvent").publish(e),this.app.command("ExportMarkupLayer").raiseCanExecuteChanged(),e.hasOwnProperty("measurementId")&&this.app.event("MeasurementEditingStartedEvent").publish({graphic:e}),this.editToolbar=this.app.accessibilityManager.createComponent("geocortex.accessibility.edit",this.app.map),this._editToolbarMoveStartedHandle=dojo.aspect.after(this.editToolbar,"onGraphicFirstMove",function(e){o.app.map.disableMapNavigation()},!0),this._editToolbarMoveStoppedHandle=dojo.aspect.after(this.editToolbar,"onGraphicMoveStop",function(e){o.app.map.enableMapNavigation()},!0),this.markupType.get()===l.SymbolType.TEXT&&(this._editToolbarRotateHandle=dojo.aspect.after(this.editToolbar,"onRotateStop",function(e){o.currentEditedSymbol=o._copySymbol(e.symbol),o.currentEditedSymbol&&o.app.command("_updateMarkupStyleSelectorView").execute(o.currentEditedSymbol)},!0),this._editToolbarScaleHandle=dojo.aspect.after(this.editToolbar,"onScaleStop",function(e){o.currentEditedSymbol=o._copySymbol(e.symbol),o.currentEditedSymbol&&o.app.command("_updateMarkupStyleSelectorView").execute(o.currentEditedSymbol)},!0)),this._editToolbarDeactivatedHandle=dojo.aspect.after(this.editToolbar,"onDeactivate",function(e,t,i){o._raiseGraphicEditingDoneEvent(t)},!0),this.editToolbar instanceof u.Edit&&(this._editToolbarInputMethodChangeHandle=dojo.aspect.after(this.editToolbar,"onInputMethodChange",function(e){var t=o.app.toolRegistry.getActiveTool();if(t instanceof n.MapTool&&"EditMarkup"===t.command){var i={tool:t,previousMethod:e?e.previousMethod:null,newMethod:e?e.newMethod:null};o.app.event("ToolInputMethodChangedEvent").publish(i)}},!0)),this.editToolbar.activate(this.editToolbarTool,e);var t,i,a=this.app.toolRegistry.getActiveTool();if(a){if(a instanceof n.MapTool&&"EditMarkup"===a.command)var r=this.app.event("ActiveToolChangedEvent").subscribe(this,function(e){var t=e.previousTool;if(t instanceof n.MapTool&&"EditMarkup"===t.command&&t.isSticky)o.app.command("StopEditingMarkup").execute(!1),o.app.event("ActiveToolChangedEvent").unsubscribe(r);else var i=o.app.map.on("click",function(e){o.app.command("StopEditingMarkup").execute(!1),o.app.event("ActiveToolChangedEvent").unsubscribe(r),i.remove()});e.tool&&o.editToolbar&&(o.app.command("StopEditingMarkup").execute(!1),o.app.event("ActiveToolChangedEvent").unsubscribe(r))})}else t=this.app.event("ActiveToolChangingEvent").subscribe(this,function(e){o._closeMapTipView(),t&&o.app.event("ActiveToolChangingEvent").unsubscribe(t),i&&i.remove()}),i=this.app.map.on("click",function(e){o._closeMapTipView(),t&&o.app.event("ActiveToolChangingEvent").unsubscribe(t),i&&i.remove()});this.app.command("_updateMarkupStyleSelectorView").execute(this.currentSymbol.get())},k.prototype.executeChangeMarkupStyleCommand=function(e){if(e){var t;if(e instanceof esri.symbol.Symbol)t=e;else if(!(t=esri.symbol.fromJson(JSON.parse(e))))return;switch(this.markupType.get()){case l.SymbolType.POINT:case l.SymbolType.MULTIPOINT:t instanceof esri.symbol.PictureMarkerSymbol?this._markerSymbol=t:t instanceof esri.symbol.SimpleMarkerSymbol&&(this._markerSymbol=t);break;case l.SymbolType.POLYLINE:t instanceof esri.symbol.SimpleLineSymbol&&(this._lineSymbol=t);break;case l.SymbolType.POLYGON:t instanceof esri.symbol.SimpleFillSymbol&&(this._polyFillSymbol=t);break;case l.SymbolType.TEXT:t instanceof esri.symbol.TextSymbol&&(this._textSymbol=t)}this.currentEditedSymbol=null,this._setCurrentSymbol(),this.editToolbar&&this._applySymbolToEditedMarkup(t)}},k.prototype._applySymbolToEditedMarkup=function(e){if(this.editToolbar&&e){if(e instanceof esri.symbol.Symbol)e=this._copySymbol(e);else if(!(e=esri.symbol.fromJson(JSON.parse(e))))return;var t=this.editToolbar.getCurrentState().graphic;(t.symbol.type===e.type||-1<t.symbol.type.indexOf("markersymbol")&&-1<e.type.indexOf("markersymbol"))&&(t.setSymbol(e),this.currentEditedSymbol=e,this.app.event("GraphicSymbolChangedEvent").publish(t),this.editToolbar.refresh())}},k.prototype._addTextMarkupImpl=function(e,t){if(t.getExtent){var i=t.getExtent();i&&(t=i.getCenter())}var o=this._copySymbol(this._textSymbol);o.setText(e);var a=new esri.Graphic;a.geometry=t,a.symbol=o,this._addGraphic(a,d.MARKUP_LAYER_ID),this.app.event("MarkupAddedEvent").publish(a),this.app.command("ClearMarkup").raiseCanExecuteChanged(),this.app.command("EditMarkup").raiseCanExecuteChanged(),this.app.command("DeleteMarkup").raiseCanExecuteChanged()},k.prototype._addGraphic=function(e,t){if(e){var i=this._getGraphicsLayer(!0,t);i.add(e),i.visible||i.setVisibility(!0)}},k.prototype._getGraphicsLayer=function(e,t){var i=this.app.map.getLayer(t);return!i&&e&&(i=m.getInternalGraphicsLayer(d.MARKUP_LAYER_ID,this.app,m.GraphicsLayerType.Markup,!0),this.app.markupLayer.set(i)),i},k.prototype._copySymbol=function(e){return esri.symbol.fromJson(e.toJson())},k.prototype._markupExists=function(e){var t=!1;if(this.app.map){for(var i=0,o=m.getAllMarkupLayers();i<o.length;i++){var a=o[i];if((!e||a.id===e)&&a&&a.graphics&&0<a.graphics.length){t=!0;break}}t||(a=this._getGraphicsLayer(!1,d.COORDINATES_LAYER_ID))&&a.graphics&&0<a.graphics.length&&(t=!0)}return t},k.prototype._hasExportableMarkup=function(){var e=!1;if(this.app.map)for(var t=0,i=m.getAllMarkupLayers();t<i.length;t++){var o=i[t];if(o&&o.graphics&&0<o.graphics.length){if(this._originalGraphic)return!1;for(var a=0,r=o.graphics;a<r.length;a++){var l=r[a];if(null!=l.geometry){if("point"!==l.geometry.type){e=!0;break}if(null!=l.symbol&&"textsymbol"!==l.symbol.type){e=!0;break}}}}if(e)break}return e},k.prototype._hasCapability=function(t,e){return e&&e.some(function(e){return e===t})},k.prototype._getStyleSelector=function(){return this._styleSelector||(this._styleSelector=this.app.viewManager.getViewById("MarkupSymbolSelectorView")),this._styleSelector},k.prototype._getTemplateSelector=function(){return this._templateSelector||(this._templateSelector=this.app.viewManager.getViewById("MarkupTemplateSelectorView")),this._templateSelector},k);function k(){var e=null!==h&&h.apply(this,arguments)||this;return e.markupTools={point:[],polyline:[],polygon:[],text:[]},e.editToolbar=null,e.editToolbarTool=esri.toolbars.Edit.MOVE|esri.toolbars.Edit.EDIT_VERTICES|esri.toolbars.Edit.SCALE|esri.toolbars.Edit.ROTATE,e.markupType=new o.Observable(l.SymbolType.POINT),e.currentSymbol=new o.Observable(a.defaultMarkerSymbol()),e._originalGraphic=null,e._modifiedGraphic=null,e._clearStyleViewTimeout=null,e._editToolbarMoveStartedHandle=null,e._editToolbarMoveStoppedHandle=null,e._editToolbarDeactivatedHandle=null,e._editToolbarRotateHandle=null,e._editToolbarScaleHandle=null,e._editToolbarInputMethodChangeHandle=null,e._isIE9or11=!1,e._markerSymbol=a.defaultMarkerSymbol(),e._lineSymbol=a.defaultLineSymbol(),e._polyFillSymbol=a.defaultFillSymbol(),e._polyBorderSymbol=a.defaultLineSymbol(),e._textSymbol=null,e._fontSymbol=null,e._coordinatesPointBuffer=35,e._coordinatesSmsSymbolBuffer=15,e}t.MarkupViewModel=g})},"Mapping/modules/Markup/MarkupStyles/MarkupStyleView":function(){var o,c=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/infrastructure/ui/components/SmartPanel/SmartPanelView","geocortex/infrastructure/SymbolUtils","./MarkupTemplateSelector/MarkupTemplateSelectorViewModel","geocortex/infrastructure/symbology/widgets/PictureSymbolWidgetViewModel","./MarkupSymbolSelector/MarkupSymbolSelectorViewModel","geocortex/infrastructure/symbology/SymbolType"],function(e,t,i,o,l,n,s,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,p=(a=i.SmartPanelView,c(u,a),u.prototype.attach=function(e){var i=this;a.prototype.attach.call(this,e),this._initialized||(this._initializeStyleSelectors(),this.app.event("MarkupTypeChangedEvent").subscribe(this,function(e){if(i._currentWidget&&"MarkupSymbolSelectorView"===i._currentWidget.id&&(i._lastCustomSymbol[i.viewModel.markupType.get()]=i._lastUpdateSymbol,i._styleSelector.updateSymbol(i._lastCustomSymbol[e]||i._getDefaultSymbol(e),!1)),i._currentWidget&&"MarkupTemplateSelectorView"===i._currentWidget.id&&i._templateSelector.loadCurrentLibrary(),e!==r.SymbolType.POINT&&i._currentWidget&&"MarkupImageSelectorView"===i._currentWidget.id){i.viewModel.templateSelectorItem||i.viewModel.symbolSelectorItem||!i.isActive||i.app.viewManager.deactivateView(i);var t=i.viewModel.templateSelectorItem||i.viewModel.symbolSelectorItem;t&&i.viewModel.currentSelector.set(t),i.isActive&&i._changeMarkupSelector()}i.viewModel.markupType.set(e)}),this.app.event("MarkupSymbolChangedEvent").subscribe(this,function(e){i.viewModel.markupSymbol=e}))},u.prototype.activated=function(){this._lastUpdateSymbol&&!this.isActive&&this._executeUpdateMarkupStyleSelectorView(this._lastUpdateSymbol,!0)},u.prototype.deactivated=function(){this._lastCustomSymbol[this.viewModel.markupType.get()]=this._lastUpdateSymbol,this.app.event("_markupToggleDeactivated").publish(),this._styleSelector&&(this._styleSelector.isActive=!1),this._templateSelector&&(this._templateSelector.isActive=!1)},u.prototype._executeShowMarkupStyleSelectorView=function(e){this._initialized||this._initializeStyleSelectors(),this._originalSymbol=esri.symbol.fromJson(e.toJson()),this._lastUpdateSymbol=e,this._initialUpdatePerformed?this._templateSelector&&this.viewModel.currentSelector.get().id===this._templateSelector.id?this._templateSelector.updateSymbol(e):this._imageSelector&&this.viewModel.currentSelector.get().id===this._imageSelector.id?this._imageSelector.updateSymbol(e):this._styleSelector&&this.viewModel.currentSelector.get().id===this._styleSelector.id&&this._styleSelector.updateSymbol(e):(this._executeUpdateMarkupStyleSelectorView(e,!0),this._initialUpdatePerformed=!0),this.app.command("ActivateView").execute(this.viewModel.currentSelector.get().id)},u.prototype._executeUpdateMarkupStyleSelectorView=function(i,e){var o=this;if(void 0===e&&(e=!1),i&&(this._lastUpdateSymbol=i,this.isActive||e)){var a,t=function(e){o._imageSelector&&i instanceof esri.symbol.PictureMarkerSymbol?(a=o._imageSelector,o._imageSelector.updateSymbol(i)):!o._templateSelector||o._styleSelector&&!e?o._styleSelector?(a=o._styleSelector,o._styleSelector.updateSymbol(i)):o._imageSelector&&o.viewModel.markupType.get()===r.SymbolType.POINT&&(a=o._imageSelector,o._imageSelector.updateSymbol(i)):(a=o._templateSelector,o._templateSelector.updateSymbol(i));var t=o.viewModel.markupSelectors.getItems().filter(function(e){return e.id===a.id})[0];!t||o.viewModel.currentSelector.get()&&t.id===o.viewModel.currentSelector.get().id||(o.viewModel.currentSelector.set(t),o.app.command("ActivateView").execute(o.viewModel.currentSelector.get().id)),t&&t.id===o.viewModel.currentSelector.get().id||o.viewModel.currentSelector.get()&&o.app.command("DeactivateView").execute(o.viewModel.currentSelector.get().id),t||o.app.command("HideMarkupStyleView").execute()};this._templateSelector?this._templateSelector.updateSymbol(i,!1).then(function(e){t(e)}):t(!1)}},u.prototype._executeHideMarkupStyleSelectorView=function(){this.isActive&&(this._currentWidget=null,this.app.command("DeactivateView").execute(this.id))},u.prototype._initializeStyleSelectors=function(){var t=this;if(this.viewModel.enableSymbolSelector){this._styleSelector=this.app.viewManager.createView({viewId:"MarkupSymbolSelectorView",markupResource:"Mapping/modules/Markup/MarkupStyles/MarkupSymbolSelector/MarkupSymbolSelectorView.html",typeName:"geocortex.essentialsHtmlViewer.mapping.modules.markup.MarkupSymbolSelectorView",regionName:"MarkupStyleSelectorRegion",isVisible:!1,libraryId:"Mapping"}),this._styleSelector.onChange=function(e){t._lastUpdateSymbol=esri.symbol.fromJson(JSON.parse(e))};var e=new s.MarkupSymbolSelectorViewModel(this.app,"Mapping"),i=this.app.configModel.moduleConfigs.filter(function(e){return"Markup"===e.moduleName})[0].viewModelConfigs.filter(function(e){return"MarkupSymbolSelectorViewModel"===e.viewModelId})[0];e.initialize(i),this._styleSelector.attach(e),this._availableWidgets.push(this._styleSelector)}if(this.viewModel.enableImageSelector){this._imageSelector=this.app.viewManager.createView({viewId:"MarkupImageSelectorView",markupResource:"Mapping/infrastructure/symbology/widgets/PictureSymbolWidget.html",typeName:"geocortex.essentialsHtmlViewer.mapping.infrastructure.symbology.PictureSymbolWidget",regionName:"MarkupStyleSelectorRegion",isVisible:!1,libraryId:"Mapping.Infrastructure"}),this._imageSelector.onChange=function(e){t.viewModel.markupSymbol&&JSON.stringify(t.viewModel.markupSymbol.toJson())===e||t.app.command("ChangeMarkupStyle").execute(e)},this._imageSelector.isMarkupView=!0;var o=new n.PictureSymbolWidgetViewModel(this.app,"Mapping.Infrastructure"),a=this.app.configModel.widgetConfigs.filter(function(e){return"PictureSymbolWidget"===e.id})[0];o.initialize(a.configuration),this._imageSelector.attach(o),this._availableWidgets.push(this._imageSelector)}if(this.viewModel.enableTemplateSelector){this._templateSelector=this.app.viewManager.createView({viewId:"MarkupTemplateSelectorView",markupResource:"Mapping/modules/Markup/MarkupStyles/MarkupTemplateSelector/MarkupTemplateSelectorView.html",typeName:"geocortex.essentialsHtmlViewer.mapping.modules.markup.MarkupTemplateSelectorView",regionName:"MarkupStyleSelectorRegion",isVisible:!1,libraryId:"Mapping"});var r=new l.MarkupTemplateSelectorViewModel(this.app,"Mapping");this._templateSelector.onChange=function(e){t._lastUpdateSymbol=esri.symbol.fromJson(JSON.parse(e))},i=this.app.configModel.moduleConfigs.filter(function(e){return"Markup"===e.moduleName})[0].viewModelConfigs.filter(function(e){return"MarkupTemplateSelectorViewModel"===e.viewModelId})[0],r.initialize(i.configuration),this._templateSelector.attach(r),this._availableWidgets.push(this._templateSelector)}this._currentWidget=this._getCurrentWidget(),this._initialized=!0},u.prototype.handleSelectorChange=function(){this._changeMarkupSelector()},u.prototype.handleDoneButtonClick=function(){this.app.command("DeactivateView").execute(this.id)},u.prototype.handleRevertButtonClick=function(){this._styleSelector&&(this._lastUpdateSymbol=this._originalSymbol,this._styleSelector.updateSymbol(this._originalSymbol),this._editingMarkup?this.app.command("_applySymbolToEditedMarkup").execute(this._originalSymbol):this.app.command("ChangeMarkupStyle").execute(this._originalSymbol))},u.prototype.handleCustomizeButtonClick=function(){this.viewModel.symbolSelectorItem&&(this._lastCustomSymbol[this.viewModel.markupType.get()]=this._lastUpdateSymbol,this.viewModel.currentSelector.set(this.viewModel.symbolSelectorItem),this._changeMarkupSelector(this._lastUpdateSymbol))},u.prototype._changeMarkupSelector=function(e){var t=this,i=e;(i=i||(this._currentWidget&&this._currentWidget.getSymbol()?esri.symbol.fromJson(JSON.parse(this._currentWidget.getSymbol())):this.viewModel.markupSymbol))&&this._currentWidget&&"MarkupSymbolSelectorView"===this._currentWidget.id&&this._setLastCustomSymbol(i);var o=this.viewModel.currentSelector.get();this._currentWidget=this._getCurrentWidget(),"MarkupSymbolSelectorView"===o.id&&e&&this._styleSelector.updateSymbol(e),"MarkupTemplateSelectorView"===o.id&&(i instanceof esri.symbol.TextSymbol&&i.text&&this._templateSelector.viewModel.symbolText.set(i.text),this._templateSelector.viewModel.executeChangeMarkupFromId(this._templateSelector.viewModel.styleIndex),this._lastUpdateSymbol=esri.symbol.fromJson(JSON.parse(this._templateSelector.getSymbol()))),this.app.command("ActivateView").execute(o.id),this._availableWidgets.forEach(function(e){e.id!==o.id&&t.app.command("DeactivateView").execute(e.id)}),this._originalSymbol=this.viewModel.markupSymbol;var a=this._currentWidget.getSymbol();if(e||a){var r=e||esri.symbol.fromJson(JSON.parse(a));r instanceof esri.symbol.TextSymbol&&i instanceof esri.symbol.TextSymbol&&this._editingMarkup&&(r.setText(i.text),this._currentWidget.updateSymbol(r)),this._editingMarkup?this.app.command("_applySymbolToEditedMarkup").execute(e?JSON.stringify(e.toJson()):JSON.stringify(r.toJson())):this.app.command("ChangeMarkupStyle").execute(e?JSON.stringify(e.toJson()):JSON.stringify(r.toJson()))}},u.prototype._getCurrentWidget=function(){var t=this;return this._availableWidgets.filter(function(e){return e.id===t.viewModel.currentSelector.get().id})[0]},u.prototype._getDefaultSymbol=function(e){switch(e){case r.SymbolType.POINT:case r.SymbolType.MULTIPOINT:return o.defaultPointMarkup;case r.SymbolType.POLYLINE:return o.defaultPolylineMarkup;case r.SymbolType.POLYGON:return o.defaultPolygonMarkup;case r.SymbolType.TEXT:return o.defaultTextMarkup}},u.prototype._setLastCustomSymbol=function(e){e instanceof esri.symbol.PictureMarkerSymbol||e instanceof esri.symbol.SimpleMarkerSymbol?this._lastCustomSymbol[r.SymbolType.POINT]=e:e instanceof esri.symbol.SimpleLineSymbol?this._lastCustomSymbol[r.SymbolType.POLYLINE]=e:e instanceof esri.symbol.SimpleFillSymbol?this._lastCustomSymbol[r.SymbolType.POLYGON]=e:e instanceof esri.symbol.TextSymbol&&(this._lastCustomSymbol[r.SymbolType.TEXT]=e)},u);function u(e,t){var i=a.call(this,e,t)||this;return i._availableWidgets=[],i._initialized=!1,i._lastCustomSymbol={},i._editingMarkup=!1,i._initialUpdatePerformed=!1,i.app.command("_showMarkupStyleSelectorView").register(i,i._executeShowMarkupStyleSelectorView),i.app.command("_updateMarkupStyleSelectorView").register(i,i._executeUpdateMarkupStyleSelectorView),i.app.command("HideMarkupStyleView").register(i,i._executeHideMarkupStyleSelectorView),i.app.event("MarkupEditingStartedEvent").subscribe(i,function(){i._editingMarkup=!0,i._styleSelector&&(i._styleSelector.editingMarkup=!0,i._styleSelector.viewModel&&i._styleSelector.viewModel.textSymbolWidget&&(i._styleSelector.viewModel.textSymbolWidget.editingMarkup=!0)),i._templateSelector&&(i._templateSelector.editingMarkup=!0)}),i.app.event("MarkupEditingStoppedEvent").subscribe(i,function(){i._editingMarkup=!1,i._styleSelector&&(i._styleSelector.editingMarkup=!1,i._styleSelector.viewModel&&i._styleSelector.viewModel.textSymbolWidget&&(i._styleSelector.viewModel.textSymbolWidget.editingMarkup=!1)),i._templateSelector&&(i._templateSelector.editingMarkup=!1)}),i}t.MarkupStyleView=p})},"Mapping/modules/Markup/MarkupStyles/MarkupStyleViewModel":function(){var o,s=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/infrastructure/ui/components/SmartPanel/SmartPanelViewModel","geocortex/framework/observables","geocortex/infrastructure/symbology/SymbolType"],function(e,t,i,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,l=(r=i.SmartPanelViewModel,s(n,r),n.prototype.initialize=function(e){var t=this;r.prototype.initialize.call(this,e),this.config=e,this.app.command("CreateMarkupStyleView").register(this,function(){},function(){return t.markupType.get()===a.SymbolType.POINT?t.enableSymbolSelector||t.enableTemplateSelector||t.enableImageSelector:t.enableSymbolSelector||t.enableTemplateSelector}),e.enableTemplateSelector&&(this.enableTemplateSelector=e.enableTemplateSelector,this.templateSelectorItem={displayName:this.app.getResource(this.libraryId,"language-markup-selector-template-displayname"),id:"MarkupTemplateSelectorView"},this.markupSelectors.addItem(this.templateSelectorItem)),e.enableImageSelector&&(this.enableImageSelector=e.enableImageSelector,this.imageSelectorItem={displayName:this.app.getResource(this.libraryId,"language-markup-selector-image-displayname"),id:"MarkupImageSelectorView"},this.markupSelectors.addItem(this.imageSelectorItem),this.markupType.bind(this,function(e){e!==a.SymbolType.POINT?t.markupSelectors.removeItem(t.imageSelectorItem):t.markupSelectors.contains(t.imageSelectorItem)||t.markupSelectors.insertItem(1,t.imageSelectorItem),t._setMenuVisibility()})),e.enableSymbolSelector&&(this.enableSymbolSelector=e.enableSymbolSelector,this.symbolSelectorItem={displayName:this.app.getResource(this.libraryId,"language-markup-selector-symbol-displayname"),id:"MarkupSymbolSelectorView"},this.markupSelectors.addItem(this.symbolSelectorItem)),this.currentSelector.bind(this,function(e){t.showRevertButton.set(t.symbolSelectorItem&&e.displayName===t.symbolSelectorItem.displayName),t.showCustomizeButton.set(t.templateSelectorItem&&t.symbolSelectorItem&&e.displayName===t.templateSelectorItem.displayName)}),this.currentSelector.set(this.markupSelectors.getAt(0)),this._setMenuVisibility()},n.prototype._setMenuVisibility=function(){this.markupSelectors.getLength()<=1?this.showMarkupSelectorMenu.set(!1):this.showMarkupSelectorMenu.set(!0)},n);function n(){var e=null!==r&&r.apply(this,arguments)||this;return e.enableImageSelector=!1,e.enableTemplateSelector=!1,e.enableSymbolSelector=!1,e.markupSelectors=new o.ObservableCollection([]),e.currentSelector=new o.Observable(null),e.showMarkupSelectorMenu=new o.Observable(!0),e.markupType=new o.Observable(a.SymbolType.POINT),e.showRevertButton=new o.Observable(!0),e.showCustomizeButton=new o.Observable(!0),e}t.MarkupStyleViewModel=l})},"Mapping/modules/Markup/ToolPalettes/TransientMarkupPaletteView":function(){var o,l=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewBase"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,a=(o=i.ViewBase,l(r,o),r.prototype.handleClickDone=function(e,t,i){this.viewModel.editToggled.set(!1),this.viewModel.deleteToggled.set(!1),this.app.command("StopEditingMarkup").execute(),this.app.command("ClearActiveTool").execute()},r.prototype.handleClickEdit=function(e,t,i){var o=this;if(this.viewModel.deleteToggled.get()&&this.viewModel.deleteToggled.set(!1),this.viewModel.editToggled.get())this.app.command("ClearActiveTool").execute();else{this.app.command("SetActiveTool").execute("EditMarkupTool"),this.viewModel.editToggled.set(!0);var a=this.app.event("ActiveToolChangedEvent").subscribe(this,function(){o.viewModel.editToggled.set(!1),o.app.event("ActiveToolChangedEvent").unsubscribe(a)})}},r.prototype.handleClickDelete=function(e,t,i){var o=this;if(!this.viewModel.clearDisabled.get())if(this.viewModel.editToggled.get()&&this.viewModel.editToggled.set(!1),this.viewModel.deleteToggled.get())this.app.command("ClearActiveTool").execute();else{this.app.command("SetActiveTool").execute("DeleteMarkupTool"),this.viewModel.deleteToggled.set(!0);var a=this.app.event("ActiveToolChangedEvent").subscribe(this,function(){o.viewModel.deleteToggled.set(!1),o.app.event("ActiveToolChangedEvent").unsubscribe(a)})}},r.prototype.handleClickChangeStyle=function(){this.app.command("CreateMarkupStyleView").execute()},r.prototype.handleClickClear=function(e,t,i){this.app.command("StopEditingMarkup").execute(),this.app.command("ClearMarkup").execute()},r);function r(){return null!==o&&o.apply(this,arguments)||this}t.TransientMarkupPaletteView=a})},"Mapping/modules/Markup/ToolPalettes/TransientMarkupPaletteViewModel":function(){var o,n=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewModelBase","geocortex/framework/observables"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=(a=i.ViewModelBase,n(l,a),l.prototype.initialize=function(e){a.prototype.initialize.call(this,e),this.markupCounter.bind(this,this.evaluateMarkupCounter),this.registerEventsClearDisabled(),this.registerEventsChangeStyleDisabled()},l.prototype.registerEventsChangeStyleDisabled=function(){var o=this;this.app.event("ActiveToolChangedEvent").subscribe(this,function(e){var t=null,i=null;e.tool&&(t=e.tool.name),e.previousTool&&(i=e.previousTool.name),o.isMarkupTool(i)&&o.changeStyleDisabled.set(!0),o.isMarkupTool(t)&&o.changeStyleDisabled.set(!1)}),this.app.event("MarkupEditingStartedEvent").subscribe(this,function(){o.changeStyleDisabled.set(!1)}),this.app.event("MarkupEditingStoppedEvent").subscribe(this,function(){o.changeStyleDisabled.set(!0)})},l.prototype.registerEventsClearDisabled=function(){var t=this;this.app.event("MarkupAddedEvent").subscribe(this,function(){t.markupCounter.set(t.markupCounter.get()+1)}),this.app.event("MeasurementMarkupAdded").subscribe(this,function(){t.markupCounter.set(t.markupCounter.get()+1)}),this.app.event("MarkupDeletedEvent").subscribe(this,function(e){e.measurementId||t.markupCounter.set(t.markupCounter.get()-1)}),this.app.event("MeasurementMarkupDeleted").subscribe(this,function(e){e.graphic&&e.graphic.measurementId&&t.markupCounter.set(t.markupCounter.get()-1)}),this.app.event("MarkupClearedEvent").subscribe(this,function(){t.markupCounter.set(0)})},l.prototype.evaluateMarkupCounter=function(){if(0<this.markupCounter.get())this.clearDisabled.set(!1);else{var e=this.app.toolRegistry.getActiveTool();e&&"DeleteMarkupTool"===e.name&&this.app.command("ClearActiveTool").execute(),this.clearDisabled.set(!0)}},l.prototype.isMarkupTool=function(e){var t=this.app.getFrameworkObjectById("MarkupViewModel").markupTools;return-1!=$.inArray(e,t.point)||-1!=$.inArray(e,t.polyline)||-1!=$.inArray(e,t.polygon)||-1!=$.inArray(e,t.text)},l);function l(){var e=null!==a&&a.apply(this,arguments)||this;return e.clearDisabled=new o.Observable(!0),e.changeStyleDisabled=new o.Observable(!0),e.markupCounter=new o.Observable(0),e.deleteToggled=new o.Observable(!1),e.editToggled=new o.Observable(!1),e.previousTool=null,e}t.TransientMarkupPaletteViewModel=r})},"Mapping/modules/Markup/MarkupStyles/MarkupSymbolSelector/MarkupSymbolSelectorView":function(){var o,u=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewBase","geocortex/infrastructure/symbology/SymbolType","geocortex/infrastructure/symbology/widgets/SimpleSymbolWidgetViewModel","geocortex/infrastructure/symbology/widgets/TextSymbolWidgetViewModel","geocortex/infrastructure/SymbolUtils"],function(e,t,i,o,a,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,s=(n=i.ViewBase,u(p,n),p.prototype.attach=function(e){var t=this;n.prototype.attach.call(this,e),this.viewModel=e,this.initialized||(this._initializeStyleConfigurationViews(),this.app.event("MarkupTypeChangedEvent").subscribe(this,function(e){t.markupType=e,t._updateStyleConfigurationViews(e)}),this.app.event("MarkupSymbolChangedEvent").subscribe(this,function(e){t.markupSymbol=e}))},p.prototype.activated=function(){this.viewModel.textSymbolWidget&&this.markupType===o.SymbolType.TEXT?this.app.viewManager.activateView(this.viewModel.textSymbolWidget):this.app.viewManager.activateView(this.viewModel.symbolWidget)},p.prototype.updateSymbol=function(e,t){if(void 0===t&&(t=!0),"picturemarkersymbol"===e.type)return Promise.resolve(!1);var i=l.fromEsriSymbolType(e.type);return i?(i===o.SymbolType.TEXT?this.viewModel.textSymbolWidget.setFromSymbol(e,t):(this.viewModel.symbolWidget.setFromSymbol(e,t),this.customSymbolCreated[i]=!0),Promise.resolve(!0)):Promise.resolve(!1)},p.prototype.getSymbol=function(e){return void 0===e&&(e=!0),this.markupType===o.SymbolType.TEXT?(e&&(this.viewModel.textSymbolWidget.activated(),this.viewModel.textSymbolWidget.applySettings()),this.viewModel.textSymbolWidget.getSymbol(e)):(this.customSymbolCreated[this.markupType]||(this.viewModel.symbolWidget.setFromSymbol(l.defaultMarkupSymbol(this.markupType)),this.customSymbolCreated[this.markupType]=!0),e&&this.viewModel.symbolWidget.activated(),this.viewModel.symbolWidget.getSymbol())},p.prototype._initializeStyleConfigurationViews=function(){function e(e){t.onChange&&t.onChange(e),t.editingMarkup?t.app.command("_applySymbolToEditedMarkup").execute(e):t.markupSymbol&&JSON.stringify(t.markupSymbol.toJson())===e||t.app.command("ChangeMarkupStyle").execute(e)}var t=this;this.viewModel.symbolWidget=this.app.viewManager.createView({viewId:"MarkupSymbolWidget",markupResource:"Mapping/infrastructure/symbology/widgets/SimpleSymbolWidget.html",typeName:"geocortex.essentialsHtmlViewer.mapping.infrastructure.symbology.SimpleSymbolWidget",regionName:"MarkupStyleConfigurationRegion",isVisible:!1,libraryId:"Mapping.Infrastructure"}),this.viewModel.symbolWidget.onChange=e.bind(this);var i=new a.SimpleSymbolWidgetViewModel(this.app,"Mapping.Infrastructure");i.parentSymbologyView=this,i.initialize(this.viewModel.config.configuration.symbologyConfig),this.viewModel.symbolWidget.attach(i),this.viewModel.textSymbolWidget=this.app.viewManager.createView({viewId:"TextMarkupSymbolWidget",markupResource:"Mapping/infrastructure/symbology/widgets/TextSymbolWidget.html",typeName:"geocortex.essentialsHtmlViewer.mapping.infrastructure.symbology.TextSymbolWidget",regionName:"MarkupStyleConfigurationRegion",isVisible:!1,libraryId:"Mapping.Infrastructure"}),this.viewModel.textSymbolWidget.onChange=e.bind(this);var o=new r.TextSymbolWidgetViewModel(this.app,"Mapping.Infrastructure");o.parentSymbologyView=this,o.initialize(this.viewModel.config.configuration.textSymbologyConfig),this.viewModel.textSymbolWidget.attach(o),this.initialized=!0},p.prototype._updateStyleConfigurationViews=function(e){e===o.SymbolType.TEXT?this.app.command("ActivateView").execute("TextMarkupSymbolWidget"):(this.viewModel.symbolWidget.setFeatureType(e),this.app.command("ActivateView").execute("MarkupSymbolWidget"))},p);function p(e,t){var i=n.call(this,e,t)||this;return i.displayName=i.app.getResource(i.libraryId,"language-markup-selector-symbol-displayname"),i.markupType=o.SymbolType.POINT,i.initialized=!1,i.editingMarkup=!1,i.customSymbolCreated={},i}t.MarkupSymbolSelectorView=s})},"Mapping/modules/Markup/MarkupStyles/MarkupSymbolSelector/MarkupSymbolSelectorViewModel":function(){var o,l=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewModelBase"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,a=(o=i.ViewModelBase,l(r,o),r.prototype.initialize=function(e){o.prototype.initialize.call(this,e),this.config=e},r);function r(e,t){return o.call(this,e,t)||this}t.MarkupSymbolSelectorViewModel=a})},"Mapping/modules/Markup/MarkupStyles/MarkupTemplateSelector/MarkupTemplateSelectorView":function(){var o,u=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewBase","geocortex/infrastructure/symbology/SymbolType","geocortex/infrastructure/SymbolUtils","geocortex/infrastructure/GraphicsLayerIds","geocortex/infrastructure/GraphicsLayerUtils"],function(e,t,i,o,a,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,s=(n=i.ViewBase,u(p,n),p.prototype.attach=function(e){n.prototype.attach.call(this,e),this.viewModel.createSwatches=this.createSwatches.bind(this)},p.prototype.activated=function(){this.viewModel.loading||this.loadCurrentLibrary()},p.prototype.getSymbol=function(){return this.viewModel._getSymbol()},p.prototype.createSwatches=function(e){for(var t=$(".markup-swatch-{0}".format(e[0].type),this.root),i=0;i<t.length;i++)t[i].id="__{0}__{1}".format(e[i].type,i),t[i].onclick=dojo.hitch(this,this.handleClickStyle),this.viewModel.markupType===o.SymbolType.TEXT?a.createTextSymbolSwatch(t[i],this._swatchSize,e[i].toSymbol(),this._getMarkupLayer()):a.createSymbolSwatch(t[i],this._swatchSize,e[i].toSymbol())},p.prototype.loadTemplates=function(){this.viewModel._loadAllTemplates()},p.prototype.loadCurrentLibrary=function(){this.viewModel.loading||(this.viewModel.markupType||this.app.event("ActiveToolChangedEvent").publish({tool:this.app.toolRegistry.getActiveTool()}),this.app.site.isInitialized&&this.viewModel.currentTemplates[this.viewModel.markupType].get()&&0===this.viewModel.currentTemplates[this.viewModel.markupType].getLength()&&this.viewModel.currentLibraries[this.viewModel.markupType].pulse())},p.prototype.updateSymbol=function(e,t){return void 0===t&&(t=!0),e instanceof esri.symbol.PictureMarkerSymbol?Promise.resolve(!1):(this.loadCurrentLibrary(),this.viewModel._updateSymbol(e,t))},p.prototype.handleClickStyle=function(e){this.viewModel.styleIndex=this._getIdNumber(e||window.event),this.viewModel.currentStyleIndex[this.viewModel.markupType]=this.viewModel.styleIndex,this.viewModel.executeChangeMarkupFromId(this.viewModel.styleIndex),this.onChange&&this.onChange(this.getSymbol())},p.prototype.handleTextChange=function(e){this.viewModel.executeChangeMarkupFromId(this.viewModel.styleIndex),this.onChange&&this.onChange(this.getSymbol())},p.prototype.handleLibraryChange=function(e){this.viewModel.setSymbolOnLibraryChange=!0},p.prototype._getMarkupLayer=function(){var e=l.getInternalGraphicsLayer(r.MARKUP_LAYER_ID,this.app,l.GraphicsLayerType.Markup,!0);return this.app.markupLayer.set(e),e},p.prototype._getIdNumber=function(e){var t=(e=e||window.event).currentTarget?e.currentTarget.id:this._getId(e.target||e.srcElement);return parseInt(t.replace(/^\D+/g,""))},p.prototype._getId=function(e){return null==e?"":"BUTTON"==e.tagName&&e.id?e.id:this._getId(e.parentNode)},p);function p(){var e=null!==n&&n.apply(this,arguments)||this;return e.displayName=e.app.getResource(e.libraryId,"language-markup-selector-template-displayname"),e.initialized=!1,e.editingMarkup=!1,e._swatchSize=36,e}t.MarkupTemplateSelectorView=s})},"Mapping/modules/Markup/MarkupStyles/MarkupTemplateSelector/MarkupTemplateSelectorViewModel":function(){var o,u=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewModelBase","geocortex/framework/observables","geocortex/infrastructure/ColorUtils","geocortex/infrastructure/SymbolUtils","geocortex/infrastructure/symbology/SymbolType","geocortex/framework-ui/LazyObservable","geocortex/essentials/utilities/UrlUtilities","geocortex/infrastructure/BrowserUtils","geocortex/framework/utils/utils"],function(e,t,i,c,o,h,g,m,a,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,s=(n=i.ViewModelBase,u(p,n),p.prototype.initialize=function(e){var t=this;this.initialized||(void 0!==e.pointLibraries&&dojo.isArray(e.pointLibraries)&&this.pointLibraries.set(e.pointLibraries),void 0!==e.lineLibraries&&dojo.isArray(e.lineLibraries)&&this.lineLibraries.set(e.lineLibraries),void 0!==e.polygonLibraries&&dojo.isArray(e.polygonLibraries)&&this.polygonLibraries.set(e.polygonLibraries),void 0!==e.textLibraries&&dojo.isArray(e.textLibraries)&&this.textLibraries.set(e.textLibraries),e.customPointStyles&&0<e.customPointStyles.length&&this.initializePointStyles(e.customPointStyles),e.customLineStyles&&0<e.customLineStyles.length&&this.initializeLineStyles(e.customLineStyles),e.customPolygonStyles&&0<e.customPolygonStyles.length&&this.initializePolygonStyles(e.customPolygonStyles),e.customTextStyles&&0<e.customTextStyles.length&&this.initializeTextStyles(e.customTextStyles),this.libraries[g.SymbolType.POINT]=this.pointLibraries,this.libraries[g.SymbolType.POLYLINE]=this.lineLibraries,this.libraries[g.SymbolType.POLYGON]=this.polygonLibraries,this.libraries[g.SymbolType.TEXT]=this.textLibraries,this.currentPointLibrary.set(this.libraries[g.SymbolType.POINT].getAt(0)),this.currentLibraries[g.SymbolType.POINT]=this.currentPointLibrary,this.currentLineLibrary.set(this.libraries[g.SymbolType.POLYLINE].getAt(0)),this.currentLibraries[g.SymbolType.POLYLINE]=this.currentLineLibrary,this.currentPolygonLibrary.set(this.libraries[g.SymbolType.POLYGON].getAt(0)),this.currentLibraries[g.SymbolType.POLYGON]=this.currentPolygonLibrary,this.currentTextLibrary.set(this.libraries[g.SymbolType.TEXT].getAt(0)),this.currentLibraries[g.SymbolType.TEXT]=this.currentTextLibrary,this.currentTemplates[g.SymbolType.POINT]=this.currentPointTemplates,this.currentTemplates[g.SymbolType.POLYLINE]=this.currentLineTemplates,this.currentTemplates[g.SymbolType.POLYGON]=this.currentPolygonTemplates,this.currentTemplates[g.SymbolType.TEXT]=this.currentTextTemplates,this.templates[g.SymbolType.POINT]=this.pointTemplates,this.templates[g.SymbolType.POLYLINE]=this.lineTemplates,this.templates[g.SymbolType.POLYGON]=this.polygonTemplates,this.templates[g.SymbolType.TEXT]=this.textTemplates,this.noLibraries[g.SymbolType.POINT]=this.noPointLibraries,this.noLibraries[g.SymbolType.POLYLINE]=this.noLineLibraries,this.noLibraries[g.SymbolType.POLYGON]=this.noPolygonLibraries,this.noLibraries[g.SymbolType.TEXT]=this.noTextLibraries,this.currentPointLibrary.bind(this,function(e){e&&t._setTemplates(t.pointTemplates,e,t.currentPointTemplates)}),this.currentLineLibrary.bind(this,function(e){e&&t._setTemplates(t.lineTemplates,e,t.currentLineTemplates)}),this.currentPolygonLibrary.bind(this,function(e){e&&t._setTemplates(t.polygonTemplates,e,t.currentPolygonTemplates)}),this.currentTextLibrary.bind(this,function(e){e&&t._setTemplates(t.textTemplates,e,t.currentTextTemplates)}),this.currentStyleIndex[g.SymbolType.POINT]=0,this.currentStyleIndex[g.SymbolType.POLYGON]=0,this.currentStyleIndex[g.SymbolType.POLYLINE]=0,this.currentStyleIndex[g.SymbolType.TEXT]=0,this.app.event("MarkupTypeChangedEvent").subscribe(this,function(e){t.markupType!==e&&(t.markupType=e,t.showLibrarySwitcher.set(t.libraries[e]&&1<t.libraries[e].getLength()),t.currentTemplate.set({name:""}),t.isPoint.set(e===g.SymbolType.POINT),t.isLine.set(e===g.SymbolType.POLYLINE),t.isPolygon.set(e===g.SymbolType.POLYGON),t.isText.set(e===g.SymbolType.TEXT),t.styleIndex=t.currentStyleIndex[e]||0)}),this.app.event("MarkupSymbolChangedEvent").subscribe(this,function(e){e instanceof esri.symbol.TextSymbol&&e.text&&!t.symbolText.get()&&t.symbolText.set(e.text),t.markupSymbol=e}),this.initialized=!0)},p.prototype.executeChangeMarkupFromId=function(e){var t=this.currentTemplates[this.markupType].getItems();if(!(e>t.length-1||e<0)&&0<t.length){for(var i=0,o=t;i<o.length;i++)o[i].selected.set(!1);var a=t[e];a.selected.set(!0),this.currentTemplate.set(a);var r=this._getSymbol(),l=esri.symbol.fromJson(JSON.parse(r));l instanceof esri.symbol.TextSymbol&&(l.setText(this.symbolText.get()),r=JSON.stringify(l.toJson())),this.markupSymbol&&JSON.stringify(this.markupSymbol.toJson())===r||this.app.command("ChangeMarkupStyle").execute(r)}},p.prototype._getSymbol=function(){var e;if(this.currentTemplate.get())if(this.markupType===g.SymbolType.TEXT&&this.symbolText.get()){var t=this.currentTemplate.get().toSymbol();t.setText(this.symbolText.get()),e=JSON.stringify(t.toJson())}else e=this.currentTemplate.get().toJsonString();return e},p.prototype._updateSymbol=function(n,s){var p,u=this;return n instanceof esri.symbol.TextSymbol&&n.text&&this.symbolText.set(n.text),new Promise(function(i,e){if(n instanceof esri.symbol.TextSymbol){(p=new esri.symbol.TextSymbol(n.toJson())).setText("");var t=p.font;t.setFamily(p.font.family.split(",")[0]),t.setDecoration(t.decoration||esri.symbol.TextSymbol.DECORATION_NONE)}else p=n;function o(){for(var e=0;e<l.length;e++){var t=u.templates[u.markupType][l[e]];if(t&&(r=t.filter(function(e){return e.hash.get()===a})[0]))break}if(r)return u.currentLibraries[u.markupType].set(l[e]),u.styleIndex=u.currentTemplates[u.markupType].indexOf(r),u.currentStyleIndex[u.markupType]=u.styleIndex,n instanceof esri.symbol.TextSymbol&&u.symbolText.set(n.text),s&&u.executeChangeMarkupFromId(u.styleIndex),void i(!0);i(!1)}var a=h.stringToHash(JSON.stringify(p.toJson())),r=null,l=u.libraries[u.markupType].getItems().sort(function(e,t){return e===u.currentLibraries[u.markupType].get()?1:-1});u.templates[u.markupType][l[0]]?o():u._loadAllTemplates().then(function(){o()})})},p.prototype._setTemplates=function(e,t,i){var o=this;if(e[t]){for(var a=0;a<e[t].length;a++)if(e[t][a].selected.get()){this.currentTemplate.set(e[t][a]),this.styleIndex=a,this.currentStyleIndex[this.markupType]=a;break}i.set(e[t]),this.createSwatches(e[t]),this.setSymbolOnLibraryChange&&(this.executeChangeMarkupFromId(a),this.setSymbolOnLibraryChange=!1)}else this._loadTemplates(e,t).then(function(e){e&&e.length&&(o.currentTemplate.set(e[0]),o.styleIndex=0,o.currentStyleIndex[o.markupType]=0,i.set(e),o.createSwatches(e),o.setSymbolOnLibraryChange&&(o.executeChangeMarkupFromId(0),o.setSymbolOnLibraryChange=!1))})},p.prototype._loadTemplates=function(m,d){var y=this;this.loading=!0;var b=[];return new Promise(function(c,t){if(y.app.site.getEssentialsVersion()<4.07)return y._handleInvalidLibrary(d),y.loading=!1,y.app.trace.debug("Could not load symbol library '{0}'. Essentials 4.7 or newer is required.".format(d)),void c([]);var e=/^(.*?)(\/*)$/.exec(y.app.site.originalUrl)[1],i=a.UrlUtilities.simplify(e+"/../../symbols/{1}/{0}".format(d,function(e){switch(e){case g.SymbolType.POINT:case g.SymbolType.MULTIPOINT:return"point";case g.SymbolType.POLYGON:return"polygon";case g.SymbolType.POLYLINE:return"line";case g.SymbolType.TEXT:return"text";default:return e}}(y.markupType)));h.getEssentialsSymbolLibrary(i).then(function(e){var t=e&&e.symbols;if(!$.isArray(t))throw new Error(y.app.getResource("Mapping.Infrastructure","language-symbology-errors-malformed-library").format(d));for(var i=0;i<t.length;i++)switch(y.markupType){case g.SymbolType.POINT:case g.SymbolType.MULTIPOINT:var o=esri.symbol.fromJson(t[i]);if(o&&o instanceof esri.symbol.SimpleMarkerSymbol){var a=y._createPointTemplate(t[i].name,o.color,o.style,o.size,o.outline.color,o.outline.style,o.outline.width);a.selected.set(!i),b.push(a)}break;case g.SymbolType.POLYLINE:var r=esri.symbol.fromJson(t[i]);if(r&&r instanceof esri.symbol.SimpleLineSymbol){var l=y._createLineTemplate(t[i].name,r.color,r.style,r.width);l.selected.set(!i),b.push(l)}break;case g.SymbolType.POLYGON:var n=esri.symbol.fromJson(t[i]);if(n&&n instanceof esri.symbol.SimpleFillSymbol){var s=y._createPolygonTemplate(t[i].name,n.outline.color,n.color,n.outline.style,n.style,n.outline.width);s.selected.set(!i),b.push(s)}break;case g.SymbolType.TEXT:var p=esri.symbol.fromJson(t[i]);if(p&&p instanceof esri.symbol.TextSymbol){var u=y._createTextTemplate(t[i].name,p.color,p.font.family,p.font.style,p.font.weight,p.font.decoration,p.font.size,p.haloColor,p.haloSize);u.selected.set(!i),b.push(u)}}y.loading=!1,0===b.length?(y._handleInvalidLibrary(d),c([])):(m[d]=b,c(m[d]))},function(e){y._handleInvalidLibrary(d),y.loading=!1,t(e)})})},p.prototype._loadAllTemplates=function(){var l=this;return new Promise(function(e,t){for(var i=[],o=l.libraries[l.markupType].getItems(),a=0;a<o.length;a++){var r=o[a];l.currentTemplates[r]||i.push(l._loadTemplates(l.templates[l.markupType],r))}0<i.length?Promise.all(i).then(function(){e()}):e()})},p.prototype._handleInvalidLibrary=function(e){this.libraries[this.markupType].removeItem(e),1===this.libraries[this.markupType].getLength()&&this.showLibrarySwitcher.set(!1),0===this.libraries[this.markupType].getLength()&&(this.currentLibraries[this.markupType].set(null),this.showLibrarySwitcher.set(!1),this.noLibraries[this.markupType].set(!0),this.currentTemplate.set({name:""}))},p.prototype.initializePointStyles=function(e){this.pointLibraries.addItem(this.legacyLibraryName),this.pointTemplates[this.legacyLibraryName]=[];for(var t=0;t<e.length;t++)if(e[t].length<4)this.app.trace.warning("Point Style "+(t+1)+" in the style selector has an incorrect number of elements.");else{var i=this._createPointTemplate("",o.getColorFromString(e[t][1]),this.esriStyleLookup[g.SymbolType.POINT][e[t][2].toLowerCase()],e[t][3]);i.selected.set(!t),this.pointTemplates[this.legacyLibraryName].push(i)}},p.prototype.initializeLineStyles=function(e){this.lineLibraries.addItem(this.legacyLibraryName),this.lineTemplates[this.legacyLibraryName]=[];for(var t=0;t<e.length;t++)if(e[t].length<4)this.app.trace.warning("Line Style "+(t+1)+" in the style selector has an incorrect number of elements.");else{var i=this._createLineTemplate("",o.getColorFromString(e[t][1]),this.esriStyleLookup[g.SymbolType.POLYLINE][e[t][2].toLowerCase()],e[t][3]);i.selected.set(!t),this.lineTemplates[this.legacyLibraryName].push(i)}},p.prototype.initializePolygonStyles=function(e){this.polygonLibraries.addItem(this.legacyLibraryName),this.polygonTemplates[this.legacyLibraryName]=[];for(var t=0;t<e.length;t++)if(e[t].length<6)this.app.trace.warning("Polygon Style "+(t+1)+" in the style selector has an incorrect number of elements.");else{var i=this._createPolygonTemplate("",o.getColorFromString(e[t][1]),o.getColorFromString(e[t][2]),this.esriStyleLookup[g.SymbolType.POLYLINE][e[t][3].toLowerCase()],this.esriStyleLookup[g.SymbolType.POLYGON][e[t][4].toLowerCase()],e[t][5]);i.selected.set(!t),this.polygonTemplates[this.legacyLibraryName].push(i)}},p.prototype.initializeTextStyles=function(e){this.textLibraries.addItem(this.legacyLibraryName),this.textTemplates[this.legacyLibraryName]=[];for(var t=0;t<e.length;t++)if(e[t].length<6)this.app.trace.warning("Text Style "+(t+1)+" in the style selector has an incorrect number of elements.");else{var i=this._createTextTemplate("",o.getColorFromString(e[t][1]),e[t][5],this.esriStyleLookup[g.SymbolType.TEXT][e[t][2].toLowerCase()],this.esriStyleLookup[g.SymbolType.TEXT][e[t][3].toLowerCase()],esri.symbol.TextSymbol.DECORATION_NONE,e[t][4],o.getColorFromString("#FFFFFF"),0);i.selected.set(!t),this.textTemplates[this.legacyLibraryName].push(i)}},p.prototype._createPointTemplate=function(e,t,i,o,a,r,l){var n=this,s={type:g.SymbolType.POINT,name:e,hash:new m.LazyObservable(null,function(){return h.stringToHash(s.toJsonString())},!0),color:t.toRgba(),style:i,size:o,selected:new c.Observable(!1),outlineColor:a?a.toRgba():null,outlineStyle:r,outlineWidth:l,toSymbol:function(){return n._pointTemplateToSymbol(s)},toJsonString:function(){return JSON.stringify(s.toSymbol().toJson())}};return s},p.prototype._createLineTemplate=function(e,t,i,o){var a=this,r={type:g.SymbolType.POLYLINE,name:e,hash:new m.LazyObservable(null,function(){return h.stringToHash(r.toJsonString())},!0),color:t.toRgba(),style:i,width:o,selected:new c.Observable(!1),toSymbol:function(){return a._lineTemplateToSymbol(r)},toJsonString:function(){return JSON.stringify(r.toSymbol().toJson())}};return r},p.prototype._createPolygonTemplate=function(e,t,i,o,a,r){var l=this,n={type:g.SymbolType.POLYGON,name:e,hash:new m.LazyObservable(null,function(){return h.stringToHash(n.toJsonString())},!0),borderColor:t.toRgba(),fillColor:i.toRgba(),borderStyle:o,fillStyle:a,borderWidth:r,selected:new c.Observable(!1),toSymbol:function(){return l._polygonTemplateToSymbol(n)},toJsonString:function(){return JSON.stringify(n.toSymbol().toJson())}};return n},p.prototype._createTextTemplate=function(e,t,i,o,a,r,l,n,s){var p=this,u={type:g.SymbolType.TEXT,name:e,hash:new m.LazyObservable(null,function(){return h.stringToHash(u.toJsonString())},!0),textFamily:i,style:o,weight:a,decoration:r,size:l,color:t.toRgba(),haloColor:null,haloSize:null,selected:new c.Observable(!1),toSymbol:function(){return p._textTemplateToSymbol(u)},toJsonString:function(){return JSON.stringify(u.toSymbol().toJson())}};return this._isIE9or11||(u.haloColor=n?n.toRgba():null,u.haloSize=s),u},p.prototype._pointTemplateToSymbol=function(e){var t=new esri.symbol.SimpleMarkerSymbol;return t.setStyle(e.style),t.setSize(e.size),t.setColor(new esri.Color(e.color)),t.setOutline(new esri.symbol.SimpleLineSymbol),t.outline.setWidth(e.outlineWidth||0),t.outline.setColor(new esri.Color(e.outlineColor||e.color)),t.outline.setStyle(e.outlineStyle||esri.symbol.SimpleLineSymbol.STYLE_SOLID),t},p.prototype._lineTemplateToSymbol=function(e){var t=new esri.symbol.SimpleLineSymbol;return t.setStyle(e.style),t.setWidth(e.width),t.setColor(new esri.Color(e.color)),t},p.prototype._polygonTemplateToSymbol=function(e){var t=new esri.symbol.SimpleFillSymbol,i=new esri.symbol.SimpleLineSymbol;return i.setStyle(e.borderStyle),i.setWidth(e.borderWidth),i.setColor(new esri.Color(e.borderColor)),t.setOutline(i),t.setStyle(e.fillStyle),t.setColor(new esri.Color(e.fillColor)),t},p.prototype._textTemplateToSymbol=function(e){var t=new esri.symbol.TextSymbol(""),i=new esri.symbol.Font;return i.setFamily(e.textFamily.split(",")[0]),i.setSize(e.size),i.setStyle(e.style||esri.symbol.Font.STYLE_NORMAL),i.setWeight(e.weight||esri.symbol.Font.WEIGHT_NORMAL),t.setFont(i),t.setDecoration(e.decoration||esri.symbol.TextSymbol.DECORATION_NONE),t.setColor(new esri.Color(e.color)),this._isIE9or11||(t.setHaloSize(e.haloSize),t.setHaloColor(new esri.Color(e.haloColor))),t.setAlign(esri.symbol.TextSymbol.ALIGN_START),t},p);function p(e,t){var i=n.call(this,e,t)||this;i.symbologyTextInputId="symbologyTextInput-".concat(l.alphaNumericToken()),i.markupType=null,i.legacyLibraryName=i.app.getResource(i.libraryId,"language-markup-legacy-library-name"),i.pointLibrarySwitcherId="pointLibrarySwitcher-"+l.alphaNumericToken(),i.lineLibrarySwitcherId="lineLibrarySwitcher-"+l.alphaNumericToken(),i.polygonLibrarySwitcherId="polygonLibrarySwitcher-"+l.alphaNumericToken(),i.textLibrarySwitcherId="textLibrarySwitcher-"+l.alphaNumericToken(),i.esriStyleLookup={point:{circle:esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,diamond:esri.symbol.SimpleMarkerSymbol.STYLE_DIAMOND,square:esri.symbol.SimpleMarkerSymbol.STYLE_SQUARE},polyline:{dash:esri.symbol.SimpleLineSymbol.STYLE_DASH,"dash dot":esri.symbol.SimpleLineSymbol.STYLE_DASHDOT,"dash dot dot":esri.symbol.SimpleLineSymbol.STYLE_DASHDOTDOT,dot:esri.symbol.SimpleLineSymbol.STYLE_DOT,solid:esri.symbol.SimpleLineSymbol.STYLE_SOLID},polygon:{solid:esri.symbol.SimpleFillSymbol.STYLE_SOLID,"forward diagonal":esri.symbol.SimpleFillSymbol.STYLE_FORWARD_DIAGONAL,"backward diagonal":esri.symbol.SimpleFillSymbol.STYLE_BACKWARD_DIAGONAL,cross:esri.symbol.SimpleFillSymbol.STYLE_CROSS,"diagonal cross":esri.symbol.SimpleFillSymbol.STYLE_DIAGONAL_CROSS,horizontal:esri.symbol.SimpleFillSymbol.STYLE_HORIZONTAL,vertical:esri.symbol.SimpleFillSymbol.STYLE_VERTICAL},text:{italic:esri.symbol.Font.STYLE_ITALIC,normal:esri.symbol.Font.STYLE_NORMAL,oblique:esri.symbol.Font.STYLE_OBLIQUE,bold:esri.symbol.Font.WEIGHT_BOLD,bolder:esri.symbol.Font.WEIGHT_BOLDER,lighter:esri.symbol.Font.WEIGHT_LIGHTER}},i.isPoint=new c.Observable(!1),i.isLine=new c.Observable(!1),i.isPolygon=new c.Observable(!1),i.isText=new c.Observable(!1),i.styleIndex=0,i.currentStyleIndex={},i.currentTemplate=new c.Observable(null),i.pointLibraries=new c.ObservableCollection([]),i.lineLibraries=new c.ObservableCollection([]),i.polygonLibraries=new c.ObservableCollection([]),i.textLibraries=new c.ObservableCollection([]),i.libraries={},i.currentPointLibrary=new c.Observable(""),i.currentLineLibrary=new c.Observable(""),i.currentPolygonLibrary=new c.Observable(""),i.currentTextLibrary=new c.Observable(""),i.currentLibraries={},i.currentPointTemplates=new c.ObservableCollection,i.currentLineTemplates=new c.ObservableCollection,i.currentPolygonTemplates=new c.ObservableCollection,i.currentTextTemplates=new c.ObservableCollection,i.currentTemplates={},i.pointTemplates={},i.lineTemplates={},i.polygonTemplates={},i.textTemplates={},i.templates={},i.symbolText=new c.Observable(""),i.showLibrarySwitcher=new c.Observable(!1),i.noLibraries={},i.noPointLibraries=new c.Observable(!1),i.noLineLibraries=new c.Observable(!1),i.noPolygonLibraries=new c.Observable(!1),i.noTextLibraries=new c.Observable(!1),i.loading=!1,i.initialized=!1,i.setSymbolOnLibraryChange=!1,i._isIE9or11=!1;var o=r.isIE();return i._isIE9or11=9===o||11===o,i.app.command("ChangeMarkupStyleFromId").register(i,i.executeChangeMarkupFromId),i}t.MarkupTemplateSelectorViewModel=s})},"url:/Mapping/modules/Markup/MarkupStyles/MarkupStyleView.html":t,"url:/Mapping/modules/Markup/MarkupStyles/MarkupSymbolSelector/MarkupSymbolSelectorView.html":i,"url:/Mapping/modules/Markup/MarkupStyles/MarkupTemplateSelector/MarkupTemplateSelectorView.html":o,"url:/Mapping/modules/Markup/ToolPalettes/DeletePaletteSmall.html":a,"url:/Mapping/modules/Markup/ToolPalettes/EditPaletteLarge.html":r,"url:/Mapping/modules/Markup/ToolPalettes/EditPaletteSmall.html":l,"url:/Mapping/modules/Markup/ToolPalettes/MarkupPaletteSmall.html":n}}),require(["geocortex/framework/resourceManager"],function(e){e.resourceManager.register("Mapping","inv","Mapping/modules/Markup/CSS/common.css","css","LyogU1RBUlQ6IE1hcmt1cCAtLS0tLS0tLS0tLS0tLS0tKi8NCi5NYXJrdXBTdHlsZVZpZXcgLmZvcm0taXRlbSB7DQogICAgcGFkZGluZzogMDsNCn0NCg0KLk1hcmt1cEltYWdlU2VsZWN0b3JWaWV3IC5pbWFnZS1jb250YWluZXIgew0KICAgIG1heC1oZWlnaHQ6IDIyZW07DQp9DQoNCi5sYXllci1zdHlsZS1pbWFnZS1zZWxlY3RvciAuaW1hZ2UtY29udGFpbmVyIHsNCiAgICBtYXgtaGVpZ2h0OiAyMGVtOw0KICAgIHBhZGRpbmctbGVmdDogMC41ZW07DQp9DQoNCi50ZW1wbGF0ZS1saWJyYXJ5LXNlbGVjdG9yIHsNCiAgICBtYXJnaW4tdG9wOiAxMHB4Ow0KICAgIHdoaXRlLXNwYWNlOiBub3dyYXA7DQogICAgcG9zaXRpb246IGFic29sdXRlOw0KICAgIGJvdHRvbTogMGVtOw0KfQ0KDQouc3R5bGUtc2VsZWN0b3IgLm1hcmt1cC1zd2F0Y2ggew0KICAgIGxpc3Qtc3R5bGU6IG5vbmU7DQogICAgZGlzcGxheTogaW5saW5lLWJsb2NrOw0KICAgIG1hcmdpbjogMC41ZW07DQogICAgYm9yZGVyOiAxcHggc29saWQgI0RERERERDsNCiAgICB3aWR0aDogM2VtOw0KICAgIGhlaWdodDogM2VtOw0KICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgYmFja2dyb3VuZDogI0Y4RjhGODsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQp9DQoNCi5zdHlsZS1zZWxlY3RvciAuZm9ybS1idG5zIHsNCiAgICBjbGVhcjogYm90aDsNCiAgICB0ZXh0LWFsaWduOiByaWdodDsNCn0NCg0KLmljb24tc3dhdGNoLXBpY2tlci0yNCB7DQogICAgd2lkdGg6IDI0cHg7DQogICAgaGVpZ2h0OiAyNHB4Ow0KICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybCgiUmVzb3VyY2VzL0ltYWdlcy9JY29ucy9Ub29sYmFyL3N0eWxlcy0yNC5wbmciKTsNCn0NCg0KLmljb24tZHJhdy1lZGl0LTI0IHsNCiAgICB3aWR0aDogMjRweDsNCiAgICBoZWlnaHQ6IDI0cHg7DQogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKCJSZXNvdXJjZXMvSW1hZ2VzL0ljb25zL1Rvb2xiYXIvZHJhdy1lZGl0LTI0LnBuZyIpOw0KfQ0KDQoubWFya3VwLWVkaXQgew0KICAgIG1hcmdpbi10b3A6IC0wLjRlbTsNCn0NCg0KLnRvb2xiYXItYm9keSAuTWFya3VwRWRpdFZpZXcgIC50b29sYmFyLXNtYWxsLWxheW91dCB7DQogICAgcGFkZGluZzogMC41ZW07DQp9DQoNCi5lc3JpU3ltYm9sRWRpdG9yIHsNCiAgICBkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7DQp9DQovKiBFTkQ6IE1hcmt1cCAtLS0tLS0tLS0tLS0tLS0tKi8="),e.resourceManager.register("Mapping","inv","Mapping/modules/Markup/CSS/small.css","css","LyogU1RBUlQ6IE1hcmt1cCAtLS0tLS0tLS0tLS0tLS0tKi8NCi5UZXh0U3R5bGVWaWV3LA0KLnN0eWxlLXNlbGVjdG9yIHsNCiAgICBoZWlnaHQ6IDEwMCU7ICAgIA0KfQ0KLnN0eWxlLXNlbGVjdG9yIC5mb3JtLWJ0bnMgew0KICAgIG1hcmdpbi10b3A6IDFlbTsNCn0NCi5tYXJrdXAtZWRpdCB7DQogICAgd2lkdGg6IDEwMCU7DQogICAgZmxvYXQ6IGxlZnQ7DQp9DQoubWFya3VwLWVkaXQgLmljb24uaWNvbi1lcmFzZS0xNiB7DQogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKFJlc291cmNlcy9JbWFnZXMvSWNvbnMvVG9vbGJhci9lcmFzZS0yNC5wbmcpOw0KfQ0KLm1hcmt1cC1lZGl0IC5pY29uLmljb24tY2xlYXItMTYgew0KICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChSZXNvdXJjZXMvSW1hZ2VzL0ljb25zL1Rvb2xiYXIvY2xlYXItMjQucG5nKTsNCn0NCg0KLnRidG0tYnRuIHsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBoZWlnaHQ6IDQuNzVlbTsNCn0NCg0KDQpAbWVkaWEgYWxsIGFuZCAobWluLXdpZHRoOiAxMDBweCkgew0KICAgIC5tYXJrdXAtZWRpdCAudG9vbGJhci1pdGVtLmJ1dHRvbiB7DQogICAgICAgIHdpZHRoOiA0OS45JTsgLyogVHdpY2UgdGhlIGRlZmF1bHQgd2lkdGggYmVjYXVzZSB0aGUgbWFya3VwIGVkaXQgZGl2cyBhcmUgNTAlIHdpZGUgaW5zdGVhZCBvZiAxMDAlICovDQogICAgfQ0KICAgIC5tYXJrdXAtZWRpdCAudG9vbGJhci1pdGVtLmJ1dHRvbjpudGgtY2hpbGQoMW4rMSkgeyAvKiBPdmVycmlkZXMgdGhlIHByZXZpb3VzIGNsZWFyICovDQogICAgICAgIGNsZWFyOiBub25lOw0KICAgIH0NCiAgICAubWFya3VwLWVkaXQgLnRvb2xiYXItaXRlbS5idXR0b246bnRoLWNoaWxkKDJuKzEpIHsgLyogQ2xlYXJzIGV2ZXJ5IDNyZCBpdGVtICovDQogICAgICAgIGNsZWFyOiBib3RoOw0KICAgIH0NCn0NCg0KQG1lZGlhIGFsbCBhbmQgKG1pbi13aWR0aDogMjAwcHgpIHsNCiAgICAubWFya3VwLWVkaXQgLnRvb2xiYXItaXRlbS5idXR0b24gew0KICAgICAgICB3aWR0aDogMzMuMyU7DQogICAgfQ0KICAgIC5tYXJrdXAtZWRpdCAudG9vbGJhci1pdGVtLmJ1dHRvbjpudGgtY2hpbGQoMm4rMSkgeyAvKiBPdmVycmlkZXMgdGhlIHByZXZpb3VzIGNsZWFyICovDQogICAgICAgIGNsZWFyOiBub25lOw0KICAgIH0NCiAgICAubWFya3VwLWVkaXQgLnRvb2xiYXItaXRlbS5idXR0b246bnRoLWNoaWxkKDNuKzEpIHsNCiAgICAgICAgY2xlYXI6IGJvdGg7DQogICAgfQ0KfQ0KDQpAbWVkaWEgYWxsIGFuZCAobWluLXdpZHRoOiAzMDBweCkgew0KICAgIC5tYXJrdXAtZWRpdCB7IHdpZHRoOiA1MCU7IH0NCiAgICAubWFya3VwLWVkaXQgLnRvb2xiYXItaXRlbS5idXR0b24gew0KICAgICAgICB3aWR0aDogNDkuOSU7DQogICAgfQ0KICAgIC5tYXJrdXAtZWRpdCAudG9vbGJhci1pdGVtLmJ1dHRvbjpudGgtY2hpbGQoM24rMSkgeyAvKiBPdmVycmlkZXMgdGhlIHByZXZpb3VzIGNsZWFyICovDQogICAgICAgIGNsZWFyOiBub25lOw0KICAgIH0NCiAgICAubWFya3VwLWVkaXQgLnRvb2xiYXItaXRlbS5idXR0b246bnRoLWNoaWxkKDRuKzEpIHsNCiAgICAgICAgY2xlYXI6IGJvdGg7DQogICAgfQ0KfQ0KDQpAbWVkaWEgYWxsIGFuZCAobWluLXdpZHRoOiA0MDBweCkgew0KICAgIC5tYXJrdXAtZWRpdCB7IHdpZHRoOiA0MCU7IH0NCiAgICAubWFya3VwLWVkaXQgLnRvb2xiYXItaXRlbS5idXR0b24gew0KICAgICAgICB3aWR0aDogNDkuOSU7DQogICAgfQ0KICAgIC5tYXJrdXAtZWRpdCAudG9vbGJhci1pdGVtLmJ1dHRvbjpudGgtY2hpbGQoNG4rMSkgeyAvKiBPdmVycmlkZXMgdGhlIHByZXZpb3VzIGNsZWFyICovDQogICAgICAgIGNsZWFyOiBub25lOw0KICAgIH0NCiAgICAubWFya3VwLWVkaXQgLnRvb2xiYXItaXRlbS5idXR0b246bnRoLWNoaWxkKDVuKzEpIHsNCiAgICAgICAgY2xlYXI6IGJvdGg7DQogICAgfQ0KfQ0KDQpAbWVkaWEgYWxsIGFuZCAobWluLXdpZHRoOiA2MDBweCkgew0KICAgIC5tYXJrdXAtZWRpdCB7IHdpZHRoOiAzMy4zJTsgfQ0KICAgIC5tYXJrdXAtZWRpdCAudG9vbGJhci1pdGVtLmJ1dHRvbiB7DQogICAgICAgIHdpZHRoOiA0OS45JTsNCiAgICB9DQogICAgLm1hcmt1cC1lZGl0IC50b29sYmFyLWl0ZW0uYnV0dG9uOm50aC1jaGlsZCg1bisxKSB7IC8qIE92ZXJyaWRlcyB0aGUgcHJldmlvdXMgY2xlYXIgKi8NCiAgICAgICAgY2xlYXI6IG5vbmU7DQogICAgfQ0KICAgIC5tYXJrdXAtZWRpdCAudG9vbGJhci1pdGVtLmJ1dHRvbjpudGgtY2hpbGQoNm4rMSkgew0KICAgICAgICBjbGVhcjogYm90aDsNCiAgICB9DQp9DQoNCkBtZWRpYSBhbGwgYW5kIChtaW4td2lkdGg6IDcwMHB4KSB7DQogICAgLm1hcmt1cC1lZGl0IHsgd2lkdGg6IDI4LjU3JTsgfQ0KICAgIC5tYXJrdXAtZWRpdCAudG9vbGJhci1pdGVtLmJ1dHRvbiB7DQogICAgICAgIHdpZHRoOiA0OS45JTsNCiAgICB9DQogICAgLm1hcmt1cC1lZGl0IC50b29sYmFyLWl0ZW0uYnV0dG9uOm50aC1jaGlsZCg2bisxKSB7IC8qIE92ZXJyaWRlcyB0aGUgcHJldmlvdXMgY2xlYXIgKi8NCiAgICAgICAgY2xlYXI6IG5vbmU7DQogICAgfQ0KICAgIC5tYXJrdXAtZWRpdCAudG9vbGJhci1pdGVtLmJ1dHRvbjpudGgtY2hpbGQoN24rMSkgew0KICAgICAgICBjbGVhcjogYm90aDsNCiAgICB9DQp9DQoNCkBtZWRpYSBhbGwgYW5kIChtaW4td2lkdGg6IDgwMHB4KSB7DQogICAgLm1hcmt1cC1lZGl0IHsgd2lkdGg6IDI0LjklOyB9DQogICAgLm1hcmt1cC1lZGl0IC50b29sYmFyLWl0ZW0uYnV0dG9uIHsNCiAgICAgICAgd2lkdGg6IDQ5LjklOw0KICAgIH0NCiAgICAubWFya3VwLWVkaXQgLnRvb2xiYXItaXRlbS5idXR0b246bnRoLWNoaWxkKDduKzEpIHsgLyogT3ZlcnJpZGVzIHRoZSBwcmV2aW91cyBjbGVhciAqLw0KICAgICAgICBjbGVhcjogbm9uZTsNCiAgICB9DQogICAgLm1hcmt1cC1lZGl0IC50b29sYmFyLWl0ZW0uYnV0dG9uOm50aC1jaGlsZCg4bisxKSB7DQogICAgICAgIGNsZWFyOiBib3RoOw0KICAgIH0NCn0NCg0KQG1lZGlhIGFsbCBhbmQgKG1pbi13aWR0aDogOTAwcHgpIHsNCiAgICAubWFya3VwLWVkaXQgeyB3aWR0aDogMjIuMjIlOyB9DQogICAgLm1hcmt1cC1lZGl0IC50b29sYmFyLWl0ZW0uYnV0dG9uIHsNCiAgICAgICAgd2lkdGg6IDQ5LjklOw0KICAgIH0NCiAgICAubWFya3VwLWVkaXQgLnRvb2xiYXItaXRlbS5idXR0b246bnRoLWNoaWxkKDhuKzEpIHsgLyogT3ZlcnJpZGVzIHRoZSBwcmV2aW91cyBjbGVhciAqLw0KICAgICAgICBjbGVhcjogbm9uZTsNCiAgICB9DQogICAgLm1hcmt1cC1lZGl0IC50b29sYmFyLWl0ZW0uYnV0dG9uOm50aC1jaGlsZCg5bisxKSB7DQogICAgICAgIGNsZWFyOiBib3RoOw0KICAgIH0NCn0NCg0KQG1lZGlhIGFsbCBhbmQgKG1pbi13aWR0aDogMTAwMHB4KSB7DQogICAgLm1hcmt1cC1lZGl0IHsgd2lkdGg6IDIwJTsgfQ0KICAgIC5tYXJrdXAtZWRpdCAudG9vbGJhci1pdGVtLmJ1dHRvbiB7DQogICAgICAgIHdpZHRoOiA0OS45JTsNCiAgICB9DQogICAgLm1hcmt1cC1lZGl0IC50b29sYmFyLWl0ZW0uYnV0dG9uOm50aC1jaGlsZCg5bisxKSB7IC8qIE92ZXJyaWRlcyB0aGUgcHJldmlvdXMgY2xlYXIgKi8NCiAgICAgICAgY2xlYXI6IG5vbmU7DQogICAgfQ0KICAgIC5tYXJrdXAtZWRpdCAudG9vbGJhci1pdGVtLmJ1dHRvbjpudGgtY2hpbGQoMTBuKzEpIHsNCiAgICAgICAgY2xlYXI6IGJvdGg7DQogICAgfQ0KfQ0KDQpAbWVkaWEgYWxsIGFuZCAobWluLXdpZHRoOiAxMTAwcHgpIHsNCiAgICAubWFya3VwLWVkaXQgeyB3aWR0aDogMTguMTglOyB9DQogICAgLm1hcmt1cC1lZGl0IC50b29sYmFyLWl0ZW0uYnV0dG9uIHsNCiAgICAgICAgd2lkdGg6IDQ5LjklOw0KICAgIH0NCiAgICAubWFya3VwLWVkaXQgLnRvb2xiYXItaXRlbS5idXR0b246bnRoLWNoaWxkKDEwbisxKSB7IC8qIE92ZXJyaWRlcyB0aGUgcHJldmlvdXMgY2xlYXIgKi8NCiAgICAgICAgY2xlYXI6IG5vbmU7DQogICAgfQ0KICAgIC5tYXJrdXAtZWRpdCAudG9vbGJhci1pdGVtLmJ1dHRvbjpudGgtY2hpbGQoMTFuKzEpIHsNCiAgICAgICAgY2xlYXI6IGJvdGg7DQogICAgfQ0KfQ0KDQpAbWVkaWEgYWxsIGFuZCAobWluLXdpZHRoOiAxMjAwcHgpIHsNCiAgICAubWFya3VwLWVkaXQgeyB3aWR0aDogMTYuNjY3JTsgfQ0KICAgIC5tYXJrdXAtZWRpdCAudG9vbGJhci1pdGVtLmJ1dHRvbiB7DQogICAgICAgIHdpZHRoOiA0OS45JTsNCiAgICB9DQogICAgLm1hcmt1cC1lZGl0IC50b29sYmFyLWl0ZW0uYnV0dG9uOm50aC1jaGlsZCgxMW4rMSkgeyAvKiBPdmVycmlkZXMgdGhlIHByZXZpb3VzIGNsZWFyICovDQogICAgICAgIGNsZWFyOiBub25lOw0KICAgIH0NCiAgICAubWFya3VwLWVkaXQgLnRvb2xiYXItaXRlbS5idXR0b246bnRoLWNoaWxkKDEybisxKSB7DQogICAgICAgIGNsZWFyOiBib3RoOw0KICAgIH0NCn0NCi8qIEVORDogTWFya3VwIC0tLS0tLS0tLS0tLS0tLS0qLw=="),e.resourceManager.register("Mapping","inv","Mapping/modules/Markup/MarkupStyles/MarkupStyleView.html","html",t),e.resourceManager.register("Mapping","inv","Mapping/modules/Markup/MarkupStyles/MarkupSymbolSelector/MarkupSymbolSelectorView.html","html",i),e.resourceManager.register("Mapping","inv","Mapping/modules/Markup/MarkupStyles/MarkupTemplateSelector/MarkupTemplateSelectorView.html","html",o),e.resourceManager.register("Mapping","inv","Mapping/modules/Markup/ToolPalettes/DeletePaletteSmall.html","html",a),e.resourceManager.register("Mapping","inv","Mapping/modules/Markup/ToolPalettes/EditPaletteLarge.html","html",r),e.resourceManager.register("Mapping","inv","Mapping/modules/Markup/ToolPalettes/EditPaletteSmall.html","html",l),e.resourceManager.register("Mapping","inv","Mapping/modules/Markup/ToolPalettes/MarkupPaletteSmall.html","html",n)}),require({cache:{}}),define(["Mapping/modules/Markup/MarkupModule","Mapping/modules/Markup/MarkupViewModel","Mapping/modules/Markup/ToolPalettes/TransientMarkupPaletteView","Mapping/modules/Markup/ToolPalettes/TransientMarkupPaletteViewModel","Mapping/modules/Markup/MarkupStyles/MarkupSymbolSelector/MarkupSymbolSelectorView","Mapping/modules/Markup/MarkupStyles/MarkupSymbolSelector/MarkupSymbolSelectorViewModel","Mapping/modules/Markup/MarkupStyles/MarkupTemplateSelector/MarkupTemplateSelectorView","Mapping/modules/Markup/MarkupStyles/MarkupTemplateSelector/MarkupTemplateSelectorViewModel"],function(e,t,i,o,a,r,l,n){s(e,"geocortex.essentialsHtmlViewer.mapping.modules.markup.MarkupModule",e.MarkupModule),s(t,"geocortex.essentialsHtmlViewer.mapping.modules.markup.MarkupViewModel",t.MarkupViewModel),s(i,"geocortex.essentialsHtmlViewer.mapping.modules.markup.toolPalettes.TransientMarkupPaletteView",i.TransientMarkupPaletteView),s(o,"geocortex.essentialsHtmlViewer.mapping.modules.markup.toolPalettes.TransientMarkupPaletteViewModel",o.TransientMarkupPaletteViewModel),s(a,"geocortex.essentialsHtmlViewer.mapping.modules.markup.MarkupSymbolSelectorView",a.MarkupSymbolSelectorView),s(r,"geocortex.essentialsHtmlViewer.mapping.modules.markup.MarkupSymbolSelectorViewModel",r.MarkupSymbolSelectorViewModel),s(l,"geocortex.essentialsHtmlViewer.mapping.modules.markup.MarkupTemplateSelectorView",l.MarkupTemplateSelectorView),s(n,"geocortex.essentialsHtmlViewer.mapping.modules.markup.MarkupTemplateSelectorViewModel",n.MarkupTemplateSelectorViewModel)})}();