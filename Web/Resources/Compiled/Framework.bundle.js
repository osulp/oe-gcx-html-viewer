require({cache:{"geocortex/framework/application/Application":function(){var I=this&&this.__spreadArrays||function(){for(var e=0,i=0,t=arguments.length;i<t;i++)e+=arguments[i].length;var r=Array(e),o=0;for(i=0;i<t;i++)for(var n=arguments[i],a=0,s=n.length;a<s;a++,o++)r[o]=n[a];return r};define(["require","exports","./../config/ConfigurationModel","./../observables","./../utils/Trace","./ModuleManager","./../commands/CommandRegistry","./../events/EventRegistry","./../behaviors/BehaviorRegistry","./../storage/Store","./../ui/ViewManager","./ApplicationCommands","./../index","./../resourceManager","./../config/ConfigurationLoader","./../ui/ViewModelBase","./../utils/utils","./../SimplePromise","../utils/HttpsUtils","../utils/ArrayUtils","./DeferredLoadTriggers"],function(h,e,d,u,c,f,g,m,p,v,y,b,w,_,r,M,C,t,L,O,R){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=(o.prototype._handleRequireError=function(e){this._disableModuleOnRequireError(e)||this.trace.error("[require error]: "+e.src+"."+e.message+": ["+e.info[0]+"]",e)},o.prototype.getLibraryOrder=function(e){if(!this.configModel.libraryConfigs)return null;for(var i=0;i<this.configModel.libraryConfigs.length;++i)if(this.configModel.libraryConfigs[i].id===e)return i;return null},o.prototype.shouldOmitStylesForLibrary=function(e){if(!this.configModel.libraryConfigs)return null;for(var i=0,t=this.configModel.libraryConfigs;i<t.length;i++){var r=t[i];if(r.id===e)return!!r.omitStyles}return!1},o.prototype.translateConfiguration=function(c,e){var f=this,h=function(e,i,t){if("string"==typeof i){if(-1<i.indexOf("@language")){var r=i.split("-");if(r.length<2)throw new Error("Invalid language key '{0}'.".format(i));var o=r.join("-").replace("@",""),n=t||c;return f.getResource(n,o)}return f.performTokenReplacement(i)}if(i instanceof Array){for(var a=[],s=0;s<i.length;++s)a.push(h(s,i[s]));return a}if(i instanceof Function)return i;if(i instanceof Object){var l={},d=i.hasOwnProperty("libraryId")?i.libraryId:void 0;for(var u in i)i.hasOwnProperty(u)&&(l[u]=h(u,i[u],d));return l}return i},i={};for(var t in e)e.hasOwnProperty(t)&&(i[t]=h(t,e[t]));return i},o.prototype.performTokenReplacement=function(e){var r=this;return e?e.replace(/{.+?}/g,function(e){var i=e.substring(1,e.length-1),t=r.configTokens.hasOwnProperty(i)?r.configTokens[i]:e;return!t&&r.configuration&&r.configuration.hasOwnProperty(i)?r.configuration[i]:t||(r.trace.warning("The token syntax \\{{0}\\} was detected, but could not be matched to a valid replacement.".format(i)),"")}):e},o.prototype.isHttpsUri=function(e){return L.isHttpsUri(e)},o.prototype.makeAbsolute=function(e,i){if(new dojo._Url(e).host)return e;var t=i||"{0}//{1}{2}".format(window.location.protocol,window.location.host,window.location.pathname);if("/"!==t.charAt(t.length-1)||"\\"!==t.charAt(t.length-1)){var r=t.split("/");--r.length,t=r.join("/"),t+="/"}if("/"===e.charAt(0)||"\\"===e.charAt(0)){var o=new dojo._Url(t);e=o.scheme+"://"+o.authority+"/"+e.substring(1)}else{for(var n=t.split("/"),a=e?e.split("../"):[],s=0,l=0,d=a;l<d.length;l++)""===d[l]&&++s;var u=n.slice(0,n.length-(0<s?s+1:s)),c=a.slice(0<s?s-1:s);e=u.join("/")+c.join("/")}return e},o.prototype.getHostElement=function(){return this._hostElement},o.prototype.getResource=function(e,i,t){t=(t=t||this.locale||"inv").toLowerCase();var r=this._resourceDictionaries[t],o=this._resourceDictionaries.inv||{},n=(r=r||o)[e]||o[e];if(!n)return this.trace.warning("No resource dictionary found for library '{0}' while trying to get resource with key '{1}', using locale '{2}'.".format(e,i,t)),"@"+i;var a=null;if(n.hasOwnProperty(i))a=n[i];else{if(r===o)return"@"+i;if(!(n=o[e])||!1===n.hasOwnProperty(i))return this.trace.warning("The resource with key '{0}' was not found in library '{1}'.".format(i,e)),"@"+i;a=n[i]}return"debug"===t?this._getDebugLocaleString(a):"strings"===t?i:"!!"===t?"!"+a+"!":a},o.prototype.getUri=function(e){if(e.indexOf("://")<0){var i=this.host+e;return this.isHttpsUri(i)!==this.isHttpsMode&&this.trace.warning("Mixing secured and non-secured resources. Request: '{0}'.".format(i)),C.isNullOrUndefined(this.proxyUri)||String.isNullOrEmpty(this.proxyUri)?i:this.proxyUri+encodeURIComponent(i)}return this.isHttpsUri(e)!==this.isHttpsMode&&this.trace.warning("Mixing secured and non-secured resources. Request: '{0}'.".format(e)),this.proxyUri+encodeURIComponent(e)},o.prototype.getUrlParameter=function(e){if(this.urlParameters)for(var i in this.urlParameters)if(this.urlParameters.hasOwnProperty(i)&&!String.isNullOrEmpty(i)&&!String.isNullOrEmpty(e)&&i.toLowerCase()===e.toLowerCase())return this.urlParameters[i];return null},o.prototype.onLibrariesDownloaded=function(e){},o.prototype.onConfigurationLoaded=function(e){},o.prototype.notifyLibraryDownload=function(e){var i=this;this.trace.info("Processing downloaded library '{0}' for application '{1}'.".format(e,this.id)),this.eventRegistry.event("LibraryDownloadedEvent").publish(e);var t=_.resourceManager.fetchAllFor(e,"json");if(t&&0<t.length)for(var r=0,o=t;r<o.length;r++){var n=o[r],a=_.resourceManager.fetch(n.name,n.library,n.locale);this.injectLibraryResources(e,a,n.locale)}this.configModel&&(this.shouldOmitStylesForLibrary(e)||this._addStyles(e),this.waitUntilShellStabilized().then(function(){return i._initializeLibrary(e)}),0<this._pendingLibraryDownloads&&--this._pendingLibraryDownloads,this._doIfNoPendingLibraryDownloads())},o.prototype.hasLibrary=function(e){return w.hasLibrary(e)&&!!this.configModel.libraryModules[e]&&this._resourceDictionaries.inv&&!!this._resourceDictionaries.inv[e]},o.prototype.registerFrameworkObject=function(i){if(!i.id)throw new Error("Could not register framework object. Object was missing an ID.");this._frameworkObjects[i.id]=i;var e=this._pendingFrameworkObjectRequests[i.id];return e&&e.length&&(e.forEach(function(e){return e(i)}),e.length=0,delete this._pendingFrameworkObjectRequests[i.id]),i},o.prototype.freeAllFrameworkObjects=function(){},o.prototype.getFrameworkObjectById=function(e){for(var i in this._frameworkObjects)if(this._frameworkObjects.hasOwnProperty(i)&&i===e)return this._frameworkObjects[i];return null},o.prototype.getFrameworkObjectByIdAsync=function(e,i,t){if(e&&dojo.isString(e)&&i&&dojo.isFunction(i)){var r=this.getFrameworkObjectById(e);r?i(r):(this._pendingFrameworkObjectRequests[e]=this._pendingFrameworkObjectRequests[e]||[],this._pendingFrameworkObjectRequests[e].push(i))}else t&&dojo.isFunction(t)&&t(new Error("Cannot retrieve Framework Object. Object ID or callback unspecified or incorrect."))},o.prototype.initialize=function(){var t=this;function i(e){"string"==typeof e&&(e=JSON.parse(e)),t.configPreprocessor&&(t.configPreprocessor(e),t.configPreprocessor=null);var i=new d.ConfigurationModel(t);t.onConfigurationLoaded(e),t.abortInitialization||i.parse(e,function(e){return t.processConfiguration(e)})}dojo.connect(window,"onresize",function(e){t.eventRegistry.event("ApplicationResizedEvent").publish()}),dojo.subscribe("ServiceTokenRefreshed",function(e){t.configuration&&e.serviceUrl===t.configuration.geometryServiceUrl&&(t.configuration.geometryServiceToken=e.token)});var e=new r.ConfigurationLoader(this);if(null!=this.configModel)throw new Error("Configuration model should not be loaded already");if(null!=this._configObject)i(this._configObject),this._configObject=null;else{if(null==this.configUri)throw new Error("No configuration method");e.loadConfigurationTree(this.configUri,function(e){return i(e)})}this.viewManager.discoverRegions(this._hostElement)},o.prototype.shutdown=function(e){this.eventRegistry.event("ApplicationShutdownEvent").publish(e),this.isShuttingDown=!0,this.viewManager.shutdown(),this.moduleManager.shutdown(e),this.commandRegistry.clear(),this.eventRegistry.clear(),this._requireErrorHandlerHandle&&this._requireErrorHandlerHandle.remove()},o.prototype._doIfNoPendingLibraryDownloads=function(){0===this._pendingLibraryDownloads&&(_.resourceManager&&_.resourceManager.performThemeInjection(),this.allLibrariesLoaded=!0,this.eventRegistry.event("ViewerLibrariesDownloadedEvent").publish(this),this.onLibrariesDownloaded(this),this._initialStateAppliedCount<=0&&this.initialStateAppliedCallback&&this.initialStateAppliedCallback(this))},o.prototype.onInitializationComplete=function(){C.isNullOrUndefined(this.initializationCompleteCallback)||this.initializationCompleteCallback(this)},o.prototype._detectBrowserLocale=function(){navigator.language?this.locale=navigator.language:navigator.userLanguage?this.locale=navigator.userLanguage:navigator.browserLanguage?this.locale=navigator.browserLanguage:this.locale="inv"},o.prototype._getLibraryConfig=function(i){return this.configModel.libraryConfigs.filter(function(e){return e.id===i})[0]},o.prototype._getAsyncModuleRoot=function(e){var i=this._getLibraryConfig(e.libraryId);return i.location&&"Mapping"!==i.id?this.performTokenReplacement(i.location+"/"+e.moduleName+".js"):e.libraryId+"/modules/"+e.moduleName},o.prototype._establishRecords=function(){this._moduleRecords=this.configModel.moduleConfigs.map(function(e,i){return{index:i,moduleConfig:e,loaded:!1,initialized:!1,deferred:!1,tasks:function(e){var i=0;i++,i+=e.viewConfigs.length;for(var t=0,r=e.viewConfigs;t<r.length;t++)r[t].requireMarkup&&i++;return i+=e.viewModelConfigs.length}(e),tasksDone:0,MainClass:null,views:e.viewConfigs.map(function(e){return{ViewClass:null,viewMarkup:null}}),viewModels:e.viewModelConfigs.map(function(e){return{ViewModelClass:null}})}})},o.prototype._download=function(){this._pendingLibraryDownloads=this.configModel.libraryConfigs.length,this._allViewModels=this.configModel.moduleConfigs.map(function(e){return e.viewModelConfigs}).reduce(function(e,i){return e.concat(i)}),this._loadTraditionalLibraries(),this._cacheAsyncLibrariesAndRegisterPath(),this._cacheAsyncModules(),this._loadAsyncLibraries()},o.prototype._loadTraditionalLibraries=function(){for(var r=this,e=this.configModel.libraryConfigs.filter(function(e){return!e.async}),i=function(i){if(w.hasLibrary(i.id))o.notifyLibraryDownload(i.id);else if(w.libraries[i.id]=!1,i.uri){var t=!1,e=o.eventRegistry.event("LibraryDownloadedEvent").subscribe(o,function(e){e===i.id&&(t=!0)});o.includeScript(i.uri,function(){setTimeout(function(){t||(r.trace.warning("A file was loaded for the library '"+i.id+"' but the library did not signal that it was ready in time. As a result, viewer functions that depend on this library may not be available."),0<r._pendingLibraryDownloads&&--r._pendingLibraryDownloads,r._doIfNoPendingLibraryDownloads()),r.eventRegistry.event("LibraryDownloadedEvent").unsubscribe(e)},3e3)},function(){return r.eventRegistry.event("LibraryDownloadedEvent").unsubscribe(e)})}else o.notifyLibraryDownload(i.id)},o=this,t=0,n=e;t<n.length;t++)i(n[t])},o.prototype._cacheAsyncLibrariesAndRegisterPath=function(){var r=this;this.configModel.libraryConfigs.filter(function(e){return e.async&&e.packageName&&e.location}).forEach(function(e){var i=r.performTokenReplacement(e.location),t={};t[e.packageName]=i,h({paths:t})}),this.configModel.libraryConfigs.filter(function(e){return e.async&&e.bundleUri}).forEach(function(e){var i=r.performTokenReplacement(e.bundleUri),t=r.getLibraryDependencyUris(e,r.configModel.libraryConfigs);0<t.length?h(t,function(){h([i])}):h([i])})},o.prototype.getLibraryDependencyUris=function(t,r){var o=this,n=[];return t&&t.libraryDependencies&&0<t.libraryDependencies.length&&r&&t.libraryDependencies.forEach(function(i){var e=r.filter(function(e){return e.id===i});e&&0<e.length?n.push(e[0].bundleUri):o.trace.error("Library '"+t.id+"' has dependency on library '"+i+"' that doesn't have a bundleUri specified or doesn't exist.")}),n},o.prototype._cacheAsyncModules=function(){var t=this,e=this.configModel.moduleConfigs.filter(function(e){var i=t._getLibraryConfig(e.libraryId);return i&&i.async&&(i.loadModulesBundle||e.overrideLoadBundle)&&!t._isDeferred(e)&&e.isEnabled}),r=["Banner","Shells","LayerList","Site","TabbedToolbar","Footer"];e.sort(function(e,i){return-r.indexOf(e.moduleName)}),e.forEach(function(e){t._getLibraryConfig(e.libraryId);var i=t._getAsyncModuleRoot(e);h([i],function(){})})},o.prototype._loadAsyncLibraries=function(){var s=this,n=this._moduleRecords.filter(function(e){var i=s._getLibraryConfig(e.moduleConfig.libraryId);return!!i&&i.async});if(n.length){var l=function(r){if(!(r>=n.length)){var a=n[r];if(0<a.moduleConfig.moduleDependencies.length){for(var o=!1,e=function(i){var e=n.filter(function(e){return!e.loaded&&!e.deferred&&e.moduleConfig.moduleName===i})[0];if(e){o=!0;var t=n.indexOf(e);t<r&&r--,n.splice(r,0,n.splice(t,1)[0]),s.trace.debug("Delaying initialization of module '"+a.moduleConfig.moduleName+"' to load dependency '"+e.moduleConfig.moduleName+"'")}},i=0,t=a.moduleConfig.moduleDependencies.reverse();i<t.length;i++)e(t[i]);if(o)return void l(r)}if(a&&!a.loaded)if(s._isDeferred(a.moduleConfig)||!1===a.moduleConfig.isEnabled){if(a.deferred=!0,a.moduleConfig.configuration&&!1===a.moduleConfig.isEnabled)return void l(++r);s.waitUntilShellStabilized().then(function(){if(!a.loaded&&(s.trace.debug("Deferring initialization of module '"+a.moduleConfig.moduleName+"'."),s._loadTriggers[a.moduleConfig.moduleName])){for(var e=0,i=s._loadTriggers[a.moduleConfig.moduleName].views;e<i.length;e++){var t=i[e];a.loadTriggers.hasView(t)||a.loadTriggers.views.push(t)}if(a.loadTriggers.commands=s._loadTriggers[a.moduleConfig.moduleName].commands,a.loadTriggers.commands)for(var r=0,o=a.loadTriggers.commands;r<o.length;r++){var n=o[r];s.command(n)}}}),l(++r)}else s._processModule(a).then(function(){return l(++r)});else l(++r)}},i=function(){s._loadTriggers={},s.configuration.deferredModuleLoading=!1,s.trace.warning("The file './Viewer/Resources/moduleDependencies.json' could not be found or loaded. Deferred module loading will not be available.")};this.configuration.deferredModuleLoading?this.fetchConfigResource({url:"./Resources/moduleDependencies.json",load:function(e){try{s._loadTriggers=JSON.parse(e)}catch(e){i()}finally{l(0)}},error:function(e){i(),l(0)}}):(this.configuration.deferredModuleLoading=!1,this._loadTriggers={},l(0))}},o.prototype._determineViewAndRegionDependencies=function(){for(var e=function(i){var n=O.firstOrDefault(d._moduleRecords.filter(function(e){return e.moduleConfig.moduleName===i.moduleName}));if(C.isNullOrUndefined(n))return"continue";n.loadTriggers=new R.DeferredLoadTriggers;for(var e=0,t=i.viewConfigs;e<t.length;e++){var r=t[e];n.loadTriggers.hasView(r.viewId)||n.loadTriggers.views.push(r.viewId),r.regionName&&r.isVisible&&!n.loadTriggers.hasRegion(r.regionName)&&n.loadTriggers.regions.push(r.regionName)}var a=O.firstOrDefault(d.configModel.moduleConfigs.filter(function(e){return"Shells"===e.moduleName}));if(a)for(var o=function(i){if(i.isVisible){var e=O.firstOrDefault(a.viewModelConfigs,function(e){return e.viewModelId===i.viewModelId});if(e&&e.configuration&&e.configuration.ordering)for(var t=0,r=Object.keys(e.configuration.ordering);t<r.length;t++){var o=r[t];-1<n.loadTriggers.views.indexOf(o)&&n.loadTriggers.regions.push(i.regionName)}}},s=0,l=a.viewConfigs;s<l.length;s++)o(l[s])},d=this,i=0,t=this.configModel.moduleConfigs.filter(function(e){return e.deferLoading});i<t.length;i++)e(t[i])},o.prototype._checkForStartupWorkflows=function(){var e=this,i=O.firstOrDefault(this._moduleRecords.filter(function(e){return"Workflow"===e.moduleConfig.moduleName})),t=O.firstOrDefault(this._moduleRecords.filter(function(e){return"WorkflowHost"===e.moduleConfig.moduleName}));if(i&&i.moduleConfig){var r=this.getUrlParameter("run")||this.getUrlParameter("runWorkflow")||this.getUrlParameter("runWorkflowById");C.isNullOrUndefined(r)?i.moduleConfig.configuration&&i.moduleConfig.configuration.startupWorkflows&&i.moduleConfig.configuration.startupWorkflows.length&&(i.moduleConfig.deferLoading=!1):i.moduleConfig.deferLoading=!1}t&&t.moduleConfig&&!1!==t.moduleConfig.isEnabled&&t.moduleConfig.configuration&&t.moduleConfig.configuration.startup&&t.moduleConfig.configuration.startup.length&&this.waitUntilShellStabilized().then(function(){setTimeout(function(){e._loadDeferred([t.moduleConfig.moduleName])})})},o.prototype._loadDeferred=function(s){for(var l=this,t=new Promise(function(n,e){for(var a=0,i=function(i){var t=O.firstOrDefault(l._moduleRecords.filter(function(e){return e.moduleConfig.moduleName===i}));if(t){var r=l.event("ModuleInitializedEvent").subscribe(l,function(e){e===t.moduleConfig.moduleName&&(l.event("ModuleInitializedEvent").unsubscribe(r),l.event("ModuleInitializationFailedEvent").unsubscribe(o),l._addStyles(t.moduleConfig.libraryId,t.moduleConfig.moduleName),t.initialized=!0,++a===s.length&&setTimeout(function(){return n(s)}))}),o=l.event("ModuleInitializationFailedEvent").subscribe(l,function(e){e===t.moduleConfig.moduleName&&(l.event("ModuleInitializedEvent").unsubscribe(r),l.event("ModuleInitializationFailedEvent").unsubscribe(o),t.initialized=!0,++a===s.length&&n(s))});l._processModule(t)}else++a===s.length&&n(s)},t=0,r=s;t<r.length;t++)i(r[t])}),e=function(i){var e=O.firstOrDefault(r._moduleRecords.filter(function(e){return e.moduleConfig.moduleName===i}));e&&(e.loadPromise=t)},r=this,i=0,o=s;i<o.length;i++)e(o[i]);return t},o.prototype._processModule=function(u){var c=this;if(!this._moduleLoadPromise.isResolved())return this._moduleLoadPromise.then(function(){return c._processModule(u)});function f(e,i){i&&(i.message="Subcomponent failed for module '"+e.moduleConfig.moduleName+"': "+i.message,c.trace.error(i.message,i)),e.tasksDone++,e.tasksDone>=e.tasks&&(e.loaded=!0,t(),c._initializeModule(e))}var t=function(){c.configModel.libraryConfigs.filter(function(e){return!!e.async}).forEach(function(i){c._moduleRecords.filter(function(e){return e.moduleConfig.libraryId===i.id}).every(function(e){return e.loaded||e.deferred})&&w.notifyLibraryDownload(i.id)})};return this._moduleLoadPromise=new Promise(function(t){var s=u.moduleConfig,l=s.libraryId+"/modules/"+s.moduleName+"/",e=l+s.moduleName+"Module",d="Mapping/modules/";s.require||(s.require=e),u.tasks=1+2*s.viewConfigs.length+s.viewModelConfigs.length;var r=h.on("error",function(e){e.info&&e.info[0]&&-1<e.info[0].indexOf(s.moduleName)&&(c._disableModuleOnRequireError(e),r.remove(),t())});h([c._getLibraryCacheName(s),c._getModuleCacheName(s)],function(e,i){r.remove(),h([s.require],function(i){if(u.MainClass=i[s.moduleName+"Module"],!u.MainClass||"function"!=typeof u.MainClass){var e=Object.keys(i).filter(function(e){return"function"==typeof i[e]})[0];u.MainClass=i[e]}f(u)},function(e){return f(u,e)}),s.viewConfigs.forEach(function(o,e){var n=u.views[e];function i(){function i(){o.requireMarkup&&h(["dojo/text!/"+o.requireMarkup],function(e){n.viewMarkup=e,f(u)},function(e){return f(u,e)})}h([o.require],function(i){if(n.ViewClass=i[o.viewId],!n.ViewClass){var e=Object.keys(i).filter(function(e){return"function"==typeof i[e]})[0];n.ViewClass=i[e]}f(u)},function(e){return f(u,e)}),o.requireMarkup||(o.requireMarkup=o.markupResource);var e=h.cache["url:/"+o.requireMarkup],t=o.requireMarkup.startsWith(d);if(!e&&t){var r=o.requireMarkup.split("/")[2];c.trace.debug("Requiring '"+s.moduleName+"' to load module '"+r+"', as it needs view markup '"+o.requireMarkup+"'"),h([d+r],function(e){i()})}else i()}o.require||(o.require=l+o.viewId);var t=h.cache[o.require],r=o.require.startsWith(d);if(!t&&r){var a=o.require.split("/")[2];c.trace.debug("Deferring loading of "+s.moduleName+" to load module "+a+" for view "+o.viewId),h([d+a],function(e){i()})}else i()}),s.viewModelConfigs.forEach(function(t,e){var r=u.viewModels[e];t.require||(t.require=l+t.viewModelId),h([t.require],function(i){if(r.ViewModelClass=i[t.viewModelId],!r.ViewModelClass||"function"!=typeof r.ViewModelClass){var e=Object.keys(i).filter(function(e){return"function"==typeof i[e]})[0];r.ViewModelClass=i[e]}f(u)},function(e){return f(u,e)})}),t()})}),this._moduleLoadPromise},o.prototype._addStyles=function(e,i){for(var t=this,r=_.resourceManager.fetchAllFor(e,"css")||[],o=[],n=[],a=0,s=i?r.filter(function(e){return e.name&&-1<e.name.indexOf(i)}):r;a<s.length;a++){var l=s[a];-1<l.name.split("/").pop().toLowerCase().indexOf("common.css")?o.push(l):n.push(l)}o.sort(function(e,i){return e.name.localeCompare(i.name)}),n.sort(function(e,i){return e.name.localeCompare(i.name)});var d=I(o,n),u=[];if(d.forEach(function(e){if(t.shellName){if(-1<e.name.toLowerCase().indexOf("large.css")&&"Desktop"!==t.shellName)return;if(-1<e.name.toLowerCase().indexOf("medium.css")&&"Tablet"!==t.shellName)return;if(-1<e.name.toLowerCase().indexOf("small.css")&&"Handheld"!==t.shellName)return}var i=_.resourceManager.fetch(e.name,e.library);i&&u.push(i)}),0<u.length){var c=document.createElement("style");c.setAttribute("type","text/css"),c.setAttribute("data-injected-stylesheet","");var f=document.createTextNode(u.join(" "));c.appendChild(f);var h=document.head.querySelectorAll("[data-injected-stylesheet]");if(h.length){var g=h.item(h.length-1);document.head.insertBefore(c,g.nextSibling)}else dojo.place(c,document.head,"first")}},o.prototype._initializeLibrary=function(i,e){var t=this;void 0===e&&(e=function(e){return t.trace.error(e.message,e)});var r=this._getLibraryConfig(i);if(!r||!r.async){var o=this.configModel.moduleConfigs.filter(function(e){return e.libraryId===i});this._initializeTraditionalModules(o)}this.initializationCompleteCallback&&(this.onInitializationComplete(),this.initializationCompleteCallback=null)},o.prototype._initializeModule=function(i,a){var s=this;void 0===a&&(a=function(e){s.trace.error(e.message,e),s.event("ModuleInitializationFailedEvent").publish(i.moduleConfig.moduleName)});var l=i.moduleConfig,d=l.libraryId,u=this._getLibraryConfig(d).async;if(!this.moduleManager.moduleIsLoaded(l.moduleName))if(i.MainClass){var e=u?new i.MainClass(this,d):this.moduleManager.instantiate(l.moduleType,l.libraryId);if(e){if(e.initialize){this.trace.info("Initializing module '{0}'.".format(l.moduleName)),this.debugModeActive("time")&&this._debug.timers.startTimingModule(l.moduleName);try{e.id="module-"+d+"-"+l.moduleName,e.initialize(this.translateConfiguration(d,l.configuration)),this.registerFrameworkObject(e),t=e,r=l,s._initialStateAppliedCount++,s.getInitialState(r.moduleName,d).then(function(e){if(e&&"function"==typeof t.applyState)return e.serialVersion||(e.serialVersion=1),t.applyState(e)}).then(function(){return s._onInitialStateApplied(r.moduleName)},function(e){return s._onInitialStateApplied(r.moduleName,e)})}catch(e){return e.message="Error initializing module '"+l.moduleName+"': "+e.message+".",void a(e)}this.moduleManager.markModuleLoaded(l.moduleName,e),this.trace.debug("Module '"+l.moduleName+"' initialized.")}var t,r;i.viewModels.forEach(function(e,i){var t=l.viewModelConfigs[i];if(s._viewModelEntries[t.viewModelId])s.trace.debug("View model '{0}' is defined by module '{1}' but it already exists.".format(t.viewModelId,l.moduleName));else try{var r=u?new e.ViewModelClass(s,d):s.instantiateFrameworkObject(t.typeName,t.libraryId);r.id=t.viewModelId||C.alphaNumericToken(),r.initialize(s.translateConfiguration(d,t.configuration)),s._viewModelEntries[t.viewModelId]=r,s.registerFrameworkObject(r)}catch(e){e.message="Failed to initialize view model '"+t.viewModelId+"': "+e.message,a(e)}}),i.views.forEach(function(e,i){var t=l.viewConfigs[i];if(!s.getFrameworkObjectById(t.viewId)){t=s.translateConfiguration(d,t),u&&t.requireMarkup&&(t.markupResource=t.requireMarkup);var r=null;if(t.viewModelId)if(r=s._viewModelEntries[t.viewModelId])r.libraryId=r.libraryId||d;else{var o=s._allViewModels.filter(function(e){return e.viewModelId===t.viewModelId})[0];if(!o)return void a(new Error("Could not attach view model '"+t.viewModelId+"' to view '"+t.viewId+"' - view model entry not found by ID."));(r=s.instantiateFrameworkObject(o.typeName,o.libraryId)).initialize(o.configuration),s._viewModelEntries[t.viewModelId]=r}else r=new M.ViewModelBase(s,d);if(t.viewModel=r,e.viewMarkup){_.resourceManager.register(d,"inv",t.markupResource,"html",e.viewMarkup);var n=null;e.ViewClass&&(n=u?new e.ViewClass(s,t.libraryId||d):s.viewManager.createView(t)),u&&s.viewManager.createView(t,n),n?s.registerFrameworkObject(n):a(new Error("Could not instantiate view with type '{0}'.".format(t.typeName)))}else a(new Error("Missing markup for view '{0}'.".format(t.viewId)))}}),i.initialized=!0,this.debugModeActive("time")&&this._debug.timers.timeModule(this,l.moduleName)}else a(new Error("Failed module instantiation ("+l.moduleName+")"))}else this.trace.debug("# SKIP MODULE "+i.moduleConfig.moduleName)},o.prototype._initializeTraditionalModules=function(e){for(var u=this,i=function(i){if(c.moduleManager.moduleIsLoaded(i.moduleName))return"continue";var t,e,r=c.translateConfiguration(i.libraryId,i.configuration),o=c.moduleManager.instantiate(i.moduleType,i.libraryId);if(null===o)return c.trace.error("Could not instantiate module with type '{0}' - type not found or constructor failed.".format(i.moduleType)),"continue";if(o.initialize){c.trace.info("Initializing module '{0}'.".format(i.moduleName));try{o.id="module-{0}-{1}".format(i.libraryId,i.moduleName),o.initialize(r),c.registerFrameworkObject(o),t=o,e=i,u._initialStateAppliedCount++,u.getInitialState(e.moduleName,e.libraryId).then(function(e){if(e&&"function"==typeof t.applyState)return o.applyState(e)}).then(function(){return u._onInitialStateApplied(i.moduleName)},function(e){return u._onInitialStateApplied(i.moduleName,e)})}catch(e){return c.trace.error("Error initializing module '{0}': {1}.".format(i.moduleName,e.message),e),"continue"}c.moduleManager.markModuleLoaded(i.moduleName,o),c.trace.debug("Module '{0}' initialized.".format(i.moduleName))}if(i.viewModelConfigs&&0<i.viewModelConfigs.length)for(var n=0,a=i.viewModelConfigs;n<a.length;n++){var s=a[n];if(c._viewModelEntries[s.viewModelId])c.trace.debug("View model '{0}' is defined by module '{1}' but it already exists.".format(s.viewModelId,i.moduleName));else{var l=null;try{(l=c.instantiateFrameworkObject(s.typeName,s.libraryId)).id=s.viewModelId||C.alphaNumericToken();var d=c.translateConfiguration(i.libraryId,s.configuration);l.initialize(d),c._viewModelEntries[s.viewModelId]=l,c.registerFrameworkObject(l)}catch(e){c.trace.error("Could not create view model with type '{0}' - type was not found, not a view model, or failed to construct: {1}".format(s.typeName,e.message),e)}}}},c=this,t=0,r=e;t<r.length;t++)i(a=r[t]);for(var o=0,n=e;o<n.length;o++){var a;if((a=n[o]).viewConfigs)for(var s=0,l=a.viewConfigs;s<l.length;s++){var d=l[s];if(!this.getFrameworkObjectById(d.viewId)){var f=this.translateConfiguration(a.libraryId,d),h=null;f.viewModelId?(h=this._viewModelEntries[f.viewModelId])?h.libraryId=h.libraryId||a.libraryId:this.trace.error("Could not attach view model '{0}' to view '{1}' - view model not found.".format(f.viewModelId,f.viewId)):h=new M.ViewModelBase(this,a.libraryId),f.viewModel=h;var g=this.viewManager.createView(f);g?this.registerFrameworkObject(g):this.trace.warning("Could not instantiate view with type '{0}'.".format(f.typeName))}}}},o.prototype.injectLibraryResources=function(e,i,t){return t=t.toLowerCase(),!1===this._resourceDictionaries.hasOwnProperty(t)?(this._resourceDictionaries[t]={},void(this._resourceDictionaries[t][e]=i)):void(!1===this._resourceDictionaries[t].hasOwnProperty(e)?this._resourceDictionaries[t][e]=i:dojo.mixin(this._resourceDictionaries[t][e],i))},o.prototype.instantiateFrameworkObject=function(i,e){for(var t=i.split("."),r=window,o=0;o<t.length&&"object"==typeof r;o++)r=r[t[o]];var n=null;if("function"==typeof r&&(n=new r(this,e)),!n)try{n=new(dojo.getObject(i))(this,e)}catch(e){this.trace.error("Could not instantiate object of type '{0}': '{1}'".format(i,e),e)}return n},o.prototype.includeScript=function(i,t,r){var o=this,e={url:i,preventCache:this.debugMode,load:function(e){try{t&&t(e)}catch(e){o.trace.error("Error while including script '{0}': {1}".format(i,e),e),r&&r(e)}},error:function(e){o.trace.error("Error while including script '{0}': {1}".format(i,e),e),0<o._pendingLibraryDownloads&&o._pendingLibraryDownloads--,o._doIfNoPendingLibraryDownloads(),r&&r(e)}};dojo.io.script.get(e)},o.prototype.processConfiguration=function(e){var o=this;if(this.configuration=e.application||{},this.configModel=e,this.eventRegistry.event("AppConfigLoaded").publish(this.configModel),this.eventRegistry.event("ApplicationConfigLoadedEvent").publish(this.configModel),this.configuration&&this.configuration.locale&&(this.locale=this.configuration.locale),this.urlParameters&&this.getUrlParameter("locale")&&(this.locale=this.getUrlParameter("locale")),!1===this.configuration.deferredModuleLoading&&this.trace.info("Deferred module loading is disabled in configuration. All configured and enabled modules will be loaded during viewer initialization."),dojo.locale=this.locale,this._pendingLocaleDownloads=e.externalLocaleReferences.length,this._establishRecords(),this._determineViewAndRegionDependencies(),this._checkForStartupWorkflows(),0===this._pendingLocaleDownloads)this._download();else for(var i=function(i,e){try{if(e)if(e.hasOwnProperty("locales")){for(var t in e)if(e.hasOwnProperty(t)){var r=e[t];o.injectLibraryResources(i.libraryId,r,t)}}else{if(!i.hasOwnProperty("locale"))throw new Error("Locale reference missing 'locale' identifier.");o.injectLibraryResources(i.libraryId,e,i.locale)}else o.trace.warning("Error loading locale '{0}' for library '{1}' from offline storage.".format(i.locale,i.libraryId))}catch(e){o.trace.error("Error fetching external locale resource {0}: {1}".format(i.uri,e.message),e)}finally{--o._pendingLocaleDownloads,o._pendingLocaleDownloads<1&&o._download()}},t=0,r=e.externalLocaleReferences;t<r.length;t++)!function(r){var e={url:r.uri,handleAs:"json",load:function(e){return i(r,e)},error:function(e){return i=r,t=e,o.trace.error("Error fetching external locale resource {0}: {1}".format(i.uri,t.message),t),--o._pendingLocaleDownloads,void(o._pendingLocaleDownloads<1&&o._download());var i,t}};o.fetchConfigResource(e)}(r[t])},o.prototype.addNativeReadyFunction=function(e){if("undefined"!=typeof gcxNativeReady)e&&e();else{var i=gcxNativeReadyCallback;gcxNativeReadyCallback=function(){i&&i(),e&&e()}}},o.prototype.getInitialState=function(e,i){return new t.SimplePromise(function(e,i){return e(null)})},o.prototype._onInitialStateApplied=function(e,i){this._initialStateAppliedCount--,i&&this.trace.error('Error setting initial state for module "{0}": {1}'.format(e,i.message),i),this.allLibrariesLoaded&&this._initialStateAppliedCount<=0&&this.initialStateAppliedCallback&&this.initialStateAppliedCallback(this)},o.prototype.fetchConfigResource=function(e){var i=document.createElement("a");try{i.href=e.url,i.style.display="none",document.body.appendChild(i);var t=geocortex._configDomains;if(!i.hostname||["protocol","hostname"].every(function(e){return i[e]===window.location[e]})||t&&!0===t[i.protocol+"//"+i.hostname])return dojo.xhrGet(e);var r=new Error("Could not load viewer because the specified configuration file is not on the same domain as the viewer ({0}).".format(e.url));throw r.name="ConfigurationDomainMismatch",r}finally{document.body.removeChild(i)}},o.prototype._traceEventListener=function(e){this._stashLog?this._stashedLogs.push(e):this.eventRegistry.event("TraceEvent").unsubscribe(this._traceEventListenerHandle)},o.prototype._getDebugLocaleString=function(e){for(var i=[9728,9983],t=[],r=0;r<e.length;++r)t.push(Math.floor(Math.random()*(i[1]-i[0]))+i[0]);return String.fromCharCode.apply(String,t)},o.prototype._awaitModulesImpl=function(e){for(var t=this,r=[],i=[],o=[],n=0,a=e;n<a.length;n++)if((h=a[n]).moduleConfig.moduleDependencies&&0<h.moduleConfig.moduleDependencies.length)for(var s=function(i){var e=O.firstOrDefault(l._moduleRecords.filter(function(e){return t._canBeLoaded(e)&&e.moduleConfig.moduleName===i}));e&&o.push(e)},l=this,d=0,u=h.moduleConfig.moduleDependencies;d<u.length;d++)s(u[d]);0<o.length&&e.unshift.apply(e,o);for(var c=0,f=e;c<f.length;c++){var h;(h=f[c])&&(h.loadPromise&&!h.loadPromise.isResolved()&&-1===r.indexOf(h.loadPromise)?r.push(h.loadPromise):i.push(h.moduleConfig.moduleName))}return 0<i.length&&r.push(this._loadDeferred(i)),0<r.length?new Promise(function(i,e){Promise.all(r).then(function(e){return i(e)}).catch(function(e){t.trace.debug("Error loading deferred modules: "+e.message),i(null)})}):Promise.resolve(null)},o.prototype._isDeferred=function(e){return!1!==this.configuration.deferredModuleLoading&&("Native"!==e.moduleName&&"Offline"!==e.moduleName||!this.isNative.get())&&!!e.deferLoading},o.prototype._findUnloadedModulesForCommand=function(i){var t=this;return this._moduleRecords.filter(function(e){return t._canBeLoaded(e)&&e.loadTriggers.hasCommand(i)})},o.prototype._findUnloadedModuleForView=function(i){var t=this;return O.firstOrDefault(this._moduleRecords,function(e){return t._canBeLoaded(e)&&e.loadTriggers.hasView(i)})},o.prototype._findUnloadedModulesForRegion=function(i){var t=this;return this._moduleRecords.filter(function(e){return t._canBeLoaded(e)&&e.loadTriggers.hasRegion(i)})},o.prototype._canBeLoaded=function(e){return e.loadTriggers&&e.deferred&&(!e.loaded||e.loadPromise&&!e.loadPromise.isResolved())},o.prototype._disableModuleOnRequireError=function(e){if(e&&e.info&&e.info[0]){var i=e.info[0],t=/Resources\/Compiled\/([a-zA-Z]+)\.js/.exec(i),r=null;if(t&&t[1]&&(r=t[1]),!C.isNullOrUndefined(r)){var o=O.firstOrDefault(this._moduleRecords.filter(function(e){return e.moduleConfig.moduleName===r}));return o&&!o.loaded&&(this.trace.error("An error occurred when requiring the module '"+r+"'. This module will be unavailable"),this.event("ModuleInitializationFailedEvent").publish(r),o.loaded=!0),!0}var n=O.firstOrDefault(this.configModel.libraryConfigs.filter(function(e){return e.id===i+"!"}));return!C.isNullOrUndefined(n)&&(this.trace.error("The library at "+i+" could not be downloaded successfully. Functionality provided by this library will be unavailable."),0<this._pendingLibraryDownloads&&--this._pendingLibraryDownloads,this.configModel.libraryConfigs.splice(this.configModel.libraryConfigs.indexOf(n),1),this._doIfNoPendingLibraryDownloads(),!0)}},o.prototype.pendingModulesForCommand=function(e){return this._findUnloadedModulesForCommand(e).map(function(e){return e.moduleConfig.moduleName})},o.prototype.awaitModulesForCommand=function(e){return this._awaitModulesImpl(this._findUnloadedModulesForCommand(e))},o.prototype.awaitModuleForView=function(e){return this._awaitModulesImpl([this._findUnloadedModuleForView(e)])},o.prototype.loadModulesForRegion=function(e){this._awaitModulesImpl(this._findUnloadedModulesForRegion(e))},o.prototype.awaitModules=function(i){var e=this._moduleRecords.filter(function(e){return-1<i.indexOf(e.moduleConfig.moduleName)});return this._awaitModulesImpl(e)},o.prototype.hasDeferredModule=function(i){var e=O.firstOrDefault(this._moduleRecords.filter(function(e){return e.moduleConfig.moduleName===i}));return e&&!e.loaded&&e.deferred},o.prototype.debugModeActive=function(e){return("all"===this.debugMode||-1<this.debugMode.toString().indexOf(e))&&(-1<e.toString().indexOf("time")?!!(this._internalDebugEnabled&&performance&&performance.mark&&performance.measure&&performance.getEntriesByName):!(-1<e.toString().indexOf("binding")&&!this._internalDebugEnabled))},o.prototype.getStashedLogs=function(){return this._stashLog=!1,this._stashedLogs},o.prototype.waitUntilAllLibrariesLoaded=function(){var t=this;return new Promise(function(i,e){t.allLibrariesLoaded?i():t.event("ViewerLibrariesDownloadedEvent").once(t,function(e){i()})}).catch(function(e){e.message&&t.trace.error(e.message)})},o.prototype.waitUntilShellStabilized=function(){var t=this;return new Promise(function(i,e){t._hasShell?t._shellStabilized?i():t.event("_shellStabilizedEvent").once(t,function(e){i()}):t.waitUntilAllLibrariesLoaded().then(function(){return i()})}).catch(function(e){e.message&&t.trace.error(e.message)})},o);function o(e,i,t,r,o){var n=this;void 0===o&&(o=!1),this.version="4.13",this.allowCrossDomainConfig=!1,this.configuration={},this.localServerAddress="",this.localServerToken=null,this.localServerNamespace=null,this.urlParameters={},this.developmentMode=!1,this.isHttpsMode=!1,this.isShuttingDown=!1,this.allLibrariesLoaded=!1,this.configPreprocessor=null,this.modalRegionSingleton=null,this._resourceDictionaries={},this._hasShell=!1,this._shellStabilized=!1,this._debug={},this._internalDebugEnabled=!1,this._moduleRecords=[],this._viewModelEntries={},this._frameworkObjects={},this._pendingFrameworkObjectRequests={},this._initialStateAppliedCount=0,this._stashLog=!0,this._stashedLogs=[],this._moduleLoadPromise=Promise.resolve(),this._getLibraryCacheName=function(e){var i=n._getLibraryConfig(e.libraryId);return i&&i.async&&i.bundleUri?n.performTokenReplacement(i.bundleUri):"dojo/ready"},this._getModuleCacheName=function(e){var i=n._getLibraryConfig(e.libraryId);return i&&i.async&&(i.loadModulesBundle||e.overrideLoadBundle)?n._getAsyncModuleRoot(e):"dojo/ready"},this.debugMode=o;var a=geocortex.framework.debug;a&&a.DebugObservables&&a.DebugMeta&&a.DebugTimers&&a.DebugTrace&&(this._internalDebugEnabled=!0,this._debug.obs=a.DebugObservables,this._debug.meta=a.DebugMeta,this._debug.timers=a.DebugTimers,this._debug.trace=a.DebugTrace),this.debugModeActive("time")&&this._debug.timers.startTimingViewer(),this.debugModeActive("binding")&&this._debug.obs.patchObservables(this),this.id=t||"default",this.configTokens=r||{},this.trace=new c.Trace(this),this.commandRegistry=new g.CommandRegistry(this),this.eventRegistry=new m.EventRegistry(this),this.behaviorRegistry=new p.BehaviorRegistry(this),this.command=dojo.hitch(this.commandRegistry,this.commandRegistry.command),this.event=dojo.hitch(this.eventRegistry,this.eventRegistry.event),this.behavior=dojo.hitch(this.behaviorRegistry,this.behaviorRegistry.behavior),this._traceEventListenerHandle=this.eventRegistry.event("TraceEvent").subscribe(this,this._traceEventListener),this.moduleManager=new f.ModuleManager(this),this.viewManager=new y.ViewManager(this),this._hostElement=i||dojo.body(),this.store=new v.Store(this,this.id),this.store.initialize(),null==e?this.configModel=new d.ConfigurationModel(this):"object"==typeof e?(this._configObject=e,this.configUri=null):(this.configModel=null,this.configUri=e.trim()),this.isOffline=new u.Observable(!1),this.isOffline.bind(this,function(e){e?this.eventRegistry.event("ApplicationOfflineEvent").publish():this.eventRegistry.event("ApplicationOnlineEvent").publish()}),this.isNative=new u.Observable(!1),this.isNative.bind(this,function(e){e?this.eventRegistry.event("ApplicationNativeReadyEvent").publish():this.eventRegistry.event("ApplicationNativeRemovedEvent").publish()}),b.ApplicationCommands.createCommands(this);var s=document.URL,l=s.substring(s.indexOf("?")+1,s.length);this.urlParameters=dojo.queryToObject(l)||{},this.host=L.getHost(),this.isHttpsMode=L.isHttpsUri(this.host),this._detectBrowserLocale(),this._requireErrorHandlerHandle=h.on("error",function(e){n._handleRequireError(e)}),w.registerApplication(this)}e.Application=i})},"geocortex/framework/application/ApplicationCommands":function(){define(["require","exports"],function(e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var t=(r.createCommands=function(e){},r);function r(){}i.ApplicationCommands=t})},"geocortex/framework/application/DeferredLoadTriggers":function(){define(["require","exports"],function(e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var t=(r.prototype.hasView=function(e){return this.views&&-1<this.views.indexOf(e)},r.prototype.hasCommand=function(e){return this.commands&&-1<this.commands.indexOf(e)},r.prototype.hasRegion=function(e){return this.regions&&-1<this.regions.indexOf(e)},r);function r(e,i,t){this.views=e||[],this.commands=i||[],this.regions=t||[]}i.DeferredLoadTriggers=t})},"geocortex/framework/application/ModuleBase":function(){var r,s=this&&this.__extends||(r=function(e,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var t in i)i.hasOwnProperty(t)&&(e[t]=i[t])})(e,i)},function(e,i){function t(){this.constructor=e}r(e,i),e.prototype=null===i?Object.create(i):(t.prototype=i.prototype,new t)});define(["require","exports","./../FrameworkObject","./../SimplePromise"],function(e,i,t,r){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o,n=(o=t.FrameworkObject,s(a,o),a.prototype.initialize=function(e){this.configuration=e,this.behaviorNames=this.app.behaviorRegistry.loadBehaviorsFromConfig(this,e)},a.prototype.onDestroy=function(){o.prototype.onDestroy.call(this),this.app.trace.debug("module onDestroy: "+this.id);for(var e=this.behaviorNames.length-1;0<=e;e--)this.app.behaviorRegistry.remove(this.behaviorNames[e]);this.behaviorNames.length=0},a.prototype.shutdown=function(e){},a.prototype.exportState=function(){return new r.SimplePromise(function(e,i){return e(null)})},a.prototype.applyState=function(e){return new r.SimplePromise(function(e,i){return e()})},a.prototype.getStateFilter=function(){return null},a);function a(e,i){var t=o.call(this,e,i)||this;return t.behaviorNames=[],t.configuration={},t}i.ModuleBase=n})},"geocortex/framework/application/ModuleManager":function(){define(["require","exports"],function(e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var t=(r.prototype.shutdown=function(e){for(var i in this._modules)this._modules.hasOwnProperty(i)&&(this._modules[i].shutdown(e),this._modules[i].destroy());this._modules={}},r.prototype.instantiate=function(e,i){return null==e?null:this.app.instantiateFrameworkObject(e,i)},r.prototype.markModuleLoaded=function(e,i){this._modules[e]=i,this.app.event("ModuleInitializedEvent").publish(e)},r.prototype.moduleIsLoaded=function(e){return null!=this._modules[e]},r.prototype.notifyModuleLoaded=function(i,t){if(this.moduleIsLoaded(i)&&null!=t)t(i);else var r=this.app.event("ModuleInitializedEvent").subscribe(this,function(e){if(e==i)try{t(e)}finally{this.app.event("ModuleInitializedEvent").unsubscribe(r)}})},r);function r(e){this._modules={},this.app=e}i.ModuleManager=t})},"geocortex/framework/application/ResourceManager":function(){define(["require","exports","./../utils/utils"],function(d,e,u){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=(t.prototype.fetch=function(e,i,t){var r=i+"-"+(t=t||"inv")+"-"+e;if(this.cachedResources.hasOwnProperty(r))return this.cachedResources[r];var o=d.cache,n=window.location.pathname;/\/$/.test(n)||(n+="/");var a="url:/"+e;if(null!=o[a])return o[a];var s=this.findResource(e,i,t);if(!s)return null;var l=null;switch(s.format){case"css":case"html":l="<"!==(s.data||"").trim().charAt(0)?u.base64Decode(s.data):s.data,this.cachedResources[r]=l;break;case"json":l=u.base64Decode(s.data),l=JSON.parse(l),this.cachedResources[r]=l;break;default:return null}return l},t.prototype.fetchAllFor=function(e,i){for(var t=[],r=0;r<this.resources.length;++r){var o=this.resources[r];if(o.library==e){if(null!=i&&o.format!=i)continue;t.push(o)}}return t},t.prototype.register=function(e,i,t,r,o){if(!this.findResource(t,e)){var n={};n.name=t,n.library=e,n.locale=i,n.format=r,n.data=o,this.resources.push(n)}},t.prototype.remove=function(e,i,t){var r=this.findResource(i,e,t);if(null==r)return!1;Array.removeItem(this.resources,r);var o=e+"-"+t+"-"+i;return this.cachedResources.hasOwnProperty(o)&&delete this.cachedResources[o],!0},t.prototype.injectTheme=function(e){this.themesToInject.push(e)},t.prototype.performThemeInjection=function(){for(var e=dojo.query("head")[0],i=0;i<this.themesToInject.length;++i){var t=dojo.create("link",{rel:"stylesheet",href:this.themesToInject[i]});dojo.place(t,e,"last")}},t.prototype.findResource=function(e,i,t){t=t||"inv";for(var r=0;r<this.resources.length;++r){var o=this.resources[r];if(o.name==e){if(null!=i&&o.library!=i)continue;if(o.locale==t)return o}}return null},t);function t(){this.resources=[],this.cachedResources={},this.themesToInject=[]}e.ResourceManager=i})}}});require({cache:{"geocortex/framework/behaviors/Behavior":function(){define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(o.prototype.run=function(t){var i=this;-1===this._queuedContexts.indexOf(t)&&(this._queuedContexts.push(t),setTimeout(function(){var e=i._queuedContexts.indexOf(t);-1<e&&i._queuedContexts.splice(e,1),i._executeCommands(t)}))},o.prototype._wireUpEvent=function(){var t=this;this.event&&(this.eventToken=this.app.event(this.event).subscribe(this,function(e){t._executeCommands(e)}))},o.prototype._executeCommands=function(e){for(var t=0;this.commands&&t<this.commands.length;t++)this.app.command(this.commands[t]).execute(e)},o.prototype.destroy=function(){this.event&&this.app.event(this.event).unsubscribe(this.eventToken),this.commands=null},o);function o(e,t,i,o){this._queuedContexts=[],this.app=e,this.name=t,this.event=o,this.commands=i||[],this._wireUpEvent()}t.Behavior=i})},"geocortex/framework/behaviors/BehaviorRegistry":function(){define(["require","exports","./Behavior","./../application/ModuleBase"],function(e,t,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(o.prototype.loadBehaviorsFromConfig=function(e,t){var i=[];if(!(e instanceof s.ModuleBase))return this.app.trace.warning("Attempted to add behaviors to registry outside of ModuleBase. Behaviors from "+e.id+" not added."),i;if(t&&t.behaviors)for(var o=0;o<t.behaviors.length;o++){var r=t.behaviors[o];i.push(r.name),this.addBehavior(r.name,r.commands,r.event)}return i},o.prototype.addBehavior=function(e,t,i){if(t){this.behaviors[e]&&this.app.trace.warning("Behavior "+e+" is already present in registry."),e||this.app.trace.warning("Attempted to add a nameless Behavior to the registry.");var o=new r.Behavior(this.app,e,t,i);this.behaviors[e]=o}else this.app.trace.debug("Behavior "+e+" does not possess an array of command IDs. Not added to registry.")},o.prototype.remove=function(e){if(!this.behaviors[e])return this.app.trace.debug("Attempted to remove behavior not in found in registry."),!1;var t=this.behaviors[e];return delete this.behaviors[e],t.destroy(),!0},o.prototype.behavior=function(e){var t=null;return void 0!==this.behaviors[e]?t=this.behaviors[e]:(t=this.dummyBehavior,this.app.trace.debug("Could not find Behavior named "+e+" in the Behavior Registry.")),t},o);function o(e){this.behaviors={},this.dummyBehavior=new r.Behavior(null,null,null),this.app=e}t.BehaviorRegistry=i})},"geocortex/framework/behaviors/Behaviors":function(){define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})},"geocortex/framework/behaviors/TypedBehavior":function(){define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})}}});require({cache:{"geocortex/framework/Behaviors":function(){define(["require","exports"],function(e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0})})}}});require({cache:{"geocortex/framework/commands/Command":function(){define(["require","exports","./../events/Event","./../utils/utils","./../FrameworkObject"],function(e,t,i,s,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t,n){this.impl=e,this.scope=t,this.canExecute=n},n=(a.prototype.raiseCanExecuteChanged=function(){this.canExecuteChanged.publish()},a.prototype.canExecute=function(e){var t=this,n=this.app.pendingModulesForCommand(this.name);if(!this.app.isShuttingDown&&0<n.length&&(this.app.awaitModulesForCommand(this.name).then(function(e){e&&t.raiseCanExecuteChanged()}),this.isWrapper&&-1<n.indexOf("WorkflowHost")))return!0;if(this.isWrapper)return!1;for(var i in this._entries)if(this._entries.hasOwnProperty(i)){var a=this._entries[i];if(a.canExecute&&a.canExecute.apply(a.scope,arguments)){if("any"===this.canExecuteMode)return!0}else if("all"===this.canExecuteMode)return this._traceDebug("Command '"+this.name+"' failed an 'all' canExecute check"),!1}return"any"!==this.canExecuteMode||(this._traceDebug("Command '"+this.name+"' failed an 'any' canExecute check"),!1)},a.prototype.execute=function(e){var t=this,n=arguments;if(!this.app.isShuttingDown&&0<this.app.pendingModulesForCommand(this.name).length)this.app.awaitModulesForCommand(this.name).then(function(){return t.execute.apply(t,n)});else{var i=!1;if(this._entries)for(var a in this._entries)if(this._entries.hasOwnProperty(a)){i=!0;break}if(i){if("all"!==this.canExecuteMode||this.canExecute.apply(this,n)){for(var a in this._traceDebug("Command "+this.name+" executed"),this.preExecute.publish.apply(this.preExecute,n),this._entries)if(this._entries.hasOwnProperty(a)){var s=this._entries[a];"any"===this.canExecuteMode&&!s.canExecute.apply(s.scope,n)||s.impl.apply(s.scope,n)}this.postExecute.publish.apply(this.postExecute,n)}}else this._traceDebug("Command "+this.name+" executed but no implementation registered.")}},a.prototype.register=function(e,t,n){this.isWrapper=!1;var i=s.alphaNumericToken(),a=new o(t,e,n||this.defaultCanExecuteFunction);return this._entries[i]=a,e&&e instanceof r.FrameworkObject&&e.trackCommandHandler(this,i),this._traceDebug("Registered an implementation for command '"+this.name+"'."),this.raiseCanExecuteChanged(),i},a.prototype.defaultCanExecuteFunction=function(){return!0},a.prototype.unregister=function(e){return this.isWrapper=!1,!!this._entries.hasOwnProperty(e)&&(delete this._entries[e],this._traceDebug("Unregistered an implementation for command '"+this.name+"'."),this.raiseCanExecuteChanged(),!0)},a.prototype.clear=function(){this._entries={},this.app.isShuttingDown||this.raiseCanExecuteChanged(),this._traceDebug("Cleared all implementations of command '"+this.name+"'.")},a.prototype._traceDebug=function(e){this.app&&this.app.debugMode&&(this.app._internalDebugEnabled?this.app._debug.trace.traceCommand(this.app,e):this.app.trace.command(e))},a);function a(e,t,n){this._entries={},this.app=null,this.name=e,this.app=t,this.isWrapper=!0,this.canExecuteChanged=new i.Event("{0}.CanExecuteChanged".format(e)),this.preExecute=new i.Event("{0}.PreExecute".format(e)),this.postExecute=new i.Event("{0}.PostExecute".format(e)),this.canExecuteMode=null!=n?n:"all"}t.Command=n})},"geocortex/framework/commands/CommandRegistry":function(){define(["require","exports","./Command"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(a.prototype.clear=function(){for(var e in this.commands)this.commands.hasOwnProperty(e)&&this.commands[e].clear()},a.prototype.command=function(e){var t=this.commands[e];if(t)return t;var n=new i.Command(e,this.app);return n.isWrapper=!0,this.commands[n.name]=n},a);function a(e){this.commands={},this.app=e}t.CommandRegistry=n})},"geocortex/framework/commands/TypedCommand":function(){define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})}}});require({cache:{"geocortex/framework/commands":function(){define(["require","exports"],function(e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0})})}}});require({cache:{"geocortex/framework/config/ConfigurationLoader":function(){define(["require","exports","./../config"],function(e,i,a){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=(r.prototype.loadConfigurationTree=function(e,i){var o=this;if(this._targetConfigUri=e,n(this._targetConfigUri)){var r=new Error("Configuration cannot be loaded from this location.");this.app.event("ConfigurationLoadFailedEvent").publish(r)}else this.app.fetchConfigResource({url:this._targetConfigUri,load:function(e){null!=i&&null!=i&&i(e)},error:function(e){return o.app.event("ConfigurationLoadFailedEvent").publish(e)}})},r);function r(e){this._targetConfigUri=null,this.app=e}function n(e){var o=[-1399014851,-706512510];a._nonConfigs&&0<a._nonConfigs.length&&(o=a._nonConfigs.map(function(e){return String.quickHashCode(e.toLowerCase())}));var i=document.createElement("a");for(i.href=e.toLowerCase(),e=i.href,e=decodeURIComponent(e);-1<e.indexOf("%");)e=decodeURIComponent(e);var r=(e=e.replace(/[\\\/:]+/g,"/")).split(/[\\\/:]/),n=(r.length,r.map(function(e){return e.toLowerCase()}).map(function(e,i){return i<r.length-1?[e,r[i+1]]:null}));n.pop();var t=!1;return n.forEach(function(e){var i=String.quickHashCode(e[0]+"/"+e[1]);-1<o.indexOf(i)&&(t=!0)}),t}i.ConfigurationLoader=o,i.checkList=n})},"geocortex/framework/config/ConfigurationModel":function(){define(["require","exports","./LibraryConfig","./ModuleConfig","./WidgetConfig","./ViewConfig","./ViewModelConfig"],function(e,i,I,L,k,_,x){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=(r.prototype.parse=function(e,i){var o,r,n,t="object"==typeof e?e:JSON.parse(e);t.configuration||(t.configuration={version:"1.0",viewerId:"unknown",application:{},defaultLibraryId:"",libraries:[],modules:[],widgets:[]});try{this.application=t.configuration.application||{},this.version=t.configuration.version||"1.0",this.viewerId=t.configuration.viewerId||"unknown",this.defaultLibraryId=t.configuration.defaultLibraryId||null,o=t.configuration.libraries||[],r=t.configuration.modules||[],n=t.configuration.widgets||[],this.app.trace.debug("Config version: {0}.".format(this.version))}catch(e){return void this.app.trace.error("Error reading configuration: {0}".format(e),e)}if(o&&0<o.length)for(var a=0;a<o.length;++a){var s=o[a];s=this.app.translateConfiguration(s.id,s),null==this.defaultLibraryId&&(this.defaultLibraryId=s.id);var u=new I.LibraryConfig(s.id,s.uri);if(u.position=a,u.omitStyles=s.omitStyles||!1,u.async=!0===s.async,u.location=s.location||u.id,u.bundleUri=s.bundleUri,u.packageName=s.packageName,u.libraryDependencies=s.libraryDependencies,u.loadModulesBundle=void 0!==s.loadModulesBundle?s.loadModulesBundle:!0===s.async,this.libraryConfigs.push(u),this.libraryModules[s.id]=[],s.locales)for(var l=0;l<s.locales.length;++l){var d=s.locales[l];d.locale=d.locale.toLowerCase(),d.hasOwnProperty("uri")&&(d.libraryId=s.id,u.locales.push(d),this.externalLocaleReferences.push(d))}}if(r&&0<r.length)for(l=0;l<r.length;++l){var f=r[l],c=f.libraryId;c=c||this.defaultLibraryId;var g=new L.ModuleConfig(f.moduleName,f.moduleType,f.configuration,c);g.require=f.require,g.deferLoading=!!f.deferLoading,g.isEnabled=!(!1===f.isEnabled),g.moduleDependencies=Array.isArray(f.moduleDependencies)?f.moduleDependencies:[],g.overrideLoadBundle=void 0!==f.overrideLoadBundle&&f.overrideLoadBundle,this.libraryModules[c]?this.libraryModules[c].push(g):this.app.trace.error("Unknown library '{0}'.".format(c));var h=f.views;if(h)for(var p=0;p<h.length;++p){var v=h[p],y=v.type||"geocortex.framework.ui.ViewBase",C=new _.ViewConfig(v.id,f.moduleName,y);g.viewConfigs.push(C),C.libraryId=v.libraryId||c,this.libraryConfigs.filter(function(e){return e.id===C.libraryId})[0],C.viewModelId=v.viewModelId||null,C.markupResource=v.markup||null,C.configuration=v.configuration||{},C.regionName=v.region||null,C.isManaged=v.isManaged||!1,C.isVisible=v.visible||!1,C.title=v.title||null,C.description=v.description||"",C.iconUri=v.iconUri||"",C.require=v.require||"",C.requireMarkup=v.requireMarkup}var b=f.viewModels;if(b)for(p=0;p<b.length;++p){var m=b[p],w=new x.ViewModelConfig(m.id,f.moduleName,m.type);g.viewModelConfigs.push(w),w.libraryId=m.libraryId||c,m.configuration&&(w.configuration=m.configuration),w.require=m.require}this.moduleConfigs.push(g)}if(n&&0<n.length)for(a=0;a<n.length;++a){var M=new k.WidgetConfig(n[a].id,n[a].libraryId||this.defaultLibraryId);dojo.safeMixin(M,n[a]),this.widgetConfigs.push(M)}i&&i(this)},r);function r(e){this.application={},this.version="unknown",this.viewerId="unknown",this.defaultLibraryId="",this.globals=null,this.libraryConfigs=[],this.moduleConfigs=[],this.widgetConfigs=[],this.libraryModules={},this.externalLocaleReferences=[],this.app=e}i.ConfigurationModel=o})},"geocortex/framework/config/LibraryConfig":function(){define(["require","exports"],function(e,i){"use strict";function o(e,i){this.loadModulesBundle=!0,this.locales=[],this.position=0,this.omitStyles=!1,this.id=e,this.uri=i}Object.defineProperty(i,"__esModule",{value:!0}),i.LibraryConfig=o})},"geocortex/framework/config/ModuleConfig":function(){define(["require","exports"],function(e,i){"use strict";function o(e,i,o,r){this.moduleDependencies=[],this.overrideLoadBundle=!1,this.viewConfigs=[],this.viewModelConfigs=[],this.moduleName=e,this.moduleType=i,this.configuration=o,this.libraryId=r}Object.defineProperty(i,"__esModule",{value:!0}),i.ModuleConfig=o})},"geocortex/framework/config/ViewConfig":function(){define(["require","exports"],function(e,i){"use strict";function o(e,i,o){this.viewId=e,this.moduleName=i,this.typeName=o}Object.defineProperty(i,"__esModule",{value:!0}),i.ViewConfig=o})},"geocortex/framework/config/ViewModelConfig":function(){define(["require","exports"],function(e,i){"use strict";function o(e,i,o){this.libraryId="",this.configuration={},this.viewModelId=e,this.moduleName=i,this.typeName=o}Object.defineProperty(i,"__esModule",{value:!0}),i.ViewModelConfig=o})},"geocortex/framework/config/WidgetConfig":function(){define(["require","exports"],function(e,i){"use strict";function o(e,i){this.viewModelType=null,this.configuration={},this.typeName="",this.markup="",this.id=e,this.libraryId=i}Object.defineProperty(i,"__esModule",{value:!0}),i.WidgetConfig=o})}}});require({cache:{"geocortex/framework/config":function(){define(["require","exports"],function(e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o._nonConfigs=[]})}}});require({cache:{"geocortex/framework/dependencies":function(){}}});require({cache:{"geocortex/framework/events/CollectionChangedArgs":function(){define(["require","exports"],function(e,t){"use strict";function n(){this.sender=null,this.type="append",this.rangeStart=0,this.rangeEnd=0}Object.defineProperty(t,"__esModule",{value:!0}),t.CollectionChangedArgs=n})},"geocortex/framework/events/Event":function(){define(["require","exports","./../utils/utils","./../FrameworkObject"],function(e,t,s,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t){this.handler=e,this.scope=t,this.once=!1},n=(i.prototype.getSubscriptionHandlerByToken=function(e){return this.subscriptions.hasOwnProperty(e)?this.subscriptions[e].handler:null},i.prototype.subscribe=function(e,t){if(null==t)throw new Error("Event handler cannot be null or undefined");for(var n;n=s.alphaNumericToken(),this.getSubscriptionHandlerByToken[n];);var i=new o(t,e);return this.subscriptions[n]=i,e&&e instanceof r.FrameworkObject&&e.trackSubscription(this,n),this._traceSubscribeEvent("Subscription '"+n+"' to event '"+this.name+"' created",this.name,n),n},i.prototype.once=function(e,t){var n=this.subscribe(e,t);return this.subscriptions[n].once=!0,n},i.prototype.unsubscribe=function(e){return!!this.subscriptions.hasOwnProperty(e)&&(delete this.subscriptions[e],this._traceUnsubscribeEvent("Event unsubscribed. Subscription '"+e+"' on event '"+this.name+"' removed",this.name,e),!0)},i.prototype.clear=function(){this.subscriptions={}},i.prototype.publish=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._tracePublishEvent("Event '"+this.name+"' published",arguments),this.isPublishing=!0;var n={};for(var i in this.subscriptions)this.subscriptions.hasOwnProperty(i)&&(n[i]=this.subscriptions[i]);for(var i in n)if(n.hasOwnProperty(i)){var s=n[i];s.once&&delete this.subscriptions[i],s.handler.apply(s.scope,arguments)}this.isPublishing=!1},i.prototype._tracePublishEvent=function(e,t){this.app&&this.app.debugModeActive("event")&&"TraceEvent"!==this.name&&(this.app._internalDebugEnabled?this.app._debug.trace.tracePublishEvent(this.app,e,t,this.name,this.subscriptions):this.app.trace.event(e))},i.prototype._traceSubscribeEvent=function(e,t,n){this.app&&this.app.debugMode&&(this.app._internalDebugEnabled?this.app._debug.trace.traceSubscribeEvent(this.app,e,this.name,n):this.app.trace.event(e))},i.prototype._traceUnsubscribeEvent=function(e,t,n){this.app&&this.app.debugMode&&(this.app._internalDebugEnabled?this.app._debug.trace.traceUnsubscribeEvent(this.app,e,this.name,n):this.app.trace.event(e))},i);function i(e,t){this.app=null,this.isPublishing=!1,this.subscriptions={},this.name=e,this.app=t}t.Event=n})},"geocortex/framework/events/EventRegistry":function(){define(["require","exports","./Event"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(s.prototype.clear=function(){for(var e in this.events)this.events.hasOwnProperty(e)&&this.events[e].clear()},s.prototype.event=function(e){var t=this.events[e];return t||(t=new n.Event(e,this.app),this.events[e]=t),t},s);function s(e){this.events={},this.app=e}t.EventRegistry=i})},"geocortex/framework/events/TypedEvent":function(){define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})},"geocortex/framework/events/ViewDimensionsChangedArgs":function(){define(["require","exports"],function(e,t){"use strict";function n(e,t){this.view=e,this.region=t}Object.defineProperty(t,"__esModule",{value:!0}),t.ViewDimensionsChangedArgs=n})}}});require({cache:{"geocortex/framework/events":function(){define(["require","exports"],function(e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0})})}}});require({cache:{"geocortex/framework/FrameworkObject":function(){define(["require","exports"],function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e=(o.prototype.auto=function(t,n,e){if(3===arguments.length&&"string"==typeof n)this.dojoConnects.push(dojo.connect(t,n,e));else if(2===arguments.length&&n instanceof Function){var o=t.bind(t,n);this.observableBindings.push({obj:t,token:o})}else 3===arguments.length&&e instanceof Function&&(o=t.bind(n,e),this.observableBindings.push({obj:t,token:o}))},o.prototype.trackSubscription=function(t,n){this.eventSubscriptions.push({event:t,token:n})},o.prototype.trackCommandHandler=function(t,n){this.commandHandlers.push({command:t,token:n})},o.prototype.onDestroy=function(){this._isDestroyed=!0},o.prototype.destroyBindings=function(){for(var t=this.dojoConnects.length-1;0<=t;t--)dojo.disconnect(this.dojoConnects[t]);for(this.dojoConnects=[],t=this.observableBindings.length-1;0<=t;t--){var n=this.observableBindings[t].obj,e=this.observableBindings[t].token;n.unbind(e)}for(this.observableBindings=[],t=this.eventSubscriptions.length-1;0<=t;t--){var o=this.eventSubscriptions[t].event;e=this.eventSubscriptions[t].token,o.unsubscribe(e)}for(this.eventSubscriptions=[],t=this.commandHandlers.length-1;0<=t;t--){var s=this.commandHandlers[t].command;e=this.commandHandlers[t].token,s.unregister(e)}this.commandHandlers=[]},o.prototype.destroy=function(){this.destroyBindings(),this.onDestroy()},o.prototype.getResource=function(t,n){return this.app.getResource(this.libraryId,t,n)},o);function o(t,n){this.dojoConnects=[],this.observableBindings=[],this.eventSubscriptions=[],this.commandHandlers=[],this._isDestroyed=!1,this.app=t,this.libraryId=n}n.FrameworkObject=e})}}});require({cache:{"geocortex/framework/index":function(){define(["require","exports"],function(i,n){"use strict";function r(i){return!0===n.libraries[i]}function e(){n.initialized||(n.initialized=!0)}Object.defineProperty(n,"__esModule",{value:!0}),n.applications=[],n.libraries={},n.initialized=!1,n.registerApplication=function(i){n.applications.push(i)},n.hasLibrary=r,n.notifyLibraryDownload=function(i){if(!r(i)){n.libraries[i]=!0;for(var e=0;e<n.applications.length;++e)n.applications[e].notifyLibraryDownload(i)}},(n.initialize=e)()})}}});require({cache:{"geocortex/framework/LazyObservable":function(){var l,c=this&&this.__extends||(l=function(e,t){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}l(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});define(["require","exports","./observables"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,l=(o=r.Observable,c(a,o),a.prototype.get=function(){var e=o.prototype.get.call(this);if(null!=e||this._delegateNullCached)return e;if(this.delegateGetter){var t=this.delegateGetter();return this.cacheDelegateResults&&t!==e&&o.prototype.set.call(this,t),this.cacheDelegateNull&&(this._delegateNullCached=!0),t}return null},a.prototype.clear=function(){o.prototype.set.call(this,null),delete this._delegateNullCached},a);function a(e,t,r){var l=o.call(this,e)||this;return l.delegateGetter=t||null,r&&(l.cacheDelegateResults=r),l}(t.LazyObservable=l).prototype.cacheDelegateResults=!1,l.prototype.cacheDelegateNull=!1,l.prototype._delegateNullCached=!1})}}});require({cache:{"geocortex/framework/observables":function(){define(["require","exports","./events/Event","./events/CollectionChangedArgs"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(p.prototype.set=function(e){this.value=e,this.bindingEvent.publish(e)},p.prototype.get=function(){return this.value},p.prototype.equals=function(e){var t=e;if(e&&e.get&&"function"==typeof e.get&&(t=e.get()),this.value instanceof Array&&t instanceof Array){if(this.value.length!==t.length)return!1;for(var n=0;n<this.value.length;n++)if(this.value[n]!==t[n])return!1;return!0}return this.get()===t},p.makeBindableProxy=function(e){if(!e)return null;var c=[];if(e.___clonedObject)return e.___clonedObject;function v(){throw new Error("Can't make method calls on a bindable proxy.")}var g=function(t,e,n){for(var i=0,r=c;i<r.length;i++){var o=r[i];if(e===o)return o}if(c.push(e),e&&"string"!=typeof e&&"number"!=typeof e&&"boolean"!=typeof e){if(e instanceof Array){for(var s=new y,u=0;u<e.length;++u){var a={};a=g(u,e[u],e),s.addItem(a)}return s}if(e instanceof Object){if(e.isObservable)return e;for(var h in a={},e)e.hasOwnProperty(h)&&(a[h]=g(h,e[h],e));return a}return e instanceof Function?v:e}var l=new p(e);return l.set=function(e){n[t]=e,l.value=e,l.bindingEvent.publish(e)},l.get=function(){return n[t]},l},t=g("root",{root:e},e);return e.___clonedObject=t.root,e instanceof Array?t.root:new p(t.root)},p.prototype.bind=function(e,t){return this.bindingEvent.subscribe(e,t)},p.prototype.unbind=function(e){return this.bindingEvent.unsubscribe(e)},p.prototype.once=function(e,t){var n=this,i=this.bind(e,function(){n.unbind(i),t.apply(e,arguments)});return i},p.prototype.sync=function(e){var t=this;this.removeSync(),e&&(this.set(e.get()),this._syncSource=e,this._syncToken=e.bindingEvent.subscribe(this,function(e){t.set(e)}))},p.prototype.removeSync=function(){this._syncToken&&this._syncSource&&(this._syncSource.unbind(this._syncToken),this._syncToken=null,this._syncSource=null)},p.prototype.syncTransform=function(e,t){var n=this;this._syncToken&&this._syncSource&&(this._syncSource.unbind(this._syncToken),this._syncToken=null,this._syncSource=null),e&&(this.set(t(e.get())),this._syncSource=e,this._syncToken=e.bindingEvent.subscribe(this,function(e){n.set(t(e))}))},p.prototype.pulse=function(){this.set(this.get())},p);function p(e){this.bindingEvent=new n.Event("__anonymous"),this._syncToken=null,this._syncSource=null,this.value=e,this._debug instanceof Function&&this._debug(this)}(t.Observable=i).prototype.isObservable=!0;var y=(o.prototype.isEmpty=function(){return 0===this.value.length},o.prototype.length=function(){return this.value.length},o.prototype.contains=function(e){return Array.contains(this.value,e)},o.prototype.getAt=function(e){return this.value[e]},o.prototype.getRange=function(e,t){return void 0===t?this.value.slice(e):this.value.slice(e,t+1)},o.prototype.indexOf=function(e){return this.value.indexOf(e)},o.prototype.get=function(){return this.value},o.prototype.getItems=function(){return this.value},o.prototype.getLength=function(){return this.value.length},o.prototype.addItems=function(e){if(e&&!(e.length<1)){var t=new r.CollectionChangedArgs;t.type="append",t.rangeStart=this.value.length,this.value=this.value.concat(e),t.rangeEnd=t.rangeStart+e.length-1,(t.sender=this).bindingEvent.publish(t)}},o.prototype.addItem=function(e){var t=new r.CollectionChangedArgs;t.type="append",t.rangeStart=this.value.length,t.rangeEnd=this.value.length,this.value.push(e),(t.sender=this).bindingEvent.publish(t)},o.prototype.insertItems=function(e,t){if(0!==t.length)if(e>=this.value.length)this.addItems(t);else{var n=new r.CollectionChangedArgs;n.type="insert",n.rangeStart=e,n.rangeEnd=e+t.length-1,n.sender=this;for(var i=0;i<t.length;++i)this.value.splice(e+i,0,t[i]);this.bindingEvent.publish(n)}},o.prototype.insertItem=function(e,t){if(e>=this.value.length)this.addItem(t);else{var n=new r.CollectionChangedArgs;n.type="insert",n.rangeStart=e,n.rangeEnd=e,(n.sender=this).value.splice(e,0,t),this.bindingEvent.publish(n)}},o.prototype.removeItem=function(e){for(var t;-1<(t=Array.pos(this.value,e));){var n=new r.CollectionChangedArgs;n.type="remove",n.rangeStart=t,n.rangeEnd=t,(n.sender=this).bindingEvent.publish(n),Array.remove(this.value,t,t)}},o.prototype.removeAt=function(e){if(0<=e&&e<this.getLength()){var t=new r.CollectionChangedArgs;t.type="remove",t.rangeStart=e,t.rangeEnd=e,(t.sender=this).bindingEvent.publish(t),Array.remove(this.value,e,e)}},o.prototype.removeRange=function(e,t){t||0===t||(t=this.value.length);var n=new r.CollectionChangedArgs;n.type="remove",n.rangeStart=e,n.rangeEnd=Math.min(t,this.value.length),(n.sender=this).bindingEvent.publish(n),Array.remove(this.value,e,t)},o.prototype.removeWhere=function(e){if(e)for(var t=this.value.length-1;0<=t;t--)if(e(this.value[t])){var n=new r.CollectionChangedArgs;n.type="remove",n.rangeStart=t,n.rangeEnd=t,(n.sender=this).bindingEvent.publish(n),Array.remove(this.value,t,t)}},o.prototype.clear=function(){if(this.value&&0!==this.value.length){var e=new r.CollectionChangedArgs;e.type="clear",e.rangeStart=0,e.rangeEnd=this.value.length-1,(e.sender=this).bindingEvent.publish(e),this.value.length=0}},o.prototype.set=function(e){this.clear(),e&&this.addItems(e)},o.prototype.pulse=function(){var e=new r.CollectionChangedArgs;e.type="clear",e.rangeStart=0,e.rangeEnd=this.value.length-1,(e.sender=this).bindingEvent.publish(e),(e=new r.CollectionChangedArgs).type="append",e.rangeStart=0,e.rangeEnd=this.value.length-1,(e.sender=this).bindingEvent.publish(e)},o.prototype.bind=function(e,t){return this.bindingEvent.subscribe(e,t)},o.prototype.unbind=function(e){return this.bindingEvent.unsubscribe(e)},o.prototype.once=function(e,t){var n=this,i=n.bind(e,function(){n.unbind(i),t.apply(e,arguments)});return i},o.prototype.sync=function(n){var i=this;this.removeSync(),n.value&&n.bindingEvent&&(this.set(n.value),this._syncSource=n,this._syncToken=n.bindingEvent.subscribe(this,function(e){i.value=n.value.map(function(e){return e});var t=new r.CollectionChangedArgs;dojo.mixin(t,e),(t.sender=i).bindingEvent.publish(t),"clear"===e.type?i.value.length=0:"remove"===e.type&&Array.remove(i.value,e.rangeStart,e.rangeEnd)}))},o.prototype.removeSync=function(){this._syncToken&&this._syncSource&&(this._syncSource.unbind(this._syncToken),this._syncToken=null,this._syncSource=null)},o.prototype.equals=function(e){var t=e;if(e&&e.isObservableCollection&&(t=e.get()),!t.hasOwnProperty("length"))throw new Error("Type mismatch");if(this.get().length!==t.length)return!1;for(var n=0;n<this.get().length;n++)if(this.value[n]!==t[n])return!1;return!0},o);function o(e){this.bindingEvent=new n.Event("__anonymous"),this.useThrottling=!1,this.throttledOperations=null,this._syncSource=null,this.value=e||[],this._debug instanceof Function&&this._debug(this)}(t.ObservableCollection=y).prototype.isObservable=!0,y.prototype.isObservableCollection=!0})}}});require({cache:{"geocortex/framework/resourceManager":function(){define(["require","exports","./application/ResourceManager"],function(e,r,a){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.resourceManager=new a.ResourceManager})}}});require({cache:{"geocortex/framework/SimplePromise":function(){define(["require","exports"],function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=(u.resolve=function(n){return u._getThen(n)?n:new u(function(t,e){t(n)})},u.reject=function(n){return new u(function(t,e){e(n)})},u.all=function(t){return u.resolve(t).then(function(t){if(!Array.isArray(t))throw new Error("SimplePromise.all: expecting an array or a thenable.");var o=t.length,i=[];return new u(function(n,r){t.forEach(function(t,e){u.resolve(t).then(function(t){i[e]=t,0==--o&&n(i)},r)})})})},u.prototype.then=function(r,o){var t=this;return new u(function(e,n){return t._done(function(t){if("function"!=typeof r)return e(t);try{return e(r(t))}catch(t){return n(t)}},function(t){if("function"!=typeof o)return n(t);try{return e(o(t))}catch(t){return n(t)}})})},u.prototype._fulfill=function(t){var e=this;this._state=u.FULFILLED,this._value=t,this._handlers.forEach(function(t){return e._handle(t)}),this._handlers=[]},u.prototype._reject=function(t){var e=this;this._state=u.REJECTED,this._value=t,this._handlers.forEach(function(t){return e._handle(t)}),this._handlers=[]},u.prototype._resolve=function(t){var e=this;try{var n=u._getThen(t);if(n)return void this._doResolve(n.bind(t),function(t){return e._resolve(t)},function(t){return e._reject(t)});this._fulfill(t)}catch(t){this._reject(t)}},u._getThen=function(t){var e=typeof t;if(t&&("object"==e||"function"==e)){var n=t.then;if("function"==typeof n)return n}return null},u.prototype._doResolve=function(t,e,n){var r=!1;try{t(function(t){r||(r=!0,e(t))},function(t){r||(r=!0,n(t))})}catch(t){if(r)return;r=!0,n(t)}},u.prototype._handle=function(t){this._state===u.PENDING?this._handlers.push(t):(this._state===u.FULFILLED&&"function"==typeof t.onFulfilled&&t.onFulfilled(this._value),this._state===u.REJECTED&&"function"==typeof t.onRejected&&t.onRejected(this._value))},u.prototype._done=function(t,e){var n=this;setTimeout(function(){n._handle({onFulfilled:t,onRejected:e})},0)},u.PENDING=0,u.FULFILLED=1,u.REJECTED=2,u);function u(t){var e=this;this._state=u.PENDING,this._value=null,this._handlers=[],this._doResolve(t,function(t){return e._resolve(t)},function(t){return e._reject(t)})}e.SimplePromise=n})}}});require({cache:{"geocortex/framework/storage/FileStorageProvider":function(){var i,c=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});define(["require","exports","./StorageProviderBase","./StorageStats"],function(e,t,r,i){"use strict";var s,o;Object.defineProperty(t,"__esModule",{value:!0}),(o=s=t.ErrorType||(t.ErrorType={})).QUOTA_EXCEEDED_ERR="QuotaExceededError",o.NOT_FOUND_ERR="NotFoundError",o.SECURITY_ERR="SecurityError",o.INVALID_MODIFICATION_ERR="InvalidModificationError",o.INVALID_STATE_ERR="InvalidStateError";var n,a=(n=r.StorageProviderBase,c(l,n),l.prototype.initialize=function(t){var r=this;if(!this._isInitialized&&!this._error)if(n.prototype.initialize.call(this),this.isSupported()){t||(this.app.configuration&&this.app.configuration.offlineStorageSpaceMb&&(t=1024*parseInt(this.app.configuration.offlineStorageSpaceMb,10)*1024),t=t||this._defaultDesiredSize);var i=function(e){r._isInitialized||(r._isInitialized=!0,r.app.trace.debug("Filesystem '{0}' initialized successfully.".format(e.name)),r._filesystem=e,r._error=null,r._initializationSuccessCallback(e))};navigator.webkitPersistentStorage||window.webkitStorageInfo?this._requestQuota(this._storageTypePersistent,t,function(e){r._isInitialized||(r.app.trace.debug("HTML5 File API quota granted. Size: {0} bytes.".format(e)),r._requestFileSystem(window.PERSISTENT,t,i,function(e){e=r._shapeError(e),r._error=e,r._initializationErrorCallback&&r._initializationErrorCallback(e)}))},function(e){e=r._shapeError(e),r._error=e,r.app.trace.error("Error requesting filesystem quota: {0}".format(e.toString()),e),r._initializationErrorCallback&&r._initializationErrorCallback(e)}):this._requestFileSystem(LocalFileSystem.PERSISTENT,t,i,function(e){e=r._shapeError(e),r._error=e,r._initializationErrorCallback&&r._initializationErrorCallback(e)})}else this.app.trace.warning("The HTML5 storage provider could not be initialized. The File API is not supported by this browser.")},l.prototype.isSupported=function(){return!(!window.requestFileSystem&&!window.webkitRequestFileSystem)},l.prototype.isFull=function(){return this._isFull},l.prototype.getScore=function(){return this.initialize(),5},l.prototype.getStats=function(){return this.initialize(),new i.StorageStats},l.prototype._ensureInitializedThen=function(e){var t=this,r=null;this._isInitialized?e.apply(this,[]):this._isInitializing?r=dojo.connect(this,"_initializationSuccessCallback",function(){dojo.disconnect(r),e.apply(t,[])}):(this._isInitializing=!0,r=dojo.connect(this,"_initializationSuccessCallback",function(){dojo.disconnect(r),e.apply(t,[])}),this.initialize())},l.prototype._silentlyEnsureInitializeThen=function(r,i){var o=this;this._isInitialized||this._isInitializing||!navigator.webkitPersistentStorage&&!window.webkitStorageInfo?this._ensureInitializedThen(r):this._queryUsageAndQuota(this._storageTypePersistent,function(e,t){0===e&&0===t?i():o._ensureInitializedThen(r)},function(e){e=o._shapeError(e),o.app.trace.warning("An error occurred while trying to fetch file API usage information: {0}".format(e.toString()))})},l.prototype._requestFileSystem=function(e,t,r,i){if(window.requestFileSystem)window.requestFileSystem(e,t,r,i);else{if(!window.webkitRequestFileSystem)throw new Error("No request filesystem method found");window.webkitRequestFileSystem(e,t,r,i)}},l.prototype._requestQuota=function(e,t,r,i){var o=navigator,n=window;switch(e){case this._storageTypeTemporary:o.webkitTemporaryStorage&&o.webkitTemporaryStorage.requestQuota?o.webkitTemporaryStorage.requestQuota(t,r,i):n.webkitStorageInfo&&n.webkitStorageInfo.requestQuota&&n.webkitStorageInfo.requestQuota(window.TEMPORARY,t,r,i);break;case this._storageTypePersistent:o.webkitPersistentStorage&&o.webkitPersistentStorage.requestQuota?o.webkitPersistentStorage.requestQuota(t,r,i):n.webkitStorageInfo&&n.webkitStorageInfo.requestQuota&&n.webkitStorageInfo.requestQuota(window.PERSISTENT,t,r,i)}},l.prototype._queryUsageAndQuota=function(e,t,r){var i=navigator,o=window;switch(e){case this._storageTypeTemporary:i.webkitTemporaryStorage&&i.webkitTemporaryStorage.queryUsageAndQuota?i.webkitTemporaryStorage.queryUsageAndQuota(t,r):o.webkitStorageInfo&&o.webkitStorageInfo.queryUsageAndQuota&&o.webkitStorageInfo.queryUsageAndQuota(window.TEMPORARY,t,r);break;case this._storageTypePersistent:i.webkitPersistentStorage&&i.webkitPersistentStorage.queryUsageAndQuota?i.webkitPersistentStorage.queryUsageAndQuota(t,r):o.webkitStorageInfo&&o.webkitStorageInfo.queryUsageAndQuota&&o.webkitStorageInfo.queryUsageAndQuota(window.PERSISTENT,t,r)}},l.prototype._writeValue=function(t,n,a,s,e){function l(e){e=c._shapeError(e),s&&s(e)}var r,c=this,i=e?"":this.keyNamespace;try{r=function(e){e.createWriter(function(e){e.truncate(0)}),e.createWriter(function(e){e.onwriteend=function(e){c.app.trace.debug("Wrote {0} bytes to filesystem.".format(e.total))};var t=!(e.onerror=function(e){e=c._shapeError(e),c.app.trace.debug("Write failed: {0}".format(e)),s&&s(e)});try{var r=!1;if(!r&&"undefined"!=typeof Blob)try{var i=new Blob([n],{type:"text/plain"});e.write(i),r=!0}catch(e){c.app.trace.debug('Failed to create blob "'+e+'". Falling back to BlobBuilder.')}if(!r){var o=null;if("undefined"!=typeof BlobBuilder?o=new BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?o=new WebKitBlobBuilder:"undefined"!=typeof MSBlobBuilder&&(o=new MSBlobBuilder),!o)throw new Error("Error writing to File API file: No BlobBuilder implementation found.");o.append(n),e.write(o.getBlob("text/plain"))}}catch(e){t=!0,l(e)}t||a()})},e?c._filesystem.root.getFile(t+".json",{create:!0,exclusive:!1},r,l):c._filesystem.root.getDirectory(i,{create:!0,exclusive:!1},function(e){c._filesystem.root.getFile(i+"/"+t+".json",{create:!0,exclusive:!1},r,l)},l)}catch(e){l(e)}},l.prototype._readValue=function(e,r,t,i){function o(e){e.name&&e.name===s.NOT_FOUND_ERR?r(null):(e=n._shapeError(e),t&&t(e))}var n=this,a=i?"":this.keyNamespace+"/";this._filesystem.root.getFile(a+e+".json",{},function(e){e.file(function(e){var t=new FileReader;t.onloadend=function(e){r(this.result)};try{t.readAsText(e)}catch(e){o(e)}},o)},o)},l.prototype._shapeError=function(e){var t="";switch(e.name){case s.QUOTA_EXCEEDED_ERR:t="Quota Exceeded.";break;case s.NOT_FOUND_ERR:t="File not found.";break;case s.SECURITY_ERR:t="Security error.";break;case s.INVALID_MODIFICATION_ERR:t="Invalid modification.";break;case s.INVALID_STATE_ERR:t="Invalid state.";break;default:t="Unknown Error."}return e=new Error("File error: {0}.".format(t))},l.prototype.clear=function(t,r){function i(e){r&&(e=o._shapeError(e),r(e))}var o=this;this._silentlyEnsureInitializeThen(function(){o._filesystem.root.getDirectory(o.keyNamespace,{create:!1},function(e){e.removeRecursively(function(){t&&t()},i)},function(e){e.name===s.NOT_FOUND_ERR?t():i(e)})},t)},l.prototype.clearAllData=function(t,r){var h=this;this._silentlyEnsureInitializeThen(function(){try{var e=h._filesystem.root.createReader(),s=[],l=0,c=0,u=new dojo.Deferred,p=new dojo.Deferred,f=new dojo.DeferredList([u,p]);f.then(function(e){c?r&&r(new Error("{0} errors were encountered while clearing the storage provider.".format(c))):t&&t()}),f.addErrback(function(e){r&&(e=h._shapeError(e),r(e))});var o=function(){},n=function(e){e=h._shapeError(e),h.app.trace.warning("Error removing local folder: {0}.".format(e.toString())),++c,p.resolve()},a=function(){e.readEntries(function(e){if(e.length){for(var t=0,r=e;t<r.length;t++){var i=r[t];i.isDirectory?i.removeRecursively(o,n):s.push(i.fullPath)}a()}else!function(){function t(){--l<=0&&(u.resolve(),p.resolve())}function r(e){e=h._shapeError(e),h.app.trace.warning("Error removing local file: {0}.".format(e.toString())),++c,--l<=0&&u.resolve()}function e(e){e.remove(t,r)}function i(e){e=h._shapeError(e),h.app.trace.warning("Could not obtain file for removal: {0}.".format(e.toString())),p.errback(e)}if(0===(l=s.length))u.resolve(),p.resolve();else if(0===s.length)u.resolve(),p.resolve();else for(var o=0,n=s;o<n.length;o++){var a=n[o];try{h._filesystem.root.getFile(a,{},e,i)}catch(e){e=h._shapeError(e),f.errback(e)}}}()},function(e){e=h._shapeError(e),r&&r(e)})};a()}catch(e){e=h._shapeError(e),r&&r(e)}},t)},l.prototype.get=function(e,t,r,i){var o=this;this._silentlyEnsureInitializeThen(function(){try{o._readValue(e,t,r,i)}catch(e){e=o._shapeError(e),r&&r(e)}},function(){t(null)})},l.prototype.set=function(e,t,r,i,o){var n=this;this._ensureInitializedThen(function(){try{n._writeValue(e,t,r,i,o)}catch(e){e=n._shapeError(e),i&&i(e)}})},l.prototype.remove=function(e,t,r,i){var o=this,n=i?"":this.keyNamespace;this._ensureInitializedThen(function(){try{o._filesystem.root.getFile(n+"/"+e+".json",{create:!1},function(e){e.remove(t,function(e){e=o._shapeError(e),r&&r(e)})},function(e){e=o._shapeError(e),o.app.trace.debug("Could not obtain file for removal: {0}.".format(e.toString())),r&&r(e)})}catch(e){e=o._shapeError(e),r&&r(e)}})},l);function l(){var e=null!==n&&n.apply(this,arguments)||this;return e._isInitializing=!1,e._initializationSuccessCallback=null,e._initializationErrorCallback=null,e._defaultDesiredSize=524288e3,e._storageTypeTemporary=0,e._storageTypePersistent=1,e._error=null,e._isFull=!1,e._isInitialized=!1,e}t.FileStorageProvider=a})},"geocortex/framework/storage/HttpStorageProvider":function(){var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});define(["require","exports","./StorageProviderBase"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=(i=r.StorageProviderBase,a(n,i),n.prototype.initialize=function(){if(!this._initialized){!window.require.has("esri-cors")&&window.Modernizr.cors&&(delete window.require.has.cache["esri-cors"],window.require.has.add("esri-cors",function(){return!0}));var e=this.localServerAddress.replace("http://","");window.esri.config.defaults.io.corsEnabledServers.push(e),this._initialized=!0}},n.isSupported=function(){return/\bGeocortexApp\b/.test(navigator.userAgent)||/http:\/\/127.0.0.1(:[0-9]*)?\/viewerpackages\//gi.test(window.location.href)},n.prototype.fileStorageRequest=function(e,t,r,i,o){this.initialize();var n={url:this.localServerAddress+this.fileStorageEndpoint+"/"+t,headers:{Authorization:"Token "+this.app.localServerToken},load:function(e){r(e)},error:function(e){e&&e.status&&404===e.status?r(null):i(e)},failOk:!0};o&&(n.putData=o),dojo.xhr(e,n)},n.prototype.clear=function(e,t){this.fileStorageRequest("DELETE",this.keyNamespace+"/",e,t)},n.prototype.clearAllData=function(e,t){this.fileStorageRequest("DELETE","",e,t)},n.prototype.get=function(e,t,r,i){var o=i?"0/"+e:this.keyNamespace+"/"+e;this.fileStorageRequest("GET",o,t,r)},n.prototype.set=function(e,t,r,i,o){var n=o?"0/"+e:this.keyNamespace+"/"+e;this.fileStorageRequest("PUT",n,r,i,t)},n.prototype.remove=function(e,t,r,i){var o=i?"0/"+e:this.keyNamespace+"/"+e;this.fileStorageRequest("DELETE",o,t,r)},n);function n(e){var t=i.call(this,e)||this;return t.fileStorageEndpoint="/filesystem",t._initialized=!1,t.localServerAddress=t.app.localServerAddress?t.app.localServerAddress:"http://127.0.0.1:8181",t}t.HttpStorageProvider=o})},"geocortex/framework/storage/LocalStorageProvider":function(){var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});define(["require","exports","./StorageProviderBase","./StorageStats"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,n=(o=r.StorageProviderBase,a(s,o),s.prototype.initialize=function(){o.prototype.initialize.call(this),this._localStorage=window.localStorage},s.prototype.isSupported=function(){return this._localStorage||this.initialize(),!!this._localStorage},s.prototype.isFull=function(){return this._localStorage||this.initialize(),this._isFull},s.prototype.getScore=function(){return this._localStorage||this.initialize(),5},s.prototype.getStats=function(){return this._localStorage||this.initialize(),new i.StorageStats},s.prototype.clear=function(e,t){this._localStorage||this.initialize();for(var r=null,i=new RegExp("^"+this.keyNamespace+s._namespaceSeperator),o=0,n=this._localStorage.length;o<n;o++){var a=this._localStorage.key(o);if(i.test(a))try{this._localStorage.removeItem(a),o--,n--}catch(e){r=e}}null!=r?t&&t(r):e&&e()},s.prototype.clearAllData=function(e,t){this._localStorage||this.initialize();try{this._localStorage.clear(),e&&e()}catch(e){t&&t(e)}},s.prototype.get=function(e,t,r,i){e=i?e:"{0}{1}{2}".format(this.keyNamespace,s._namespaceSeperator,e),this._localStorage||this.initialize();try{var o=this._localStorage.getItem(e);t&&t(o)}catch(e){r&&r(e)}},s.prototype.set=function(e,t,r,i,o){e=o?e:"{0}{1}{2}".format(this.keyNamespace,s._namespaceSeperator,e),this._localStorage||this.initialize();try{this._localStorage.setItem(e,t),r&&r()}catch(e){i&&i(e)}},s.prototype.remove=function(e,t,r,i){e=i?e:"{0}{1}{2}".format(this.keyNamespace,s._namespaceSeperator,e),this._localStorage||this.initialize();try{this._localStorage.removeItem(e),t&&t()}catch(e){r&&r(e)}},s._namespaceSeperator="→",s);function s(){var e=null!==o&&o.apply(this,arguments)||this;return e._isFull=!1,e}t.LocalStorageProvider=n})},"geocortex/framework/storage/StorageProviderBase":function(){define(["require","exports","./StorageStats"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(o.prototype.initialize=function(){},o.prototype.isSupported=function(){return!1},o.prototype.isFull=function(){return!1},o.prototype.getStats=function(){return new r.StorageStats},o.prototype.getScore=function(){return 0},o.prototype.clear=function(e,t){},o.prototype.clearAllData=function(e,t){},o.prototype.get=function(e,t,r,i){},o.prototype.set=function(e,t,r,i,o){},o.prototype.remove=function(e,t,r,i){},o);function o(e){this.app=e,this.keyNamespace=e.id}t.StorageProviderBase=i})},"geocortex/framework/storage/StorageStats":function(){define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(i.UNKNOWN=-1,i);function i(){this.capacity=i.UNKNOWN,this.sizeInChars=i.UNKNOWN,this.numKeys=i.UNKNOWN}t.StorageStats=r})},"geocortex/framework/storage/Store":function(){define(["require","exports","./HttpStorageProvider","./FileStorageProvider","./LocalStorageProvider"],function(e,t,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(a.prototype.initialize=function(e){if(e)this._provider=e;else if(r.HttpStorageProvider.isSupported())this._provider=new r.HttpStorageProvider(this.app);else{var t=new i.FileStorageProvider(this.app);t.isSupported()?this._provider=t:this._provider=new o.LocalStorageProvider(this.app)}this._provider.keyNamespace=this._rootNamespace},a.prototype.hasProvider=function(){return null!=this._provider},a.prototype._yield=function(t){return t?function(){var e=arguments;setTimeout(function(){t.apply(this,e)},0)}:function(){}},a.prototype._yieldError=function(t){return t?function(){var e=arguments;setTimeout(function(){t.apply(this,e)},0)}:function(){}},a.prototype._yieldGet=function(t){return t?function(){var e=arguments;setTimeout(function(){t.apply(this,e)},0)}:function(){}},a.prototype.clear=function(e,t){this._provider&&this._provider.clear(this._yield(e),this._yieldError(t))},a.prototype.clearAllData=function(e,t){this._provider&&this._provider.clearAllData(this._yield(e),this._yieldError(t))},a.prototype._sanitizeKey=function(e){return e.replace(new RegExp("[/\\\\:,?=|]","gm"),"_")},a.prototype.set=function(t,r,e,i,o){var n=new dojo.Deferred,a=this._sanitizeKey(t);return o=o||!1,this._provider&&this._provider.set(a,r,this._yield(function(){n&&-1==n.fired&&n.resolve(r),e&&e(t,r)}),this._yieldError(function(e){n&&-1==n.fired&&n.resolve(e),i&&i(e,t,r)}),o),n},a.prototype.get=function(t,r,i,e){var o=new dojo.Deferred,n=this._sanitizeKey(t);return e=e||!1,this._provider&&this._provider.get(n,this._yieldGet(function(e){o&&-1==o.fired&&o.resolve(e),r&&r(e,t)}),this._yieldError(function(e){o&&-1==o.fired&&o.resolve(e),i&&i(e,t)}),e),o},a.prototype.remove=function(t,e,r,i){var o=new dojo.Deferred,n=this._sanitizeKey(t);return i=i||!1,this._provider&&this._provider.remove(n,this._yield(function(){o&&-1==o.fired&&o.resolve(t),e&&e(t)}),this._yieldError(function(e){o&&-1==o.fired&&o.resolve(e),r&&r(e,t)}),i),o},a);function a(e,t){this.app=e,this._rootNamespace=this._sanitizeKey(t?t.toString():"framework."+this.app.id)}t.Store=n})}}});require({cache:{"geocortex/framework/Thenable":function(){define(["require","exports"],function(e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0})})}}});require({cache:{"geocortex/framework/ui/BindingEngine":function(){define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(n.prototype.bind=function(e,t,i){},n.prototype.unbind=function(e){},n);function n(){}t.DefaultBindingEngine=i})},"geocortex/framework/ui/BindingExpression":function(){define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=/^on/,i=(n.prototype.on=function(i,n){var o=this;if(i&&n){if(!this.domElement)throw new Error("Cannot bind before domElement is set.");r.test(i)&&(i=i.substring(2)),e(["dojo/on"],function(e){var t=e(o.domElement,i,n);o._dojoDomEvents.push(t)})}},n.prototype.destroy=function(){if(this.templateSelections)for(var e in this.templateSelections)if(this.templateSelections.hasOwnProperty(e)){var t=this.templateSelections[e];if(t&&t.___domParent){var i=t.___domParent;dojo.place(t,i,"last")}}this.domElement=null,this.target=null,this.parentView=null,this.viewModel=null;for(var n=this._dojoDomEvents.length-1;0<=n;n--)this._dojoDomEvents[n].remove();for(this._dojoDomEvents.length=0,n=this.targetBindings.length-1;0<=n;n--)this.targetBindings[n].event.unsubscribe(this.targetBindings[n].token);for(this.targetBindings=[],n=this.boundViews.length-1;0<=n;n--)this.boundViews[n].destroyBindings();this.boundViews=[]},n);function n(){this.domElement=null,this.type="attr",this.attributeName=null,this.target=null,this.invert=!1,this._dojoDomEvents=[],this.targetBindings=[],this.templateMode=null,this.templateKey=null,this.templateSelections={},this.parentView=null,this.boundViews=[],this.viewModel=null}t.BindingExpression=i})},"geocortex/framework/ui/BindingExpressionFactory":function(){define(["require","exports"],function(e,t){"use strict";function i(){}Object.defineProperty(t,"__esModule",{value:!0}),t.BindingExpressionFactory=i})},"geocortex/framework/ui/BindingExpressionHandler":function(){define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})},"geocortex/framework/ui/BindingInterfaces":function(){define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})},"geocortex/framework/ui/BindingNode":function(){define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(n.prototype.destroy=function(){this.domElement=null,this.parent=null,this.context=null,this.contextChange=!1;for(var e=this.expressions.length-1;0<=e;e--)this.expressions[e].destroy();for(this.expressions=[],e=this.children.length-1;0<=e;e--)this.children[e].destroy();this.children=[]},n);function n(){this.domElement=null,this.parent=null,this.children=[],this.expressions=[],this.context=null,this.contextChange=!1,this.domElement=null,this.parent=null,this.context=null}t.BindingNode=i})},"geocortex/framework/ui/BindingTreeBuilder":function(){define(["require","exports","./ViewBase","./BindingNode","./BindingExpression","../config/ViewConfig","../events/CollectionChangedArgs","./ViewModelBase","../utils/ThrottledOperation","../config/WidgetConfig","../utils/ViewUtils","../utils/utils"],function(e,t,k,c,w,E,N,D,I,v,S,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=/\{(.*?)\}/g;function M(e,t){var i=[];if(!e)return i;var n=e.match(s);if(!n){if(t.app)return t.app.trace.warning("Invalid data-binding expression '{0}'.".format(e)),[];throw new Error("Invalid data-binding expression '{0}'.".format(e))}for(var o=0,r=n;o<r.length;o++){var a=r[o].split(":");2===a.length&&i.push({directive:a[0].replace("{","").trim(),target:a[1].replace("}","").trim()})}return i}function h(e,t,i,n,o){var r=e.expressions,a=e.context,s=!1,l=!1,d=t.directive,u=t.target,p=new w.BindingExpression;if(p.domElement=n,p.target=u,null!=o.viewModel?p.viewModel=o.viewModel:(p.viewModel={},p.viewModel.id="[None]"),o.parentView?p.parentView=o.parentView:p.parentView=o,d.startsWith("@")){var c=d.split("-")[1];if(d.startsWith("@event-"))c?(p.type="event",p.attributeName=c):(o.app.trace.warning("Binding error: Invalid event binding expression '{0}' in view '{1}'.".format(d,o.id)),s=!0);else if(d.startsWith("@var"))p.type="var";else if(d.startsWith("@text"))p.attributeName="innerHTML",p.type="text";else if(d.startsWith("@attach"))p.attributeName="___attachedValue",p.type="attachment";else if(d.startsWith("@style-")){var v=d.indexOf("-"),h=d.substring(v+1);h?(p.type="style",p.attributeName=h):(o.app.trace.warning("Binding error: Invalid style binding expression '{0}' in view '{1}'.".format(d,o.id)),s=!0)}else if(d.startsWith("@dom"))p.type="dom",p.attributeName=c;else if(d.startsWith("@value"))p.type="value",p.attributeName=c;else if(d.startsWith("@widget"))p.type=d.substring(1),p.attributeName=c,p.otherExpressions=i;else if(d.startsWith("@class")||d.startsWith("@noclass")){p.type="class",d.startsWith("@noclass")&&(p.invert=!0);var g=d.indexOf("-"),f=d.substring(g+1);f?p.attributeName=f:(o.app.trace.warning("Binding error: Invalid class binding expression '{0}' in view '{1}'.".format(d,o.id)),s=!0)}else"@source"===d?(function(e,t,i,n,o){e.type="source",e.attributeName="@source",e.templateMode="single-inline";for(var r=0,a=i;r<a.length;r++){var s=a[r];if(s!==t){var l=s.directive,d=s.target;if("@template"===l){e.templateMode="single-external";var u=new E.ViewConfig(null,null,null);if(u.markupResource=d,u.libraryId=o.libraryId,!(m=o.app.viewManager.createView(u))){o.app.trace.error("Could not instantiate template '{0}' while binding view '{1}'.".format(d,o.id));break}m.app=o.app,e.templateSelections={"@default":m.root};break}if("@template-selector"===l){e.templateMode="inline-selected",e.templateKey=d,e.templateSelections={};break}}}if("single-external"!==e.templateMode){for(var p=new dojo.NodeList,c=0;c<n.children.length;++c)for(var v=n.children[c],h=M(dojo.attr(v,"data-binding"),o),g=0,f=h;g<f.length;g++){var w=f[g];if("@template-for"===w.directive||"@template-select"===w.directive){if("@template-for"===w.directive&&w.target===e.target){p.push(v);var m=dojo.clone(v);(e.templateSelections["@default"]=m).___domParent=n}else if("@template-select"===w.directive){p.push(v);for(var y=!1,b=0,V=h;b<V.length;b++){var _=V[b];if("@template"===_.directive){var j=new E.ViewConfig(null,null,null);if(j.markupResource=_.target,j.libraryId=o.libraryId,!(m=o.app.viewManager.createView(j))){o.app.trace.error("Could not instantiate template '{0}' while binding view '{1}'.".format(_.target,o.id));break}m.app=o.app;var B=dojo.clone(v);dojo.place(m.root,B,"last"),e.templateSelections[w.target]=B,y=!0;break}}y||(p.push(v),(e.templateSelections[w.target]=v).___domParent=n)}break}}p.orphan()}}(p,t,i,n,o),l=!0):"@source-remove"===d?(p.type="source-remove",p.attributeName=c):"@source-add"===d?(p.type="source-add",p.attributeName=c):"@visible"===d||"@hidden"===d?("@hidden"===d&&(p.invert=!0),p.type="visibility",p.attributeName="@visibility"):"@disabled"===d||"@enabled"===d?("@disabled"===d&&(p.invert=!0),p.type="disabledState",p.attributeName="@disabledState"):d.startsWith("@template")?p.type="template":d.startsWith("@halt")?l=!0:(o.app.trace.warning("Unknown binding term '{0}'.".format(d)),s=!0)}else p.type="attr",p.attributeName=d;return s||o.applyBinding.apply(o,[n,p,a,e])&&r.push(p),l}function d(t,i,e,n,o,r,a){if(!0!==i.upToDate){for(var s=null,l=null,d=0,u=e.expressions;d<u.length;d++){var p=u[d];s||"source-add"!==p.type||(s=p.target),l||"source-remove"!==p.type||(l=p.target)}var c=a;i.parentView&&(c=i.parentView);var v=c[s],h=c[l];if(null!=t){if(t instanceof N.CollectionChangedArgs){if(null===t||"clear"===t.type){if(S.cancelAllThrottledOperations(n),h)for(f=t.rangeStart;f<=t.rangeEnd;++f)h.apply(a,[i,n.getAt(f),t,f]);for(f=i.boundViews.length-1;0<=f;f--)a.app.viewManager.destroyView(i.boundViews[f]);if(i.boundViews=[],!h&&null!=i.domElement&&null!=i.domElement.children){for(w=new dojo.NodeList,f=0;f<i.domElement.children.length;++f)i.domElement.children[f].___collectionTemplate||w.push(i.domElement.children[f]);w.orphan()}}else if("replace"===t.type){if(S.cancelAllThrottledOperations(n),h)for(f=t.rangeStart;f<t.rangeEnd+1;++f)h.apply(a,[i,n.getAt(f),t,f]);for(f=i.boundViews.length-1;0<=f;f--)a.app.viewManager.destroyView(i.boundViews[f]);i.boundViews=[],h||dojo.empty(i.domElement),t.type="append",t.rangeStart=0,t.rangeEnd=n.value.length-1}}else{var g=t.isObservable?t.get():t;h&&h.apply(a,[i,g,t,0]);for(var f=i.boundViews.length-1;0<=f;f--)a.app.viewManager.destroyView(i.boundViews[f]);if(i.boundViews=[],!h){var w,m=i.___singleSourceItem;m&&((w=new dojo.NodeList).push(m),w.orphan(),i.___singleSourceItem=null)}if(g&&i.domElement)if(v)v.apply(a,[i,g,t,0]);else{var y=a.resolveBindingTemplate(i,g);dojo.place(y,i.domElement,"last");var b=new k.ViewBase(a.app);b.parentView=i.parentView,b.app=b.parentView.app,b.libraryId=a.libraryId;var V={children:[]};V.children.push(y);var _=g;_||((_=new D.ViewModelBase(a.app,a.libraryId)).app=a.app,_.libraryId=a.libraryId),b.root=V,b.isActive||!1!==b.app.applicationReady?b.attach(_):b.app.waitUntilApplicationReady().then(function(){b.attach(_)}),b.root=y,i.___singleSourceItem=b.root,i.boundViews.push(b)}}if("append"===t.type||"insert"===t.type){var j=null;if("insert"===t.type&&i.domElement.children.length>t.rangeStart&&(j=i.domElement.children[t.rangeStart]),n.useThrottling){n.throttledOperations=n.throttledOperations&&n.throttledOperations.constructor===Array?n.throttledOperations:[];var B=void 0===n.throttleDelay?0:n.throttleDelay,E=t.rangeStart,M=Math.min(E+10-1,t.rangeEnd),x=n.get().slice(0),A=function(){var e=n.throttledOperations.indexOf(R);-1<e&&n.throttledOperations.splice(e,1)},R=new I.ThrottledOperation(B,function(){var e=P(t,i,n,v,j,o,a,E,M,x);return M>=t.rangeEnd?(A(),!1):(E+=10,M+=10,M=Math.min(M,t.rangeEnd),e||A(),e)});n.throttledOperations.push(R)}else P(t,i,n,v,j,o,a,t.rangeStart,t.rangeEnd)}else if("remove"===t.type){S.cancelAllThrottledOperations(n);for(var C=t.rangeStart;C<=t.rangeEnd;++C)for(var T=i.boundViews.length-1;0<=T;T--){var O=i.boundViews[T];null!==O.viewModel&&void 0!==O.viewModel&&O.viewModel===r.getAt(C)&&(h?h.apply(a,[i,t[C],t,C]):a.app.viewManager.destroyView(O),Array.removeItem(i.boundViews,O))}}}}else i.upToDate=!1}function P(r,a,e,s,l,t,d,i,n,o){if(n<i)return!1;if(!a||null==a.domElement)return!1;for(var u=o||e,p=function(e){var t=null;if(null!=s)s.apply(d,[a,u.isObservable?u.getAt(e):u[e],r,e]);else{var i=u.isObservable?u.getAt(e):u[e];if(t=d.resolveBindingTemplate(a,i),l&&"insert"===r.type)dojo.place(t,l,"before");else if(l&&"append"===r.type)dojo.place(t,l,"after");else{if(!a||null==a.domElement)return{value:!1};dojo.place(t,a.domElement,"last")}var n=new k.ViewBase(d.app,d.libraryId);n.parentView=a.parentView,n.app=n.parentView.app,n.libraryId=d.libraryId,n.id+="-item"+e;var o={children:[]};o.children.push(t),null==i&&((i=new D.ViewModelBase(d.app,d.libraryId)).app=d.app,i.libraryId=d.libraryId),n.root=o,n.isActive||!1!==n.app.applicationReady?n.attach(i):n.app.waitUntilApplicationReady().then(function(){n.attach(i)}),n.root=t,a.boundViews.push(n)}},c=i;c<=n;++c){var v=p(c);if("object"==typeof v)return v.value}return t.___populateInitialValueFunc&&(t.___populateInitialValueFunc(),delete t.___populateInitialValueFunc),!0}function r(e,t,i){if(null==e||e.isObservable){var n=e.get();n=null==n?"":n.toString(),"innerHTML"===t.attributeName?(dojo.empty(i),i.appendChild(dojo.doc.createTextNode(n))):dojo.attr(i,t.attributeName,String.escapeHtml(n))}else"innerHTML"===t.attributeName?(dojo.empty(i),i.appendChild(document.createTextNode(e))):dojo.attr(i,t.attributeName,String.escapeHtml(e))}function u(e,t){t!==dojo.attr(e,"value")&&(null==t&&(t=""),dojo.attr(e,"value",t))}function g(e,t){e.checked=!0===t}function f(e,t){var i=dojo.attr(e,"value");e.checked=!0===t||i===t}function m(e,t){if(t instanceof Date){var i=new Date(t.getTime());i.setMinutes(i.getMinutes()-i.getTimezoneOffset()),e.valueAsDate=i}else e.value=t}function y(e,t){var i=t;if(e.domElement)if(i instanceof N.CollectionChangedArgs){for(var n=i,o=n.sender,r=[],a=n.rangeStart;a<=n.rangeEnd;a++){var s=o.getAt(a);r.push(s.value?s.value+"":s)}if("append"===n.type||"insert"===n.type)for(var l=0;l<e.domElement.options.length;++l)for(var d=e.domElement.options[l],u=0;u<r.length;u++)S.optionMatchesValue(d,r[u],i)?d.selected=!0:dojo.attr(e.domElement,"multiple")||(d.selected=!1)}else if("number"!=typeof i&&"boolean"!=typeof i||(i=i.toString()),null==i)for(l=0;l<e.domElement.options.length;++l)(d=e.domElement.options[l]).selected=!1;else if(dojo.isArray(i)){if(e.viewModel[e.target].isObservableCollection){var p=!1;for(l=0;l<e.domElement.options.length;++l)if((d=e.domElement.options[l]).selected=!1,dojo.attr(e.domElement,"multiple")||!p)for(var c=0,v=i;c<v.length;c++){var h=v[c];if(S.optionMatchesValue(d,h,i)){p=d.selected=!0;break}}}else for(l=0;l<e.domElement.options.length;++l)if(d=e.domElement.options[l],S.optionMatchesValue(d,null,i)){d.selected=!0;break}}else for(l=0;l<e.domElement.options.length;++l)if(d=e.domElement.options[l],S.optionMatchesValue(d,null,i)){d.selected=!0;break}}function b(e,t,i,n,o,r,a){if(e.domElement){var s=null;if(0<e.boundViews.length){for(var l=e.boundViews.length-1;0<=l;l--){var d=e.boundViews[l];a.app.menuRegistry&&!a.app.menuRegistry.isManagedMenuView(d)&&a.app.viewManager.destroyView(d)}e.boundViews=[]}dojo.empty(e.domElement);var u=null;if(t){if("string"==typeof t){var p=dojo.create("div");dojo.attr(p,"innerHTML",t),dojo.addClass(p,"empty-div"),s=p.children&&1===p.children.length?p.children[0]:p}else if(t.hasOwnProperty("nodeType")&&[1,2,3,8,9].contains(n.nodeType))s=t;else if(t instanceof k.ViewBase)u=t,e.boundViews.push(u),s=t.root;else{if(!(t instanceof v.WidgetConfig))return void a.app.trace.warning("Could not resolve widget '{0}': Object of unknown type provided.".format(o));u=S.createWidgetViewFromConfig(t,i,a.app),e.boundViews.push(u),s=u.root}dojo.place(s,e.domElement,r?"replace":"last"),u&&(u.added(a),u.activated())}}}t.buildTree=function(e){if(null!=e.root){var t=new c.BindingNode;return t.domElement=null,t.parent=null,t.children=[],t.context=e.viewModel,function e(t,i,n){if(i&&i.children)for(var o=0;o<i.children.length;++o){var r=i.children[o],a=dojo.attr(r,"data-region-name"),s=dojo.attr(r,"data-binding");if(s=s||r.___dataBindingExpressions){var l=M(s,n);if(r.___dataBindingExpressions=s,n.app&&n.app.debugMode||dojo.removeAttr(r,"data-binding"),!l||0===l.length)continue;for(var d=!1,u=0;u<l.length;++u)d=h(t,l[u],l,r,n);var p=new c.BindingNode;p.domElement=r,p.parent=t,p.context=t.context,p.children=[],p.expressions=[],t.children.push(p),!1!==d||a||e(p,r,n)}else a||e(t,r,n)}}(t,{children:[e.root]},e),t}},t.buildSourceBinding=function(i,n,e,o,r){var a=r.getBindingTarget(n);if(null===a)return!1;if(void 0===a)return r.app.trace.warning("Binding error: '{0}' in view model '{1}' was not bindable.".format(n.target,n.viewModel.id)),!1;var s=a;if(s.bind){var t=s.bind(r,function(e){d(e,n,o,s,i,a,r)});n.targetBindings.push({event:s.bindingEvent,token:t})}if(s.isObservableCollection){var l=s.getLength()-1;r.bindingSetupDelegates.push(function(){if(r.bound){var e=new N.CollectionChangedArgs;e.type="clear",e.rangeStart=0,e.rangeEnd=l,e.sender=s,d(e,n,o,s,i,a,r)}var t=new N.CollectionChangedArgs;t.type="append",t.rangeStart=0,t.rangeEnd=l,t.sender=s,d(t,n,o,s,i,a,r),s.isObservable&&s.bindingEvent.isPublishing&&(n.upToDate=!0)})}else r.bindingSetupDelegates.push(function(){d(a,n,o,s,i,a,r),s.isObservable&&s.bindingEvent.isPublishing&&(n.upToDate=!0)})},t.buildEventBinding=function(i,n,o,e){var r=e;if(!e[n.target]&&n.parentView&&n.parentView[n.target]&&(r=n.parentView),!r[n.target])return e.app.trace.warning("Binding error: Event handler '{0}' was not found in view '{1}' or its parent view.".format(n.target,r.id)),!1;i!==n.domElement&&e.app.trace.warning("Binding error: buildEventBinding passed in el that doesn't match binding.domElement."),n.on(n.attributeName,function(e){var t;return n.target&&"function"==typeof r[n.target]&&(t=r[n.target](e,i,o)),t||(e.preventDefault(),e.stopPropagation(),!1)})},t.buildVarBinding=function(e,t,i,n){var o=n;t.parentView&&(o=t.parentView);var r=o[t.target];r?r&&r instanceof Array?r.push(e):r&&r.isObservableCollection?r.addItem(e):o[t.target]=e:o[t.target]=e},t.buildTextBinding=function(e,t,i,n){var o=n.getBindingTarget(t);return null!==o&&(void 0===o?(n.app.trace.view("Binding error: Property '{0}' does not exist in view model '{1}'.".format(t.target,t.viewModel.id)),!1):(o.isObservable&&t.targetBindings.push({event:o.bindingEvent,token:o.bind(n,function(){r(o,t,e)})}),void n.bindingSetupDelegates.push(function(){r(o,t,e)})))},t.buildAttributeBinding=function(e,t,i,n,o){var r=o.getBindingTarget(t);if(void 0===r)return o.app.trace.view("Binding error: Property '{0}' does not exist in view model '{1}'.".format(t.target,t.viewModel.id)),!1;function a(){!function(e,t,i,n){if(null===e)return dojo.attr(i,t.attributeName,"");if(e.isObservable){var o=e.get();null==o&&(o=""),!0===n?i[t.attributeName]=o:dojo.attr(i,t.attributeName,o)}else null==e&&(e=""),!0===n?i[t.attributeName]=e:dojo.attr(i,t.attributeName,e)}(r,t,e,n)}null!==r&&r.isObservable&&t.targetBindings.push({event:r.bindingEvent,token:r.bind(o,a)}),o.bindingSetupDelegates.push(function(){a()})},t.buildStyleBinding=function(t,i,e,n){var o=n.getBindingTarget(i);if(null===o)return!1;function r(e,t){return isNaN(t)||""===t?t:t+"px"}if(void 0===o)return n.app.trace.view("Binding error: Property '{0}' does not exist in view model '{1}'.".format(i.target,i.viewModel.id)),!1;if(null==o||o.isObservable){if(null!=o){var a=function(){var e=r(i.attributeName,o.get());dojo.style(t,i.attributeName,e)};o.isObservable&&i.targetBindings.push({event:o.bindingEvent,token:o.bind(n,a)}),n.bindingSetupDelegates.push(function(){a.apply(n,[null])})}}else{var s=r(i.attributeName,o);dojo.style(t,i.attributeName,s)}},t.buildDomBinding=function(e,t,i,n){var o=n;t.parentView&&(o=t.parentView);var r=o[t.target];if(null==r)return!1;if(void 0===r)return n.app.trace.view("Binding error: Property '{0}' does not exist in view model '{1}'.".format(t.target,t.viewModel.id)),!1;try{if(r.isObservable){if(t.targetBindings.push({event:r.bindingEvent,token:r.bind(n,function(e){if(!r.get())return!1;t.domElement=dojo.place(r.get(),t.domElement,"replace"),n.app&&n.app.viewManager.notifyDimensionsChanged(n)})}),!r.get())return!1;dojo.place(r.get(),t.domElement,"replace")}else{if(!r)return!1;dojo.place(r,t.domElement,"replace")}}catch(e){n.app.trace.warning("Binding error: An error occurred in view '{0}' while attempting to perform a DOM binding in view model '{1}'.".format(n.id,t.viewModel.id))}},t.buildWidgetBinding=function(e,i,t,n){var o,r=i.target,a=n.viewModel,s=!0,l=!1,d=null;if(i.otherExpressions)for(var u=0,p=i.otherExpressions;u<p.length;u++){var c=p[u];if("@widget-context"===c.directive){if(i.target=c.target,!(a=n.getBindingTarget(i)))return n.app.trace.error("Error binding widget '{0}' to target '{1}': Target was not found in view model.".format(r,c.target)),!1;d=a}else"@widget-required"===c.directive?s=!("false"===c.target.toLowerCase()):"@widget-replace"===c.directive&&(l="true"===c.target.toLowerCase())}o=a&&a.isObservable;for(var v=n.app.configModel.widgetConfigs,h=null,g=0,f=v;g<f.length;g++){var w=f[g];if(w.id===r){h=w;break}}function m(){var e=d||null;e&&e.isObservable&&(e=e.get());var t=(i.parentView||n).resolveWidget(r,e,i);return t||(s&&n.app.trace.error("Widget '{0}' was not found.".format(r)),!1)}var y=!h;n.libraryId,h&&h.libraryId&&h.libraryId,o&&i.targetBindings.push({event:a.bindingEvent,token:a.bind(n,function(e){if(y){var t=m();b(i,t,e,h,r,l,n)}else b(i,h,e,h,r,l,n)})}),n.bindingSetupDelegates.push(function(){var e=null;if(a&&(e=a.isObservable?a.get():a),y){var t=m();b(i,t,e,h,r,l,n)}else b(i,h,e,h,r,l,n)})},t.buildClassBinding=function(n,o,e,t){var i=t.getBindingTarget(o);if(null===i)return!1;if(void 0===i)return t.app.trace.view("Binding error: Property '{0}' does not exist in view model '{1}'.".format(o.target,o.viewModel.id)),!1;function r(e){var t=S.isTruthy(e);!0===o.invert&&(t=!t);var i=o.attributeName;!0===t?(dojo.removeClass(n,i),dojo.addClass(n,i)):dojo.removeClass(n,i)}i.isObservable&&o.targetBindings.push({event:i.bindingEvent,token:i.bind(t,r)}),t.bindingSetupDelegates.push(function(){r.apply(t,[i])})},t.buildVisibilityBinding=function(n,o,e,t){var i=t.getBindingTarget(o);if(null===i)return!1;if(void 0===i)return t.app.trace.view("Binding error: Property '{0}' does not exist in view model '{1}'.".format(o.target,o.viewModel.id)),!1;function r(e){var t=S.isTruthy(e);!0===o.invert&&(t=!t);var i="";i="inline"===o.initialVisibility?"bound-visible-inline":"bound-visible",!0===t?(dojo.removeClass(n,"bound-invisible"),dojo.addClass(n,i)):(dojo.removeClass(n,i),dojo.addClass(n,"bound-invisible"))}o.initialVisibility=dojo.style(n,"display")||"block",i.isObservable&&o.targetBindings.push({event:i.bindingEvent,token:i.bind(t,r)}),t.bindingSetupDelegates.push(function(){r.apply(t,[i])})},t.buildDisabledBinding=function(n,o,e,t){var r=t.getBindingTarget(o);if(void 0===r)return t.app.trace.view("Binding error: Property '{0}' does not exist in view model '{1}'.".format(o.target,o.viewModel.id)),!1;function i(e){var t="bound-disabled",i=!1;e?r&&(e instanceof N.CollectionChangedArgs?"append"===e.type?(0<e.rangeEnd+1-e.rangeStart||r.value&&0<r.value.length)&&(i=!1):"clear"===e.type?i=!0:"insert"===e.type?0<e.rangeEnd+1-e.rangeStart&&(i=!1):"remove"===e.type&&e.rangeEnd+1-e.rangeStart<r.value.length&&(i=!1):i=r.isObservableCollection?!(0<r.getLength()):r.isObservable?!r.get():"string"==typeof e&&0===e.length):i=!0,!0===o.invert&&(i=!i),!0===i?(dojo.attr(n,"disabled",!0),dojo.attr(n,"tabindex",-1),dojo.addClass(n,t)):(dojo.removeAttr(n,"disabled"),dojo.removeAttr(n,"tabindex"),dojo.removeClass(n,t))}o.initialDisabled=dojo.attr(n,"disabled"),r.isObservable&&o.targetBindings.push({event:r.bindingEvent,token:r.bind(t,i)}),t.bindingSetupDelegates.push(function(){i.apply(t,[r])})},t.buildValueBinding=function(t,i,e,n){var o=n.getBindingTarget(i);if(void 0===o)return n.app.trace.view("Binding error: Property '{0}' does not exist in view model '{1}'.".format(i.target,i.viewModel.id)),!1;if(null==o)return!1;var r=o.isObservable||!1,a=o.isObservableCollection||!1,s=t.tagName.toLowerCase(),l=dojo.attr(t,"type")||t.type?t.type:null;r&&("select"===s?(i.targetBindings.push({event:o.bindingEvent,token:o.bind(i,function(e){return y(i,e)})}),n.bindingSetupDelegates.push(function(){y(i,o.get())})):"radio"===l?(i.targetBindings.push({event:o.bindingEvent,token:o.bind(i,function(e){return f(t,e)})}),n.bindingSetupDelegates.push(function(){f(t,o.get())})):"checkbox"===l?(i.targetBindings.push({event:o.bindingEvent,token:o.bind(i,function(e){return g(t,e)})}),n.bindingSetupDelegates.push(function(){g(t,o.get())})):"date"===l?(i.targetBindings.push({event:o.bindingEvent,token:o.bind(i,function(e){return m(t,e)})}),n.bindingSetupDelegates.push(function(){m(t,o.get())})):(i.targetBindings.push({event:o.bindingEvent,token:o.bind(i,function(e){return u(t,e)})}),n.bindingSetupDelegates.push(function(){u(t,o.get())}))),"textarea"===s||"input"===s&&"text"===l?function(i,n,o,r){function e(e){var t=dojo.attr(e.currentTarget,"value");if(t!==a)return a=t,n?o.set(t):r.setBindingTargetValue(i,t),!0}var a=null;i.on("change",e),i.on("keyup",e),i.on("mouseup",e),i.on("input",e)}(i,r,o,n):"input"===s&&"checkbox"===l?function(i,n,o,r){i.on("change",function(e){var t=dojo.attr(e.currentTarget,"checked");return n?o.set(t):r.setBindingTargetValue(i,t),!0})}(i,r,o,n):"input"===s&&"radio"===l?function(t,i,n,o){t.on("click",function(e){return dojo.attr(e.currentTarget,"checked")&&(i?n.set(e.currentTarget.value):o.setBindingTargetValue(t,e.currentTarget.value)),!0})}(i,r,o,n):"input"===s&&"date"===l?function(n,o,r,a){n.on("change",function(e){var t=o?r.get():r,i=e.currentTarget.valueAsDate;return i.setMinutes(i.getMinutes()+i.getTimezoneOffset()),t instanceof Date&&!isNaN(t.getTime())&&(i.setHours(t.getHours()),i.setMinutes(t.getMinutes()),i.setSeconds(t.getSeconds()),i.setMilliseconds(t.getMilliseconds())),o?r.set(i):a.setBindingTargetValue(n,i),!0})}(i,r,o,n):"select"===s?function(r,a,s,l,d,u){a.___populateInitialValueFunc=function(){y(r,d.isObservable?d.get():d)},r.on("change",function(){for(var e,t=dojo.query("option",a),i=[],n=0;n<t.length;++n){var o=t[n];!0===o.selected&&(e=o.___attachedValue,p.isNullOrUndefined(e)?i.push(o.value):i.push(e))}return 0===i.length&&0<t.length&&!a.multiple&&!0===u.app.___uaIsiPad&&(e=t[a.selectedIndex=0].___attachedValue,i.push(p.isNullOrUndefined(e)?t[0].value:e)),0<i.length?l?(d.clear(),d.addItems(i)):s?d.set(i[0]):u.setBindingTargetValue(r,i):d.clear(),!0})}(i,t,r,a,o,n):function(i,n,o,r){i.on("change",function(e){if(void 0!==e.currentTarget){var t=dojo.attr(e.currentTarget,"value");return n?o.set(t):r.setBindingTargetValue(i,t),!0}r.app&&r.app.trace.error("Binding error: bound to change event where currentTarget is undefined")})}(i,r,o,n)}})},"geocortex/framework/ui/DisposableBinding":function(){define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})},"geocortex/framework/ui/DivRegionAdapter":function(){var n,l=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","./RegionAdapterBase","./../resourceManager","./../utils/ArrayUtils"],function(e,t,i,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,a=(r=i.RegionAdapterBase,l(s,r),s.prototype.unhostAllViews=function(){for(var e=this.views.length-1;0<=e;e--){var t=this.views[e];this.unhostView(t)}this.views.length=0},s.prototype.hostView=function(e){if(this.unhostAllViews(),this.views.push(e),null==e.root){var t=n.resourceManager.fetch(e.markupResource,e.libraryId);if(null===t)return this.app.trace.warning("Could not fetch markup resource '{0}' in library '{1}'.".format(e.markupResource,e.libraryId)),!1;e.root=dojo.create("div",{className:"view {0}".format(e.id)}),e.root.innerHTML=t,dojo.place(e.root,this.domElement,"last"),e.viewModel&&e.attach(e.viewModel),this.app.viewManager.discoverRegions(e.root,e)}else dojo.place(e.root,this.domElement,"only");return r.prototype.hostView.call(this,e),!0},s.prototype.unhostView=function(e){this.deactivateView(e),o.removeItem(this.views,e);var t=new dojo.NodeList;t.push(e.root),t.orphan(),r.prototype.unhostView.call(this,e)},s);function s(e,t){return r.call(this,e,t)||this}t.DivRegionAdapter=a})},"geocortex/framework/ui/DivStackRegionAdapter":function(){var n,l=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","./RegionAdapterBase","./../utils/ArrayUtils","./../resourceManager"],function(e,t,i,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,a=(r=i.RegionAdapterBase,l(s,r),s.prototype.host=function(e,t){r.prototype.host.call(this,e,t),"false"===this.options.activateViewsInLastPosition&&(this.activateViewsInLastPosition=!1)},s.prototype.activateView=function(e){n.contains(this.activeViews,e)&&n.removeItem(this.activeViews,e),this.activeViews.push(e),this.activateViewsInLastPosition&&dojo.place(e.root,this.domElement,"last"),r.prototype.activateView.call(this,e)},s.prototype.deactivateView=function(e){e.isActive=!1,n.removeItem(this.activeViews,e),0<this.activeViews.length&&this.activateView(this.activeViews[this.activeViews.length-1]),r.prototype.deactivateView.call(this,e)},s.prototype.hostView=function(e){if(this.views.push(e),null==e.root){var t=o.resourceManager.fetch(e.markupResource,e.libraryId);if(null==t)return this.app.trace.warning("Could not fetch markup resource '{0}' in library '{1}'.".format(e.markupResource,e.libraryId)),!1;var i=this.getHostedTagName();e.root=dojo.create(i,{className:"view {0}".format(e.id)}),e.root.innerHTML=t,dojo.place(e.root,this.domElement,"last"),e.viewModel&&e.attach(e.viewModel),this.app.viewManager.discoverRegions(e.root,e)}else dojo.place(e.root,this.domElement,"last");return r.prototype.hostView.call(this,e),!0},s.prototype.unhostView=function(e){this.deactivateView(e),n.removeItem(this.views,e),n.removeItem(this.activeViews,e);var t=new dojo.NodeList;t.push(e.root),t.orphan(),r.prototype.unhostView.call(this,e)},s.prototype.getHostedTagName=function(){return this.options&&this.options.tagName?this.options.tagName:"div"},s);function s(e,t){var i=r.call(this,e,t)||this;return i.activeViews=[],i.activateViewsInLastPosition=!0,i}t.DivStackRegionAdapter=a})},"geocortex/framework/ui/MultiDivRegionAdapter":function(){var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","./MultiViewRegionAdapter"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=(n=i.MultiViewRegionAdapter,a(r,n),r.prototype.getHostedTagName=function(){return"div"},r);function r(){return null!==n&&n.apply(this,arguments)||this}t.MultiDivRegionAdapter=o})},"geocortex/framework/ui/MultiViewRegionAdapter":function(){var n,l=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","./RegionAdapterBase","./../resourceManager","./../utils/ArrayUtils"],function(e,t,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,a=(r=i.RegionAdapterBase,l(s,r),s.prototype.activateView=function(e){if(this.stickyViewActive)this.app.trace.warning("View "+e.id+" is sticky. View activations for region "+this.name+" are blocked");else{if(e.configuration&&!0===e.configuration.sticky&&(this.stickyViewActive=!0),this.hideAllViews(),0<this.activeViews.length){var t=this.activeViews[this.activeViews.length-1];t!==e&&(this.cancelActivate(t),t.deactivated())}r.prototype.activateView.call(this,e)}},s.prototype.deactivateView=function(e,t){e.configuration&&!0===e.configuration.sticky&&(this.stickyViewActive=!1),null==t&&(t=!0),r.prototype.deactivateView.call(this,e),!this.app.isShuttingDown&&t&&0<this.activeViews.length&&("MenuView"===e.constructor.name&&e.viewModel&&e.viewModel.menuSourceView?this.activateView(e.viewModel.menuSourceView):this.activateView(this.activeViews[this.activeViews.length-1]))},s.prototype.hideAllViews=function(){dojo.query("> .view",this.domElement).removeClass("active"),dojo.query("> .view",this.domElement).addClass("inactive")},s.prototype.hostView=function(e){var t=this;if(this.views.push(e),null==e.root){var i=o.resourceManager.fetch(e.markupResource,e.libraryId);if(null==i)return this.app.trace.warning("Could not fetch markup resource '{0}' in library '{1}'.".format(e.markupResource,e.libraryId)),!1;var n=this.getHostedTagName();e.root=dojo.create(n,{className:"view {0}".format(e.id)}),e.root.innerHTML=i,dojo.place(e.root,this.domElement,"last"),e.viewModel&&e.attach(e.viewModel),!1===e.app.applicationReady&&e.app.waitUntilApplicationReady().then(function(){setTimeout(function(){t.app.viewManager.discoverRegions(e.root,e)})}),this.app.viewManager.discoverRegions(e.root,e)}else dojo.place(e.root,this.domElement,"last");return r.prototype.hostView.call(this,e),!0},s.prototype.getHostedTagName=function(){return this.options&&this.options.tagName?this.options.tagName:"div"},s.prototype.unhostView=function(e){this.deactivateView(e,!1),n.removeItem(this.views,e),n.removeItem(this.activeViews,e);var t=new dojo.NodeList;t.push(e.root),t.orphan(),r.prototype.unhostView.call(this,e)},s);function s(){return null!==r&&r.apply(this,arguments)||this}t.MultiViewRegionAdapter=a})},"geocortex/framework/ui/PopupModalRegionAdapter":function(){var n,d=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","./RegionAdapterBase","./../utils/ArrayUtils","./../resourceManager","./MultiViewRegionAdapter"],function(e,t,i,n,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,s=(a=i.RegionAdapterBase,d(l,a),l.getInstance=function(){return l.instance},l.prototype.activate=function(){0<this.activeViews.length&&(dojo.style(this.domElement,"opacity",0),dojo.query(this.domElement).removeClass("inactive"),dojo.query(this.domElement).addClass("active"),dojo.query(this.overlayElement).removeClass("inactive"),dojo.query(this.overlayElement).addClass("active"))},l.prototype.deactivate=function(){dojo.query(this.domElement).removeClass("active"),dojo.query(this.domElement).addClass("inactive"),dojo.query(this.overlayElement).removeClass("active"),dojo.query(this.overlayElement).addClass("inactive"),this._screenReaderNarrationDisabled&&(this.app.command("EnableScreenReaderNarrate").execute(),this._screenReaderNarrationDisabled=!1),this.activeView&&(this.activeView=null)},l.prototype.host=function(e){var t=this;a.prototype.host.call(this,e),this.domElement=e,dojo.query(this.domElement).removeClass("active"),dojo.query(this.domElement).addClass("inactive"),this.contentContainer=dojo.query(".modal-container")[0],this.contentElement=dojo.query(".modal-container-inner")[0],this.overlayElement=dojo.query(".modal-overlay")[0],dojo.connect(window,"onresize",function(){t.handleScrollEvent()}),dojo.connect(window,"onscroll",function(){t.handleScrollEvent()}),this.app.event("WorkflowFormTextInputBlurredEvent").subscribe(this,function(){setTimeout(function(){t.positionContent()},100)})},l.prototype.handleScrollEvent=function(){var e=this;null!=this._scrollTimer&&(clearTimeout(this._scrollTimer),this._scrollTimer=null),this._scrollTimer=setTimeout(function(){e.positionContent()},0)},l.prototype.positionContent=function(){var e=this;if(this.contentContainer&&null!=this.activeView&&null!=this.activeView.root){var t=dojo.position(this.contentContainer),i=dojo.window.getBox(),n=t.w;t.w>i.w?(n=i.w,dojo.style(this.contentElement,{"max-width":n+"px"})):dojo.style(this.contentElement,{"max-width":""});var o=t.h;t.h>i.h?(o=i.h,dojo.style(this.contentElement,{"max-height":o+"px"})):dojo.style(this.contentElement,{"max-height":""}),dojo.style(this.contentContainer,{left:i.w/2-n/2+"px",top:i.h/2-o/2+"px"}),setTimeout(function(){return dojo.style(e.domElement,"opacity",1)})}},l.prototype.showActiveView=function(e){e.isActive&&(this.activeView=e,this.hideAllViews(),e.activated(),this.activate(),this.activeView=e,dojo.removeClass(e.root,"inactive"),dojo.addClass(e.root,"active"))},l.prototype.hideAllViews=function(){dojo.query("> .view",this.contentElement).removeClass("active"),dojo.query("> .view",this.contentElement).addClass("inactive")},l.prototype.activateView=function(e){var t=this;n.contains(this.activeViews,e)&&n.removeItem(this.activeViews,e),this.activeViews.push(e),this._screenReaderNarrationDisabled||(this._screenReaderNarrationDisabled=!0,this.app.command("DisableScreenReaderNarrate").execute()),a.prototype.activateView.call(this,e),this.showActiveView(e),this._repositionOnImageLoaded(e.root),setTimeout(function(){return t.app.command("FocusOnFirstInputInView").execute(t.contentElement)},400)},l.prototype.deactivateView=function(e){n.removeItem(this.activeViews,e),0<this.activeViews.length?(this.showActiveView(this.activeViews[this.activeViews.length-1]),this.positionContent()):this.deactivate(),a.prototype.deactivateView.call(this,e)},l.prototype.deactivateActiveView=function(){if(this.activeView){null!=this.titleBindingToken&&(this.activeView.title.unbind(this.titleBindingToken),this.titleBindingToken=null);var e=this.activeView;this.activeView=null,this.deactivateView(e),n.removeItem(this.activeViews,this.activeView)}},l.prototype.hostView=function(e){if(this.views.push(e),null==e.root){var t=o.resourceManager.fetch(e.markupResource,e.libraryId);if(null==t)return this.app.trace.warning("Could not fetch markup resource '{0}' in library '{1}'.".format(e.markupResource,e.libraryId)),!1;e.root=dojo.create("div",{className:"view {0}".format(e.id)}),e.root.innerHTML=t,dojo.place(e.root,this.contentElement,"last"),e.viewModel&&e.attach(e.viewModel),this.app.viewManager.discoverRegions(e.root,e),this.positionContent()}else dojo.place(e.root,this.contentElement,"last");return a.prototype.hostView.call(this,e),!0},l.prototype.unhostView=function(e){e==this.activeView&&this.deactivateView(e),n.removeItem(this.views,e),n.removeItem(this.activeViews,e);var t=new dojo.NodeList;t.push(e.root),t.orphan(),a.prototype.unhostView.call(this,e)},l.prototype._repositionOnImageLoaded=function(e){var i=this,n="attached_ModalRegion_ImageLoadedConnection";dojo.forEach(dojo.query("img",e),function(e){e[n]&&(dojo.disconnect(e[n]),delete e[n]);var t=dojo.connect(e,"load",i,function(e){i._imageLoaded(e)});e[n]=t})},l.prototype._imageLoaded=function(e){var t=e.target,i="attached_ModalRegion_ImageLoadedConnection";t[i]&&(dojo.disconnect(t[i]),delete t[i]),this.positionContent()},l.prototype._canExecuteCloseModalRegion=function(){if(this.views&&0<this.views.length)for(var e=0;e<this.views.length;e++)if(this.views[e].childRegions&&0<this.views[e].childRegions.length)for(var t=0;t<this.views[e].childRegions.length;t++){var i=this.views[e].childRegions[t];if(i instanceof r.MultiViewRegionAdapter&&i.stickyViewActive)return this.app.trace.warning("Sticky view is active. Region "+this.name+" cannot be closed"),!1}return!0},l.instance=null,l);function l(e,t){var i=a.call(this,e,t)||this;if(i.activeView=null,i.activeViews=[],i.titleBindingToken=null,i.contentHeader=null,i.contentTitle=null,i.contentContainer=null,i.contentElement=null,i.overlayElement=null,i._scrollTimer=null,i._scrollDelay=50,i._screenReaderNarrationDisabled=!1,l.instance)throw new Error("PopupModalRegionAdapter is a singleton and has already been constructed once.");return null==(l.instance=i).app.modalRegionSingleton&&(i.app.modalRegionSingleton=i),i.app.command("CloseModalRegion").register(i,function(){i.deactivate()},i._canExecuteCloseModalRegion),i.app.event("ViewActivatedEvent").subscribe(i,function(){0<i.activeViews.length&&setTimeout(function(){i.positionContent()},0)}),i.app.event("ViewDimensionsChangedEvent").subscribe(i,function(){i.positionContent()}),i}t.PopupModalRegionAdapter=s})},"geocortex/framework/ui/RegionAdapterBase":function(){define(["require","exports","./../utils/ArrayUtils"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(o.prototype.host=function(e,t){this.domElement=e,this.options=t||{},this.options.useTransitions?this.options.transitionDelay&&!isNaN(this.options.transitionDelay)||(this.options.transitionDelay=this.defaultTransitionDelay):this.options.useTransitions=!1},o.prototype.unhost=function(){this.domElement=null,this.options=null},o.prototype.activateView=function(e){this.cancelActivate(e),0===this.activeViews.length&&!1===e.isActive&&(this.isActive=!0,this.app.event("RegionActivatedEvent").publish(this),dojo.removeClass(this.domElement,"region-inactive"),dojo.addClass(this.domElement,"region-active")),i.contains(this.activeViews,e)&&i.removeItem(this.activeViews,e),this.activeViews.push(e),e.activated(),e.isActive=!0,this.options.useTransitions?(dojo.removeClass(e.root,"inactive"),dojo.addClass(e.root,"activating"),this._viewActivationTimers[e.id]=setTimeout(dojo.hitch(this,function(){dojo.removeClass(e.root,"inactive"),dojo.removeClass(e.root,"activating"),dojo.addClass(e.root,"active"),delete this._viewActivationTimers[e.id]}),this.options.transitionDelay)):(dojo.removeClass(e.root,"inactive"),dojo.addClass(e.root,"active")),this.app.event("ViewActivatedEvent").publish(e)},o.prototype.cancelActivate=function(e){this._viewActivationTimers[e.id]&&(clearTimeout(this._viewActivationTimers[e.id]),delete this._viewActivationTimers[e.id],dojo.removeClass(e.root,"activating"))},o.prototype.cancelDeactivate=function(e){this._viewActivationTimers[e.id]&&(clearTimeout(this._viewActivationTimers[e.id]),delete this._viewActivationTimers[e.id],dojo.removeClass(e.root,"deactivating"))},o.prototype.deactivateView=function(e){this.cancelDeactivate(e),this.activeViews.length<=1&&!0===e.isActive&&(this.isActive=!1,dojo.removeClass(this.domElement,"region-active"),dojo.addClass(this.domElement,"region-inactive"),this.app.event("RegionDeactivatedEvent").publish(this)),this.cancelActivate(e),i.removeItem(this.activeViews,e),e.deactivated(),e.isActive=!1,this.options.useTransitions?(dojo.removeClass(e.root,"active"),dojo.addClass(e.root,"deactivating"),this._viewDeactivationTimers[e.id]=setTimeout(dojo.hitch(this,function(){dojo.removeClass(e.root,"active"),dojo.removeClass(e.root,"deactivating"),dojo.addClass(e.root,"inactive"),delete this._viewDeactivationTimers[e.id]}),this.options.transitionDelay)):(dojo.removeClass(e.root,"active"),dojo.addClass(e.root,"inactive")),this.app.event("ViewDeactivatedEvent").publish(e)},o.prototype.hostView=function(e){dojo.removeClass(e.root,"active"),dojo.addClass(e.root,"inactive"),e.hostView=this.ownerView,e.added(),this.app.event("ViewHostedEvent").publish({region:this,view:e})},o.prototype.unhostView=function(e){e.hostView=null,e.removed(),dojo.removeClass(e.root,"active"),dojo.addClass(e.root,"inactive"),this.app.event("ViewUnhostedEvent").publish({region:this,view:e})},o);function o(e,t){this._viewActivationTimers=[],this._viewDeactivationTimers=[],this.isActive=!1,this.domElement=null,this.options=null,this.views=[],this.activeViews=[],this.defaultTransitionDelay=10,this.app=t,this.name=e}t.RegionAdapterBase=n})},"geocortex/framework/ui/ViewBase":function(){var n,d=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","./../FrameworkObject","./../observables","./../utils/utils","./BindingTreeBuilder"],function(e,t,i,n,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,s=(a=i.FrameworkObject,d(l,a),l.prototype.isDestroyed=function(){return this._isDestroyed},l.prototype.addDisposableBinding=function(e,t){this.disposableBindings.push({event:e.bindingEvent,token:t})},l.prototype.attach=function(e){var t=this;if(this.app&&this.app._internalDebugEnabled&&this.app.debugModeActive("view")&&this.app.trace.view("View.Attach called for view '{0}'.".format(this.id)),!this.bound&&(this.viewModel=e,this.root)){var i=r.buildTree(this);i instanceof Promise?i.then(function(e){t.bindingTree=e,null!==t.viewModel&&void 0!==t.viewModel&&t.pulseAll(),t.bound=!0,t.initiallyBound||(t.initiallyBound=!0,t.app.event("ViewInitializedEvent").publish(t))}):(this.bindingTree=i,null!==this.viewModel&&void 0!==this.viewModel&&this.pulseAll(),this.bound=!0,this.initiallyBound||(this.initiallyBound=!0,this.app.event("ViewInitializedEvent").publish(this)))}},l.prototype.activated=function(){},l.prototype.deactivated=function(){},l.prototype.added=function(e){!this.bound&&this.viewModel&&(this.bindingTree=r.buildTree(this),this.bound=!0,this.pulseAll(),this.initiallyBound||(this.initiallyBound=!0,this.app.event("ViewInitializedEvent").publish(this)))},l.prototype.removed=function(){this.app&&this.app._internalDebugEnabled&&this.app.debugModeActive("view")&&this.app.trace.view("View.Removed called for view '{0}'.".format(this.id)),this.destroyBindings()},l.prototype.destroy=function(){this.destroyBindings(),a.prototype.destroy.call(this)},l.prototype.destroyBindings=function(){if(a.prototype.destroyBindings.call(this),this.isActive&&this.app.viewManager.deactivateView(this),this.bindingTree){this.bindingTree.destroy();for(var e=this.disposableBindings.length-1;0<=e;e--){var t=this.disposableBindings[e];t.event.unsubscribe(t.token)}this.bound=!1,this.disposableBindings=[],this.bindingSetupDelegates=[]}},l.prototype.pulseAll=function(){for(var e=0,t=this.bindingSetupDelegates;e<t.length;e++){var i=t[e];try{i()}catch(e){this.app.trace.error("Error performing initial data-bind in view '{0}' with view model '{1}': {2}".format(this.id,this.viewModel.id,e.message),e)}}this.bindingSetupDelegates=[]},l.prototype.resolveWidget=function(e,t,i){return null},l.prototype.getBindingTarget=function(e){if("@context"===e.target)return e.viewModel;if(-1<e.target.indexOf("@language-")){var t=e.target.split("-").slice(1).join("-");return this.app.getResource(this.libraryId,"language-"+t)}if(!0!==e.viewModel.isObservable){var i=e.viewModel[e.target];return o.isNullOrUndefined(i)&&e.parentView&&e.parentView.viewModel&&(i=e.parentView.viewModel[e.target]),i}var n=e.viewModel.get();return null==n?n:n[e.target]},l.prototype.setBindingTargetValue=function(e,t){if("@context"!==e.target){if(!(-1<e.target.indexOf("@language-")))if(e.viewModel.isObservable){var i=e.viewModel.get();i&&(i[e.target]?i[e.target].isObservable?i[e.target].set(t):i[e.target]=t:i[e.target]=new n.Observable(t))}else e.viewModel[e.target].isObservable?e.viewModel[e.target].set(t):e.viewModel[e.target]=t}else e.viewModel&&e.viewModel.isObservable?e.viewModel.set(t):e.viewModel=t},l.prototype.resolveBindingTemplate=function(e,t){var i=null;if("single-inline"===e.templateMode||"single-external"===e.templateMode)i=dojo.clone(e.templateSelections["@default"]);else if("inline-selected"===e.templateMode){var n=null;t[e.templateKey]&&(n=t[e.templateKey]).isObservable&&(n=n.get()),!n&&e.templateSelections.hasOwnProperty("@null")?i=dojo.clone(e.templateSelections["@null"]):e.templateSelections.hasOwnProperty(n)&&(i=dojo.clone(e.templateSelections[n])),!i&&e.templateSelections.hasOwnProperty("@default")&&(i=dojo.clone(e.templateSelections["@default"]),dojo.addClass(i,"empty-div"))}return i=i||dojo.create("div")},l.prototype.buildTree=function(){return r.buildTree(this)},l.prototype.buildSourceBinding=function(e,t,i,n){return r.buildSourceBinding(e,t,i,n,this)},l.prototype.buildEventBinding=function(e,t,i){return r.buildEventBinding(e,t,i,this)},l.prototype.buildVarBinding=function(e,t,i){return r.buildVarBinding(e,t,i,this)},l.prototype.buildTextBinding=function(e,t,i){return r.buildTextBinding(e,t,i,this)},l.prototype.buildAttributeBinding=function(e,t,i,n){return r.buildAttributeBinding(e,t,i,n,this)},l.prototype.buildStyleBinding=function(e,t,i){return r.buildStyleBinding(e,t,i,this)},l.prototype.buildDomBinding=function(e,t,i){return r.buildDomBinding(e,t,i,this)},l.prototype.buildWidgetBinding=function(e,t,i){return r.buildWidgetBinding(e,t,i,this)},l.prototype.buildClassBinding=function(e,t,i){return r.buildClassBinding(e,t,i,this)},l.prototype.buildVisibilityBinding=function(e,t,i){return r.buildVisibilityBinding(e,t,i,this)},l.prototype.buildDisabledBinding=function(e,t,i){return r.buildDisabledBinding(e,t,i,this)},l.prototype.buildValueBinding=function(e,t,i){return r.buildValueBinding(e,t,i,this)},l.prototype.applyBinding=function(e,t,i,n){return"source"===t.type?this.buildSourceBinding(e,t,i,n):"event"===t.type?this.buildEventBinding(e,t,i):"text"===t.type?this.buildTextBinding(e,t,i):"var"===t.type?this.buildVarBinding(e,t,i):"class"===t.type?this.buildClassBinding(e,t,i):"style"===t.type?this.buildStyleBinding(e,t,i):"dom"===t.type?this.buildDomBinding(e,t,i):"value"===t.type?this.buildValueBinding(e,t,i):"attr"===t.type?this.buildAttributeBinding(e,t,i):"attachment"===t.type?this.buildAttributeBinding(e,t,i,!0):"visibility"===t.type?this.buildVisibilityBinding(e,t,i):"disabledState"===t.type?this.buildDisabledBinding(e,t,i):"widget"===t.type&&this.buildWidgetBinding(e,t,i),!0},l);function l(e,t){var i=a.call(this,e,t)||this;return i.isActive=!1,i.isManaged=!1,i.isBusy=new n.Observable(!1),i.title=new n.Observable(""),i.description=new n.Observable(""),i.iconUri=new n.Observable(""),i.markupResource=null,i.viewModel=null,i.regionName="",i.typeName="",i.root=null,i.bindingTree=null,i.parentView=null,i.hostView=null,i.childRegions=[],i.bound=!1,i.initiallyBound=!1,i.disposableBindings=[],i.bindingSetupDelegates=[],i.id="View-"+o.alphaNumericToken(),i.app&&i.app._internalDebugEnabled&&i.app.debugModeActive("view")&&(i.app.trace.view("Created view '"+i.id+"'"),i.app._debug.meta.createdView()),i}t.ViewBase=s})},"geocortex/framework/ui/ViewManager":function(){define(["require","exports","./../utils/ArrayUtils","./../config/ViewConfig","./../utils/utils","./../resourceManager","./../events/ViewDimensionsChangedArgs"],function(e,t,d,l,u,p,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(){};t.ViewManagerRegionEntry=c;var i=(o.prototype.shutdown=function(){for(var e=this._hostedRegions.length-1;0<=e;e--)this.destroyRegion(this._hostedRegions[e]);this._hostedRegions.length=0;for(var t=this._views.length-1;0<=t;t--)this.destroyView(this._views[t]);for(this._views.length=0,e=this._pendingRegions.length-1;0<=e;e--){var i=this._pendingRegions[e];for(t=i.views.length-1;0<=t;t--)this.destroyView(i.views[t]);i.views=[]}this._pendingRegions.length=0},o.prototype._registerCommands=function(){var i=this;this.app.commandRegistry.command("ActivateView").register(this,function(t){var e=i.getViewById(t);e?i.activateView(e):i.app.isShuttingDown||i.app.awaitModuleForView(t).then(function(e){e?i.app.commandRegistry.command("ActivateView").execute(t):i.app.trace.warning("ActivateView: Could not find view '{0}'.".format(t))})}),this.app.commandRegistry.command("DeactivateView").register(this,function(e){var t=i.getViewById(e);t?i.deactivateView(t):i.app.trace.warning("DeactivateView: Could not find view '{0}'.".format(e))}),this.app.commandRegistry.command("ToggleView").register(this,function(t){var e=i.getViewById(t);e?i.toggleView(e):i.app.isShuttingDown||i.app.awaitModuleForView(t).then(function(e){e?i.app.commandRegistry.command("ActivateView").execute(t):i.app.trace.warning("ToggleView: Could not find view '{0}'.".format(t))})}),this.app.commandRegistry.command("DestroyView").register(this,function(e){var t=i.getViewById(e);t?i.destroyView(t):i.app.trace.warning("DestroyView: Could not find view '{0}'.".format(e))})},o.prototype.activateView=function(e){if(!e.id)return this.app.trace.error("ViewManager: Invalid or nonexistent view passed to activateView."),!1;var t=this.getRegionForViewId(e.id);if(t)return t.activateView(e),!0;if(!e.regionName)return this.app.trace.warning("Could not activate view '{0}' - view is not associated with a region.".format(e.id)),!1;if(t=this.getExistingRegionByName(e.regionName))return this.app.applicationReady?(t.hostView(e),t.activateView(e)):this.app.waitUntilApplicationReady().then(function(){setTimeout(function(){t.hostView(e),t.activateView(e)})}),!0;var i=this._getPendingRegionEntryByName(e.regionName);if(i)return d.contains(i.views,e)?this.app.trace.view("View '{0}' re-added to pending region '{1}'.".format(e.id,e.regionName)):i.views.push(e),!1;var n=new c;return n.name=e.regionName,n.views=[e],this._pendingRegions.push(n),!1},o.prototype.deactivateView=function(e){if(!e.id)return this.app.trace.error("ViewManager: Invalid or nonexistent view passed to deactivateView."),!1;var t=this.getRegionForViewId(e.id);return t?(t.deactivateView(e),!0):(this.app.trace.view("Could not find region for view '{0}'.".format(e.id)),!1)},o.prototype.toggleView=function(e){e.isActive?this.deactivateView(e):this.activateView(e)},o.prototype.createView=function(e,t){var i=e.viewId||e.id;if(!i||!this.getViewById(i)){var n=e.typeName||e.type||"geocortex.framework.ui.ViewBase";if(!(t=t||null))try{t=this.app.instantiateFrameworkObject(n,e.libraryId)}catch(e){return this.app.trace.error("Could not instantiate view with type '{0}' - type was not found or view constructor failed.".format(n),e),null}if(null==t)return this.app.trace.error("Could not instantiate view with type '{0}' - type was not found or view constructor failed.".format(n)),null;var o=e.isVisible||e.visible;if(t.id=null==i?"View-"+u.alphaNumericToken():i,t.markupResource=e.markupResource||e.markup,t.regionName=e.regionName||e.region,t.configuration=e.configuration||{},t.isManaged=e.isManaged||!1,t.title.set(e.title||""),t.description.set(e.description),t.iconUri.set(e.iconUri),e.viewModel&&(t.viewModel=e.viewModel),this._views.push(t),this.app._internalDebugEnabled&&this.app.debugModeActive("view")&&this.app._debug.meta.createdManagedView(),t.regionName){var r=this.getExistingRegionByName(t.regionName);if(r)return r.hostView(t),o&&r.activateView(t),t;o&&(t.___shouldActivate=!0);var a=this._getPendingRegionEntryByName(t.regionName);if(a){if(d.contains(a.views,t))return this.app.trace.view("View '{0}' re-added to pending region '{1}'.".format(t.id,t.regionName)),t;a.views.push(t)}else{var s=new c;s.name=t.regionName,s.views=[t],this._pendingRegions.push(s)}return t}var l=p.resourceManager.fetch(t.markupResource,t.libraryId||"inv");return null==l?(this.app.trace.warning("Could not fetch markup resource '{0}' in library '{1}'.".format(t.markupResource,t.libraryId)),null):(t.root=dojo.create("div"),t.root.innerHTML=l,t.root.children&&1===t.root.children.length&&(t.root=t.root.children[0]),t)}this.app.trace.error("Could not create view '{0}' - a view with that ID already exists.".format(i))},o.prototype.create=function(e,t,i,n,o){var r=new l.ViewConfig(null,null,e);r.markupResource=i,r.regionName=n,r.configuration={};var a=this.createView(r);if(null===a)return a;var s=null;try{(s=this.app.instantiateFrameworkObject(t||"geocortex.framework.ui.ViewModelBase",o)).initialize({})}catch(e){return this.app.trace.error("Could not create view model with type '{0}' - type was not found, not a view model, or failed to construct: {1}".format(r.typeName,e.message),e),null}return a.attach(s),this.activateView(a),a},o.prototype.destroyView=function(e){if(e&&e.id){if(!e.isDestroyed()){this.app.trace.view("destroy view: "+e.id);for(var t=this.getRegionForViewId(e.id),i=window.document.activeElement;i;){if(e.root===i){window.document.activeElement.blur();break}i=i.parentElement}if(null!=t&&(t.deactivateView(e),t.unhostView(e)),e.destroy(),this.app._internalDebugEnabled&&this.app.debugModeActive("view")&&(-1===this._views.indexOf(e)?this.app._debug.meta.destroyedView():this.app._debug.meta.destroyedManagedView()),null!=e.childRegions)for(var n=e.childRegions.length-1;0<=n;n--)this.destroyRegion(e.childRegions[n]);if(e.childRegions.length=0,null!=e.root){var o=new dojo.NodeList;o.push(e.root),o.orphan()}d.removeItem(this._views,e),e.onDestroy()}}else this.app.trace.view("ViewManager: Invalid or nonexistent view passed to destroyView.")},o.prototype.destroyRegion=function(e){if(e){if(this.app.trace.view("destroy region: "+e.name),null!=e.views)for(var t=e.views.length-1;0<=t;t--)this.destroyView(e.views[t]);d.removeItem(this._hostedRegions,e),e.unhost()}else this.app.trace.error("ViewManager: Invalid or nonexistent region passed to destroyRegion.")},o.prototype.discoverRegions=function(e,g){var f=this;null!=e&&dojo.query("[data-region-name]",e).forEach(function(e){var t=dojo.attr(e,"data-region-name"),i=f.getExistingRegionByName(t);if(i)i.domElement!==e&&f.app.trace.error("Region '{0}' already exists.".format(t));else{var n=f._getPendingRegionEntryByName(t),o=null;n&&f._removePendingRegionEntry(t);var r=dojo.attr(e,"data-region-adapter"),a=null;try{r=r||"geocortex.framework.ui.DivRegionAdapter",a=dojo.getObject(r,!0),o=new a(t,f.app)}catch(e){return f.app.trace.error("Could not instantiate region with type '{0}' - type was not found.".format(r),e),null}var s=dojo.attr(e,"data-region-options"),l={};if(s)for(var d=s.split(","),u=0;u<d.length;u++){var p=d[u].split("=");l[p[0]]=1<p.length?p[1]:""}if(o.host(e,l),f._hostedRegions.push(o),null!=g&&(g.childRegions.push(o),o.ownerView=g),n)for(var c=0,v=n.views;c<v.length;c++){var h=v[c];f._views.push(h),f.app._internalDebugEnabled&&f.app.debugModeActive("view")&&f.app._debug.meta.createdManagedView(),o.hostView(h),h.___shouldActivate&&(delete h.___shouldActivate,o.activateView(h))}f.app.waitUntilApplicationReady().then(function(){f.app.loadModulesForRegion(o.name)})}})},o.prototype.getExistingRegionByName=function(e){for(var t=0,i=this._hostedRegions;t<i.length;t++){var n=i[t];if(n.name===e)return n}return null},o.prototype._getPendingRegionEntryByName=function(e){for(var t=0,i=this._pendingRegions;t<i.length;t++){var n=i[t];if(n.name===e)return n}return null},o.prototype._removePendingRegionEntry=function(e){for(var t=-1,i=0;i<this._pendingRegions.length;++i)if(this._pendingRegions[i].name===e){t=i;break}return-1<t&&(d.remove(this._pendingRegions,t,t),!0)},o.prototype.getRegionForViewId=function(e){for(var t=0,i=this._hostedRegions;t<i.length;t++)for(var n=i[t],o=0,r=n.views;o<r.length;o++)if(r[o].id===e)return n;return null},o.prototype.getViewById=function(e){for(var t=0,i=this._views;t<i.length;t++){var n=i[t];if(n.id&&n.id===e)return n}},o.prototype.getViews=function(){return this._views},o.prototype.notifyDimensionsChanged=function(e){var t=this.getRegionForViewId(e.id),i=new n.ViewDimensionsChangedArgs(e,t);this.app.eventRegistry.event("ViewDimensionsChangedEvent").publish(i)},o);function o(e){this._views=[],this._hostedRegions=[],this._pendingRegions=[],this.app=e,this._registerCommands()}t.ViewManager=i})},"geocortex/framework/ui/ViewModelBase":function(){var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","./../FrameworkObject"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=(n=i.FrameworkObject,a(r,n),r.prototype.initialize=function(e){},r.prototype.getResource=function(e,t){return this.app.getResource(this.libraryId,e,t)},r);function r(e,t){return n.call(this,e,t)||this}t.ViewModelBase=o})}}});require({cache:{"geocortex/framework/utils/ArrayUtils":function(){define(["require","exports","./Tuple"],function(t,e,o){"use strict";var l=this;Object.defineProperty(e,"__esModule",{value:!0});var r,n,u=function(t,e){return t===e?0:e<t?1:-1};function i(t,e,r){var n=t.slice((r||e)+1||t.length);return t.length=e<0?t.length+e:e,t.push.apply(t,n)}function a(t,e){var r=s(t,e);return-1===r?null:i(t,r,r)}function c(t,e){for(var r=t.length;r--;)if(t[r]===e)return!0;return!1}function s(t,e){for(var r=t.length;r--;)if(t[r]===e)return r;return-1}function f(t){return"function"==typeof t||"[object Function]"===r.call(t)}function p(t){var e=function(t){var e=Number(t);return isNaN(e)?0:0!==e&&isFinite(e)?(0<e?1:-1)*Math.floor(Math.abs(e)):e}(t);return Math.min(Math.max(e,0),n)}e.firstOrDefault=function(t,e){var r=t?t.length:0;if(null==e&&0<r)return t[0];for(var n=0;n<r;n++){var i=t[n];if(e(i,n))return i}return null},e.lastOrDefault=function(t,e){var r=t?t.length:0;if(null==e&&0<r)return t[r-1];for(var n=r-1;0<=n;n--){var i=t[n];if(e(i,n))return i}return null},e.orderBy=function(t,i){return t?t.slice().sort(function(t,e){var r=i(t),n=i(e);return r instanceof o.Tuple?o.Tuple.compare(r,n):u(r,n)}):[]},e.orderByDescending=function(t,i){return t?t.slice().sort(function(t,e){var r=i(t),n=i(e);return r instanceof o.Tuple?o.Tuple.compare(n,r):u(n,r)}):[]},e.groupBy=function(t,e){var r={},n=[];if(t&&e){for(var i=0,o=t;i<o.length;i++){var u=o[i],a=e(u),c=JSON.stringify(a);r.hasOwnProperty(c)?r[c].items.push(u):r[c]={key:a,items:[u]}}for(var l in r)r.hasOwnProperty(l)&&n.push(r[l])}return n},e.distinct=function(t){return t?t.filter(function(t,e,r){return null!=t&&r.indexOf(t)===e}):[]},e.difference=function(t,e){return t?e?t.filter(function(t){return e.indexOf(t)<0}):t.slice(0):[]},e.remove=i,e.removeItem=a,e.contains=c,e.pos=s,e.returnTop=function(t,e){var r=[];for(var n in t)t.hasOwnProperty(n)&&r.push([n,t[n]]);return r.sort(function(t,e){return t=t[1],(e=e[1])<t?-1:t<e?1:0}),r.slice(0,e)},e.flatten=function(t){return t?[].concat.apply([],t):t},Array.prototype.indexOf||(Array.prototype.indexOf=function(t){if(null==this)throw new TypeError;var e=Object(this),r=e.length>>>0;if(0==r)return-1;var n=0;if(1<arguments.length&&((n=Number(arguments[1]))!=n?n=0:0!==n&&n!==1/0&&n!==-1/0&&(n=+(0<n||-1)*Math.floor(Math.abs(n)))),r<=n)return-1;for(var i=0<=n?n:Math.max(r-Math.abs(n),0);i<r;i++)if(i in e&&e[i]===t)return i;return-1}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(t){if(null==this)throw new TypeError;var e=Object(this),r=e.length>>>0;if(0==r)return-1;var n=r;1<arguments.length&&((n=Number(arguments[1]))!=n?n=0:0!==n&&n!==1/0&&n!==-1/0&&(n=+(0<n||-1)*Math.floor(Math.abs(n))));for(var i=0<=n?Math.min(n,r-1):r-Math.abs(n);0<=i;i--)if(i in e&&e[i]===t)return i;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(t,e){var r,n;if(null==this)throw new TypeError("this is null or not defined");var i=Object(this),o=i.length>>>0;if("[object Function]"!=={}.toString.call(t))throw new TypeError(t+" is not a function");for(e&&(r=e),n=0;n<o;){var u=void 0;Object.prototype.hasOwnProperty.call(i,n)&&(u=i[n],t.call(r,u,n,i)),n++}}),Array.prototype.every||(Array.prototype.every=function(t){if(null==this)throw new TypeError;var e=Object(this),r=e.length>>>0;if("function"!=typeof t)throw new TypeError;for(var n=arguments[1],i=0;i<r;i++)if(i in e&&!t.call(n,e[i],i,e))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(t){if(null==this)throw new TypeError;var e=Object(this),r=e.length>>>0;if("function"!=typeof t)throw new TypeError;for(var n=arguments[1],i=0;i<r;i++)if(i in e&&t.call(n,e[i],i,e))return!0;return!1}),Array.prototype.filter||(Array.prototype.filter=function(t){if(null==this)throw new TypeError;var e=Object(this),r=e.length>>>0;if("function"!=typeof t)throw new TypeError;for(var n=[],i=arguments[1],o=0;o<r;o++)if(o in e){var u=e[o];t.call(i,u,o,e)&&n.push(u)}return n}),Array.prototype.map||(Array.prototype.map=function(t,e){var r,n,i;if(null==l)throw new TypeError(" this is null or not defined");var o=Object(l),u=o.length>>>0;if("function"!=typeof t)throw new TypeError(t+" is not a function");for(e&&(r=e),n=new Array(u),i=0;i<u;){var a=void 0,c=void 0;i in o&&(a=o[i],c=t.call(r,a,i,o),n[i]=c),i++}return n}),Array.prototype.find||(Array.prototype.find=function(t){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var e,r=Object(this),n=r.length>>>0,i=arguments[1],o=0;o<n;o++)if(e=r[o],t.call(i,e,o,r))return e}),Array.prototype.findIndex||(Array.prototype.findIndex=function(t){if(null===this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var e,r=Object(this),n=r.length>>>0,i=arguments[1],o=0;o<n;o++)if(e=r[o],t.call(i,e,o,r))return o;return-1}),Array.from||(Array.from=(r=Object.prototype.toString,n=Math.pow(2,53)-1,function(t,e,r){var n=Object(t);if(null==t)throw new TypeError("Array.from requires an array-like object - not null or undefined");var i,o=1<arguments.length?e:void 0;if(void 0!==o){if(!f(o))throw new TypeError("Array.from: when provided, the second argument must be a function");2<arguments.length&&(i=r)}for(var u,a=p(n.length),c=f(this)?Object(new this(a)):new Array(a),l=0;l<a;)u=n[l],c[l]=o?void 0===i?o(u,l):o.call(i,u,l):u,l+=1;return c.length=a,c})),Array.prototype.includes||(Array.prototype.includes=function(t){return!!~this.indexOf(t)}),Array.remove=i,Array.removeItem=a,Array.contains=c,Array.pos=s})},"geocortex/framework/utils/DateFormatters":function(){define(["require","exports"],function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DateFormatters={d:function(t){return t.getDate()+""},dd:function(t){return o(t.getDate(),2)},f:function(t){return r(t.getMilliseconds()/1e3,1,!1)},ff:function(t){return r(t.getMilliseconds()/1e3,2,!1)},fff:function(t){return r(t.getMilliseconds()/1e3,3,!1)},ffff:function(t){return r(t.getMilliseconds()/1e3,4,!1)},fffff:function(t){return r(t.getMilliseconds()/1e3,5,!1)},ffffff:function(t){return r(t.getMilliseconds()/1e3,6,!1)},fffffff:function(t){return r(t.getMilliseconds()/1e3,7,!1)},F:function(t){return r(t.getMilliseconds()/1e3,1,!0)},FF:function(t){return r(t.getMilliseconds()/1e3,2,!0)},FFF:function(t){return r(t.getMilliseconds()/1e3,3,!0)},FFFF:function(t){return r(t.getMilliseconds()/1e3,4,!0)},FFFFF:function(t){return r(t.getMilliseconds()/1e3,5,!0)},FFFFFF:function(t){return r(t.getMilliseconds()/1e3,6,!0)},FFFFFFF:function(t){return r(t.getMilliseconds()/1e3,7,!0)},h:function(t){var e=t.getHours();return 12<e&&(e-=12),o(e,1)},hh:function(t){var e=t.getHours();return 12<e&&(e-=12),o(e,2)},H:function(t){return o(t.getHours(),1)},HH:function(t){return o(t.getHours(),2)},m:function(t){return o(t.getMinutes(),1)},mm:function(t){return o(t.getMinutes(),2)},M:function(t){return o(t.getMonth()+1,1)},MM:function(t){return o(t.getMonth()+1,2)},s:function(t){return o(t.getSeconds(),1)},ss:function(t){return o(t.getSeconds(),2)},y:function(t){return o(t.getFullYear(),1)},yy:function(t){return o(t.getFullYear(),2)},yyy:function(t){return o(t.getFullYear(),3)},yyyy:function(t){return o(t.getFullYear(),4)},yyyyy:function(t){return o(t.getFullYear(),5)}};var o=function(t,e){for(var r=e-(t+="").length,n=[];n.length<r;)n.push("0");return n.join("")+t},r=function(t,e,r){var n=Math.floor(t*Math.pow(10,e)),i=o(n,e);return r?u(i):i},u=function(t){return(t+="").replace(/0*$/g,"")}})},"geocortex/framework/utils/DateUtils":function(){define(["require","exports"],function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=/(Z|([+-][012]\d(:?\d\d)?))\s*$/;e.containsTimezone=function(t){return r.test(t)};var n,i=null,o=null;function u(){return null===i&&(i=(new Date).getTimezoneOffset()),i}function a(t){var e=String(t);return 1===e.length&&(e="0"+e),e}e.getTimezoneOffset=u,e.getTimezoneString=function(){if(null==o){var t=u(),e=Math.floor(t/60),r=Math.floor(t-60*e);if(0==e&&0==r)return"Z";o=e<0?(e*=-1,"+"):"-",o+=0==e?"00":e<10?"0"+e:e,o+=0==r?":00":r<10?":0"+r:":"+r}return o},n=new Date("2011-06-02T09:34:29+02:00"),Date.fromISO=n&&1307000069e3==+n?function(t){return new Date(t)}:function(t){var e,r,n=/^(\d{4}\-\d\d\-\d\d([tT ][\d:\.]*)?)([zZ]|([+\-])(\d\d):(\d\d))?$/.exec(t)||[];if(n[1]){for(var i=0,o=(e=n[1].split(/\D/)).length;i<o;i++)e[i]=parseInt(e[i],10)||0;return e[1]-=1,(e=new Date(Date.UTC.apply(Date,e))).getDate()?(n[5]&&(r=60*parseInt(n[5],10),n[6]&&(r+=parseInt(n[6],10)),"+"==n[4]&&(r*=-1),r&&e.setUTCMinutes(e.getUTCMinutes()+r)),e):NaN}return NaN},Date.prototype.toISOString||(Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"})})},"geocortex/framework/utils/Grouping":function(){define(["require","exports"],function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0})})},"geocortex/framework/utils/HttpsUtils":function(){define(["require","exports"],function(t,e){"use strict";function r(){var t=window.location.protocol;t.indexOf(":")<0&&(t+=":");var e=window.location.pathname.lastIndexOf("/"),r="/";-1<e&&(r=window.location.pathname.substr(0,e)),""===r&&(r="/");var n=t+"//"+window.location.host.trim()+r.trim();return"/"!==n.charAt(n.length-1)&&(n+="/"),n}function n(t){var e=t.trim();return-1<e.indexOf("://")&&5<=e.length&&"https"===e.substring(0,5)}Object.defineProperty(e,"__esModule",{value:!0}),e.isHttpsMode=function(){return n(r())},e.getHost=r,e.isHttpsUri=n})},"geocortex/framework/utils/String":function(){define(["require","exports","./DateFormatters"],function(t,e,p){"use strict";if(Object.defineProperty(e,"__esModule",{value:!0}),!String.prototype.format){var h=new RegExp("(d{1,4}|f{1,7}|F{1,7}|g{1,2}|h{1,2}|H{1,2}|K|m{1,2}|M{1,4}|s{1,2}|t{1,2}|y{1,5}|z{1,3}|:|\\/|[^d{1,4}|f{1,7}|F{1,7}|g{1,2}|h{1,2}|H{1,2}|K|m{1,2}|M{1,4}|s{1,2}|t{1,2}|y{1,5}|z{1,3}|:|\\/])","g"),r="\0MAGIC\0",n=/{{/g,i=/{(\d+)(?::([^}]*))?}/g;String.prototype.format=function(){var f=arguments,t=this.replace(n,r);return(t=t.replace(i,function(t,e,r){var n=f[e];if(!(r&&n instanceof Date))return n;for(var i=n,o=[],u=0,a=r.match(h);u<a.length;u++){var c=a[u],l=p.DateFormatters[c];if(l){var s=l.call(this,i);o.push(s)}else o.push(c)}return o.join("")})).replace(new RegExp(r,"g"),"{").replace(/}}/g,"}")}}String.format=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return t.format.apply(t,e)},String.quickHashCode=function(t){var e,r=0;if(0===t.length)return r;for(e=0;e<t.length;e++)r=(r<<5)-r+t.charCodeAt(e),r&=r;return r},String.escapeHtml=function(t){return null==t?t:t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},String.unescapeHtml=function(t){return null==t?t:t.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&#x2F;/g,"/")},String.escapeHtmlEncode=function(t){var e=document.createElement("div");return e.appendChild(document.createTextNode(t)),e.innerHTML},String.isNullOrEmpty=function(t){return null==t||0===t.length},String.prototype.reverse=function(){return this.split("").reverse().join("")},String.prototype.trimString=function(t){return t?this.ltrim(t).rtrim(t):this.trim()},String.prototype.ltrim=function(t){if(!t)return this.replace(/^\s+/gm,"");for(var e=this,r=this.length;e.startsWith(t)&&0<=r;)e=e.substring(t.length),--r;return e},String.prototype.rtrim=function(t){if(!t)return this.reverse().replace(/^\s+/gm,"").reverse();for(var e=this,r=this.length;e.endsWith(t)&&0<=r;)e=e.substring(0,e.length-t.length),--r;return e},String.prototype.startsWith=function(t,e){return e=e||0,this.indexOf(t,e)===e},String.prototype.endsWith=function(t,e){e=e||this.length,e-=t.length;var r=this.lastIndexOf(t);return-1!==r&&r===e},String.prototype.replaceAll=function(t,e){return this.split(t).join(e)}})},"geocortex/framework/utils/ThrottledOperation":function(){define(["require","exports"],function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=(n.prototype.cancel=function(){this._setTimeoutToken&&(clearTimeout(this._setTimeoutToken),this._setTimeoutToken=null,this.isActive=!1,this.cancelAction&&this.cancelAction())},n.prototype.execute=function(t){t.isActive=!0;var e=t.action();null!==t._setTimeoutToken&&e?t._setTimeoutToken=setTimeout(function(){t.execute(t)},t.period):(t._setTimeoutToken=null,t.isActive=!1)},n);function n(t,e,r){this.period=100,this.isActive=!1,this._setTimeoutToken=null,this.period=null==t?0:t,this.action=e,this.cancelAction=r;var n=this;this._setTimeoutToken=setTimeout(function(){n.execute(n)},this.period)}e.ThrottledOperation=r})},"geocortex/framework/utils/TimeDelayedOperation":function(){define(["require","exports"],function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=(n.prototype.start=function(){this._timerHandle=setTimeout(this.func,this.delayMS)},n.prototype.stop=function(){clearTimeout(this._timerHandle)},n.prototype.reset=function(){this.stop(),this.start()},n);function n(t,e,r){this.delayMS=0,this.func=null,this.delayMS=t,this.func=r?function(){e.apply(r)}:e}e.TimeDelayedAction=r})},"geocortex/framework/utils/Trace":function(){define(["require","exports","./../utils/utils"],function(t,e,u){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=(n.prototype._traceImpl=function(t,e,r,n,i){if(("debug"!==t&&"trace"!==t||this.app.debugMode)&&this.app){var o=-1<u.activeLogSources.indexOf(r.toLowerCase())||-1<u.activeLogSources.indexOf("all");this.app.event("TraceEvent").publish({level:t,timestamp:new Date,source:r,message:e,stack:n,display:i,visible:o})}},n.prototype._stackTraceFromException=function(t){return void 0!==t?t.stack||t.backtrace||t.stacktrace:null},n.prototype.binding=function(t,e){this.app&&this.app.debugModeActive("binding")&&this._traceImpl("debug",t,e)},n.prototype.event=function(t,e){this.app&&this.app.debugModeActive("event")&&this._traceImpl("debug",t,"Events",null,e)},n.prototype.command=function(t){this.app&&this.app.debugModeActive("command")&&this._traceImpl("debug",t,"Commands")},n.prototype.timer=function(t,e){this.app&&this.app.debugModeActive("time")&&this._traceImpl(e,t,"Timers")},n.prototype.view=function(t){this.app&&this.app.debugModeActive("view")&&this._traceImpl("debug",t,"Views")},n.prototype.debug=function(t){this.app&&this.app.debugMode&&this._traceImpl("debug",t,this._appName)},n.prototype.trace=function(t){this._traceImpl("trace",t,this._appName)},n.prototype.info=function(t){this._traceImpl("info",t,this._appName)},n.prototype.alert=function(t){this._traceImpl("alert",t,this._appName)},n.prototype.warning=function(t){this._traceImpl("warning",t,this._appName)},n.prototype.error=function(t,e){this._traceImpl("error",t,this._appName,this._stackTraceFromException(e))},n.prototype.exception=function(t,e){this._traceImpl("error",t,this._appName,this._stackTraceFromException(e))},n);function n(t){this._appName="GVH",this.app=t}e.Trace=r})},"geocortex/framework/utils/Tuple":function(){define(["require","exports"],function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=(n.equals=function(t,e){return null===t?null===e:t.item1===e.item1&&t.item2===e.item2&&t.item3===e.item3&&t.item4===e.item4&&t.item5===e.item5},n.compare=function(t,e){function r(t,e){return null===t?null===e?0:-1:t===e?0:e<t?1:-1}return r(t.item1,e.item1)||r(t.item2,e.item2)||r(t.item3,e.item3)||r(t.item4,e.item4)||r(t.item5,e.item5)},n);function n(t,e,r,n,i){this.item1=null,this.item2=null,this.item3=null,this.item4=null,this.item5=null,this.item1=t,this.item2=e,null!=r&&void 0!==r&&(this.item3=r),null!=n&&void 0!==n&&(this.item4=n),null!=i&&void 0!==i&&(this.item5=i)}e.Tuple=r})},"geocortex/framework/utils/utils":function(){define(["require","exports"],function(t,e){"use strict";function r(t){return void 0!==t}function n(t){return null===t||!r(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.base64keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",e.isDefined=r,e.isNullOrUndefined=n,e.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},e.isEmptyObject=function(t){return!!t&&0===Object.keys(t).length&&t.constructor===Object},e.isObject=function(t){return t===Object(t)},e.getProp=function(t,e){return e.reduce(function(t,e){return t&&"undefined"!==t[e]?t[e]:void 0},t)},e.makeUrlAbsolute=function(t){if(0===t.indexOf("http"))return t;var e="{0}//{1}{2}".format(window.location.protocol,window.location.host,window.location.pathname);if("/"!==e.charAt(e.length-1)||"\\"!==e.charAt(e.length-1)){var r=e.split("/");--r.length,e=r.join("/"),e+="/"}return t="/"===t.charAt(0)||"\\"===t.charAt(0)?window.location.protocol+"//"+window.location.host+"/"+t.substring(1):e+t},e.alphaNumericToken=function(t){for(var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",r=t||8,n="",i=0;i<r;i++){var o=Math.floor(Math.random()*e.length);n+=e.substring(o,o+1)}return n},e.base64Encode=function(t){var e,r,n,i,o,u,a,c="",l=0;for(t=this.utf8Encode(t);l<t.length;)i=(e=t.charCodeAt(l++))>>2,o=(3&e)<<4|(r=t.charCodeAt(l++))>>4,u=(15&r)<<2|(n=t.charCodeAt(l++))>>6,a=63&n,isNaN(r)?u=a=64:isNaN(n)&&(a=64),c=c+this.base64keyStr.charAt(i)+this.base64keyStr.charAt(o)+this.base64keyStr.charAt(u)+this.base64keyStr.charAt(a);return c},e.base64Decode=function(t){var e,r,n,i,o,u,a="";if(!t||""===t)return a;var c=0;if(/[^A-Za-z0-9\+\/\=]/g.exec(t))throw new Error("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding.");for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");e=this.base64keyStr.indexOf(t.charAt(c++))<<2|(i=this.base64keyStr.indexOf(t.charAt(c++)))>>4,r=(15&i)<<4|(o=this.base64keyStr.indexOf(t.charAt(c++)))>>2,n=(3&o)<<6|(u=this.base64keyStr.indexOf(t.charAt(c++))),a+=String.fromCharCode(e),64!==o&&(a+=String.fromCharCode(r)),64!==u&&(a+=String.fromCharCode(n)),e=r=n=null,i=o=u=null,c<t.length;);return a=this.utf8Decode(a)},e.utf8Encode=function(t){t=t.replace(/\r\n/g,"\n");for(var e="",r=0;r<t.length;r++){var n=t.charCodeAt(r);n<128?e+=String.fromCharCode(n):(127<n&&n<2048?e+=String.fromCharCode(n>>6|192):(e+=String.fromCharCode(n>>12|224),e+=String.fromCharCode(n>>6&63|128)),e+=String.fromCharCode(63&n|128))}return e},e.utf8Decode=function(t){for(var e="",r=0,n=0,i=0,o=0;r<t.length;)(n=t.charCodeAt(r))<128?(e+=String.fromCharCode(n),r++):191<n&&n<224?(i=t.charCodeAt(r+1),e+=String.fromCharCode((31&n)<<6|63&i),r+=2):(i=t.charCodeAt(r+1),o=t.charCodeAt(r+2),e+=String.fromCharCode((15&n)<<12|(63&i)<<6|63&o),r+=3);return e},e.isUrl=function(t){if(!t||"string"!=typeof t)return!1;var e=t.trim().toLowerCase();return 7<=e.length&&0===e.indexOf("http://")||8<=e.length&&0===e.indexOf("https://")},e.isPercentage=function(t){return!n(t)&&/^(\d+|\d*[.]\d+)%$/.test(t)},e.clamp=function(t,e,r){return t<e?e:r<t?r:t},e.addEventListener=function(t,e,r){t.addEventListener?t.addEventListener(e,r,!1):t.attachEvent&&t.attachEvent("on"+e,r)},e.activeLogSources=["all"],e.setActiveLogSources=function(t){e.activeLogSources=t},e.dateToISOStringNoMs=function(t){var e=t.toISOString();return e.substring(0,e.indexOf("."))+e.substring(e.length-1)}})},"geocortex/framework/utils/ViewUtils":function(){define(["require","exports","./utils","../config/ViewConfig","../events/CollectionChangedArgs"],function(t,e,l,s,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createWidgetViewFromConfig=function(t,e,r){var n=t.type,i=t.id?"WidgetView-{0}-{1}".format(t.id,l.alphaNumericToken()):"{0}-{1}".format(l.alphaNumericToken(),l.alphaNumericToken()),o=new s.ViewConfig(i,null,n||"geocortex.framework.ui.ViewBase");o.isVisible=!0,o.libraryId=t.libraryId,t.markup&&(o.markupResource=t.markup);var u=null;(t=r.translateConfiguration(t.libraryId,t)).viewModelId?(u=r.getFrameworkObjectById(t.viewModelId))||r.trace.error("Could not bind widget '{0}' to view model with ID '{1}': View model not found.".format(t.Id,t.viewModelId)):t.viewModelType?(u=r.instantiateFrameworkObject(t.viewModelType,t.libraryId),t.id||(t.id=l.alphaNumericToken()),u.id="WidgetViewModel-{0}-{1}".format(t.id,l.alphaNumericToken())):u=e;var a=r.viewManager.createView(o);a||r.trace.error("Could not create widget '{0}': The widget's view could not be created.".format(t.Id)),a.configuration=t.configuration;var c={children:[]};return c.children.push(a.root),a.root=c,a.attach(u),a.root=c.children[0],a},e.isTruthy=function(t){if(!t)return!1;if(!(t instanceof r.CollectionChangedArgs))return t.isObservableCollection?0<t.getLength():t.isObservable?!!t.get():!!t||"string"==typeof t&&0<t.length;var e=t;if("append"===e.type){if(0<e.rangeEnd+1-e.rangeStart||e.sender.value&&0<e.sender.value.length)return!0}else{if("clear"===e.type)return!1;if("insert"===e.type){if(0<e.rangeEnd+1-e.rangeStart)return!0}else if("remove"===t.type&&e.rangeEnd+1-e.rangeStart<e.sender.value.length)return!0}},e.optionMatchesValue=function(t,e,r){if(void 0!==t.___attachedValue){var n=t.___attachedValue;return n===(l.isNullOrUndefined(e)?r:e)||("number"==typeof n||"boolean"==typeof n?n=n.toString():n&&n.hasOwnProperty("value")&&(n=n.value,r.hasOwnProperty("value")&&(r=r.value),"number"!=typeof n&&"boolean"!=typeof n||(n=n.toString())),n===(l.isNullOrUndefined(e)?r:e))}var i=l.isNullOrUndefined(e)?r:e;return t.value===i},e.cancelAllThrottledOperations=function(t){if(t.useThrottling&&t.throttledOperations&&t.throttledOperations.length)for(var e=t.throttledOperations.length-1;0<=e;e--)t.throttledOperations[e].cancel(),t.throttledOperations.splice(e,1)}})}}});