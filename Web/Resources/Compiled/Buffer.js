function shim(e,t,r){if("string"==typeof e&&(r=t,t=e),"undefined"==typeof r)return void console.warn("Undefined shim for: "+t);for(var i=t.split("."),n=null,a=window,o=0,s=i.length;o<s;o++)n=i[o],o==s-1?a[n]=r:a[n]||(a[n]={}),a=a[n]}require({cache:{"Mapping/modules/Buffer/BufferModule":function(){define(["require","exports","geocortex/framework/application/ModuleBase","geocortex/infrastructure/buffer/BufferUtils","geocortex/framework/utils/utils","geocortex/infrastructure/GeometryUtils","geocortex/infrastructure/Feature","geocortex/infrastructure/FeatureSet","geocortex/infrastructure/FeatureSetCollection","geocortex/framework-ui/animation/AnimationSequence","geocortex/infrastructure/SymbolUtils","geocortex/infrastructure/GraphicsLayerUtils","geocortex/infrastructure/commandArgs/AddStatusArgs"],function(e,t,r,i,n,a,o,s,u,f,c,p,l){"use strict";var d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.targetCommandSettings={},t._bufferWkid=-1,t._bufferSpatialReference=null,t._geodesic=!0,t._extentExpansionFactor=1.25,t._statusMsgTimers={},t.DEFAULT_NUM_FEATURES_WARNING_THRESHOLD=250,t.BUFFERING_STATUS_DISPLAY_DELAY=300,t}return __extends(t,e),t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this._bufferWkid=t&&t.bufferProjectionWkid&&""!=t.bufferProjectionWkid?parseInt(t.bufferProjectionWkid,10):-1,void 0!=t.geodesic?this._geodesic=!!t.geodesic:this._geodesic=this._bufferWkid===-1,this._bufferWkid!==-1&&(this._bufferSpatialReference=new esri.SpatialReference(this._bufferWkid)),this._bufferLayerId=t.bufferLayerName?t.bufferLayerName:"Buffering",this._lineColor=t.lineColor?new esri.Color(t.lineColor):new esri.Color("#cf4c40"),this._fillColor=t.fillColor?new esri.Color(t.fillColor):new esri.Color("#cf4c40"),this._numFeaturesWarningThreshold=void 0!=t.numFeaturesWarningThreshold?parseInt(t.numFeaturesWarningThreshold,10):this.DEFAULT_NUM_FEATURES_WARNING_THRESHOLD,this.app.map&&this.app.map.loaded?this.onMapLoaded():this.app.event("MapLoadedEvent").once(this,this.onMapLoaded)},t.prototype.registerCommands=function(){this.app.command("ActivateBuffering").register(this,this.executeActivateBuffering),this.app.command("DeactivateBuffering").register(this,this.executeDeactivateBuffering),this.app.command("BufferGeometry").register(this,this.executeBufferGeometry,this.canExecuteBufferGeometry),this.app.command("IdentifyBufferedGeometry").register(this,this.executeIdentifyBufferedGeometry,this.canExecuteIdentifyBufferedGeometry),this.app.command("IdentifyBufferedFeature").register(this,this.executeIdentifyBufferedFeature,this.canExecuteIdentifyBufferedFeature),this.app.command("IdentifyBufferedFeatureSet").register(this,this.executeIdentifyBufferedFeatureSet,this.canExecuteIdentifyBufferedFeatureSet),this.app.command("IdentifyBufferedFeatureSetCollection").register(this,this.executeIdentifyBufferedFeatureSetCollection,this.canExecuteIdentifyBufferedFeatureSetCollection)},t.prototype.subscribeEvents=function(){this.app.event("BufferDistanceChangedEvent").subscribe(this,this.handleBufferDistanceChangedEvent)},t.prototype.onMapLoaded=function(){this.registerCommands(),this.subscribeEvents();var e=this.app.map.spatialReference;this._geodesic=!(void 0==e.wkid||!i.isGeographicWkid(e.wkid))||this._geodesic,this._bufferSpatialReference||(this._bufferSpatialReference=e)},t.prototype.executeActivateBuffering=function(e){this._setCmdBufferStatusAndRaiseEvent(e,!0)},t.prototype.executeDeactivateBuffering=function(e){this._setCmdBufferStatusAndRaiseEvent(e,!1)},t.prototype.handleBufferDistanceChangedEvent=function(e){if(e&&e.targetCommands)for(var t=0;t<e.targetCommands.length;t++){var r=e.targetCommands[t],i=this.targetCommandSettings[r];i?(i.bufferDistance=e.distance,i.bufferUnit=e.unit.config,i.writeToMarkupLayer=e.writeToMarkupLayer):i=this._createEntryForTargetCommand(r,e.distance,e.unit.config),this._updateTargetCommandToolStatusMessages(r,i)}},t.prototype.executeBufferGeometry=function(e){var t=this;if(this._performBufferOperation(e)){var r=void 0==e.bufferId?n.alphaNumericToken():e.bufferId;this._addBufferingStatusMsg(r),i.bufferGeometry(this.app,e).then(function(i){t._processBufferResults(i,e),t._removeBufferingStatusMsg(r)},function(i){t._reportBufferingError(i,e.errback),t._removeBufferingStatusMsg(r)})}},t.prototype.executeBufferGeometries=function(e){var t=this;if(this._performBufferOperation(e)){var r=function(){var r=void 0==e.bufferId?n.alphaNumericToken():e.bufferId;t._addBufferingStatusMsg(r),i.bufferGeometries(t.app,e).then(function(i){t._processBufferResults(i,e),t._removeBufferingStatusMsg(r)},function(i){t._reportBufferingError(i,e.errback),t._removeBufferingStatusMsg(r)})};e.geometries.length>this._numFeaturesWarningThreshold?this.app.command("Confirm").execute(this.app.getResource(this.libraryId,"language-buffer-excess-features-warning").format(e.geometries.length),null,function(e){e&&r()}):r()}},t.prototype.canExecuteBufferGeometry=function(e){return!!e.geometry&&a.isValidGeometry(e.geometry)&&(e.bufferUnit&&null!=e.bufferDistance&&!isNaN(Number(e.bufferDistance))||!!e.sourceCommand)},t.prototype.executeIdentifyBufferedGeometry=function(e){var t="IdentifyBufferedGeometry";e&&this._showBufferOptionsAndExecuteBufferGeometry(t,e)},t.prototype.canExecuteIdentifyBufferedGeometry=function(e){return!!e&&a.isValidGeometry(e)},t.prototype.executeIdentifyBufferedFeature=function(e){var t=e instanceof esri.Graphic?e.geometry:e&&e.esriFeature.get()?e.esriFeature.get().geometry:null,r="IdentifyBufferedFeature";t&&this._showBufferOptionsAndExecuteBufferGeometry(r,t)},t.prototype.canExecuteIdentifyBufferedFeature=function(e){var t=null;return e&&e instanceof esri.Graphic?t=e.geometry:e&&e instanceof o.Feature&&e.esriFeature&&e.esriFeature.get()&&(t=e.esriFeature.get().geometry),!!t&&a.isValidGeometry(t)},t.prototype.executeIdentifyBufferedFeatureSet=function(e){var t="IdentifyBufferedFeatureSet",r=null;if("string"==typeof e&&(e=this.app.featureSetManager.getCollectionById(e)),e instanceof u.FeatureSetCollection){var i=e.featureSets.get().filter(function(e){return e.isSelectedInCollection.get()});r=i[0]||e.featureSets.get()[0]||null}if(e instanceof s.FeatureSet&&(r=e),r){var n=this._retrieveGeometries(r);n.length&&this._showBufferOptionsAndExecuteBufferGeometries(t,n)}else{var a=this.app.getResource(this.libraryId,"language-buffer-error-identify-buffered-feature-set");this._reportBufferingError(this._generateErrorObjFromString(a,t))}},t.prototype.canExecuteIdentifyBufferedFeatureSet=function(e){return e&&"string"==typeof e?!!this.app.featureSetManager.getCollectionById(e):!!e},t.prototype.executeIdentifyBufferedFeatureSetCollection=function(e){var t="IdentifyBufferedFeatureSetCollection",r="string"==typeof e?this.app.featureSetManager.getCollectionById(e):e;if(r){var i=this._retrieveGeometries(r);i.length&&this._showBufferOptionsAndExecuteBufferGeometries(t,i)}else{var n=this.app.getResource(this.libraryId,"language-buffer-error-identify-buffered-feature-set-collection");this._reportBufferingError(this._generateErrorObjFromString(n,t))}},t.prototype.canExecuteIdentifyBufferedFeatureSetCollection=function(e){return e&&"string"==typeof e?!!this.app.featureSetManager.getCollectionById(e):!!e},t.prototype._createEntryForTargetCommand=function(e,t,r,i){if(e&&!this.targetCommandSettings[e]){var n={};return n.isActive=!!i,n.bufferDistance=t||null,n.bufferUnit=r||null,this.targetCommandSettings[e]=n,n}},t.prototype._performBufferOperation=function(e){if(!this._processBufferArgs(e)){var t=this.targetCommandSettings[e.sourceCommand];if(!t||t&&!t.isActive){var r={};return r.bufferId=e.bufferId,r.sourceCommand=e.sourceCommand,r.geometry=e.geometry,r.geometries=e.geometries,e.callback(r),!1}var i=this.app.getResource(this.libraryId,"language-buffer-error-process-args");return void this._reportBufferingError(this._generateErrorObjFromString(i,e.sourceCommand,e.bufferId),e.errback)}return!0},t.prototype._processBufferArgs=function(e){if(e.bufferSpatialReference=e.bufferSpatialReference||this._bufferSpatialReference,e.outSpatialReference=this.app.map.spatialReference,e.geodesic=void 0!=e.geodesic?e.geodesic:this._geodesic,e.bufferId=void 0==e.bufferId?n.alphaNumericToken():e.bufferId,(void 0==e.bufferDistance||void 0==e.bufferUnit)&&e.sourceCommand){var t=this.targetCommandSettings[e.sourceCommand];if(t&&t.isActive&&void 0!=t.bufferDistance&&t.bufferUnit&&(e.bufferDistance=t.bufferDistance,e.bufferUnit=t.bufferUnit,e.writeToMarkupLayer=t.writeToMarkupLayer),t&&t.isActive&&(void 0==t.bufferDistance||void 0==t.bufferUnit))return!1}return void 0!=e.bufferDistance&&void 0!=e.bufferUnit},t.prototype._processBufferResults=function(e,t){var r=this,i=e.geometry||e.geometries,n=function(i){if("point"!==i.type){var n=i.getExtent(),a=n.expand(r._extentExpansionFactor);r.app.map.extent.contains(a)||r.app.command("ZoomToExtent").execute(a)}if(t.writeToMarkupLayer)r.app.command("AddMarkupGeometry").execute(i);else{var o=r._addGeometryMarkup(i);$(document.body).one("mouseup touchend keydown",function(e){return r._removeGeometryMarkup(o)})}t.callback&&dojo.isFunction(t.callback)&&t.callback(e),r.app.event("BufferingCompletedEvent").publish(e)};if(dojo.isArray(i)){if(i.length<1)return void this._reportBufferingError(this._generateErrorObjFromString(this.app.getResource(this.libraryId,"language-buffer-error-invalid-results"),t.sourceCommand,t.bufferId),t.errback);if(1===i.length)return void n(i[0]);a.unionGeometries(i).then(function(t){e.geometry=t,n(t)},function(e){r._reportBufferingError(r._generateErrorObjFromString(r.app.getResource(r.libraryId,"language-buffer-error-union-operation"),t.sourceCommand,t.bufferId),t.errback)})}else n(i)},t.prototype._setCmdBufferStatusAndRaiseEvent=function(e,t){var r=this,i=function(e){var i=r.targetCommandSettings[e];i?i.isActive=t:i=r._createEntryForTargetCommand(e,null,null,!0),r._updateTargetCommandToolStatusMessages(e,i)};if("string"==typeof e)i(e);else{if(!e.length)return;e.forEach(function(e){return i(e)})}t?this.app.event("BufferingActivatedEvent").publish(e):this.app.event("BufferingDeactivatedEvent").publish(e)},t.prototype._retrieveGeometries=function(e){var t=[],r=[];e instanceof s.FeatureSet&&r.push(e),e instanceof u.FeatureSetCollection&&(r=e.featureSets.get());for(var i=0;i<r.length;i++)for(var n=r[i],o=0;o<n.features.length();o++){var f=n.features.getAt(o),c=f.esriFeature.get()?f.esriFeature.get().geometry:null;c&&a.isValidGeometry(c)&&t.push(c)}return t},t.prototype._showBufferOptionsAndExecuteBufferGeometry=function(e,t){this._showBufferOptionsAndExecuteBufferGeometries(e,[t])},t.prototype._showBufferOptionsAndExecuteBufferGeometries=function(e,t){var r=this,i=function(i){var n={};n.geometries=t,n.callback=function(e){return r._performIdentifyForGeometry(e,!0)},n.sourceCommand=e,n.unionResults=!0,r.executeActivateBuffering(e),r.executeBufferGeometries(n),r.app.command("DeactivateBufferingAndDismissOptions").execute(e)},n={targetCommand:e,delegateFunction:i};this.app.command("DisplayBufferOptions").execute(n)},t.prototype._performIdentifyForGeometry=function(e,t){var r=this;void 0===t&&(t=!1);var i=e.geometry||(e.geometries&&1===e.geometries.length?e.geometries[0]:null);if(i){var n={};n.geometry=i,n.source="Identify",n.layerRestriction=function(e){return e.identifiable},n.doNotBuffer=t,f.runWhenIdle(function(){r.app.command("Identify").execute(n)})}},t.prototype._generateErrorObjFromString=function(e,t,r){var i={};return i.sourceCommand=t,i.error=new Error(e),void 0!=r&&(i.bufferId=r),i},t.prototype._reportBufferingError=function(e,t){this.app.event("BufferingErrorEvent").publish(e),t&&dojo.isFunction(t)&&t(e)},t.prototype._updateTargetCommandToolStatusMessages=function(e,t){var r=this,n=this._getToolsByCommand(e);if(n&&n.length){var a=function(e){if(e.isActive){var t=e.name+"StatusMessageView",i={id:t,text:e.statusText,closeButton:{}};r.app.command("DisplayNotification").execute(i)}},o=function(e){e.originalStatusText||(e.originalStatusText=e.statusText);var n=i.getUnitDescFromConfig(t.bufferUnit).displayName,o=r.app.getResource(r.libraryId,"language-buffer-active-tool-addon-message").format(t.bufferDistance,n);e.statusText="{0} {1}".format(e.originalStatusText,o),a(e)},s=function(e){e.originalStatusText&&(e.statusText=e.originalStatusText,delete e.originalStatusText,a(e))},u=function(e){t.isActive&&null!=t.bufferDistance&&t.bufferUnit?o(e):s(e)};n.forEach(function(e){return u(e)})}},t.prototype._getToolsByCommand=function(e){var t=[],r=this.app.toolRegistry.tools;for(var i in r){if(!r.hasOwnProperty(i))return;var n=r[i];n.command===e&&t.push(n)}return t},t.prototype._addGeometryMarkup=function(e){var t=new esri.Graphic;t.setGeometry(e);var r;"polygon"===t.geometry.type||"extent"===t.geometry.type?(r=c.defaultFillSymbol(),r.setColor(this._fillColor),r.color.a=.3,r.outline.setColor(this._lineColor)):"polyline"===t.geometry.type?(r=c.defaultLineSymbol(),r.setColor(this._lineColor)):(r=c.defaultMarkerSymbol(),r.setColor(this._lineColor)),t.setSymbol(r);var i=p.getInternalGraphicsLayer(this._bufferLayerId,this.app,p.GraphicsLayerType.Markup);return i&&p.addGraphicToLayer(t,this._bufferLayerId,this.app),t},t.prototype._removeGeometryMarkup=function(e){var t=this.app.map.getLayer(this._bufferLayerId);t&&e&&t.remove(e)},t.prototype._addBufferingStatusMsg=function(e){if(e){var t=setTimeout(dojo.hitch(this,function(){var t=this.app.getResource(this.libraryId,"language-buffer-status-msg"),r=new l.AddStatusArgs(t);r.id=e,r.showBusyIcon=!0,r.timeoutMS=0,this.app.command("AddStatus").execute(r)}),this.BUFFERING_STATUS_DISPLAY_DELAY);this._statusMsgTimers[e]=t}},t.prototype._removeBufferingStatusMsg=function(e){if(e){var t=this._statusMsgTimers[e];t&&(clearTimeout(t),this.app.command("RemoveStatus").execute(e),delete this._statusMsgTimers[e])}},t}(r.ModuleBase);t.BufferModule=d})},"Mapping/modules/Buffer/BufferOptionsView":function(){define(["require","exports","geocortex/framework/ui/ViewBase"],function(e,t,r){"use strict";var i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._currentTargetCommands=[],t}return __extends(t,e),t.prototype.attach=function(t){if(!(this.configuration&&this.configuration.targetCommands&&this.configuration.targetCommands.length))return void this.app.trace.error(this.app.getResource(this.libraryId,"language-buffer-target-modules-error"));this.masterViewModel=t,t.registerView(this.id,this.configuration.targetCommands);var r=t.getViewModelForView(this.id);r&&(e.prototype.attach.call(this,r),this.registerCommands())},t.prototype.registerCommands=function(){this.app.command("DisplayBufferOptions").register(this,this.executeDisplayBufferOptions,this.canExecuteDisplayBufferOptions),this.app.command("ActivateBufferingAndDisplayOptions").register(this,this.executeActivateBufferingAndDisplayOptions,this.canExecuteDisplayBufferOptions),this.app.command("DeactivateBufferingAndDismissOptions").register(this,this.executeDeactivateBufferingAndDismissOptions,this.canExecuteDisplayBufferOptions)},t.prototype.executeDisplayBufferOptions=function(e){var t="string"==typeof e?e:e.targetCommand,r="string"==typeof e?null:e.delegateFunction;r&&dojo.isFunction(r)&&(this._oneTimeCommandDelegateParams={},this._oneTimeCommandDelegateParams.delegateFunction=r,this._oneTimeCommandDelegateParams.targetCommand=t),this._currentTargetCommands.push(t),this.app.viewManager.activateView(this)},t.prototype.executeActivateBufferingAndDisplayOptions=function(e){var t="string"==typeof e?e:e.targetCommand;this.canExecuteDisplayBufferOptions(t)&&(this.app.command("ActivateBuffering").execute(t),this.app.command("DisplayBufferOptions").execute(e))},t.prototype.executeDeactivateBufferingAndDismissOptions=function(e){var t="string"==typeof e?e:e.targetCommand;this.canExecuteDisplayBufferOptions(t)&&(this.app.command("DeactivateBuffering").execute(t),this.dismissBufferOptions(t))},t.prototype.canExecuteDisplayBufferOptions=function(e){if(!e)return!1;var t="string"==typeof e?e:e.targetCommand;return!!t&&this.canDisplayOptionsForTargetCommand(t)},t.prototype.canDisplayOptionsForTargetCommand=function(e){var t=this.viewModel.targetCommands;return!(!t||!t.length)&&t.indexOf(e)>-1},t.prototype.validateAndApplyInput=function(){this.masterViewModel.validateAndProcessInput(this.id)},t.prototype.handleContinueButtonClick=function(){this.masterViewModel.validateAndProcessInput(this.id)&&(this._executeOneTimeCommandDelegate(),this.dismissBufferOptions())},t.prototype.handleCancelButtonClick=function(){this._oneTimeCommandDelegateParams&&(this._oneTimeCommandDelegateParams=null);var e=this._currentTargetCommands.length?this._currentTargetCommands[this._currentTargetCommands.length-1]:null;e&&this.app.command("DeactivateBufferingAndDismissOptions").execute(e)},t.prototype.handleClearButtonClick=function(){this.viewModel.bufferingError.set(""),this.viewModel.bufferDistance.set(null),this.masterViewModel._raiseChangedBufferDistanceEvent(this.viewModel)},t.prototype.dismissBufferOptions=function(e){if(e){var t=this._currentTargetCommands.indexOf(e);t>-1&&this._currentTargetCommands.splice(t,1)}0===this._currentTargetCommands.length&&this.isActive&&this.app.viewManager.deactivateView(this);var r=this.viewModel.targetCommands;if(r&&r.length){var i=this.masterViewModel.generateBufferDistanceChangedEventArgs(this.viewModel);this.app.event("BufferOptionsDismissedEvent").publish(i)}},t.prototype._executeOneTimeCommandDelegate=function(){if(this._oneTimeCommandDelegateParams&&dojo.isFunction(this._oneTimeCommandDelegateParams.delegateFunction)){var e=this.masterViewModel.generateBufferDistanceChangedEventArgs(this.viewModel,[this._oneTimeCommandDelegateParams.targetCommand]);this._oneTimeCommandDelegateParams.delegateFunction(e),this._oneTimeCommandDelegateParams=null}},t}(r.ViewBase);t.BufferOptionsView=i})},"Mapping/modules/Buffer/BufferOptionsViewModel":function(){define(["require","exports","geocortex/framework/observables","geocortex/framework/ui/ViewModelBase","geocortex/infrastructure/FormatUtils","geocortex/infrastructure/buffer/BufferUtils"],function(e,t,r,i,n,a){"use strict";var o=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.childViewModels=[],n.bufferUnits=new r.ObservableCollection([]),n._addBufferToMarkupLayerByDefault=!1,n._getSupportedBufferUnitLanguageResources(),n}return __extends(t,e),t.prototype.initialize=function(t){return e.prototype.initialize.call(this,t),this._setBufferUnits(t.bufferUnits),this._setDefaultBufferUnit(t.defaultBufferUnit),this.DEFAULT_BUFFER_DISTANCE=isNaN(parseInt(t.defaultBufferDistance,10))?0:parseInt(t.defaultBufferDistance,10),this._addBufferToMarkupLayerByDefault=!!t.addBufferToMarkupLayerByDefault,this.bufferUnits.length()&&this.DEFAULT_BUFFER_UNIT?void this.subscribeEvents():void this.app.trace.error(this.app.getResource(this.libraryId,"language-buffer-config-units-error"))},t.prototype.subscribeEvents=function(){this.app.event("BufferingErrorEvent").subscribe(this,this.handleBufferingErrorEvent)},t.prototype.registerView=function(e,t){if(!e||!t||!t.length)return!1;var i=this.childViewModels.filter(function(t){return t.viewId===e});if(i.length)return!1;var n={};n.viewId=e,n.bufferUnits=this.bufferUnits,n.targetCommands=t.slice(0),n.bufferDistance=new r.Observable(this.DEFAULT_BUFFER_DISTANCE?this.DEFAULT_BUFFER_DISTANCE:null),n.selectedBufferUnit=new r.Observable(this.DEFAULT_BUFFER_UNIT.config),n.inputError=new r.Observable(""),n.bufferingError=new r.Observable(""),n.writeToMarkupLayer=new r.Observable(this._addBufferToMarkupLayerByDefault),this.childViewModels.push(n)},t.prototype.validateAndProcessInput=function(e){var t=this.getViewModelForView(e);if(!t){var r=this.app.getResource(this.libraryId,"language-buffer-error-input-validation").format(e);return this.app.trace.error(r),t.bufferingError.set(r),!1}var i="number"==typeof t.bufferDistance.get()?t.bufferDistance.get():t.bufferDistance.get()?n.parseNumber(t.bufferDistance.get()):null,a=null!==i&&!isNaN(i);return a?(t.inputError.set(""),t.bufferingError.set(""),t.bufferDistance.set(n.formatNumber(i)),this._raiseChangedBufferDistanceEvent(t),!0):(t.inputError.set(this.app.getResource(this.libraryId,"language-buffer-invalid-distance")),!1)},t.prototype.getViewModelForView=function(e){var t=this.childViewModels.filter(function(t){return t.viewId===e});return t.length?(t.length>1&&this.app.trace.warning("Multiple child view models registered for view with id {0}. Please check your configuration. Using first instance of view model.".format(e)),t[0]):(this.app.trace.error("BufferOptionsViewModel: Could not find child view model for view with id {0}".format(e)),null)},t.prototype.getViewModelForCommand=function(e){var t=this.childViewModels.filter(function(t){return t.targetCommands.indexOf(e)>-1});return t.length?t[0]:null},t.prototype.handleBufferingErrorEvent=function(e){if(e&&e.sourceCommand){var t=this.getViewModelForCommand(e.sourceCommand);if(t){var r=e&&e.error?e.error.message||e.error.name:"",i=e.error.details;i&&i.length&&(r=r.concat(" ",i.join(" "))),r=r?this.app.getResource(this.libraryId,"language-buffer-operation-error").format(r):this.app.getResource(this.libraryId,"language-buffer-error-details-unavailable"),t.bufferingError.set(r);var n=this.app.viewManager.getViewById(t.viewId);this.app.viewManager.activateView(n)}}},t.prototype.generateBufferDistanceChangedEventArgs=function(e,t){var r={};return r.distance=n.parseNumber(e.bufferDistance.get()),r.unit=a.getUnitDescFromConfig(e.selectedBufferUnit.get()),r.writeToMarkupLayer=e.writeToMarkupLayer.get(),r.targetCommands=t&&t.length?t:e.targetCommands.slice(0),r},t.prototype._raiseChangedBufferDistanceEvent=function(e){var t=this.generateBufferDistanceChangedEventArgs(e);this.app.event("BufferDistanceChangedEvent").publish(t)},t.prototype._getSupportedBufferUnitLanguageResources=function(){for(var e in a.SUPPORTED_BUFFER_UNITS)a.SUPPORTED_BUFFER_UNITS.hasOwnProperty(e)&&(a.SUPPORTED_BUFFER_UNITS[e]={displayName:this.app.getResource(this.libraryId,"language-buffer-unit-"+e.toLowerCase()+"-display-name"),config:e})},t.prototype._setBufferUnits=function(e){var t=this;e&&e.length&&e.forEach(function(e){var r=a.SUPPORTED_BUFFER_UNITS[e];r?t.bufferUnits.addItem(r):t.app.trace.warning(t.app.getResource(t.libraryId,"language-buffer-invalid-unit-warning").format(e))})},t.prototype._setDefaultBufferUnit=function(e){var t;if(e&&(t=a.SUPPORTED_BUFFER_UNITS[e]),!t){if(!this.bufferUnits.length())return void this.app.trace.warning(this.app.getResource(this.libraryId,"language-buffer-invalid-unit-warning").format(e));t=this.bufferUnits.getAt(0)}this.DEFAULT_BUFFER_UNIT=t},t}(i.ViewModelBase);t.BufferOptionsViewModel=o})},"url:/Mapping/modules/Buffer/BufferOptionsView.html":'<div class="buffer-options">\r\n    <div class="form-item">\r\n        <label>\r\n            <span data-binding="{@text: @language-buffer-options-distance-label}"></span>\r\n            <input type="number" step="any" data-binding="{@value: bufferDistance}{@event-onchange: validateAndApplyInput}{title: @language-buffer-options-distance-title}" />\r\n        </label>\r\n    </div>\r\n    <div class="form-validation" data-binding="{@visible: inputError}">\r\n        <span class="field-validation-error" data-binding="{@text: inputError}"></span>\r\n    </div>\r\n    <div class="form-item">\r\n        <label>\r\n            <span data-binding="{@text: @language-buffer-options-units-label}"></span>\r\n            <select data-binding="{@source: bufferUnits}{@value: selectedBufferUnit}{@event-onchange: validateAndApplyInput}{title: @language-buffer-options-length-unit-select}">\r\n                <option data-binding="{@template-for: bufferUnits}{@text: displayName}{value: config}" />\r\n            </select>\r\n        </label>\r\n    </div>\r\n    <div class="form-item">\r\n        <label>\r\n            <input type="checkbox" data-binding="{@value: writeToMarkupLayer}{@event-onchange: validateAndApplyInput}{title: @language-buffer-options-markup-select}" />\r\n            <span data-binding="{@text: @language-buffer-options-markup-label}"></span>\r\n        </label>\r\n    </div>\r\n    <div class="form-validation" data-binding="{@visible: bufferingError}">\r\n        <span class="field-validation-error" data-binding="{@text: bufferingError}"></span>\r\n    </div>\r\n    <div class="form-btns">\r\n        <button class="button" data-binding="{title: @language-buffer-clear-button-title}{@text: @language-buffer-clear-button-text}{@event-onclick: handleClearButtonClick}"></button>\r\n        <button class="button" data-binding="{title: @language-buffer-cancel-button-title}{@text: @language-buffer-cancel-button-text}{@event-onclick: handleCancelButtonClick}"></button>\r\n        <button class="button" data-binding="{title: @language-buffer-options-continue-button-title}{@text: @language-buffer-options-continue-button-text}{@event-onclick: handleContinueButtonClick}"></button>\r\n    </div>\r\n</div>\r\n'}}),define(["Mapping/modules/Buffer/BufferModule","Mapping/modules/Buffer/BufferOptionsView","Mapping/modules/Buffer/BufferOptionsViewModel"],function(e,t,r){shim(e,"geocortex.essentialsHtmlViewer.mapping.modules.buffer.BufferModule",e.BufferModule),shim(t,"geocortex.essentialsHtmlViewer.mapping.modules.buffer.BufferOptionsView",t.BufferOptionsView),shim(r,"geocortex.essentialsHtmlViewer.mapping.modules.buffer.BufferOptionsViewModel",r.BufferOptionsViewModel)});