!function(){function e(e,t,i){if("string"==typeof e&&(i=t,t=e),void 0!==i)for(var a=t.split("."),o=null,n=window,r=0,s=a.length;r<s;r++)o=a[r],r==s-1?n[o]=i:n[o]||(n[o]={}),n=n[o];else console.warn("Undefined shim for: "+t)}var t="<div class='region map-context-menu-region' data-region-name='MapContextMenuContentRegion' data-region-adapter='geocortex.framework.ui.DivStackRegionAdapter'></div>",i="<div class='map-menu-coordinates' data-binding='{@visible: showCoordinates}'>    <div tabindex='0'><strong data-binding='{@text: xType}'></strong> <span data-binding='{@text: xValue}'></span></div>    <div tabindex='0'><strong data-binding='{@visible: yValue}{@text: yType}'></strong> <span data-binding='{@text: yValue}'></span></div></div>",a="<div data-binding='{@widget: MapContextMenuWidget}{@widget-required: true}{@widget-context: mapPoint}{@visible: showMenu}' data-menu-id='MapContextMenu' data-menu-hoist-disabled data-menu-type='geocortex.essentialsHtmlViewer.mapping.modules.map.MapMenuView'></div>",o="<div class='map-menu-reverse-geocode' tabindex='0' data-binding='{@visible: showReverseGeocoder}'>    <strong data-binding='{@text: label}'></strong> <span data-binding='{@text: address}'></span>    \x3c!-- Used to mitigate the movement of the menu when the address result is populated --\x3e    <p data-binding='{@visible: isSearching}'></p></div>",n="<div class='region map-region' data-region-name='MapRegion'></div>",r="<div class='map-error' aria-label='map error' data-binding='{@hidden: showMap}' role='form'>    <div data-binding='{@visible: showError}'>        <h2 data-binding='{@text: @language-map-site-initialization-failed}'>\x3c!-- The site failed to initialize. --\x3e</h2>        <p data-binding='{@text: @language-common-debug-log-keys}'>\x3c!-- The site failed to initialize. --\x3e</p>    </div>    <div data-binding='{@visible: showAuthError}'>        <h2 data-binding='{@text: @language-map-site-authorization-failed}'>\x3c!-- The site authorization failed. --\x3e</h2>        <p data-binding='{@text: @language-map-site-authorization-failed-message}'>\x3c!-- The site failed to initialize. --\x3e</p>    </div>    <div data-binding='{@visible: showCriticalServicesError}'>        <h2 data-binding='{@text: @language-map-site-critical-services-failed}'>\x3c!-- Critical services failed. --\x3e</h2>        <p data-binding='{@text: @language-map-site-critical-services-failed-message}'>\x3c!-- Critical services failed. --\x3e</p>    </div></div><div id='map-container' style='height: 100%; width: 100%' data-binding='{@visible: showMap}{@var: mapContainer}'>    \x3c!-- MAP --\x3e    <div id='map' class='map needsclick' data-binding='{@var: mapDiv}'></div>    \x3c!-- MAP REGIONS --\x3e    <div class='region map-top-top-left' aria-label='top top left map region' data-region-name='TopTopLeftMapRegion' data-region-adapter='geocortex.framework.ui.DivStackRegionAdapter' data-region-options='activateViewsInLastPosition=false' role='complementary'></div>    <div class='region map-top' aria-label='top map region' data-region-name='TopMapRegion' data-region-adapter='geocortex.framework.ui.DivStackRegionAdapter' data-region-options='activateViewsInLastPosition=false' role='complementary'></div>    <div class='region map-center-region' aria-label='center map region' data-region-name='CenterRegion' data-region-adapter='geocortex.framework.ui.DivStackRegionAdapter' data-region-options='activateViewsInLastPosition=false' role='complementary'></div>    <div class='region map-top-left' aria-label='top left map region' data-region-name='TopLeftMapRegion' data-region-adapter='geocortex.framework.ui.DivStackRegionAdapter' data-region-options='activateViewsInLastPosition=false' role='complementary'></div>    <div class='region map-navigation-region' aria-label='navigation region' data-region-name='NavigationMapRegion' data-region-adapter='geocortex.framework.ui.DivStackRegionAdapter' data-region-options='activateViewsInLastPosition=false' role='navigation'></div>    <div class='region map-top-center' aria-label='top center map region' data-region-name='TopCenterMapRegion' data-region-adapter='geocortex.framework.ui.DivStackRegionAdapter' data-region-options='activateViewsInLastPosition=false' role='complementary'></div>    <div class='region map-top-right' aria-label='top right map region' data-region-name='TopRightMapRegion' data-region-adapter='geocortex.framework.ui.DivStackRegionAdapter' data-region-options='activateViewsInLastPosition=false' role='complementary'></div>    <div class='region map-basemap-region' aria-label='basemap map region' data-region-name='BasemapMapRegion' data-region-adapter='geocortex.framework.ui.DivStackRegionAdapter' data-region-options='activateViewsInLastPosition=false' role='complementary'></div>    <div class='region map-middle-right' aria-label='middle right map region' data-region-name='MiddleRightMapRegion' data-region-adapter='geocortex.framework.ui.DivStackRegionAdapter' data-region-options='activateViewsInLastPosition=false' role='complementary'></div>    <div class='region map-bottom-right' aria-label='bottom right map region' data-region-name='BottomRightMapRegion' data-region-adapter='geocortex.framework.ui.DivStackRegionAdapter' data-region-options='activateViewsInLastPosition=false' role='complementary'></div>    <div class='region map-bottom-center' aria-label='bottom center map region' data-region-name='BottomCenterMapRegion' data-region-adapter='geocortex.framework.ui.DivStackRegionAdapter' data-region-options='activateViewsInLastPosition=false' role='complementary'></div>    <div class='region map-bottom-left' aria-label='bottom left map region' data-region-name='BottomLeftMapRegion' data-region-adapter='geocortex.framework.ui.DivStackRegionAdapter' data-region-options='activateViewsInLastPosition=false' role='complementary'></div>    <div class='region map-middle-left' aria-label='middle left map region' data-region-name='MiddleLeftMapRegion' data-region-adapter='geocortex.framework.ui.DivStackRegionAdapter' data-region-options='activateViewsInLastPosition=false' role='complementary'></div>    <div class='region map-background' data-region-name='BackgroundMapRegion' data-region-adapter='geocortex.framework.ui.DivStackRegionAdapter' data-region-options='activateViewsInLastPosition=false'></div></div>";require({cache:{"Mapping/modules/Map/CenterSharingLinkProvider":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();define(["require","exports","geocortex/infrastructure/sharing/SharingLinkProviderBase","geocortex/infrastructure/MapUtils"],function(t,i,a,o){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(t){function i(e,i){var o=t.call(this,e,i)||this;return o._separator=",",o.name="center",o.priority=a.ExtentLinkPriority.CENTER,o}return e(i,t),i.prototype.generate=function(){if(!this.app.map.extent)return"";var e=this.app.map.extent.getCenter();return"{1}{0}{2}".format(this._separator,e.x,e.y)},i.prototype.apply=function(e){var t=this;if(e){var i=e.split(this._separator);i.length>=2?this.app.waitUntilShellStabilized().then(function(){t._applyCenter(i)}):this.app.trace.warning("Unable to parse the center parameter {0}: expected two comma separated number values.".format(e))}},i.prototype._applyCenter=function(e){for(var t=0;t<e.length;t++)if(isNaN(parseFloat(e[t])))return void this.app.trace.warning("Unable to parse the center parameter value '{0}': invalid number value.".format(e[t]));var i=new esri.geometry.Point(parseFloat(e[0]),parseFloat(e[1]));e.length>=3&&!isNaN(parseInt(e[2]))?i.spatialReference=new esri.SpatialReference(parseInt(e[2])):this.app.map&&this.app.map.spatialReference&&(i.spatialReference=this.app.map.spatialReference),o.panToPointWithPriority(this.app,i,7,!0)},i}(a.SharingLinkProviderBase);i.CenterSharingLinkProvider=n})},"Mapping/modules/Map/ExtentSharingLinkProvider":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();define(["require","exports","geocortex/infrastructure/sharing/SharingLinkProviderBase","geocortex/infrastructure/MapUtils"],function(t,i,a,o){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(t){function i(e,i){var o=t.call(this,e,i)||this;return o._separator=",",o.name="extent",o.priority=a.ExtentLinkPriority.EXTENT,o}return e(i,t),i.prototype.generate=function(){if(!this.app.map.extent)return"";var e=this.app.map.extent;return"{1}{0}{2}{0}{3}{0}{4}".format(this._separator,e.xmin,e.ymin,e.xmax,e.ymax)},i.prototype.apply=function(e){var t=this;if(e){var i=e.split(this._separator);i.length>=4?this.app.waitUntilShellStabilized().then(function(){t._applyExtent(i)}):this.app.trace.warning("Unable to parse the extent parameter '{0}': expected four comma separated number values.".format(e))}},i.prototype._applyExtent=function(e){for(var t=0;t<e.length;t++)if(isNaN(parseFloat(e[t])))return void this.app.trace.warning("Unable to parse the extent parameter value '{0}': invalid number value.".format(e[t]));var i=new esri.geometry.Extent(parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]),new esri.SpatialReference(4326));e.length>=5&&!isNaN(parseInt(e[4]))?i.setSpatialReference(new esri.SpatialReference(parseInt(e[4]))):this.app.map&&this.app.map.spatialReference&&i.setSpatialReference(this.app.map.spatialReference),o.zoomToExtentWithPriority(this.app,i,7,!0)},i}(a.SharingLinkProviderBase);i.ExtentSharingLinkProvider=n})},"Mapping/modules/Map/MapCoordinatesController":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();define(["require","exports","geocortex/framework/FrameworkObject","geocortex/infrastructure/coordinates/CoordinateSystem","geocortex/infrastructure/buffer/BufferUtils","geocortex/infrastructure/GeometryUtils"],function(t,i,a,o,n,r){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=function(t){function i(e,i,a){var n=t.call(this,e,i)||this;return n._skipGeometryServiceVersionCheck=!1,n._disabled=!1,n._geometryServiceAgsVer=null,n._supportedDisplayTypeConfig=[o.CoordinateSystemType.DD,o.CoordinateSystemType.DDM,o.CoordinateSystemType.DMS,o.CoordinateSystemType.XY,o.CoordinateSystemType.MGRS,o.CoordinateSystemType.USNG],n.mapCoordinateDataModelId=a,n.app.waitUntilSiteInitialized().then(function(){return n.app.coordinatesManager.getCoordinatesModel(n.mapCoordinateDataModelId).then(function(t){var i=!1;if(t.configuration){n._skipGeometryServiceVersionCheck=!!t.configuration.skipGeometryServiceVersionCheck;var a=t.configuration.customCoordinateSystems||[],o=t.configuration.defaultCoordinateDisplayTypes||[];(i=a.some(function(e){return"mgrs"===e.output||"usng"===e.output}))||(i=o.some(function(e){return"mgrs"===e||"usng"===e}))}i&&!n._skipGeometryServiceVersionCheck?r.getGeometryServiceArcGisVersion(e).then(function(e){n._geometryServiceAgsVer=e,n.initializeCoordinateDataModel(t)}):n.initializeCoordinateDataModel(t)},function(e){return n._handleCoordinateModelError(e)})}),n}return e(i,t),i.prototype.initializeCoordinateDataModel=function(e){var t=this;if(e){this._dataModel=e;var i=function(){t._processCoordinatesDataModel(),t._disabled||t.app.coordinatesManager.registerModel(t._dataModel,!0)};this.app.map&&this.app.map.loaded?i():this.app.event("MapLoadedEvent").once(this,i)}},i.prototype._processCoordinatesDataModel=function(){var e=this;if(this._dataModel){var t=this._dataModel.configuration,i=!1,a=function(t,a,o,r){var s="mgrs"===(a=a.trim().toLowerCase())||"usng"===a;if(a&&"latlon"===a&&(a="dd"),!s||e._skipGeometryServiceVersionCheck||e._geometryServiceAgsVer&&!(e._geometryServiceAgsVer&&e._geometryServiceAgsVer<10.3))if(!(t&&a&&e._supportedDisplayTypeConfig.indexOf(a)>=0&&(o||r||s)))e.app.trace.error("Could not add coordinate system {0} due to a configuration error. Please check your configuration settings.".format(t));else{var p={};if(p.displayName=t.trim(),p.output=a,o){if(p.wkid=o,"xy"!==a&&!n.isGeographicWkid(o))return void e.app.trace.error("Could not add coordinate system {0}. This coordinate system uses a geographic output type. Please configure a valid WKID for a geographic coordinate system.".format(t))}else r&&(p.wkt=r);e._dataModel.coordinateSystems.addItem(p)}else if(!i){var c="GeoCoordinate strings are only available with ArcGIS Server 10.3 or above. ";c+=null===e._geometryServiceAgsVer?"Could not determine current geometry service version. Check your proxy settings maybe? ":"Current version is {0}. ".format(e._geometryServiceAgsVer),c+="Disabling all geo coordinate systems.",e.app.trace.error(c),i=!0}};t.defaultGcsWkid&&!isNaN(parseInt(t.defaultGcsWkid,10))&&(this._dataModel.defaultGcsWkid=parseInt(t.defaultGcsWkid,10)),t.defaultCoordinateDisplayTypes&&t.defaultCoordinateDisplayTypes.length&&t.defaultCoordinateDisplayTypes.forEach(function(t){var i=t.toLowerCase().trim(),o=e._dataModel.defaultGcsWkid,n=e.getResource("language-map-coordinates-{0}".format(i.toUpperCase())),r=e.getResource("language-map-coordinates-WKID")+": "+o,s="";if("xy"===i){o=e.app.map.spatialReference.wkid,s=e.getResource("language-map-coordinates-default-coordinate-system-label");r=o?e.getResource("language-map-coordinates-WKID")+": "+o:e.getResource("language-map-coordinates-WKT")}a(s+" "+r+" "+n,i,o,e.app.map.spatialReference.wkt)}),t.customCoordinateSystems&&t.customCoordinateSystems.length&&t.customCoordinateSystems.forEach(function(e){return a(e.displayName,e.output,e.wkid,e.wkt)}),0!==this._dataModel.coordinateSystems.length()?(t.fractionalDigits&&!isNaN(parseInt(t.fractionalDigits,10))&&(this._dataModel.fractionalDigits=parseInt(t.fractionalDigits,10)),this._dataModel.currentCoordinateSystem.set(this._dataModel.coordinateSystems.getAt(0)),t.disableMouseLocationMonitoring||this._dataModel.isActive.bind(this,this._logCoordinates)):this._disabled=!0}},i.prototype._logCoordinates=function(e){var t=this;this._disabled||(this._mouseMoveToken&&(this._mouseMoveToken.remove(),this._mouseMoveToken=null),this._keyboardMoveToken&&(this.app.event("EditVertexMovedEvent").unsubscribe(this._keyboardMoveToken),this._keyboardMoveToken=null),e&&(this._keyboardMoveToken=this.app.event("EditVertexMovedEvent").subscribe(this,function(e){e.mapPoint&&t._dataModel.inputStream.set(e.mapPoint)}),this._mouseMoveToken=this.app.map.on("mouse-move",function(e){t.app.map.snappingManager?t.app.map.snappingManager.getSnappingPoint(e.screenPoint).then(function(i){i?t._dataModel.inputStream.set(i):t._dataModel.inputStream.set(e.mapPoint)},function(i){t._dataModel.inputStream.set(e.mapPoint)}):t._dataModel.inputStream.set(e.mapPoint)})))},i.prototype._handleCoordinateModelError=function(e){this.app.trace.error("MapCoordinatesController: An error occurred while trying to retrieve the coordinatesModel {0}. Details of the error are: {1}".format(this.mapCoordinateDataModelId||"<unknown>",e.message))},i}(a.FrameworkObject);i.MapCoordinatesController=s})},"Mapping/modules/Map/MapExtentLog":function(){define(["require","exports","geocortex/infrastructure/MapUtils","geocortex/essentials/GeometryUtilities"],function(e,t,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t,i){this._mapLoadedEventToken=null,this._previousExtentArray=[],this._nextExtentArray=[],this._currentExtent=null,this._pauseRecordExtentChange=!1,this._prevNextExtentCommandInProgress=!1,this._disableExtentChangeTimeoutId=null,this._maxLogEntries=100,this._extentChangeRecordDelayMs=500,this.app=e,this.libraryId=t,this._maxLogEntries=void 0!=i?i:this._maxLogEntries,this._maxLogEntries&&(this._mapLoadedEventToken=this.app.event("MapLoadedEvent").subscribe(this,this._onMapLoaded))}return e.prototype._onMapLoaded=function(){this.app.event("MapLoadedEvent").unsubscribe(this._mapLoadedEventToken),this.app.map.on("extent-change",dojo.hitch(this,this._recordExtentChange)),this.app.map.on("resize",dojo.hitch(this,this._onMapResized)),this._registerCommands()},e.prototype._onMapResized=function(){this._pauseRecordExtentChangeOperation()},e.prototype._registerCommands=function(){this.app.command("ZoomToPreviousExtent").register(this,this._executeZoomToPreviousExtent,this._canExecuteZoomToPreviousExtent),this.app.command("ZoomToNextExtent").register(this,this._executeZoomToNextExtent,this._canExecuteZoomToNextExtent)},e.prototype._canExecuteZoomToPreviousExtent=function(){return!this._prevNextExtentCommandInProgress&&0!==this._previousExtentArray.length},e.prototype._canExecuteZoomToNextExtent=function(){return!this._prevNextExtentCommandInProgress&&0!==this._nextExtentArray.length},e.prototype._executeZoomToPreviousExtent=function(){if(this._previousExtentArray.length){var e=this._previousExtentArray.pop();this._prevNextExtentCommandInProgress=!0,this._addExtentConditionally(this._nextExtentArray,this._currentExtent),this._currentExtent=e,i.zoomToExtent(this.app,this._currentExtent,!0),this._zoomToPrevNextExtentCanExecuteChanged()}},e.prototype._executeZoomToNextExtent=function(){if(this._nextExtentArray.length){var e=this._nextExtentArray.pop();this._prevNextExtentCommandInProgress=!0,this._addExtentConditionally(this._previousExtentArray,this._currentExtent),this._currentExtent=e,i.zoomToExtent(this.app,this._currentExtent,!0),this._zoomToPrevNextExtentCanExecuteChanged()}},e.prototype._recordExtentChange=function(e){this._pauseRecordExtentChange||this._prevNextExtentCommandInProgress||(this._currentExtent&&this._addExtentConditionally(this._previousExtentArray,this._currentExtent),this._nextExtentArray=[]),this._currentExtent=e.extent,this._pauseRecordExtentChangeOperation(this._extentChangeRecordDelayMs),this._prevNextExtentCommandInProgress=!1,this._zoomToPrevNextExtentCanExecuteChanged()},e.prototype._numLogEntries=function(){return this._previousExtentArray.length+this._nextExtentArray.length},e.prototype._addExtentConditionally=function(e,t){var i=this._numLogEntries();this._isValidExtentObject(t)?(i>=this._maxLogEntries&&e.length&&e.shift(),(!e.length||e.length&&!this._extentsEqual(e[e.length-1],t))&&e.push(new esri.geometry.Extent(t.toJson()))):this.app.trace.error("MapExtentLog: Invalid extent specified. Could not add to extent log")},e.prototype._pauseRecordExtentChangeOperation=function(e){var t=this;this._disableExtentChangeTimeoutId&&(clearTimeout(this._disableExtentChangeTimeoutId),this._disableExtentChangeTimeoutId=null),this._pauseRecordExtentChange=!0,void 0!=e&&(this._disableExtentChangeTimeoutId=setTimeout(function(){t._pauseRecordExtentChange=!1},e))},e.prototype._extentsEqual=function(e,t){return e&&t&&e.spatialReference&&t.spatialReference&&e.xmin===t.xmin&&e.xmax===t.xmax&&e.ymin===t.ymin&&e.ymax===t.ymax&&a.spatialRefsAreEqual(e.spatialReference,t.spatialReference,!1)},e.prototype._isValidExtentObject=function(e){return!!(e&&e instanceof esri.geometry.Extent)||e&&"number"==typeof parseFloat(e.xmin)&&"number"==typeof parseFloat(e.xmax)&&"number"==typeof parseFloat(e.ymin)&&"number"==typeof parseFloat(e.ymax)&&e.spatialReference&&(e.spatialReference.wkid&&"number"==typeof parseInt(e.spatialReference.wkid,10)||e.spatialReference.wkt)},e.prototype._zoomToPrevNextExtentCanExecuteChanged=function(){this.app.command("ZoomToPreviousExtent").raiseCanExecuteChanged(),this.app.command("ZoomToNextExtent").raiseCanExecuteChanged()},e}();t.MapExtentLog=o})},"Mapping/modules/Map/MapHostView":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();define(["require","exports","geocortex/framework/ui/ViewBase"],function(t,i,a){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return e(i,t),i.prototype.attach=function(){this.app.event("ViewActivatedEvent").subscribe(this,this._activateMapHost),this.app.event("ViewDeactivatedEvent").subscribe(this,this._deactivateMapHost)},i.prototype._activateMapHost=function(e){"MapView"==e.id&&(this.app.command("ActivateView").execute(this.id),this.app.command("MapResize").execute())},i.prototype._deactivateMapHost=function(e){"MapView"==e.id&&this.app.command("DeactivateView").execute(this.id)},i}(a.ViewBase);i.MapHostView=o})},"Mapping/modules/Map/MapModule":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();define(["require","exports","geocortex/framework/application/ModuleBase","./MapExtentLog","./MapCoordinatesController","geocortex/infrastructure/ArrayUtils","geocortex/infrastructure/GraphicsLayerUtils","geocortex/infrastructure/PromiseUtils","geocortex/infrastructure/commandArgs/ProjectArgs","geocortex/infrastructure/MapUtils","geocortex/infrastructure/GeometryUtils","geocortex/infrastructure/Feature","geocortex/infrastructure/FeatureSet","geocortex/infrastructure/commandArgs/AddStatusArgs","geocortex/infrastructure/GraphicsLayerIds","geocortex/infrastructure/GraphicsLayerUtils","geocortex/essentials/MapServiceConstants","geocortex/infrastructure/FocusUtils"],function(t,i,a,o,n,r,s,p,c,l,u,d,h,m,g,v,f,y){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var b=function(t){function i(e,i){var a=t.call(this,e,i)||this;return a._config=null,a._isAndroid=!1,a._isAndroid3plus=!1,a._showMapOnZoom=!0,a._showMapOnPan=!1,a._maxLogEntries=100,a._executeMapClickCommands=!0,a._mapClickTimerHandles=[],a._mapCoordinatesControllers=[],a._mapExtentLog=null,a._coordModelType="geocortex.essentialsHtmlViewer.mapping.infrastructure.coordinates.CoordinatesModel",a._coolDownDuration=300,a.registerCommands(),a.app.event("SiteInitializedEvent").subscribe(a,a._handleSiteInitialized),a.app.event("LayerUpdateStartedEvent").subscribe(a,a._handleLayerUpdateStart),a.app.event("LayerUpdateEndedEvent").subscribe(a,a._handleLayerUpdateEnd),a.app.event("LayerAddedEvent").subscribe(a,a._handleLayerAdded),a.app.event("LayerRemovedEvent").subscribe(a,a._handleLayerRemoved),a._isAndroid3plus=a._androidSieve(navigator.userAgent,3),a._isAndroid=$(document.documentElement).hasClass("dj_android"),a}return e(i,t),i.prototype.initialize=function(e){if(t.prototype.initialize.call(this,e),e||(e={}),e&&e.menus&&this.app.menuRegistry.loadMenus(e),e.hasOwnProperty("showLoadingStatus")||(e.showLoadingStatus=!0),e.hasOwnProperty("loadingMessageTiming")&&e.loadingMessageTiming.length||(e.loadingMessageTiming=[1e3,3e3,3e3]),e.hasOwnProperty("defaultPointFeatureZoomScales")&&e.defaultPointFeatureZoomScales.length||(e.defaultPointFeatureZoomScales=[]),e.hasOwnProperty("panDuration")){var i=parseInt(e.panDuration,10);isNaN(i)||(esri.config.defaults.map.panDuration=i)}if(e.hasOwnProperty("panRate")){var a=parseInt(e.panRate,10);isNaN(a)||(esri.config.defaults.map.panRate=a)}if(e.hasOwnProperty("zoomDuration")){var n=parseInt(e.zoomDuration,10);isNaN(n)||(esri.config.defaults.map.zoomDuration=n)}if(e.hasOwnProperty("zoomRate")){var r=parseInt(e.zoomRate,10);isNaN(r)||(esri.config.defaults.map.zoomRate=r)}this._initializeCoordinateModels(),e.tools&&this.app&&this.app.toolRegistry&&this.app.toolRegistry.createTools(e.tools,!0),e.hasOwnProperty("showMapOnZoom")&&(this._showMapOnZoom=e.showMapOnZoom),e.hasOwnProperty("showMapOnPan")&&(this._showMapOnPan=e.showMapOnPan),e.hasOwnProperty("maxExtentLogSize")&&(this._maxLogEntries=isNaN(parseInt(e.maxExtentLogSize,10))?this._maxLogEntries:parseInt(e.maxExtentLogSize,10)),this._config=e,this._mapExtentLog=new o.MapExtentLog(this.app,this.libraryId,this._maxLogEntries),this.app.event("MapLoadedEvent").subscribe(this,this.subscribeToMapEvents),dojo.subscribe("FeatureClickedEvent",this,this.featureClickHandler),dojo.subscribe("geoRssLayerLoaded",this,this._onGeoRssLayerLoaded)},i.prototype.registerCommands=function(){this.app.command("ZoomToLayerVisibleScale").register(this,this._executeZoomToVisibleScale),this.app.command("ZoomToLayerExtent").register(this,this._executeZoomToLayerExtent),this.app.command("PanToAllFeatures").register(this,this._executePanToAllFeatures),this.app.command("PanToFeature").register(this,this._executePanToFeature,function(e){return e&&e.esriFeature&&e.esriFeature.get()&&e.esriFeature.get().geometry}),this.app.command("PanToFeatureIfOutsideMapExtent").register(this,this._executePanToFeatureIfOutsideMapExtent,function(e){return e&&e.esriFeature&&e.esriFeature.get()&&e.esriFeature.get().geometry}),this.app.command("PanToPoint").register(this,this._executePanToPoint),this.app.command("Project").register(this,this._executeProject),this.app.command("RecenterMapOnNextMapResize").register(this,this._executeRecenterMap),this.app.command("ZoomOutToExtent").register(this,this._executeZoomOutToExtent),this.app.command("ZoomToFeatures").register(this,this._executeZoomToFeatures),this.app.command("ZoomToFeatureSetCollection").register(this,this._executeZoomToFeatureSetCollection),this.app.command("ZoomToAllFeatures").register(this,this._executeZoomToAllFeatures),this.app.command("ZoomToExtent").register(this,this._executeZoomToExtent),this.app.command("ZoomToFeature").register(this,this._executeZoomToFeature,this._canExecuteZoomToFeature),this.app.command("ZoomToFeatureIfOutsideMapExtent").register(this,this._executeZoomToFeatureIfOutsideMapExtent,this._canExecuteZoomToFeature),this.app.command("ZoomToScale").register(this,this._executeZoomToScale),this.app.command("ZoomToNamedExtent").register(this,this._executeZoomToNamedExtent),this.app.command("ZoomToOfflineMapExtent").register(this,this._executeZoomToOfflineMapExtent),this.app.command("PanUp").register(this,this._executePanUp),this.app.command("PanDown").register(this,this._executePanDown),this.app.command("PanLeft").register(this,this._executePanLeft),this.app.command("PanRight").register(this,this._executePanRight),this.app.command("SetTimeExtent").register(this,this._executeSetTimeExtent),this.app.command("EnableMapClick").register(this,this._executeEnableMapClick),this.app.command("DisableMapClick").register(this,this._executeDisableMapClick),this.app.command("EnableMapOnNextClick").register(this,this._enableMapNextClick),this.app.command("FocusMap").register(this,this._focusMap)},i.prototype._focusMap=function(){y.focusOnMap(this.app.map)},i.prototype.getStateFilter=function(){return{serviceLayers:{item:this.app.project.filter.serviceLayer},graphicsLayers:{item:this.app.project.filter.operationalLayer}}},i.prototype.exportState=function(){var e=this;return Promise.try(function(){var t=r.ArrayUtils.mapWithErrorCallback(e.app.site.essentialsMap.mapServices,function(t){return e.app.project.convert.fromGcxMapService(t)},function(t,i){e.app.trace.warning('Unable to save map service "{0}" to project: {1}'.format(t.displayName,i))}),i=s.getGraphicsLayersExceptExcluded(e.app,[s.ExcludeFromEnum.ExportApplyStateName]);return i=i.filter(function(e){return e.id!==g.COORDINATES_LAYER_ID}),{serviceLayers:t,graphicsLayers:r.ArrayUtils.mapWithErrorCallback(i,function(t){return e.app.project.convert.fromEsriLayer(t)},function(t,i){e.app.trace.warning('Unable to save graphics layer "{0}" to project: {1}'.format(t.id,i))})}})},i.prototype.applyState=function(e){var t=this;return Promise.try(function(){t.app.site.essentialsMap.mapServices.filter(function(e){return e.isUserCreated}).forEach(function(e){t.app.site.essentialsMap.removeMapService(e)});var i=s.getInternalGraphicsLayer(g.MARKUP_LAYER_ID,t.app,s.GraphicsLayerType.Markup,!0);i&&i.clear();var a=s.getInternalGraphicsLayer(g.MEASUREMENT_LAYER_ID,t.app,s.GraphicsLayerType.Label);a&&a.clear(),t.app.event("MarkupClearedEvent").publish();var o=t.app.project.convert,n=p.PromiseUtils.mapSkipRejected(e.serviceLayers,function(e){return p.PromiseUtils.warnOnReject(o.toGcxMapService(e),t.app,'Unable to restore map service "{0}": {{0}}'.format(e.id))}).return(),r=p.PromiseUtils.mapSkipRejected(e.graphicsLayers,function(e){return p.PromiseUtils.warnOnReject(o.toEsriLayer(e),t.app,'Unable to restore graphics layer "{0}": {{0}}'.format(e.id))}).return();return Promise.join(n,r).then(function(){t._fixGraphicsLayersOrder(),t.app.command("ClearMarkup").raiseCanExecuteChanged(),t.app.command("ClearMarkupQuiet").raiseCanExecuteChanged(),t.app.command("EditMarkup").raiseCanExecuteChanged(),t.app.command("DeleteMarkup").raiseCanExecuteChanged()})})},i.prototype._fixGraphicsLayersOrder=function(){var e=this,t=[g.MARKUP_LAYER_ID,g.MEASUREMENT_LAYER_ID,g.COORDINATES_LAYER_ID].filter(function(t){return e.app.map.graphicsLayerIds.indexOf(t)>=0});if(t.length){var i=Math.min.apply(null,t.map(function(t){return e.app.map.graphicsLayerIds.indexOf(t)}));t.forEach(function(t,a){var o=e.app.map.getLayer(t);e.app.map.reorderLayer(o,a+i)})}},i.prototype._androidSieve=function(e,t){var i=/Android (\d+(?:\.\d+)+)/,a=e.match(i);return null!==a&&parseFloat(a[1])>=t},i.prototype._executeEnableMapClick=function(){this._executeMapClickCommands=!0},i.prototype._executeDisableMapClick=function(){this._executeMapClickCommands=!1,$(document.body).off("mousedown.nextClick touchstart.nextClick")},i.prototype._enableMapNextClick=function(){var e=this;$(document.body).off("mousedown.nextClick touchstart.nextClick"),this._isAndroid?setTimeout(function(){$(document.body).one("mousedown.nextClick touchstart.nextClick",function(){return e.app.command("EnableMapClick").execute()})},100):$(document.body).one("mousedown.nextClick touchstart.nextClick",function(){return e.app.command("EnableMapClick").execute()})},i.prototype._executeRecenterMap=function(){var e=this;if(!this._coolDownTimer&&this.app.applicationReady){var t=this.app.map&&this.app.map.extent&&this.app.map.extent.getCenter();t&&(this._coolDownTimer=setTimeout(function(){e._coolDownTimer=null,e.app.map.centerAt(t)},this._coolDownDuration))}},i.prototype._executeZoomOutToExtent=function(e){var t=this,i=function(e){var i=null;if(e&&e.length>0){i=e[0],t.app.command("ShowMap").execute();var a=2,o=2;i.getWidth()>0&&(a=t.app.map.extent.getWidth()/i.getWidth()),i.getHeight()>0&&(o=t.app.map.extent.getHeight()/i.getHeight());var n=t.app.map.extent.getWidth()*a,r=t.app.map.extent.getHeight()*o,s=new esri.geometry.Extent(i.getCenter().x-n/2,i.getCenter().y-r/2,i.getCenter().x+n/2,i.getCenter().y+r/2,i.spatialReference);t.app.site.essentialsMap.extentManager.setExtentWithPriority(s,5)}};if(e&&e.isInstanceOf(esri.geometry.Extent)){if(!e.spatialReference&&this.app.map.spatialReference)return e.spatialReference=this.app.map.spatialReference,void i([e]);var a=new c.ProjectArgs([e],i,function(e){t.app.trace.warning("ZoomOutToExtent: "+e.message)});this.app.command("Project").execute(a)}},i.prototype._executeZoomToExtent=function(e){l.zoomToExtentWithPriority(this.app,e,10,this._showMapOnZoom)},i.prototype._executePanToPoint=function(e){l.panToPointWithPriority(this.app,e,9,this._showMapOnPan)},i.prototype._executeProject=function(e){var t=this;if(e&&e instanceof c.ProjectArgs){var i=function(i){t.app.command("Alert").execute(t.app.getResource(t.libraryId,"language-map-operation-project-failed")),t.app.trace.warning(i),e.errback&&e.errback(i)};if(e.geometries.length>0&&!u.needsProjection(e.geometries[0],this.app)){var a=e.callback;if(i=e.errback,!e.callback||!dojo.isFunction(a)){if(i&&dojo.isFunction(i)){i(new Error("callback function required."))}return}return void a(e.geometries)}var o=void 0;(o=void 0!==esri.tasks.ProjectParameters?new esri.tasks.ProjectParameters:new Object).geometries=e.geometries,e.outputSpatialReference?o.outSR=e.outputSpatialReference:o.outSR=this.app.map.spatialReference,o.transformation=e.transformation,u.project(o,e.callback,i,this.app)}},i.prototype._executeZoomToVisibleScale=function(e){if(e&&this.app.site.essentialsMap){var t=1,i=null,a=this.app.map,o=this.app.site.essentialsMap.calculateScale();if(o&&!(o<=0))if(e.withinScaleRange(o)?i=null:o<e.maxScale?i=this._getClosestLODScale("greaterThan",e.maxScale)+1:o>e.minScale&&(i=this._getClosestLODScale("lessThan",e.minScale)-1),i&&(t=i/o),1!==t){var n=a.extent.getCenter();l.zoomToExtentWithPriority(this.app,a.extent.expand(t).centerAt(n),8,this._showMapOnZoom)}else this.app.command("ShowMap").execute()}},i.prototype._getClosestLODScale=function(e,t){var i=this.app.map,a=i.__tileInfo&&i.__tileInfo.lods;if(!a||!a.length)return t;for(var o=0,n=0,r=a;n<r.length;n++){var s=r[n];if(s.scale===t)return t;if("lessThan"===e){if(t<s.scale)continue}else if(s.scale>t){o=s.scale;continue}return"lessThan"===e?s.scale:o}},i.prototype._executeZoomToLayerExtent=function(e){e&&e.fullExtent&&l.zoomToExtentWithPriority(this.app,e.fullExtent,8,this._showMapOnZoom)},i.prototype._executeZoomToNamedExtent=function(e){var t=this;e?this.app.doWhenMapInitialized(function(){var i=t.app.site.namedExtents.filter(function(t){return t.displayName.toLowerCase().trim()===e.toLowerCase().trim()}),a=i.length?i[0]:null;a?l.zoomToExtentWithPriority(t.app,a.extent,8,t._showMapOnZoom):t.app.trace.error("Error ZoomToNamedExtent: could not find extent '{0}'.".format(e))}):this.app.trace.error("Error ZoomToNamedExtent: extent name was null.")},i.prototype._executeZoomToOfflineMapExtent=function(){var e=this;this.app.doWhenMapInitialized(function(){var t=e.app.offlineManager.getActiveOfflineMap();if(t){var i=new esri.geometry.Polygon(t.content.geometry).getExtent();l.zoomToExtentWithPriority(e.app,i,8,e._showMapOnZoom)}else e.app.trace.warning("ZoomToOfflineMapExtent: no active offline map.")})},i.prototype._executePanToFeature=function(e){if(e&&e instanceof d.Feature){var t=e.esriFeature.get();t&&t.geometry?this.app.command("PanToPoint").execute(t.geometry):this.app.trace.warning("Error PanToFeature: No geometry.")}else this.app.trace.error("Error PanToFeature: not a feature.")},i.prototype._executePanToFeatureIfOutsideMapExtent=function(e){if(e&&e instanceof d.Feature){var t=e.esriFeature.get();t&&t.geometry?this.app&&this.app.map?this.app.map.extent.intersects(t.geometry)&&!this._isObscuredByMapTipView(t.geometry)||this.app.command("PanToFeature").execute(e):this.app.trace.error("Error ZoomToFeature: No access to the Esri map."):this.app.trace.warning("Error PanToFeatureIfOutsideMapExtent: No geometry.")}else this.app.trace.error("Error PanToFeatureIfOutsideMapExtent: not a feature.")},i.prototype._executePanToAllFeatures=function(e){if(e&&dojo.isArray(e)){if(1===e.length)return void this.app.command("PanToFeature").execute(e[0]);for(var t=null,i=0,a=e;i<a.length;i++){var o=a[i];if(o&&o instanceof d.Feature){var n=o.esriFeature.get();if(!n||!n.geometry)continue;var r=n.geometry,s=l.getExtent(r);t=null==t?s:t.union(s)}}t&&l.panToPointWithPriority(this.app,t,8,this._showMapOnPan)}},i.prototype._executeZoomToFeatures=function(e){e&&e instanceof h.FeatureSet&&this._executeZoomToAllFeatures(e.features.getItems())},i.prototype._executeZoomToAllFeatures=function(e){if(e&&dojo.isArray(e)){if(1===e.length)return void this._executeZoomToFeature(e[0]);for(var t=null,i=0,a=e;i<a.length;i++){var o=a[i];if(o&&o instanceof d.Feature){var n=o.esriFeature.get();if(!n||!n.geometry)continue;var r=n.geometry,s=l.getExtent(r);t=null==t?s:t.union(s)}}t&&(0===t.getWidth()&&0===t.getHeight()?l.panToPointWithPriority(this.app,t.getCenter(),8,this._showMapOnPan):(t=t.expand(1.5),l.zoomToExtentWithPriority(this.app,t,8,this._showMapOnZoom)))}},i.prototype._executeZoomToFeatureSetCollection=function(e){var t=[].concat.apply([],[[]].concat(e.featureSets.get().map(function(e){return e.features.get()})));this._executeZoomToAllFeatures(t)},i.prototype._executeZoomToFeature=function(e){var t=this;if(e&&e instanceof d.Feature)if(this.app&&this.app.map){var i;if(e.zoomExtent.get())l.zoomToExtentWithPriority(this.app,e.zoomExtent.get(),null,this._showMapOnZoom);else{if(e.esriFeature.get()&&e.esriFeature.get().geometry){var a=e.esriFeature.get().geometry,o=e.zoomScale.get(),n=void 0;if(o){var r=null;r="point"===a.type?a:(n=a.getExtent())?n.getCenter():null;var s=void 0,p=o/(s=this.app.map.spatialReference.wkid?esri.geometry.getScale(this.app.map.extent,this.app.map.width,this.app.map.spatialReference.wkid):esri.geometry.getScale(this.app.map.extent,this.app.map.width,this.app.map.spatialReference.wkt));return i=new c.ProjectArgs([r],function(e){var i=null;e&&e.length>0&&(i=e[0]),i&&l.zoomToExtentWithPriority(t.app,t.app.map.extent.centerAt(i).expand(p),8,t._showMapOnZoom)},function(e){}),void this.app.command("Project").execute(i)}if("point"===a.type)return i=new c.ProjectArgs([a],function(i){var a=null;if(i&&i.length>0&&(a=i[0]),a){var o=t.app.map.extent.centerAt(a),n=t._pickDefaultZoomScaleForPointFeature(e);isNaN(n)&&(n=t.app.map.spatialReference.wkid?esri.geometry.getScale(o,t.app.map.width,t.app.map.spatialReference.wkid):esri.geometry.getScale(o,t.app.map.width,t.app.map.spatialReference.wkt)),o=esri.geometry.getExtentForScale(t.app.map,e.calculateScaleToMakeVisible(n)).centerAt(o.getCenter()),l.zoomToExtentWithPriority(t.app,o,8,t._showMapOnZoom)}},function(e){}),void this.app.command("Project").execute(i);var h=e.zoomFactor.get();h||(h=1.5);var m=a.getExtent();return m&&(m=u.fixAspectRatio(m.expand(h),this.app.map.extent)),i=new c.ProjectArgs([m],function(i){var a=null;if(i&&i.length>0&&(a=i[0]),a){var o=void 0;o=t.app.map.spatialReference.wkid?esri.geometry.getScale(a,t.app.map.width,t.app.map.spatialReference.wkid):esri.geometry.getScale(a,t.app.map.width,t.app.map.spatialReference.wkt),e.withinScaleRange(o)||(o=e.calculateScaleToMakeVisible(o),a=esri.geometry.getExtentForScale(t.app.map,o).centerAt(a.getCenter())),l.zoomToExtentWithPriority(t.app,a,8,t._showMapOnZoom)}},function(e){}),void this.app.command("Project").execute(i)}this.app.trace.warning("Error ZoomToFeature: No geometry.")}}else this.app.trace.error("Error ZoomToFeature: No access to the Esri map.");else this.app.trace.error("Error ZoomToFeature: No feature provided.")},i.prototype._executeZoomToFeatureIfOutsideMapExtent=function(e){if(e&&e instanceof d.Feature)if(this.app&&this.app.map){if(this.app.map.extent){var t=void 0;if(e.zoomExtent.get())t=e.zoomExtent.get();else{if(!e.esriFeature.get()||!e.esriFeature.get().geometry)return void this.app.trace.warning("Error ZoomToFeatureIfOutsideMapExtent: No geometry.");t=e.esriFeature.get().geometry}if(this.app.map.extent.intersects(t)&&!this._isObscuredByMapTipView(t))return}this.app.command("ZoomToFeature").execute(e)}else this.app.trace.error("Error ZoomToFeature: No access to the Esri map.");else this.app.trace.error("Error ZoomToFeatureIfOutsideMapExtent: No feature provided.")},i.prototype._canExecuteZoomToFeature=function(e){if(e&&e.esriFeature&&e.esriFeature.get()&&e.esriFeature.get().geometry){if(this.app.isOffline.get()){var t=this.app.map.spatialReference,i=e.esriFeature.get().geometry.spatialReference;return i?t.equals(i)||t.isWebMercator()&&4326===i.wkid||i.isWebMercator()&&4326===t.wkid:t.equals(i)}return!0}return!1},i.prototype._isObscuredByMapTipView=function(e){if(!e)return!1;var t=this.app.viewManager.getViewById("MapTipView");if(!t||!t.root)return!1;var i=t.root.getBoundingClientRect(),a=this.app.map.toMap(new esri.geometry.ScreenPoint(i.left-this.app.map.position.x,i.bottom-this.app.map.position.y)),o=this.app.map.toMap(new esri.geometry.ScreenPoint(i.right-this.app.map.position.x,i.top-this.app.map.position.y));return new esri.geometry.Extent(a.x,a.y,o.x,o.y,this.app.map.spatialReference).contains(l.getExtent(e))},i.prototype.calculateScaleToMakeVisible=function(e){return null},i.prototype._executeZoomToScale=function(e){e&&this.app&&this.app.site&&this.app.site.essentialsMap&&this.app.site.essentialsMap.extentManager.setScaleWithPriority(e,6)},i.prototype._executePanUp=function(e){if(e){var t=this.app.map.extent,a=this._calculateVerticalPanAmount(e),o=new esri.geometry.Extent(t.xmin,t.ymin+a,t.xmax,t.ymax+a,t.spatialReference);this.app.site.essentialsMap.extentManager.setExtentWithPriority(o,i.extentChangePriority)}else this.app.site.essentialsMap.extentManager.changeExtentWithPriority(function(e){return e.panUp()},i.extentChangePriority)},i.prototype._executePanDown=function(e){if(e){var t=this.app.map.extent,a=this._calculateVerticalPanAmount(e),o=new esri.geometry.Extent(t.xmin,t.ymin-a,t.xmax,t.ymax-a,t.spatialReference);this.app.site.essentialsMap.extentManager.setExtentWithPriority(o,i.extentChangePriority)}else this.app.site.essentialsMap.extentManager.changeExtentWithPriority(function(e){return e.panDown()},i.extentChangePriority)},i.prototype._executePanLeft=function(e){if(e){var t=this.app.map.extent,a=this._calculateHorizontalPanAmount(e),o=new esri.geometry.Extent(t.xmin-a,t.ymin,t.xmax-a,t.ymax,t.spatialReference);this.app.site.essentialsMap.extentManager.setExtentWithPriority(o,i.extentChangePriority)}else this.app.site.essentialsMap.extentManager.changeExtentWithPriority(function(e){return e.panLeft()},i.extentChangePriority)},i.prototype._executePanRight=function(e){if(e){var t=this.app.map.extent,a=this._calculateHorizontalPanAmount(e),o=new esri.geometry.Extent(t.xmin+a,t.ymin,t.xmax+a,t.ymax,t.spatialReference);this.app.site.essentialsMap.extentManager.setExtentWithPriority(o,i.extentChangePriority)}else this.app.site.essentialsMap.extentManager.changeExtentWithPriority(function(e){return e.panRight()},i.extentChangePriority)},i.prototype._calculateHorizontalPanAmount=function(e){return this.app.map&&this.app.map.extent?this.app.map.extent.getWidth()*e:0},i.prototype._calculateVerticalPanAmount=function(e){return this.app.map&&this.app.map.extent?this.app.map.extent.getHeight()*e:0},i.prototype._executeSetTimeExtent=function(e){this.app.map&&this.app.map.setTimeExtent(e)},i.prototype._pickDefaultZoomScaleForPointFeature=function(e){var t=e.layer;if(t)for(var i=0,a=this._config.defaultPointFeatureZoomScales;i<a.length;i++){var o=a[i];if(t.withinScaleRange(o))return o}else if(this._config.defaultPointFeatureZoomScales.length>0)return this._config.defaultPointFeatureZoomScales[0];return NaN},i.prototype._pointToExtent=function(e){var t=5*(this.app.map.extent.getWidth()/this.app.map.width);return new esri.geometry.Extent(e.x-t,e.y-t,e.x+t,e.y+t,this.app.map.spatialReference)},i.prototype.featureClickHandler=function(e){e&&this.app.behavior("MapOnFeatureClickBehavior").run(e)},i.prototype.subscribeToMapEvents=function(){var e=this,t=this,i=!1,a=0,o=null,n=null,r=function(t){if(i)return i=!1,!1;if(!e._executeMapClickCommands)return!1;var r=(new Date).getTime();if(e._isAndroid3plus){r-a<=300&&o&&Math.abs(o.x-t.screenPoint.x)<50&&Math.abs(o.y-t.screenPoint.y)<50?clearTimeout(n):n=setTimeout(function(){e._executeMapClickCommands&&e.app.behavior("MapOnClickBehavior").run(t.mapPoint)},300)}else e.app.behavior("MapOnClickBehavior").run(t.mapPoint);a=r,o=t.screenPoint},s=null,p=function(e){null!=s&&(clearTimeout(s),s=null)},c=function(t){p(),i=!1,s=setTimeout(function(){if(s=null,i=!0,esri.MapNavigationManager?esri.MapNavigationManager.prototype._panEnd?e.app.map.navigationManager?e.app.map.navigationManager._panHandle&&esri.MapNavigationManager.prototype._panEnd.call(e.app.map.navigationManager):e.app.trace.warning("Can't prevent panning: missing map.navigationManager."):e.app.trace.warning("Can't prevent panning: missing esri.MapNavigationManager._panEnd"):e.app.trace.warning("Can't prevent panning: missing esri.MapNavigationManager."),t.preventDefault(),!(Date.now()-a<700)&&t.touches&&t.touches.length>0){var o=t.touches[0],n=$(e.app.map.root).offset(),r=new esri.geometry.ScreenPoint(Math.floor(o.pageX)-n.left,Math.floor(o.pageY)-n.top),p=e.app.map.toMap(r);a=Date.now(),e.app.behavior("MapOnLongClickBehavior").run(p)}},e._config.longClickMilliseconds||500)},l=function(t){if(t.preventDefault(),!(Modernizr.touch&&Date.now()-a<700)){var i=$(e.app.map.root).offset(),o=t.pageX-i.left,n=t.pageY-i.top,r=new esri.geometry.ScreenPoint({x:o,y:n}),s=e.app.map.toMap(r);a=Date.now(),e.app.behavior("MapOnContextMenuBehavior").run(s)}},u=[],d=function(){dojo.forEach(u,dojo.disconnect),u.length=0,Modernizr.touch&&(e.app.map.root.removeEventListener("touchstart",c,!1),e.app.map.root.removeEventListener("touchend",p,!1),e.app.map.root.removeEventListener("touchcancel",p,!1),e.app.map.root.removeEventListener("touchleave",p,!1),e.app.map.root.removeEventListener("touchmove",p,!1))},h=function(){d(),u.push(dojo.connect(e.app.map,"onClick",r));var t=e.app.behaviorRegistry.behaviors.MapOnLongClickBehavior;t&&t.commands.length>0&&(u.push(dojo.connect(e.app.map,"onMouseDown",c)),u.push(dojo.connect(e.app.map,"onMouseUp",p)),u.push(dojo.connect(e.app.map,"onMouseDrag",p)),u.push(dojo.connect(e.app.map,"onPanStart",p)),u.push(dojo.connect(e.app.map,"onZoomStart",p)),Modernizr.touch&&(e.app.map.root.addEventListener("touchstart",c,!1),e.app.map.root.addEventListener("touchend",p,!1),e.app.map.root.addEventListener("touchcancel",p,!1),e.app.map.root.addEventListener("touchleave",p,!1),e.app.map.root.addEventListener("touchmove",p,!1)));var i=e.app.behaviorRegistry.behaviors.MapOnContextMenuBehavior;i&&i.commands.length>0&&e.app.map.root.addEventListener("contextmenu",l,!1)};h(),this.app.event("GraphicDrawActivatedEvent").subscribe(this,function(){0!==e._mapClickTimerHandles.length&&(e._mapClickTimerHandles.forEach(function(e){clearTimeout(e)}),e._mapClickTimerHandles=[]),d()}),this.app.event("GraphicDrawDeactivatedEvent").subscribe(this,function(){e._isAndroid?e._mapClickTimerHandles.push(setTimeout(h,950)):h()});var m=esri.toolbars.Draw.prototype.activate;esri.toolbars.Draw.prototype.activate=function(){if(!this.__attached_isActive)if(m.apply(this,arguments),this.__attached_isActive=!0,this.__attached_stopEvent)delete this.__attached_stopEvent;else{var e=arguments[0];t.app.event("GraphicDrawActivatedEvent").publish({sender:this,geometryType:e})}};var g=esri.toolbars.Draw.prototype.deactivate;if(esri.toolbars.Draw.prototype.deactivate=function(){this.__attached_isActive&&(this.__attached_stopEvent?delete this.__attached_stopEvent:t.app.event("GraphicDrawDeactivatedEvent").publish({sender:this,geometryType:null}),g.apply(this,arguments),this.__attached_isActive=!1)},this.app.event("GraphicEditActivatedEvent").subscribe(this,d),this.app.event("GraphicEditDeactivatedEvent").subscribe(this,function(){e.app.toolRegistry.getActiveTool()||h()}),void 0!==esri.toolbars.Edit){var v=0,f=null,y=esri.toolbars.Edit.prototype.activate;esri.toolbars.Edit.prototype.activate=function(){if(!this.__attached_isActive)if(y.apply(this,arguments),this.__attached_isActive=!0,this._textSymbolEditor&&(this._textSymbolEditor._showHaloStyler=!1),this.__attached_stopEvent)delete this.__attached_stopEvent;else{v=arguments[0],f=arguments[1];var e={tool:v,graphic:f,sender:this};t.app.event("GraphicEditActivatedEvent").publish(e)}};var b=esri.toolbars.Edit.prototype.deactivate;esri.toolbars.Edit.prototype.deactivate=function(){if(this.__attached_isActive){if(this.__attached_stopEvent)delete this.__attached_stopEvent;else{var e={tool:v,graphic:f,sender:this};v=0,f=null,t.app.event("GraphicEditDeactivatedEvent").publish(e)}b.apply(this,arguments),this.__attached_isActive=!1}}}},i.prototype._onGeoRssLayerLoaded=function(e){e&&e.esriLayer&&dojo.connect(e.esriLayer,"onClick",this,function(e){dojo.stopEvent(e);var t=new d.Feature({graphic:e.graphic,allowUnsafeContent:this.app.configuration.allowUnsafeContent});t.descriptionFormat.set("{content}"),t.labelFormat.set("{title}"),this.app.command("ShowMapTip").execute(t)})},i.prototype._handleSiteInitialized=function(e){e&&e.isInitialized?this._registerLayersClickableIfNeeded():this.app.trace.error("Error processing MapModule._handleSiteInitialized. - site was not initialized.")},i.prototype._registerLayersClickableIfNeeded=function(e){var t=this,i=function(e){t._registerStreamLayersAsClickable(e),t._registerLayerAdditionBasedWfsLayersAsClickable(e)},a=this.app.site;a&&a.isInitialized&&(e?i(e):a.essentialsMap.mapServices.forEach(function(e){return i(e)}))},i.prototype._registerStreamLayersAsClickable=function(e){var t=e&&e.layers&&e.layers[0];e&&t&&e.serviceLayer&&e.serviceLayer instanceof esri.layers.StreamLayer&&(t.identifiable||t.showMapTips)&&v.registerStreamLayerAsClickable(e.serviceLayer,this.app,t.displayName)},i.prototype._registerLayerAdditionBasedWfsLayersAsClickable=function(e){var t=e&&e.layers&&e.layers[0];e&&t&&e.isUserCreated&&e.userLayerType===f.UserLayerType.LAYER_ADDITION&&e.serviceLayer&&e.serviceLayer instanceof esri.layers.WFSLayer&&(t.identifiable||t.showMapTips)&&v.registerWfsLayerAsClickable(e.serviceLayer,this.app,t.displayName)},i.prototype._handleLayerUpdateStart=function(e,t){if(t){t.attached_isLoading=!0,t.attached_timers||(t.attached_timers=new Array);var i=setTimeout(dojo.hitch(this,function(){if(!(this._config.loadingMessageTiming.length<1)&&this._config.showLoadingStatus&&t.attached_isLoading){var i=this.app.getResource(this.libraryId,"language-map-loading-stage1").format(t.displayName),a=new m.AddStatusArgs(i);if(a.id=e.id+"LoadingStatus",a.showBusyIcon=!0,this.app.command("AddStatus").execute(a),this._config.loadingMessageTiming.length<2)return;var o,n=setTimeout(dojo.hitch(this,function(){if(t.attached_isLoading){if((o=this.app.viewManager.getViewById(a.id))&&o.viewModel&&o.viewModel.text.set(this.app.getResource(this.libraryId,"language-map-loading-stage2").format(t.displayName)),this._config.loadingMessageTiming.length<3)return;var e=setTimeout(dojo.hitch(this,function(){t.attached_isLoading&&(o=this.app.viewManager.getViewById(a.id))&&o.viewModel&&o.viewModel.text.set(this.app.getResource(this.libraryId,"language-map-loading-stage3").format(t.displayName))}),this._config.loadingMessageTiming[2]);t.attached_timers.push(e)}}),this._config.loadingMessageTiming[1]);t.attached_timers.push(n)}}),this._config.loadingMessageTiming[0]);t.attached_timers.push(i)}},i.prototype._handleLayerUpdateEnd=function(e,t){if(t){if(t.attached_timers){for(var i=0,a=t.attached_timers;i<a.length;i++){var o=a[i];clearTimeout(o)}t.attached_timers.length=0}t.attached_isLoading=!1;var n=e.id+"LoadingStatus";this.app.command("RemoveStatus").execute(n)}},i.prototype._handleLayerAdded=function(e,t){this._registerLayersClickableIfNeeded(t)},i.prototype._handleLayerRemoved=function(e){var t=e.id+"LoadingStatus";this.app.command("RemoveStatus").execute(t)},i.prototype._initializeCoordinateModels=function(){var e=this,t=this.id.split("-").pop(),i=this.app.configModel.moduleConfigs.filter(function(e){return e.moduleName===t})[0];i&&i.viewModelConfigs.length&&i.viewModelConfigs.forEach(function(t){var i=t.viewModelId;t.typeName===e._coordModelType&&e._mapCoordinatesControllers.push(new n.MapCoordinatesController(e.app,e.libraryId,i))})},i}(a.ModuleBase);b.extentChangePriority=6,i.MapModule=b})},"Mapping/modules/Map/MapState":function(){define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})},"Mapping/modules/Map/MapView":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();define(["require","exports","geocortex/framework/ui/ViewBase","geocortex/infrastructure/FocusUtils","geocortex/infrastructure/eventArgs/MapExtentEventArgs","./RippleClick","geocortex/infrastructure/ShellUtils","geocortex/essentials/utilities/StringUtilities","geocortex/framework/utils/utils","geocortex/framework/utils/ArrayUtils"],function(t,i,a,o,n,r,s,p,c,l){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var u=function(t){function i(e,i){var a=t.call(this,e,i)||this;return a.active=null,a.hoverTimer=null,a.firstResize=!1,a.initialized=!1,a.initializing=!1,a.extentEpoch=null,a.extentBroadcastFrequency=null,a.minScale=null,a.maxScale=null,a._layerEventsLookup={},a._mapHoverSubscriberCount=0,a._mapMouseMoveSubscriberCount=0,a._mapHoverTimeout=500,a._enableMapClickEvent=!0,a._resizePromise=null,a.app.event("ViewActivatedEvent").subscribe(a,a._updateBingLogoPosition),a.app.event("ViewDeactivatedEvent").subscribe(a,a._updateBingLogoPosition),a.app.event("RegionActivatedEvent").subscribe(a,a._updateBingLogoPosition),a.app.event("RegionDeactivatedEvent").subscribe(a,a._updateBingLogoPosition),a.app.event("ViewActivatedEvent").subscribe(a,a._updateTopLeftMapRegion),a.app.event("ViewDeactivatedEvent").subscribe(a,a._updateTopLeftMapRegion),a.app.command("ActivateMapContextMenu").register(a,a._activateMapContextMenu),a.app.event("SmallShellTopRightRegionOpeningEvent").subscribe(a,a._animateTopRightRegionOpening),a.app.event("SmallShellTopRightRegionClosingEvent").subscribe(a,a._animateTopRightRegionClosing),a}return e(i,t),i.prototype.removed=function(){null!=this.app.map&&this.app.map.destroy()},i.prototype.activated=function(){var e=this;t.prototype.activated.call(this),this.initialized||this.initialize(),this.active=!0,setTimeout(function(){return o.focusOnMap(e.app.map)},0)},i.prototype.deactivated=function(){t.prototype.deactivated.call(this),this.active=!1,clearTimeout(this.hoverTimer)},i.prototype.attach=function(e){var i=this;t.prototype.attach.call(this,e),this.viewModel&&(this.initialized||this.initialize(),this.app.waitUntilMapLoaded().then(function(){i._addBrokenPanDetection()}))},i.prototype._activateMapContextMenu=function(e){var t=this.mapDiv.getBoundingClientRect(),i=this.app.map.toScreen(e),a=t.left+i.x,o=t.top+i.y;this.app.event("MapContextMenuPointUpdatedEvent").publish(e),this.app.command("ActivateContextMenu").execute({pageX:a,pageY:o,viewId:"MapContextMenuView"})},i.prototype._addBrokenPanDetection=function(){if(/.*Trident\/([0-9]+)\..*/.test(navigator.userAgent)){var e,t;if(navigator.msPointerEnabled)e="MSPointerMove",t="MSPointerUp";else{if(!navigator.pointerEnabled)return;e="pointermove",t="pointerup"}var i=this.mapDiv.childNodes[0].childNodes[0],a=this.app.map;void 0!==a.__panning&&this._addEventListener(i,e,function(e){if(e=e||window.event,a.__panning&&0===e.buttons&&(void 0===e.pointerType||"mouse"===e.pointerType||4===e.pointerType)){var o=document.createEvent("HTMLEvents");o.initEvent(t,!1,!0),dojo.mixin(o,e),o.button=0,o.buttons=0,o.which=0,i.dispatchEvent(o)}})}},i.prototype.resize=function(){var e=this,t=this.app.map;this._resizePromise||(this._resizePromise=this.app.waitUntilShellStabilized().then(function(){if(e._resizePromise=null,e.mapDiv){e.app.map.reposition();var i=e.mapDiv.clientWidth,a=e.mapDiv.clientHeight;!0===e.isActive&&i>2&&a>2&&t.width&&t.height&&(t.width!==i||t.height!==a)&&(t.resizeDelay=0,e.app.site.essentialsMap.extentManager.blockForResize(i,a,!0),e.app.trace.debug("Map size change executing. Map will be sized to "+i+"px x "+a+"px"))}}))},i.prototype.initialize=function(){var e=this;!this.initializing&&!this.initialized&&this.viewModel&&this.root&&(this.initializing=!0,this.app.waitUntilSiteDownloaded().then(function(t){e._initializeMap(t)}))},i.prototype._initializeMap=function(e){var t=this,i=!1,a=!!Modernizr.csstransforms3d,o=!0,n=!1,s=!1,u=!1;this.configuration&&this.configuration.hasOwnProperty("wrapAround180")&&(i=this.configuration.wrapAround180),this.configuration&&this.configuration.hasOwnProperty("force3DTransforms")&&(a=this.configuration.force3DTransforms),this.configuration&&this.configuration.hasOwnProperty("showAttribution")&&(o=!!this.configuration.showAttribution),this.configuration&&this.configuration.hasOwnProperty("fitTiledMapsToExtent")&&(n=!!this.configuration.fitTiledMapsToExtent),this.configuration&&this.configuration.hasOwnProperty("disableMapKeyboardNavigation")&&(s=!!this.configuration.disableMapKeyboardNavigation),this.configuration&&this.configuration.hasOwnProperty("showLabels")&&(u=!!this.configuration.showLabels);var d={slider:!1,logo:!1,showAttribution:o,wrapAround180:i,force3DTransforms:a,autoResize:!1,fitExtent:n,showInfoWindowOnClick:!1,showLabels:u},h=null;if(e){if(e.map&&e.map.initialExtent){var m=esri.geometry.fromJson(e.map.initialExtent);if(m&&m instanceof esri.geometry.Extent){if(c.isNullOrUndefined(e.map.initialExtent.spatialReference)){var g=l.firstOrDefault(e.map.mapServices,function(e){return e.fullExtent&&e.fullExtent.spatialReference});g&&(m.spatialReference=g.fullExtent.spatialReference)}d.extent=m}}if(e.timeSliders&&e.timeSliders.length>0){var v=e.timeSliders[0],f=v.initialStartTime||v.startTime,y=v.initialEndTime||v.endTime;f&&y&&(h=new esri.TimeExtent(p.StringUtilities.getDateFromRestDateString(f),p.StringUtilities.getDateFromRestDateString(y)))}}if(this.configuration&&this.configuration.hasOwnProperty("minScale")){var b=parseFloat(this.configuration.minScale);isNaN(b)||(this.minScale=b,d.minScale=b)}if(this.configuration&&this.configuration.hasOwnProperty("maxScale")){var M=parseFloat(this.configuration.maxScale);isNaN(M)||(this.maxScale=M,d.maxScale=M)}this.rippleClick=new r.RippleClick(this.app,this.mapDiv,this.mapContainer),this.rippleClick.initialize(this.configuration),this.app.debugModeActive("time")&&this.app._debug.timers.determineTimeToESRIMapCreation(this.app),this.app.trace.debug("Initial shell height: "+this.app.initialShellHeight),this.app.trace.debug("Initial shell width: "+this.app.initialShellWidth);var x=window.innerWidth-this.app.initialShellWidth,C=window.innerHeight-this.app.initialShellHeight,_=document.getElementById("map");_.setAttribute("style","width:"+x+"px; height:"+C+"px;"),this.app.trace.debug("Set the initial map size to "+x+"x"+C),this.app.doWhenMapInitialized(function(){_.setAttribute("style","width:100%; height:100%;")}),this.app.map=new esri.Map("map",d),this.app.map._fitTiledMapsToExtent=n,this.app.map.hideZoomSlider(),this.extentBroadcastFrequency=this.configuration.extentBroadcastFrequency||0,h&&this.app.map.setTimeExtent(h),s&&this._disableMapKeyboardNavigation(),this.app.command("ZoomToInitialExtent").register(this,function(){t.app.command("ActivateView").execute(t.id)}),this.app.command("ZoomToFullExtent").register(this,function(){t.app.command("ActivateView").execute(t.id)}),this.app.event("ApplicationResizedEvent").subscribe(this,function(){return t.resize()}),this.app.command("MapResize").register(this,function(){return t.resize()}),this.app.command("ShowMap").register(this,function(){t.app.command("ActivateView").execute(t.id)}),this.app.command("EnableMapClick").register(this,function(){return t._enableMapClickEvent=!0}),this.app.command("DisableMapClick").register(this,function(){return t._enableMapClickEvent=!1}),this.app.command("DisableMapKeyboardNavigation").register(this,this._disableMapKeyboardNavigation),this.app.command("EnableMapKeyboardNavigation").register(this,this._enableMapKeyboardNavigation),this.app.event("ActiveToolChangedEvent").subscribe(this,this._toolChanged),dojo.connect(this.app.map,"onExtentChange",function(e,i,a,o){var n=o;!n&&t.app.site&&t.app.site.essentialsMap&&(n=t._getLevelOfDetails(e)),t.app.map.graphicsLayerIds.forEach(function(e){var i=t.app.map.getLayer(e),a=i.getNode();a&&a.style&&"none"===a.style.display&&i.visible&&i.visibleAtMapScale&&!i.suspended&&$(a).show()}),t.app.event("MapExtentChangeEvent").publish(e,i,a,n),t._publishWithMapExtent("MapExtentChangedEvent",e,n)}),dojo.connect(this.app.map,"onLayerAdd",this,this._layerAdd),dojo.connect(this.app.map,"onLayerAddResult",this,function(e,i){t.app.event("LayerAddResultEvent").publish(e,i),t.app.event("LayerAddedWithResultEvent").publish(e,i),t._updateBingLogoPosition()}),dojo.connect(this.app.map,"onLayerRemove",this,function(e){if(e){var i=t._layerEventsLookup[e.id];if(i){for(var a=0,o=i;a<o.length;a++){var n=o[a];dojo.disconnect(n)}delete t._layerEventsLookup[e.id]}t.app.event("LayerRemovedEvent").publish(e),t._updateBingLogoPosition()}}),dojo.connect(this.app.map,"onLayersAddResult",this,function(e){t.app.event("LayersAddedWithResultEvent").publish(e||[]),t._updateBingLogoPosition()}),dojo.connect(this.app.map,"onPanStart",function(e,i){t.app.event("MapPanStartEvent").publish(e,i),t.app.event("MapPanStartedEvent").publish(e,i)}),dojo.connect(this.app.map,"onPan",function(e,i){t.app.event("MapPanEvent").publish(e,i),t._broadcastExtent(e)}),dojo.connect(this.app.map,"onPanEnd",function(e,i){t.app.event("MapPanEndEvent").publish(e,i),t.app.event("MapPanEndedEvent").publish(e,i)}),dojo.connect(this.app.map,"onZoomStart",function(e,i,a,o){t.app.event("MapZoomStartEvent").publish(e,i,a,o),t.app.event("MapZoomStartedEvent").publish(e,i,a,o)}),dojo.connect(this.app.map,"onZoom",function(e,i,a){t.app.event("MapZoomEvent").publish(e,i,a),t._broadcastExtent(e)}),dojo.connect(this.app.map,"onZoomEnd",function(e,i,a,o){t.app.event("MapZoomEndEvent").publish(e,i,a,o),t.app.event("MapZoomEndedEvent").publish(e,i,a,o)}),dojo.connect(this.app.map,"onLoad",function(e){if(t.minScale||t.maxScale){var i=t.app.map._params,a=i.lods;if(a&&a.length){var o=t.app.map.__tileInfo.lods;if(t.minScale){for(;a[0].scale<t.minScale;){s=Math.min(t.minScale,2*a[0].scale);(p=new esri.layers.LOD).level=0,p.scale=s,p.resolution=a[0].resolution*s/a[0].scale,a.splice(0,0,p),o.splice(0,0,p),i.hasOwnProperty("maxZoom")&&i.maxZoom++}for(var n=0;n<a.length;n++)a[n].level=n,o[n].level=n}if(t.maxScale)for(var r=a.length-1;a[r].scale>t.maxScale;){var s=Math.max(t.maxScale,.5*a[r].scale),p=new esri.layers.LOD;p.level=a[r].level+1,p.scale=s,p.resolution=a[r].resolution*s/a[r].scale,a.push(p),o.push(p),i.maxZoom=p.level,r++}}}t._installZoomFix(),t.app.site.essentialsMap.isLoaded=!0,t.app.event("MapLoadedEvent").publish(e)}),dojo.connect(this.app.map,"onClick",function(e){t._enableMapClickEvent&&(t.app.event("MapClickedEvent").publish(e),e.mapPoint&&t.app.event("MapClickedPointEvent").publish(e.mapPoint))}),dojo.connect(this.app.map,"onMouseDown",function(e){t.app.event("MapMouseDownEvent").publish(e)}),dojo.connect(this.app.map,"onMouseUp",function(e){t.app.event("MapMouseUpEvent").publish(e)}),dojo.connect(this.app.map,"onTimeExtentChange",function(e){t.app.event("MapTimeExtentChangedEvent").publish(e)}),dojo.subscribe("LayerVisibilityChange",function(e){var i=[];if(e&&e.length>0)for(var a=0,o=e;a<o.length;a++){var n=o[a];if(n&&n.mapServiceId&&n.layerId){var r=t.app.site.essentialsMap.findMapServiceById(n.mapServiceId);if(r){var s=r.findLayerById(n.layerId);s&&i.push({layer:s,mapService:r,visibility:n.visibility})}}else t.app.trace.error(t.id+" can't find map service for layer. Either mapServiceId or layerId are not available.")}t.app.event("LayerVisibilityChangedEvent").publish(i)}),dojo.subscribe("ServiceLayerInitializedEvent",function(e){t.app.event("SiteLayerLoadingEvent").publish(e)}),dojo.subscribe("MapServiceVisibilityChangedEvent",function(e){e&&(t.app.event("MapServiceVisibilityChangedEvent").publish(e.serviceLayer,e),t._updateBingLogoPosition())}),dojo.subscribe("MapServiceAddedEvent",function(e){e&&t.app.event("MapServiceAddedEvent").publish(e)}),dojo.subscribe("MapServiceRemovedEvent",function(e){e&&t.app.event("MapServiceRemovedEvent").publish(e)}),dojo.subscribe("CatalogLayerAddedEvent",function(e){return t.app.event("CatalogLayerAddedEvent").publish(e)}),dojo.subscribe("CatalogLayerRemovedEvent",function(e){return t.app.event("CatalogLayerRemovedEvent").publish(e)}),dojo.subscribe("MapServiceLayersChangedWithResultEvent",function(e){return t.app.event("MapServiceLayersChangedWithResultEvent").publish(e)}),this._attachMouseHoverHandlers(),this._attachMouseMoveHandlers(),this._updateBingLogoPosition(),this.initialized=!0,this.app.event("MapInitializedEvent").publish()},i.prototype._installZoomFix=function(){var e=this;this.app.map.on("zoom-start",function(t){e.app.map.layerIds.forEach(function(t){var i=e.app.map.getLayer(t);if(i&&i instanceof esri.layers.DynamicMapServiceLayer&&i.updating){var a=i._img;a&&(a.style.display="none")}})})},i.prototype._addEventListener=function(e,t,i){e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent&&e.attachEvent("on"+t,i)},i.prototype._removeEventListener=function(e,t,i){e.removeEventListener?e.removeEventListener(t,i,!1):e.detachEvent&&e.detachEvent("on"+t,i)},i.prototype._attachMouseMoveHandlers=function(){var e=this,t=s.throttle(function(t){t.mapPoint&&e.app.event("MapMouseMovePointEvent").publish(t.mapPoint)},50);dojo.aspect.after(this.app.event("MapMouseMovePointEvent"),"subscribe",function(i){return e._mapMouseMoveSubscriberCount++<=0&&e._addEventListener(e.app.map.root,"mousemove",t),i}),dojo.aspect.after(this.app.event("MapMouseMovePointEvent"),"unsubscribe",function(){--e._mapMouseMoveSubscriberCount<=0&&e._removeEventListener(e.app.map.root,"mousemove",t)})},i.prototype._attachMouseHoverHandlers=function(){var e=this,t=function(t){clearTimeout(e.hoverTimer);var i={clientX:t.clientX,clientY:t.clientY};e.hoverTimer=setTimeout(function(){e.app.event("MapMouseHoverEvent").publish(i)},e._mapHoverTimeout)},i=function(t){t.explicitOriginalTarget&&"path"===t.explicitOriginalTarget.localName||clearTimeout(e.hoverTimer)};dojo.aspect.after(this.app.event("MapMouseHoverEvent"),"subscribe",function(a){return e._mapHoverSubscriberCount++<=0&&(e._addEventListener(e.app.map.root,"mousemove",t),e._addEventListener(e.app.map.root,"mouseout",i)),a}),dojo.aspect.after(this.app.event("MapMouseHoverEvent"),"unsubscribe",function(){--e._mapHoverSubscriberCount<=0&&(e._removeEventListener(e.app.map.root,"mousemove",t),e._removeEventListener(e.app.map.root,"mouseout",i))})},i.prototype._updateTopLeftMapRegion=function(e){if("TopMapRegion"===e.regionName){var t=this.app.viewManager.getExistingRegionByName("TopMapRegion");t&&t.views.filter(function(e){return"DataFrameButtonView"!==e.id&&e.isActive}).length>0?$(".map-top-left").removeClass("map-top-hidden").addClass("map-top-visible"):$(".map-top-left").removeClass("map-top-visible").addClass("map-top-hidden")}},i.prototype._updateBingLogoPosition=function(){for(var e=0;this.app.map&&e<this.app.map.layerIds.length;e++){var t=this.app.map.getLayer(this.app.map.layerIds[e]);if(t.isInstanceOf(esri.virtualearth.VETiledLayer)&&t.visible){var i=this.app.viewManager.getExistingRegionByName("BottomLeftMapRegion");if(i){var a=i.activeViews;if(a&&a.length>0){for(var o=0,n=0,r=a;n<r.length;n++){var s=r[n];s.root.clientHeight>o&&(o=s.root.clientHeight)}$(".bingLogo-lg").css("bottom",o)}}return}}},i.prototype._broadcastExtent=function(e){var t=null,i=null;this.extentEpoch||(this.extentEpoch=+new Date),(t=+new Date)-this.extentEpoch>this.extentBroadcastFrequency&&(this.app.site&&this.app.site.essentialsMap&&(i=this._getLevelOfDetails(e)),this._publishWithMapLod("MapExtentChangingEvent",i),this.extentEpoch=t)},i.prototype._layerAdd=function(e){var t=this,i=this.app.site.essentialsMap.mapServices.filter(function(t){return t.serviceLayer===e});if(0!==i.length){var a=i[0];this.app.event("LayerAddEvent").publish(e,a),this.app.event("LayerAddedEvent").publish(e,a);var o=[];this._layerEventsLookup[e.id]=o,o.push(dojo.connect(e,"onUpdateStart",this,function(){t.app.event("LayerUpdateStartEvent").publish(e,a),t.app.event("LayerUpdateStartedEvent").publish(e,a)})),o.push(dojo.connect(e,"onUpdateEnd",this,function(){t.app.event("LayerUpdateEndEvent").publish(e,a),t.app.event("LayerUpdateEndedEvent").publish(e,a)})),o.push(dojo.connect(e,"onVisibilityChange",this,function(){t.app.event("MapServiceVisibilityChangedEvent").publish(e,a),t._updateBingLogoPosition()})),this._updateBingLogoPosition()}},i.prototype._getLevelOfDetails=function(e){var t={scale:this.app.site.essentialsMap.calculateScale()};return e&&this.app.map&&this.app.map.width>0&&(t.resolution=e.getWidth()/this.app.map.width),t},i.prototype._publishWithMapLod=function(e,t){var i=null;t&&((i=new n.MapExtentEventArgs).currentScale=t.scale,i.currentResolution=t.resolution),this.app.event(e).publish(i)},i.prototype._publishWithMapExtent=function(e,t,i){var a=null;i&&((a=new n.MapExtentEventArgs).currentScale=i.scale,a.currentResolution=i.resolution),this.app.event(e).publish(t,a)},i.prototype._toolChanged=function(e){e.tool&&this.app.command("ActivateView").execute(this.id)},i.prototype._disableMapKeyboardNavigation=function(){this._setMapKeyboardNavigation(!1)},i.prototype._enableMapKeyboardNavigation=function(){this._setMapKeyboardNavigation(!0)},i.prototype._setMapKeyboardNavigation=function(e){var t=this;if(this.app.map){var i=function(e){e?t.app.map.enableKeyboardNavigation():t.app.map.disableKeyboardNavigation()};this.app.map.loaded?i(e):this.app.event("MapLoadedEvent").once(this,function(){i(e)})}},i.prototype._animateTopRightRegionOpening=function(){$(".region.map-top").removeClass("map-top-slide-up"),$(".region.map-top").addClass("map-top-slide-down")},i.prototype._animateTopRightRegionClosing=function(){$(".region.map-top").removeClass("map-top-slide-down"),$(".region.map-top").addClass("map-top-slide-up")},i}(a.ViewBase);i.MapView=u})},"Mapping/modules/Map/MapViewModel":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();define(["require","exports","geocortex/framework/ui/ViewModelBase","geocortex/framework/observables","geocortex/essentials/MapServiceConstants","geocortex/essentials/MapService","geocortex/essentials/Layer","geocortex/infrastructure/MapUtils","geocortex/infrastructure/GraphicsLayerIds","geocortex/infrastructure/GraphicsLayerUtils"],function(t,i,a,o,n,r,s,p,c,l){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var u=function(t){function i(e,i){var a=t.call(this,e,i)||this;return a._zoomedExtent=null,a.showMap=new o.Observable(!0),a.showError=new o.Observable(!1),a.showAuthError=new o.Observable(!1),a.showCriticalServicesError=new o.Observable(!1),a.siteFailed=new o.Observable(!1),a.temporaryGraphicsLayer=null,a.temporaryMarkupSymbol=null,a.stepZoomFactor=.5,a.registerCommands(),a}return e(i,t),i.prototype.initialize=function(e){if(t.prototype.initialize.call(this,e),e&&e.hasOwnProperty("stepZoomFactor")){var i=parseFloat(e.stepZoomFactor);this.stepZoomFactor=!isNaN(i)&&i>0?i:.5}this.temporaryMarkupSymbol=new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_DIAMOND,20,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new esri.Color([0,0,0]),1),new esri.Color([255,255,0,.5])),this.app.event("SiteInitializationFailedEvent").subscribe(this,function(e){this.showMap.set(!1),this.showError.set(!0)}),this.app.event("SiteAuthorizationFailedEvent").subscribe(this,function(e){this.showMap.set(!1),this.showAuthError.set(!0)}),this.app.event("SiteServiceLayersFailedEvent").subscribe(this,function(e){dojo.some(e,function(e){return e.failureAction===n.FailureAction.ERROR})&&(this.showMap.set(!1),this.showCriticalServicesError.set(!0))}),this.app.event("UserSignInCancelledEvent").subscribe(this,function(e){this.showMap.set(!1),this.showAuthError.set(!0)}),this.app.event("MapLoadedEvent").subscribe(this,this._subscribeToMapEvents),this.app.event("UserAddedLayerOrMapServiceRemovedEvent").subscribe(this,this._userAddedLayerOrMapServiceRemoved)},i.prototype.registerCommands=function(){var e=this;this.app.command("AddTemporaryMarkupGeometry").register(this,function(e){if(this.temporaryGraphicsLayer||(this.temporaryGraphicsLayer=l.getInternalGraphicsLayer(c.TEMP_GRAPHICS_LAYER_ID,this.app,l.GraphicsLayerType.Markup,!1)),e){var t=null;switch(e.type){case"polygon":case"extent":t=new esri.symbol.SimpleFillSymbol(esri.symbol.SimpleFillSymbol.STYLE_SOLID,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new esri.Color([255,51,51,.8]),2),new esri.Color([255,51,51,.5]));break;case"polyline":t=new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new esri.Color([204,51,51,.8]),2);break;default:t=new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,14,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new esri.Color([0,0,0]),1),new esri.Color([204,51,51]))}this.temporaryGraphicsLayer.add(new esri.Graphic(e,t))}}),this.app.command("ClearTemporaryMarkup").register(this,function(){e.temporaryGraphicsLayer&&e.temporaryGraphicsLayer.clear()}),this.app.command("AddMapService").register(this,this._executeAddMapService),this.app.command("RemoveMapService").register(this,this._executeRemoveMapService,this._canExecuteRemoveMapService),this.app.command("RemoveUserAddedLayer").register(this,this._executeRemoveUserAddedLayer,this._canExecuteRemoveUserAddedLayer),this.app.command("ZoomToInitialExtent").register(this,function(){setTimeout(function(){if(null!=e.app.map){if(null===e.app.site||!e.app.site.isInitialized||null===e.app.site.essentialsMap)return void e.app.trace.warning("Could not zoom to initial extent - Site was null or uninitialized.");if(!e.app.site.essentialsMap.isInitialized||null===e.app.site.essentialsMap.initialExtent)return void e.app.trace.warning("Could not zoom to initial extent - Map was not initialized or has no initial extent.");e.app.site.essentialsMap.extentManager.setExtentWithPriority(e.app.site.essentialsMap.initialExtent,8)}},1)}),this.app.command("ZoomToFullExtent").register(this,function(){setTimeout(function(){if(null!=e.app.map){if(null===e.app.site||!e.app.site.isInitialized||null===e.app.site.essentialsMap)return void e.app.trace.warning("Could not zoom to full extent - Site was null or uninitialized.");if(!e.app.site.essentialsMap.isInitialized||null===e.app.site.essentialsMap.fullExtent)return void e.app.trace.warning("Could not zoom to full extent - Map was not initialized or has no full extent.");e.app.site.essentialsMap.extentManager.setExtentWithPriority(e.app.site.essentialsMap.fullExtent,8)}},1)}),this.app.command("StepZoomIn").register(this,this._executeStepZoomIn),this.app.command("StepZoomOut").register(this,this._executeStepZoomOut)},i.prototype._executeAddMapService=function(e){this.app.site.essentialsMap.addMapService(e)},i.prototype._canExecuteRemoveMapService=function(e){return!!(this.app.site&&this.app.site.essentialsMap&&this.app.site.essentialsMap.mapServices&&this.app.site.essentialsMap.mapServices.some(function(t){return t.isUserCreated&&t.serviceLayer==e.serviceLayer}))},i.prototype._executeRemoveMapService=function(e){e.catalogId?this.app.command("RemoveLayerCatalogItem").execute(e):this.app.site.essentialsMap.removeMapService(e),this.app.event("UserAddedLayerOrMapServiceRemovedEvent").publish(e)},i.prototype._executeRemoveUserAddedLayer=function(e){e.catalogId?this.app.command("RemoveLayerCatalogItem").execute(e):this.app.site.essentialsMap.removeMapService(e.mapService);var t=this.app.viewManager.getViewById("LayerActionsView");t&&this.app.viewManager.deactivateView(t),this.app.event("UserAddedLayerOrMapServiceRemovedEvent").publish(e)},i.prototype._userAddedLayerOrMapServiceRemoved=function(e){var t=this;if(e){var i=new Array;e instanceof s.Layer?i.push(e):e instanceof r.MapService&&e.layers.forEach(function(e){i.push(e)});var a=this.app.featureSetManager.featureSetCollections;a&&a.getLength()>0&&a.get().forEach(function(e){i.forEach(function(i){if(e.featureSets&&e.featureSets.get()&&e.featureSets.getLength()>0)for(var a=e.featureSets.get(),o=0;o<a.length;o++)if(a[o].layer===i){a[o].clearFeatures(),t.app.event("_featureRemovedFromResults").publish(),e.featureSets.removeItem(a[o]),t.app.command("_updateMetadataForSavedSelections").execute(e);break}})})}},i.prototype._canExecuteRemoveUserAddedLayer=function(e){if(!e||!e.isUserCreated)return!1;if(e.catalogId)return this._canRemoveCatalogLayer(e);var t=e.mapService;return t.mapServiceType==n.MapServiceType.FEATURE||t.drawingBehavior==n.DrawingBehavior.FEATURE_LAYER||t.drawingBehavior==n.DrawingBehavior.WFS_LAYER||t.drawingBehavior==n.DrawingBehavior.STREAM_LAYER},i.prototype._canRemoveCatalogLayer=function(e){return e&&e.isUserCreated&&e.mapService.layers.length>0&&!String.isNullOrEmpty(e.catalogId)},i.prototype._executeStepZoomOut=function(){this.app.command("ShowMap").execute(),this._zoomedExtent=p.stepZoomWithPriority(this.app.site,this.stepZoomFactor,this._zoomedExtent,5)},i.prototype._executeStepZoomIn=function(){this.app.command("ShowMap").execute(),this._zoomedExtent=p.stepZoomWithPriority(this.app.site,1/this.stepZoomFactor,this._zoomedExtent,5)},i.prototype._subscribeToMapEvents=function(){dojo.connect(this.app.map,"onPanEnd",this,function(){this._zoomedExtent=null}),dojo.connect(this.app.map,"onZoomEnd",this,function(){this._zoomedExtent=null})},i}(a.ViewModelBase);i.MapViewModel=u})},"Mapping/modules/Map/RippleClick":function(){define(["require","exports","geocortex/framework-ui/animation/Animation","geocortex/infrastructure/tools/MapTool"],function(e,t,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t,i){this.rippleClickEnabled=!0,this._disableThisRippleClick=!1,this.app=e,this.mapDiv=t,this.mapContainer=i}return e.prototype.initialize=function(e){var t=this;-1!==navigator.appVersion.indexOf("MSIE 10")||$(document.documentElement).hasClass("dj_ie9")?(this.rippleClickEnabled=!1,this.app.trace.debug("Ripple Click disabled on browsers that do not support the pointer-events css property.")):e.rippleClick||null==e.rippleClick?this.rippleClickEnabled=!0:this.rippleClickEnabled=!1,this.app.waitUntilSiteInitialized().then(function(){t.registerEventsAndCommands()})},e.prototype.registerEventsAndCommands=function(){var e=this;this._addEventListener(this.mapContainer,"click",function(t){e._stopRippleClick(),e.app.command("RippleClick").execute(t)}),this.app.command("RippleClick").register(this,this._executeRippleClick,this._canExecuteRippleClick),this.app.command("ToggleRippleClick").register(this,this._toggleRippleClick),this.app.command("DisableRippleClick").register(this,this._disableRippleClick),this.app.command("EnableRippleClick").register(this,this._enableRippleClick),this._addEventListener(this.mapContainer,"mousewheel",function(t){e._stopRippleClick()}),this.app.event("MapZoomStartedEvent").subscribe(this,function(){e._stopRippleClick()}),this.app.event("MapPanEvent").subscribe(this,function(){e._stopRippleClick(),e._disableThisRippleClick=!0}),this.app.event("MapPanEndedEvent").subscribe(this,function(){setTimeout(function(){e._disableThisRippleClick=!1},0)}),this.app.event("GraphicEditActivatedEvent").subscribe(this,function(){e.app.command("DisableRippleClick").execute()}),this.app.event("GraphicEditDeactivatedEvent").subscribe(this,function(){e.app.command("EnableRippleClick").execute()}),this.app.event("ActiveToolChangedEvent").subscribe(this,this._toolChanged)},e.prototype._toolChanged=function(e){var t=this;!e.tool||e.tool instanceof a.MapTool&&this._isPointIdentify(e.tool)?(this.app.command("EnableRippleClick").execute(),this._disableThisRippleClick=!0,setTimeout(function(){t._disableThisRippleClick=!1},0)):this.app.command("DisableRippleClick").execute()},e.prototype._isPointIdentify=function(e){return"Identify"===e.command&&("POINT"===e.drawMode||"MULTIPOINT"===e.drawMode)},e.prototype._canExecuteRippleClick=function(e){return!!this.rippleClickEnabled&&(!!this._clickHitMap(e)&&(!this._disableThisRippleClick||(this._disableThisRippleClick=!1,!1)))},e.prototype._clickHitMap=function(e){return e.target===this.app.map._layersDiv||e.target===this.app.map._gc._surface.rawNode||((" "+e.target.className+" ").indexOf(" region ")>-1||!!e.graphic)},e.prototype._stopRippleClick=function(){var e=this;$("#rippleClickElem")[0]&&this.animation&&this.animation.stop().then(function(){e.animation=null})},e.prototype._executeRippleClick=function(e){if(null==this.animation){this.parent||(this.parent=$(this.mapDiv));var t;this.rippleElem?t=$(this.rippleElem):(this.parent.append($("<span></span>").attr("id","rippleClickElem")),t=this.parent.find("#rippleClickElem"),this.rippleElem=t[0]);var a=Math.max(this.parent.width(),this.parent.height());t.css({width:a,height:a});var o=e.pageX-this.parent.offset().left-t.width()/2,n=e.pageY-this.parent.offset().top-t.width()/2;t.css({left:o+"px",top:n+"px"}),this.animation=i.create(t.get()[0]),this.animation.setResets(!0).add({className:"animate"}).play(),this.app.trace.debug("Executed a Ripple Click")}},e.prototype._toggleRippleClick=function(){this.rippleClickEnabled=!this.rippleClickEnabled},e.prototype._disableRippleClick=function(){this.rippleClickEnabled=!1},e.prototype._enableRippleClick=function(){this.rippleClickEnabled=!0},e.prototype._addEventListener=function(e,t,i){e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent&&e.attachEvent("on"+t,i)},e}();t.RippleClick=o})},"Mapping/modules/Map/ScaleSharingLinkProvider":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();define(["require","exports","geocortex/infrastructure/sharing/SharingLinkProviderBase"],function(t,i,a){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=function(t){function i(e,i){var o=t.call(this,e,i)||this;return o.name="scale",o.priority=a.ExtentLinkPriority.SCALE,o}return e(i,t),i.prototype.generate=function(){return this.app.map.extent?this.app.map.getScale().toString():""},i.prototype.apply=function(e){var t=this;if(e){var i=parseFloat(e);isNaN(i)?this.app.trace.warning("Unable to parse the scale parameter {0}: expected a single number value.".format(e)):this.app.waitUntilShellStabilized().then(function(){t.app.site.essentialsMap.extentManager.setScaleWithPriority(i,7)})}},i}(a.SharingLinkProviderBase);i.ScaleSharingLinkProvider=o})},"Mapping/modules/Map/MapContextMenu/MapContextMenuView":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();define(["require","exports","geocortex/framework/ui/ViewBase","geocortex/infrastructure/commandArgs/ShowMapElementArgs"],function(t,i,a,o){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(t){function i(e,i){var a=t.call(this,e,i)||this;return a._pushPinId="MapContextMenuPushPin",a.app.event("MapContextMenuPointUpdatedEvent").subscribe(a,a._updatePointInfo),a.app.configuration.mobileMode?a.app.event("SmallBottomPanelClosedEvent").subscribe(a,a._smallBottomPanelClosedHandler):a.app.event("ContextMenuDeactivated").subscribe(a,a._contextMenuDeactivatedHandler),a}return e(i,t),i.prototype.activated=function(){this._stopMapClicks()},i.prototype.deactivated=function(){this._enableMapClicks(),this._removePushPin()},i.prototype._stopMapClicks=function(){this.app.event("FlyoutActivated").publish(this)},i.prototype._enableMapClicks=function(){this.app.event("FlyoutDeactivated").publish(this)},i.prototype._contextMenuDeactivatedHandler=function(){this.isActive&&(this._removePushPin(),this._enableMapClicks())},i.prototype._smallBottomPanelClosedHandler=function(){this.isActive&&this._enableMapClicks()},i.prototype._updatePointInfo=function(e){this._showPushPin(e)},i.prototype._deactivateContextMenu=function(){this.app.command("DeactivateContextMenu").execute()},i.prototype._showPushPin=function(e){var t=document.createElement("div"),i=document.createElement("img");i.src="Resources/Images/Pushpins/map-marker-green-32.png",i.style.pointerEvents="none",t.appendChild(i);var a=new o.ShowMapElementArgs(this._pushPinId,e,t);this.app.command("ShowMapElement").execute(a),this.app.configuration.mobileMode?this.app.command("PanToPoint").execute(e):this.app.event("MapExtentChangingEvent").once(this,this._handleExtentChangedEvent)},i.prototype._removePushPin=function(){this.app.isShuttingDown||this.app.command("HideMapElement").execute(this._pushPinId)},i.prototype._handleExtentChangedEvent=function(){this._deactivateContextMenu(),this._removePushPin()},i}(a.ViewBase);i.MapContextMenuView=n})},"Mapping/modules/Map/MapContextMenu/Views/Coordinates/CoordinatesViewModel":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();define(["require","exports","geocortex/framework/ui/ViewModelBase","geocortex/framework/observables","geocortex/infrastructure/coordinates/CoordinateUtils"],function(t,i,a,o,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.showCoordinates=new o.Observable(!1),e.xValue=new o.Observable,e.yValue=new o.Observable,e.xType=new o.Observable(""),e.yType=new o.Observable(""),e._isActive=!1,e}return e(i,t),i.prototype.initialize=function(e){t.prototype.initialize.call(this,e),e.showCoordinates&&(this._isActive=!0,this.app.event("MapContextMenuPointUpdatedEvent").subscribe(this,this._updatePointInfo))},i.prototype._updatePointInfo=function(e){var t=this;this._isActive&&this.app.coordinatesManager.getCoordinate(e).then(function(e){var i,a;switch(e.targetCoordinateSystem.output){case"xy":i=n.getResource(t.app,"x"),a=n.getResource(t.app,"y");break;case"mgrs":i=n.getResource(t.app,"MGRS"),a=null;break;case"usng":i=n.getResource(t.app,"USNG"),a=null;break;default:i=n.getResource(t.app,"latitude-abbrev"),a=n.getResource(t.app,"longitude-abbrev")}t.xType.set(i+":"),t.yType.set(a?a+":":null),t.xValue.set(e.formattedGeoCoordString?e.formattedGeoCoordString.coordinateValue:e.formattedLatitudeOrX),t.yValue.set(null===t.yType.get()?null:e.formattedLongitudeOrY),t.showCoordinates.set(!0)},function(e){t.app.trace.warning(e.message),t.showCoordinates.set(!1)})},i}(a.ViewModelBase);i.CoordinatesViewModel=r})},"Mapping/modules/Map/MapContextMenu/Views/Menu/MapMenuView":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();define(["require","exports","geocortex/infrastructure/menus/MenuView"],function(t,i,a){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return e(i,t),i.prototype.attach=function(e){t.prototype.attach.call(this,e),this.title.set(this.getResource("language-menu-map-context-menu-title"))},i.prototype.resolveWidget=function(e,i,a){if(t.prototype.resolveWidget.call(this,e,i),"MapContextMenuWidget"===e)return this.app.menuRegistry.createMenuWidget(this,i,a)},i.prototype._deactivateContextMenu=function(){this.app.command("DeactivateContextMenu").execute()},i.prototype.handleMenuItemClick=function(e,i,a){this.app.configuration.mobileMode||this._deactivateContextMenu(),t.prototype.handleMenuItemClick.call(this,e,i,a)},i}(a.MenuView);i.MapMenuView=o})},"Mapping/modules/Map/MapContextMenu/Views/Menu/MapMenuViewModel":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();define(["require","exports","geocortex/infrastructure/menus/MenuViewModel","geocortex/framework/observables"],function(t,i,a,o){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.showMenu=new o.Observable(!1),e.mapPoint=new o.Observable,e}return e(i,t),i.prototype.initialize=function(e){t.prototype.initialize.call(this,e),e.showMenu&&this.app.menuRegistry.getMenu("MapContextMenu")&&(this.showMenu.set(!0),this.app.event("MapContextMenuPointUpdatedEvent").subscribe(this,this._updatePointInfo))},i.prototype._updatePointInfo=function(e){this.mapPoint.set(e)},i}(a.MenuViewModel);i.MapMenuViewModel=n})},"Mapping/modules/Map/MapContextMenu/Views/ReverseGeocode/ReverseGeocodeViewModel":function(){var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();define(["require","exports","geocortex/framework/ui/ViewModelBase","geocortex/framework/observables","geocortex/infrastructure/ReverseGeocoder"],function(t,i,a,o,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.showReverseGeocoder=new o.Observable(!1),e.label=new o.Observable,e.address=new o.Observable,e.isSearching=new o.Observable(!1),e}return e(i,t),i.prototype.initialize=function(e){t.prototype.initialize.call(this,e),e.showReverseGeocoder&&(this.app.site&&this.app.site.isInitialized?this._handleSiteInitialized():this.app.event("SiteInitializedEvent").once(this,this._handleSiteInitialized))},i.prototype._handleSiteInitialized=function(){var e=this.app.site.geocodingEndpoints;if(e)for(var t=0;t<e.length;t++){var i=e[t];if(i.isDefaultReverseGeocoder){this._endpoint=i;break}}this._endpoint&&(this.showReverseGeocoder.set(!0),this.reverseGeocoder=new n.ReverseGeocoder(this.app,this._endpoint),this.label.set(this.getResource("language-map-context-menu-reverse-geocode-label")),this.app.event("MapContextMenuPointUpdatedEvent").subscribe(this,this._updatePointInfo))},i.prototype._updatePointInfo=function(e){var t=this;this.app.isOffline.get()?this.showReverseGeocoder.set(!1):(this.showReverseGeocoder.set(!0),this.address.set(this.getResource("language-map-context-menu-reverse-geocode-search-in-progress")),this.isSearching.set(!0),this.reverseGeocoder.reverseGeocode(e).then(function(e){t.isSearching.set(!1),e&&e.address?t.address.set(e.address):t._handleResultError()},function(e){t.isSearching.set(!1),t._handleResultError()}))},i.prototype._handleResultError=function(){this.address.set(this.getResource("language-map-context-menu-reverse-geocode-search-no-result"))},i}(a.ViewModelBase);i.ReverseGeocodeViewModel=r})},"url:/Mapping/modules/Map/MapContextMenu/MapContextMenuView.html":t,"url:/Mapping/modules/Map/MapContextMenu/Views/Coordinates/CoordinatesView.html":i,"url:/Mapping/modules/Map/MapContextMenu/Views/Menu/MapMenuView.html":a,"url:/Mapping/modules/Map/MapContextMenu/Views/ReverseGeocode/ReverseGeocodeView.html":o,"url:/Mapping/modules/Map/MapHostView.html":n,"url:/Mapping/modules/Map/MapView.html":r}}),require(["geocortex/framework/resourceManager"],function(e){e.resourceManager.register("Mapping","inv","Mapping/modules/Map/CSS/common.css","css","DQovKiBNQVAgKENPTU1PTikgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovDQoNCi5tYXAsDQoubWFwLXJlZ2lvbiB7DQogICAgcG9zaXRpb246IGFic29sdXRlOw0KICAgIHdpZHRoOiAxMDAlOw0KICAgIGhlaWdodDogMTAwJTsNCiAgICAvKnotaW5kZXg6IDEwMDsqLw0KfQ0KDQoubWFwLXRvcC1sZWZ0IHsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgbGVmdDogMDsNCiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7DQp9DQoNCi5tYXAtdG9wLWxlZnQubWFwLXRvcC1oaWRkZW4gew0KICAgIHRvcDogMy4wNWVtOw0KfQ0KDQoubWFwLXRvcCB7DQogICAgYmFja2dyb3VuZC1jb2xvcjogd2hpdGU7DQogICAgcG9zaXRpb246IHJlbGF0aXZlOw0KfQ0KDQoubm8tdG91Y2ggLm1hcC10b3AtbGVmdCB7DQogICAgLyp0b3A6IDMuMDVlbTsqLw0KfQ0KDQoubWFwLWJvdHRvbS1sZWZ0IHsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgYm90dG9tOiAwZW07DQogICAgbGVmdDogMGVtOw0KICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsNCiAgICBmbG9hdDogbGVmdDsNCn0NCg0KLm1hcC1ib3R0b20tbGVmdCAuYWN0aXZlIHsNCiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2sgIWltcG9ydGFudDsNCiAgICB2ZXJ0aWNhbC1hbGlnbjogYm90dG9tOw0KfQ0KDQoubWFwIC5iaW5nTG9nby1sZyB7DQogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKCJSZXNvdXJjZXMvSW1hZ2VzL2JpbmctbG9nby03MHg0MC5wbmciKTsNCiAgICBsZWZ0OiAwOw0KICAgIHdpZHRoOiA3MHB4Ow0KICAgIGhlaWdodDogNDBweDsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgei1pbmRleDogMTsNCn0NCg0KLm1hcC1uYXZpZ2F0aW9uLXJlZ2lvbiB7DQogICAgcG9zaXRpb246IHJlbGF0aXZlOw0KICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsNCiAgICBmbG9hdDogbGVmdDsNCiAgICBtYXgtaGVpZ2h0OiA0MCU7DQogICAgbWF4LXdpZHRoOiA1MCU7DQogICAgLyp6LWluZGV4OiAxMDE7Ki8NCiAgICBtYXJnaW4tbGVmdDogMy45ZW07DQp9DQoNCi5uby10b3VjaCAubWFwLW5hdmlnYXRpb24tcmVnaW9uIHsNCiAgICBtYXJnaW4tbGVmdDogMy4xZW07DQp9DQoNCi5tYXAtYmFzZW1hcC1yZWdpb24gew0KICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsNCiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7DQogICAgZmxvYXQ6IHJpZ2h0Ow0KICAgIG1hcmdpbjogNXB4IDVweCAwIDVweDsNCiAgICBtYXgtd2lkdGg6IDYwJTsNCn0NCg0KLm1hcC10b3AtY2VudGVyIHsNCiAgICB0b3A6IDA7DQogICAgcG9zaXRpb246IHJlbGF0aXZlOw0KfQ0KDQoubWFwLXRvcC1yaWdodCB7DQogICAgcG9zaXRpb246IHJlbGF0aXZlOw0KICAgIHRvcDogMDsNCiAgICByaWdodDogMDsNCiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7DQogICAgZmxvYXQ6IHJpZ2h0Ow0KfQ0KDQoubWFwLXRvcC1yaWdodCA+IC52aWV3IHsNCiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7DQogICAgdmVydGljYWwtYWxpZ246IG1pZGRsZTsNCn0NCg0KLm1hcC1taWRkbGUtbGVmdCB7DQogICAgcG9zaXRpb246IGFic29sdXRlOw0KICAgIGxlZnQ6IDA7DQogICAgdG9wOiA1MCU7DQp9DQoNCi5tYXAtbWlkZGxlLXJpZ2h0IHsNCiAgICByaWdodDogMDsNCn0NCg0KLm1hcC1ib3R0b20tY2VudGVyIHsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgYm90dG9tOiAwOw0KICAgIHdpZHRoOiAxMDAlOw0KICAgIGhlaWdodDogYXV0bzsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgcG9pbnRlci1ldmVudHM6IG5vbmU7DQp9DQoNCi5zdGF0dXMtd2luZG93IHsNCiAgICBwb2ludGVyLWV2ZW50czogYXV0bzsNCn0NCg0KLm1hcC1ib3R0b20tY2VudGVyIC52aWV3LmFjdGl2ZSB7DQogICAgcG9zaXRpb246IHJlbGF0aXZlOw0KICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsNCiAgICB6LWluZGV4OiAyMTA7DQp9DQoNCi5tYXAtYm90dG9tLXJpZ2h0IHsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgYm90dG9tOiAwLjRlbTsNCiAgICByaWdodDogMGVtOw0KICAgIHdpZHRoOiBhdXRvOw0KICAgIGhlaWdodDogYXV0bzsNCn0NCg0KLm1hcC1lcnJvciB7DQogICAgcGFkZGluZzogMWVtOw0KfQ0KDQogICAgLm1hcC1lcnJvciBkaXYgew0KICAgICAgICBwYWRkaW5nLWxlZnQ6IDQwcHg7DQogICAgICAgIGJhY2tncm91bmQ6IHVybCgiUmVzb3VyY2VzL0ltYWdlcy9JY29ucy9Ub29sYmFyL3N0b3AtMzIucG5nIikgbm8tcmVwZWF0IHRvcCBsZWZ0Ow0KICAgIH0NCg0KICAgIC5tYXAtZXJyb3IgaDIgew0KICAgICAgICBmb250LXNpemU6IDEuMWVtOw0KICAgIH0NCg0KLk1hcFZpZXcgew0KICAgIGhlaWdodDogMTAwJTsNCn0NCg0KLnZpZXdlci1sb2FkZXItZXJyb3IgLk1hcFZpZXcgew0KICAgIHBhZGRpbmctdG9wOiA1ZW07DQp9DQoNCi5tYXAta2V5Ym9hcmQtZm9jdXMgPiBkaXYgew0KICAgIGJvcmRlcjogbm9uZSAhaW1wb3J0YW50Ow0KfQ0KDQovKlJpcHBsZSBjbGljayBhbmltYXRpb24gaW5zcGlyZWQgYnkgdGhlIEJvcmlzIEFuaW1hdGlvbiBodHRwOi8vdHltcGFudXMubmV0L0RldmVsb3BtZW50L0NsaWNrRWZmZWN0cy8qLw0KDQovKiBSaXBwbGUgQ2xpY2sgYW5pbWF0aW9uIHN0eWxpbmcgKi8NCiNyaXBwbGVDbGlja0VsZW0gew0KICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgICBiYWNrZ3JvdW5kOiAjMUE3MkM0OyAvKiBWaWV3ZXIgYmx1ZSAqLw0KICAgIGJvcmRlci1yYWRpdXM6IDEwMCU7DQogICAgLW1zLXRyYW5zZm9ybTogc2NhbGUoMCk7DQogICAgdHJhbnNmb3JtOiBzY2FsZSgwKTsNCiAgICBvcGFjaXR5OiAwLjc1Ow0KICAgIHotaW5kZXg6MTsNCiAgICBwb2ludGVyLWV2ZW50czogbm9uZTsNCn0NCg0KLypSaXBwbGUgY2xpY2sgYW5pbWF0aW9uIGVmZmVjdCovDQovKiAgYWRkaW5nIHRoZSBhbmltYXRlIGNsYXNzIHRvIGEgcmlwcGxlIGNsaWNrIGVsZW1lbnQgdHJpZ2dlcnMgdGhlIGFuaW1hdGlvbi4gDQogICAgVGhlIGVsZW1lbnQgZ3Jvd3MgaW4gc2l6ZSBhbmQgc2ltdWx0YW5lb3VzbHkgZmFkZXMuDQogICAgSSB1c2UgdGhpcyBpbiBjb21iaW5hdGlvbiB3aXRoIHRoZSBBbmltYXRpb24gRnJhbWV3b3JrIHRvIGNyZWF0ZSBhIHJpcHBsZSBjbGljayAqLw0KI3JpcHBsZUNsaWNrRWxlbS5hbmltYXRlIHsNCiAgICAtd2Via2l0LXRyYW5zaXRpb246IGFsbCAwLjVzIGN1YmljLWJlemllcigwLCAwLCAwLCAxLjAyKTsgDQogICAgdHJhbnNpdGlvbjogYWxsIDAuNXMgY3ViaWMtYmV6aWVyKDAsIDAsIDAsIDEuMDIpOyAvKnRoZSBhbmltYXRpb24gZnVuY3Rpb24qLw0KICAgIG9wYWNpdHk6IDA7DQp9DQoNCkBtZWRpYSBhbGwgYW5kICggbWluLXdpZHRoOiAwcHgpIHsNCiAgICAjcmlwcGxlQ2xpY2tFbGVtLmFuaW1hdGUgew0KICAgICAgICAtbXMtdHJhbnNmb3JtOiBzY2FsZSgwLjE1KTsNCiAgICAgICAgLXdlYmtpdC10cmFuc2Zvcm06IHNjYWxlKDAuMTUpOw0KICAgICAgICB0cmFuc2Zvcm06IHNjYWxlKDAuMTUpOyAvKnRoZSBzaXplIG9mIHRoZSByaXBwbGUqLw0KICAgIH0NCn0NCg0KQG1lZGlhIGFsbCBhbmQgKCBtaW4td2lkdGg6IDUwMHB4KSB7DQogICAgI3JpcHBsZUNsaWNrRWxlbS5hbmltYXRlIHsNCiAgICAgICAgLW1zLXRyYW5zZm9ybTogc2NhbGUoMC4xKTsNCiAgICAgICAgLXdlYmtpdC10cmFuc2Zvcm06IHNjYWxlKDAuMSk7DQogICAgICAgIHRyYW5zZm9ybTogc2NhbGUoMC4xKTsgLyp0aGUgc2l6ZSBvZiB0aGUgcmlwcGxlKi8NCiAgICB9DQp9DQoNCkBtZWRpYSBhbGwgYW5kICggbWluLXdpZHRoOiAxMDAwcHgpIHsNCiAgICAjcmlwcGxlQ2xpY2tFbGVtLmFuaW1hdGUgew0KICAgICAgICAtbXMtdHJhbnNmb3JtOiBzY2FsZSgwLjA3NSk7DQogICAgICAgIC13ZWJraXQtdHJhbnNmb3JtOiBzY2FsZSgwLjA3NSk7DQogICAgICAgIHRyYW5zZm9ybTogc2NhbGUoMC4wNzUpOyAvKnRoZSBzaXplIG9mIHRoZSByaXBwbGUqLw0KICAgIH0NCn0NCg0KQG1lZGlhIGFsbCBhbmQgKCBtaW4td2lkdGg6IDE1MDBweCkgew0KICAgICNyaXBwbGVDbGlja0VsZW0uYW5pbWF0ZSB7DQogICAgICAgIC1tcy10cmFuc2Zvcm06IHNjYWxlKDAuMDUpOw0KICAgICAgICAtd2Via2l0LXRyYW5zZm9ybTogc2NhbGUoMC4wNSk7DQogICAgICAgIHRyYW5zZm9ybTogc2NhbGUoMC4wNSk7IC8qdGhlIHNpemUgb2YgdGhlIHJpcHBsZSovDQogICAgfQ0KfQ0KLyogTWFwIEVsZW1lbnRzIHBvc2l0aW9uaW5nL3NwYWNpbmcsIHJlZ2lvbiBzcGVjaWZpYyAqLw0KLnJlZ2lvbi5tYXAtbmF2aWdhdGlvbi1yZWdpb24gLnZpZXcsDQoucmVnaW9uLmZvb3Rlci1sZWZ0IC52aWV3LA0KLnJlZ2lvbi5tYXAtdG9wLWxlZnQgLnZpZXcsDQoucmVnaW9uLm1hcC1jZW50ZXItbGVmdCAudmlldywNCi5yZWdpb24ubWFwLWJvdHRvbS1sZWZ0IC52aWV3IHsNCiAgICBtYXJnaW46IDAuMzhlbSAwZW0gMC40ZW0gMC40ZW07DQp9DQoNCi5yZWdpb24uZm9vdGVyLWxlZnQgLnZpZXcgew0KICAgIG1hcmdpbi10b3A6IDA7DQogICAgbWFyZ2luLWJvdHRvbTogMDsNCn0NCg0KLnJlZ2lvbi5mb290ZXItcmlnaHQgLnZpZXcsDQoucmVnaW9uLm1hcC10b3AtcmlnaHQgLnZpZXcsDQoucmVnaW9uLm1hcC1jZW50ZXItcmlnaHQgLnZpZXcsDQoucmVnaW9uLm1hcC1ib3R0b20tcmlnaHQgLnZpZXcgew0KICAgIG1hcmdpbjogMC4zOGVtIDAuNGVtIDAuNGVtIDBlbTsNCn0NCg0KLnJlZ2lvbi5tYXAtYm90dG9tLXJpZ2h0IC52aWV3IHsNCiAgICBtYXJnaW4tYm90dG9tOiAwOw0KfQ0KDQoucmVnaW9uLmZvb3Rlci1yaWdodCAudmlldyB7DQogICAgbWFyZ2luLXRvcDogMDsNCiAgICBtYXJnaW4tYm90dG9tOiAwOw0KfQ0KDQoucmVnaW9uLmZvb3Rlci1yZWdpb24gLnZpZXcgYnV0dG9uIHsNCiAgICBib3JkZXI6IDA7DQogICAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7DQp9DQoNCiAgICAucmVnaW9uLmZvb3Rlci1yZWdpb24gLnZpZXcgYnV0dG9uOmhvdmVyIHsNCiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZmZmZjsNCiAgICB9DQoNCi8qI3JlZ2lvbiBNYXAgQ29udGV4dCBNZW51ICovDQoNCi5jb250ZXh0LW1lbnUtcmVnaW9uIC5NYXBDb250ZXh0TWVudVZpZXcgew0KICAgIHdpZHRoOiAxNWVtOw0KfQ0KDQouY29udGV4dC1tZW51LXJlZ2lvbiAuTWFwQ29udGV4dE1lbnVWaWV3IC5saXN0LW1lbnUtZGV0YWlscyB7DQogICAgcGFkZGluZy1sZWZ0OiAwLjVlbTsNCn0NCg0KLmNvbnRleHQtbWVudS1yZWdpb24ub2Zmc2V0LXVwIC5NYXBDb250ZXh0TWVudVZpZXcgew0KICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgICB0b3A6IC00MHB4Ow0KfQ0KDQoubWFwLW1lbnUtcmV2ZXJzZS1nZW9jb2RlIHsNCiAgICAvKiBQcmV2ZW50cyBjbGljayBvbiB0aGUgYWRkcmVzcyBvcGVuaW5nIEdvb2dsZSBNYXBzIGFwcGxpY2F0aW9uIG9uIEFuZHJvaWQgKi8NCiAgICBwb2ludGVyLWV2ZW50czogbm9uZTsNCn0NCg0KLyojZW5kcmVnaW9uICov"),e.resourceManager.register("Mapping","inv","Mapping/modules/Map/CSS/medium.css","css","Lm1hcC10b3AtbGVmdC5tYXAtdG9wLWhpZGRlbiB7DQogICAgdG9wOiAzLjg1ZW07DQp9DQo="),e.resourceManager.register("Mapping","inv","Mapping/modules/Map/CSS/small.css","css","LyogTUFQIChTTUFMTCkgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovDQoubm8tdG91Y2ggLm1hcC1uYXZpZ2F0aW9uLXJlZ2lvbiwNCi5tYXAtbmF2aWdhdGlvbi1yZWdpb24gew0KICAgIG1hcmdpbjogMDsNCiAgICBtYXgtd2lkdGg6IDgwJTsNCn0NCg0KLnZpZXdlci1sb2FkZXItZXJyb3IgLk1hcFZpZXcgew0KICAgIHBhZGRpbmctdG9wOiAwOw0KfQ0KDQovKiBCRUdJTjogVG9wIG1hcCByZWdpb24gKGNvbXBhY3QgdG9vbGJhcikgLSBzbGlkZSB1cCBhbmQgZG93biAqLw0KDQoubWFwLXRvcC1zbGlkZS1kb3duIHsNCiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZTNkKDAsIDAsIDFweCk7DQogICAgYW5pbWF0aW9uOiBtYXAtdG9wLXNsaWRlLWRvd24gMTAwbXMgZm9yd2FyZHM7DQogICAgYW5pbWF0aW9uLWRlbGF5OiA0MDBtczsNCiAgICBhbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOiBlYXNlLWluOw0KfQ0KDQoubWFwLXRvcC1zbGlkZS11cCB7DQogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGUzZCgwLCAwLCAxcHgpOw0KICAgIGFuaW1hdGlvbjogbWFwLXRvcC1zbGlkZS11cCAxMDBtcyBmb3J3YXJkczsNCiAgICBhbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOiBlYXNlLW91dDsNCn0NCg0KQGtleWZyYW1lcyBtYXAtdG9wLXNsaWRlLWRvd24gew0KICBmcm9tIHsNCiAgICB0b3A6IDBlbTsNCiAgfQ0KDQogIHRvIHsNCiAgICB0b3A6IDEuN2VtOw0KICB9DQp9DQoNCkBrZXlmcmFtZXMgbWFwLXRvcC1zbGlkZS11cCB7DQogIGZyb20gew0KICAgIHRvcDogMS43ZW07DQogIH0NCg0KICB0byB7DQogICAgdG9wOiAwZW07DQogIH0NCn0NCi8qIEVORDogVG9wIG1hcCByZWdpb24gKGNvbXBhY3QgdG9vbGJhcikgLSBzbGlkZSB1cCBhbmQgZG93biAqLw=="),e.resourceManager.register("Mapping","inv","Mapping/modules/Map/MapContextMenu/MapContextMenuView.html","html",t),e.resourceManager.register("Mapping","inv","Mapping/modules/Map/MapContextMenu/Views/Coordinates/CoordinatesView.html","html",i),e.resourceManager.register("Mapping","inv","Mapping/modules/Map/MapContextMenu/Views/Menu/MapMenuView.html","html",a),e.resourceManager.register("Mapping","inv","Mapping/modules/Map/MapContextMenu/Views/ReverseGeocode/ReverseGeocodeView.html","html",o),e.resourceManager.register("Mapping","inv","Mapping/modules/Map/MapHostView.html","html",n),e.resourceManager.register("Mapping","inv","Mapping/modules/Map/MapView.html","html",r)}),require({cache:{}}),define(["Mapping/modules/Map/CenterSharingLinkProvider","Mapping/modules/Map/ExtentSharingLinkProvider","Mapping/modules/Map/MapCoordinatesController","Mapping/modules/Map/MapExtentLog","Mapping/modules/Map/MapHostView","Mapping/modules/Map/MapModule","Mapping/modules/Map/MapView","Mapping/modules/Map/MapViewModel","Mapping/modules/Map/ScaleSharingLinkProvider","Mapping/modules/Map/MapContextMenu/MapContextMenuView","Mapping/modules/Map/MapContextMenu/Views/Coordinates/CoordinatesViewModel","Mapping/modules/Map/MapContextMenu/Views/ReverseGeocode/ReverseGeocodeViewModel","Mapping/modules/Map/MapContextMenu/Views/Menu/MapMenuView","Mapping/modules/Map/MapContextMenu/Views/Menu/MapMenuViewModel"],function(t,i,a,o,n,r,s,p,c,l,u,d,h,m){e(t,"geocortex.essentialsHtmlViewer.mapping.modules.map.CenterSharingLinkProvider",t.CenterSharingLinkProvider),e(i,"geocortex.essentialsHtmlViewer.mapping.modules.map.ExtentSharingLinkProvider",i.ExtentSharingLinkProvider),e(a,"geocortex.essentialsHtmlViewer.mapping.modules.map.MapCoordinatesController",a.MapCoordinatesController),e(o,"geocortex.essentialsHtmlViewer.mapping.modules.map.MapExtentLog",o.MapExtentLog),e(n,"geocortex.essentialsHtmlViewer.mapping.modules.map.MapHostView",n.MapHostView),e(r,"geocortex.essentialsHtmlViewer.mapping.modules.map.MapModule",r.MapModule),e(s,"geocortex.essentialsHtmlViewer.mapping.modules.map.MapView",s.MapView),e(p,"geocortex.essentialsHtmlViewer.mapping.modules.map.MapViewModel",p.MapViewModel),e(c,"geocortex.essentialsHtmlViewer.mapping.modules.map.ScaleSharingLinkProvider",c.ScaleSharingLinkProvider),e(l,"geocortex.essentialsHtmlViewer.mapping.modules.map.MapContextMenuView",l.MapContextMenuView),e(u,"geocortex.essentialsHtmlViewer.mapping.modules.map.CoordinatesViewModel",u.CoordinatesViewModel),e(d,"geocortex.essentialsHtmlViewer.mapping.modules.map.ReverseGeocodeViewModel",d.ReverseGeocodeViewModel),e(h,"geocortex.essentialsHtmlViewer.mapping.modules.map.MapMenuView",h.MapMenuView),e(m,"geocortex.essentialsHtmlViewer.mapping.modules.map.MapMenuViewModel",m.MapMenuViewModel)})}();