require({cache:{"geocortex/framework-ui/animation/Animation":function(){define(["require","exports","./AnimationFactory"],function(e,i,r){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.MAX_OPS_PER_FRAME=1e3;var n=null,o=[],a=0;function s(e,t,i){return(n=n||new r.AnimationFactory).create(e,t,i)}function m(){for(var e=a=0,t=o.splice(0,i.MAX_OPS_PER_FRAME);e<t.length;e++)(0,t[e])();o.length&&!a&&setTimeout(function(){a=requestAnimationFrame(m)})}i.getDefault=function(){return n},i.create=s,i.play=function(e,t,i){return s(e,t,i).play(i)},i.scheduleForAnimationFrame=function(e){o.push(e),a=a||requestAnimationFrame(m)}})},"geocortex/framework-ui/animation/AnimationEvent":function(){define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})},"geocortex/framework-ui/animation/AnimationFactory":function(){define(["require","exports","./AnimationSequence","./providers/CssTransitionAnimationProvider"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(o.prototype.create=function(e,t,i){return this._isInitialized||this._init(),new r.AnimationSequence(this.getAnimationProvider(),e,t||[],i)},o.prototype.getAnimationProvider=function(){return this._animationProvider},o.prototype.setAnimationProvider=function(e){this._animationProvider=e},o.prototype._init=function(){this._isInitialized=!0,this._animationProvider||(this._animationProvider=new i.CssTransitionAnimationProvider)},o);function o(e){this._animationProvider=e||null}t.AnimationFactory=n})},"geocortex/framework-ui/animation/AnimationFrameCallback":function(){define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})},"geocortex/framework-ui/animation/AnimationKeyframe":function(){define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reservedKeyframeProperties=["className","duration","isDynamic"]})},"geocortex/framework-ui/animation/AnimationProvider":function(){define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})},"geocortex/framework-ui/animation/AnimationProviderBase":function(){define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(r.prototype.animate=function(e,t,i,r,n){throw new Error("Not implemented")},r);function r(){}t.AnimationProviderBase=i})},"geocortex/framework-ui/animation/AnimationSequence":function(){define(["require","exports","./AnimationState","./Animation"],function(e,i,a,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i._activeAnimations=[];var n=[];function o(){return 0<i._activeAnimations.length}function r(){if(o())return!1;var e=n.slice();n=[];for(var t=0,i=e;t<i.length;t++){var r=i[t];try{r()}catch(e){console.error("Error during animation delegate: "+e)}}return!0}i.isAnimating=o,i.checkAndRunIdle=r,i.runWhenIdle=function(e){n.push(e),setTimeout(function(){return r()},0)};var s=(m.prototype.resets=function(){return this._resets},m.prototype.setResets=function(e){return this._resets=e,this},m.prototype.play=function(e){var t=this;if(e&&(this._frameCallback=e),this._state!==a.AnimationState.Idle)return this._animationPromise.reject(new Error("Animation already in progress."));this._animationPromise=$.Deferred();var i=m.getActiveAnimationForElement(this._element);return i?i._animationPromise.then(function(e){return t._startAnimation()}):this._frames.length?this._startAnimation():this._isDynamic&&!this._frames.length?(this._state=a.AnimationState.Idle,this._animationPromise):void 0},m.prototype.stop=function(){return this._state=a.AnimationState.Stopped,this._complete(!1)},m.prototype.add=function(e){if("string"==typeof e){var t=null,i=e;if(-1<i.indexOf(":")){var r=i.split(":");i=r[0],t=parseInt(r[1],10)}this._frames.push({className:i,duration:t})}else{var n={};for(var o in e)e.hasOwnProperty(o)&&(n[o]=e[o]);this._isDynamic&&(n.isDynamic=!0),this._frames.push(n)}return this._isDynamic&&this._state===a.AnimationState.Idle&&this._tick(),this},m.prototype._startAnimation=function(){var t=this;return i._activeAnimations.push(this),this._state=a.AnimationState.Started,this._frame=-1,setTimeout(function(){t._tick()},0),this._animationPromise.then(function(e){return m.removeAnimationForElement(t._element),e})},m.prototype._tick=function(){if(this._frame>=this._frames.length)return this._isDynamic?void(this._state=a.AnimationState.Idle):void this._complete();this._applyFrame()},m.prototype._complete=function(e){setTimeout(function(){r()},0);var t={state:e?a.AnimationState.Stopped:a.AnimationState.Completed,element:this._element,frame:null};return this._animationPromise.resolve(t)},m.prototype._onFrameEnd=function(){++this._frame,this._state=a.AnimationState.Started,this._tick()},m.prototype._applyFrame=function(){var i=this;t.scheduleForAnimationFrame(function(){var e=-1===i._frame?null:i._frames[i._frame],t=i._frame>=i._frames.length-1?null:i._frames[i._frame+1];!i._isDynamic||t?(i._state=a.AnimationState.FrameBegin,i._frameProvider.animate(i,i._element,e,t,function(t){if(t=t||{state:a.AnimationState.FrameEnd,element:i._element,frame:e},i._frameCallback)try{i._frameCallback(t)}catch(e){return console.error("Error in animation frame callback: "+e),i._animationPromise.reject(t)}if(t){if(t.state===a.AnimationState.Error)return i._animationPromise.reject(t);if(t.state!==a.AnimationState.FrameEnd)throw new Error("Animation provider emitted an event other than an error or a frame.")}i._onFrameEnd()})):i._state=a.AnimationState.Idle})},m.getActiveAnimationForElement=function(t){return i._activeAnimations.filter(function(e){return e._element===t})[0]||null},m.removeAnimationForElement=function(e){for(var t=0;t<i._activeAnimations.length;++t)if(i._activeAnimations[t]._element===e)return i._activeAnimations.splice(t,1),!0;return!1},m);function m(e,t,i,r){var n=this;this._frameProvider=e,this._element=t,this._frame=-1,this._frames=[],this._frameCallback=r,this._state=a.AnimationState.Idle,i&&i.forEach(function(e){return n.add(e)})}i.AnimationSequence=s})},"geocortex/framework-ui/animation/AnimationState":function(){define(["require","exports"],function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),(i=t.AnimationState||(t.AnimationState={}))[i.Idle=0]="Idle",i[i.Started=1]="Started",i[i.FrameBegin=2]="FrameBegin",i[i.FrameEnd=3]="FrameEnd",i[i.Completed=4]="Completed",i[i.Stopped=5]="Stopped",i[i.Error=6]="Error"})},"geocortex/framework-ui/animation/providers/CachedKeyframe":function(){define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})},"geocortex/framework-ui/animation/providers/CssTransitionAnimationProvider":function(){var r,u=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","./../AnimationProviderBase","./../AnimationKeyframe","./../../utils/UiUtils","geocortex/framework/utils/utils"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,s=(a=i.AnimationProviderBase,u(m,a),m.prototype.getKeyframeStyleCount=function(){return this._emittedStylesheet.cssRules.length},m.prototype.animate=function(e,t,i,r,n){var o,a,s,m=n;if(i&&r){if(!i.className){var u=this._getCachedKeyframeData(t,r);i.className=u.emittedClassName}s=t.className.replace(i.className,"").trim()}else s=i?t.className:t.className.replace(/anim-keyframe[-\d\w]+/g,"").trim();r&&(o=r.duration,r.className?-1===t.className.indexOf(r.className)&&(s=s?s+" "+r.className:r.className):(a=this._getCachedKeyframeData(t,r),r.className=a.emittedClassName,-1===t.className.indexOf(r.className)&&(s=s?s+" "+a.emittedClassName:a.emittedClassName),++a.refCount,m=function(){n(),--a.refCount})),r&&$(t).hasClass(r.className)?setTimeout(m,10):(t.className=s.trim().replace(/\s\s+/g," "),a&&a.duration&&(o=a.duration),null==o&&(!r&&i.duration?o=i.duration:r&&(o=this._getKeyframeDuration(t),r.duration=o,a&&(a.duration=r.duration))),r||e.resets()&&(t.className=t.className.replace(i.className,"").trim()),setTimeout(m,null!=o?o:10))},m.prototype._setupPropertyMap=function(){var e,t="-{0}-".format(o.detectBrowserPrefix());if(window.getComputedStyle){var i=window.getComputedStyle(document.body);e=[];for(var r=0;r<i.length;++r)e.push(i[r])}else e=m._animatableProperties;for(["transition","transform"].forEach(function(e){return t+e}),r=0;r<e.length;++r){var n=e[r].replace(t,"").replace(/\-(\w)/g,function(e){return e.toUpperCase().replace("-","")});this._cssPropertyNameMap[n]=e[r]}},m.prototype._setupStylesheet=function(){var e=document.createElement("style");document.getElementsByTagName("head")[0].appendChild(e),this._emittedStylesheet=e.sheet},m.prototype._generateFrameId=function(){return"anim-keyframe-"+n.alphaNumericToken(8)},m.prototype.getCssNameForProperty=function(e){return this._cssPropertyNameMap[e]||e},m.prototype._getHashKey=function(e){var t={};for(var i in e)!e.hasOwnProperty(i)||-1<r.reservedKeyframeProperties.indexOf(i)&&"duration"!==i||(t[i]=e[i]);return String.quickHashCode(JSON.stringify(t))},m.prototype._getCachedKeyframeData=function(e,t){var i="anim-keyframe"+this._getHashKey(t),r=this._cachedKeyframeMap[i];if(r)return++r.count,r;var n=null!=t.duration;t.className=i,t.duration=null!=t.duration?t.duration:this._getKeyframeDuration(e),r={key:i,count:0,refCount:0,emittedClassName:i,frame:t,duration:t.duration,styleBlockIndex:-1},this._cachedKeyframeMap[i]=r,this._cachedKeyframesArray.push(r);var o="."+t.className+" { ";for(var a in t)t.hasOwnProperty(a)&&"className"!==a&&"duration"!==a&&(o+=(this.getCssNameForProperty(a)||a)+": "+t[a]+"; ");return n&&(o+=this.getCssNameForProperty("transitionDuration")+": "+t.duration+"ms !important; "),o+="} ",r.styleBlockIndex=this._emittedStylesheet.insertRule(o,this._emittedStylesheet.cssRules.length),this._emittedStylesheet.cssRules.length>=this._poolSize*this._poolFlushFactor&&(++r.refCount,this.flushKeyframes(),--r.refCount),r},m.prototype.flushKeyframes=function(){this._emittedStylesheet.cssRules.length,this._poolSize,this._poolSizeTarget;for(var e={},t=[],i=[],r=0;r<this._cachedKeyframesArray.length;++r){var n=this._cachedKeyframesArray[r];0===n.refCount?i.push(n):(t.push(n),e[n.key]=n)}i.length,this._swapKeyframeSets(t,e),i.length,this._removeKeyframesFromStylesheets(i)},m.prototype._swapKeyframeSets=function(e,t){for(var i in this._cachedKeyframesArray=e.slice(),this._cachedKeyframeMap={},t)this._cachedKeyframeMap[i]=t[i]},m.prototype._removeKeyframesFromStylesheets=function(e,t){void 0===t&&(t=!0),this._cachedKeyframesArray.length;for(var i=0;i<e.length;++i)this._emittedStylesheet.removeRule(e[i].styleBlockIndex-i);for(i=0;i<this._emittedStylesheet.rules.length;++i){var r=this._emittedStylesheet.rules[i].selectorText.substr(1);this._cachedKeyframeMap[r].styleBlockIndex=i}},m.prototype._getKeyframeDuration=function(e){if(!window.getComputedStyle)return null;var t=window.getComputedStyle(e),i=t.getPropertyValue("transition-duration")||"0",r=t.getPropertyValue("transition-delay")||"0",n=-1<i.indexOf("ms")?parseFloat(i):1e3*parseFloat(i);return(-1<r.indexOf("ms")?parseFloat(r):1e3*parseFloat(r))+n},m.prototype._setPoolOptions=function(e){e.hasOwnProperty("poolSize")&&(this._poolSize=e.poolSize),e.hasOwnProperty("poolFlushFactor")&&(this._poolFlushFactor=e.poolFlushFactor),e.hasOwnProperty("poolSizeTarget")&&(this._poolSizeTarget=e.poolSizeTarget)},m._animatableProperties=["background","background-color","background-position","border-bottom-color","border-bottom-width","border","border-color","border-left-color","border-left-width","border-right-color","border-right-width","border-spacing","border-top-color","border-top-width","bottom","clip","color","crop","font-size","font-weight","height","left","letter-spacing","line-height","margin","margin-bottom","margin-left","margin-right","margin-top","max-height","max-width","min-height","min-width","opacity","outline-color","outline-offset","outline-width","padding","padding-bottom","padding-left","padding-right","padding-top","right","text-indent","text-shadow","transform","transition-duration","transform-origin","top","vertical-align","visibility","width","word-spacing","z-index"],m);function m(){var e=a.call(this)||this;return e._poolSize=1e3,e._poolFlushFactor=.75,e._poolSizeTarget=.5,e._cachedKeyframeMap={},e._cachedKeyframesArray=[],e._cssPropertyNameMap={},e._emittedStylesheet||(e._setupPropertyMap(),e._setupStylesheet()),e}t.CssTransitionAnimationProvider=s})}}});require({cache:{"geocortex/framework-ui/FilterableCollection":function(){var n,s=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});define(["require","exports","geocortex/framework/observables","geocortex/framework/events/CollectionChangedArgs"],function(t,e,r,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=(n=r.ObservableCollection,s(i,n),i.prototype.setSource=function(t){if(t!==this._source){if(this._source&&this._sourceBindingToken){if(this._source.unbind(this._sourceBindingToken),this._sourceBindingToken=null,0<this.length()){var e=new a.CollectionChangedArgs;e.type="clear",e.rangeStart=0,e.rangeEnd=this.length()-1,this.bindingEvent.publish(e)}this._source=null}null!=t&&(this._source=t,this._sourceBindingToken=this._source.bind(this,this._sourceChanged),this._redo())}},i.prototype.getSource=function(){return this._source},i.prototype.setFilter=function(t){(t=t||this._defaultFilter)!==this._filter&&(this._filter=t,this._source&&this._redo())},i.prototype.getFilter=function(){return this._filter===this._defaultFilter?null:this._filter},i.prototype.refresh=function(){this._redo()},i.prototype._redo=function(t){void 0===t&&(t=new a.CollectionChangedArgs),0!=(t.sender=this)._indexMap.length&&(t.type="clear",t.rangeStart=0,t.rangeEnd=this._indexMap.length-1,this.bindingEvent.publish(t));for(var e=this._indexMap.length=0,r=this._source?this._source.length():0;e<r;e++)this._filter(this._source.getAt(e))&&this._indexMap.push(e);0!=this._indexMap.length&&(t.type="append",t.rangeStart=0,t.rangeEnd=this._indexMap.length-1,this.bindingEvent.publish(t))},i.prototype._sourceChanged=function(t){var e,r,n=new a.CollectionChangedArgs;switch(n.sender=this,t.type){case"set":return void this._redo(n);case"append":for(n.type="append",n.rangeStart=this._indexMap.length,e=t.rangeStart;e<=t.rangeEnd;e++)this._filter(this._source.getAt(e))&&this._indexMap.push(e);n.rangeEnd=this._indexMap.length-1;break;case"insert":for(r=0<t.rangeStart?this._findIndexMapIx(t.rangeStart):0;r<this._indexMap.length&&this._indexMap[r]<t.rangeStart;)r++;for(n.type=r<this._indexMap.length?"insert":"append",n.rangeStart=r,e=t.rangeStart;e<=t.rangeEnd;e++)this._filter(this._source.getAt(e))&&this._indexMap.splice(r++,0,e);n.rangeEnd=r-1;for(var o=t.rangeEnd-t.rangeStart+1;r<this._indexMap.length;r++)this._indexMap[r]+=o;break;case"remove":for(r=0<t.rangeStart?this._findIndexMapIx(t.rangeStart):0;r<this._indexMap.length&&this._indexMap[r]<t.rangeStart;)r++;for(n.rangeStart=r;r<this._indexMap.length&&this._indexMap[r]<=t.rangeEnd;)r++;n.rangeEnd=r-1,n.type=0==n.rangeStart&&n.rangeEnd==this._indexMap.length-1?"clear":"remove";break;case"clear":if(0==this.length())return;n.type="clear",n.rangeStart=0,n.rangeEnd=this._indexMap.length;break;default:throw new Error("Unhandled case: "+t.type)}switch(n.rangeStart<=n.rangeEnd&&this.bindingEvent.publish(n),n.type){case"remove":this._indexMap.splice(n.rangeStart,n.rangeEnd-n.rangeStart+1);var i=t.rangeEnd-t.rangeStart+1;for(r=t.rangeStart;r<this._indexMap.length;r++)this._indexMap[r]-=i;break;case"clear":this._indexMap.length=0}},i.prototype._findIndexMapIx=function(t){for(var e=0,r=this._indexMap.length-1,n=0;e<=r;)if(n=Math.floor((e+r)/2),this._indexMap[n]>t)r=n-1;else{if(!(this._indexMap[n]<t))return n;e=n+1}return n},i.prototype._defaultFilter=function(t){return!0},i.prototype.isEmpty=function(){return 0==this._indexMap.length},i.prototype.length=function(){return this._indexMap.length},i.prototype.contains=function(t){return this._source&&this._filter(t)&&this._source.contains(t)},i.prototype.getAt=function(t){return this._source?this._source.getAt(this._indexMap[t]):null},i.prototype.getRange=function(t,e){(null==e||e>=this._indexMap.length)&&(e=this._indexMap.length-1);for(var r=new Array(e-t+1),n=t;n<=e;n++)r[n-t]=this.getAt(n);return r},i.prototype.indexOf=function(t){if(!this._source||!this._filter(t))return-1;var e=this._source.indexOf(t);return-1==e?-1:this._findIndexMapIx(e)},i.prototype.get=function(){throw new Error("Raw array manipulation not supported")},i.prototype.getItems=function(){throw new Error("Raw array manipulation not supported")},i.prototype.getLength=function(){return this._indexMap.length},i.prototype.addItems=function(t){throw new Error("Operation not supported")},i.prototype.addItem=function(t){throw new Error("Operation not supported")},i.prototype.insertItems=function(t,e){throw new Error("Operation not supported")},i.prototype.insertItem=function(t,e){throw new Error("Operation not supported")},i.prototype.removeItem=function(t){throw new Error("Operation not supported")},i.prototype.removeAt=function(t){throw new Error("Operation not supported")},i.prototype.removeRange=function(t,e){throw new Error("Operation not supported")},i.prototype.clear=function(){throw new Error("Operation not supported")},i.prototype.set=function(t){throw new Error("Operation not supported")},i.prototype.sync=function(t){throw new Error("Operation not supported")},i.prototype.equals=function(t){throw new Error("Operation not supported")},i);function i(t,e){var r=n.call(this)||this;return r._source=null,r._sourceBindingToken=null,r._filter=r._defaultFilter,r._indexMap=[],t&&r.setSource(t),e&&r.setFilter(e),r}e.FilterableCollection=o})}}});require({cache:{"geocortex/framework-ui/LazyObservable":function(){define(["require","exports","geocortex/framework/LazyObservable"],function(e,r,a){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.LazyObservable=a.LazyObservable})}}});!function(){var i="<div class='multi-region-view' data-binding='{@var: multiRegionViewElement}{@source: regionDescriptors}'>    <div data-binding='{@template-for: regionDescriptors}{class: regionCss}'>        <div class='region-view-switcher' data-binding='{@visible: displayRegionViewSwitcher}{@widget: RegionViewSwitcherWidget}{@widget-context: viewSwitcherViewModel}{@widget-required: false}'></div>        <div class='region' data-binding='{data-region-name: regionName}{data-region-adapter: regionType}'></div>    </div></div>";require({cache:{"geocortex/framework-ui/MultiRegion/MultiRegionView":function(){var r,s=this&&this.__extends||(r=function(e,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var t in i)i.hasOwnProperty(t)&&(e[t]=i[t])})(e,i)},function(e,i){function t(){this.constructor=e}r(e,i),e.prototype=null===i?Object.create(i):(t.prototype=i.prototype,new t)});define(["require","exports","geocortex/framework/ui/ViewBase"],function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o,r=(o=t.ViewBase,s(n,o),n.prototype.attach=function(e){o.prototype.attach.call(this,e),this._wireUpEventSubscriptions()},n.prototype.resolveWidget=function(e,i,t){if(o.prototype.resolveWidget.call(this,e,i,t),"RegionViewSwitcherWidget"!==e)return null;if(!i)return null;var r=this.app.viewManager.createView({markupResource:this.viewModel.regionViewSwitcherWidgetMarkup,typeName:this.viewModel.regionViewSwitcherWidgetType,libraryId:this.viewModel.regionViewSwitcherLibraryId});return r&&r.attach(i),r},n.prototype._wireUpEventSubscriptions=function(){this.app.event("RegionActivatedEvent").subscribe(this,this._handleRegionActivatedEvent),this.app.event("RegionDeactivatedEvent").subscribe(this,this._handleRegionDeactivatedEvent)},n.prototype._handleRegionActivatedEvent=function(e){var i=this.viewModel.getRegionDescriptorByRegionName(e.name.toString());i&&(i.regionActive.set(!0),this.regionName&&!this.isActive&&this.app.viewManager.activateView(this))},n.prototype._handleRegionDeactivatedEvent=function(e){var i=this.viewModel.getRegionDescriptorByRegionName(e.name.toString());i&&(i.regionActive.set(!1),dojo.some(this.viewModel.regionDescriptors.get(),function(e){return!0===e.regionActive.get()})||this.regionName&&this.isActive&&this.app.viewManager.deactivateView(this))},n);function n(){return null!==o&&o.apply(this,arguments)||this}i.MultiRegionView=r})},"geocortex/framework-ui/MultiRegion/MultiRegionViewModel":function(){var r,g=this&&this.__extends||(r=function(e,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var t in i)i.hasOwnProperty(t)&&(e[t]=i[t])})(e,i)},function(e,i){function t(){this.constructor=e}r(e,i),e.prototype=null===i?Object.create(i):(t.prototype=i.prototype,new t)});define(["require","exports","geocortex/framework/ui/ViewModelBase","geocortex/framework/observables","./RegionDescriptor","./../ViewSwitcher/ViewSwitcherViewModel"],function(e,i,t,r,o,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s,c=(s=t.ViewModelBase,g(a,s),a.prototype.initialize=function(e){var i=this;e&&e.regions&&dojo.isArray(e.regions)?(this.autoInsertViewSwitcher=!!e.autoInsertViewSwitcher,e.regions.forEach(function(e){return e.regionName&&i.regionDescriptors.addItem(i.createDescriptorForRegion(e.regionName,e.regionType,e.regionCss))}),this._processRegionDescriptors()):this.app.trace.error("MultiRegionViewModel: Region configuration not found or invalid region configuration syntax.")},a.prototype.getRegionDescriptorByRegionName=function(e){for(var i=0;i<this.regionDescriptors.length();i++){var t=this.regionDescriptors.getAt(i);if(t.regionName===e)return t}return null},a.prototype.supportsViewSwitcher=function(e){return this.autoInsertViewSwitcher&&-1<this.supportedViewSwitcherRegionAdapters.indexOf(e.regionType)},a.prototype.createDescriptorForRegion=function(e,i,t){return new o.RegionDescriptor(e,i,t)},a.prototype.createViewSwitcherViewModel=function(e){return new n.ViewSwitcherViewModel(this.app,this.libraryId,e)},a.prototype.processRegion=function(e){e&&this.supportsViewSwitcher(e)&&(e.viewSwitcherViewModel.set(this.createViewSwitcherViewModel(e.regionName)),e.displayRegionViewSwitcher.sync(e.viewSwitcherViewModel.get().viewSwitcherActive))},a.prototype._processRegionDescriptors=function(){var i=this;this.regionDescriptors.get().forEach(function(e){return i.processRegion(e)})},a);function a(){var e=null!==s&&s.apply(this,arguments)||this;return e.regionDescriptors=new r.ObservableCollection([]),e.autoInsertViewSwitcher=!1,e.regionViewSwitcherWidgetMarkup="Framework.UI/geocortex/framework/ui/ViewSwitcher/ViewSwitcherView.html",e.regionViewSwitcherWidgetType="geocortex.framework.ui.ViewSwitcher.ViewSwitcherView",e.regionViewSwitcherLibraryId="Framework.UI",e.supportedViewSwitcherRegionAdapters=["geocortex.framework.ui.MultiDivRegionAdapter","geocortex.framework.ui.MultiViewRegionAdapter"],e}i.MultiRegionViewModel=c})},"geocortex/framework-ui/MultiRegion/RegionDescriptor":function(){define(["require","exports","geocortex/framework/observables"],function(e,i,r){"use strict";Object.defineProperty(i,"__esModule",{value:!0});function t(e,i,t){if(this.regionActive=new r.Observable(!1),this.displayRegionViewSwitcher=new r.Observable(!1),this.viewSwitcherViewModel=new r.Observable(null),this.DEFAULT_REGION_TYPE="geocortex.framework.ui.MultiDivRegionAdapter",this.DEFAULT_CSS_CLASS="region-container",!e)throw new Error("RegionDescriptor Error: Cannot create region descriptor. Region name not defined.");this.regionName=e,this.regionType=i||this.DEFAULT_REGION_TYPE,this.regionCss=this.DEFAULT_CSS_CLASS+(t?" "+t.trim():"")}i.RegionDescriptor=t})},"url:/Framework.UI/geocortex/framework/ui/MultiRegion/MultiRegionView.html":i}}),require(["geocortex/framework/resourceManager"],function(e){e.resourceManager.register("Framework.UI","inv","Framework.UI/geocortex/framework/ui/MultiRegion/MultiRegionView.html","html",i)})}();require({cache:{"geocortex/framework-ui/ObservableCollectionAggregator":function(){var o,s=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});define(["require","exports","geocortex/framework/observables","geocortex/framework/events/CollectionChangedArgs"],function(t,e,n,l){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o,r=(o=n.ObservableCollection,s(i,o),i.prototype.setCollectionsSource=function(t){if(t!==this._collections){if(null!=this._collections){if(this._collections.unbind(this._collectionsBindingToken),this._collectionsBindingToken=null,0<this._collections.length()){var e=new l.CollectionChangedArgs;e.type="clear",e.rangeStart=0,e.rangeEnd=this.length()-1,this.collectionsChanged(e)}this._collections=null}if(null!=t){this._collections=t,this._collectionsBindingToken=this._collections.bind(this,this.collectionsChanged);var n=new l.CollectionChangedArgs;n.rangeStart=0,n.rangeEnd=this._collections.length()-1,n.type="append",this.collectionsChanged(n)}}},i.prototype.getCollectionSource=function(){return this._collections},i.prototype.collectionsChanged=function(t){this.fixBindings(t),this.propagateEvents(t)},i.prototype.fixBindings=function(t){if("append"===t.type||"insert"===t.type)for(var e=t.rangeStart;e<=t.rangeEnd;e++)this._collectionsMembersBindingTokens.splice(e,0,this._collections.getAt(e).bindingEvent.subscribe(this,this.underlyingCollectionChanged));else{if("remove"!==t.type&&"clear"!==t.type)throw"replace"===t.type?new Error("The original value is lost and we need to unbind from it"):new Error("Unknown argument type");for(e=t.rangeStart;e<=t.rangeEnd;e++)this._collections.getAt(e).bindingEvent.unsubscribe(this._collectionsMembersBindingTokens[e]),this._collectionsMembersBindingTokens[e]=null;this._collectionsMembersBindingTokens.splice(t.rangeStart,t.rangeEnd-t.rangeStart+1)}},i.prototype.propagateEvents=function(t){var e=this._collections.length(),n=new l.CollectionChangedArgs;n.type=t.type,n.rangeStart=0;for(var o=n.rangeEnd=0;o<e&&o<t.rangeStart;o++)n.rangeStart+=this._collections.getAt(o).length();for(n.rangeEnd=n.rangeStart-1;o<e&&o<=t.rangeEnd;o++)n.rangeEnd+=this._collections.getAt(o).length();n.rangeEnd>=n.rangeStart&&(n.sender=this).bindingEvent.publish(n)},i.prototype.underlyingCollectionChanged=function(t){var e=new l.CollectionChangedArgs;e.sender=this,e.type=t.type;for(var n=0,o=this._collections.length(),r=0;r<o;r++){var i=this._collections.getAt(r);if(i===t.sender){"append"===t.type&&r!==o-1?e.type="insert":"clear"===t.type&&1!==o&&(e.type="remove"),e.rangeStart=n+t.rangeStart,e.rangeEnd=n+t.rangeEnd;break}n+=i.length()}this.bindingEvent.publish(e)},i.prototype.isEmpty=function(){if(null==this._collections)return!0;for(var t=this._collections.length(),e=0;e<t;e++)if(!this._collections.getAt(e).isEmpty())return!1;return!0},i.prototype.length=function(){if(null==this._collections)return 0;for(var t=0,e=this._collections.length(),n=0;n<e;n++)t+=this._collections.getAt(n).length();return t},i.prototype.contains=function(t){if(null==this._collections)return!1;for(var e=this._collections.length(),n=0;n<e;n++)if(this._collections.getAt(n).contains(t))return!0;return!1},i.prototype.getAt=function(t){if(null==this._collections)return null;for(var e=this._collections.length(),n=0;n<e;n++){var o=this._collections.getAt(n),r=o.length();if(!(r<=t))return o.getAt(t);t-=r}throw new Error("Index out of bounds")},i.prototype.getRange=function(t,e){if(null==this._collections)return[];void 0===e&&(e=Number.POSITIVE_INFINITY);for(var n=null,o=0,r=this._collections.length(),i=0;i<r&&0<=e;i++,t-=o,e-=o){var l=this._collections.getAt(i);if(t<(o=l.length())){var s=l.getRange(0<t?t:0,e);n=null==n?s:n.concat(s)}}return n},i.prototype.indexOf=function(t){if(null==this._collections)return-1;for(var e=0,n=this._collections.length(),o=0;o<n;o++){var r=this._collections.getAt(o),i=r.indexOf(t);if(-1!==i)return e+i;e+=r.length()}return-1},i.prototype.get=function(){throw new Error("Raw array manipulation not supported")},i.prototype.getItems=function(){throw new Error("Raw array manipulation not supported")},i.prototype.getLength=function(){return this.length()},i.prototype.addItems=function(t){throw new Error("Operation not supported")},i.prototype.addItem=function(t){throw new Error("Operation not supported")},i.prototype.insertItems=function(t,e){throw new Error("Operation not supported")},i.prototype.insertItem=function(t,e){throw new Error("Operation not supported")},i.prototype.removeItem=function(t){throw new Error("Operation not supported")},i.prototype.removeAt=function(t){throw new Error("Operation not supported")},i.prototype.removeRange=function(t,e){throw new Error("Operation not supported")},i.prototype.clear=function(){throw new Error("Operation not supported")},i.prototype.set=function(t){throw new Error("Operation not supported")},i.prototype.sync=function(t){throw new Error("Operation not supported")},i.prototype.equals=function(t){throw new Error("Operation not supported")},i);function i(t){var e=o.call(this)||this;return e._collectionsBindingToken=null,e._collectionsMembersBindingTokens=[],t&&e.setCollectionsSource(t),e}e.ObservableCollectionAggregator=r})}}});require({cache:{"geocortex/framework-ui/OrderedCollection":function(){var n,c=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});define(["require","exports","geocortex/framework/observables","geocortex/framework/events/CollectionChangedArgs"],function(t,e,r,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o,s=(o=r.ObservableCollection,c(i,o),i.prototype.setSortFunction=function(t){if(this._sorter!==t){var e=this.length();if(t){var r=new n.CollectionChangedArgs;r.type="clear",r.rangeStart=0,r.rangeEnd=e-1,(r.sender=this).bindingEvent.publish(r)}(this._sorter=t)&&(o.prototype.get.call(this).sort(this._sorter),(r=new n.CollectionChangedArgs).type="append",r.rangeStart=0,r.rangeEnd=e-1,(r.sender=this).bindingEvent.publish(r))}},i.prototype.getSortFunction=function(){return this._sorter},i.prototype.addItems=function(t){if(this._sorter)if(0===this.length())o.prototype.addItems.call(this,t.concat().sort(this._sorter));else for(var e=0;e<t.length;e++)this.addItem(t[e]);else o.prototype.addItems.call(this,t)},i.prototype.addItem=function(t){if(this._sorter){for(var e=0,r=o.prototype.length.call(this);e<r&&this._sorter(o.prototype.getAt.call(this,e),t)<0;e++);r<=e?o.prototype.addItem.call(this,t):o.prototype.insertItem.call(this,e,t)}else o.prototype.addItem.call(this,t)},i.prototype.set=function(t){this._sorter?o.prototype.set.call(this,t.concat().sort(this._sorter)):o.prototype.set.call(this,t)},i.prototype.sync=function(t){this._unsortedSyncToken&&this._unsortedSyncSource&&(this._unsortedSyncSource.bindingEvent.unsubscribe(this._unsortedSyncToken),this._unsortedSyncSource=null,this._unsortedSyncToken=null),t&&t.bindingEvent&&(this.clear(),this.addItems(t.getRange(0,t.length()-1)),this._unsortedSyncSource=t,this._unsortedSyncToken=t.bindingEvent.subscribe(this,this._onSyncedCollectionChanged))},i.prototype._onSyncedCollectionChanged=function(t){switch(t.type){case"set":this.set(t.sender.getRange(t.rangeStart,t.rangeEnd));break;case"append":case"insert":this.addItems(t.sender.getRange(t.rangeStart,t.rangeEnd));break;case"remove":for(var e=t.rangeStart;e<=t.rangeEnd;e++)this.removeItem(t.sender.getAt(e));break;case"clear":this.clear();break;default:throw new Error("Unhandled case: "+t.type)}},i.prototype.insertItems=function(t,e){throw new Error("Direct insertion is not supported")},i.prototype.insertItem=function(t,e){throw new Error("Direct insertion is not supported")},i);function i(t,e){var r=o.call(this,t)||this;return r._sorter=null,e&&r.setSortFunction(e),r}e.OrderedCollection=s})}}});require({cache:{"geocortex/framework-ui/PresentableCollection":function(){var r,a=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});define(["require","exports","geocortex/framework/observables","geocortex/framework/FrameworkObject"],function(t,e,r,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var h=function(t,e,i){this.pageNumber=new r.Observable(t||null),this.isActive=new r.Observable(e||!1),this.cssClass=new r.Observable(i||"pc-page-shortcut")};e.PresentableCollectionPageShortcut=h;var n,s=(n=i.FrameworkObject,a(u,n),u.prototype.nextPage=function(){this.currPageNumber.set(this.currPageNumber.get()+1)},u.prototype.prevPage=function(){this.currPageNumber.set(this.currPageNumber.get()-1)},u.prototype.getAt=function(t){return this._itemCollection.getAt(t)},u.prototype.getLength=function(){return this._itemCollection.getLength()},u.prototype.destroy=function(){n.prototype.destroy.call(this),this.cleanUp()},u.prototype.cleanUp=function(){this._itemCollection&&this._itemCollection.clear(),this.items&&this.items.clear(),this._underlyingCollection&&(this._underlyingCollection.unbind(this._underlyingCollectionBindingToken),this._underlyingCollection=null,this._underlyingCollectionBindingToken=null)},u.prototype.attachToCollection=function(t){if(this.cleanUp(),!t)throw new Error("Could not attach to collection.");this._attachToUnderlyingCollection(t)},u.prototype._attachToUnderlyingCollection=function(t){this._underlyingCollection=t,this._underlyingCollectionBindingToken=this._underlyingCollection.bind(this,this._handleUnderlyingCollectionChanges),this._itemCollection.set(t.getRange(0));var e=this._itemCollection.getLength();this.numberOfItems.set(e),this.currIndexStart.set(0),this.currIndexEnd.set(this.pageSize.get()),this.currPageNumber.set(1),e<this.currIndexEnd.get()&&(this.currIndexEnd.set(e),this._prevIndexEnd=e),this._bindEntirePage(),this._maintainPageRanges()},u.prototype._bindEntirePage=function(){this._calculatePageWindow(),this.items.clear();for(var t=[],e=this.currIndexStart.get(),i=this.currIndexEnd.get(),r=e;r<i;++r){var n=this._itemCollection.getAt(r);t.push(n)}this.items.addItems(t),this._prevIndexStart=e,this._prevIndexEnd=this._prevIndexEnd},u.prototype._enableOrDisablePagination=function(t){t?(this.currIndexStart.set(this.currPageNumber.get()*this._prevPageSize),this.pageSize.set(this._prevPageSize),this._calculatePageWindow(),this._bindEntirePage(),this._maintainPageRanges()):(this.currIndexStart.set(0),this._prevPageSize=this.pageSize.get(),this.pageSize.set(Number.MAX_VALUE),this.pageShortcuts.clear(),this._calculatePageWindow(),this._bindEntirePage())},u.prototype._calculatePageWindow=function(){var t=this._itemCollection.length();this.lastPageNumber.set(Math.ceil(t/this.pageSize.get()));var e=this.currIndexStart.get(),i=this.currIndexEnd.get(),r=this.pageSize.get(),n=0,s=0,a=0;return t<i&&(i=t),this.currIndexStart.set(e<0?0:e),this.currIndexEnd.set(Math.min(this._itemCollection.getLength(),this.currIndexEnd.get())),n=this.currIndexStart.get()-this._prevIndexStart,t<=e&&(s=n=0,a=~~((e-t+1)/r+1),a*=-1,n=Math.max(0,a*r)),i-e<r&&i<=t&&(s=Math.min(r,t)-(i-e)),0!==a&&(s=n=0),{pageShift:a,startShift:n,endShift:s}},u.prototype._handlePageChange=function(t){this.isPaginated.get()?(this.pageSize.value=Math.max(0,Number(this.pageSize.get())),this.currPageNumber.value=Math.max(1,Number(this.currPageNumber.get())),isNaN(this.pageSize.get())||this.pageSize.get()<1||(this.currPageNumber.get()>this.lastPageNumber.get()&&0<this.lastPageNumber.get()?this.currPageNumber.set(this.lastPageNumber.get()):(this.currIndexStart.set((this.currPageNumber.get()-1)*this.pageSize.get()),this.currIndexEnd.set(Math.min(this._itemCollection.getLength(),this.currIndexStart.get()+this.pageSize.get())),this._prevIndexStart=this.currIndexStart.get(),this._prevIndexEnd=this.currIndexEnd.get(),this._maintainPageRanges(),this._bindEntirePage()))):t!==Number.MAX_VALUE&&(this._prevPageSize=t,this.pageSize.set(Number.MAX_VALUE))},u.prototype._maintainPageRanges=function(){var t=Math.ceil(this._itemCollection.getLength()/this.pageSize.get());this.lastPageNumber.set(t),1<t&&!this.isMultiplePages.get()?this.isMultiplePages.set(!0):t<=1&&this.isMultiplePages.get()&&this.isMultiplePages.set(!1),this.firstPageNumber.set(1);var e=this.numPageShortcuts.get(),i=Math.max(0,this.currPageNumber.get()-e/2),r=e/2-(this.currPageNumber.get()-i),n=Math.min(t,this.currPageNumber.get()+e/2+r);n-i<this.numPageShortcuts.get()&&(i-=this.numPageShortcuts.get()-(n-i))<0&&(i=0),this.pageShortcuts.clear();for(var s=[],a=i;a<n;++a)s.push(new h(a+1,!1));this.pageShortcuts.addItems(s),this._highlightCorrectPageShortcut()},u.prototype._highlightCorrectPageShortcut=function(){for(var t=0;t<this.pageShortcuts.getLength();++t){var e=this.pageShortcuts.getAt(t);e.pageNumber.get()===this.currPageNumber.get()?e.cssClass.set("pc-page-shortcut pc-shortcut-active"):e.cssClass.set("pc-page-shortcut")}},u.prototype._performWindowRecalc=function(t){if(0!==t.pageShift)this.currIndexStart.set((this.currPageNumber.get()-1)*this.pageSize.get()),this.currIndexEnd.set(this.currIndexStart.get()+this.pageSize.get()),this.currIndexStart.set(Math.max(0,this.currIndexStart.get())),this.currIndexEnd.set(Math.min(this._itemCollection.getLength(),this.currIndexEnd.get())),this._bindEntirePage();else{if(t.startShift<0){var e=Math.max(0,this._prevIndexStart+t.startShift),i=this._itemCollection.getRange(e,this._prevIndexStart-1);this.items.insertItems(0,i)}else 0<t.startShift&&this.items.removeRange(0,t.startShift-1);if(t.endShift<0)this.items.removeRange(this.items.getLength()+t.endShift,this.items.getLength());else if(0<t.endShift){var r=Math.min(this._itemCollection.getLength(),this.currIndexEnd.get()+t.endShift);i=this._itemCollection.getRange(this.currIndexEnd.get(),r-1),this.items.addItems(i)}this.currIndexStart.set(this.currIndexStart.get()+t.startShift),this.currIndexEnd.set(this.currIndexEnd.get()+t.endShift<=this._itemCollection.getLength()?this.currIndexEnd.get()+t.endShift:this._itemCollection.getLength()),this.currIndexStart.get()<0&&(this.currIndexEnd.set(Math.min(this.items.length(),this.currIndexEnd.get()-this.currIndexStart.get())),this.currIndexStart.set(0))}this._prevIndexStart=this.currIndexStart.get(),this._prevIndexEnd=this.currIndexEnd.get()},u.prototype._handleUnderlyingCollectionChanges=function(t){if(t&&"clear"!==t.type){if("replace"===t.type)this.items.clear(),this._itemCollection.clear(),this._itemCollection.addItems(this._underlyingCollection.getRange(0)),this._calculatePageWindow(),this._bindEntirePage();else if("insert"===t.type){if(!this.isSorted.get()){var e=this._underlyingCollection.getRange(t.rangeStart,t.rangeEnd);this._itemCollection.insertItems(t.rangeStart,e);var i=u.getIntersectType(this.currIndexStart.get(),this.currIndexEnd.get(),t.rangeStart,t.rangeEnd);if(i===u.RANGE_RELATION_BEFORE||i===u.RANGE_RELATION_HEAD){var r=t.rangeEnd-t.rangeStart+1;this._prevIndexStart+=r,this._prevIndexEnd+=r,this._performWindowRecalc({pageShift:0,startShift:-r,endShift:Math.min(-r+Math.max(this.pageSize.get()-this.numberOfItems.get(),0),0)})}else if(i===u.RANGE_RELATION_CONTAINED)this._performWindowRecalc({pageShift:0,startShift:0,endShift:Math.min(-(t.rangeEnd-t.rangeStart+1)+Math.max(this.pageSize.get()-this.numberOfItems.get(),0),0)}),this.items.insertItems(t.rangeStart-this.currIndexStart.get(),e),this.currIndexEnd.get()<this.items.length()&&this.currIndexEnd.set(this.items.length());else if(i===u.RANGE_RELATION_TAIL){this.items.removeRange(t.rangeStart-this.currIndexStart.get(),this.items.getLength());var n=this.currIndexStart.get()+this.pageSize.get(),s=Math.min(n,t.rangeEnd);this._performWindowRecalc({pageShift:0,startShift:0,endShift:s-this.currIndexEnd.get()}),t.rangeStart+e.length>n&&(e=e.slice(0,n-t.rangeStart)),this.items.insertItems(t.rangeStart-this.currIndexStart.get(),e),this.currIndexEnd.get()<this.items.length()&&this.currIndexEnd.set(this.items.length())}else if(i===u.RANGE_RELATION_AFTER){var a=this.currIndexEnd.get()-this.currIndexStart.get();a<this.pageSize.get()&&this.items.addItems(e.slice(0,this.pageSize.get()-a))}else this._bindEntirePage()}}else if("append"===t.type)if(this.isSorted.get())for(var h=t.rangeStart;h<=t.rangeEnd;++h){var g=this._underlyingCollection.getAt(h),o=this.getSortedPosition(g);this._itemCollection.insertItem(o,g),o<=this.currIndexStart.get()?(this.items.removeRange(this.items.getLength()-1),this.items.insertItem(0,this._itemCollection.getAt(this.currIndexStart.get()))):o>this.currIndexStart.get()&&o<=this.currIndexEnd.get()&&(this.items.removeRange(this.items.getLength()-1),this.items.insertItem(o-this.currIndexStart.get(),g))}else this._itemCollection.addItems(this._underlyingCollection.getRange(t.rangeStart,t.rangeEnd)),this._performWindowRecalc(this._calculatePageWindow());else if("remove"===t.type)if(0<t.rangeEnd-t.rangeStart){if(this.isSorted.get())for(h=t.rangeStart;h<=t.rangeEnd;++h){var l=this.getSortedPosition(this._underlyingCollection.getAt(h));this._itemCollection.removeRange(l,l)}else this._itemCollection.removeRange(t.rangeStart,t.rangeEnd);this._bindEntirePage()}else if(l=-1,l=this.isSorted.get()?this.getSortedPosition(this._underlyingCollection.getAt(t.rangeStart)):t.rangeStart,this._itemCollection.removeRange(l,l),l<this.currIndexStart.get())this.currIndexEnd.set(this.currIndexEnd.get()-1),this._performWindowRecalc({pageShift:0,startShift:1,endShift:1}),this.currIndexEnd.set(this.currIndexEnd.get()+1);else if(l>=this.currIndexStart.get()&&l<this.currIndexEnd.get()){var c=l-this.currIndexStart.get();this.items.removeRange(c,c),this.currIndexEnd.set(this.currIndexEnd.get()-1),this.currIndexEnd.get()!==this._itemCollection.getLength()&&this._performWindowRecalc({pageShift:0,startShift:0,endShift:1})}}else this.items.clear(),this._itemCollection.clear(),this._calculatePageWindow();this.numberOfItems.set(this._itemCollection.getLength()),this._maintainPageRanges()},u.prototype.sortCollection=function(){var t=this._itemCollection.get();this.sortMethod(t,this.sortingPredicate||null),this._bindEntirePage()},u.prototype.unsortCollection=function(){this._itemCollection.set(this._underlyingCollection.getRange(0)),this._bindEntirePage()},u.prototype.getSortedPosition=function(t){if(!1===this.isSorted.get())return this._itemCollection.getLength();for(var e=this._itemCollection.get(),i=(this._itemCollection.getLength(),0),r=e.length-1,n=~~((r-i)/2);n<r&&i<n;){var s=e[n],a=this.sortingPredicate(t,s);if(0===this.sortingPredicate(t,e[r]))return r;if(0===this.sortingPredicate(t,e[i]))return i;if(0<a)i=n;else{if(!(a<0))return n;r=n}n=~~((r-i)/2)+i}return n},u.prototype.defaultNativeSort=function(t,e){return null==e?t.sort():t.sort(e)},u.getIntersectType=function(t,e,i,r){return t===i&&e===r?u.RANGE_RELATION_SAME:i<t&&r<=t?u.RANGE_RELATION_BEFORE:i<=t&&r<e?u.RANGE_RELATION_HEAD:i<t&&e<r?u.RANGE_RELATION_CONTAINS:t<i&&r<e?u.RANGE_RELATION_CONTAINED:i<=e&&e<r?u.RANGE_RELATION_TAIL:e<i?u.RANGE_RELATION_AFTER:u.RANGE_RELATION_SAME},u.RANGE_RELATION_SAME=0,u.RANGE_RELATION_BEFORE=1,u.RANGE_RELATION_HEAD=2,u.RANGE_RELATION_TAIL=3,u.RANGE_RELATION_AFTER=4,u.RANGE_RELATION_CONTAINS=5,u.RANGE_RELATION_CONTAINED=6,u);function u(t){var e=n.call(this,null,null)||this;return e.items=new r.ObservableCollection,e.isSorted=new r.Observable(!1),e.isFiltered=new r.Observable(!1),e.isPaginated=new r.Observable(!0),e.isMultiplePages=new r.Observable(!0),e.numberOfItems=new r.Observable(0),e.currIndexStart=new r.Observable(0),e.currIndexStartFromOne=new r.Observable(1),e.currIndexEnd=new r.Observable(0),e.currPageNumber=new r.Observable(1),e.prevPageNumber=new r.Observable,e.nextPageNumber=new r.Observable,e.firstPageNumber=new r.Observable(1),e.lastPageNumber=new r.Observable(1),e.pageSize=new r.Observable(5),e.pageShortcuts=new r.ObservableCollection,e.numPageShortcuts=new r.Observable(10),e._itemCollection=new r.ObservableCollection,e.sortMethod=null,e.sortingPredicate=null,e.filterPredicate=null,e._prevIndexStart=e.currIndexStart.get(),e._prevIndexEnd=e.currIndexEnd.get(),e._prevPageNum=0,e._prevPageSize=e.pageSize.get(),e.sortMethod=e.defaultNativeSort,e.sortingPredicate=function(t,e){return t===e?0:e<t?1:-1},t&&e.attachToCollection(t),e.auto(e.isSorted,e,function(t){t?this.sortCollection():this.unsortCollection()}),e.currIndexStartFromOne.syncTransform(e.currIndexStart,function(t){return t+1}),e.auto(e.isPaginated,e,e._enableOrDisablePagination),e.auto(e.currPageNumber,e,e._handlePageChange),e.auto(e.pageSize,e,e._handlePageChange),e}e.PresentableCollection=s})}}});!function(){var t="<li class='selector-item single-select'>    <div data-binding='{@event-onclick: handleClickItem}{@event-touchstart: handleClickItem}'>        <input class='selector-checkbox' data-binding='{id: id}{checked: isSelected}' type='checkbox' />        <label data-binding='{@text: displayName}{for: id}'></label>    </div></li>",i="<div class='fui-selector' data-binding='{@class-expanded: openState}'>    <div class='fui-selector-header' data-binding='{@visible: showSelectorHeader}{@noclass-no-selector-items: items}'>        <button data-binding='{@event-onclick: handleClickSelector}{@visible: items}'><span data-binding='{@text: selectorText}'></span></button>        <span data-binding='{@hidden: items}{@text: noItemsText}'></span>    </div>    <div data-binding='{@visible: openState}'>        <ul class='fui-selector-body' data-binding='{@hidden:showNativeSelect}{@source: items}{@class-expanded: openState}{@var: customSelect}'>            <li class='fui-selector-item' data-binding='{@template-for: items}{@widget: SelectorItemWidget}{@widget-context: @context}{@widget-replace: true}' />        </ul>        <select class='fui-selector-body' data-binding='{@class-expanded: openState}{@visible: showNativeSelect}{@var: selectElement}{@source: items}{@value: _selectedItems}            {@event-onchange: handleSelectionChange}{aria-label: @language-framework-ui-selector-view-label}'>            <option data-binding='{@template-for: items}{@event-onclick: handleClickItem}{@text: displayName}{@attach:@context}'></option>        </select>    </div></div>";require({cache:{"geocortex/framework-ui/Selector/SelectorItemViewModel":function(){define(["require","exports","geocortex/framework/observables","geocortex/framework/utils/utils"],function(e,t,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(l.prototype.getId=function(){return this.id.get()},l);function l(e,t,i){this.id=new o.Observable,this.id.set(n.alphaNumericToken()),this.displayName=new o.Observable(null==e?"":e),this.isSelected=new o.Observable(!!i),this.item=t||null}t.SelectorItemViewModel=i})},"geocortex/framework-ui/Selector/SelectorView":function(){var o,s=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewBase"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,n=(o=i.ViewBase,s(l,o),l.prototype.attach=function(e){var n=this;o.prototype.attach.call(this,e),this.viewModel.singleSelect||dojo.attr(this.selectElement,"multiple","multiple"),e.openState.bind(this,function(e){if(e){var t={view:n,onOtherInteracted:function(e){return n.viewModel.openState.set(!1)}};n.app.command("TapToDismiss").execute(t),n.viewModel.openState.get()&&!n.viewModel.showNativeSelect.get()&&n.positionCustomSelect()}}),e.items.bind(this,function(e){if(-1<["remove"].indexOf(e.type))for(var t=e.rangeStart;t<=e.rangeEnd;++t)for(var i=n._itemViews.length;i--;){var o=n._itemViews[i];o&&o.viewModel==e.sender.getAt(t)&&(n.app.viewManager.destroyView(o),n._itemViews.splice(i,1))}})},l.prototype.handleSelectionChange=function(e,t,i){for(var o=this,n=t,l=[],s=0;s<n.options.length;++s)l.push(n.options[s]);return l.filter(function(e){return e.selected&&null==e.attributes["data-is-dummy"]}).length<1?this.viewModel.unselectAll():setTimeout(function(){var e=o.viewModel.items.get(),t=o.viewModel.getSelectedItems();e.map(function(e){-1<t.indexOf(e)?o.viewModel.selectItem(e.item,e):o.viewModel.unselectItem(e.item,e)}),o.viewModel.singleSelect&&o.viewModel.toggleOpenState()}),!0},l.prototype.handleClickItem=function(e,t,i){return i===this.viewModel.dummyItem?(this.viewModel.unselectAll(),void this.viewModel.toggleOpenState()):(this.viewModel.handleSelectionChange(null,i),this.viewModel.singleSelect&&this.viewModel.toggleOpenState(),!0)},l.prototype.handleClickSelector=function(e,t,i){return this.viewModel.toggleOpenState(),!0},l.prototype.positionCustomSelect=function(){var e=this.customSelect;e.style.top="auto",e.style.left="auto",e.style.opacity="0",this.app.viewManager.activateView(this);var t=document.body.clientWidth,i=document.body.clientHeight,o=e.getBoundingClientRect();o.left+o.width>t&&(e.style.left=-1*o.width+"px"),o.top+o.height>i&&(e.style.top=-1*o.height+"px"),e.style.opacity="1"},l.prototype.resolveWidget=function(e,t,i){if("SelectorItemWidget"===e){var o=this.viewModel.templatePath||"Framework.UI/geocortex/framework/ui/Selector/DefaultItemTemplate.html",n=this.viewModel.templateLibraryId||this.libraryId,l=this.viewModel.templateTypeName||"geocortex.framework.ui.ViewBase",s=this.app.viewManager.createView({typeName:l,markupResource:o,isVisible:!0,libraryId:n});return s.parentView=this,s.attach(t),this._itemViews.push(s),s}},l);function l(){var e=null!==o&&o.apply(this,arguments)||this;return e._itemViews=[],e}t.SelectorView=n})},"geocortex/framework-ui/Selector/SelectorViewModel":function(){var o,a=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewModelBase","geocortex/framework/observables","./SelectorItemViewModel"],function(e,t,i,l,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=(r=i.ViewModelBase,a(n,r),n.prototype.toggleOpenState=function(){this.showNativeSelect.get()&&this.singleSelect||this.openState.set(!this.openState.get())},n.prototype.setCollection=function(e,t,i,o,n){this.syncToken&&(this._underlyingCollection.unbind(this.syncToken),this.syncToken=null),this.displayNameField=t,this.templatePath=i,this.templateLibraryId=o,this.templateTypeName=n,this.showSelectorHeader.set(!this.showNativeSelect.get()||!this.singleSelect),this._underlyingCollection=e,this.syncToken=this._underlyingCollection.bind(this,this.handleUnderlyingCollectionChange),this.clear(),this.items.addItems(this._adapt(this._underlyingCollection.get()))},n.prototype.clear=function(){this.items.clear(),this.dummyItemText&&(this.dummyItem.displayName.set(this.dummyItemText),this.items.addItem(this.dummyItem))},n.prototype._adapt=function(e){var i=this,o=[];return e.forEach(function(e){var t=new s.SelectorItemViewModel;e[i.displayNameField].isObservable?t.displayName.set(e[i.displayNameField].get()):t.displayName.set(e[i.displayNameField]),t.item=e,o.push(t)}),o},n.prototype.handleUnderlyingCollectionChange=function(e){var t;switch(e.type){case"append":t=this._adapt(this._underlyingCollection.getRange(e.rangeStart,e.rangeEnd)),this.items.addItems(t);break;case"insert":t=this._adapt(this._underlyingCollection.getRange(e.rangeStart,e.rangeEnd)),this.items.insertItems(e.rangeStart,t);break;case"remove":this.items.removeRange(e.rangeStart,e.rangeEnd);break;case"clear":this.clear();break;case"set":t=this._adapt(this._underlyingCollection.getRange(e.rangeStart,e.rangeEnd)),this.clear(),this.items.addItems(t)}},n.prototype.getViewModelForItem=function(e){for(var t=0;t<this.items.getLength();++t)if(this.items.getAt(t).item===e)return this.items.getAt(t);return null},n.prototype.getViewModelForSelectedItem=function(e){for(var t=0;t<this._selectedItems.getLength();++t)if(this._selectedItems.getAt(t).item===e)return this._selectedItems.getAt(t);return null},n.prototype.getSelectedItems=function(){return this._selectedItems.get().slice()},n.prototype.hasItemViewModelFor=function(e){return!!this.getViewModelForItem(e)},n.prototype.selectItem=function(e,t){this._setItemSelectedState(e,t,!0)},n.prototype.unselectItem=function(e,t){this._setItemSelectedState(e,t,!1)},n.prototype.onSelectItem=function(e){},n.prototype.onUnselectItem=function(e){},n.prototype.handleSelectionChange=function(e,t){!0===e?this.selectItem(null,t):t.isSelected.get()?this.unselectItem(null,t):this.selectItem(null,t)},n.prototype.unselectAll=function(t){var i=this;this._selectedItems.get().forEach(function(e){"string"!=typeof e&&!0===e.isSelected.get()&&(t&&t===e||i.unselectItem(null,e))}),this.openState.get()&&!this.singleSelect&&this.openState.set(!1)},n.prototype._setItemSelectedState=function(e,t,i){if(!(t=t||this.getViewModelForItem(e)))throw new Error("Tried to select an item in a Framework UI selector but item was not part of bound collection.");this.singleSelect&&i&&this.unselectAll(t),t.isSelected.get()!==i&&(t.isSelected.set(i),i?this._selectedItems.addItem(t):this._selectedItems.removeItem(t),i&&this.onSelectItem?this.onSelectItem(t):!i&&this.onUnselectItem&&this.onUnselectItem(t))},n);function n(e,t,i,o){void 0===i&&(i=!0),void 0===o&&(o=!0);var n=r.call(this,e,t)||this;return n.displayNameField="displayName",n.dummyItemText=null,n.templatePath=null,n.templateLibraryId=null,n.templateTypeName=null,n.mobileMode=!0,n.singleSelect=i,n._selectedItems=new l.ObservableCollection,n.showSelectorHeader=new l.Observable(!1),n.showNativeSelect=new l.Observable(o),n.selectorText=new l.Observable(""),n.noItemsText=new l.Observable(""),n.openState=new l.Observable(n.showNativeSelect.get()&&i),n.items=new l.ObservableCollection,n.selectedItems=new l.ObservableCollection,n.dummyItem=new s.SelectorItemViewModel,n}t.SelectorViewModel=o})},"url:/Framework.UI/geocortex/framework/ui/Selector/DefaultItemTemplate.html":t,"url:/Framework.UI/geocortex/framework/ui/Selector/SelectorView.html":i}}),require(["geocortex/framework/resourceManager"],function(e){e.resourceManager.register("Framework.UI","inv","Framework.UI/geocortex/framework/ui/Selector/DefaultItemTemplate.html","html",t),e.resourceManager.register("Framework.UI","inv","Framework.UI/geocortex/framework/ui/Selector/SelectorView.html","html",i)})}();!function(){var i="<div class='splash-screen'></div>";require({cache:{"geocortex/framework-ui/SplashScreen/SplashScreenView":function(){var n,o=this&&this.__extends||(n=function(e,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var t in i)i.hasOwnProperty(t)&&(e[t]=i[t])})(e,i)},function(e,i){function t(){this.constructor=e}n(e,i),e.prototype=null===i?Object.create(i):(t.prototype=i.prototype,new t)});define(["require","exports","geocortex/framework/ui/ViewBase"],function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n,r=(n=t.ViewBase,o(a,n),a.prototype.removeSplash=function(){var e=this;this.app.viewManager.deactivateView(this),this.app.command("HideSplashScreen").clear(),this._siteInitializedToken&&this.app.event("SiteInitializedEvent").unsubscribe(this._siteInitializedToken),this._siteInitializedFailedToken&&this.app.event("SiteInitializationFailedEvent").unsubscribe(this._siteInitializedFailedToken),setTimeout(function(){e.app.viewManager.destroyView(e)},250)},a);function a(e,i){var t=n.call(this,e,i)||this;return t._siteInitializedToken=null,t._siteInitializedFailedToken=null,t.app.command("HideSplashScreen").register(t,function(){this.removeSplash()}),t.app.site&&t.app.site.isInitialized?t.removeSplash():(t._siteInitializedToken=t.app.event("SiteInitializingEvent").once(t,function(){setTimeout(function(){t.removeSplash()},0)}),t._siteInitializedFailedToken=t.app.event("SiteInitializationFailedEvent").subscribe(t,function(){setTimeout(function(){t.removeSplash()},0)}),t._siteInitializedFailedToken=t.app.event("UserSignInCancelledEvent").subscribe(t,function(){setTimeout(function(){t.removeSplash()},0)})),t}i.SplashScreenView=r})},"url:/Framework.UI/geocortex/framework/ui/SplashScreen/SplashScreenView.html":i}}),require(["geocortex/framework/resourceManager"],function(e){e.resourceManager.register("Framework.UI","inv","Framework.UI/geocortex/framework/ui/SplashScreen/SplashScreenView.html","html",i)})}();require({cache:{"geocortex/framework-ui/StringLocalizer":function(){define(["require","exports"],function(e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.localizeObservables=function e(i,r,n){if(r)if(i.allLibrariesLoaded)for(var t=0;t<n.length;t++){var s=n[t].get();s&&9<s.length&&"@language"==s.substring(0,9)&&n[t].set(i.getResource(r,s.substring(1)))}else i.event("ViewerLibrariesDownloadedEvent").once(this,function(){e(i,r,n)})},i.localizeString=function e(i,r,n,t){if(r&&n&&t)if(i.allLibrariesLoaded)n&&9<n.length&&"@language"==n.substring(0,9)?t(i.getResource(r,n.substring(1))):t(n);else var s=i.event("ViewerLibrariesDownloadedEvent").subscribe(this,function(){i.event("ViewerLibrariesDownloadedEvent").unsubscribe(s),e(i,r,n,t)})}})}}});require({cache:{"geocortex/framework-ui/utils/UiUtils":function(){define(["require","exports"],function(e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n=null,t="tapToDismiss",i="focusToDismiss";function u(e){return"mousedown."+e+" touchstart."+e}function f(e){return""+t+e.id}function r(e){return"focusin."+e}function s(e){return""+i+e.id}o.detectBrowserPrefix=function(e){if(!e&&null!==n)return n;var o=e?e.toLowerCase():navigator.userAgent.toLowerCase(),t=/opera/.exec(o)||/(msie|trident)/.exec(o)||/firefox/.exec(o)||/(chrome|safari|webkit)/.exec(o),i=t&&{opera:"O",chrome:"webkit",safari:"webkit",webkit:"webkit",firefox:"Moz",msie:"ms",trident:"ms"}[t[0]]||"";return e||(n=i),i},o.focusToDismissThis=function(o,t,i){if(o){var e=r(s(o));$(document.body).off(e),$(document.body).on(e,function(e){i&&i(e)||function(e,o,t){var i=s(o);$(document.body).off(r(i)),t&&t(e)}(e,o,t)})}},o.tapToDismissThis=function(o,t,i){if(o){var e=u(f(o));$(document.body).off(e),$(document.body).on(e,function(e){return function(e,o,t,i){var n=!1,r=f(o);o.root===e.target?n=!0:$(e.target).parents().each(function(e){this===o.root&&(n=!0)}),n?t?i&&i(e):o.app.viewManager.deactivateView(o):($(document.body).off(u(r)),t&&t(e))}(e,o,t,i)})}},o.disableTapToDismiss=function(e){if(e){var o=f(e);$(document.body).off(u(o))}},o.disableFocusToDismiss=function(e){if(e){var o=s(e);$(document.body).off(r(o))}}})}}});require({cache:{"geocortex/framework-ui/version":function(){var r,e,o;e=r=r||{},((o=e.framework||(e.framework={})).ui||(o.ui={})).version="2.0.0"}}});!function(){var t="<div class='button-tab-strip' data-binding='{@var: buttonTabStripElement}'>    <div data-binding='{@source: activeViewDescriptors}'>        <button data-binding='{@template-for: activeViewDescriptors}{@event-onclick: handleClickTab}{className: cssClass}{title: title}'>            <img class='tab-strip-icon' data-binding='{src: iconUri}{@visible: iconUri}' alt=' ' />            <p class='tab-strip-label' data-binding='{@visible: title}{@text: title}'></p>        </button>    </div></div>",i="<div class='view-container-view' data-binding='{@var: containerElement}'>    <div class='panel-header' data-binding='{@visible: headerIsVisible}{@var: headerElement}'>        <div data-binding='{@visible: titleBarIsVisible}'>            <button class='panel-header-button right close-16' data-binding='{@visible: showingXButton}{@event-onclick: handleClickClose}{title: closeTitle}'></button>            <button class='panel-header-button left back-16' data-binding='{@visible: showingBackButton}{@event-click: handleClickBack}{title: backTitle}'></button>            <h2 class='panel-title'>                <img src='Resources/Images/loader-small.gif' data-binding='{@visible: showBusyIndicator}' alt=' ' />                <span data-binding='{@text: containerTitle}{@visible: containerTitle}'></span>                <span data-binding='{@visible: containerTitle}'>&nbsp;-&nbsp;</span>                <span data-binding='{@text: viewTitle}{@visible: viewTitle}'></span>            </h2>        </div>        <div data-binding='{@dom: headerInsertDomElement}'></div>    </div>    <div class='panel-scroll-container' data-binding='{data-region-name: regionName}{data-region-adapter: regionType}{@var: scrollRegionElement}{@event-onscroll: handleScrollChange}'></div>    <div class='panel-footer' data-binding='{@var: footerElement}{@visible: footerInsertDomElement}' style='position: absolute'>        <div class='panel-footer-inner' data-binding='{@dom: footerInsertDomElement}'></div>    </div></div>";require({cache:{"geocortex/framework-ui/ViewContainer/ButtonTabStripView":function(){var r,s=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewBase"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=i.ViewBase,s(o,r),o.prototype.attach=function(e){var i=this;r.prototype.attach.call(this,e),this.app.event("DataFrameOpenedEvent").subscribe(this,function(){return i._yield(function(){return i._updateLabels()})}),this.app.event("PanelResizeEndEvent").subscribe(this,function(){return i._yield(function(){return i._updateLabels()})}),this.viewModel.activeViewDescriptors.bind(this,function(e){var t=i.viewModel.activeViewDescriptors.getLength();"remove"===e.type?t-=e.rangeEnd-e.rangeStart+1:"clear"===e.type&&(t=0),i._updateLabels(t)})},o.prototype.handleClickTab=function(e,t,i){var r=i.view;r&&this.app.viewManager.activateView(r)},o.prototype._updateLabels=function(e){e=e||this.viewModel.activeViewDescriptors.getLength();var t=$(this.buttonTabStripElement);75<t.width()/e?t.removeClass("no-label"):t.addClass("no-label")},o.prototype._yield=function(e){return setTimeout(e,0)},o);function o(){return null!==r&&r.apply(this,arguments)||this}t.ButtonTabStripView=n})},"geocortex/framework-ui/ViewContainer/ViewContainerView":function(){var r,c=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewBase","geocortex/framework/observables","./ViewContainerViewClosedEventArgs"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,s=(o=i.ViewBase,c(a,o),a.prototype.attach=function(e){var t=this;o.prototype.attach.call(this,e),this.title.sync(this.viewModel.viewTitle),this.headerInsertDomElement.sync(this.viewModel.headerInsertDomElement),this.footerInsertDomElement.sync(this.viewModel.footerInsertDomElement),this.viewModel.headerIsVisible.bind(this,function(e){return t.delayedResize()}),this.delayedResize()},a.prototype.resize=function(){if(this.headerElement&&this.scrollRegionElement&&this.containerElement){var e=$(this.scrollRegionElement),t=$(this.headerElement),i=$(this.footerElement),r=t.length&&"none"!==t.css("display")?t.outerHeight():0,n=i.length&&"none"!==i.css("display")?i.outerHeight():0;"relative"!==e.css("position")&&e.css("top",r+"px"),e.css("bottom",n+"px")}},a.prototype.delayedResize=function(){var e=this;setTimeout(function(){e.resize()},1)},a.prototype.getZerothView=function(){for(var e=0;e<this.viewModel.viewDescriptors.getLength();++e){var t=this.viewModel.viewDescriptors.getAt(e);if(0===this.viewModel.getViewPriority(t.view.id))return t.view}return null},a.prototype.activated=function(){var i=this;if(o.prototype.activated.call(this),!this._active&&this.viewModel&&!this._activatingForViewInContainer){this._activatingForViewInContainer=!1,this._active=!0;var e=this.getZerothView();if(e)e.isActive||(this.app.viewManager.activateView(e),this._active=!0);else{if(this.app.allLibrariesLoaded&&!this.app.isShuttingDown){var t=this.viewModel.getZerothViewId();t&&this.app.awaitModuleForView(t)}var r=this.viewModel.viewDescriptors.bind(this,function(e){var t=e.sender.getAt(0);t&&0===i.viewModel.getViewPriority(t.view.id)&&(t.view.isActive||i.app.viewManager.activateView(t.view),i.viewModel.viewDescriptors.unbind(r))})}}this.viewModel&&this.viewModel.showOrHideCloseButtons(),this.viewModel&&this.viewModel.closeOnEscape&&(this._keyDownEventToken=dojo.connect(document,"keydown",this,this._documentKeyDown)),this.app.event("ViewContainerActivatedEvent").publish(this),this.delayedResize()},a.prototype.deactivated=function(){o.prototype.deactivated.call(this),this._activatingForViewInContainer=!1,this._keyDownEventToken&&(dojo.disconnect(this._keyDownEventToken),this._keyDownEventToken=null),this.app.event("ViewContainerDeactivatedEvent").publish(this)},a.prototype.activateContainer=function(){this._active=!0,this.regionName&&!this.isActive&&this.app.viewManager.activateView(this)},a.prototype.deactivateContainer=function(){this._active=!1,this.app.viewManager.deactivateView(this)},a.prototype.handleScrollChange=function(e,t,i){i.getDescriptorForActiveView(i.currentView).scrollTop=t.scrollTop},a.prototype.handleRegionActivatedEvent=function(e){this.viewModel&&e.name===this.viewModel.regionName.get()&&this.activateContainer()},a.prototype.handleRegionDeactivatedEvent=function(e){this.viewModel&&e.name===this.viewModel.regionName.get()&&this.deactivateContainer()},a.prototype.handleClickBack=function(e,t,i){if(i.currentView){var r=i.currentView;this._closeCurrentView(i),this._broadcastClosedEvent(r,!1,!0)}},a.prototype.handleClickClose=function(e,t,i){if(i.currentView){var r=i.currentView;this._closeCurrentView(i),this._broadcastClosedEvent(r,!0,!1)}},a.prototype.handleClickTab=function(e,t,i){var r=i.view;r&&this.app.command("ActivateView").execute(r.id)},a.prototype.handleClickCloseTab=function(e,t,i){var r=i.view;r&&this.app.viewManager.destroyView(r)},a.prototype._documentKeyDown=function(e){if(27===e.keyCode&&this.viewModel){var t=this.viewModel.currentView;this._closeCurrentView(this.viewModel),this._broadcastClosedEvent(t,!0,!1)}},a.prototype._handleViewActivatedInContainerEvent=function(e){var t,i=this;if(this._activatingForViewInContainer=!1,this.viewModel&&(t=this.viewModel.getDescriptorForActiveView(e))){this._activatingForViewInContainer=!0,this.regionName&&this.app.viewManager.activateView(this);var r=void 0===t.scrollTop?0:t.scrollTop;"FeatureDetailsView"!==t.view.id&&"FeatureDetailsCompactView"!==t.view.id&&"EditorView"!==t.view.id&&setTimeout(function(){dojo.style(i.scrollRegionElement,"scrollTop",r),i.scrollRegionElement.scrollTop=r},0),this.delayedResize()}},a.prototype._closeCurrentView=function(e){e.closeCurrentView()},a.prototype._broadcastClosedEvent=function(e,t,i){var r=new n.ViewContainerViewClosedEventArgs(this.id,e.id,t,i);this.app.event("ViewContainerViewClosedEvent").publish(r)},a);function a(e,t){var i=o.call(this,e,t)||this;return i._hasDiscoveredRegions=!1,i._active=!1,i._keyDownEventToken=null,i._activatingForViewInContainer=!1,i.headerInsertDomElement=new r.Observable(null),i.footerInsertDomElement=new r.Observable(null),i.scrollContainerTop=new r.Observable(0),i.scrollContainerBottom=new r.Observable(0),i.app.event("ViewActivatedInContainerEvent").subscribe(i,i._handleViewActivatedInContainerEvent),i.app.event("RegionActivatedEvent").subscribe(i,i.handleRegionActivatedEvent),i.app.event("RegionDeactivatedEvent").subscribe(i,i.handleRegionDeactivatedEvent),i.app.event("ViewDimensionsChangedEvent").subscribe(i,i.resize),i.app.event("SiteInitializingEvent").once(i,i.delayedResize),i}t.ViewContainerView=s})},"geocortex/framework-ui/ViewContainer/ViewContainerViewClosedEventArgs":function(){define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function i(e,t,i,r){this.containerViewId=e,this.viewId=t,this.xButtonClicked=i,this.backButtonClicked=r}t.ViewContainerViewClosedEventArgs=i})},"geocortex/framework-ui/ViewContainer/ViewContainerViewModel":function(){var r,w=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewModelBase","geocortex/framework/observables","./ViewDescriptor","./ViewContainerView","geocortex/framework/utils/ArrayUtils"],function(e,t,i,a,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c,s=(c=i.ViewModelBase,w(l,c),l.prototype.initialize=function(o){var s=this;this.regionName.set(o.containerRegionName),this.regionType.set(o.containerRegionType||"geocortex.framework.ui.MultiDivRegionAdapter"),this.containerTitle.set(o.containerTitle||null),this.containerManagedTitle.set(o.containerManagedTitle||null),this.defaultViewIconUri=o.defaultViewIcon||null,this.containerTitle.get()&&this.viewTitle.sync(this.containerTitle),null!==o.headerIsVisible&&void 0!==o.headerIsVisible?this._originalHeaderIsVisibleSetting=!!o.headerIsVisible:this._originalHeaderIsVisibleSetting=!0,this._showHeaderForStandaloneViews=!!o.showHeaderForStandaloneViews,this.headerIsVisible.set(this._originalHeaderIsVisibleSetting),this.showHostedViews.set(!!o.showHostedViews),this._ordering=o.ordering||{},this._backButtonOnRootView=o.backButtonOnRootView,this._showBackButtonAsX=o.showBackButtonAsX,this.closeOnEscape=!!o.closeOnEscape,this._viewDescriptorConstructor=o.viewDescriptor||null;var a=function(t,e){if(o["{0}InsertMarkup".format(t)])try{var i={markupResource:o["{0}InsertMarkup".format(t)],typeName:o["{0}InsertType".format(t)],libraryId:s.libraryId};if(o["{0}InsertLibraryId".format(t)]){if(!s.app.allLibrariesLoaded){var r=s.app.event("ViewerLibrariesDownloadedEvent").subscribe(s,function(){s.app.event("ViewerLibrariesDownloadedEvent").unsubscribe(r),a(t,e)});return}i.libraryId=o["{0}InsertLibraryId".format(t)]}else i.libraryId="Framework.UI";var n=s.app.viewManager.createView(i);n.attach(s),s._insertedViews.push(n),e.set(n.root)}catch(e){s.app.trace.error("Could not create view {0} container insert: {1}".format(t,e.toString()))}};a("header",this.headerInsertDomElement),a("footer",this.footerInsertDomElement)},l.prototype.createDescriptorForView=function(e){if(this._viewDescriptorConstructor){var t=dojo.getObject(this._viewDescriptorConstructor);if(t)return new t(e,this);this.app.trace.error("Couldn't find viewDescriptor type: "+this._viewDescriptorConstructor),this._viewDescriptorConstructor=null}return new r.ViewDescriptor(e,this)},l.prototype.getDescriptorForView=function(e){for(var t=0;t<this.viewDescriptors.getLength();++t){var i=this.viewDescriptors.getAt(t);if(i.view===e)return i}return null},l.prototype.getDescriptorForActiveView=function(e){for(var t=0;t<this.activeViewDescriptors.getLength();++t){var i=this.activeViewDescriptors.getAt(t);if(i.view===e)return i}return null},l.prototype.handleViewHosted=function(e){if((!this.managedViewsOnly||e.view.isManaged)&&e.region.name===this.regionName.get()){var t=this.getDescriptorForView(e.view);t||(t=this.createDescriptorForView(e.view),this._addOrderedView(t),this.showHostedViews.get()&&(this.getDescriptorForActiveView(e.view)||this.insertActiveViewDescriptor(t)))}},l.prototype.handleViewUnhosted=function(e){if(e.region.name===this.regionName.get()){var t=this.getDescriptorForView(e.view);t&&(this.viewDescriptors.removeItem(t),this.showHostedViews.get()||this.activeViewDescriptors.removeItem(t))}},l.prototype.handleViewActivatedEvent=function(e){if(!this.managedViewsOnly||e.isManaged){var t=this.app.viewManager.getRegionForViewId(e.id);if(t&&t.name===this.regionName.get()){var i=this.getDescriptorForView(e);i||(i=this.createDescriptorForView(e),this._addOrderedView(i)),this._activeViews[e.id]=!0,this.app.trace.debug("--- Activated view {0}".format(e.id)),this.activateViewInContainer(e)}}},l.prototype.handleViewDeactivatedEvent=function(e){var t=this.app.viewManager.getRegionForViewId(e.id);if(t&&t.name===this.regionName.get()){this._activeViews[e.id]=!1;var i=this.getDescriptorForView(e);i&&!this.showHostedViews.get()&&this.activeViewDescriptors.removeItem(i),this.app.trace.debug("--- Deactivated view {0}".format(e.id)),this.deactivateViewInContainer(e)}},l.prototype.activateViewInContainer=function(e){this.deactivateViews(),this.currentView=e;var t=this.getDescriptorForView(e);t?(t.isActive.set(!0),t.cssClass.set("tab-active")):e.isManaged&&((t=this.createDescriptorForView(e)).isActive.set(!0),t.cssClass.set("tab-active"),this._addOrderedView(t)),this.getDescriptorForActiveView(e)||this.insertActiveViewDescriptor(t),this.app.event("ViewActivatedInContainerEvent").publish(e),!this._showHeaderForStandaloneViews||e instanceof n.ViewContainerView?this.headerIsVisible.set(this._originalHeaderIsVisibleSetting):this.headerIsVisible.set(!0),this.showOrHideCloseButtons(),this.containerTitle.get()||this.viewTitle.sync(e.title),this.backTitle.set(this.app.getResource(this.libraryId,"language-framework-ui-view-container-view-back").format(this.viewTitle.get())),this.closeTitle.set(this.app.getResource(this.libraryId,"language-framework-ui-view-container-view-close").format(this.viewTitle.get())),this.showBusyIndicator.sync(e.isBusy)},l.prototype.showOrHideCloseButtons=function(){var e=this.viewDescriptors.getAt(0);e&&(this.currentView===e.view?this._backButtonOnRootView?(this.showingXButton.set(this._showBackButtonAsX),this.showingBackButton.set(!this._showBackButtonAsX)):(this.showingBackButton.set(!1),this.showingXButton.set(!1)):this.currentView&&this.currentView.hasOwnProperty("configuration")&&(this.currentView.configuration.hasOwnProperty("showXButton")||this.currentView.configuration.hasOwnProperty("showBackButton"))?this.currentView.configuration.hasOwnProperty("showXButton")?(this.showingXButton.set(!!this.currentView.configuration.showXButton),this.showingBackButton.set(!1)):(this.showingBackButton.set(!!this.currentView.configuration.showBackButton),this.showingXButton.set(!1)):(this.showingXButton.set(this._showBackButtonAsX),this.showingBackButton.set(!this._showBackButtonAsX)))},l.prototype.deactivateViewInContainer=function(e){var t=this.getDescriptorForView(e);t&&(t.isActive.set(!1),t.cssClass.set("tab-inactive"),this.showHostedViews.get()||this.activeViewDescriptors.removeItem(t)),this.showOrHideCloseButtons()},l.prototype.closeCurrentView=function(){var e=this.getDescriptorForView(this.currentView);e&&!this.showHostedViews.get()&&this.activeViewDescriptors.removeItem(e),this.deactivateCurrentView()},l.prototype.deactivateCurrentView=function(){this.currentView&&this.app.viewManager.deactivateView(this.currentView)},l.prototype.deactivateViews=function(){for(var e=0;e<this.viewDescriptors.getLength();++e){var t=this.viewDescriptors.getAt(e);t.isActive.set(!1),t.cssClass.set("tab-inactive")}},l.prototype.getViewPriority=function(e){return this._ordering.hasOwnProperty(e)?parseInt(this._ordering[e].toString(),10):null},l.prototype.getZerothViewId=function(){var t=this;return o.firstOrDefault(Object.keys(this._ordering),function(e){return 0===t._ordering[e]})},l.prototype._addOrderedView=function(e){var t=e.view,i=this.getDescriptorForActiveView(t);if(!this._ordering)return this.viewDescriptors.addItem(e),void(t.isActive&&!i&&this.insertActiveViewDescriptor(e));var r=t.id;if(!r)return this.viewDescriptors.addItem(e),void(t.isActive&&!i&&this.insertActiveViewDescriptor(e));var n=this.getViewPriority(r);if(null==(e.priority=n))return e.priority=this.activeViewDescriptors.getLength()+1,this.viewDescriptors.addItem(e),void(t.isActive&&!i&&this.insertActiveViewDescriptor(e));for(var o=!1,s=0;s<this.viewDescriptors.getLength();++s){var a=this.viewDescriptors.getAt(s).view,c=this.getViewPriority(a.id);if(null===c||n<=c){o=!0,this.viewDescriptors.insertItem(s,e);break}}o||this.viewDescriptors.addItem(e),t.isActive&&this.insertActiveViewDescriptor(e)},l.prototype.insertActiveViewDescriptor=function(e){for(var t=0;t<this.activeViewDescriptors.getLength();++t){var i=this.activeViewDescriptors.getAt(t);if(e.priority<i.priority)return void this.activeViewDescriptors.insertItem(t,e)}this.activeViewDescriptors.addItem(e)},l.prototype.dispose=function(){for(var e=this._insertedViews.length-1;0<=e;e--){var t=this._insertedViews[e];this.app.viewManager.destroyView(t)}this._insertedViews.length=0},l);function l(e,t){var i=c.call(this,e,t)||this;i.regionName=new a.Observable(""),i.regionType=new a.Observable(null),i.headerIsVisible=new a.Observable(!0),i.titleBarIsVisible=new a.Observable(!0),i.hasCustomHeaderComponent=new a.Observable(!1),i.hasCustomFooterComponent=new a.Observable(!1),i.showingBackButton=new a.Observable(!0),i.showBusyIndicator=new a.Observable(!1),i.showHostedViews=new a.Observable(!1),i.showingXButton=new a.Observable(!0),i.containerTitle=new a.Observable(""),i.containerManagedTitle=new a.Observable(""),i.viewTitle=new a.Observable(""),i.closeTitle=new a.Observable(""),i.backTitle=new a.Observable(""),i.fullTitle=new a.Observable(""),i.viewDescriptors=new a.ObservableCollection,i.activeViewDescriptors=new a.ObservableCollection,i.headerInsertDomElement=new a.Observable(null),i.footerInsertDomElement=new a.Observable(null),i.managedViewsOnly=!1,i.defaultViewIconUri=null,i._viewDescriptorConstructor=null,i._activeViews={},i._insertedViews=[],i._backButtonOnRootView=!0,i._showBackButton=!0,i._showBackButtonAsX=!0,i._originalHeaderIsVisibleSetting=!1,i._showHeaderForStandaloneViews=!1,i._fullTitleFormatString="{0} - {1}",i._ordering={};var r=i.app.viewManager.getExistingRegionByName(i.regionName.get());if(r)for(var n=0,o=r.views;n<o.length;n++){var s=o[n];i._addOrderedView(i.createDescriptorForView(s))}return i.app.event("ViewHostedEvent").subscribe(i,i.handleViewHosted),i.app.event("ViewUnhostedEvent").subscribe(i,i.handleViewUnhosted),i.app.event("ViewActivatedEvent").subscribe(i,i.handleViewActivatedEvent),i.app.event("ViewDeactivatedEvent").subscribe(i,i.handleViewDeactivatedEvent),i}t.ViewContainerViewModel=s})},"geocortex/framework-ui/ViewContainer/ViewDescriptor":function(){define(["require","exports","geocortex/framework/observables","./ViewContainerView"],function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function i(e,t){if(this.containerTitle=new r.Observable(null),this.isBusy=new r.Observable(null),this.isActive=new r.Observable(!1),this.cssClass=new r.Observable("tab-inactive"),this.view=e,this.iconUri=e.iconUri.get()?e.iconUri:new r.Observable(t.defaultViewIconUri),this.title=e.title,this.isBusy=e.isBusy,this.priority=1,e instanceof n.ViewContainerView==1){var i=e;this.containerTitle.set(i.viewModel.containerTitle.get()),i.viewModel.containerManagedTitle.get()&&(this.title=i.viewModel.containerManagedTitle)}}t.ViewDescriptor=i})},"url:/Framework.UI/geocortex/framework/ui/ViewContainer/ButtonTabStripView.html":t,"url:/Framework.UI/geocortex/framework/ui/ViewContainer/ViewContainerView.html":i}}),require(["geocortex/framework/resourceManager"],function(e){e.resourceManager.register("Framework.UI","inv","Framework.UI/geocortex/framework/ui/ViewContainer/ButtonTabStripView.html","html",t),e.resourceManager.register("Framework.UI","inv","Framework.UI/geocortex/framework/ui/ViewContainer/ViewContainerView.html","html",i)})}();require({cache:{"geocortex/framework-ui/ViewDescriptorInterface":function(){define(["require","exports"],function(e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0})})}}});!function(){var t="<div class='tab-container'>    <ul class='tab-control' data-binding='{@source: viewDescriptors}'>        <li data-binding='{@template-for: viewDescriptors}{@event-onclick: handleClickTab}'>            <a data-binding='{@noclass-tab: isActive}{@class-tab-active: isActive}'>                <span data-binding='{@text: title}{title: title}'></span>            </a>        </li>    </ul></div>";require({cache:{"geocortex/framework-ui/ViewSwitcher/ViewSwitcherView":function(){var r,c=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewBase"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=(r=i.ViewBase,c(n,r),n.prototype.handleClickTab=function(e,t,i){var r=i.view;r&&this.app.viewManager.activateView(r)},n);function n(){return null!==r&&r.apply(this,arguments)||this}t.ViewSwitcherView=o})},"geocortex/framework-ui/ViewSwitcher/ViewSwitcherViewDescriptor":function(){define(["require","exports","geocortex/framework/observables"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function r(e,t){this.view=e,this.viewSwitcherViewModel=t,this.title=e.title,this.isActive=new i.Observable(e.isActive)}t.ViewSwitcherViewDescriptor=r})},"geocortex/framework-ui/ViewSwitcher/ViewSwitcherViewModel":function(){var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});define(["require","exports","geocortex/framework/ui/ViewModelBase","geocortex/framework/observables","./ViewSwitcherViewDescriptor"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,c=(n=i.ViewModelBase,a(s,n),s.prototype.initialize=function(e){e&&!this.targetRegion&&(this.targetRegion=e.targetRegion),this.targetRegion?this._subscribeEvents():this.app.trace.error("ViewSwitcherViewModel: Target region not configured.")},s.prototype.getDescriptorForView=function(e){if(e)for(var t=0;t<this.viewDescriptors.getLength();++t){var i=this.viewDescriptors.getAt(t);if(i.view.id===e.id)return i}return null},s.prototype.updateViewSwitcherState=function(){this.viewSwitcherActive.set(this.checkIfSwitcherActive())},s.prototype.createDescriptorForView=function(e){return new r.ViewSwitcherViewDescriptor(e,this)},s.prototype.handleViewHostedEvent=function(e){if(e.region.name===this.targetRegion&&e.view){var t=this.createDescriptorForView(e.view);this.viewDescriptors.addItem(t),this.updateViewSwitcherState()}},s.prototype.handleViewUnHostedEvent=function(e){if(e.region.name===this.targetRegion&&e.view){var t=this.getDescriptorForView(e.view);t&&(this.viewDescriptors.removeItem(t),this.updateViewSwitcherState())}},s.prototype.handleViewActivatedEvent=function(e){var t=this.getDescriptorForView(e);t&&(this._deactivateActiveTabsInTargetRegion(),t.isActive.set(!0))},s.prototype.handleViewDeactivatedEvent=function(e){var t=this.getDescriptorForView(e);t&&t.isActive.set(!1)},s.prototype.checkIfSwitcherActive=function(){return 1<this.viewDescriptors.length()},s.prototype._deactivateActiveTabsInTargetRegion=function(){this.viewDescriptors.get().forEach(function(e){return e.isActive.get()&&e.isActive.set(!1)})},s.prototype._subscribeEvents=function(){this.app.event("ViewHostedEvent").subscribe(this,this.handleViewHostedEvent),this.app.event("ViewUnhostedEvent").subscribe(this,this.handleViewUnHostedEvent),this.app.event("ViewActivatedEvent").subscribe(this,this.handleViewActivatedEvent),this.app.event("ViewDeactivatedEvent").subscribe(this,this.handleViewDeactivatedEvent)},s);function s(e,t,i){var r=n.call(this,e,t)||this;return r.viewDescriptors=new o.ObservableCollection([]),r.viewSwitcherActive=new o.Observable(!1),r.targetRegion=i||"",r}t.ViewSwitcherViewModel=c})},"url:/Framework.UI/geocortex/framework/ui/ViewSwitcher/ViewSwitcherView.html":t}}),require(["geocortex/framework/resourceManager"],function(e){e.resourceManager.register("Framework.UI","inv","Framework.UI/geocortex/framework/ui/ViewSwitcher/ViewSwitcherView.html","html",t)})}();