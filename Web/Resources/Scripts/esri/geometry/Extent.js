// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.27/esri/copyright.txt for details.
//>>built
define("esri/geometry/Extent","dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./webMercatorUtils ./mathUtils ../srUtils".split(" "),function(B,w,x,C,y,u,t,D,k,v,E,F){function z(){}var A={type:"extent",xmin:0,ymin:0,xmax:0,ymax:0},g=B(D,{declaredClass:"esri.geometry.Extent",type:"extent",xmin:0,ymin:0,xmax:0,ymax:0,constructor:function(a,b,c,d,e){u.isObject(a)?(u.mixin(this,a),this.spatialReference&&(this.spatialReference=F.createSpatialReference(this.spatialReference))):
this.update(a,b,c,d,e);this.verifySR()},getWidth:function(){return Math.abs(this.xmax-this.xmin)},getHeight:function(){return Math.abs(this.ymax-this.ymin)},getCenter:function(){return new k((this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2,this.spatialReference)},getTopLeft:function(){return new k(this.xmin,this.ymax,this.spatialReference)},getTopRight:function(){return new k(this.xmax,this.ymax,this.spatialReference)},getBottomLeft:function(){return new k(this.xmin,this.ymin,this.spatialReference)},
getBottomRight:function(){return new k(this.xmax,this.ymin,this.spatialReference)},centerAt:function(a){var b=this.getCenter(),c=a.x-b.x;a=a.y-b.y;return new g(this.xmin+c,this.ymin+a,this.xmax+c,this.ymax+a,this.spatialReference)},update:function(a,b,c,d,e){this.xmin=a;this.ymin=b;this.xmax=c;this.ymax=d;this.spatialReference=e;this.clearCache();return this},offset:function(a,b){return new g(this.xmin+a,this.ymin+b,this.xmax+a,this.ymax+b,this.spatialReference)},expand:function(a){var b=(1-a)/2;
a=this.getWidth()*b;b*=this.getHeight();return new g(this.xmin+a,this.ymin+b,this.xmax-a,this.ymax-b,this.spatialReference)},intersects:function(a){if(!a)return!1;var b=a.type,c=this.spatialReference,d=a.spatialReference;c&&d&&!c.equals(d)&&c._canProject(d)&&(a=c.isWebMercator()?v.geographicToWebMercator(a):v.webMercatorToGeographic(a,!0));switch(b){case "point":return this.contains(a);case "multipoint":return this._intersectsMultipoint(a);case "extent":return this._intersectsExtent(a);case "polygon":return this._intersectsPolygon(a);
case "polyline":return this._intersectsPolyline(a)}},normalize:function(){var a=this._normalize(!1,!0);x.isArray(a)||(a=[a]);return a},shiftCentralMeridian:function(){return this._normalize(!0)},bisect:function(){var a=this.spatialReference,b=a&&a._getInfo(),c=[],d=0;if(b&&this._isOutOfBounds(b)){var e=this,d=e.xmin,f=e.ymin,h=e.ymax,G=b.valid[0],l=b.valid[1];e.getWidth()>2*l&&(e=e.getCenter(),e=new g(e.x-l,f,e.x+l,h,new t(a.toJson())));var d=e.xmin-d,m=this._normalizeX(e.xmin,b),b=this._normalizeX(e.xmax,
b);m.frameId===b.frameId?c.push(new g(m.x,f,b.x,h,new t(a.toJson()))):c.push(new g(m.x,f,l,h,new t(a.toJson())),new g(G,f,b.x,h,new t(a.toJson())))}else c.push(this.getExtent());return{extents:c,marginLeft:d}},_intersectsMultipoint:function(a){var b=a.points.length,c;for(c=0;c<b;c++)if(this.contains(a.getPoint(c)))return!0;return!1},_intersectsExtent:function(a){var b,c,d,e,f=!1;this.xmin<=a.xmin?(b=a.xmin,this.xmax<b?f=!0:d=Math.min(this.xmax,a.xmax)-b):(b=this.xmin,a.xmax<b?f=!0:d=Math.min(this.xmax,
a.xmax)-b);this.ymin<=a.ymin?(c=a.ymin,this.ymax<c?f=!0:e=Math.min(this.ymax,a.ymax)-c):(c=this.ymin,a.ymax<c?f=!0:e=Math.min(this.ymax,a.ymax)-c);return f?null:new g(b,c,b+d,c+e,this.spatialReference)},_intersectsPolygon:function(a){var b=[this.xmin,this.ymax],c=[this.xmax,this.ymax],d=[this.xmin,this.ymin],e=[this.xmax,this.ymin],f=[b,c,d,e],b=[[d,b],[b,c],[c,e],[e,d]],d=a.rings,e=d.length,h,g=new k(0,0,this.spatialReference);h=f.length;for(c=0;c<h;c++)if(g.update(f[c][0],f[c][1]),a.contains(g))return!0;
g.setSpatialReference(a.spatialReference);for(var l,m,c=0;c<e;c++)if(f=d[c],h=f.length){l=f[0];g.update(l[0],l[1]);if(this.contains(g))return!0;for(a=1;a<h;a++){m=f[a];g.update(m[0],m[1]);if(this.contains(g)||this._intersectsLine([l,m],b))return!0;l=m}}return!1},_intersectsPolyline:function(a){var b=[[[this.xmin,this.ymin],[this.xmin,this.ymax]],[[this.xmin,this.ymax],[this.xmax,this.ymax]],[[this.xmax,this.ymax],[this.xmax,this.ymin]],[[this.xmax,this.ymin],[this.xmin,this.ymin]]],c,d=a.paths,e=
d.length,f,h,g,l,m=new k(0,0,a.spatialReference);for(a=0;a<e;a++)if(f=d[a],h=f.length){g=f[0];m.update(g[0],g[1]);if(this.contains(m))return!0;for(c=1;c<h;c++){l=f[c];m.update(l[0],l[1]);if(this.contains(m)||this._intersectsLine([g,l],b))return!0;g=l}}return!1},_intersectsLine:function(a,b){var c=E._getLineIntersection2,d,e=b.length;for(d=0;d<e;d++)if(c(a,b[d]))return!0;return!1},contains:function(a){if(!a)return!1;var b=a.type;if("point"===b){var c=this.spatialReference,d=a.spatialReference,b=a.x;
a=a.y;c&&d&&!c.equals(d)&&c._canProject(d)&&(a=c.isWebMercator()?k.lngLatToXY(b,a):k.xyToLngLat(b,a,!0),b=a[0],a=a[1]);return b>=this.xmin&&b<=this.xmax&&a>=this.ymin&&a<=this.ymax}return"extent"===b?this._containsExtent(a):!1},_containsExtent:function(a){var b=a.xmin,c=a.ymin,d=a.xmax,e=a.ymax,f=a.spatialReference;a=new k(b,c,f);b=new k(b,e,f);e=new k(d,e,f);c=new k(d,c,f);return this.contains(a)&&this.contains(b)&&this.contains(e)&&this.contains(c)?!0:!1},union:function(a){return new g(Math.min(this.xmin,
a.xmin),Math.min(this.ymin,a.ymin),Math.max(this.xmax,a.xmax),Math.max(this.ymax,a.ymax),this.spatialReference)},getExtent:function(){var a=this.spatialReference;return new g(this.xmin,this.ymin,this.xmax,this.ymax,a&&new t(a.toJson()))},_shiftCM:function(a){var b=this.getCacheValue("_shifted");if(!b){var b=new g(this.toJson()),c=b.spatialReference;if(a=a||c._getInfo()){var d=this._getCM(a);if(d){var e=c._isWebMercator()?v.webMercatorToGeographic(d):d;b.xmin-=d.x;b.xmax-=d.x;c._isWebMercator()||(e.x=
this._normalizeX(e.x,a).x);b.setSpatialReference(new t(u.substitute({Central_Meridian:e.x},4326===c.wkid?a.altTemplate:a.wkTemplate)))}}this.setCacheValue("_shifted",b)}return b},_getCM:function(a){var b;this._isOutOfBounds(a)&&(b=this.getCenter());return b},_isOutOfBounds:function(a){var b=a.valid[0];a=a.valid[1];var c=this.xmin,d=this.xmax;return!(c>=b&&c<=a&&d>=b&&d<=a)},_normalize:function(a,b,c){var d=new g(this.toJson()),e=d.spatialReference;if(e&&(c=c||e._getInfo())){var f=w.map(this._getParts(c),
function(a){return a.extent});return 2<f.length?a?this._shiftCM(c):d.update(c.valid[0],d.ymin,c.valid[1],d.ymax,e):2===f.length?a?this._shiftCM(c):b?f:{rings:w.map(f,function(a){return[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]}),spatialReference:e}:f[0]||d}return d},_getParts:function(a){var b=this.getCacheValue("_parts");if(!b){var b=[],c=this.xmin,d=this.xmax,e=this.ymin,f=this.ymax,h=this.spatialReference,k=this.getWidth(),l=c,m=d,r=0,n=0,p,q;a=a||h._getInfo();
p=a.valid[0];q=a.valid[1];n=this._normalizeX(c,a);c=n.x;r=n.frameId;n=this._normalizeX(d,a);d=n.x;n=n.frameId;a=c===d&&0<k;if(k>2*q){k=new g(l<m?c:d,e,q,f,h);c=new g(p,e,l<m?d:c,f,h);q=new g(0,e,q,f,h);e=new g(p,e,0,f,h);h=[];p=[];k.contains(q)&&h.push(r);k.contains(e)&&p.push(r);c.contains(q)&&h.push(n);c.contains(e)&&p.push(n);for(f=r+1;f<n;f++)h.push(f),p.push(f);b.push({extent:k,frameIds:[r]},{extent:c,frameIds:[n]},{extent:q,frameIds:h},{extent:e,frameIds:p})}else c>d||a?b.push({extent:new g(c,
e,q,f,h),frameIds:[r]},{extent:new g(p,e,d,f,h),frameIds:[n]}):b.push({extent:new g(c,e,d,f,h),frameIds:[r]});this.setCacheValue("_parts",b)}return b},_normalizeX:function(a,b){var c=0,d=b.valid[0],e=b.valid[1];b=2*e;a>e?(c=Math.ceil(Math.abs(a-e)/b),a-=c*b):a<d&&(c=Math.ceil(Math.abs(a-d)/b),a+=c*b,c=-c);return{x:a,frameId:c}},toJson:function(){var a={xmin:this.xmin,ymin:this.ymin,xmax:this.xmax,ymax:this.ymax},b=this.spatialReference;b&&(a.spatialReference=b.toJson());return a}});z.prototype=g.prototype;
g.simpleConstructor=z;g.defaultProps=A;C("extend-esri")&&(x.setObject("geometry.Extent",g,y),y.geometry.defaultExtent=A);return g});